{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../src/components/utils.js","../../node_modules/svelte/easing/index.mjs","../../node_modules/svelte/transition/index.mjs","../../node_modules/svelte/store/index.mjs","../../src/constants.js","../../src/stores.js","../../src/components/LidoRoute.svelte","../../src/components/kml.js","../../src/components/mapSettings/ColorPinCombo.svelte","../../src/components/mapSettings/storage.js","../../src/components/ShortcutsLink.svelte","../../src/actions/blurAction.js","../../src/components/DownloadButton.svelte","../../src/components/mapSettings/CheckboxColorCombo.svelte","../../src/components/mapSettings/AirportSelector.svelte","../../src/components/mapSettings/ZoomLevel.svelte","../../src/actions/clickOutsideAction.js","../../src/components/mapboxgl/json.js","../../src/components/mapboxgl/utils.js","../../src/components/mapboxgl/layers/ogimet.js","../../src/components/mapboxgl/layers/fir-reg.js","../../src/components/mapboxgl/layers/great-circle.js","../../src/components/mapSettings/Form.svelte","../../src/components/ExportSettings.svelte","../../src/components/Export.svelte","../../src/components/Logo.svelte","../../src/components/Home.svelte","../../src/components/countries.js","../../src/components/mapboxgl/layers/airport.js","../../src/components/mapboxgl/layers/etops.js","../../src/components/mapboxgl/layers/ralt.js","../../src/components/mapboxgl/layers/tracks.js","../../src/components/mapboxgl/layers/rmain.js","../../src/components/mapboxgl/layersManagement.js","../../src/components/mapboxgl/pj_times.js","../../src/components/mapboxgl/pj_eqearth.js","../../src/components/mapboxgl/mapManagement.js","../../src/tilesCache.js","../../src/components/CircleProgress.svelte","../../src/components/AircraftType.svelte","../../src/components/MapPlane.svelte","../../src/components/mapboxgl/blankStyle.js","../../src/components/mapboxgl/mapOptions.js","../../src/components/MapProjectionSelect.svelte","../../src/components/SimulatorPlayer.svelte","../../src/actions/grametAction.js","../../src/components/Gramet.svelte","../../src/actions/mapResizeAction.js","../../src/components/Map.svelte","../../node_modules/svelte-overlay/src/components/positions.js","../../node_modules/svelte-overlay/src/components/helpers.js","../../node_modules/svelte-overlay/src/components/Overlay.svelte","../../src/components/Link.svelte","../../src/components/GrametTrigger.svelte","../../src/components/pairingParser.js","../../src/components/OfpInfos.svelte","../../src/components/TakeOffInput.svelte","../../src/components/suncalc.js","../../src/components/solarstore.js","../../src/components/KpUpdater.svelte","../../src/components/SunTimeLine.svelte","../../src/components/KpTimeLine.svelte","../../src/components/Moon.svelte","../../src/components/SunPopOver.svelte","../../src/components/Sun.svelte","../../src/components/EmbeddedVideo.svelte","../../src/components/Help.md","../../src/components/ChangeLog.svelte","../../src/components/ChangeLogModal.svelte","../../src/components/Help.svelte","../../src/components/Navbar.svelte","../../src/components/OfpInput.svelte","../../src/components/async-script-loader.js","../../src/components/Page.svelte","../../src/components/SWUpdate.svelte","../../src/components/HomePwaInstall.svelte","../../src/App.svelte","../../node_modules/workbox-window/build/workbox-window.prod.es5.mjs","../../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root.host) {\n        return root;\n    }\n    return document;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentElement !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => svg ? svg_element(name) : element(name));\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration();\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, bubbles = false) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor() {\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes) {\n        super();\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = append_empty_stylesheet(node).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction escape_attribute_value(value) {\n    return typeof value === 'string' ? escape(value) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : context || []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : options.context || []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.42.1' }, detail), true));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_html_tag, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, src_url_equal, start_hydrating, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","export class Deferred {\n    constructor() {\n        this.promise = new Promise((resolve, reject)=> {\n            this.reject = reject\n            this.resolve = resolve\n        })\n    }\n}\nexport const runningOnIpad = (navigator.platform === \"iPad\")||(navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);\nexport const usingChromeOnIOS = /CriOS/i.test(navigator.userAgent) && /iphone|ipod|ipad/i.test(navigator.userAgent);\nexport const usingSafari = /Safari\\//i.test(navigator.userAgent) && !(/(Chrome\\/|Chromium\\/)/i.test(navigator.userAgent));\nexport const supportsHover = matchMedia('(hover: hover)').matches;\n\nexport function debounce(func, wait, immediate) {\n    let timeout;\n    return function() {\n        const context = this, args = arguments;\n        const later = function() {\n            timeout = null;\n            if (!immediate) func.apply(context, args);\n        };\n        const callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n    };\n}\nexport function throttle(func, wait, leading, trailing, context) {\n    let ctx, args, result;\n    let timeout = null;\n    let previous = 0;\n    const later = function() {\n        previous = new Date;\n        timeout = null;\n        result = func.apply(ctx, args);\n    };\n    return function() {\n        var now = new Date;\n        if (!previous && !leading) previous = now;\n        var remaining = wait - (now - previous);\n        ctx = context || this;\n        args = arguments;\n        // Si la période d'attente est écoulée\n        if (remaining <= 0) {\n            // Réinitialiser les compteurs\n            clearTimeout(timeout);\n            timeout = null;\n            // Enregistrer le moment du dernier appel\n            previous = now;\n            // Appeler la fonction\n            result = func.apply(ctx, args);\n        } else if (!timeout && trailing) {\n            // Sinon on s’endort pendant le temps restant\n            timeout = setTimeout(later, remaining);\n        }\n        return result;\n    };\n}\n\nexport function folderName(str) {\n    const a = str.split('-');\n    const name = a.slice(0, -1).join('');\n    switch (name) {\n        case \"route\":\n            return \"rmain\";\n        case \"alternate\":\n            return \"ralt\";\n        case \"nat\":\n            return \"rnat\";\n        default:\n            return name;\n    }\n}\nexport function folder2prefix(str){\n    switch (str) {\n        case \"rmain\":\n            return \"route\";\n        case \"ralt\":\n            return \"alternate\";\n        case \"rnat\":\n            return \"nat\";\n        default:\n            return str;\n    }\n}\n\nexport function clamp(num, min, max) {\n    return num <= min ? min : num >= max ? max : num;\n}\n\nexport function isInside(num, min, max) {\n    return num < min ? false : num > max ? false : true;\n}\n\nexport async function addToSWCache(urls, cacheName) {\n    if (window.caches) {\n        try {\n            const myCache = await window.caches.open(cacheName);\n            await myCache.addAll(urls);\n        } catch (err) {\n            //console.log('could not cache', err);\n        }\n    }\n}\n\n// intersect a segment against one of the 4 lines that make up the bbox\n\nfunction intersect(a, b, edge, bbox) {\n    // noinspection JSBitwiseOperatorUsage\n    return edge & 8 ? [a[0] + (b[0] - a[0]) * (bbox[3] - a[1]) / (b[1] - a[1]), bbox[3]] : // top\n        edge & 4 ? [a[0] + (b[0] - a[0]) * (bbox[1] - a[1]) / (b[1] - a[1]), bbox[1]] : // bottom\n        edge & 2 ? [bbox[2], a[1] + (b[1] - a[1]) * (bbox[2] - a[0]) / (b[0] - a[0])] : // right\n        edge & 1 ? [bbox[0], a[1] + (b[1] - a[1]) * (bbox[0] - a[0]) / (b[0] - a[0])] : null; // left\n}\n\n// bit code reflects the point position relative to the bbox:\n\n//         left  mid  right\n//    top  1001  1000  1010\n//    mid  0001  0000  0010\n// bottom  0101  0100  0110\n\nfunction bitCode(p, bbox) {\n    var code = 0;\n\n    if (p[0] < bbox[0]) code |= 1; // left\n    else if (p[0] > bbox[2]) code |= 2; // right\n\n    if (p[1] < bbox[1]) code |= 4; // bottom\n    else if (p[1] > bbox[3]) code |= 8; // top\n\n    return code;\n}\n\nexport function lineclip(points, bbox, result) {\n\n    var len = points.length,\n        codeA = bitCode(points[0], bbox),\n        part = [],\n        i, a, b, codeB, lastCode;\n\n    if (!result) result = [];\n\n    for (i = 1; i < len; i++) {\n        a = points[i - 1];\n        b = points[i];\n        codeB = lastCode = bitCode(b, bbox);\n\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n\n            if (!(codeA | codeB)) { // accept\n                part.push(a);\n\n                if (codeB !== lastCode) { // segment went outside\n                    part.push(b);\n\n                    if (i < len - 1) { // start a new line\n                        result.push(part);\n                        part = [];\n                    }\n                } else if (i === len - 1) {\n                    part.push(b);\n                }\n                break;\n\n            } else if (codeA & codeB) { // trivial reject\n                break;\n\n            } else if (codeA) { // a outside, intersect with clip edge\n                a = intersect(a, b, codeA, bbox);\n                codeA = bitCode(a, bbox);\n\n            } else { // b outside\n                b = intersect(a, b, codeB, bbox);\n                codeB = bitCode(b, bbox);\n            }\n        }\n\n        codeA = lastCode;\n    }\n\n    if (part.length) result.push(part);\n\n    return result;\n}\n\nexport function promiseTimeout(ms, promise){\n    // Create a promise that rejects in <ms> milliseconds\n    let timeout = new Promise((resolve, reject) => {\n        let id = setTimeout(() => {\n            clearTimeout(id);\n            reject('Timed out in '+ ms + 'ms.')\n        }, ms)\n    });\n    // Returns a race between our timeout and the passed in promise\n    return Promise.race([\n        promise,\n        timeout\n    ]);\n}\n\n\nexport const getBounds = (points, affineAndClamp, result=[Infinity, Infinity, -Infinity, -Infinity]) => {\n    for (const [lng, lat] of points.map(g => (affineAndClamp) ? affineAndClamp([g.longitude, g.latitude]) : [g.longitude, g.latitude])) {\n        if (result[0] > lng) { result[0] = lng; }\n        if (result[1] > lat) { result[1] = lat; }\n        if (result[2] < lng) { result[2] = lng; }\n        if (result[3] < lat) { result[3] = lat; }\n    }\n    result[0] -= 1;\n    result[1] -= 1;\n    result[2] += 1;\n    result[3] += 1;\n    return result;\n}\n\nexport async function fetchSimultaneously(urls, fetchCallback) {\n    const queue = urls;\n    const maxSimultaneouslyRequests = 5;\n    let currentRequests = 0;\n    let i = 0;\n\n    return await new Promise(resolve => {\n\n        const fetcher = setInterval(async () => {\n            if (queue.filter(url => url).length === 0) {\n                clearInterval(fetcher);\n                resolve();\n            }\n\n            if (currentRequests >= maxSimultaneouslyRequests || i > queue.length - 1) {\n                return;\n            }\n\n            // Get current index and increase i\n            const index = i++;\n            const url = queue[index];\n\n            currentRequests++;\n            try {\n                await fetch(url);\n                if (fetchCallback) fetchCallback();\n            } catch(err) {console.error(err)}\n            currentRequests--;\n\n            // Set value of index to empty (undefined)\n            delete queue[index];\n        }, 100);\n    });\n}\n\nexport const isPatchUpdate = (current, next) => {\n    const cParts = current.split('.');\n    const nParts = next.split('.');\n    return cParts.slice(0, -1).join('.') === nParts.slice(0, -1).join('.');\n}\n//semver-compare\nexport const semverCompare = (a, b) => {\n    let pa = a.split('.');\n    let pb = b.split('.');\n    for (var i = 0; i < 3; i++) {\n        let na = Number(pa[i]);\n        let nb = Number(pb[i]);\n        if (na > nb) return 1;\n        if (nb > na) return -1;\n        if (!isNaN(na) && isNaN(nb)) return 1;\n        if (isNaN(na) && !isNaN(nb)) return -1;\n    }\n    return 0;\n};\n\nexport const shareAppLink = async () => {\n    const shareData = {\n        'title': 'OFP2MAP',\n        'url': window.location.pathname\n    };\n    try {\n        await navigator.share(shareData)\n    } catch(err) {\n        console.log(err);\n    }\n    return false;\n};\n\n// search for condition in array, returns the index, -1 if no match (-1 also for empty array)\n// condition might be > or >= for ascending order array, < or < = for descending order array\nexport const binarysearch = (sortedArray, condition) => {\n    let start = 0, end = sortedArray.length - 1;\n    let ans = -1;\n    while (start <= end)\n    {\n        let mid = Math.trunc((start + end) / 2);\n        if (!condition(sortedArray[mid]))\n        {\n            start = mid + 1;\n        }\n        else\n        {\n            ans = mid;\n            end = mid - 1;\n        }\n    }\n    return (ans === -1 || !condition(sortedArray[ans])) ? -1 : ans;\n};\n\nexport const focusMap = (evenIfHidden= false) => {\n    const canvas = (evenIfHidden) ?\n        document.querySelector(\"#map canvas.mapboxgl-canvas\") :\n        document.querySelector(\"page:not(.d-none)>#map canvas.mapboxgl-canvas\");\n    if (canvas) canvas.focus();\n};\n","export { identity as linear } from '../internal/index.mjs';\n\n/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nfunction backInOut(t) {\n    const s = 1.70158 * 1.525;\n    if ((t *= 2) < 1)\n        return 0.5 * (t * t * ((s + 1) * t - s));\n    return 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\nfunction backIn(t) {\n    const s = 1.70158;\n    return t * t * ((s + 1) * t - s);\n}\nfunction backOut(t) {\n    const s = 1.70158;\n    return --t * t * ((s + 1) * t + s) + 1;\n}\nfunction bounceOut(t) {\n    const a = 4.0 / 11.0;\n    const b = 8.0 / 11.0;\n    const c = 9.0 / 10.0;\n    const ca = 4356.0 / 361.0;\n    const cb = 35442.0 / 1805.0;\n    const cc = 16061.0 / 1805.0;\n    const t2 = t * t;\n    return t < a\n        ? 7.5625 * t2\n        : t < b\n            ? 9.075 * t2 - 9.9 * t + 3.4\n            : t < c\n                ? ca * t2 - cb * t + cc\n                : 10.8 * t * t - 20.52 * t + 10.72;\n}\nfunction bounceInOut(t) {\n    return t < 0.5\n        ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0))\n        : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\nfunction bounceIn(t) {\n    return 1.0 - bounceOut(1.0 - t);\n}\nfunction circInOut(t) {\n    if ((t *= 2) < 1)\n        return -0.5 * (Math.sqrt(1 - t * t) - 1);\n    return 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\nfunction circIn(t) {\n    return 1.0 - Math.sqrt(1.0 - t * t);\n}\nfunction circOut(t) {\n    return Math.sqrt(1 - --t * t);\n}\nfunction cubicInOut(t) {\n    return t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\nfunction cubicIn(t) {\n    return t * t * t;\n}\nfunction cubicOut(t) {\n    const f = t - 1.0;\n    return f * f * f + 1.0;\n}\nfunction elasticInOut(t) {\n    return t < 0.5\n        ? 0.5 *\n            Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) *\n            Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n        : 0.5 *\n            Math.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n            Math.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n            1.0;\n}\nfunction elasticIn(t) {\n    return Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction elasticOut(t) {\n    return (Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0);\n}\nfunction expoInOut(t) {\n    return t === 0.0 || t === 1.0\n        ? t\n        : t < 0.5\n            ? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n            : -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\nfunction expoIn(t) {\n    return t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\nfunction expoOut(t) {\n    return t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\nfunction quadInOut(t) {\n    t /= 0.5;\n    if (t < 1)\n        return 0.5 * t * t;\n    t--;\n    return -0.5 * (t * (t - 2) - 1);\n}\nfunction quadIn(t) {\n    return t * t;\n}\nfunction quadOut(t) {\n    return -t * (t - 2.0);\n}\nfunction quartInOut(t) {\n    return t < 0.5\n        ? +8.0 * Math.pow(t, 4.0)\n        : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\nfunction quartIn(t) {\n    return Math.pow(t, 4.0);\n}\nfunction quartOut(t) {\n    return Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\nfunction quintInOut(t) {\n    if ((t *= 2) < 1)\n        return 0.5 * t * t * t * t * t;\n    return 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\nfunction quintIn(t) {\n    return t * t * t * t * t;\n}\nfunction quintOut(t) {\n    return --t * t * t * t * t + 1;\n}\nfunction sineInOut(t) {\n    return -0.5 * (Math.cos(Math.PI * t) - 1);\n}\nfunction sineIn(t) {\n    const v = Math.cos(t * Math.PI * 0.5);\n    if (Math.abs(v) < 1e-14)\n        return 1;\n    else\n        return 1 - v;\n}\nfunction sineOut(t) {\n    return Math.sin((t * Math.PI) / 2);\n}\n\nexport { backIn, backInOut, backOut, bounceIn, bounceInOut, bounceOut, circIn, circInOut, circOut, cubicIn, cubicInOut, cubicOut, elasticIn, elasticInOut, elasticOut, expoIn, expoInOut, expoOut, quadIn, quadInOut, quadOut, quartIn, quartInOut, quartOut, quintIn, quintInOut, quintOut, sineIn, sineInOut, sineOut };\n","import { cubicInOut, linear, cubicOut } from '../easing/index.mjs';\nimport { is_function, assign } from '../internal/index.mjs';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\n\nfunction blur(node, { delay = 0, duration = 400, easing = cubicInOut, amount = 5, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const f = style.filter === 'none' ? '' : style.filter;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `opacity: ${target_opacity - (od * u)}; filter: ${f} blur(${u * amount}px);`\n    };\n}\nfunction fade(node, { delay = 0, duration = 400, easing = linear } = {}) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\nfunction fly(node, { delay = 0, duration = 400, easing = cubicOut, x = 0, y = 0, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `\n\t\t\ttransform: ${transform} translate(${(1 - t) * x}px, ${(1 - t) * y}px);\n\t\t\topacity: ${target_opacity - (od * u)}`\n    };\n}\nfunction slide(node, { delay = 0, duration = 400, easing = cubicOut } = {}) {\n    const style = getComputedStyle(node);\n    const opacity = +style.opacity;\n    const height = parseFloat(style.height);\n    const padding_top = parseFloat(style.paddingTop);\n    const padding_bottom = parseFloat(style.paddingBottom);\n    const margin_top = parseFloat(style.marginTop);\n    const margin_bottom = parseFloat(style.marginBottom);\n    const border_top_width = parseFloat(style.borderTopWidth);\n    const border_bottom_width = parseFloat(style.borderBottomWidth);\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => 'overflow: hidden;' +\n            `opacity: ${Math.min(t * 20, 1) * opacity};` +\n            `height: ${t * height}px;` +\n            `padding-top: ${t * padding_top}px;` +\n            `padding-bottom: ${t * padding_bottom}px;` +\n            `margin-top: ${t * margin_top}px;` +\n            `margin-bottom: ${t * margin_bottom}px;` +\n            `border-top-width: ${t * border_top_width}px;` +\n            `border-bottom-width: ${t * border_bottom_width}px;`\n    };\n}\nfunction scale(node, { delay = 0, duration = 400, easing = cubicOut, start = 0, opacity = 0 } = {}) {\n    const style = getComputedStyle(node);\n    const target_opacity = +style.opacity;\n    const transform = style.transform === 'none' ? '' : style.transform;\n    const sd = 1 - start;\n    const od = target_opacity * (1 - opacity);\n    return {\n        delay,\n        duration,\n        easing,\n        css: (_t, u) => `\n\t\t\ttransform: ${transform} scale(${1 - (sd * u)});\n\t\t\topacity: ${target_opacity - (od * u)}\n\t\t`\n    };\n}\nfunction draw(node, { delay = 0, speed, duration, easing = cubicInOut } = {}) {\n    const len = node.getTotalLength();\n    if (duration === undefined) {\n        if (speed === undefined) {\n            duration = 800;\n        }\n        else {\n            duration = len / speed;\n        }\n    }\n    else if (typeof duration === 'function') {\n        duration = duration(len);\n    }\n    return {\n        delay,\n        duration,\n        easing,\n        css: (t, u) => `stroke-dasharray: ${t * len} ${u * len}`\n    };\n}\nfunction crossfade(_a) {\n    var { fallback } = _a, defaults = __rest(_a, [\"fallback\"]);\n    const to_receive = new Map();\n    const to_send = new Map();\n    function crossfade(from, node, params) {\n        const { delay = 0, duration = d => Math.sqrt(d) * 30, easing = cubicOut } = assign(assign({}, defaults), params);\n        const to = node.getBoundingClientRect();\n        const dx = from.left - to.left;\n        const dy = from.top - to.top;\n        const dw = from.width / to.width;\n        const dh = from.height / to.height;\n        const d = Math.sqrt(dx * dx + dy * dy);\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        const opacity = +style.opacity;\n        return {\n            delay,\n            duration: is_function(duration) ? duration(d) : duration,\n            easing,\n            css: (t, u) => `\n\t\t\t\topacity: ${t * opacity};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${transform} translate(${u * dx}px,${u * dy}px) scale(${t + (1 - t) * dw}, ${t + (1 - t) * dh});\n\t\t\t`\n        };\n    }\n    function transition(items, counterparts, intro) {\n        return (node, params) => {\n            items.set(params.key, {\n                rect: node.getBoundingClientRect()\n            });\n            return () => {\n                if (counterparts.has(params.key)) {\n                    const { rect } = counterparts.get(params.key);\n                    counterparts.delete(params.key);\n                    return crossfade(rect, node, params);\n                }\n                // if the node is disappearing altogether\n                // (i.e. wasn't claimed by the other list)\n                // then we need to supply an outro\n                items.delete(params.key);\n                return fallback && fallback(node, params, intro);\n            };\n        };\n    }\n    return [\n        transition(to_send, to_receive, false),\n        transition(to_receive, to_send, true)\n    ];\n}\n\nexport { blur, crossfade, draw, fade, fly, scale, slide };\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","export const aircraftTypes = [\"220\", \"318\", \"319\", \"320\", \"321\", \"330\", \"340\", \"350\", \"380\", \"787\", \"772\", \"773\", \"77F\"];\nexport const discontinuatedAircraftTypes = [\"340\", \"380\"];","import { writable, readable, derived } from 'svelte/store';\nimport {aircraftTypes} from \"./constants\";\nimport {binarysearch} from \"./components/utils\";\n\nexport const previousAppVersionKey = 'previousAppVersion';\nexport function resetable(resetValue) {\n    const { subscribe, set, update } = writable(resetValue);\n    return {\n        subscribe,\n        set,\n        update,\n        reset: () => set((typeof resetValue === 'object') ? {...resetValue} : Array.isArray(resetValue) ? [...resetValue] : resetValue)\n    };\n}\n\nexport const wb = writable();\nexport const swDismiss = writable(false);\nexport const swUpdated = writable(false);\nexport const majorUpdate = writable(false);\nexport const sidebar = writable(false);\nexport const focusMode = writable(false);\n\nexport const showGramet = writable(false);\nexport const showPlaneOnMap = resetable(false);\nexport const grametPosition = writable(100);\nexport const mapZoom = writable(0);\nexport const simulate = writable(-1);\nexport const ofp = writable();\nexport const ofpStatus = writable();\nexport const takeOffTime = writable();\nexport const landingTime = derived([ofp, takeOffTime], ([$ofp, $takeOffTime]) => {\n    if ($ofp && $takeOffTime) {\n        if ($ofp.timeMatrix.length > 0) {\n            return new Date($takeOffTime.getTime() + (60000 * $ofp.timeMatrix[$ofp.timeMatrix.length - 1][1]));\n        }\n        const landing = new Date($takeOffTime.getTime() + $ofp.infos.flightTime * 60000);\n        return landing;\n    }\n    return undefined;\n});\nexport const fl = writable();\n\nexport const selectedAircraftType = writable();\nexport const aircraftType = derived([ofp, selectedAircraftType], ([$ofp, $selectedAircraftType]) => {\n    let aircraft;\n    if ($selectedAircraftType) {\n        aircraft = $selectedAircraftType;\n    }else if ($ofp){\n        aircraft = $ofp.infos.aircraftType;\n    }\n    if (!aircraft || aircraftTypes.indexOf(aircraft) === -1) return undefined;\n    return aircraft;\n});\n\nlet swLastUpdateDate = new Date();\nexport const checkSWUpdate = () => {\n    if ('serviceWorker' in navigator) {\n        // eslint-disable-next-line no-constant-condition\n        const timeout = ('process.env.NODE_ENV' !== '\"development\"') ? 1800000 /* 30 mn */ : 2000;\n        if ((new Date() - swLastUpdateDate) > timeout) {\n            navigator.serviceWorker.getRegistration().then(reg => {\n                if (reg) {\n                    if (!reg.waiting) {\n                        reg.update();\n                    } else {\n                        // service worker quit while in background ?\n                        swUpdated.set(true);\n                        majorUpdate.set(true); // show immediatly\n                    }\n                    swDismiss.set(false);\n                    swLastUpdateDate = new Date();\n                }\n            }, console.error);\n        }\n    }\n}\n\nexport const checkSwOnVisibilityChange = () =>{\n    if (document && document.visibilityState && document.visibilityState === 'visible') {\n        checkSWUpdate();\n    }\n}\nexport const visible = readable(true, set => {\n    const changeVisibleState = () => {\n        if (document && document.visibilityState) {\n            if (document.visibilityState === 'visible'){\n                //console.log('visibility visible')\n                set(true);\n            } else {\n                //console.log('visibility not visible')\n                set(false);\n            }\n        } else {\n            //console.log('visibility not supported, visible')\n            set(true);\n        }\n    };\n    document.addEventListener(\"visibilitychange\", changeVisibleState);\n    changeVisibleState();\n    return () => {\n        document.removeEventListener(\"visibilitychange\", changeVisibleState);\n    }\n});\n\nexport const online = readable({}, set => {\n    const update_network_status = () => {\n        set(navigator.onLine);\n    };\n\n    if (\n        (typeof navigator !== \"undefined\") &&\n        'onLine' in navigator\n    ) {\n        update_network_status();\n        window.addEventListener('offline', update_network_status);\n        window.addEventListener('online', update_network_status);\n    } else {\n        set(undefined);\n    }\n\n    return () => {\n        if (\n            (typeof navigator !== \"undefined\") &&\n            'onLine' in navigator\n        ) {\n            window.removeEventListener('offline', update_network_status);\n            window.removeEventListener('online', update_network_status);\n        }\n    };\n});\n\nexport const route = readable('/', set => {\n    const hashchange = () => {\n        const meta = document.querySelector( \"meta[name=viewport]\" );\n        const metaContent = (meta) ? meta.getAttribute( \"content\" ) : '';\n        let route = window.location.hash.substr(1) || \"/\";\n        if (route === '/map') {\n            sidebar.set(false);\n            if (metaContent) meta.setAttribute('content', metaContent + ',maximum-scale=1'); \n        } else {\n            if (metaContent) meta.setAttribute('content', metaContent.replace(',maximum-scale=1', ''));\n        }\n        set(route);\n        checkSWUpdate();\n    };\n    hashchange();\n    window.addEventListener('hashchange', hashchange);\n\n    return () => {\n        window.removeEventListener('hashchange', hashchange);\n    };\n});\nexport const isHelpRoute = derived(route, $route => $route === '/help' || ($route && $route.startsWith('/help')));\n\nexport const flightProgress = derived(\n    [ofp, simulate, takeOffTime, showPlaneOnMap, visible],\n    ([$ofp, $simulate, $takeOffTime, $showPlaneOnMap, $visible], set) => {\n        //console.log('fp init')\n        let interval;\n        const frequency = ($showPlaneOnMap) ? 10 * 1000 : 60 * 1000;\n        const simulatorFrequency = 100;\n        if($ofp && $takeOffTime){\n            const setValue = (value) => {\n                if (value < 100) {\n                    set(value);\n                }else {\n                    set(100);\n                    clearInterval(interval);\n                    interval = undefined;\n                    //console.log('fp: last update', value);\n                    simulate.set(-1); \n                }\n            };\n            \n            if ($simulate >= 0) {\n                //console.log('start of simulated session');\n                let value = $simulate;\n                interval = setInterval(() => {\n                    setValue(value);\n                    value++;\n                }, simulatorFrequency);\n            } else {\n                const takeOff = $takeOffTime;\n                const landing = new Date(takeOff.getTime() + $ofp.infos.flightTime * 60000);\n                const computePosition = () => {\n                    let now = new Date();\n                    if (now <= takeOff) {\n                        return 0;\n                    } else if (now >= landing) {\n                        return  100;\n                    } else {\n                        return (now - takeOff) / ($ofp.infos.flightTime * 60) / 10;\n                    }\n                };\n                const pos = computePosition();\n                if (pos < 100) {\n                    if ($visible) {\n                        interval = setInterval(() => {\n                            const value = computePosition();\n                            setValue(value);\n                        }, frequency);\n                    }\n                    set(pos);\n                }else{\n                    set(100);\n                    //console.log('set to max, no interval set', 100);\n                }\n            }\n        } else {\n            set(0);\n            //console.log('set to zero (no ofp of fakeOfp), no interval set', 0)\n        }\n        return () => {\n            if (interval) clearInterval(interval);\n            //console.log('closing flight progress')\n        }\n    },\n    0 // initial value\n);\nexport const position = derived([ofp, flightProgress], ([$ofp, $flightProgress]) => {\n    if (!$ofp) return { map: {latitude: 0, longitude: 0}, gramet: $flightProgress, fl: 300, reltime: 0};\n    const timeMatrix = $ofp.timeMatrix;\n    const distanceMatrix = $ofp.distanceMatrix;\n    const firstPoint = distanceMatrix[0][0];\n    const lastPoint = distanceMatrix[distanceMatrix.length - 1][0];\n    const routeDistance = distanceMatrix[distanceMatrix.length - 1][1];\n    const firstFL = (timeMatrix.length !== 0) ? timeMatrix[0][2] : distanceMatrix[0][2];\n    const lastFL = (timeMatrix.length !== 0) ? timeMatrix[timeMatrix.length - 1][2] : distanceMatrix[distanceMatrix.length - 1][2];\n    const routeTime = (timeMatrix.length !== 0) ? timeMatrix[timeMatrix.length - 1][1] : $ofp.infos.flightTime;\n    const posTime = ($flightProgress * routeTime) / 100;\n    if ($flightProgress <= 0) return {map: firstPoint, gramet: 0, fl: firstFL, reltime: posTime};\n    if ($flightProgress >= 100) return {map: lastPoint, gramet: 100, fl: lastFL, reltime: posTime};\n\n    if (timeMatrix.length !== 0) {\n        const i = binarysearch(timeMatrix, a => a[1] >= posTime);\n        const [p, sum, fl] = timeMatrix[i];\n        if (posTime - sum === 0) {\n            return {\n                reltime: posTime,\n                map: p,\n                gramet: 100 * distanceMatrix[i][1] / routeDistance,\n                fl\n            };\n        }\n        const previous = timeMatrix[i - 1];\n        if (previous) {\n            const segmentLength = distanceMatrix[i][1] - distanceMatrix[i - 1][1];\n            const fraction = (sum - posTime) / (sum - previous[1]);\n            return {\n                reltime: posTime,\n                map: p.atFraction(previous[0], fraction, segmentLength),\n                gramet: 100 * ((distanceMatrix[i][1] - (fraction * segmentLength))) / routeDistance,\n                fl: previous[2]\n            }\n        }\n        return {\n            reltime: posTime,\n            map: firstPoint,\n            gramet: 0,\n            fl: firstFL\n        };\n    } else if(distanceMatrix.length !== 0){\n        const routeDistance = distanceMatrix[distanceMatrix.length - 1][1];\n        const posDistance = ($flightProgress * routeDistance) / 100;\n        const i = binarysearch(distanceMatrix, a => a[1] >= posDistance);\n        const [p, sum, fl] = distanceMatrix[i];\n        if (posDistance - sum === 0) return {\n            map: p,\n            gramet: $flightProgress,\n            fl,\n            reltime: posTime\n        };\n        const previous = distanceMatrix[i - 1];\n        if (previous) {\n            const segmentLength = sum - previous[1];\n            return {\n                map: p.atFraction(previous[0], (sum - posDistance) / segmentLength, segmentLength),\n                gramet: $flightProgress,\n                fl: previous[2],\n                reltime: posTime\n            }\n        }\n        return {\n            map: firstPoint,\n            gramet: 0,\n            fl: firstFL,\n            reltime: posTime\n        };\n    }\n    return {\n        map: lastPoint,\n        gramet: 100,\n        fl: lastFL,\n        reltime: posTime\n    };\n\n}, { map: {latitude: 0, longitude: 0}, gramet: 0, fl: 300, reltime: 0});","<script context=\"module\">\n    import {runningOnIpad} from \"./utils.js\";\n    let copyPermission = false;\n    if (navigator.permissions) {\n        try {\n            navigator.permissions.query({name: \"clipboard-write\"}).then((result) => {\n                if (result.state == \"granted\" || result.state == \"prompt\") {\n                    copyPermission = true;\n                }\n            });\n        }catch(err) {\n            console.log(err);\n        }\n    }\n</script>\n<script>\n    import { tick, onDestroy } from 'svelte';\n    import { fade } from 'svelte/transition';\n    import {ofp} from '../stores';\n    let valueCopy = null;\n    let areaDom;\n    const lidoRoute = (!!$ofp) ? $ofp.lidoRoute(false).join(' ') : '';\n    let copied = false;\n    let timeOut;\n    const click = (e) => {\n        const success = copyText(lidoRoute);\n        if (!runningOnIpad) {\n            copied = success;\n            timeOut = setTimeout(function () {\n                copied = false;\n                if (timeOut) clearTimeout(timeOut);\n            }, 3000);\n            e.preventDefault();\n        }\n    };\n\n    async function copyText(text) {\n        let success = true;\n        if (copyPermission) {\n            navigator.clipboard.writeText(text).then(() => success = true, () => success = false) ;\n        }\n        else {\n            valueCopy = text;\n            await tick();\n            areaDom.focus();\n            areaDom.select();\n            try {\n                success = document.execCommand('copy');\n                if (!success) {\n                    console.log('copy command failed');\n                }\n            } catch (err) {\n                success = false;\n                console.log('failed to copy');\n            }\n            valueCopy = null;\n        }\n        return success;\n    }\n    onDestroy(() => {\n        if (timeOut) clearTimeout(timeOut);\n    });\n</script>\n{#if valueCopy != null}\n    <textarea bind:this={areaDom}>{valueCopy}</textarea>\n{/if}\n<div class=\"card mb-3\">\n    <div class=\"card-body\">\n        <h5 class=\"card-title\">Route Lido</h5>\n        <div class=\"row mb-3\">\n            <div class=\"col-12 col-md-9\">\n                <p class=\"card-text\">Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\n                    d'avoir une application Lido plus réactive.</p>\n            </div>\n            <div class=\"text-md-end col align-self-center col-12 col-md-3 py-3 py-md-0\">\n                {#if runningOnIpad}\n                    <a role=\"button\" class=\"btn btn-primary\" on:click={click} href='lhs-mpilot://'>ouvrir mPilot <sup>*</sup></a>\n                {:else}\n                    <a role=\"button\" class=\"btn btn-primary\" on:click={click} href='lhs-mpilot://'>copier la route</a>\n                {/if}\n            </div>\n        </div>\n        {#if runningOnIpad}\n            <div class=\"card-text\">\n                <small class=\"text-muted\"><sup>*</sup> Une fois dans l'application mPilot,\n                il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>\n            </div>\n        {/if}\n        <div class=\"text-monospace\">{lidoRoute}\n            {#if copied}\n                <span out:fade>copié!</span>\n            {/if}\n        </div>\n    </div>\n</div>\n\n\n<style>\n    .card {\n        flex: 0 1 auto;\n        min-height: 1px;\n        margin: 0.5rem 1rem;\n    }\n    span {\n        padding: 2px 2px;\n        color: #fff;\n        background-color: #1ea840;\n        border-radius: 3px;\n        position: absolute;\n        right: 0;\n        top: 0;\n    }\n    div.text-monospace {\n        text-align: left;\n        position: relative;\n        padding: 0.5em 1em 0.3em 1em;\n        border: 1px dashed #ccc;\n        max-height: 150px;\n        overflow-y: auto;\n    }\n    textarea {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 2em;\n        height: 2em;\n        padding: 0;\n        border: none;\n        outline: none;\n        box-shadow: none;\n        background: transparent;\n    }\n</style>","/* globals editolido */\nimport {folderName} from './utils';\n\nexport const kmlExportDefaultOptions = {\n  \"routeDisplay\": true,\n  \"routePin\": 0,\n  \"routeColor\": \"FFDA25A8\", /* #A825DAFF */\n  \"alternateDisplay\": true,\n  \"alternatePin\": 0,\n  \"alternateColor\": \"FFFF00FF\", /* #FF00FFFF */\n  \"natDisplay\": true,\n  \"natPin\": 8,\n  \"natColor\": \"80DA25A8\", /* #A825DA80 */\n  \"greatCircleDisplay\": true,\n  \"greatCircleColor\": \"5F1478FF\" /* #FF78145F */\n};\n\nfunction skeleton (kmlGen, kmlOptions) {\n  kmlGen.addFolders(\n    {\"name\": \"greatcircle\", \"enabled\": kmlOptions.greatCircleDisplay, \"color\": kmlOptions.greatCircleColor},\n    //{\"name\": \"ogimet\", \"enabled\": kmlOptions.ogimetDisplay, \"color\": kmlOptions.ogimetColor},\n    {\n        \"name\": \"ralt\",\n        \"enabled\": kmlOptions.alternateDisplay,\n        \"color\": kmlOptions.alternateColor,\n        \"pinId\": kmlOptions.alternatePin\n    },\n    {\"name\": \"rmain\", \"color\": kmlOptions.routeColor, \"pinId\": kmlOptions.routePin},\n    {\"name\": \"rnat\", \"enabled\": kmlOptions.natDisplay, \"color\": kmlOptions.natColor, \"pinId\": kmlOptions.natPin},\n    {\n        \"name\": \"rnat_incomplete\",\n        \"enabled\": kmlOptions.natDisplay,\n        \"color\": kmlOptions.natIncompleteColor,\n        \"pinId\": kmlOptions.natPin\n    }\n  );\n}\n\n/**\n * This is a singleton definition which can be imported  even without lidojs loaded\n */\nexport const KmlGenerator = () => {\n  if (!(window['kmlGen'])) {\n    window['kmlGen'] = new editolido.KMLGenerator();\n    skeleton(window['kmlGen'], kmlExportDefaultOptions);\n  }\n  return window['kmlGen'];\n}\n\n\nexport function updateKml(name, value) {\n  if (!name) {\n    console.error('received an empty name :', name);\n    return;\n  }\n  if (name.startsWith('etops-')\n    || name.startsWith('airport-')\n    || name.startsWith('fir-')\n    || name.endsWith('-change')\n    || name.endsWith('-hide')\n    || name === 'nat-incomplete-color'\n    || name === 'nat-pin-position'\n    || name.startsWith('ogimet-')) return;\n  const kmlGen = KmlGenerator();\n  const folder = folderName(name);\n  if (name.endsWith('-display')) {\n      kmlGen.changeFolderState(folder, value);\n  }else if (name.endsWith('-pin')) {\n      kmlGen.changeFolderPin(folder, value);\n  }else if (name.endsWith('-color')) {\n      kmlGen.changeFolderColor(folder, value.toUpperCase());\n  }else{\n      console.error(`ignoring kml update for ${name}`);\n  }\n}\n/**\n * skeleton to generate kml for an OFP\n * @param ofp: Ofp\n * @param kmlGen: KmlGenerator\n * @param options: {}\n * @returns {string|Source|ConcatSource}\n */\nexport function generateKML(ofp, options) {\n    let kmlOptions = {...kmlExportDefaultOptions, ...options};\n    const kmlGen = KmlGenerator();\n    skeleton(kmlGen, kmlOptions); //perform reset also\n    const description = ofp.description;\n    kmlGen.setName(description);\n    if (!ofp) return;\n    const routeName = `${ofp.infos.depICAO}-${ofp.infos.destICAO}`;\n    const route = new editolido.Route(ofp.wptCoordinates(), {\"name\": routeName, \"description\": description});\n    const alternateRoute = new editolido.Route(ofp.wptCoordinatesAlternate(), {\"name\": \"Route Dégagement\"});\n    const greatCircle = new editolido.Route([route.points[0], route.points[route.points.length - 1]]).split(300, {\"name\": `Ortho ${routeName}`});\n    let natmarks = [];\n    for (let track of ofp.tracks) {\n      let folder = track.isComplete ? 'rnat' : 'rnat_incomplete';\n      kmlGen.addLine(folder, track);\n      let p = new editolido.GeoPoint(track.points[0], {\"name\": track.name, \"description\": track.description});\n      kmlGen.addPoint(folder, p);\n      if (track.isMine) {\n        natmarks.push(p);\n        p = new editolido.GeoPoint(track.points[track.points.length - 1], {\"name\": track.name, \"description\": track.description});\n        natmarks.push(p);\n        kmlGen.addPoint(folder, p);\n      }\n    }\n    kmlGen.addLine('greatcircle', greatCircle);\n    kmlGen.addLine('rmain', route);\n    kmlGen.addPoints('rmain', route, {'excluded': natmarks});\n    kmlGen.addLine('ralt', alternateRoute);\n    //kmlGen.addLine('ogimet', ofp.ogimetData.route);\n    kmlGen.addPoints('ralt', alternateRoute);\n}","<script context=\"module\">\n    import {debounce} from '../utils.js';\n    export const kmlRegex = /^[A-F0-9]{8}$/i;\n    export const splitKmlColor = (v) => {\n        return [v.slice(6,8), v.slice(4,6), v.slice(2, 4), v.slice(0, 2)]\n    }\n    export const kml2hexa = (v) => {\n        const [r, g, b, a] = splitKmlColor(v);\n        return \"#\" + r + g + b + a;\n    }\n    export const kml2rgba = (v) => {\n        let [r, g, b, a] = splitKmlColor(v).map((v) => parseInt(v, 16));\n        return `rgba(${r}, ${g}, ${b}, ${a / 255.0})`;\n    }\n    export const kml2mapColor = (v) => {\n        let [hex, range] = kml2swatch(v);\n        return [hex, range / 255.0];\n    }\n    export const defaultSwatch = [\"#FF0000\", 255];\n    export const kml2swatch = (v) => {\n        try{\n            const range = parseInt(v.slice(0,2), 16);\n            const hex = \"#\" + v.slice(6,8) + v.slice(4,6) + v.slice(2,4);\n            return [hex, range];\n        }catch(err){\n            console.error(`invalid KML color ${v}`);\n            return defaultSwatch;\n        }\n    };\n    export const pickerStyle = (hex) => {\n        const [r, g, b] = [hex.slice(1, 3), hex.slice(3, 5), hex.slice(5, 7)].map((v) => parseInt(v, 16));\n        return `--range-red: ${r}; --range-green: ${g}; --range-blue: ${b};`;\n    };\n    export const swatchStyle = (swatch) => {\n        return `background-color: ${swatch[0]}; opacity: ${swatch[1]/255.0}`\n    };\n    const options = [\n        {label: 'Aucun repère', color: '#FFFFFF'},\n        {label: 'Bleu', color: '#6699FF'},\n        {label: 'Jaune', color: '#FFFF00'},\n        {label: 'Marron* (Rouge pour Avenza/Earth)', color: '#CC9966'},\n        {label: 'Orange', color:'#FF9922'},\n        {label: 'Rose* (Rouge pour Avenza)', color: '#DD5599'},\n        {label: 'Rouge', color: '#FF0000'},\n        {label: 'Vert', color: '#22DD44'},\n        {label: 'Violet', color: '#BB11EE'}\n    ];\n</script>\n<script>\n    import { createEventDispatcher } from 'svelte';\n    const dispatch = createEventDispatcher();\n    export let kmlColor = \"FF0000FF\";\n    export let selected = 0;\n    export let name;\n    const colorName = name + '-color';\n    const pinName = name + '-pin';\n    const debounceDelay = 500;\n    let swatch = defaultSwatch;\n\n    const debounceDispatch = (debounceDelay > 0) ? debounce(dispatch, debounceDelay) : dispatch;\n    function changeKmlColor(node) {\n        return {\n            update(swatch) { /* color was changed */\n                const [hex, range] = swatch;\n                /* kmlColor is abgr */\n                kmlColor = (range.toString(16) + hex.slice(5,7) + hex.slice(3,5) + hex.slice(1, 3)).toUpperCase();\n                debounceDispatch(\"change\", {\"name\": colorName, \"value\": kmlColor});\n            }\n        }\n    }\n    function changeSwatch(node) {\n        swatch = kml2swatch(kmlColor);\n        return {\n            update(kmlColor) { /* kmlColor was changed */\n                swatch = kml2swatch(kmlColor);\n                debounceDispatch(\"change\", {\"name\": colorName, \"value\": kmlColor.toUpperCase()});\n            }\n        }\n    }\n</script>\n\n<kmlcolor class=\"input-group\" use:changeSwatch={kmlColor}>\n    <pin class=\"form-control\">\n        <svg>\n            <use xlink:href=\"#marker-symbol\" style=\"stroke: {(selected === 0) ? '#fff': options[selected].color }; fill: {options[selected].color};\"></use>\n        </svg>\n    </pin>\n    <!-- svelte-ignore a11y-no-onchange -->\n    <select name=\"{pinName}\" bind:value={selected} class=\"form-select\" on:change={(e) => {e.target.blur(); dispatch(\"change\", {name: pinName, 'value': selected})}}>\n        {#each options as option, index}\n        <option value=\"{index}\" selected={index === selected}>{option.label}</option>\n        {/each}\n    </select>\n    <picker class=\"form-control\" style=\"{pickerStyle(swatch[0])}\">\n        <label use:changeKmlColor={swatch} style=\"{swatchStyle(swatch)}\">\n            <input bind:value={swatch[0]} type=\"color\"/>\n        </label>\n        <input bind:value={swatch[1]} type=\"range\" min=\"30\" max=\"255\">\n    </picker>\n\n</kmlcolor>\n\n<style>\n    :global(picker input[type=\"color\"]) {\n        opacity: 0;\n        width: 0;\n        height: 0;\n    }\n    :global(picker input[type=\"range\"]) {\n        appearance: none;\n        -webkit-appearance: none;\n        -moz-appearance: none;\n        width: var(--color-swatch-width);\n        padding: 0;\n        height: 14px;\n        align-self: center;\n    }\n    :global(picker input[type=range]:focus) {\n        outline: none;\n    }\n    :global(picker input[type=range]::-webkit-slider-runnable-track) {\n        width: 100%;\n        height: 4px;\n        cursor: pointer;\n        background: linear-gradient(90deg, rgba(var(--range-red), var(--range-green), var(--range-blue), 0.12), rgba(var(--range-red), var(--range-green), var(--range-blue), 1));\n    }\n    :global(picker input[type=range]::-webkit-slider-thumb) {\n        box-shadow: 1px 1px 1px #000000, 0 0 1px #0d0d0d;\n        border: 1px solid #cccccc;\n        height: 12px;\n        width: 15px;\n        border-radius: 3px;\n        background: transparent;\n        cursor: pointer;\n        -webkit-appearance: none;\n        margin-top: -4.5px;\n    }\n    :global(picker input[type=range]:focus::-webkit-slider-runnable-track) {\n        background: linear-gradient(90deg, rgba(var(--range-red), var(--range-green), var(--range-blue), 0.12), rgba(var(--range-red), var(--range-green), var(--range-blue), 1));\n    }\n    :global(picker input[type=range]::-moz-range-track){\n        width: 100%;\n        height: 4px;\n        cursor: pointer;\n        background: linear-gradient(90deg, rgba(var(--range-red), var(--range-green), var(--range-blue), 0.12), rgba(var(--range-red), var(--range-green), var(--range-blue), 1));\n    }\n    :global(picker input[type=range]::-moz-range-thumb) {\n        box-shadow: 1px 1px 1px #000000, 0 0 1px #0d0d0d;\n        border: 1px solid #cccccc;\n        height: 12px;\n        width: 15px;\n        border-radius: 3px;\n        background:transparent;\n        cursor: pointer;\n    }\n\n    :global(kmlcolor) {\n        --color-swatch-width: 3em;\n        --color-swatch-height: 1.1em;\n    }\n\n    :global(picker) {\n        --range-red: 255;\n        --range-green: 0;\n        --range-blue: 255;\n\n    }\n    :global(.input-group>picker.form-control) {\n        flex: 0 0 90px;\n        display: flex;\n        flex-direction: column;\n        padding: 0;\n        justify-content: space-between;\n    }\n    /* label is used because it triggers the color input everywhere */\n    :global(kmlcolor picker > label) {\n        align-self: center;\n        height: var(--color-swatch-height);\n        width: var(--color-swatch-width);\n        border: 1px solid #ccc;\n        border-radius: 2px;\n        margin-bottom: 0;\n    }\n    :global(kmlcolor select, kmlpin select) {\n        border-left: 20px solid #FFFFFF !important;\n        padding-left: 0.2rem !important;\n    }\n    :global(kmlcolor pin, kmlpin pin) {\n        background-color: white !important;\n        padding: 0 0 0 0.2rem !important;\n        border-right: 0 !important;\n    }\n    pin {\n        flex:0 0 20px !important;\n        padding: 0 2px !important;\n        margin-left: -2px;\n        align-items: center !important;\n        display: flex !important;\n        position: absolute !important;\n        width: 20px !important;\n        z-index: 4;\n        height: 100%;\n    }\n    :global(kmlcolor pin svg, kmlpin pin svg){\n        stroke: white;\n        fill: white;\n        height: 1.1rem;\n        width: 1.1rem;\n    }\n\n</style>\n","import {kmlRegex} from './ColorPinCombo.svelte';\n\nexport const kmlDefaultOptions = {\n    \"routeDisplay\": true,\n    \"routeColor\": \"FFDA25A8\", /* #A825DAFF */\n    \"alternateDisplay\": true,\n    \"alternateColor\": \"FFFF00FF\", /* #FF00FFFF */\n    \"natDisplay\": true,\n    \"natPinPosition\": 0,\n    \"natColor\": \"80858585\", /* \"80DA25A8\" */\n    \"natIncompleteColor\": \"FF0000FF\", /* #FF0000FF */\n    \"greatCircleDisplay\": true,\n    \"greatCircleColor\": \"5F1478FF\", /* #FF78145F */\n    \"ogimetDisplay\": true,\n    \"ogimetColor\": \"40FF0000\", /* #0000FF40 */\n    \"airportDisplay\": true,\n    \"airportPin\": 0,\n    \"airportLabel\": 0,\n    \"firDisplay\": true,\n    \"firHide\": \"\",\n    \"etopsDisplay\": true,\n    \"etopsColor\": \"FF0324FC\", /* #FC2403FF */\n    \"iconTextChange\": '1.0',\n    \"lineWidthChange\": '1.0',\n    \"iconSizeChange\": '1.0'\n};\n\nclass Storage {\n    constructor() {}\n    getItem(key) {\n        const value = localStorage.getItem(key);\n        if (value !== null) {\n            try {\n                return JSON.parse(value);\n            } catch (err) {\n                this.removeItem(key);\n                console.log(`invalid json in ${key}`);\n            }\n        }\n        return null;\n    }\n    setItem(key, value) {\n        const toSave = JSON.stringify(value);\n        if (toSave !== '{}') {\n            localStorage.setItem(key, toSave);\n        }\n    }\n    removeItem(key) {\n        localStorage.removeItem(key);\n    }\n    hasItem(key) {\n        return localStorage.getItem(key) !== null;\n    }\n}\nexport const stores = Object.freeze({\n    \"optionsKML\": \"optionsKML\",\n    \"shortcut\": \"shortcut\",\n    \"downloadType\": \"downloadType\",\n    \"exportKML\": \"exportKML\",\n    \"focusKML\": \"focusKML\",\n    \"changelogOnUpdate\": \"changelogOnUpdate\"\n});\n\nexport const storage = new Storage();\n\nexport const validate = (options, defaultOptions=kmlDefaultOptions) => {\n    const validated = {};\n    for (let [key, value] of Object.entries(options)) {\n        if (key in defaultOptions) { \n            if (key.endsWith('Pin')) {\n                value *= 1; // coalesce to number or NaN\n                if (!isNaN(value)) {\n                    validated[key] = value;\n                }\n            } else if (key.endsWith('Color') && value.match(kmlRegex)) {\n                validated[key] = value.toUpperCase();\n            } else if (key.endsWith('Display')) {\n                validated[key] = !!(value); //coerce to boolean\n            } else if (key.endsWith('Change')) {\n                value *= 1; // coalesce to number or NaN\n                if (!isNaN(value)) {\n                    validated[key] = value.toFixed(1);\n                }\n            }else if (key.endsWith('Hide')) {\n                validated[key] = value.toString().trim();\n            }\n        }\n    }\n    return {...defaultOptions, ...validated};\n};\n\n\nexport const setHistory = (kmlOptions, route, name=\"Mon OFP2MAP\") => {\n    const options = {};\n    const includedStores = [\"optionsKML\", \"shortcut\", \"downloadType\"];\n    for (const [key, store] of Object.entries(stores)) {\n        if (!includedStores.includes(store)) continue;\n        let value = storage.getItem(store);\n        if (key === stores.optionsKML && kmlOptions) {\n            const diff = {};\n            for (const key of Object.keys(kmlOptions).filter(k => kmlOptions[k] !== kmlDefaultOptions[k])){\n                diff[key] = kmlOptions[key];\n            }\n            value = diff;\n        }\n        if (value !== null) {\n            if (key === stores.optionsKML) {\n                for (const[k, v] of Object.entries(value)) {\n                    options[k] = v;\n                }\n            } else {\n                options[key] = value;\n            }\n        }\n    }\n    const query = Object.entries(options)\n        .map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n        .join(\"&\");\n    const permalink =\n        window.location.origin +\n        window.location.pathname +\n        (query ? \"?\" + query : \"\") +\n        '#' + route;\n    window.history.replaceState(options, name, permalink);\n};\n\nexport const storeSettingsFromURL = (url) => {\n    const rawData = {}\n    const validated = {}\n    if (url.length > 1) {\n        const query = url.substr(1) || \"\";\n        query.split(\"&\").forEach(function(part) {\n            const item = part.split(\"=\");\n            rawData[decodeURIComponent(item[0])] = decodeURIComponent(item[1]);\n        });\n    }\n    for (let [key, value] of Object.entries(rawData)) {\n        if (key in kmlDefaultOptions) {\n            let valid=undefined;\n            if (key.endsWith('Pin')) {\n                value *= 1; // coalesce to number or NaN\n                if (!isNaN(value)) {\n                    valid = value;\n                }\n            } else if (key.endsWith('Color') && value.match(kmlRegex)) {\n                valid = value.toUpperCase();\n            } else if (key.endsWith('Display')) {\n                valid = !!(value); //coerce to boolean\n            } else if (key.endsWith('Change')) {\n                value *= 1; // coalesce to number or NaN\n                if (!isNaN(value)) {\n                    valid = value.toFixed(1);\n                }\n            }\n            if (valid !== undefined) {\n                validated[key] = valid;\n            }\n        }else if (key === 'downloadType') {\n            value *= 1;\n            if (!isNaN(value)) {\n                storage.setItem(stores.downloadType, value);\n            }\n        }else if (key === 'shortcut') {\n            value = value.trim();\n            if (value) {\n                storage.setItem(stores.shortcut, value);\n            }\n        }\n    }\n    storage.setItem(stores.optionsKML, validated);\n}","<script>\n    import {KmlGenerator} from \"./kml.js\";\n    import {runningOnIpad} from \"./utils.js\";\n    import {storage, stores} from './mapSettings/storage.js';\n    import {ofp} from '../stores';\n    import { createEventDispatcher } from 'svelte';\n    const dispatch = createEventDispatcher();\n    const store = stores.shortcut;\n    const defaultValue = \"OFP2MAP\";\n    let shortcutName = storage.getItem(store) || defaultValue;\n    $: disabled = !(shortcutName.trim() && runningOnIpad)\n    let url;\n    const lidoRoute = (!!$ofp) ? $ofp.lidoRoute(false).join(' ') : '';\n    function click(e) {\n        const name = shortcutName.trim();\n        if (name && runningOnIpad) {\n            const kmlGen = KmlGenerator();\n            const obj = {\n                \"lidoRoute\": lidoRoute,\n                \"kml\": kmlGen.render(),\n                \"kmlAvenza\": kmlGen.render({\n                    \"template\": editolido.avenzaTemplate,\n                    \"styleTemplate\": editolido.avenzaStyleTemplate,\n                    \"iconTemplate\": editolido.avenzaIconTemplate,\n                    \"icons\": editolido.AVENZAICONS\n                }),\n                \"kmlGoogleEarth\": kmlGen.render({\n                    \"styleTemplate\": editolido.googleEarthStyleTemplate\n                }),\n                \"grametProxyURL\": $ofp.ogimetData.proxyImg\n            };\n            url = \"shortcuts://run-shortcut?name=\" + encodeURIComponent(name) + \"&input=text&text=\" + encodeURIComponent(JSON.stringify(obj));\n        } else {\n            e.preventDefault();\n        }\n    };\n    function save() {\n        const name = shortcutName.trim();\n        if (name === defaultValue) {\n            storage.removeItem(store);\n        } else {\n            storage.setItem(store, name);\n        }\n        dispatch('save', [store, name]);\n    };\n</script>\n\n<div class=\"input-group\">\n    <span class=\"input-group-text\"></span>\n    <input class=\"form-control\" placeholder=\"Nom du raccourci\" type=\"text\" bind:value={shortcutName} on:change={save}>\n    <div class=\"input-group-text\" class:disabled>\n    <a class:disabled href={url} on:click={click} >Lancer</a>\n    </div>\n</div>\n\n<style>\nspan {\n    background-repeat: no-repeat;\n    background-size: contain;\n    background-position: center;\n    background-color: #1b1e5b;\n    border-color: #1b1e5b;\n    background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAAXNSR0IArs4c6QAABK9JREFUSMe1VjuPHEUQrkf3zM7ePm6958dhH2djwGBkIyHeQoiIH0EAIiQg4wcQkTogIoMIRICEQEIgQQASCAJbxsIW+M68hM/n85ndmd2dnemuKgKDEHdrn0FHqYNSd6s+ler7qgqXlp8DQAAzAIQ/bUd/1uXsIPSX//fD7fizLmcHIfifzd3+VzENqgDgiBzSbgIoWFC5a27hxPwiApwbrK2Or3lkQtwFgGjqkV8++viLhx/tpS1D2gjjt3765o3Vr4LKjqlwd/7ELZ6nKouN1qnjzzx/6ASZ1VpPNTiCR/p3Hm3tOf375TxM+ZYYNwUwgFL0iV7/jQeefKy7t5RaIAqIWKw0TGR6R7PzUG9xZXT98rRgJPxXAGIQzF44uP/UfccPJH6qtYKoiUCMFmsNldZFrDzzyd7+PFQ/jYeIgIC3BRANGoSv3tN/5cg+Ro0WDcTgRvRQW6g0lBomUuWxKjUebs8z48+jXExxW9m3FlkN2g5ffyB7ts+l5AYpYGqWKCQCLpqrjSrFUmGsNhYZiuYS7+32BeyLtV+iKd4aoFJ46ZA9u68uwwgwAQhmtWIq4KO5Gl2tXCpMBMdihVghkseYi3TTZKndXh0O+J9JbKcpLmYRSIAULJpFxaAQxHzERsC0YiojjmM1iqEQy6MVIkWUUmWmKrYyjNHeu0yDGL2rlGqlqeJEcBKpClRVHEqWspGMu/OF46KeFLEswnQk1bAu18dj2lbnrUVmhF9K/Danx/vSS7QGE4KIVCNMESZII+Qcfe6bg/beoUKeXx9L/L2OK4PhKMTtbJ3BIoewOqJPN+hYW5fntEKqESvEEnmMnJMfcjqgbOhag95SkbbXr/x6cXNzIjpTC7N1wGAD8J/5fa2GO5ZUFeIEeUJuRElB6ZCzgWsOea7g5sX5+3/o3K1XL3E5AOKZACe3aljNdbL2XXut0/zcetc4O86lEuXsC05zzgaumXN2ndtn+eCPOG/dg7r8MOVXaLgGRDtkYGauk3XuP+BaCTU8Z/6c653383diSBBy1yhco+DsN7fwdbq85nvICSBBoyvLD9P69zTagH+2Jre9NTcPdRsLmQKoc8qOmc/zntdo4TEt+mAD6qz4Axf80gQzDyBACg4MLG3Fe57mtQtbiLkVwMzANO03VE2IhVnJMVNJjU+oB5gKNCPOGZAHFVA1Q0M1Ngc43tx5HhDTaHWzdWS+fd9CFIvIQixEgMBoAiagbCIgYgImZhFMDFP+4Yz/7mNgv9PAQdBa1j5ZkSh7nlpyALURAiICgRIYmqIKWESNqAEhQRH+5kP/xbsQw85FBgBENIXRxc04Du0H+77jzCMmCAmhJ/SMjv48iYe6ho/e5S8/BLDt0W+qA0RAwvLn4eTSYO54L1nMjAw8oEN0SI7IEaZe1zfC2+/AhbPgPdxkPs/Qwd8wTPW1sjh9NT2YZcfawAAMyIAJUYPDmZXJmx/Y+lXw/r/PZGTUMhZfr1uU7N4Wdx161HFVvH+ueOcrmNbg+NZDH5eWn9t5bzHQoMlis3G0Y4bVpTxcGaEj2JW15Qa1KKGwUYa1yY12iJ53f7NDQkgQ/qX9v7upAZBtXZZ30xDwD7OghDZGs+a6AAAAAElFTkSuQmCC\");\n}\n\ndiv.input-group-text {\n    border-color: #1b1e5b;\n    background-color: #1b1e5b;\n}\na {\n    color: var(--bs-white);\n    text-decoration: none;\n    display: inline-block;\n    text-align: center;\n    font-variant-caps: all-small-caps;\n    min-width:122px;\n    cursor:pointer;\n}\na.disabled {\n    cursor: not-allowed;\n}\ninput {\n    border-color: #1b1e5b;\n}\n</style>","import {focusMap} from '../components/utils';\n\nexport default function blurAction(node) {\n    // const observer = new IntersectionObserver((entries) => { \n    //     entries.forEach(entry => {\n    //     if(entry.intersectionRatio!==1){\n    //         node.blur();\n    //     }\n    // });\n    // }, {threshold: 1});\n    // observer.observe(node);\n    const handleVisibilityChange = () =>{\n        if (document && document.visibilityState && document.visibilityState !== 'visible') {\n            if(node && node.blur) {\n                node.blur();\n                focusMap();\n            }\n        }\n    };\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange, false);\n\n    return {\n        destroy() {\n            // observer.unobserve(node);\n            // observer.disconnect();\n            document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n        }\n    }\n}","<script context=\"module\">\n    const options = ['KML Mapsme', 'KML Avenza', 'KML Google Earth'];\n    const optionColors = ['bs-green', 'bs-purple', 'bs4-cyan']\n</script>\n<script>\n    import {KmlGenerator} from './kml.js';\n    import {storage, stores} from './mapSettings/storage.js';\n    import { createEventDispatcher, onMount } from 'svelte';\n    import blurAction from \"../actions/blurAction\";\n    const dispatch = createEventDispatcher();\n\n    export let label;\n    const store = stores.downloadType;\n    const defaultValue = 1;\n    let selected = storage.getItem(store) || defaultValue;\n    if (typeof selected === 'string') selected = parseInt(selected, 10);\n    if (selected < 0 || selected >= options.length) selected = 0;\n    let url = \"\";\n    let filename = \"\";\n    let cssRoot;\n    const setCssColor = (value) => {\n        cssRoot.style.setProperty('--color', `var(--${optionColors[selected]})`);\n    }\n    const blobURL = (data, type=\"application/vnd.google-earth.kml+xml\")  => {\n        const blob = new Blob( data, { type });\n        return URL.createObjectURL(blob);\n    }\n\n    const download = function (e) {\n        const kmlGen = KmlGenerator();\n        const extensions = ['_mapsme.kml', '_avenza.kml', '_googleearth.kml']\n        const extension = extensions[selected];\n        let str = kmlGen.name;\n        if (!str) {\n            console.log(\"can not compute filename\");\n            filename = \"editolido\" + extension;\n        } else {\n            str = str.trim();\n            filename = str.replace(/[ \\/]/g, \"_\").replace(/:/g, '') + extension;\n        }\n        if (url && url.startsWith('blob:')) URL.revokeObjectURL(url);\n        if (selected === 0) {\n            url = blobURL([kmlGen.render()]);\n        } else if (selected === 1) {\n            url = blobURL([kmlGen.render({\n                \"template\": editolido.avenzaTemplate,\n                \"styleTemplate\": editolido.avenzaStyleTemplate,\n                \"iconTemplate\": editolido.avenzaIconTemplate,\n                \"icons\": editolido.AVENZAICONS\n            })]);\n        } else if (selected === 2) {\n            url = blobURL([kmlGen.render({\n                \"styleTemplate\": editolido.googleEarthStyleTemplate\n            })]);\n        } else {\n            e.preventDefault();\n            return false;\n        }\n        //This will be interesting with navigator.canShare (Web Share API level 2)\n        // if (navigator.share && (selected === 0 || selected === 1)) {\n        //     navigator.share({\n        //         \"title\": options[selected],\n        //         url\n        //     });\n        //     e.preventDefault();\n        // }\n    };\n    function save(e) {\n        e.target.blur();\n        if (selected === defaultValue){\n            storage.removeItem(store);\n        } else {\n            storage.setItem(store, selected);\n        }\n        dispatch(\"save\", [store, selected]);\n        setCssColor();\n    }\n    onMount(() => {\n        setCssColor();\n        return () => {\n            if (url && url.startsWith('blob:')) URL.revokeObjectURL(url);\n        };\n    });\n</script>\n\n<div bind:this={cssRoot} class=\"input-group\">\n  <!-- svelte-ignore a11y-no-onchange -->\n  <select bind:value={selected} class=\"form-select choice{selected}\"aria-label=\"Example select with button addon\" on:change={save} use:blurAction>\n    <option selected={selected === 0} value=\"{0}\">{options[0]}</option>\n    <option selected={selected === 1} value=\"{1}\">{options[1]}</option>\n    <option selected={selected === 2} value=\"{2}\">{options[2]}</option>\n  </select>\n  <div class=\"input-group-text\">\n      <!-- Using the download attribute in standalone mode makes the app to lost the ofp on return (last check on iPadOS 14.4)-->\n    <a class=\"\" download={filename} href={url} on:click={download}>{label}</a>\n  </div>\n</div>\n<style>\n    div.input-group {\n        --color: var(--bs-green);\n    }\n    select {\n        border-color: var(--color);\n    }\n    a, .input-group-text {\n        background-color: var(--color);\n        border-color: var(--color);\n    }\n    a {\n        color: var(--bs-white);\n        text-decoration: none;\n        display: inline-block;\n        text-align: center;\n        font-variant-caps: all-small-caps;\n        min-width:122px;\n    }\n</style>","<script context=\"module\">\n    import {debounce} from '../utils.js';\n    import {kml2swatch, pickerStyle, swatchStyle, defaultSwatch} from './ColorPinCombo.svelte';\n\n</script>\n<script>\n    import { createEventDispatcher } from 'svelte';\n    const dispatch = createEventDispatcher();\n    export let kmlColor = \"FF0000FF\";\n    export let checked;\n    export let name;\n    const colorName = name + '-color';\n    const displayName = name + '-display';\n    const debounceDelay = 500;\n    let swatch = defaultSwatch;\n    const debounceDispatch = (debounceDelay > 0) ? debounce(dispatch, debounceDelay) : dispatch;\n    function changeKmlColor(node) {\n        return {\n            update(swatch) { /* color was changed */\n                const [hex, range] = swatch;\n                /* kmlColor is abgr */\n                kmlColor = (range.toString(16) + hex.slice(5,7) + hex.slice(3,5) + hex.slice(1, 3)).toUpperCase();\n                debounceDispatch(\"change\", {\"name\": colorName, \"value\": kmlColor});\n            }\n        }\n    }\n    function changeSwatch(node) {\n        swatch = kml2swatch(kmlColor);\n        return {\n            update(kmlColor) { /* kmlColor was changed */\n                swatch = kml2swatch(kmlColor);\n                debounceDispatch(\"change\", {\"name\": colorName, \"value\": kmlColor.toUpperCase()});\n            }\n        }\n    }\n</script>\n\n<kmlcolor class=\"input-group checkbox-combo\" use:changeSwatch={kmlColor}>\n    <label for=\"{displayName}\" class=\"form-control\"><input name=\"{displayName}\" checked={checked} type=\"checkbox\" on:change/><slot>Couleur</slot></label>\n    <picker class=\"form-control\" style=\"{pickerStyle(swatch[0])}\">\n        <label use:changeKmlColor={swatch} style=\"{swatchStyle(swatch)}\">\n            <input bind:value={swatch[0]} type=\"color\" />\n        </label>\n        <input bind:value={swatch[1]} type=\"range\" min=\"30\" max=\"255\">\n    </picker>\n</kmlcolor>\n\n<style>\n:global(.checkbox-combo label.form-control){\n    display:flex;\n    align-items: center;\n    flex: 1;\n    padding-left: 0;\n    flex-grow: 1;\n    background-color: white;\n    width:auto;\n}\n:global(.checkbox-combo input[type=checkbox]) {\n    margin-left: -1px;\n}\n</style>\n","<script context=\"module\">\n    export const STATUS = 0;\n    export const GREENRED = 1;\n    export const MEDICAL = 2;\n    export const BLUEGREENRED = 3;\n    const options = [\n        {label: 'statuts', id: STATUS},\n        {label: 'vert/rouge', id: GREENRED},\n        {label: 'bleu/vert/rouge', id: BLUEGREENRED},\n        {label: 'médical', id: MEDICAL},\n    ];\n    export const ICAO = 0;\n    export const IATA = 1;\n    const labels = [\n        {label: 'ICAO', id:ICAO},\n        {label: 'IATA', id:IATA},\n    ];\n</script>\n<script>\n    import { createEventDispatcher } from 'svelte';\n    import blurAction from '../../actions/blurAction';\n    const dispatch = createEventDispatcher();\n    export let selectedPin = STATUS;\n    export let selectedLabel = ICAO;\n</script>\n\n<div class=\"row g-2\">\n    <div class=\"col\">\n        <div class=\"form-floating\">\n            <!-- svelte-ignore a11y-no-onchange -->\n            <select use:blurAction name=\"airport-pin\" bind:value={selectedPin} class=\"form-select\" on:change={(e) => {e.target.blur(); dispatch(\"change\", {name: 'airport-pin', 'value': selectedPin})}}>\n                {#each options as option (option.id)}\n                <option value=\"{option.id}\" selected={option.id === selectedPin}>{option.label}</option>\n                {/each}\n            </select>\n            <label for=\"airport-pin\">Style</label>\n        </div>\n    </div>\n    <div class=\"col\">\n        <div class=\"form-floating\">\n            <!-- svelte-ignore a11y-no-onchange -->\n            <select use:blurAction name=\"airport-label\" bind:value={selectedLabel} class=\"form-select\" on:change={(e) => {e.target.blur(); dispatch(\"change\", {name: \"airport-label\", 'value': selectedLabel})}}>\n                {#each labels as option (option.id)}\n                <option value=\"{option.id}\" selected={option.id === selectedLabel}>{option.label}</option>\n                {/each}\n            </select>\n            <label for=\"airport-label\">Noms</label>\n        </div>\n    </div>\n</div>\n\n<style>\n    /* select {\n        border-left: 1px;\n        padding-left: 0.2rem;\n    } */\n    .col, .row {\n        margin-top: 0;\n    }\n    label {\n        width: 5em;\n    }\n</style>","<script context=\"module\">\n    import {debounce} from '../utils.js';\n</script>\n<script>\n    import { createEventDispatcher} from 'svelte';\n    const dispatch = createEventDispatcher();\n    export let name;\n    export let label;\n    export let value;\n    export let min = 0.6;\n    export let max = 2.0;\n    export let step = 0.1;\n    export let decimals = 1;\n\n    const debounceDispatch = debounce(dispatch, 100);\n\n    const increment = () => {\n        const previousValue = value;\n        value = Math.min(Math.max(parseFloat(value) + step, min), max).toFixed(decimals);\n        if (value !== previousValue) {\n            debounceDispatch('change', {name, value});\n        }\n    };\n    const decrement = () => {\n        const previousValue = value;\n        value = Math.min(Math.max(parseFloat(value) - step, min), max).toFixed(decimals);\n        if (value !== previousValue) {\n            debounceDispatch('change', {name, value});\n        }\n    };\n\n</script>\n\n<div class=\"input-group input-group-sm mb-2\">\n    <label for=\"{name}\" class=\"input-group-text\">{label}</label>\n    <button class=\"form-control\" type=\"button\" on:click={decrement}><svg class=\"zoom\"><use xlink:href=\"#zoom-out-symbol\"></use></svg></button>\n    <div class=\"form-control\">{value}</div>\n    <button class=\"form-control\" type=\"button\" on:click={increment}><svg class=\"zoom\"><use xlink:href=\"#zoom-in-symbol\"></use></svg></button>\n</div>\n<style>\n    div.form-control {\n        text-align: center;\n        padding-left: 0;\n        padding-right: 0;\n        flex: 1;\n    }\n    button.form-control{\n        flex: 0 0 3em;\n    }\n    label {\n        width: 5em;\n    }\n    :global(svg.zoom) {\n        width: 16px;\n        height: 16px;\n    }\n</style>\n","/** Dispatch event on click outside of node */\nexport default function clickOutside(node) {\n    //console.log('click outside installed')\n    const handleClick = event => {\n        if (node && !node.contains(event.target) && !event.defaultPrevented) {\n            node.dispatchEvent(\n                new CustomEvent('click_outside', {\n                    detail: {\n                        origin: node,\n                        target: event.target\n                    }\n                })\n            );\n            //console.log('click outside')\n        }\n    }\n\n    document.addEventListener('click', handleClick, true);\n\n    return {\n        destroy() {\n            document.removeEventListener('click', handleClick, true);\n            //console.log('click outside removed')\n        }\n    }\n}","\nexport function jsonPoint(lngLat, properties={}) {\n    const json = {\n        'type': 'Feature',\n        'geometry': {\n            'type': 'Point',\n            'coordinates': [lngLat[0], lngLat[1]]\n        },\n        properties\n    };\n    return json;\n}\n\nexport function featureCollection(features) {\n    return {\n        'type': 'geojson',\n        'data': {\n            'type': 'FeatureCollection',\n            'features': features\n        }\n    };\n}\n\nexport function jsonLine(coordinates, properties={}) {\n    const json = {\n        'type': 'Feature',\n        'geometry': {\n            'type': 'LineString',\n            'coordinates': coordinates\n        },\n        properties\n    };\n    return json;\n}\n","import {jsonLine, jsonPoint, featureCollection} from './json';\nimport {folder2prefix} from '../utils';\nimport {kml2mapColor, splitKmlColor} from \"../mapSettings/ColorPinCombo.svelte\";\n\nexport const pinColors = [\n    '#FFFFFF', '#6699FF', '#FFFF00',\n    '#CC9966', '#FF9922', '#DD5599',\n    '#FF0000', '#22DD44', '#BB11EE', '#F56'\n];\nexport const iconTextSizeDefault = 10;\nexport const lineWidthDefault = 2;\nexport const iconSizeDefault = 1;\nexport const iconSizeDefaultNoPin = 0.2;\nexport const minTextOpacityDefault= 0.8;\nexport const haloTextSizeThreshold =10;\nexport const haloLightColor = \"#f8f9fa\"; //bs-gray-100\nexport const haloDarkColor = \"#212529\"; //bs-dark\nexport const haloTextBlur = ({ratio, size=iconTextSizeDefault, extraFactor=1}) => {\n    const textSize = computeIconTextSize(ratio, size, extraFactor);\n    return (textSize >= haloTextSizeThreshold) ? textSize/2 : 0;\n};\nexport const haloTextWidth = ({ratio, size=iconTextSizeDefault, extraFactor=1}) => {\n    const textSize = computeIconTextSize(ratio, size, extraFactor);\n    return textSize / 4;\n};\nexport const getContrastColor = (kmlColor, opacityProperty) => {\n    const [R, G, B,] = splitKmlColor(kmlColor).map((v) => parseInt(v, 16));\n    const A = opacityProperty;\n    const brightness = R * 0.299 + G * 0.587 + B * 0.114 + (1 - A) * 255;\n    return brightness > 186 ? haloDarkColor : haloLightColor;\n}\nexport const geoPoints2LngLats = (data, affine, cb) => {\n    let lngLats = [];\n    const len = data.length;\n    for (let i = 0; i < len; i++) {\n        const newPair = (affine) ? affine([data[i].longitude, data[i].latitude]) : [data[i].longitude, data[i].latitude];\n        if (newPair) lngLats.push((cb) ? cb(newPair, data[i]) : newPair);\n    }\n    return lngLats;\n}\n\nexport const computeIconSize = (ratio, size=iconSizeDefault, extraFactor=1) => {\n    const result = ratio * size * ((ratio > 1) ? extraFactor : 1);\n    if (isNaN(result)) return 1;\n    return result;\n}\nexport const computeIconTextSize = (ratio, size=iconTextSizeDefault, extraFactor=1) => {\n    const result = ratio * size * ((ratio > 1) ? extraFactor : 1);\n    if (isNaN(result)) return iconTextSizeDefault;\n    return result;\n}\nexport const computeLineWidthSize = (ratio, size=lineWidthDefault) => {\n    const result = ratio * size;\n    if (isNaN(result)) return 1;\n    return result;\n}\n//to increase size of track entry/exit points\nexport const getIconSizeExpression = (iconSize) =>[\"case\", [\"==\", 1, [\"get\", \"overrideTextColor\"]], computeIconSize(iconSize/iconSizeDefault, iconSizeDefaultNoPin * 3), iconSizeDefaultNoPin];\nexport const getIconAnchorExpression = () => 'center';\nexport const getIconImageExpression = () => 'sdf-triangle';\nexport const getIconColorExpression = (color, overrideColor) => (overrideColor) ? [\"case\", [\"==\", 1, [\"get\", \"overrideIconColor\"]], overrideColor, color] : color;\nexport const getTextColorExpression = (color, overrideColor) => (overrideColor) ? [\"case\", [\"==\", 1, [\"get\", \"overrideTextColor\"]], overrideColor, color] : color;\nexport const getOpacityColorExpression = (opacity, overrideOpacity, minOpacity=minTextOpacityDefault) => {\n    if (overrideOpacity) {\n        return [\"case\", [\"==\", 1, [\"get\", \"overrideTextColor\"]], Math.max(overrideOpacity, minOpacity), Math.max(opacity, minOpacity)];\n    }\n    return Math.max(opacity, minOpacity);\n}\nexport const getTextKmlColorExpression = (kmlcolor, overrideKmlColor) => {\n    const [color,] = kml2mapColor(kmlcolor);\n    const [overrideColor,] = (overrideKmlColor) ? kml2mapColor(overrideKmlColor) : [null, null];\n    return getTextColorExpression(color, overrideColor);\n};\nexport const getOpacityKmlColorExpression= (kmlcolor, overrideKmlColor, minOpacity=minTextOpacityDefault) => {\n    const [, opacity] = kml2mapColor(kmlcolor);\n    const [,overrideOpacity] = (overrideKmlColor) ? kml2mapColor(overrideKmlColor) : [null, null];\n    return getOpacityColorExpression(opacity, overrideOpacity, minOpacity)\n};\nexport function addPoints(map, id, data, affine, kmlOptions, minZoom, maxZoom) {\n    const prefix = folder2prefix(id);\n    const visibility = kmlOptions[`${prefix}Display`];\n    const kmlcolor = kmlOptions[`${prefix}Color`];\n    const textSize = computeIconTextSize(kmlOptions[`iconTextChange`]);\n    const iconSize = computeIconSize(kmlOptions[`iconSizeChange`]);\n    map.addSource(`${id}-marker-source`, featureCollection(\n        geoPoints2LngLats(data, affine, (lngLat, geoPoint) => jsonPoint(lngLat, {title: geoPoint.name.replace(/00\\.0/g,'')}))\n    ));\n    map.addLayer(markerLayer(id, kmlcolor, visibility, textSize, iconSize, minZoom, maxZoom));\n}\n\nexport function addLine(map, id, data, affineLine, kmlcolor, visibility, lineWidth, dashes) {\n    if (affineLine) {\n        map.addSource(`${id}-line-source`, featureCollection(affineLine(data).map(l =>jsonLine(l))));\n    } else {\n        map.addSource(`${id}-line-source`, {\n            'type': 'geojson',\n            'data': jsonLine(data.map(g => [g.longitude, g.latitude]))\n        });\n    }\n    map.addLayer(lineLayer(id, kmlcolor, visibility, lineWidth, dashes));\n}\n\nexport function addLines(map, id, data, affineLine, kmlcolor, visibility, lineWidth, dashes) {\n    if (affineLine) {\n        const len = data.length;\n        const results = [];\n        for (let line=0; line<len; line++) {\n            const sublines = affineLine(data[line]);\n            const sublen = sublines.length;\n            for (let subline = 0; subline < sublen; subline++) {\n                results.push(jsonLine(sublines[subline]))\n            }\n        }\n        map.addSource(`${id}-line-source`, featureCollection(results));\n    }else{\n        map.addSource(`${id}-line-source`, featureCollection(data.map(ar => jsonLine(ar.map(g => [g.longitude, g.latitude])))));\n    }\n    map.addLayer(lineLayer(id, kmlcolor, visibility, lineWidth, dashes));\n}\nexport const interpolateTextSize = (size, minZoom=0, maxZoom=10, magnification =2) => [\n    \"interpolate\", [\"linear\"], [\"zoom\"],\n    // zoom is 5 (or less) -> circle radius will be 1px\n    minZoom, size,\n    // zoom is 10 (or greater) -> circle radius will be 5px\n    maxZoom, size * magnification\n];\nexport function markerLayer (folder, kmlcolor, visibility, textSize, iconSize, minZoom, maxZoom) {\n    const [hexcolor, opacity] = kml2mapColor(kmlcolor);\n    const layer = {\n        'id': `${folder}-marker-layer`,\n        'type': 'symbol',\n        'source': `${folder}-marker-source`,\n        'layout': {\n            'icon-image': getIconImageExpression(),\n            'icon-size': getIconSizeExpression(iconSize),\n            'icon-anchor': getIconAnchorExpression(),\n            'icon-offset': [0, 0],\n            //'icon-rotate': ['get', 'orientation'],\n            'icon-allow-overlap': false,\n            'visibility': ( visibility) ? 'visible' : 'none',\n            'text-field': ['get', 'title'],\n            //'text-font': ['Open Sans Semibold', 'Arial Unicode MS Bold'],\n            'text-size': interpolateTextSize(textSize, minZoom, maxZoom),\n            'text-offset': [0, 0.7],\n            'text-anchor': 'top'\n        },\n        'paint': {\n            'icon-color': getIconColorExpression(hexcolor),\n            'icon-halo-width': 1,\n            'icon-halo-color': '#000',\n            'text-halo-color': haloLightColor,\n            'text-color': getTextColorExpression(hexcolor),\n            'text-opacity': getOpacityColorExpression(opacity)\n        }\n    };\n    return layer;\n}\nexport function lineLayer(folder, kmlcolor, visibility, lineWidth=lineWidthDefault, dashes=false) {\n    const [hexcolor, opacity] = kml2mapColor(kmlcolor);\n    const layer = {\n        'id': `${folder}-line-layer`,\n        'type': 'line',\n        'source': `${folder}-line-source`,\n        'layout': {\n            'line-join': 'round',\n            'line-cap': 'round',\n            'visibility': (visibility) ? 'visible' : 'none'\n        },\n        'paint': {\n            'line-color': hexcolor,\n            'line-opacity': opacity,\n            'line-width': lineWidth,\n            'line-dasharray': (dashes) ? [10, 10] : [1]\n        }\n    }\n    return layer;\n}\nexport function changeIconSizeGeneric(folder, data, iconSize=iconSizeDefault){\n    const {map, value} = data;\n    const markerLayer = `${folder}-marker-layer`;\n    if (map.getLayer(markerLayer)) {\n        map.setLayoutProperty(markerLayer, 'icon-size', getIconSizeExpression(computeIconSize(value, iconSize)));\n    }\n    return true; // allows chaining\n}\nexport function changeIconTextGeneric(folder, data, textSize=iconTextSizeDefault){\n    const {map, value, mapOptions} = data;\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n    const markerLayer = `${folder}-marker-layer`;\n    if (map.getLayer(markerLayer)) {\n        map.setLayoutProperty(markerLayer, 'text-size', interpolateTextSize(computeIconTextSize(value, textSize), minZoom, maxZoom));\n    }\n    return true; // allows chaining\n}\nexport function changeLineWidthGeneric(folder, data, lineWidth=lineWidthDefault){\n    const {map, value} = data;\n    const lineLayer = `${folder}-line-layer`;\n    if (map.getLayer(lineLayer)) {\n        map.setPaintProperty(lineLayer, 'line-width', computeLineWidthSize(value, lineWidth));\n    }\n    return true; // allows chaining\n}\n\nexport function changeLineGeneric(folder, data){\n    const {map, value} = data;\n    const lineLayer = `${folder}-line-layer`;\n    const markerLayer = `${folder}-marker-layer`;\n    const [hexcolor, opacity] = kml2mapColor(value);\n    if (map.getLayer(lineLayer)) {\n        map.setPaintProperty(lineLayer, 'line-color', hexcolor);\n        map.setPaintProperty(lineLayer, 'line-opacity', opacity);\n    }\n    if (map.getLayer(markerLayer)) {\n        const iconImageExpression = map.getLayoutProperty(markerLayer, 'icon-image');\n        const iconImage = Array.isArray(iconImageExpression) ? iconImageExpression.slice(-1).pop() : iconImageExpression;\n        map.setPaintProperty(markerLayer, 'text-color', getTextColorExpression(hexcolor));\n        map.setPaintProperty(markerLayer, 'text-opacity', getOpacityColorExpression(opacity));\n        if (iconImage === 'sdf-triangle') map.setPaintProperty(markerLayer, 'icon-color', getIconColorExpression(hexcolor));\n    }\n    return true; // allows chaining\n}\nexport function changeDisplayGeneric(folder, visibility, data){\n    const {map} = data;\n    const lineLayer = `${folder}-line-layer`;\n    const markerLayer = `${folder}-marker-layer`;\n    if (map.getLayer(lineLayer)) {\n        map.setLayoutProperty(lineLayer, 'visibility', (visibility) ? 'visible' : 'none');\n    }\n    if (map.getLayer(markerLayer)) {\n        map.setLayoutProperty(markerLayer, 'visibility', (visibility) ? 'visible' : 'none');\n    }\n    return true; // allows chaining\n}\n\n","import {addLine, changeDisplayGeneric, changeLineGeneric, changeLineWidthGeneric, computeLineWidthSize} from '../utils';\nexport const ogimetMapIdCondition = (mapOptions) => (mapOptions && (mapOptions.id.startsWith('vb_')||['ed_eqe_physical_fr', 'jb_theworld'].includes(mapOptions.id)));\nconst folder = 'ogimet';\nconst lineWidthOgimet = 1.5;\n\nconst addOgimet = (data) => {\n    const {map, ofp, kmlOptions, mapData, mapOptions} = data;\n    if (!ofp || ogimetMapIdCondition(mapOptions)) return;\n    const visibility = kmlOptions.ogimetDisplay;\n    const {affineAndClip} = mapData;\n    const lineWidth = computeLineWidthSize(kmlOptions['lineWidthChange'], lineWidthOgimet);\n    addLine(map, folder, ofp.ogimetData.route.points, affineAndClip, kmlOptions.ogimetColor, visibility, lineWidth);\n}\n\nexport default {\n    show: changeDisplayGeneric.bind(null, folder, true),\n    hide: changeDisplayGeneric.bind(null, folder, false),\n    add: addOgimet,\n    changeLine: changeLineGeneric.bind(null, folder),\n    changeLineWidth: (data) => changeLineWidthGeneric(folder, data, lineWidthOgimet)\n}","export const firMapIdCondition = (mapOptions) => (mapOptions && (mapOptions.id === 'jb_pacific' || mapOptions.id.startsWith('vb_')));\nconst folder = 'fir-reg';\nconst lineLayer = `${folder}-line-layer`;\nconst orangeStripeLayer = `${folder}-orange-stripe-layer`;\nconst redStripeLayer = `${folder}-red-stripe-layer`;\nconst layers = [orangeStripeLayer, redStripeLayer, lineLayer];\nconst source = `${folder}-source`;\n\nexport const addFirReg = (data) => {\n    const {ofp, map, mapData, kmlOptions, mapOptions} = data;\n    if (!ofp || firMapIdCondition(mapOptions)) return;\n    const {affine} = mapData;\n    const visibility = kmlOptions.firDisplay && !kmlOptions.firHide.includes(mapOptions.id);\n    fetch('data/fir-reg.CONF_AIRAC.geojson')\n    .then(response => response.json())\n    .then(data => {\n        if (affine) {\n            for (let i = 0; i<data.features.length; i++){\n                const points = data.features[i].geometry.coordinates[0];\n                data.features[i].geometry.coordinates = [points.map(v => affine(v))];\n            }\n        }\n        map.addSource(source, {\n            type: 'geojson',\n            data: data\n        });\n        map.addLayer({\n            'id': orangeStripeLayer,\n            'type': 'fill',\n            'source': source,\n            'layout': {'visibility': (visibility) ? 'visible' : 'none'},\n            'paint': {\n                //'fill-color': \"rgba(255, 0, 0, 0.2)\",\n                'fill-pattern': 'stripe-orange',\n                'fill-opacity': 0.4\n            },\n            'filter': ['!', ['==', 'FIR-RED', ['get', 'type']]]\n        });\n        map.addLayer({\n            'id': redStripeLayer,\n            'type': 'fill',\n            'source': source,\n            'layout': {'visibility': (visibility) ? 'visible' : 'none'},\n            'paint': {\n                //'fill-color': \"rgba(255, 0, 0, 0.2)\",\n                'fill-pattern': 'stripe-red',\n                'fill-opacity': 0.35\n            },\n            'filter': ['==', 'FIR-RED', ['get', 'type']]\n        });\n        map.addLayer({\n            'id': lineLayer,\n            'type': 'line',\n            'source': source,\n            'layout': {'visibility': (visibility) ? 'visible' : 'none'},\n            'paint': {\n                'line-color': ['case', ['==', 'FIR-RED', ['get', 'type']], \"rgb(255,0,0)\", \"rgb(255,127,0)\"],\n                'line-width': 1,\n                'line-opacity': ['case', ['==', 'FIR-RED', ['get', 'type']], 0.35, 0.4]\n            }\n        });\n    })\n};\n\nexport function changeFirDisplay({map, kmlOptions, mapOptions}) {\n    const visibility = kmlOptions.firDisplay && !kmlOptions.firHide.includes(mapOptions.id);\n    for (const layer of layers) {\n        if (map.getLayer(layer)) {\n            map.setLayoutProperty(layer, 'visibility', (visibility) ? 'visible': 'none');\n        }\n    }\n}\n\nexport default {\n    show: (data) => changeFirDisplay(data),\n    hide: (data) => changeFirDisplay(data),\n    add: addFirReg,\n}","/* global editolido */\nimport {addLine, changeDisplayGeneric, changeLineGeneric, changeLineWidthGeneric, computeLineWidthSize} from '../utils';\nexport const greatCircleMapIdCondition = (mapOptions) => (mapOptions && mapOptions.id.startsWith('vb_'));\nconst folder = 'great-circle';\nconst lineWidthGreatCircle = 1.5;\n\nconst addGreatCircle = (data) => {\n    const {ofp, kmlOptions, mapData, map, mapOptions} = data;\n    if (!ofp || greatCircleMapIdCondition(mapOptions)) return;\n    const visibility = kmlOptions.greatCircleDisplay;\n    const {affineAndClip} = mapData;\n    const routeName = `${ofp.infos.depICAO}-${ofp.infos.destICAO}`;\n    const route = ofp.route;\n    const greatCircle = new editolido.Route([route.points[0], route.points[route.points.length - 1]]).split(300, {\"name\": `Ortho ${routeName}`});\n    const lineWidth = computeLineWidthSize(kmlOptions['lineWidthChange'], lineWidthGreatCircle);\n    addLine(map, folder, greatCircle.points, affineAndClip, kmlOptions.greatCircleColor, visibility, lineWidth);\n}\n\nexport default {\n    show: changeDisplayGeneric.bind(null, folder, true),\n    hide: changeDisplayGeneric.bind(null, folder, false),\n    add: addGreatCircle,\n    changeLine: changeLineGeneric.bind(null, folder),\n    changeLineWidth: (data) => changeLineWidthGeneric(folder, data, lineWidthGreatCircle)\n}","<script context=\"module\">\n    export function dashToCamelCase(str) {\n        return str.replace(/-([a-z])/g, function (g) {\n            return g[1].toUpperCase();\n        });\n    }\n    export function camelCaseToDash(str) {\n        return str.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase()\n    }\n</script>\n\n<script>\n    import { createEventDispatcher } from 'svelte';\n    import { fly } from 'svelte/transition';\n    import CheckboxColorCombo from './CheckboxColorCombo.svelte';\n    import AirportSelector from './AirportSelector.svelte';\n    import ZoomLevel from './ZoomLevel.svelte';\n    import {storage, stores, kmlDefaultOptions, validate} from './storage.js';\n    import {sidebar, ofp, focusMode} from \"../../stores.js\";\n    import clickOutside from '../../actions/clickOutsideAction';\n    import {ogimetMapIdCondition} from '../mapboxgl/layers/ogimet';\n    import {firMapIdCondition} from '../mapboxgl/layers/fir-reg';\n    import {greatCircleMapIdCondition} from '../mapboxgl/layers/great-circle';\n    import {focusMap} from '../utils';\n    const dispatch = createEventDispatcher();\n    const store = stores.optionsKML;\n    export let kmlOptions;\n    export let mapOptions;\n    let focusOptions;\n    let focusBackup;\n    const focusStore = stores.focusKML;\n    let storedOptions = validate({...(storage.getItem(store) ||{})});\n    const focusOptionsDefault = (options) => Object.keys(options)\n        .reduce((obj, key) => {\n            obj[key] = (key !== 'routeDisplay' && key.endsWith('Display'))  ? false : options[key];\n            return obj;\n        }, {});\n\n    $: isDefault = compare(kmlOptions, kmlDefaultOptions);\n    $: isChanged = !compare(storedOptions, kmlOptions);\n    $: isFocusDefault = (focusBackup) ? compare(focusOptionsDefault(focusBackup), kmlOptions) : false;\n    $: hideOnThisProjection = (mapOptions)  ? kmlOptions['firHide'].split(',').includes(mapOptions.id) : false;\n\n    /**\n     * e is a component event or a dom checkbox event\n     */\n    function update(e) {\n        const name = (e.detail) ? e.detail.name : e.target.name;\n        const value = (e.detail) ? e.detail.value : e.target.checked;\n        const key = dashToCamelCase(name);\n        if ( kmlOptions[key] !== value) {\n            kmlOptions[key] = value;\n            dispatch('change', {name, value});\n        }\n    }\n    function updateAll(options) {\n        let hasChange = false;\n        for (const [key, value] of Object.entries(options)) {\n            if (kmlOptions[key] !== value){\n                kmlOptions[key] = value;\n                dispatch('change', { 'name': camelCaseToDash(key), value});\n                hasChange = true;\n            }\n        }\n        if (hasChange) {\n            kmlOptions = {...options};\n        }\n    }\n    function compare(obj1, obj2){\n        return JSON.stringify(obj1) === JSON.stringify(obj2);\n    }\n    function reset() {\n        updateAll(kmlDefaultOptions);\n    }\n    function restore() {\n        updateAll(storedOptions);\n    }\n    function save() {\n        if (isDefault) {\n            storage.removeItem(store);\n        } else {\n            const options = {};\n            for (const key of Object.keys(kmlOptions).filter(k => kmlOptions[k] !== kmlDefaultOptions[k])){\n                options[key] = kmlOptions[key];\n            }\n            storage.setItem(store, options);\n        }\n        dispatch('save');\n        storedOptions = {...kmlOptions};\n    }\n\n    function toggleFocus(e) {\n        e.target.blur();\n        if ($focusMode) {\n            endFocusMode();\n        }else{\n            focusBackup = {...kmlOptions};\n            focusOptions = validate({...(storage.getItem(focusStore) ||focusOptionsDefault(kmlOptions))});\n            $focusMode = true;\n            updateAll(focusOptions);\n        }\n        $sidebar = false;\n    }\n    export function endFocusMode() {\n        if ($focusMode) {\n            storage.setItem(focusStore, kmlOptions);\n            if (focusBackup) {\n                updateAll(focusBackup);\n            }\n            focusOptions = undefined;\n            $focusMode = false;\n        }\n    }\n    function resetFocus() {\n        storage.removeItem(focusStore);\n        if (focusBackup) {\n            focusOptions = focusOptionsDefault(focusBackup);\n            updateAll(focusOptions);\n        } else {\n            console.error('the focus backup should never be undefined');\n        }\n    }\n    function clickOutsideHandler () {\n        $sidebar=false;\n        //do not focus on map without checking if e.detail.target is an input field\n    }\n    function toggleOnThisProjection () {\n        const projections = kmlOptions['firHide'].split(',').filter(v => v.length > 0);\n        const index = projections.indexOf(mapOptions.id);\n        if (index >= 0) {\n            projections.splice(index, 1);\n        }else{\n            projections.push(mapOptions.id);\n            projections.sort();\n        }\n        update({detail: {name: 'fir-hide', value: projections.join(',')}});\n    }\n</script>\n\n{#if $sidebar}\n<div class:sidebar={$sidebar} class:focusmode={$focusMode} class=\"settings\"  use:clickOutside on:click_outside={clickOutsideHandler} transition:fly=\"{{duration: 300, x: 200, y: 0}}\">\n    <button type=\"button\" tabindex=\"0\" class=\"btn-close float-end\"  aria-label=\"Close\" on:click={() =>  {$sidebar = !$sidebar; if (!$sidebar) focusMap();}}></button>\n    <form on:submit|preventDefault class:mt-5={!$ofp}>\n        {#if $ofp}\n        <fieldset class=\"form-group\">\n            <div class=\"input-group checkbox-combo\">\n                <label for=\"fir-display\" class=\"form-control\"><input name=\"fir-display\" checked={kmlOptions['firDisplay']} type=\"checkbox\" on:change={update}/>FIR REG\n                    {#if firMapIdCondition(mapOptions)}\n                        <svg class=\"deactivated eye\"><use xlink:href=\"#eye-off-symbol\"></use></svg>\n                    {:else if kmlOptions['firDisplay']}\n                        {#if hideOnThisProjection}\n                            <svg class=\"eye\" on:click={toggleOnThisProjection}><use xlink:href=\"#eye-off-symbol\"></use></svg>\n                        {:else}\n                            <svg class=\"eye\" on:click={toggleOnThisProjection}><use xlink:href=\"#eye-symbol\"></use></svg>\n                        {/if}\n                    {/if}\n                </label>\n            </div>\n            {#if firMapIdCondition(mapOptions)}\n                <small class=\"deactivated form-text text-muted\">Calque désactivé sur cette projection</small>\n            {:else if kmlOptions['firDisplay']}\n                {#if hideOnThisProjection}\n                    <small class=\"form-text text-muted\">Calque masqué sur cette projection</small>\n                {/if}\n            {/if}\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"route\" kmlColor={kmlOptions['routeColor']} checked={kmlOptions['routeDisplay']} on:change={update}>\n                Route\n                <button class=\"getfocus btn btn-sm btn-outline-info\" class:active={$focusMode} on:click|preventDefault={toggleFocus}>\n                    {#if $focusMode}<svg class=\"checkmark\"><use xlink:href=\"#checkmark-symbol\"/></svg>{/if}FOCUS</button>\n            </CheckboxColorCombo>\n            {#if $focusMode}<small class=\"text-center mt-0\">Cliquez sur FOCUS pour sortir du mode</small>{/if}\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"alternate\" kmlColor={kmlOptions['alternateColor']} checked={kmlOptions['alternateDisplay']} on:change={update}>Dégagement</CheckboxColorCombo>\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"nat\" kmlColor={kmlOptions['natColor']} checked={kmlOptions['natDisplay']} on:change={update}>Tracks</CheckboxColorCombo>\n            <small class=\"form-text text-muted\">Un track incomplet sera rouge</small>\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"great-circle\" kmlColor={kmlOptions['greatCircleColor']} checked={kmlOptions['greatCircleDisplay']} on:change={update}>Orthodromie\n                {#if greatCircleMapIdCondition(mapOptions)}<svg class=\"deactivated eye\"><use xlink:href=\"#eye-off-symbol\"></use></svg>{/if}\n            </CheckboxColorCombo>\n            {#if greatCircleMapIdCondition(mapOptions)}<small class=\"deactivated form-text text-muted\">Calque désactivé sur cette projection</small>{/if}\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"ogimet\" kmlColor={kmlOptions['ogimetColor']} checked={kmlOptions['ogimetDisplay']} on:change={update}>Route GRAMET\n                {#if ogimetMapIdCondition(mapOptions)}<svg class=\"deactivated eye\"><use xlink:href=\"#eye-off-symbol\"></use></svg>{/if}\n            </CheckboxColorCombo>\n            {#if ogimetMapIdCondition(mapOptions)}<small class=\"deactivated form-text text-muted\">Calque désactivé sur cette projection</small>{/if}\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <CheckboxColorCombo name=\"etops\" kmlColor={kmlOptions['etopsColor']} checked={kmlOptions['etopsDisplay']} on:change={update}>ETOPS</CheckboxColorCombo>\n        </fieldset>\n        <fieldset class=\"form-group\">\n            <legend class=\"d-flex align-items-center\">\n                <input name=\"airport-display\" checked={kmlOptions['airportDisplay']} type=\"checkbox\" on:change={update}/>Aéroports</legend>\n            <AirportSelector selectedPin={kmlOptions['airportPin']} selectedLabel={kmlOptions['airportLabel']} on:change={update} />\n        </fieldset>\n        {/if}\n        <fieldset class=\"form-group\">\n            <legend>Aspect général</legend>\n            <ZoomLevel name=\"icon-text-change\" label=\"Labels\" value={kmlOptions['iconTextChange']} min={0.9} max={2} on:change={update}/>\n            {#if $ofp}\n            <ZoomLevel name=\"line-width-change\" label=\"Lignes\" value={kmlOptions['lineWidthChange']} max={3} on:change={update}/>\n            {/if}\n            <ZoomLevel name=\"icon-size-change\" label=\"Icônes\" value={kmlOptions['iconSizeChange']} on:change={update}/>\n        </fieldset>\n        <div>\n        {#if (!$focusMode)}\n            <button disabled={!isChanged} class=\"btn btn-primary btn-sm\"type=\"button\" on:click={save}>Mémoriser</button>\n            <button disabled={!isChanged} class=\"btn btn-secondary btn-sm\" type=\"button\" on:click={restore}>Restaurer</button>\n            {#if !isDefault}<button class=\"btn btn-outline-dark btn-sm ms-auto\" type=\"button\" on:click={reset}>Reset</button>{/if}\n        {:else}\n            <button disabled={isFocusDefault} class=\"resetfocus btn btn-danger btn-sm\" type=\"button\" on:click={resetFocus}>RESET Réglages mode FOCUS</button>\n        {/if}\n        </div>\n    </form>\n</div>\n{/if}\n\n<style>\n    :global(.settings input[type=\"checkbox\"]) {\n        margin-right: 0.5ch;\n    }\n    .btn:disabled {\n        opacity: .3;\n    }\n    fieldset small {\n        line-height: 1;\n        width: var(--formwidth);\n        display: block;\n        margin-top: -0.05rem;\n        font-size: 0.7rem;\n        position: absolute;\n        font-variant: all-small-caps\n    }\n    fieldset small.deactivated::before {\n        content: \"⚠️ \";\n        \n    }\n    :global(.settings legend, .checkbox-combo label.form-control) {\n        font-size: 1rem;\n        font-weight: bold;\n        font-variant-caps: all-small-caps;\n        margin-bottom: 0;\n    }\n    form {\n        --formwidth: 250px;\n        width: var(--formwidth);\n        margin-top: 5px;\n        user-select: none; /* supported by Chrome and Opera */\n        -webkit-user-select: none; /* Safari */\n        -moz-user-select: none; /* Firefox */\n        touch-action: manipulation;\n    }\n    .form-group{\n        margin-bottom: 1.25rem;\n    }\n    .settings {\n        position: absolute;\n        right: 0;\n        transition: right 0.15s ease-out;\n        background-color: #eee;\n        border-left: 1px solid rgba(255,255,255,0.2);\n        padding: 5px;\n        z-index: 2;\n    }\n    @supports ( backdrop-filter: blur(4px) ) or ( -webkit-backdrop-filter: blur(4px) ) {\n        .settings {\n            background-color: rgba(254,254,254,0.6);\n            backdrop-filter: blur(4px);\n            -webkit-backdrop-filter: blur(4px);\n        }\n        .settings.focusmode {\n            background-color: rgba(23, 162, 184, 0.1);\n        }\n    }\n    .settings :global(label[for=\"route-display\"]) {\n        padding-right: 0;\n    }\n    .getfocus{\n        line-height: 1;\n        margin-left: auto;\n        margin-right: auto;\n        font-size: 0.8rem;\n        font-weight: 500;\n        display: flex;\n        align-items: center;\n        color: var(--bs-info);\n        border-color: var(--bs-info);\n    }\n    .getfocus.active, .getfocus:active {\n        color: var(--bs-dark);\n        background-color: var(--bs-info);\n        border-color: var(--bs-info);\n    }\n    svg.checkmark {\n        width: 0.7rem;\n        height: 0.7rem;\n        stroke: transparent;\n        stroke-width: 8px;\n        margin-right: 5px;\n        border: 1px solid var(--bs-info);\n        padding: 2px;\n        border-radius: 2px;\n    }\n    .getfocus.active svg {\n        stroke: var(--bs-dark);\n        border: 1px solid var(--bs-dark);\n    }\n    .getfocus:not(.active):hover{\n        background-color: transparent;\n        color: var(--bs-info);\n    }\n    .resetfocus{\n        margin-left: auto;\n        margin-right: auto;\n    }\n    .btn-sm{\n        font-variant-caps: all-small-caps;\n    }\n    form>:last-child {\n        margin-top: 24px;\n        margin-bottom: 0.5rem;\n        display: flex;\n        column-gap: 0.5rem;\n    }\n    .settings :global(select[name=airport-pin]), .settings :global(select[name=airport-label]) {\n        font-size: 0.9rem;\n    }\n    svg.eye {\n        position: absolute;\n        right: 3px;\n    }\n    :global(svg.eye) {\n        width: 16px;\n        height: 16px;\n    }\n    :global(svg.eye.deactivated){\n        color: var(--bs-gray-400);\n    }\n    form>fieldset:first-of-type{\n        margin-right: 50px;\n    }\n    form>fieldset:first-of-type svg{\n        right: 10px;\n    }\n</style>\n","<script>\n    import ColorPinCombo from './mapSettings/ColorPinCombo.svelte';\n    import CheckboxColorCombo from './mapSettings/CheckboxColorCombo.svelte';\n    import {storage, stores, validate} from './mapSettings/storage.js';\n    import {dashToCamelCase, camelCaseToDash} from './mapSettings/Form.svelte';\n    import {kmlExportDefaultOptions, updateKml} from './kml.js';\n\n    const store = stores.exportKML;\n    let storedOptions = validate({...(storage.getItem(store) ||{})}, kmlExportDefaultOptions);\n    let exportOptions = {...kmlExportDefaultOptions, ...storedOptions};\n    const allowedOptions = [\n        'routeDisplay', 'routeColor',\n        'alternateDisplay', 'alternateColor',\n        'natDisplay', 'natColor',\n        'greatCircleDisplay', 'greatCircleColor'];\n    export let mapOptions;\n    const allowedMapOptions = Object.keys(mapOptions)\n        .filter(key => allowedOptions.includes(key))\n        .reduce((obj, key) => {\n            obj[key] = (key === 'routeDisplay')  ? true : mapOptions[key];\n            return obj;\n        }, {});\n\n    function updateAll(options) {\n        let hasChange = false;\n        for (const [key, value] of Object.entries(options)) {\n            if (exportOptions[key] !== value){\n                exportOptions[key] = value;\n                const name = camelCaseToDash(key);\n                updateKml(name, value);\n                hasChange = true;\n            }\n        }\n        if (hasChange) {\n            exportOptions = {...exportOptions}; // notify svelte\n        }\n    }\n    for (const [key, value] of Object.entries(exportOptions)) {\n        if (kmlExportDefaultOptions[key] !== value){\n            const name = camelCaseToDash(key);\n            updateKml(name, value);\n        }\n    }\n\n    function compare(obj1, obj2){\n        return JSON.stringify(obj1) === JSON.stringify(obj2);\n    }\n\n    $: isDefault = compare(kmlExportDefaultOptions, exportOptions);\n    $: isChanged = !compare(storedOptions, exportOptions);\n    $: isLikeMap = compare({...exportOptions, ...allowedMapOptions}, exportOptions);\n\n\n    function update(e) {\n        const name = (e.detail) ? e.detail.name : e.target.name;\n        const value = (e.detail) ? e.detail.value : e.target.checked;\n        const key = dashToCamelCase(name);\n        if ( exportOptions[key] !== value) {\n            exportOptions[key] = value;\n            updateKml(name, value);\n        }\n    }\n    const restore = () => updateAll(storedOptions);\n    const reset = () => updateAll(kmlExportDefaultOptions);\n    const asMap = () => updateAll({...exportOptions, ...allowedMapOptions});\n    function save() {\n        if (isDefault) {\n            storage.removeItem(store);\n        } else {\n            const options = {};\n            for (const key of Object.keys(exportOptions).filter(k => exportOptions[k] !== kmlExportDefaultOptions[k])){\n                options[key] = exportOptions[key];\n            }\n            storage.setItem(store, options);\n        }\n        storedOptions = {...exportOptions};\n    }\n</script>\n\n<div>\n    <fieldset class=\"form-group\">\n        <legend>Route</legend>\n            <ColorPinCombo name=\"route\" kmlColor={exportOptions['routeColor']} selected={exportOptions['routePin']} on:change={update} />\n    </fieldset>\n    <fieldset class=\"form-group\">\n        <legend><input name=\"alternate-display\" checked={exportOptions['alternateDisplay']} type=\"checkbox\" on:change={update} />Dégagement</legend>\n        <ColorPinCombo name=\"alternate\" kmlColor={exportOptions['alternateColor']} selected={exportOptions['alternatePin']} on:change={update} />\n    </fieldset>\n    <fieldset class=\"form-group\">\n        <legend><input name=\"nat-display\" checked={exportOptions['natDisplay']} type=\"checkbox\" on:change={update}/>Tracks</legend>\n        <ColorPinCombo name=\"nat\" kmlColor={exportOptions['natColor']} selected={exportOptions['natPin']} on:change={update} />\n        <small class=\"form-text text-muted\">Positionné à l'entrée des tracks, un track incomplet restera rouge.</small>\n    </fieldset>\n    <fieldset class=\"form-group\">\n        <CheckboxColorCombo name=\"great-circle\" kmlColor={exportOptions['greatCircleColor']} checked={exportOptions['greatCircleDisplay']} on:change={update}>Orthodromie</CheckboxColorCombo>\n    </fieldset>\n    <div class=\"mt-4 mb-2 d-flex\">\n        <button disabled={!isChanged} class=\"btn btn-primary btn-sm\"type=\"button\" on:click={save}>Mémoriser</button>\n        <button disabled={!isChanged} class=\"btn btn-secondary btn-sm ms-3\" type=\"button\" on:click={restore}>Restaurer</button>\n        <button disabled={isLikeMap} class=\"btn btn-outline-secondary btn-sm ms-auto\" type=\"button\" on:click={asMap}>Comme Carte</button>\n        <button disabled={isDefault} class=\"btn btn-outline-secondary btn-sm ms-auto\" type=\"button\" on:click={reset}>Reset</button>\n    </div>\n</div>\n\n<style>\n    fieldset.form-group {\n        margin-bottom: 0.5rem;\n    }\n    .btn-primary {\n        background-color: var(--blueaf);\n        border-color: var(--blueaf);\n    }\n    .btn:disabled {\n        opacity: 0.25;\n    }\n    div.d-flex{\n        font-variant-caps: all-small-caps;\n    }\n</style>","<script>\n  import ShortcutsLink from \"./ShortcutsLink.svelte\";\n  import DownloadButton from \"./DownloadButton.svelte\";\n  import ExportSettings from \"./ExportSettings.svelte\";\n  export let kmlOptions;\n</script>\n<div class=\"card mb-3\">\n  <div class=\"card-body\">\n    <div class=\"row\">\n        <div class=\"col-12 col-md-6 d-flex pt-2 pt-md-0\">\n            <form on:submit|preventDefault class=\"settings\">\n                <fieldset class=\"form\">\n                    <legend>Réglages pour l'export</legend>\n                    <ExportSettings mapOptions={kmlOptions}/>\n                </fieldset>\n            </form>\n        </div>\n        <div class=\"col-12 col-md-6 d-flex export\">\n            <form on:submit|preventDefault class=\"settings\">\n                <fieldset class=\"form\">\n                    <legend>Export</legend>\n                    <fieldset class=\"form-group\">\n                        <legend>KML</legend>\n                        <p>Choisissez un format (MapsMe, Avenza Maps ou Google Earth) et téléchargez le fichier KML.</p>\n                        <DownloadButton label=\"Télécharger\" on:save />\n                    </fieldset>\n                    <fieldset class=\"form-group mt-4\">\n                        <legend>Raccourcis</legend>\n                        <p>Sur iOS on peut lancer un raccourci.\n                            <a href=\"https://www.icloud.com/shortcuts/886cc07d24d74d83bb0859643242c2df\" target=\"_blank\">\n                                Exemple de raccourci à installer\n                            </a>. Le raccourci reçoit le KML, la route Lido et le GRAMET.\n                        </p>\n                    <ShortcutsLink on:save /> \n                </fieldset>\n            </form>\n        </div>\n    </div>\n  </div>\n</div>\n\n<style>\n    form {\n        width: 100%;\n    }\n\n    @media (max-width: 575px){\n        .col-12 {\n            padding-left: 0;\n            padding-right: 0;\n        }\n        .export{\n            margin-top: 1.5rem;\n        }\n    }\n\n    .card {\n        margin: 1.5rem 1rem;\n        background-color: rgba(255,255,255,0.89);\n    }\n    fieldset.form {\n        border: 1px solid var(--blueaf);\n        padding: 5px 10px;\n        width: 100%;\n        height: 100%;\n    }\n    fieldset.form > legend {\n        background-color: var(--blueaf);\n        color: #fff;\n        padding: 3px 6px;\n        width: auto;\n        font-variant: none;\n        border-radius: 0.2rem;\n        float:none;\n    }\n</style>","<script>\n    import {shareAppLink} from './utils';\n</script>\n<div class=\"row\">\n    <div class=\"col-12 col-lg-8\">\n        <h1><strong class=\"d-none\">OFP2MAP </strong>Cartographie pour l'OFP</h1>\n        <img src=\"svg/Air_France_Logo.svg\" alt=\"logo Air France\">\n        {#if (navigator.standalone === true || 'process.env.NODE_ENV' === '\"development\"') && navigator.share}\n            <button class=\"btn btn-link\" on:click={shareAppLink}>Partager l'App</button>\n        {:else}\n            &nbsp;\n        {/if}\n    </div>\n</div>\n<style>\n    div {\n        padding: 0 2rem;\n    }\n    div>div {\n        text-align: center;\n        background-color: rgba(0, 0, 0, 0.2);\n        border-radius: 8px;\n        font-variant-caps: all-small-caps;\n        color: white;\n        display: flex;\n        padding: 0.5rem;\n        flex-direction: column;\n        align-items: center;\n        margin-top: 1rem;\n        margin-bottom: 15px;\n    }\n    img{\n        width: 100%;\n        margin: 0 auto;\n        display: block;\n    }\n    @media (min-width: 992px){\n        div>div {\n            margin: 3rem auto;\n        }\n    }\n    button.btn{\n        outline-color: var(--bs-yellow);\n    }\n</style>","<script>\n      import Logo from './Logo.svelte';\n</script>\n<Logo/>\n\n<div class=\"row\">\n  <div class=\"col-12 col-lg-4\">\n    <div class=\"card feature usage\">\n      <div class=\"card-header\">Facile à utiliser</div>\n      <div class=\"card-body\">\n        <p class=\"card-text\">Dans <b>Pilot Mission</b>, onglet <b>Dossier de vol</b>, affichez le PDF nommé <b>Dossier de vol OFP</b>. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez <b>Enregistrer dans Fichiers</b>. Dans l'app, c'est cet OFP qu'il faut sélectionner.</p>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-12 col-lg-4\"><div class=\"card feature offline\">\n    <div class=\"card-header\">RAPIDE ET OFFLINE</div>\n    <div class=\"card-body\">\n      <p class=\"card-text\">L'OFP ne quitte pas votre iPad ou votre ordinateur. Conçu pour le PilotPad, peut s'utiliser en vol sans réseau et fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p>\n    </div>\n  </div></div>\n  <div class=\"col-12 col-lg-4\"><div class=\"card feature maps\">\n    <div class=\"card-header\">Multiples Projections</div>\n    <div class=\"card-body\">\n      <ul class=\"card-text\">\n        <li>trois LAMBERT conformes</li>\n        <li>un ATLAS POLITIQUE</li>\n        <li>un ATLAS PHYSIQUE</li>\n        <li>une carte VFR</li>\n        <li>une MERCATOR (zoom x 12)</li>\n      </ul>\n      <p class=\"card-text\">Export KML compatible Mapsme, Avenza et Google Earth.</p>\n    </div>\n  </div></div>\n</div>\n\n<style>\n/* .usage {\n  margin: 0 15px;\n  color: white;\n  background-color: rgba(0, 0, 0, 0.2);\n} */\n.usage .card-header {\n  background-color: var(--bs-green);\n}\n.feature{\n  color: black;\n  background-color: rgba(255, 255, 255, 0.8);\n  border: none;\n  margin: 1rem 0;\n  backdrop-filter: blur(4px);\n  -webkit-backdrop-filter: blur(4px);\n  font-size: 108%;\n}\n.feature .card-header {\n  font-variant-caps: all-small-caps;\n  font-weight: bold;\n  color: white;\n}\n.feature.offline  .card-header{\n  background-color: var(--bs-purple);\n}\n/* .feature.mapsme .card-header {\n  background-color: var(--bs-green);\n} */\n.feature.maps .card-header {\n  background-color: var(--bs-pink);\n}\n/* .feature.ogimet .card-header {\n  background-color: var(--bs-yellow);\n} */\n.row {\n  margin-bottom: 1rem; /* for no ofp prompt */\n  padding: 0 1rem 1rem 1rem;\n}\nul {\n  list-style: square;\n}\nb, li {\n  white-space: nowrap;\n}\n@media (min-width: 992px){\n  .row {\n    margin-top: 2rem;\n  }\n  .feature {\n    height: 100%;\n  }\n}\n</style>\n","// ---> code from https://github.com/thekelvinliu/country-code-emoji\n// offset between uppercase ascii and regional indicator symbols\nconst OFFSET = 127397;\n\nexport function countryCodeEmoji(cc) {\n    const codePoints = [...cc.toUpperCase()].map(c => c.codePointAt() + OFFSET);\n    return String.fromCodePoint(...codePoints);\n}\n// <--- end of code from https://github.com/thekelvinliu/country-code-emoji\n\nconst isoCountries = {\n    'NY' : 'United States', // flytax special code\n    'TY' : 'Japan', // flytax special code\n    'AF' : 'Afghanistan',\n    'AX' : 'Aland Islands',\n    'AL' : 'Albania',\n    'DZ' : 'Algeria',\n    'AS' : 'American Samoa',\n    'AD' : 'Andorra',\n    'AO' : 'Angola',\n    'AI' : 'Anguilla',\n    'AQ' : 'Antarctica',\n    'AG' : 'Antigua & Barbuda',\n    'AR' : 'Argentina',\n    'AM' : 'Armenia',\n    'AW' : 'Aruba',\n    'AU' : 'Australia',\n    'AT' : 'Austria',\n    'AZ' : 'Azerbaijan',\n    'BS' : 'Bahamas',\n    'BH' : 'Bahrain',\n    'BD' : 'Bangladesh',\n    'BB' : 'Barbados',\n    'BY' : 'Belarus',\n    'BE' : 'Belgium',\n    'BQ' : 'British Antarctic Territory',\n    'BZ' : 'Belize',\n    'BJ' : 'Benin',\n    'BM' : 'Bermuda',\n    'BT' : 'Bhutan',\n    'BO' : 'Bolivia',\n    'BA' : 'Bosnia & Herzegovina',\n    'BW' : 'Botswana',\n    'BV' : 'Bouvet Island',\n    'BR' : 'Brazil',\n    'IO' : 'British Indian Ocean Territory',\n    'BN' : 'Brunei Darussalam',\n    'BG' : 'Bulgaria',\n    'BF' : 'Burkina Faso',\n    'BI' : 'Burundi',\n    'KH' : 'Cambodia',\n    'CM' : 'Cameroon',\n    'CA' : 'Canada',\n    'CV' : 'Cape Verde',\n    'KY' : 'Cayman Islands',\n    'CF' : 'Central African Republic',\n    'TD' : 'Chad',\n    'CL' : 'Chile',\n    'CN' : 'China',\n    'CX' : 'Christmas Island',\n    'CC' : 'Cocos (Keeling) Islands',\n    'CO' : 'Colombia',\n    'CW' : 'Curaçao',\n    'KM' : 'Comoros',\n    'CG' : 'Congo',\n    'CD' : 'Congo, Democratic Republic',\n    'CK' : 'Cook Islands',\n    'CR' : 'Costa Rica',\n    'CI' : 'Cote D\\'Ivoire',\n    'HR' : 'Croatia',\n    'CU' : 'Cuba',\n    'CY' : 'Cyprus',\n    'CZ' : 'Czech Republic',\n    'DK' : 'Denmark',\n    'DJ' : 'Djibouti',\n    'DM' : 'Dominica',\n    'DO' : 'Dominican Republic',\n    'EC' : 'Ecuador',\n    'EG' : 'Egypt',\n    'SV' : 'El Salvador',\n    'GQ' : 'Equatorial Guinea',\n    'ER' : 'Eritrea',\n    'EE' : 'Estonia',\n    'ET' : 'Ethiopia',\n    'FK' : 'Falkland Islands (Malvinas)',\n    'FO' : 'Faroe Islands',\n    'FJ' : 'Fiji',\n    'FI' : 'Finland',\n    'FR' : 'France',\n    'GF' : 'French Guiana',\n    'PF' : 'French Polynesia',\n    'TF' : 'French Southern Territories',\n    'GA' : 'Gabon',\n    'GM' : 'Gambia',\n    'GE' : 'Georgia',\n    'DE' : 'Germany',\n    'GH' : 'Ghana',\n    'GI' : 'Gibraltar',\n    'GR' : 'Greece',\n    'GL' : 'Greenland',\n    'GD' : 'Grenada',\n    'GP' : 'Guadeloupe',\n    'GU' : 'Guam',\n    'GT' : 'Guatemala',\n    'GG' : 'Guernsey',\n    'GN' : 'Guinea',\n    'GW' : 'Guinea-Bissau',\n    'GY' : 'Guyana',\n    'HT' : 'Haiti',\n    'HM' : 'Heard Island & Mcdonald Islands',\n    'VA' : 'Holy See (Vatican City State)',\n    'HN' : 'Honduras',\n    'HK' : 'Hong Kong',\n    'HU' : 'Hungary',\n    'IS' : 'Iceland',\n    'IN' : 'India',\n    'ID' : 'Indonesia',\n    'IR' : 'Iran, Islamic Republic Of',\n    'IQ' : 'Iraq',\n    'IE' : 'Ireland',\n    'IM' : 'Isle Of Man',\n    'IL' : 'Israel',\n    'IT' : 'Italy',\n    'JM' : 'Jamaica',\n    'JP' : 'Japan',\n    'JE' : 'Jersey',\n    'JO' : 'Jordan',\n    'KZ' : 'Kazakhstan',\n    'KE' : 'Kenya',\n    'KI' : 'Kiribati',\n    'KR' : 'Korea',\n    'KW' : 'Kuwait',\n    'KG' : 'Kyrgyzstan',\n    'LA' : 'Lao People\\'s Democratic Republic',\n    'LV' : 'Latvia',\n    'LB' : 'Lebanon',\n    'LS' : 'Lesotho',\n    'LR' : 'Liberia',\n    'LY' : 'Libyan Arab Jamahiriya',\n    'LI' : 'Liechtenstein',\n    'LT' : 'Lithuania',\n    'LU' : 'Luxembourg',\n    'MO' : 'Macao',\n    'MK' : 'Macedonia',\n    'MG' : 'Madagascar',\n    'MW' : 'Malawi',\n    'MY' : 'Malaysia',\n    'MV' : 'Maldives',\n    'ML' : 'Mali',\n    'MT' : 'Malta',\n    'MH' : 'Marshall Islands',\n    'MQ' : 'Martinique',\n    'MR' : 'Mauritania',\n    'MU' : 'Mauritius',\n    'YT' : 'Mayotte',\n    'MX' : 'Mexico',\n    'FM' : 'Micronesia, Federated States Of',\n    'MD' : 'Moldova',\n    'MC' : 'Monaco',\n    'MN' : 'Mongolia',\n    'ME' : 'Montenegro',\n    'MS' : 'Montserrat',\n    'MA' : 'Morocco',\n    'MZ' : 'Mozambique',\n    'MM' : 'Myanmar',\n    'NA' : 'Namibia',\n    'NR' : 'Nauru',\n    'NP' : 'Nepal',\n    'NL' : 'Netherlands',\n    'AN' : 'Netherlands Antilles',\n    'NC' : 'New Caledonia',\n    'NZ' : 'New Zealand',\n    'NI' : 'Nicaragua',\n    'NE' : 'Niger',\n    'NG' : 'Nigeria',\n    'NU' : 'Niue',\n    'NF' : 'Norfolk Island',\n    'MP' : 'Northern Mariana Islands',\n    'NO' : 'Norway',\n    'OM' : 'Oman',\n    'PK' : 'Pakistan',\n    'PW' : 'Palau',\n    'PS' : 'Palestinian Territory',\n    'PA' : 'Panama',\n    'PG' : 'Papua New Guinea',\n    'PY' : 'Paraguay',\n    'PE' : 'Peru',\n    'PH' : 'Philippines',\n    'PN' : 'Pitcairn',\n    'PL' : 'Poland',\n    'PT' : 'Portugal',\n    'PR' : 'Puerto Rico',\n    'QA' : 'Qatar',\n    'RE' : 'Reunion',\n    'RO' : 'Romania',\n    'RU' : 'Russian Federation',\n    'RW' : 'Rwanda',\n    'BL' : 'Saint Barthelemy',\n    'SH' : 'Saint Helena',\n    'KN' : 'Saint Kitts & Nevis',\n    'LC' : 'Saint Lucia',\n    'MF' : 'Saint Martin',\n    'PM' : 'Saint Pierre & Miquelon',\n    'VC' : 'Saint Vincent & Grenadines',\n    'WS' : 'Samoa',\n    'SM' : 'San Marino',\n    'ST' : 'Sao Tome & Principe',\n    'SA' : 'Saudi Arabia',\n    'SN' : 'Senegal',\n    'RS' : 'Serbia',\n    'SC' : 'Seychelles',\n    'SL' : 'Sierra Leone',\n    'SG' : 'Singapore',\n    'SK' : 'Slovakia',\n    'SI' : 'Slovenia',\n    'SB' : 'Solomon Islands',\n    'SO' : 'Somalia',\n    'SX' : 'Sint Maarten',\n    'ZA' : 'South Africa',\n    'GS' : 'South Georgia & Sandwich Isl.',\n    'ES' : 'Spain',\n    'LK' : 'Sri Lanka',\n    'SD' : 'Sudan',\n    'SR' : 'Suriname',\n    'SJ' : 'Svalbard & Jan Mayen',\n    'SZ' : 'Swaziland',\n    'SE' : 'Sweden',\n    'CH' : 'Switzerland',\n    'SY' : 'Syrian Arab Republic',\n    'TW' : 'Taiwan',\n    'TJ' : 'Tajikistan',\n    'TZ' : 'Tanzania',\n    'TH' : 'Thailand',\n    'TL' : 'Timor-Leste',\n    'TG' : 'Togo',\n    'TK' : 'Tokelau',\n    'TO' : 'Tonga',\n    'TT' : 'Trinidad & Tobago',\n    'TN' : 'Tunisia',\n    'TR' : 'Turkey',\n    'TM' : 'Turkmenistan',\n    'TC' : 'Turks & Caicos Islands',\n    'TV' : 'Tuvalu',\n    'UG' : 'Uganda',\n    'UA' : 'Ukraine',\n    'AE' : 'United Arab Emirates',\n    'GB' : 'United Kingdom',\n    'US' : 'United States',\n    'UM' : 'United States Outlying Islands',\n    'UY' : 'Uruguay',\n    'UZ' : 'Uzbekistan',\n    'VU' : 'Vanuatu',\n    'VE' : 'Venezuela',\n    'VN' : 'Viet Nam',\n    'VG' : 'Virgin Islands, British',\n    'VI' : 'Virgin Islands, U.S.',\n    'WF' : 'Wallis & Futuna',\n    'EH' : 'Western Sahara',\n    'XK' : 'Kosovo',\n    'YE' : 'Yemen',\n    'ZM' : 'Zambia',\n    'ZW' : 'Zimbabwe'\n};\n\nexport const countryCodeName =  cc => isoCountries[cc] || '';","/* global mapboxgl editolido */\nimport {kml2mapColor} from \"../../mapSettings/ColorPinCombo.svelte\";\nimport {STATUS, GREENRED, MEDICAL, BLUEGREENRED} from \"../../mapSettings/AirportSelector.svelte\";\nimport {computeIconTextSize, computeIconSize, haloLightColor, haloTextBlur, haloTextWidth} from '../utils';\nimport { countryCodeName, countryCodeEmoji } from \"../../countries\";\nimport {get} from \"svelte/store\";\nimport {aircraftType as aircraftTypeStore} from '../../../stores';\n\nconst folder = 'airport';\nconst adequateLayer = `${folder}-layer`;\nconst emergencyLayer = `${folder}-emer-layer`;\nconst etopsLayer = `${folder}-etops-layer`;\nconst layers = [emergencyLayer, adequateLayer, etopsLayer]; // in display order\nconst source = `${folder}-source`;\n\nconst MEDICAL_COLOR = '#062DF8';\nconst TEXT_COLOR = '#000';\n\nconst getEtopsNames = (ofp) => {\n    const raltNames = (ofp) ? ofp.infos.ralts : [];\n    let epNames = [];\n    if (ofp && ofp.infos['EEP'] && ofp.infos['EXP'] && ofp.infos['raltPoints'].length > 0) {\n        epNames = [ofp.infos['EEP'].name, ofp.infos['EXP'].name];\n    }\n    return [raltNames, epNames.concat(raltNames)];\n};\n\n// --------------> CONDITIONS\nconst medicalCondition = [\"==\", 1, [\"get\", \"h\"]];\nconst levelCondition = (level) => [\"==\", level, [\"get\", \"level\"]];\nconst level0Condition = levelCondition(0);\nconst adequateCondition = (aircraftType) => [\"<\", [\"coalesce\", [\"get\", `${aircraftType}`], 11], 10];\nconst raltCondition = (ofp) => {\n    const [raltNames] = getEtopsNames(ofp);\n    if (raltNames.length > 0) {\n        return  [\"in\", [\"get\", \"name\"], [\"literal\", raltNames]];\n    }else{\n        return [\"to-boolean\", false];\n    }\n};\n\n// --------------> LABELLER + FORMATTER\nconst airportLabeller = (labelling) =>  (labelling === 0) ? ['get', 'name'] : ['get', 'iata'];\nconst medicalDecoration = '\\u200A✚'; //https://jkorpela.fi/chars/spaces.html\nconst medicalFormatter = (label, options) => {\n    return [\"case\", medicalCondition,\n        [\"format\",\n            label, {},\n            medicalDecoration, options\n        ],\n        label\n    ];\n};\n\n// -------------> FILTER\nconst adequateFilter = ({aircraftType, kmlOptions: {airportPin: style}}) => {\n    return (style === MEDICAL)\n        ? [\"all\", medicalCondition, adequateCondition(aircraftType)]\n        : adequateCondition(aircraftType);\n};\nconst etopsFilter = ({ofp, kmlOptions: {airportPin: style}}) => {\n    const [, etopsNames] = getEtopsNames(ofp);\n    const isEtops = [\"in\", [\"get\", \"name\"], [\"literal\", etopsNames]];\n    return (style === MEDICAL)\n        ? [\"all\", isEtops, medicalCondition]\n        : isEtops;\n};\nconst emergencyFilter = ({aircraftType, kmlOptions: {airportPin: style}}) => {\n    return (style === MEDICAL)\n        ? [\"to-boolean\", false]\n        : [\"!\", adequateCondition(aircraftType)];\n};\n\n// -------------> symbol-sort-key\nconst adequateSymbolSortKey = ({aircraftType, ofp}) => {\n    // maxPriority = 0\n    // medical = 1\n    // then by order field\n    const [, etopsNames] = getEtopsNames(ofp);\n    const maxPriorityNames = (ofp) ? [ofp.departure.name, ofp.arrival.name].concat(etopsNames) : etopsNames;\n    return [\"case\",\n    [\"in\", [\"get\", \"name\"], [\"literal\", maxPriorityNames]], 0,\n    [\"case\", medicalCondition, 1, [\"get\", `${aircraftType}`]]]\n};\n\n// -------------> icon-color\nconst adequateIconColorMap = {\n    [STATUS]: (aircraftType) => [\"case\",\n        [\"==\", 9, [\"get\", `${aircraftType}`]], '#ea80d8',\n        [\"==\", 8, [\"get\", `${aircraftType}`]], '#ea80d8',\n        [\"==\", 7, [\"get\", `${aircraftType}`]], '#dddddd',\n        [\"==\", 6, [\"get\", `${aircraftType}`]], '#dddddd',\n        [\"==\", 5, [\"get\", `${aircraftType}`]], '#fbfe98',\n        [\"==\", 4, [\"get\", `${aircraftType}`]], '#fbfe98',\n        [\"==\", 3, [\"get\", `${aircraftType}`]], '#00b0f1',\n        [\"==\", 2, [\"get\", `${aircraftType}`]], '#00b0f1',\n        '#000'\n    ],\n    [GREENRED]: () => [\"case\", level0Condition, '#095','#C71'],\n    [BLUEGREENRED]: () => [\"case\", level0Condition, [\"case\", medicalCondition, '#0525cc', '#095'],'#C71'],\n    [MEDICAL]: () => [\"case\", level0Condition, MEDICAL_COLOR,'#C71'],\n};\nconst adequateIconColor = ({aircraftType, kmlOptions: {airportPin: style}}) => {\n    return adequateIconColorMap[style](aircraftType);\n};\nconst emergencyIconColor = ({ofp}) => {\n    return (ofp) ?\n        [\"case\", levelCondition(1), '#D70', '#B02'] :\n        '#B02';\n};\nconst etopsIconColor = (data) => {\n    return [\"case\", raltCondition(data.ofp),\n        kml2mapColor(data.kmlOptions.etopsColor)[0],\n        adequateIconColor(data)\n    ];\n};\n\n// -------------> icon-image\nconst adequateIconImage = () => 'sdf-airport';\nconst etopsIconImage = () => 'sdf-triangle';\nconst emergencyIconImage = ({ofp}) => {\n    return (ofp) ? \n        [\"case\", levelCondition(2),\n            'sdf-star',\n            'sdf-airport'\n        ] :\n        'sdf-airport'\n};\n\n// -------------> icon-size\nconst interpolateIconSize = (size, mapOptions, magnification =1.8) => {\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n    return [\n        \"interpolate\", [\"linear\"], [\"zoom\"],\n        // zoom is 5 (or less) -> circle radius will be 1px\n        minZoom, size,\n        // zoom is 10 (or greater) -> circle radius will be 5px\n        maxZoom, size * magnification\n    ];\n};\nconst adequateIconSize = ({mapOptions, kmlOptions:{iconSizeChange: iconRatio}}) => {\nreturn interpolateIconSize(computeIconSize(iconRatio, 0.6), mapOptions);\n};\nconst etopsIconSize = ({mapOptions, kmlOptions:{iconSizeChange: iconRatio}}) => {\nreturn interpolateIconSize(computeIconSize(iconRatio, 1), mapOptions);\n};\nconst emergencyIconSize = ({mapOptions, kmlOptions: {iconSizeChange: iconRatio}}) => {\nreturn interpolateIconSize(computeIconSize(iconRatio, 0.5, 1.2), mapOptions);\n// return (ofpLoaded) ? [\"case\",\n// [\"==\", 2, [\"get\", \"level\"]], computeIconSize(iconRatio, 0.5, 1.2),\n// computeIconSize(iconRatio, 0.4, 1.2)] : computeIconSize(iconRatio, 0.4, 1.2);\n};\n\n// -------------> icon-halo-width\nconst adequateIconHaloWidth = ({ofp, kmlOptions: {airportPin: style}}) => (style === STATUS && !!ofp) ? 3 : 0;\nconst etopsIconHaloWidth = adequateIconHaloWidth;\nconst emergencyIconHaloWidth = () => 0;\n\n// -------------> icon-halo-color\nconst adequateIconHaloColor = ({ofp}) => {\n    return (ofp) ? \n        [\"case\", [\"==\", 0, [\"get\", \"level\"]], '#095','#D70'] :\n        '#444';\n};\nconst etopsIconHaloColor = adequateIconHaloColor;\nconst emergencyIconHaloColor = () => '#000';\n// -------------> text-color\nconst adequateTextColor = ({ofp}) => {\n    if (!ofp) return TEXT_COLOR;\n    return [\"case\", level0Condition,\n        TEXT_COLOR,\n        '#8d4600'\n    ];\n};\nconst etopsTextColor = ({ofp, kmlOptions:{etopsColor}}) => {\n        return [\"case\", raltCondition(ofp),\n            kml2mapColor(etopsColor)[0],\n            TEXT_COLOR\n        ];\n};\nconst emergencyTextColor = () => TEXT_COLOR;\n\n// -------------> text-field\nconst adequateTextField = ({kmlOptions: {airportPin: style, airportLabel: labelling}}) => {\n    const label = airportLabeller(labelling);\n    switch (style){\n        case BLUEGREENRED:\n        case MEDICAL:\n            return [\"case\", level0Condition, // only decorates level > 0\n                label,\n                medicalFormatter(label, {\"text-color\": '#0525cc', \"font-scale\": 1.1}),\n            ];\n        default:\n            return medicalFormatter(label, {\"text-color\": MEDICAL_COLOR, \"font-scale\": 1.1});\n    }\n};\nconst etopsTextField = ({ofp, kmlOptions: {airportPin: style, airportLabel: labelling}}) => {\n    const label = airportLabeller(labelling);\n    switch (style){\n        case BLUEGREENRED:\n        case MEDICAL:\n            return [\"case\", raltCondition(ofp), // only ralts are not \"blue\"\n                medicalFormatter(label, {\"text-color\": MEDICAL_COLOR, \"font-scale\": 1.1}),\n                label\n            ];\n        default:\n            return medicalFormatter(label, {\"text-color\": MEDICAL_COLOR, \"font-scale\": 1.1});\n    }\n};\nconst emergencyTextField = ({kmlOptions: {airportLabel: labelling}}) => {\n    return airportLabeller(labelling);\n};\n\n// -------------> text-size\nconst interpolateTextSize = (mapOptions, {ratio, size, magnification=2, extraFactor=1}) => {\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n    const textSize = computeIconTextSize(ratio, size, extraFactor);\n    return [\n        \"interpolate\", [\"linear\"], [\"zoom\"],\n        // zoom is 5 (or less) -> circle radius will be 1px\n        minZoom, textSize,\n        // zoom is 10 (or greater) -> circle radius will be 5px\n        maxZoom, textSize * magnification\n    ];\n};\nconst adequateTextSize = ({mapOptions, kmlOptions:{iconTextChange: ratio}}) => {\n    return interpolateTextSize(mapOptions, {ratio, size: 8, extraFactor: 1.15});\n};\nconst etopsTextSize = ({mapOptions, kmlOptions:{iconTextChange: ratio}}) => {\n    return interpolateTextSize(mapOptions, {ratio, size: 10});\n};\nconst emergencyTextSize =adequateTextSize;\n\n// -------------> text-halo-blur\nconst adequateTextHaloBlur = ({kmlOptions:{iconTextChange: ratio}}) => {\n    return haloTextBlur({ratio, size: 8, extraFactor: 1.15});\n};\nconst etopsTextHaloBlur = ({kmlOptions:{iconTextChange: ratio}}) => {\n    return haloTextBlur({ratio, size: 10});\n};\nconst emergencyTextHaloBlur = adequateTextHaloBlur;\n\n// -------------> text-halo-width\nconst adequateTextHaloWidth = ({kmlOptions:{iconTextChange: ratio}}) => {\n    return haloTextWidth({ratio, size: 8, extraFactor: 1.15});\n};\nconst etopsTextHaloWidth = ({kmlOptions:{iconTextChange: ratio}}) => {\n    return haloTextWidth({ratio, size: 10});\n};\nconst emergencyTextHaloWidth = adequateTextHaloWidth;\n\nexport const changeAdequatesColor = (data) => {\n    const map = data.map;\n    if (map.getLayer(adequateLayer)) {\n        map.setPaintProperty(adequateLayer, 'icon-color', adequateIconColor(data));\n        map.setPaintProperty(adequateLayer, 'text-color', adequateTextColor(data));\n    }\n    return true; // allows chaining\n};\nexport const changeAirportETOPSColor = (data) => {\n    const map = data.map;\n    if (map.getLayer(etopsLayer)) {\n        map.setPaintProperty(etopsLayer, 'icon-color', etopsIconColor(data));\n        map.setPaintProperty(etopsLayer, 'text-color', etopsTextColor(data));\n    }\n    return true; // allows chaining\n};\nexport const changeAirportETOPSDisplay = ({map}, visible) => {\n    if (map.getLayer(etopsLayer) ) {\n        map.setLayoutProperty(etopsLayer, 'visibility', (visible) ? 'visible': 'none');\n    }\n};\n\nfunction changeAirportDisplay({map}, visible) {\n    for (const layer of layers) {\n        if (map.getLayer(layer)) {\n            if (layer === etopsLayer) continue; //etops Layer is in charge\n            map.setLayoutProperty(layer, 'visibility', (visible) ? 'visible': 'none');\n        }\n    }\n}\nconst baseLayerOptions = {\n    'type': 'symbol',\n    'layout': {\n        'icon-anchor': 'center',\n        'icon-offset': [0, 0],\n        'icon-allow-overlap': true,\n        'icon-ignore-placement': true,\n        'text-offset': [0, 0.7],\n        'text-anchor': 'top',\n        'text-allow-overlap': false,\n        'text-ignore-placement': false,\n    },\n    'paint': {\n        'text-halo-color': haloLightColor,\n        'text-opacity': 0.8\n    }\n};\n\nexport const addAirports = (data) => {\n    const {map, mapData: {affineOrDrop: affine}, ofp, kmlOptions:{airportDisplay, etopsDisplay}} = data;\n    fetch('data/airports.CONF_AIRAC.geojson')\n    .then(response => response.json())\n    .then(json => {\n        if (affine) {\n            const projFeatures = [];\n            for (let feature of json.features) {\n                feature.geometry.coordinates = affine(feature.geometry.coordinates);\n                if(feature.geometry.coordinates !== undefined) projFeatures.push(feature);\n            }\n            json.features = projFeatures;\n        }\n        map.addSource(source, {\n            type: 'geojson',\n            data: json\n        });\n        const emergencyOptions = {...baseLayerOptions};\n        emergencyOptions.id = emergencyLayer;\n        emergencyOptions.source = source;\n        emergencyOptions.filter = emergencyFilter(data);\n        emergencyOptions.layout['icon-image'] = emergencyIconImage(data);\n        emergencyOptions.layout['icon-size'] = emergencyIconSize(data);\n        emergencyOptions.layout['visibility'] = (airportDisplay) ? 'visible' : 'none';\n        emergencyOptions.layout['text-field'] = emergencyTextField(data);\n        emergencyOptions.layout['text-size'] = emergencyTextSize(data);\n        emergencyOptions.paint['icon-color'] = emergencyIconColor(data);\n        emergencyOptions.paint['icon-halo-width'] = emergencyIconHaloWidth(data);\n        emergencyOptions.paint['icon-halo-color'] = emergencyIconHaloColor(data);\n        emergencyOptions.paint['text-color'] = emergencyTextColor(data);\n        emergencyOptions.paint['text-halo-width'] = emergencyTextHaloWidth(data);\n        map.addLayer(emergencyOptions);\n        const adequateOptions = {...baseLayerOptions};\n        adequateOptions.id = adequateLayer;\n        adequateOptions.source = source;\n        adequateOptions.filter = adequateFilter(data);\n        adequateOptions.layout['symbol-sort-key'] = adequateSymbolSortKey(data);\n        adequateOptions.layout['icon-image'] = adequateIconImage(data);\n        adequateOptions.layout['icon-size'] = adequateIconSize(data);\n        adequateOptions.layout['visibility'] = (airportDisplay) ? 'visible' : 'none';\n        adequateOptions.layout['text-field'] = adequateTextField(data);\n        adequateOptions.layout['text-size'] = adequateTextSize(data);\n        adequateOptions.paint['icon-color'] = adequateIconColor(data);\n        adequateOptions.paint['icon-halo-width'] = adequateIconHaloWidth(data);\n        adequateOptions.paint['icon-halo-color'] = adequateIconHaloColor(data);\n        adequateOptions.paint['text-color'] = adequateTextColor(data);\n        adequateOptions.paint['text-halo-width'] = adequateTextHaloWidth(data);\n        map.addLayer(adequateOptions);\n        const etopsOptions = {...baseLayerOptions};\n        etopsOptions.id = etopsLayer;\n        etopsOptions.source = source;\n        etopsOptions.filter = etopsFilter(data);\n        etopsOptions.layout['icon-image'] = etopsIconImage(data);\n        etopsOptions.layout['icon-size'] = etopsIconSize(data);\n        etopsOptions.layout['visibility'] = (etopsDisplay) ? 'visible' : 'none';\n        etopsOptions.layout['text-field'] = etopsTextField(data);\n        etopsOptions.layout['text-size'] = etopsTextSize(data);\n        etopsOptions.paint['icon-color'] = etopsIconColor(data);\n        etopsOptions.paint['icon-halo-width'] = etopsIconHaloWidth(data);\n        etopsOptions.paint['icon-halo-color'] = etopsIconHaloColor(data);\n        etopsOptions.paint['text-color'] = etopsTextColor(data);\n        etopsOptions.paint['text-halo-width'] = etopsTextHaloWidth(data);\n        map.addLayer(etopsOptions);\n\n \n        const addAirportPopup = function (e, {focusAfterOpen=false, closeOnMove=true, closeButton=true}={}) {\n            const coordinates = e.features[0].geometry.coordinates.slice();\n            const title = e.features[0].properties.title;\n            const icao = e.features[0].properties.name;\n            const iata = editolido.icao2iata(icao);\n            const aircraftType = get(aircraftTypeStore); // important to re-read store value when adding popup\n            const security = e.features[0].properties.level;\n            const order = e.features[0].properties[aircraftType];\n            //console.log(status, typeof status)\n            let statusText = \"\";\n            let statusNum = \"0\";\n            switch(order) {\n                case 2:\n                case 3:\n                    statusText = \"Destination & RCF\";\n                    statusNum = \"3\";\n                    break;\n                case 4:\n                case 5:\n                    statusText = \"Dégagement à destination\";\n                    statusNum = \"2\";\n                    break;\n                case 6:\n                case 7:\n                    statusText = \"Dégagement en route\";\n                    statusNum = \"2 ERA\";\n                    break;\n                case 8:\n                case 9:\n                    statusText = \"Appui ou adéquat en route\";\n                    statusNum = \"1\";\n                    break;\n            }\n            const isMedical = e.features[0].properties.h === 1 && statusNum !== \"0\";\n            const cc = e.features[0].properties.cc;\n            let html = `<div class=\"airport\">`\n            html += `<h1><span class=\"title\">${icao}/${iata}</span><span class=\"flag\">${countryCodeEmoji(cc)}</span><span class=\"cc\">${countryCodeName(cc)}</span></h1>`;\n            html += `<h2>${title}${(isMedical) ? ' <b>🄷</b>' : ''}</h2>`;\n            if (ofp) {\n                html +=  `<p class=\"status status-${statusNum.charAt(0)}\">STATUT ${statusNum}</p>`;\n                if(security > 0) html += `<p class=\"security-${security}\">${(security==1) ? 'ORANGE' : 'RED'}</p>`;\n                if(statusText) html += `<p class=\"status-text\">${statusText}</p>`;\n            }\n            html += \"</div>\";\n            let popup = new mapboxgl.Popup({closeButton, focusAfterOpen, closeOnMove});\n            popup.on('close', () => {\n                popup=undefined;\n            });\n            return popup.setLngLat(coordinates).setHTML(html).addTo(map);\n        };\n        let popup;\n        for (const layer of layers) {\n            map.on('mouseenter', layer, (e) => {\n                if (popup) popup.remove();\n                map.getCanvas().style.cursor = 'pointer';\n                popup = addAirportPopup(e, {closeButton: false});\n            });\n            map.on('mouseleave', layer, () => {\n                if (popup) popup.remove();\n                map.getCanvas().style.cursor = '';\n            });\n            map.on('click', layer, (e) => {\n                if (popup) popup.remove();\n                popup = addAirportPopup(e);\n            });\n        }\n    })\n};\n\nexport function changeAirportStyle(data) {\n    const map = data.map;\n    if (map.getLayer(adequateLayer)) {\n        changeAdequatesColor(data);\n        map.setPaintProperty(adequateLayer, 'icon-halo-width', adequateIconHaloWidth(data));\n        map.setLayoutProperty(adequateLayer, 'text-field', adequateTextField(data));\n        map.setFilter(adequateLayer, adequateFilter(data));\n    }\n    if (map.getLayer(etopsLayer)) {\n        changeAirportETOPSColor(data);\n        map.setPaintProperty(etopsLayer, 'icon-halo-width', etopsIconHaloWidth(data));\n        map.setLayoutProperty(etopsLayer, 'text-field', etopsTextField(data));\n        map.setFilter(etopsLayer, etopsFilter(data));\n    }\n    if (map.getLayer(emergencyLayer)) map.setFilter(emergencyLayer, emergencyFilter(data));\n}\n\nexport function changeAircraftType(data) {\n    const map = data.map;\n    map.setFilter(adequateLayer, adequateFilter(data));\n    map.setFilter(etopsLayer, etopsFilter(data));\n    map.setFilter(emergencyLayer, emergencyFilter(data));\n    changeAdequatesColor(data);\n    changeAirportETOPSColor(data);\n    map.setLayoutProperty(adequateLayer, 'symbol-sort-key', adequateSymbolSortKey(data));\n}\n\nconst changeIconText = (data) => {\n    const map = data.map;\n    if (map.getLayer(adequateLayer)) {\n        map.setLayoutProperty(adequateLayer, 'text-size', adequateTextSize(data));\n        map.setPaintProperty(adequateLayer, 'text-halo-width', adequateIconHaloWidth(data));\n        map.setPaintProperty(adequateLayer, 'text-halo-blur', adequateTextHaloBlur(data));\n    }\n    if (map.getLayer(etopsLayer)) {\n        map.setLayoutProperty(etopsLayer, 'text-size', etopsTextSize(data));\n        map.setPaintProperty(etopsLayer, 'text-halo-width', etopsIconHaloWidth(data));\n        map.setPaintProperty(etopsLayer, 'text-halo-blur', etopsTextHaloBlur(data));\n    }\n    if (map.getLayer(emergencyLayer)) {\n        map.setLayoutProperty(emergencyLayer, 'text-size', emergencyTextSize(data));\n        map.setPaintProperty(emergencyLayer, 'text-halo-width', emergencyIconHaloWidth(data));\n        map.setPaintProperty(emergencyLayer, 'text-halo-blur', emergencyTextHaloBlur(data));\n    }\n}\nconst changeIconSize = (data) => {\n    const map = data.map;\n    if (map.getLayer(adequateLayer)) {\n        map.setLayoutProperty(adequateLayer, 'icon-size', adequateIconSize(data));\n    }\n    if (map.getLayer(etopsLayer)) {\n        map.setLayoutProperty(etopsLayer, 'icon-size', etopsIconSize(data));\n    }\n    if (map.getLayer(emergencyLayer)) {\n        map.setLayoutProperty(emergencyLayer, 'icon-size', emergencyIconSize(data));\n    }\n}\n\nconst changeLabel = (data) => {\n    const map = data.map;\n    if (map.getLayer(adequateLayer)) {\n        map.setLayoutProperty(adequateLayer, 'text-field', adequateTextField(data));\n    }\n    if (map.getLayer(etopsLayer)) {\n        map.setLayoutProperty(etopsLayer, 'text-field', etopsTextField(data));\n    }\n    if (map.getLayer(emergencyLayer)) {\n        map.setLayoutProperty(emergencyLayer, 'text-field', emergencyTextField(data));\n    }\n};\n\nexport default {\n    show: (data) => changeAirportDisplay(data, true),\n    hide: (data) => changeAirportDisplay(data, false),\n    add: addAirports,\n    changeMarker: changeAirportStyle,\n    change: changeAircraftType,\n    changeIconText,\n    changeIconSize,\n    changeLabel\n}","import {addLines, computeLineWidthSize} from '../utils';\nimport {changeAirportETOPSColor, changeAirportETOPSDisplay} from './airport';\nimport {kml2mapColor} from \"../../mapSettings/ColorPinCombo.svelte\";\n\nconst folder = 'etops';\nconst lineWidthETOPS = 1;\nconst epCircleLayer = `${folder}-ep-circle-line-layer`;\nconst etopsCircleLayer = `${folder}-etops-circle-line-layer`;\nfunction addEtops(data) {\n    const {map, mapData, ofp, kmlOptions} = data;\n    if (!ofp) return;\n    const lineWidth = computeLineWidthSize(kmlOptions['lineWidthChange'], lineWidthETOPS);\n    if (ofp.infos['EEP'] && ofp.infos['EXP'] && ofp.infos['raltPoints'].length > 0) {\n        const {affineAndClip} = mapData;\n        const etopsTime = ofp.infos.maxETOPS;\n        const visibility = kmlOptions.etopsDisplay;\n        addLines(map, `${folder}-ep-circle`, [ofp.infos['EEP'].circle(420, 48), ofp.infos['EXP'].circle(420, 48)] , affineAndClip, kmlOptions.routeColor, visibility, lineWidth, true);\n        addLines(map, `${folder}-etops-circle`, ofp.infos['raltPoints'].map(d => d.circle(7 * etopsTime)), affineAndClip, kmlOptions.etopsColor, visibility, lineWidth, true);\n        changeAirportETOPSDisplay(data, visibility);\n    }\n}\n\nexport function changeEPCircleColor({map, kmlOptions:{routeColor}}) {\n    const [hexcolor, opacity] = kml2mapColor(routeColor);\n    if (map.getLayer(epCircleLayer)) {\n        map.setPaintProperty(epCircleLayer, 'line-color', hexcolor);\n        map.setPaintProperty(epCircleLayer, 'line-opacity', opacity);\n    }\n}\n\nfunction changeETOPSCircleColor(data) {\n    const {map} = data;\n    const [hexcolor, opacity] = kml2mapColor(data.value);\n    if (map.getLayer(etopsCircleLayer)) {\n        map.setPaintProperty(etopsCircleLayer, 'line-color', hexcolor);\n        map.setPaintProperty(etopsCircleLayer, 'line-opacity', opacity);\n    }\n    changeAirportETOPSColor(data);\n}\n\nfunction changeETOPSDisplay(data, visible) {\n    const {map} = data;\n    if (map.getLayer(etopsCircleLayer)) {\n        map.setLayoutProperty(etopsCircleLayer, 'visibility', (visible) ? 'visible': 'none');\n    }\n    if (map.getLayer(epCircleLayer)) {\n        map.setLayoutProperty(epCircleLayer, 'visibility', (visible) ? 'visible': 'none');\n    }\n    changeAirportETOPSDisplay(data, visible);\n}\nfunction changeLineWidth(data){\n    const {map, value} = data;\n    const lineWidth = computeLineWidthSize(value, lineWidthETOPS);\n    if (map.getLayer(etopsCircleLayer)) {\n        map.setPaintProperty(etopsCircleLayer, 'line-width', lineWidth);\n    }\n    if (map.getLayer(epCircleLayer)) {\n        map.setPaintProperty(epCircleLayer, 'line-width', lineWidth);\n    }\n    return true; // allows chaining\n}\nexport default {\n    show: (data) => changeETOPSDisplay(data, true),\n    hide: (data) => changeETOPSDisplay(data, false),\n    add: addEtops,\n    changeLine: (data) => changeETOPSCircleColor(data),\n    changeLineWidth\n}\n","/* global editolido */\nimport {addLine, addPoints, changeDisplayGeneric, changeLineGeneric, changeIconTextGeneric, changeLineWidthGeneric, changeIconSizeGeneric, computeLineWidthSize} from '../utils';\n\nconst folder = 'ralt';\n\nconst addRalt = (data) => {\n    const {map, ofp, kmlOptions, mapData, mapOptions} = data;\n    if (!ofp) return;\n    const {affineAndClip, affineOrDrop} = mapData;\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n    const alternateRoute = new editolido.Route(ofp.wptCoordinatesAlternate(), {\"name\": \"Route Dégagement\"});\n    const lineWidth = computeLineWidthSize(kmlOptions['lineWidthChange']);\n    addLine(map, folder, alternateRoute.points, affineAndClip, kmlOptions.alternateColor, kmlOptions.alternateDisplay, lineWidth);\n    addPoints(map, folder, alternateRoute.points, affineOrDrop, kmlOptions, minZoom, maxZoom);\n}\n\nexport default {\n    show: changeDisplayGeneric.bind(null, folder, true),\n    hide: changeDisplayGeneric.bind(null, folder, false),\n    add: addRalt,\n    changeLine: changeLineGeneric.bind(null, folder),\n    changeIconText: changeIconTextGeneric.bind(null, folder),\n    changeLineWidth: changeLineWidthGeneric.bind(null, folder),\n    changeIconSize: changeIconSizeGeneric.bind(null, folder)\n}","/* global mapboxgl, editolido */\nimport {jsonPoint, jsonLine, featureCollection} from '../json.js';\nimport {lineLayer, markerLayer, changeLineWidthGeneric, changeLineGeneric, changeDisplayGeneric, computeIconTextSize, computeLineWidthSize, computeIconSize, getTextKmlColorExpression, getOpacityKmlColorExpression, changeIconSizeGeneric, changeIconTextGeneric, interpolateTextSize, getContrastColor, haloTextBlur, haloTextWidth} from '../utils';\nimport {takeOffTime} from \"../../../stores\";\n\nconst folder = 'rnat';\nconst lineWidthTracks = 1;\nconst minTextOpacityTracks = 0.9;\n\nconst rnatLabelLayer = (id, kmlcolor, visibility, textSize, minZoom, maxZoom) => {\n    return {\n        'id': `${id}-marker-layer`,\n        'type': 'symbol',\n        'source': `${id.replace('-labels', '')}-line-source`,\n        'layout': {\n            'visibility': ( visibility) ? 'visible' : 'none',\n            'text-field': ['get', 'title'],\n            'text-size': interpolateTextSize(textSize, minZoom, maxZoom),\n            'text-offset': [0, -0.1],\n            'text-anchor': 'bottom',\n            'text-ignore-placement': true,\n            'text-allow-overlap': true,\n            'symbol-placement': 'line-center'\n        },\n        'paint': {\n            'text-halo-color': '#000',\n            'text-color': getTextKmlColorExpression(kmlcolor),\n            'text-opacity': getOpacityKmlColorExpression(kmlcolor, null, minTextOpacityTracks)\n        }\n    };\n};\nfunction addTracks(data) {\n    const {map, ofp, mapData, kmlOptions, mapOptions} = data;\n    if (!ofp) return;\n    const {affineOrDrop, affineAndClip} = mapData;\n    const affine = affineOrDrop;\n    const affineLine = affineAndClip;\n    const kmlcolor = kmlOptions.natColor;\n    const visibility = kmlOptions.natDisplay;\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n\n    const lines = {\n        'rnat': [],\n        'rnat-incomplete': []\n    };\n    const markers = {\n        'rnat': [],\n        'rnat-incomplete': []\n    };\n    for (let track of ofp.tracks) {\n        const folder = (track.isComplete) ? 'rnat' : 'rnat-incomplete';\n        const natLetter = track.name.slice(-1);\n        const natDirection = track.infos.direction;\n        const natLabel = (natDirection === 'WEST') ? `<\\u2009${natLetter}` : (natDirection === 'EAST') ? `${natLetter}\\u2009>` : natLetter;\n        if (affineLine) {\n            const sublines = affineLine(track.points);\n            const sublen = sublines.length;\n            for (let i=0; i<sublen;i++){\n                lines[folder].push(jsonLine(sublines[i], {title: natLabel}));\n            }\n        }else{\n            lines[folder].push(jsonLine(track.points.map(g => [g.longitude, g.latitude]), {title: track.name.slice(-1)}))\n        }\n        const firstPoint = track.points[0];\n        let lngLat = (affine) ? affine([firstPoint.longitude, firstPoint.latitude]) : [firstPoint.longitude, firstPoint.latitude];\n        if (lngLat) markers[folder].push(jsonPoint(lngLat, {\n            title: `${(track.isMine) ? track.name + '\\n' : ''}${firstPoint.name}`,\n            description: track.description,\n            track: track.name,\n            point: firstPoint.name,\n            isMine: track.isMine,\n            direction: natDirection,\n            overrideTextColor: (track.isMine) ? 1 : 0\n        }));\n        const lastPoint = track.points[track.points.length - 1];\n        lngLat = (affine) ? affine([lastPoint.longitude, lastPoint.latitude]) : [lastPoint.longitude, lastPoint.latitude];\n        if (lngLat) markers[folder].push(jsonPoint(lngLat,{\n            title: `${(track.isMine) ? track.name + '\\n' : ''}${lastPoint.name}`,\n            description:  track.description,\n            track: track.name,\n            point: lastPoint.name,\n            isMine: track.isMine,\n            direction: natDirection,\n            noPin: 1,\n            overrideTextColor: (track.isMine) ? 1 : 0\n        }));\n    }\n    map.addSource(`rnat-marker-source`, featureCollection(markers['rnat']));\n    map.addSource(`rnat-incomplete-marker-source`, featureCollection(markers['rnat-incomplete']));\n    map.addSource(`rnat-line-source`, featureCollection(lines['rnat']));\n    map.addSource(`rnat-incomplete-line-source`, featureCollection(lines['rnat-incomplete']));\n    const textSize = computeIconTextSize(kmlOptions[`iconTextChange`]);\n    const lineWidth = computeLineWidthSize(kmlOptions[`lineWidthChange`], lineWidthTracks);\n    const iconSize = computeIconSize(kmlOptions[`iconSizeChange`]);\n    map.addLayer(lineLayer('rnat', kmlcolor, visibility, lineWidth));\n    map.addLayer(lineLayer('rnat-incomplete', kmlOptions.natIncompleteColor, visibility, lineWidth));\n    map.addLayer(markerLayer(\"rnat\", kmlcolor, visibility, textSize, iconSize, minZoom, maxZoom));\n    changeMyTrackLabels(data); // text-color & text-opacity for entry/exit point\n    map.setLayoutProperty(\"rnat-marker-layer\", 'symbol-sort-key', [\"case\", [\"==\", 1, [\"get\", \"overrideTextColor\"]], 0, 1]);\n    map.addLayer(markerLayer(\"rnat-incomplete\", kmlcolor, visibility, textSize, iconSize, minZoom, maxZoom));\n    map.addLayer(rnatLabelLayer('rnat-labels', kmlcolor, visibility, textSize, minZoom, maxZoom));\n    map.addLayer(rnatLabelLayer('rnat-incomplete-labels', kmlOptions.natIncompleteColor, visibility, textSize, minZoom, maxZoom));\n\n    const popup = (e, {closeButton=true, focusAfterOpen=false, closeOnMove=true}={}) => {\n        const coordinates = e.features[0].geometry.coordinates.slice();\n        // Ensure that if the map is zoomed out such that multiple\n        // copies of the feature are visible, the popup appears\n        // over the copy being pointed to.\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n        const props = e.features[0].properties; // WARNING properties created above or in addEntryPointPopup below\n        //console.log(props);\n        let trackPopup = new mapboxgl.Popup({closeButton, focusAfterOpen, closeOnMove});\n        trackPopup.setLngLat(coordinates);\n        const unsubscribe = takeOffTime.subscribe($takeOffTime => {\n            let description = props.description.replace(props.point, `<b>${props.point}</b>`);\n            let entry = [undefined, undefined, undefined];\n            if (props.isMine) entry = ofp.timeMatrix.filter(([p,]) => editolido.isARINC(props.point) ? editolido.arinc_normalizer(props.point).asDM === p.name: props.point === p.name).pop() || entry;\n            const [, eet, fl] = entry;\n            let flInTitle = (fl) ? ` - FL${fl}` : '';\n            const direction = (props.direction === 'WEST') ? 'WB' : (props.direction === 'EAST') ? 'EB' : '';\n            if (fl) {\n                if (direction) {\n                    const pattern = new RegExp(String.raw`(LVLS ${direction})([\\d\\s]*)( ${fl} )`, \"u\");\n                    const highlighted = description.replace(pattern, \"<strong>$1</strong>$2<strong><b>$3</b></strong>\");\n                    if (description != highlighted) {\n                        description = highlighted;\n                    }else{\n                        description = description.replace(`LVLS ${direction}`, `<strong class=\"error\">LVLS ${direction}</strong>`);\n                    }\n                }\n            }\n            const eto = (eet && $takeOffTime) ? ' - ETO: ' + (new Date($takeOffTime.getTime() + 60000 * eet)).toISOString().substring(11,16) + 'z' : '';\n            let html = `<div class=\"track\"><h1>${props.track}${eto}${flInTitle}</h1><p>${description}</p>`;\n            trackPopup.setHTML(html);\n        });\n        const closePopup = () => {\n            unsubscribe();\n            if (trackPopup) trackPopup.off('close', closePopup);\n            trackPopup = undefined;\n            map.getCanvas().focus();\n        };\n        trackPopup.on('close', closePopup);\n        return trackPopup.addTo(map);\n    };\n    let trackPopup;\n    for (const layer of ['rnat-marker-layer', 'rnat-incomplete-marker-layer']) {\n        map.on('click', layer, function(e) {\n            if (trackPopup) trackPopup.remove();\n            trackPopup = popup(e, {closeOnMove: false});\n        });\n        map.on('mouseenter', layer, function(e) {\n            map.getCanvas().style.cursor = 'pointer';\n            if (trackPopup) trackPopup.remove();\n            trackPopup = popup(e, {closeButton: false});\n        });\n        map.on('mouseleave', layer, function() {\n            if (trackPopup) trackPopup.remove();\n            map.getCanvas().style.cursor = '';\n        });\n    }\n    const addEntryPointPopup = () => {\n        const myTrack = ofp.tracks.filter(t => t.isMine).pop();\n        if (myTrack && myTrack.points.length > 0) {\n            const entryPoint = myTrack.points[0];\n            const affine = mapData.affineOrDrop;\n            const lngLat = (affine) ? affine([entryPoint.longitude, entryPoint.latitude]) : [entryPoint.longitude, entryPoint.latitude];\n            if (lngLat) {\n                const [longitude, latitude] = lngLat;\n                const popupData = {\n                    lngLat:{\n                        \"lng\": longitude,\n                        \"lat\": latitude\n                    },\n                    features: [\n                        {\n                            \"properties\": {\n                                \"track\": myTrack.name,\n                                \"point\": entryPoint.name,\n                                \"isMine\": true,\n                                \"description\": myTrack.description,\n                                \"direction\": myTrack.infos.direction\n                            },\n                            \"geometry\": {\n                                'coordinates': [longitude, latitude]\n                            }\n                        }\n                    ]\n                };\n                popup(popupData, {closeButton:true, focusAfterOpen: false, closeOnMove: false}); //TODO on iPad if the close button has focus, we can't close with keyboard\n            }\n        }\n    };\n    if (mapData.initialLoad) addEntryPointPopup();\n}\n\nfunction changeLine(data){\n    changeLineGeneric(folder, data) && changeLineGeneric('rnat-labels', data);\n    changeMyTrackLabels(data);\n    return true; // allows chaining\n}\nfunction changeIconText(data) {\n    [folder, 'rnat-incomplete', 'rnat-labels', 'rnat-incomplete-labels'].forEach(folder => changeIconTextGeneric(folder, data));\n    changeMyTrackLabels(data);\n}\nexport function changeMyTrackLabels(data) {\n    const {map, kmlOptions} = data;\n    const markerLayer = `rnat-marker-layer`;\n    const rmainLayer = 'rmain-marker-layer';\n    if (map.getLayer(markerLayer)) {\n        const ratio = kmlOptions.iconTextChange;\n        map.setPaintProperty(markerLayer, 'text-color', getTextKmlColorExpression(kmlOptions[\"natColor\"], kmlOptions[\"routeColor\"]));\n        map.setPaintProperty(markerLayer, 'text-opacity', getOpacityKmlColorExpression(kmlOptions[\"natColor\"], kmlOptions[\"routeColor\"], minTextOpacityTracks));\n        if (map.getLayer(rmainLayer)){\n            const opacityProperty = map.getPaintProperty(rmainLayer, 'text-opacity');\n            const contrastColor = getContrastColor(kmlOptions.routeColor, opacityProperty);\n            const condition = [\"==\", 1, [\"get\", \"overrideTextColor\"]];\n            map.setPaintProperty(markerLayer, 'text-halo-color', [\"case\", condition, contrastColor, \"rgba(0, 0, 0, 0)\"]);\n            map.setPaintProperty(markerLayer, 'text-halo-width', [\"case\", condition, haloTextWidth({ratio}), 0]);\n            map.setPaintProperty(markerLayer, 'text-halo-blur', [\"case\", condition, haloTextBlur({ratio}), 0]);\n        }\n    }\n    return true; // allows chaining\n}\nexport default {\n    show: (data) => [folder, 'rnat-incomplete', 'rnat-labels', 'rnat-incomplete-labels'].forEach(folder => changeDisplayGeneric(folder, true, data)),\n    hide: (data) => [folder, 'rnat-incomplete', 'rnat-labels', 'rnat-incomplete-labels'].forEach(folder => changeDisplayGeneric(folder, false, data)),\n    add: addTracks,\n    changeLine,\n    changeIconText,\n    changeLineWidth: (data) => [folder, 'rnat-incomplete'].forEach(folder => changeLineWidthGeneric(folder, data, lineWidthTracks)),\n    changeIconSize: (data) => [folder, 'rnat-incomplete'].forEach(folder => changeIconSizeGeneric(folder, data))\n}","import {addLine, addPoints, changeDisplayGeneric, changeLineGeneric, changeIconTextGeneric, changeLineWidthGeneric, changeIconSizeGeneric, computeLineWidthSize, getContrastColor, haloTextBlur, haloTextWidth} from '../utils';\nimport {changeEPCircleColor} from './etops';\nimport {changeMyTrackLabels} from './tracks';\n\nconst folder = 'rmain';\n\nconst addRmain = (data) => {\n    const {map, ofp, kmlOptions, mapData, mapOptions} = data;\n    if (!ofp) return;\n    const {affineAndClip, affineOrDrop} = mapData;\n    const minZoom = mapOptions.interpolateMinZoom || mapOptions.mapboxOptions.minZoom || 0;\n    const maxZoom = mapOptions.interpolateMaxZoom || mapOptions.mapboxOptions.maxZoom || 10;\n    const route = ofp.route;\n    route.name = `${ofp.infos.depICAO}-${ofp.infos.destICAO}`;\n    route.description = ofp.description;\n    const lineWidth = computeLineWidthSize(kmlOptions['lineWidthChange']);\n    addLine(map, folder, route.points, affineAndClip, kmlOptions.routeColor, true, lineWidth);\n    addPoints(map, folder, route.points, affineOrDrop, kmlOptions, minZoom, maxZoom);\n    setTextHalo(data);\n}\n\nconst changeLine = (data) => {\n    changeLineGeneric(folder, data);\n    changeEPCircleColor(data);\n    changeMyTrackLabels(data);\n    setTextHalo(data);\n    return true; // allows chaining\n}\nfunction setTextHalo(data){\n    const {map, kmlOptions} = data;\n    const ratio = kmlOptions.iconTextChange;\n    const markerLayer = `${folder}-marker-layer`;\n    if (map.getLayer(markerLayer)) {\n        const opacityProperty = map.getPaintProperty(markerLayer, 'text-opacity');\n        const contrastColor = getContrastColor(kmlOptions.routeColor, opacityProperty);\n        map.setPaintProperty(markerLayer, 'text-halo-color', contrastColor);\n        map.setPaintProperty(markerLayer, 'text-halo-width', haloTextWidth({ratio}));\n        map.setPaintProperty(markerLayer, 'text-halo-blur', haloTextBlur({ratio}));\n    }\n    return true; // allows chaining\n}\nexport default {\n    show: changeDisplayGeneric.bind(null, folder, true),\n    hide: changeDisplayGeneric.bind(null, folder, false),\n    add: addRmain,\n    changeLine,\n    changeIconText: (data) => changeIconTextGeneric(folder, data) && setTextHalo(data),\n    changeLineWidth: changeLineWidthGeneric.bind(null, folder),\n    changeIconSize: changeIconSizeGeneric.bind(null, folder)\n}","import { folderName } from '../utils';\nimport airport from './layers/airport';\nimport etops from './layers/etops';\nimport fir from './layers/fir-reg';\nimport greatCircle from './layers/great-circle';\nimport ogimet from './layers/ogimet';\nimport ralt from './layers/ralt';\nimport rmain from './layers/rmain';\nimport tracks from './layers/tracks';\n\nconst layers = [ // order is important, so Array instead of dict\n    ['fir', fir],\n    ['airport', airport],\n    ['etops', etops],\n    ['greatcircle', greatCircle],\n    ['ogimet', ogimet],\n    ['ralt', ralt],\n    ['rmain', rmain],\n    ['rnat', tracks]\n];\nexport const loadMapLayers = (data) => {\n    const {map, mapOptions} = data;\n    if (mapOptions.tiles) {\n        map.addSource('jb-raster',{\n            'type': 'raster',\n            'tiles': mapOptions.tiles,\n            'tileSize': mapOptions.tileSize,\n        });\n        map.addLayer({\n            'id': 'jb-layer',\n            'type': 'raster',\n            'source': 'jb-raster',\n            'minzoom': 0,\n            'maxzoom': 22,\n            paint:{\n                'raster-opacity': 1\n            }\n        });\n    }\n    layers.forEach(([,layer]) => layer.add && layer.add(data));\n}\n\nexport const updateMapLayers = (data) => {\n    const {name, value} = data;\n    const folder = folderName(name);\n    if (folder === 'icontext') {\n        return layers.forEach(([,layer]) => layer.changeIconText && layer.changeIconText(data));\n    }else if (folder === 'linewidth'){\n        return layers.forEach(([,layer]) => layer.changeLineWidth && layer.changeLineWidth(data));\n    }else if (folder === 'iconsize'){\n        return layers.forEach(([,layer]) => layer.changeIconSize && layer.changeIconSize(data));\n    }\n    const module = Object.fromEntries(layers)[folder];\n    if (module) {\n        if (name.endsWith('-display')){\n            (value) ? module.show && module.show(data) : module.hide && module.hide(data);\n        }else if (name.endsWith('-hide')){\n            module.hide && module.hide(data);\n        }else if (name.endsWith('-label')) {\n            module.changeLabel && module.changeLabel(data);\n        }else if (name.endsWith('-pin')) {\n            module.changeMarker && module.changeMarker(data);\n        }else if (name.endsWith('-color')) {\n            module.changeLine && module.changeLine(data);\n        }else if (name.endsWith('-change')) {\n            module.change && module.change(data);\n        }else{\n            console.error(`ignoring map layer update for ${name}`);\n        }\n    }else{\n        console.error(`unknown layer ${name} / folder ${folder}`);\n    }\n}\n\nexport default layers","const TWO_PI = Math.PI * 2;\nconst FORTPI = Math.PI / 4;\nconst SPI = 3.14159265359;\nconst sign = function(x) {\n    return x<0 ? -1 : 1;\n}\nconst adjust_lon = function(x) {\n  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));\n}\n/*\n    reference\n    The Times projection\n    Flattening the Earth, Snyder, J.P., 1993, p.213-214.\n  */\n\n\n/* Initialize the Times projection\n    -------------------------------------------*/\nexport function init() {\n    //no-op\n}\n\n/* The Times forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------*/\nexport function forward(p) {\n    var lon = p.x;\n    var lat = p.y;\n    var dlon = adjust_lon(lon - this.long0);\n    var T = Math.tan(lat/2.0);\n    var S = Math.sin(FORTPI * T);\n    var S2 = S*S;\n    var x = this.x0 + (this.a * dlon  * (0.74482 - 0.34588*S2));\n    var y = this.y0 + (this.a * 1.70711 *  T);\n    p.x = x;\n    p.y = y;\n    return p;\n}\n\n/* The Times inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n    p.x -= this.x0;\n    p.y -= this.y0;\n    var T = p.y / 1.70711 / this.a;\n    var S = Math.sin(FORTPI * T);\n    var S2 = S*S;\n    var lon = adjust_lon(this.long0 + (p.x / this.a / (0.74482 - 0.34588 * S2)));\n    var lat = 2 * Math.atan(T);\n\n    p.x = lon;\n    p.y = lat;\n    return p;\n}\n\nexport var names = [\"The Times\", \"times\"];\nexport default {\n    init: init,\n    forward: forward,\n    inverse: inverse,\n    names: names\n};","\nconst epsilon2 = 1e-12;\nconst abs = Math.abs;\nconst asin = Math.asin;\nconst cos = Math.cos;\nconst sin = Math.sin;\nconst sqrt = Math.sqrt;\n/*\n    reference\n    https://github.com/d3/d3-geo/blob/master/src/projection/equalEarth.js\n  */\n\n    const A1 = 1.340264,\n    A2 = -0.081106,\n    A3 = 0.000893,\n    A4 = 0.003796,\n    M = sqrt(3) / 2,\n    iterations = 12;\n\n\n/* Initialize the Equal Earth projection\n    -------------------------------------------*/\nexport function init() {\n    //lat=phi long=lambda\n    //equations considers x0=y0=long0=0\n}\n\n/* The Equal Earth forward equations--mapping lat,long to x,y \n    ------------------------------------------------------------*/\nexport function forward(p) {\n    const lambda = p.x;\n    const phi = p.y;\n    const l = asin(M * sin(phi)), l2 = l * l, l6 = l2 * l2 * l2;\n    p.x = this.a * lambda * cos(l) / (M * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2)));\n    p.y = this.a * l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2));\n    return p;\n}\n\n/* The Equal Earth inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n    const y = p.y / this.a;\n    const x = p.x / this.a;\n\n    let l = y, l2 = l * l, l6 = l2 * l2 * l2;\n    for (var i = 0, delta, fy, fpy; i < iterations; ++i) {\n        fy = l * (A1 + A2 * l2 + l6 * (A3 + A4 * l2)) - y;\n        fpy = A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2);\n        l -= delta = fy / fpy, l2 = l * l, l6 = l2 * l2 * l2;\n        if (abs(delta) < epsilon2) break;\n    }\n\n    p.x =  M * x * (A1 + 3 * A2 * l2 + l6 * (7 * A3 + 9 * A4 * l2)) / cos(l);\n    p.y = asin(sin(l) / M);\n    return p;\n}\n\nexport var names = [\"Equal Earth\", \"eqearth\"];\nexport default {\n    init: init,\n    forward: forward,\n    inverse: inverse,\n    names: names\n};","/* global mapboxgl */\n\nimport {clamp, isInside, lineclip, getBounds, throttle, focusMap} from '../utils';\nimport {loadMapLayers} from './layersManagement';\nimport {focusMode, sidebar, showPlaneOnMap, mapZoom} from '../../stores';\nimport times from './pj_times';\nimport eqearth from './pj_eqearth';\n\nexport const token = 'MAPBOX_TOKEN';\n\nexport const key = {};\n\nexport const mapControlHTML = focusMode => (\n    (focusMode) \n    ? '<svg><use xlink:href=\"#single-layer-symbol\"/></svg>'\n    : '<svg><use xlink:href=\"#layers-symbol\"/></svg>');\n\nexport function createMap(id, mapOptions, ofp, kmlOptions, aircraftType, onLoadCb, initialLoad=false) {\n    if (!window.proj4.Proj.projections.get('times')) window.proj4.Proj.projections.add(times);\n    if (!window.proj4.Proj.projections.get('eqearth')) window.proj4.Proj.projections.add(eqearth);\n    const customAttribution = () => {\n        const airportsAttribution = 'Airports/FIR © Olivier Ravet';\n        if (mapOptions.id.startsWith('ed_eqe')) {\n            return `© equal-earth.com - ${airportsAttribution}`;\n        } else if (mapOptions.id.startsWith('jb_') || mapOptions.id.startsWith('ed_')) {\n            return `Yammer/QGIS & Avenza maps - ${airportsAttribution}`;\n        } else if (mapOptions.id.startsWith('vb_')) {\n            return `© ${window.atob(\"Q2FydGFCb3NzeQ==\")}.com - Airports © Olivier Ravet`;\n        } else{\n            return `Yammer/Maps.me - ${airportsAttribution}`;\n        }\n    }\n    let mapboxOptions = {\n        'container':id,\n        'center': [0, 49],\n        'zoom': 2,\n        'attributionControl': true,\n        'customAttribution': customAttribution()\n    }\n    const map = new mapboxgl.Map({...mapOptions.mapboxOptions, ...mapboxOptions});\n    map._setCacheLimits(320, 32);\n    map.loadImage('sdf/maki-marker-sdf.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('sdf-marker-15', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    map.loadImage('sdf/map-triangle-sdf.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('sdf-triangle', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    map.loadImage('sdf/map-circle-sdf.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('sdf-airport', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    map.loadImage('sdf/map-star-sdf.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('sdf-star', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    map.loadImage('images/stripe-orange.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('stripe-orange', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    map.loadImage('images/stripe-red.png', function(error, image) {\n        if (error) {\n            console.log(error);\n        } else {\n            map.addImage('stripe-red', image, { pixelRatio: 2, sdf: true});\n        }\n    });\n    // definitions from epsg.io\n    //https://epsg.io/4326\n    window.proj4.defs('WGS84', \"+proj=longlat +datum=WGS84\");\n    //https://epsg.io/3857\n    window.proj4.defs(\"EPSG:3857\",\"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs\");\n    let affine, affineAndClamp, affineOrDrop, affineAndClip;\n    let affine2xy = (lngLat) => window.proj4('WGS84', 'EPSG:3857', lngLat);\n    let xy2wgs84 = (xy) => window.proj4('EPSG:3857', 'WGS84', xy);\n    let reverseLngLat = (lngLat) => window.proj4('EPSG:3857', 'WGS84', window.proj4('WGS84', 'EPSG:3857', lngLat));\n    if (mapOptions.extent) {\n        window.proj4.defs('CUSTOM', mapOptions.proj4);\n        let a, b, c, d;\n        if (mapOptions.affineTransform) {\n            [a, b, c, d] = mapOptions.affineTransform;\n        }else{\n            const mercatorBounds = [-20026376.39, -20048966.10, 20026376.39, 20048966.10]; //EPSG:3857 bounds\n            const [x0, y0, x1, y1] = mapOptions.extent;\n            let [u0, v0, u1, v1] = mercatorBounds;\n            if (mapOptions.ratio) { /* this is not exact, still in progress */\n                const mercatorHeight = mercatorBounds[3] - mercatorBounds[1];\n                const [w, h] = mapOptions.ratio;\n                const dy = (h / w) * mercatorHeight;\n                [u0, v0, u1, v1] = [mercatorBounds[0], mercatorBounds[3] - dy, mercatorBounds[2],  mercatorBounds[3]];\n            }\n            a = (u1 - u0) / (x1 - x0);\n            b = u0 - (a * x0);\n            c = (v1 - v0) / (y1 - y0);\n            d = v0 - (c * y0);\n            //console.log(a,b,c,d)\n        }\n        const [minX, minY, maxX, maxY] = (mapOptions.viewport) ? mapOptions.viewport : mapOptions.extent;\n        const customXY = (lngLat) => window.proj4('WGS84', 'CUSTOM', lngLat);\n        const xy2customXY = ([x, y]) => [(x - b) / a, (y - d) / c];\n        const customXY2xy = (XY) => [(a * XY[0]) + b, (c * XY[1]) + d];\n        const customXY2wgs84 = (XY) => {/*console.log('XY2xy', customXY2xy(XY)); */return xy2wgs84(customXY2xy(XY));}\n        reverseLngLat = (lngLat) => window.proj4('CUSTOM', 'WGS84', xy2customXY(window.proj4('WGS84', 'EPSG:3857', lngLat)));\n        affine2xy = (lngLat) => {\n            return customXY2xy(customXY(lngLat));\n        }\n        affine = (lngLat) => {\n            return xy2wgs84(affine2xy(lngLat))\n        }\n        affineAndClamp = (lngLat) => {\n            let [X, Y] = customXY(lngLat);\n            X = clamp(X, minX, maxX);\n            Y = clamp(Y, minY, maxY);\n            return customXY2wgs84([X, Y]);\n        }\n        affineOrDrop = (lngLat) => {\n            let [X, Y] = customXY(lngLat);\n            if (isInside(X, minX, maxX) && isInside(Y, minY, maxY)) {\n                return customXY2wgs84([X, Y]);\n            }\n        }\n        affineAndClip = (data) => {\n            if (data.length === 0) return [];\n            const points = data.map(g => customXY([g.longitude, g.latitude]));\n            return lineclip(points, mapOptions.extent).map(l => l.map(XY => customXY2wgs84(XY)));\n        }\n    }\n    let bbox = undefined;\n    let points = [];\n    if (ofp) {\n        for (const track of ofp.tracks) {\n            points = points.concat(track.points);\n        }\n        points = points.concat(ofp.route.points, ofp.wptCoordinatesAlternate());\n        bbox = getBounds(points, affineAndClamp);\n\n        map.fitBounds(bbox, {padding: {top: 30, bottom:80, left: 30, right: 30}});\n    }\n    //map.addControl(new mapboxgl.FullscreenControl());\n    const geolocateControl = new mapboxgl.GeolocateControl({\n        positionOptions: {\n            enableHighAccuracy: false\n        },\n        fitBoundsOptions: {maxZoom: 3},\n        trackUserLocation: true\n    });\n    if (affine) {\n        const originalOnSuccess = geolocateControl._onSuccess;\n        geolocateControl._onSuccess = function(position) {\n            const [lng, lat] = affine([position.coords.longitude, position.coords.latitude]);\n            return originalOnSuccess.apply(this, [{'coords': {'longitude': lng, 'latitude': lat, 'accuracy': position.coords.accuracy}}]);\n        }\n    }\n\n    const mapData = {map, affine, affineAndClamp, affineAndClip, affineOrDrop, bbox, mapOptions, geolocate: geolocateControl, initialLoad};\n\n    class LayersControl {\n        onAdd(map) {\n        this._map = map;\n        this._container = document.createElement('div');\n        this._container.className = 'mapboxgl-ctrl  mapboxgl-ctrl-group';\n        this._button = document.createElement('button');\n        this._button.className = 'mapboxgl-ctrl-layers';\n        this._button.setAttribute('type', \"button\");\n        this._button.setAttribute('title', \"Personnaliser la carte\");\n        this._focusModeUnsubscribe = focusMode.subscribe($focusMode => this._button.innerHTML = mapControlHTML($focusMode));\n        this._container.appendChild(this._button);\n        this._toggleSidebar = () => sidebar.update((value) => !value);\n        this._button.addEventListener('click', this._toggleSidebar);\n        return this._container;\n        }\n        onRemove() {\n        this._button.removeEventListener('click', this._toggleSidebar);\n        this._focusModeUnsubscribe();\n        this._container.parentNode.removeChild(this._container);\n        this._map = undefined;\n        }\n    }\n    map.addControl(new(LayersControl));\n    map.addControl(geolocateControl);\n    let calibrateMode = false;\n    let calibrateData = [];\n    const calibrate = (e) => {\n        console.log(reverseLngLat([e.lngLat.lng, e.lngLat.lat]));\n        const expectedLngLat = reverseLngLat([e.lngLat.lng, e.lngLat.lat]).map(v => Math.round(v));\n        const [X, Y] = window.proj4('WGS84', 'CUSTOM', expectedLngLat);\n        const [x, y] = window.proj4('WGS84', 'EPSG:3857', [e.lngLat.lng, e.lngLat.lat]);\n        // x1 = aX1+b\n        // y1 = cY1+d\n        // x2 = aX2+b\n        // y2 = cY2+d\n        calibrateData.push([X, Y, x, y]);\n        console.log(`point${calibrateData.length}: ${expectedLngLat}`);\n        if (calibrateData.length === 2) {\n            const [X1, Y1, x1, y1] = calibrateData[0];\n            const [X2, Y2, x2, y2] = calibrateData[1];\n            const a = (x1 - x2)/(X1 - X2);\n            const b = x1 - (a * X1);\n            const c = (y1 - y2)/(Y1 - Y2);\n            const d = y1 - (c * Y1);\n            console.log({a, b, c, d});\n            calibrateData = [];\n        }\n    };\n    const handleKeydown = (event) => {\n        if (event.ctrlKey) {\n            calibrateMode = !calibrateMode;\n            map.getCanvasContainer().style.cursor = (calibrateMode) ? \"crosshair\" : \"grab\";\n            calibrateData = [];\n            if (calibrateMode) {\n                map.on('click', calibrate);\n            } else {\n                map.off('click', calibrate);\n            }\n        }\n        \n    };\n    //patch for logitech combo touch azerty \n    const patchKeyboard = (e) => {\n        let patchEvent;\n        if(e.keyCode === 187 && (e.key === '-' || e.key === '_')) {\n            e.preventDefault();\n            e.stopPropagation();\n            patchEvent = new KeyboardEvent('keydown', {\n                location: e.location,\n                ctrlKey: e.ctrlKey,\n                shiftKey: e.shiftKey,\n                altKey: e.altKey,\n                metaKey: e.metaKey,\n                repeat: e.repeat,\n                isComposing: e.isComposing,\n                charCode: e.charCode,\n                key: e.key,\n                code: e.code,\n                bubbles: true,\n                keyCode: 189,\n                which: 189\n            });\n            map.getCanvas().dispatchEvent(patchEvent);\n            console.log('patched event keycode 187 -> 189');\n        }\n    };\n    const hidePlane = () => showPlaneOnMap.set(false);\n    const storeZoom = throttle(e => mapZoom.set(Math.floor( ( e.target.getZoom() + Number.EPSILON ) * 10 ) / 10), 100);\n    const geolocateControlElt = document.querySelector('.mapboxgl-ctrl-geolocate');\n    map.on('load', function() {\n\n        loadMapLayers({\n            ofp,\n            kmlOptions,\n            mapData,\n            map,\n            mapOptions,\n            aircraftType\n        });\n        if (geolocateControlElt) geolocateControlElt.addEventListener('click', focusMap);\n        geolocateControl.on('trackuserlocationstart', hidePlane);\n        \n        // if (ofp) addToSWCache([ofp.ogimetData.proxyImg], 'lido-gramet2');\n        //fetch(ofp.ogimetData.proxyImg); // add to cache\n        if (onLoadCb) onLoadCb(map, mapOptions);\n        // eslint-disable-next-line no-constant-condition\n        if ('process.env.NODE_ENV' === '\"development\"') {\n            document.addEventListener('keydown', handleKeydown);\n        }\n        map.on('zoom', storeZoom);\n        mapZoom.set(map.getZoom());\n        map.getCanvasContainer().addEventListener('keydown', patchKeyboard, {capture: true});\n        //map.getCanvas().focus(); //we do not give focus here because the nat entry point might be focused on the close button\n    });\n\n    map.on('remove', function() {\n        if (geolocateControlElt) geolocateControlElt.removeEventListener('click', focusMap);\n        geolocateControl.off('trackuserlocationstart', hidePlane);\n        // eslint-disable-next-line no-constant-condition\n        if ('process.env.NODE_ENV' === '\"development\"') document.removeEventListener('keydown', handleKeydown);\n        map.off('zoom', storeZoom);\n        map.getCanvasContainer().removeEventListener('keydown', patchKeyboard);\n    });\n\n    return mapData;\n}\n","/* global mapboxgl */\nexport class TilesCache {\n    constructor(dbName, version, callback) {\n        this.dbName = dbName;\n        \n        this.dbPromise = new Promise((resolve, reject) => {\n            const open = indexedDB.open(dbName, version);\n            open.onsuccess = () => {\n                resolve(open);\n            };\n            open.onerror = () => {\n                reject('Error while opening DB');\n            };\n            open.onupgradeneeded = (callback) ? callback.bind(null, open): () => {};\n        });\n\n    }\n    getImageIdFromURL(url) {\n        return url.pathname.replace(/[/.]/g,'_');\n    }\n    async fetchImageFromDB (imageId, storeName) {\n        const open = await this.dbPromise;\n        return new Promise((resolve, reject) => {\n            const tx =  open.result.transaction(storeName, 'readonly');\n            const store = tx.objectStore(storeName);\n            const imageInStoreReq = store.get(imageId);\n            imageInStoreReq.onsuccess = () => {\n                resolve(imageInStoreReq.result);\n            };\n            imageInStoreReq.onerror = () => {\n                reject('Something went wrong while fetching image from DB ');\n            };\n        });\n    }\n    async putImageInDB(imageId, storeName, blob) {\n        const open = await this.dbPromise;\n        return new Promise((resolve, reject) => {\n            const tx = open.result.transaction(storeName, 'readwrite');\n            const store = tx.objectStore(storeName);\n            const imagePutReq = store.put(blob, imageId);\n            imagePutReq.onsuccess = () => {\n                const imageInStoreReq = store.get(imageId);\n                imageInStoreReq.onsuccess = () => {\n                    resolve(imageInStoreReq.result);\n                };\n            };\n            imagePutReq.onerror = () => {\n                reject('Something went wrong while putting image in DB ');\n            };\n        });\n    }\n    getCacheHandler(storeName) {\n        return this._cacheHandler.bind(this, storeName);\n    }\n    async isNotCached(storeName, url) {\n        const imageID = this.getImageIdFromURL(url);\n        const open = await this.dbPromise;\n        return new Promise((resolve, reject) => {\n            const tx =  open.result.transaction(storeName, 'readonly');\n            const store = tx.objectStore(storeName);\n            const imageInStoreReq = store.getKey(imageID);\n            imageInStoreReq.onsuccess = () => {\n                resolve((imageInStoreReq.result === undefined) ? url : null); //returns url if not in cache, null otherwise\n            };\n            imageInStoreReq.onerror = () => {\n                reject('Something went wrong while checking if cached from DB ');\n            };\n        });\n    }\n    async countTiles(storeName) {\n        const open = await this.dbPromise;\n        return new Promise((resolve, reject) => {\n            const tx =  open.result.transaction(storeName, 'readonly');\n            const store = tx.objectStore(storeName);\n            const countStoreReq = store.count();\n            countStoreReq.onsuccess = () => resolve(countStoreReq.result);\n            countStoreReq.onerror = () => reject('Something went wrong while counting entries from DB');\n        });\n    }\n    async close() {\n        const open = await this.dbPromise;\n        open.result.close();\n    }\n    async _cacheHandler(storeName, { request, url }) {\n        const imageID = this.getImageIdFromURL(url);\n        return this.fetchImageFromDB(imageID, storeName).then((blob) => {\n            if (blob) {\n                // If image is directly available in DB then return the blob as the response.\n                return new Response(blob);\n            } else {\n                // If the image is unavailable, fetch the image by resuming the intercepted request to the server.\n                return fetch(request).then(response => {\n                    const respClone = response.clone();\n                    return respClone.blob()\n                }).then(imageBlob => {\n                    if (imageBlob.type.startsWith('image/')||imageBlob.type === 'application/x-protobuf') {\n                        return this.putImageInDB(imageID, storeName, imageBlob).then((blob) => {\n                            return new Response(blob);\n                        });\n                    } else {\n                        return new Response('', { \"status\" : 404 , \"statusText\" : \"invalid image found (sw)\"})\n                    }\n                });\n            }\n        });\n    }\n}\nfunction lon2tile(lon,zoom) { return (Math.floor((lon+180)/360*Math.pow(2,zoom))); }\nfunction lat2tile(lat,zoom)  { return (Math.floor((1-Math.log(Math.tan(lat*Math.PI/180) + 1/Math.cos(lat*Math.PI/180))/Math.PI)/2 *Math.pow(2,zoom))); }\nexport const findMissingCacheTiles = async (ofp, mapData) => {\n    const {map, mapOptions, bbox} = mapData;\n    if (!map) return [];\n    const tilesCaches = new TilesCache('CONF_TILES_DB');\n\n    if (mapOptions.cacheAll) {\n        const tilesCount = await tilesCaches.countTiles(mapOptions.cacheName);\n        \n        let tilesMax;\n        if (mapOptions.matrix) {\n            tilesMax = mapOptions.matrix.map(([w, h]) => w * h);\n        } else {\n            tilesMax = [...Array(mapOptions.cacheZoom + 1).keys()].map(v => Math.pow(2, v) * Math.pow(2, v));\n        } \n        if (tilesCount >= tilesMax.reduce((a, b) => a + b, 0)) {\n            tilesCaches.close();\n            console.log('map is fully cached', tilesMax);\n            caches[mapOptions.id] = true;\n            return [];\n        }\n    }\n\n    const [sw, ne] = [[bbox[0], bbox[1]], [bbox[2], bbox[3]]];\n    const promises = [];\n    for (let zoom=0; zoom <= mapOptions.cacheZoom; zoom++) {\n        let swXY, neXY;\n        const max = Math.pow(2,zoom);\n        if (mapOptions.cacheAll) {\n            swXY={x: 0, y: max - 1};\n            neXY={x: max - 1, y: 0};\n        } else {\n            swXY={x: lon2tile(sw[0], zoom), y: lat2tile(sw[1], zoom)};\n            neXY={x: lon2tile(ne[0], zoom), y: lat2tile(ne[1], zoom)};\n        }\n        let maxX, maxY;\n        if (mapOptions.matrix) {\n            [maxX, maxY] = mapOptions.matrix[zoom];\n        }else{\n            [maxX, maxY] = [max, max];\n        }\n\n        for (let x=swXY.x; x<=neXY.x; x++) {\n            for (let y=neXY.y; y<=swXY.y; y++) {\n                if(x>=0 && y>=0 && x<maxX && y<maxY){\n                    let url;\n                    if(mapOptions.tiles) {\n                        url = new URL(mapOptions.tiles[0].replace('{z}', zoom).replace('{x}', x).replace('{y}', y));\n                        promises.push(tilesCaches.isNotCached(mapOptions.cacheName, url));\n                    } else {\n                        url = new URL(`https://api.mapbox.com/v4/denizotjb.6nts91f3/${zoom}/${x}/${y}@2x.webp?sku=${map._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`);\n                        promises.push(tilesCaches.isNotCached(mapOptions.cacheName, url));\n                        url = new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.1x3i1g8r,denizotjb.bifqeinj,denizotjb.cz0kdfpx,denizotjb.aop85z8z,mapbox.mapbox-terrain-v2/${zoom}/${x}/${y}.vector.pbf?sku=${map._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`);\n                        promises.push(tilesCaches.isNotCached(mapOptions.cacheName, url));\n                    }\n                }\n            }\n        }\n    }\n    const results = await Promise.all(promises);\n    tilesCaches.close();\n    return results.filter(url => url !== null);\n};\n","<script>\n    export let value = 0;\n    export let max = 100;\n    $: progressPath = () => {\n        if (value <= 0) {\n            return \"\";\n        } else if (value >= max) {\n            return \"M50,5A45 45 0 1 1 49.9999 5\";\n        } else {\n            const angle = Math.PI * 2 * (value / max);\n            const x = 50 + Math.cos(angle - Math.PI / 2) * 45;\n            const y = 50 + Math.sin(angle - Math.PI / 2) * 45;\n            let path = \"M50,5\";\n            if (angle > Math.PI) {\n                path += \"A45 45 0 0 1 50 95\";\n            }\n            path += `A45 45 0 0 1 ${x} ${y}`;\n            return path;\n        }\n    };\n</script>\n\n<svg viewBox=\"0 0 108 108\">\n    <circle cx=\"54\" cy=\"54\" r=\"50\"/>\n    <path d=\"M50,5A45 45 0 1 1 49.9999 5\" transform=\"translate(4,4)\"/>\n    <path d=\"{progressPath()}\" transform=\"translate(4,4)\"/>\n    <line x1=\"54\" y1=\"36\" x2=\"54\" y2=\"72\" />\n    <polyline points=\"36 54, 54 72, 72 54\" />\n    <line x1=\"54\" y1=\"36\" x2=\"54\" y2=\"72\" />\n    <polyline points=\"36 54, 54 72, 72 54\" />\n</svg>\n<slot></slot>\n\n<style>\n    svg {\n        fill: var(--progress-fill, transparent);\n        height: var(--progress-height, 24px);\n        stroke-linecap: var(--progress-linecap, round);\n        width: var(--progress-width, 24px);\n    }\n    circle {\n        fill: var(--progress-circlefill, transparent);\n        stroke: var(--progress-circleoutline, black);\n        stroke-width: 4px;\n    }\n    path:first-of-type {\n        stroke: var(--progress-trackcolor, var(--bs-gray-500));\n        stroke-width: var(--progress-trackwidth, 14px);\n    }\n    path:last-of-type {\n        stroke: var(--progress-color, yellow);\n        stroke-width: var(--progress-width, 14px);\n    }\n    line:last-of-type, polyline:last-of-type {\n        stroke: var(--progress-arrowstroke, black);\n        stroke-width: var(--progress-arrowwidth, 10px);\n    }\n    line:first-of-type, polyline:first-of-type {\n        stroke: var(--progress-arrowoutline, var(--progress-circleoutline, black));\n        stroke-width: calc(var(--progress-arrowwidth, 10px) + 2px);\n    }\n</style>","<script>\n    import {selectedAircraftType, aircraftType, ofp} from '../stores';\n    import {aircraftTypes, discontinuatedAircraftTypes} from '../constants';\n    import blurAction from '../actions/blurAction';\n    export let aircraftTypeSelectElement = null;\n    $: ofpAircraftType = ($ofp) ? $ofp.infos.aircraftType : undefined;\n</script>\n\n<!-- svelte-ignore a11y-no-onchange -->\n<select tabindex=\"{(($ofp) ? -1 : 0)}\" bind:this={aircraftTypeSelectElement} name=\"aircraftType\" bind:value={$selectedAircraftType} on:change use:blurAction>\n    {#if (!$aircraftType)}\n        <option value=\"{undefined}\" selected={true}>???</option>\n    {/if}\n    {#each aircraftTypes as type}\n        {#if (type === $aircraftType|| (ofpAircraftType && type === ofpAircraftType) || !discontinuatedAircraftTypes.includes(type))}\n            <option value=\"{type}\" selected={type === $aircraftType}>{type}</option>\n        {/if}\n    {/each}\n</select>\n\n<style>\n    select[name=aircraftType] {\n        background-color: rgba(255,255,255,0.3);\n        border: none;\n        font-size: 12px;\n        display: none;\n        margin-right: 5px;\n        z-index: 2;\n        padding: 0px 10px;\n        appearance: none;\n        -webkit-appearance: none;\n        -moz-appearance: none;\n    }\n</style>","<script>\n    import { position } from \"../stores\";\n    import { onMount, onDestroy } from \"svelte\";\n\n    let planeMarker;\n    export let mapData;\n\n    const planeElement = window.document.createElement(\"div\");\n    planeElement.classList.add(\"mapboxgl-user-location-dot\", \"map-plane\");\n    const placePlane = (geoPoint) => {\n        if (planeMarker) {\n            const affine = mapData.affine;\n            const [lng, lat] = affine\n                ? affine([geoPoint.longitude, geoPoint.latitude])\n                : [geoPoint.longitude, geoPoint.latitude];\n            planeMarker.setLngLat([lng, lat]);\n        }\n    };\n\n    $: placePlane($position.map);\n\n    onMount(() => {\n        planeMarker = new mapboxgl.Marker(planeElement);\n        placePlane($position.map);\n        planeMarker.addTo(mapData.map);\n\n    });\n    onDestroy(() => {\n        if (planeMarker) {\n            planeMarker.remove();\n            planeMarker = undefined;\n        }\n    });\n</script>\n\n<style>\n    :global(.mapboxgl-user-location-dot.map-plane, .mapboxgl-user-location-dot.map-plane:before) {\n        background-color: var(--plane-color);\n    }\n    /* :global(.map-plane) {\n        width: 20px;\n        height:20px;\n        border: 2px solid var(--plane-color);\n        border-radius: 50%;\n    } */\n    :global(.mapboxgl-user-location-dot.map-plane:before) {\n        /* content: \"\"; */\n        /* position: absolute; */\n        -webkit-animation: mapboxgl-map-plane-dot-pulse 10s infinite;\n        -moz-animation: mapboxgl-map-plane-dot-pulse 10s infinite;\n        animation: mapboxgl-map-plane-dot-pulse 10s infinite;\n        /* align-content: baseline; */\n    }\n    @keyframes -global-mapboxgl-map-plane-dot-pulse {\n        0%   { transform: scale(1); opacity: 1; background-color: var(--plane-color);}\n        14%  { transform: scale(3); opacity: 0; background-color: var(--plane-halo-color);}\n        20% { transform: scale(1); opacity: 0; background-color: var(--plane-color);}\n    }\n</style>\n","const blankStyle = {\n    \"version\": 8,\n    \"name\": \"Blank pour App\",\n    \"metadata\": {\n        \"mapbox:autocomposite\": true,\n        \"mapbox:type\": \"template\",\n        \"mapbox:sdk-support\": {\n            \"js\": \"1.9.0\",\n            \"android\": \"8.6.0\",\n            \"ios\": \"5.6.0\"\n        },\n        \"mapbox:groups\": {},\n        \"mapbox:uiParadigm\": \"layers\"\n    },\n    \"center\": [0, 0],\n    \"zoom\": 1.2946207284336362,\n    \"bearing\": 0,\n    \"pitch\": 0,\n    \"sources\": {},\n    \"sprite\": \"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu\",\n    \"glyphs\": \"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf\",\n    \"layers\": [],\n    \"created\": \"2020-06-16T07:22:32.952Z\",\n    \"id\": \"ckbhlmwdm0mn51imw8t4dddqs\",\n    \"modified\": \"2020-06-16T07:23:29.539Z\",\n    \"owner\": \"flyingeek\",\n    \"visibility\": \"public\",\n    \"draft\": false\n}\nexport {blankStyle as default}","import blankStyle from './blankStyle';\n// Pour réaliser les tiles dans Map Tiler\n// - Choisir Andvanced Tiles -> Continue\n// - Choisir le TIF geo-référencé -> Continue\n// - choisir Custom dans presets\n// - choisir \"from output\" et 512px x 512px\n// - choisir Zoom: 0 à 4\n// - choisir \"Advanced Options\" -> séléctionner JPEG, laisser sur Sparse Output et OpenGIS -> Close\n// - choisir \"Folder\" -> Render\nconst query = \"(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)\";\nconst tilesResolution = (matchMedia(query).matches) ? 256 : 512;\nconst options = [\n    {\n        'label': 'Mercator',\n        'id': 'mercator',\n        'mapboxOptions': {\n            //'style': 'mapbox://styles/flyingeek/ckc4yge17166a1ip66rkf0zhr',\n            //'style': 'mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e',\n            'style': 'mapbox://styles/flyingeek/cknj4nmwu0t8117ny6rk7dwbg',\n            'renderWorldCopies': false,\n            'maxZoom': 12\n        },\n        'cacheName': 'CONF_MERCATOR',\n        'interpolateMinZoom': 2,\n        'interpolateMaxZoom': 7, // overrides maxboxOptions.maxZoom for interpolate expression\n        'cacheZoom': 6\n    },\n    {\n        'label': 'Lambert North',\n        'id': 'jb_north',\n        'extent': [-7441575.32982940, -5719574.16449270, 7383398.17621086, 9105399.34154755],\n        //'affineTransform': [2.63206100208865, -323662.179369435, 2.63502996130431, -10626687.7639946],\n        'proj4': '+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_NORTH_TILES_BASE_URL/{z}/{x}/{y}.jpg'],\n        'cacheZoom': 4,\n        'cacheName': 'CONF_NORTH',\n        'cacheAll': true,\n        'tileSize': tilesResolution,\n        'interpolateMinZoom': 2,\n        'subLabel': 'recommandée au nord du 30N'\n    },\n    {\n        'label': 'Lambert South',\n        'id': 'jb_south',\n        'extent': [-12613000.20107552, -12796118.19556621, 13437104.14597977, 13253986.15148908],\n        'validity': [-12613903.56963206, -9420000.1608799, 13437054.51836624, 5862747.38325809],\n        'proj4': '+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_SOUTH_TILES_BASE_URL/{z}/{x}/{y}.jpg'],\n        'cacheZoom': 4,\n        'cacheName': 'CONF_SOUTH',\n        'cacheAll': true,\n        'tileSize': tilesResolution,\n        'interpolateMinZoom': 2,\n        'subLabel': 'recommandée au sud du 30N'\n    },\n    {\n        'label': 'Lambert Pacific',\n        'id': 'jb_pacific',\n        'extent': [-8306365.14297095, -7788164.66141786, 6519185.45830619, 7037385.93985927],\n        'proj4': '+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_PACIFIC_TILES_BASE_URL/{z}/{x}/{y}.jpg'],\n        'cacheName': 'CONF_PACIFIC',\n        'cacheZoom': 4,\n        'cacheAll': true,\n        'tileSize': tilesResolution,\n        'interpolateMinZoom': 3,\n        'subLabel': 'recommandée au sud du 30N'\n    },\n    {\n        'label': 'The World',\n        'id': 'jb_theworld',\n        // for wide map\n        //'ratio': [16358, 10084], /* width, height, but we use affineTransform instead */\n        // coefficients based on ratio\n        //'affineTransform': [1.314746085506463, -40260.546626176685, 1.3162291162962998, 6490582.670755925]\n        // coefficients adjusted manually\n        'affineTransform': [1.314746085506463, -45260.546626176685, 1.315 ,6480000],\n        \"extent\": [-15201502.45260082, -8478963.56607166, 15262747.04890729, 10300929.57326125],\n        //\n        // 10000x10000 px map adjust\n        //'affineTransform': [1.342031311736757, 1178.4237424843013, 1.3435451202037834, -1086726.777713921],\n        //'affineTransform': [1.342031311736757, 1178.4237424843013, 1.3425, -1095092],\n        //'affineTransform': [1.342031311736757, 1178.4237424843013, 1.3421, -1100000],\n        //\"extent\": [-14923314.11241390, -14113585.79413393, 14921557.93320679, 15731286.25148677],\n        \"proj4\": \"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0\",\n        // zoom6 available on netlify but to reduce size we limit to 5\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_THEWORLD_TILES_BASE_URL/{z}/{x}/{y}.webp'],\n        'matrix': [[1, 1], [2, 2], [4, 3], [8, 5], [16, 10], [32, 20], [64, 40]],\n        'cacheZoom': 5,\n        'cacheName': 'CONF_THEWORLD',\n        'cacheAll': true,\n        'interpolateMinZoom': 3,\n        'tileSize': tilesResolution\n    },\n    {\n        'label': '=Physique=',\n        'id': 'ed_eqe_physical_fr',\n        // for wide map\n        //\"ratio\": [19268, 10630],\n        // coefficients based on ratio\n        //'affineTransform': [1.1037001869442906, 855.8520345054567, 1.1049451584091474, 9308847.034806727]\n        // coefficients adjusted manually\n        'affineTransform': [1.104, -855.8520345054567, 1.10, 9310000],\n        // coefficients using calibration\n        //'affineTransform': [1.1037, 855, 1.10, 9305000],\n        // coefficients using calibration zoom 9\n        //'affineTransform': [1.1036, -630, 1.09925, 9304530],\n        \"extent\": [-18145536.69460000, -10300589.33644032, 18143985.81684419, 9720047.17470000],\n        \"proj4\": \"+proj=eqearth +datum=WGS84 +wktext\",\n        // zoom6 available on netlify but to reduce size we limit to 5\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_EQE_PHYSICAL_FR_TILES_BASE_URL/{z}/{x}/{y}.webp'],\n        'matrix': [[1, 1], [2, 2], [4, 3], [8, 5], [16, 9], [32, 18], [64, 36]],\n        'cacheZoom': 5,\n        'cacheName': 'CONF_EQE_PHYSICAL_FR',\n        'cacheAll': true,\n        'interpolateMinZoom': 3,\n        'tileSize': tilesResolution\n    }\n    //,\n    // {\n    //     'label': '=Politique=',\n    //     'id': 'ed_eqe_political_fr',\n    //     // for wide map\n    //     //\"ratio\": [19268, 10630],\n    //     //'affineTransform': [1.1037001869442906, 855.8520345054567, 1.1049451584091474, 9308847.034806727]\n    //     'affineTransform': [1.104, -855.8520345054567, 1.10, 9310000],\n    //     \"extent\": [-18144998.39890000, -9405510.77770950, 18144670.32165249, 9729041.82040000],\n    //     \"proj4\": \"+proj=eqearth +datum=WGS84 +wktext\",\n    //     'mapboxOptions': {\n    //         'style': blankStyle,\n    //         'renderWorldCopies': false,\n    //         'maxZoom': 6\n    //     },\n    //     'tiles': ['CONF_EQE_POLITICAL_FR_TILES_BASE_URL/{z}/{x}/{y}.jpg'],\n    //     'matrix': [[1, 1], [2, 2], [4, 3], [8, 5], [16, 9], [32, 17], [64, 34]],\n    //     'cacheZoom': 6,\n    //     'cacheName': 'CONF_EQE_POLITICAL_FR',\n    //     'cacheAll': true,\n    //     'tileSize': tilesResolution\n    // }\n    // ,\n    // {\n    //     'label': 'JB Mercator',\n    //     'id': 'mapbox_jb_mercator',\n    //     'mapboxOptions': {\n    //         'style': 'mapbox://styles/denizotjb/ckbi1x4ae0vp11jqtfulbtll5'\n    //     }\n    // }\n    ,{\n        'label': atob(\"Q2FydGFCb3NzeQ==\") + ' 2020',\n        'id': 'vb_2020',\n        \"ratio\": [19449, 18352],\n        'extent': [26966.11818123, -430589.86447607, 1262485.62823696, 735241.49181695],\n        'proj4': \"+proj=lcc +lat_1=45.89893890000052 +lat_2=47.69601440000037 +lat_0=46.8 +lon_0=2.33722917 +x_0=600000 +y_0=200000 +datum=WGS84 +units=m +no_defs \",\n        //'proj4': '+proj=lcc +lat_0=46.8 +lon_0=2.33722917 +lat_1=45.8989389000005 +lat_2=47.6960144000004 +x_0=600000 +y_0=200000 +datum=WGS84 +units=m +no_defs +type=crs',\n        'mapboxOptions': {\n            'style': blankStyle,\n            'renderWorldCopies': false,\n            'maxZoom': 5\n        },\n        'tiles': ['CONF_CB_TILES_BASE_URL/{z}/{x}/{y}.webp'],\n        'matrix': [[1, 1], [2, 2], [4, 4], [8, 8], [16, 16], [32, 31], [64, 61]],\n        'cacheName': 'CONF_CB',\n        'cacheZoom': 5,\n        'cacheAll': true,\n        'interpolateMinZoom': 0.5,\n        'tileSize': tilesResolution\n    }\n];\n\nexport { options as default};","<script>\n    /* global editolido */\n    import {mapZoom} from '../stores';\n    import options from './mapboxgl/mapOptions';\n    import blurAction from '../actions/blurAction';\n    import {onMount} from 'svelte';\n    export let name = 'map-style';\n    export let ofp;\n    export let selected = options[0];\n    let autoSelectedId = selected.id;\n    const authorizedOptions = (ofp) ? options : options.filter(o => (!o.id.startsWith('vb_') && o.id !== 'jb_theworld'));\n\n    function isInBounds(option, dep, dest) {\n        if (!option.proj4) return false;\n        try{\n            const bounds = (option.validity) ? option.validity : option.extent;\n            for (let p of [dep, dest]) {\n                const [x, y] = window.proj4(option.proj4, [p.longitude, p.latitude]);\n                if (x < bounds[0] ||  x > bounds[2] || y < bounds[1] || y > bounds[3]) {\n                    return false;\n                }\n            }\n        }catch(err){\n            console.log(err);\n            return false;\n        }\n        return true;\n    }\n\n    onMount(() => {\n        if (selected.id === options[0].id && ofp) {\n            const dep = ofp.route.points[0];\n            const dest = ofp.route.points[ofp.route.points.length - 1];\n            const cbMapOption = options.find(o => o.id === 'vb_2020');\n            const northOption = options.find(o => o.id === 'jb_north');\n            if (isInBounds(cbMapOption, dep, dest)){\n                selected = cbMapOption;\n            }else if (dep.distanceTo(dest, editolido.rad_to_nm) <=1500){\n                //pass (mercator)\n            }else if (dest.latitude > 30 && dep.latitude > 30){\n                selected = northOption;\n            }else if (dest.longitude < -80 && dep.longitude < -80) {\n                selected = options.find(o => o.id === 'jb_pacific');\n            }else if ((dest.latitude > 30 || dep.latitude > 30) && (dep.atFraction(dest, 0.5)).latitude >= 30 && isInBounds(northOption, dep, dest)) {\n                selected = northOption;\n            }else{\n                selected = options.find(o => o.id === 'jb_south');\n            }\n        }\n        autoSelectedId = selected.id;\n    });\n</script>\n<div class=\"input-group\">\n    <!-- svelte-ignore a11y-no-onchange -->\n    <select id=\"{name}\" name=\"{name}\" bind:value={selected} \n        class=\"form-select form-select-sm\" class:extend={autoSelectedId === 'mercator' && selected.id === 'mercator'}\n        aria-label=\"Choix de la projection\"\n        on:change use:blurAction>\n        {#each authorizedOptions as option (option.id)}\n        <option value=\"{option}\" selected={option.id === selected.id}>\n            {(option.id === autoSelectedId) ? `${option.label.toUpperCase()}`: option.label}\n        </option>\n        {/each}\n    </select>\n    {#if selected.id==='mercator'}\n        <label for=\"{name}\">🔎&nbsp;{$mapZoom.toFixed(1)}</label>\n    {/if}\n</div>\n<style>\n    label {\n        position: absolute;\n        right: 2.25rem;\n        top: 50%;\n        transform: translate(0, -50%);\n        background-color: var(--bs-gray-100);\n        font-size: small;\n        min-width: 48px;\n        z-index: 3; /* same as .input-group:focus*/\n    }\n    select {\n        width: auto !important;\n        font-size: small;\n        display: inline-block;\n        background-color: var(--bs-gray-100);\n    }\n    select.extend{\n        padding-right: 4rem !important;\n    }\n</style>","<script>\n    import {simulate} from '../stores';\n    export let name = \"simulator\";\n    let input;\n    const toggle = () => {\n        input.checked = !input.checked\n        $simulate = (input.checked) ? 0 : -1;\n    }\n</script>\n\n<!-- <input bind:value={$fl} type=\"range\" min=200 max=450 step=1/>{$fl} -->\n<!-- <input bind:value={$grametPosition} type=\"range\" min=0 max=100 step=1/> -->\n<label for=\"{name}\" on:click={toggle} class:btn-simulator-play={$simulate < 0} class:btn-simulator-stop={$simulate >= 0}>\n<input bind:this={input} name=\"{name}\" type=\"checkbox\" checked={$simulate>=0} on:change={toggle}>\n</label>\n<style>\n    input{\n        display: none;\n    }\n    label{\n        position: absolute;\n        top: 0;\n        left: 5px;\n        font-size: 45px;\n    }\n    :global(.btn-simulator-play), :global(.btn-simulator-stop){\n        --stroke-width: 3px;\n    }\n    :global(.btn-simulator-play)::before, :global(.btn-simulator-stop)::before {\n        color: var(--plane-color);\n        -webkit-text-stroke-width: var(--stroke-width);\n        -webkit-text-stroke-color: black;\n        font-family: monospace;\n    }\n    :global(.btn-simulator-play)::before {\n        content:\"▶︎\";\n    }\n    :global(.btn-simulator-stop)::before {\n        content:\"◼︎\";\n    }\n</style>","import {writable} from 'svelte/store';\nimport {showGramet} from '../stores';\n\nexport const grametStatus = writable();\nexport const grametResponseStatus = writable({});\nconst grametMargin = 65; // left and right margin to the \"inner gramet\" image in px\nconst grametTop = 33;// top margin to the \"inner gramet\" image in px\n\nexport function grametThumbAction(container, {ofp, pos, fl}){\n    const plane = document.getElementById('gt-plane');\n    let objectURL;\n    let position = parseFloat(pos);\n    let currentOfp = ofp;\n    let img;\n    let clone;\n    let iWidth; // the image width (small size computed by browser)\n    let scale;\n    let level = fl;\n    const viewportHeight = container.clientHeight;\n    const viewportWidth = container.clientWidth;\n    const style = getComputedStyle(document.body);\n    const gInnerHeight = parseFloat(style.getPropertyValue('--gramet-inner-height', \"384px\").slice(0, -2)); //remove px\n    const position2pixel = (position) =>  {\n        return ((grametMargin * scale) + ((iWidth - (grametMargin * 2 * scale)) * position / 100));\n    }\n    const imageOffsetForPosition = (position) => {\n        const pixelPosX = position2pixel(position);\n        const margin = grametMargin * scale; // in the thubnail we hide the left and right margin\n        const iw = iWidth;\n        const lock = viewportWidth /3; // plane locked position when we scroll image\n        const min = margin + lock;\n        const max = (iw - margin) - (viewportWidth - lock)\n        if (pixelPosX > (min) && pixelPosX < max){\n            return lock - pixelPosX;\n        }else if(pixelPosX <= min){\n            return lock - min;\n        }else{\n            return lock -max;\n        }\n    }\n    const placePlane = (plane, planePosition, x, planeLevel) => {\n        if(plane){\n            plane.style.left = (x + (position2pixel(planePosition) - (plane.clientWidth / 2))) + 'px';\n            plane.style.top = (((gInnerHeight - Math.round((-0.0006 * planeLevel * planeLevel) + (0.8985 * planeLevel) + 46.264)) * scale) - (plane.clientHeight / 2)) + 'px';\n        }\n    }\n    const loadListener = () => {\n        const gHeight = img.height || 700;\n        clone = img.cloneNode();\n        clone.id = \"grametImg\";\n        clone.style.display = 'none';\n        clone.crossOrigin = \"anonymous\"; // otherwise sw does not cache\n        clone.addEventListener('load', cloneLoadListener); // Safari required the clone to be loaded before adding it to pinchzoom\n        clone.addEventListener('error', errorListener);\n        document.body.appendChild(clone);\n        img.style.height = `${(gHeight/gInnerHeight) * viewportHeight}px`; // 700 is the full gramet height, 380 is the real gramet height\n        img.style.objectFit = 'contain';\n        img.style.position =  'absolute';\n        img.style.opacity = 0.01;\n        container.appendChild(img);\n        iWidth= img.clientWidth;\n        const h = img.clientHeight;\n        const ratio = h / gHeight;\n        scale = ratio;\n        const offset = imageOffsetForPosition(position);\n        img.style.top = `-${grametTop * ratio}px`;\n        img.style.left = `${offset}px`;\n    };\n    const cloneLoadListener = () => {\n        grametStatus.set('success');\n        plane.style.display = 'block';\n        img.style.opacity = 1;\n        const offset = imageOffsetForPosition(position);\n        placePlane(plane, position, offset, level);\n    };\n    const errorListener = () => {\n        plane.style.display = 'none';\n        grametStatus.set('error');\n    };\n    const cleanup = () => {\n        if (img) img.removeEventListener('load', loadListener);\n        if (img) img.removeEventListener('error', errorListener);\n        if (img) img.remove();\n        showGramet.set(false);\n        if (clone) clone.removeEventListener('load', cloneLoadListener);\n        if (clone) clone.removeEventListener('error', errorListener);\n        if (clone) clone.remove();\n        clone = undefined;\n        img = undefined;\n        if(objectURL) URL.revokeObjectURL(objectURL);\n        objectURL = undefined;\n    }\n    const createImg = async (ofp) => {\n        img = document.createElement('img')\n        grametStatus.set('loading');\n        plane.style.display = 'none';\n        fetch(ofp.ogimetData.proxyImg).then(function(response) {\n            if(response.ok) {\n                grametResponseStatus.set({status: response.status, text: response.statusText || 'OK'});\n                response.blob().then((blob) => {\n                    if (img) { // img could be empty if grametTrigger was destroyed before receiving Gramet (page change)\n                        objectURL = URL.createObjectURL(blob);\n                        img.addEventListener('load', loadListener);\n                        img.addEventListener('error', errorListener);\n                        img.src = objectURL;\n                    }\n                });\n            } else {\n                errorListener();\n                if (response.headers) {\n                    grametResponseStatus.set({status: response.status, text:response.statusText ||response.headers.get('X-ofp2map-status')})\n                } else {\n                    grametResponseStatus.set({status: response.status, text:response.statusText || \"\"})\n                }\n            }\n        })\n        .catch(function(error) {\n                errorListener();\n                console.log('catch', error);\n                grametResponseStatus.set({status: 0, text: error.message});\n        });\n    };\n    createImg(ofp);\n\n    return {\n        update({ofp, pos, fl}){\n            position = parseFloat(pos);\n            if (ofp !== currentOfp) {\n                currentOfp = ofp;\n                cleanup();\n                createImg(ofp);\n            }else{\n                const offset = imageOffsetForPosition(position);\n                img.style.left = offset  + 'px';\n                level = fl;\n                placePlane(plane, position, offset, fl);\n            }\n        },\n        destroy(){\n            cleanup();\n        }\n    }\n}\n\n\n//To load Gramet Img im pinchzoom\n//due to problem with Safari, we keep a clone in the document\n//that way there is less reload and incomplete image appearing in the pinchzoom view\nexport const setGramet = (pinchZoom, {pos, fl}) => {\n    const plane = pinchZoom.parentNode.querySelector('svg');\n    const img = document.getElementById('grametImg');\n    const style = getComputedStyle(document.body);\n    const gInnerHeight = parseFloat(style.getPropertyValue('--gramet-inner-height', \"384px\").slice(0, -2)); //remove px\n    const maxHeight = parseFloat(pinchZoom.parentNode.dataset.maxHeight || \"370\");\n    const iWidth = img.width;\n    const iHeight = img.height;\n    const nav = document.querySelector('nav');\n    const viewportWidth = nav.clientWidth;\n    let cHeight;\n    if (iWidth !== 0){\n        cHeight = Math.min((viewportWidth / iWidth) * iHeight, maxHeight);\n    } else {\n        cHeight = Math.min(iHeight, maxHeight);\n    }\n    let position = parseFloat(pos);\n    let scale;\n    let x = 0;\n    let y = 0;\n    let allowImgScroll;\n    let level = fl;\n    const position2pixel = (position) =>  {\n        return (grametMargin + ((iWidth - (grametMargin * 2)) * position / 100)) * scale;\n    }\n    const placePlane = (plane, planePosition, planeLevel) => {\n        // before and after flight, displays the full gramet\n        plane.style.left = (x + (position2pixel(planePosition) - (plane.clientWidth/2) + 2)) + 'px';\n        plane.style.top = (((gInnerHeight  + grametTop - 2 - Math.round((-0.0006 * planeLevel * planeLevel) + (0.8985 * planeLevel) + 46.264)) * scale) - (plane.clientHeight / 2)) + y + 'px';//TODO\n    }\n    const imageOffsetForPosition = (position) => {\n        const pixelPosX = position2pixel(position);\n        const margin = 0; // we do not try to hide the left/right margin in this view\n        const lock = viewportWidth /3;\n        const min = margin + lock;\n        const iw = iWidth * scale; // the scale here is due to pinchzoom\n        const max = (iw - margin) - (viewportWidth - lock);\n        if (pixelPosX > min && pixelPosX < max){\n            return lock - pixelPosX;\n        }else if(pixelPosX <= min){\n            return lock - min;\n        }else{\n            return lock - max;\n        }\n    }\n    const pinchzoomChange = () => {\n        x = pinchZoom.x; // x offset\n        y = pinchZoom.y; // y offset\n        scale = pinchZoom.scale; // scale\n        allowImgScroll = (viewportWidth <= iWidth * scale);\n        placePlane(plane, position, level);\n    }\n    \n    if (position <= 0 || position >= 100) {\n        // flight is not yet progress or finished\n        if (iWidth === 0){\n            scale = maxHeight / (gInnerHeight + 70);\n        } else {\n            scale = Math.min(viewportWidth/iWidth, cHeight / (gInnerHeight + 70));\n        }\n        y = 0;\n    } else {\n        // flight is in progress\n        scale = cHeight / (gInnerHeight);\n        y = - grametTop * scale;\n    }\n    if (viewportWidth > iWidth * scale) {\n        x = (viewportWidth - (iWidth * scale)) / 2;\n        allowImgScroll = false;\n    } else {\n        x = imageOffsetForPosition(position);\n        allowImgScroll = true;\n    }\n    placePlane(plane, position, level);\n    img.style.display = \"block\";\n    pinchZoom.style.maxHeight = `${maxHeight}px`;\n    pinchZoom.appendChild(img);\n    pinchZoom.setTransform({scale, x, y});\n    pinchZoom.addEventListener(\"change\", pinchzoomChange);\n    return {\n        update({pos, fl}){\n            position = parseFloat(pos);\n            level = fl;\n            if (allowImgScroll) {\n                x = imageOffsetForPosition(position);\n                pinchZoom.setTransform({x});\n            }\n            placePlane(plane, position, fl);\n        },\n        destroy(){\n            img.style.display = 'none';\n            document.body.appendChild(img);\n            pinchZoom.removeEventListener(\"change\", pinchzoomChange);\n        }\n    }\n};\n\n//To set the pinchzoom drawer height\n// adjust the size of the parent (the larger the gramet, the less height)\nexport const setHeight = (container) => {\n    const img = document.getElementById('grametImg');\n    const gWidth = img.width;\n    const gHeight = img.height || 700;\n    const maxHeight = parseFloat(container.dataset.maxHeight || \"370\");\n    const nav = document.querySelector('nav');\n    const nWidth = nav.clientWidth;\n    let ratio = 1;\n    if (gWidth !== 0){\n        ratio = nWidth / gWidth;\n    }\n    const height = Math.min(ratio * gHeight, maxHeight);\n    container.style.height = `${height}px`;\n}\n","<script>\n    import {position, simulate} from '../stores';\n    import SimulatorPlayer from './SimulatorPlayer.svelte';\n    import { fly } from \"svelte/transition\";\n    import {setGramet, setHeight} from '../actions/grametAction';\n    const maxHeight = 370;\n</script>\n\n<div class=\"pinch-zoom-parent\" transition:fly=\"{{y: maxHeight}}\" data-max-height={maxHeight} use:setHeight>\n    <pinch-zoom use:setGramet={{pos: $position.gramet, fl: $position.fl}} min-scale=\"0.3\"></pinch-zoom>\n    <svg><use xlink:href=\"#plane-symbol\"/></svg>\n    <!-- {#if (($flightProgress === 0 || $flightProgress === 100) && ogimetParams.get('tref') * 1000 > $ofp.infos.ofpOFF.getTime())}\n        <div class=\"warning\">GRAMET pour décollage maintenant</div>\n    {/if} -->\n    {#if (($position.gramet === 0 || $position.gramet === 100 || $simulate>=0))}\n        <SimulatorPlayer/>\n    {/if}\n</div>\n\n<style>\n    .pinch-zoom-parent{\n        width: 100%;\n        position:absolute;\n        bottom: -10px;\n        left:50%;\n        transform: translateX(-50%);\n        background-color: rgba(255,255,255,0.6);\n        background-image: url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='120px' width='120px' ><text transform='rotate(45)' x='20' y='7' fill='lightblue' fill-opacity='0.7' font-size='14'>GRAMET</text></svg>\");\n    }\n    svg {\n        position:absolute;\n        width: 40px;\n        height: 40px;\n        top:60px;\n        left: 0;\n        color: var(--plane-color);\n    }\n    /* .warning {\n        position: absolute;\n        z-index: 10;\n        top: 10px;\n        color: white;\n        background-color: var(--bs-warning);\n        padding: 5px;\n        left: 10px;\n    } */\n\n</style>\n","export default function mapResizeAction(node, map) {\n    let currentMap = map;\n    const resizeMap = () => currentMap && currentMap.resize() /* && console.log('map resized') */;\n    const observer = new IntersectionObserver((entries, observer) => { \n        entries.forEach(entry => {\n        if(entry.intersectionRatio===1){\n            resizeMap();\n        }\n    });\n    }, {threshold: 1});\n    observer.observe(node);\n    const handleVisibilityChange = () =>{\n        if (document && document.visibilityState && document.visibilityState === 'visible') {\n            resizeMap();\n        }\n    };\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange, false);\n    window.addEventListener(\"orientationchange\", resizeMap);\n\n    return {\n        update(map) {\n            currentMap = map;\n        },\n        destroy() {\n            observer.unobserve(node);\n            observer.disconnect();\n            window.removeEventListener(\"orientationchange\", resizeMap);\n            document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n            if (currentMap) currentMap.remove();\n            //console.log('map removed');\n        }\n    }\n}","<script>\n    import FormSettings from \"./mapSettings/Form.svelte\";\n    import {createMap, token} from './mapboxgl/mapManagement';\n    import {updateMapLayers} from './mapboxgl/layersManagement';\n    import {online, showGramet, simulate, aircraftType, showPlaneOnMap, route} from \"../stores.js\";\n    import {promiseTimeout, fetchSimultaneously, focusMap} from './utils';\n    import { createEventDispatcher, onMount, onDestroy, tick} from 'svelte';\n    import {get} from 'svelte/store';\n    import {findMissingCacheTiles} from '../tilesCache';\n    import CircleProgress from \"./CircleProgress.svelte\";\n    import AircraftType from \"./AircraftType.svelte\";\n    import MapPlane from \"./MapPlane.svelte\";\n    import MapProjectionSelect from \"./MapProjectionSelect.svelte\";\n    import Gramet from './Gramet.svelte';\n    import mapResizeAction from '../actions/mapResizeAction';\n\n    const dispatch = createEventDispatcher();\n    export let kmlOptions;\n    export let ofp;\n    let map;\n    let mapData;\n    let selectedProjection;\n    let aircraftTypeSelectElement;\n\n    let cacheMaxValue, cacheValue, cacheError, tilesMissing;\n    const initCacheMap = () => {\n        cacheMaxValue = 0;\n        cacheValue = -1;\n        cacheError = false;\n        tilesMissing = [];\n    };\n\n    let settings;\n    $: mapIsCached = tilesMissing !== undefined && tilesMissing.length === 0;\n    $: {\n        if ($route === '/map') {\n            tick().then(focusMap);\n        }\n    }\n    const caches = {};\n\n\n    export let id = 'map';\n\n    async function afterMapLoad(){\n        initCacheMap();\n        if (!!ofp) {\n            try {\n                tilesMissing = await findMissingCacheTiles(ofp, mapData);\n            } catch (err){\n                console.error(`Could not find missing cache tiles`, err);\n            }\n        }\n        //console.log(tilesMissing);\n        const attribution = document.querySelector(`#${id} .mapboxgl-ctrl-attrib-inner`);\n        if (attribution) {\n            attribution.appendChild(document.createTextNode(' | '));\n            attribution.appendChild(aircraftTypeSelectElement);\n            attribution.appendChild(document.createTextNode(`${\"CONF_AIRAC\".substring(0,2)}.${\"CONF_AIRAC\".substring(2,4)}`));\n        }\n    }\n\n    function projectionChange(e) {\n        e.target.blur(); // to avoid zoom problem in standalone mode\n        const showPlaneState = get(showPlaneOnMap);\n        if (map) map.remove();\n\n        showPlaneOnMap.set(false); // dom element will be removed by createMap\n        mapData = createMap(id, selectedProjection, ofp, kmlOptions, $aircraftType, afterMapLoad);\n        focusMap();\n        map = mapData.map;\n        setTimeout(async () => {\n            await tick;\n            showPlaneOnMap.set(showPlaneState);\n        }, 0);\n    }\n\n    function aircraftChange(e) {\n        e.target.blur(); // to avoid zoom problem in standalone mode\n        focusMap();\n        update({detail: {value: $aircraftType, name: \"airport-change\"}});\n    }\n\n    const update = (e) => {\n        updateMapLayers({\n            map,\n            mapData,\n            name: e.detail.name,\n            value: e.detail.value,\n            ofp: ofp,\n            kmlOptions,\n            mapOptions: selectedProjection,\n            aircraftType: $aircraftType\n        });\n        dispatch('save'); // set History\n    };\n\n    let cacheButtonDisabled = false;\n    const cacheMap = async (e) => {\n        if (cacheButtonDisabled) return false;\n        cacheButtonDisabled = true;\n        cacheValue = 0;\n        try {\n            cacheMaxValue = tilesMissing.length; // set the progress class\n            cacheError = false; //remove error class\n            try {\n                await promiseTimeout(4000, fetch(`./manifest.json?dummy=${Date.now()}`, {cache: \"no-store\"}));\n            } catch (err) {\n                console.error(err);\n                cacheButtonDisabled = false;\n                cacheError = true;\n                cacheValue = -1;\n                return false;\n            }\n            await fetchSimultaneously(tilesMissing, () => cacheValue++);\n            if (cacheValue>=cacheMaxValue){\n                caches[selectedProjection.id] = true;\n                caches=caches;\n                tilesMissing = [];\n                cacheMaxValue = 0;\n                cacheValue = -1;\n            }\n        }finally{\n            cacheButtonDisabled = false;\n            cacheValue = -1;\n        }\n    }\n    let supportWebP = true;\n    const canUseWebP = async () => {\n        const handler = (event) => {\n            supportWebP = event && event.type === 'load' ? image.width == 1 : false;\n        }\n        const image = new Image();\n        image.onerror = handler;\n        image.onload = handler;\n        image.src = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=';\n    };\n    canUseWebP();\n\n    onMount(() => {\n        mapboxgl.accessToken = token;\n        mapData = createMap(id, selectedProjection, ofp, kmlOptions, $aircraftType, afterMapLoad, true); //initialLoad = true\n        showPlaneOnMap.reset();\n        map = mapData.map;\n    });\n    onDestroy(() => {\n        //if (map) map.remove(); /-> map is removed by resize action\n        settings.endFocusMode();\n        map = undefined;\n        mapData = undefined;\n    });\n</script>\n\n<div id={id} use:mapResizeAction={map}></div>\n<div class=\"mapmenu\">\n    <div class=\"projection\">\n        <MapProjectionSelect bind:selected={selectedProjection} ofp={ofp} on:change={projectionChange}></MapProjectionSelect>\n        {#if (selectedProjection && window.indexedDB)}\n        <div class=\"cacheButton\"\n            class:cacheError={cacheError}\n            class:cacheProgress={cacheValue >= 0||cacheMaxValue > 0}\n            class:hidden={!ofp || mapIsCached|| !$online || caches[selectedProjection.id]===true}\n            on:click={(cacheButtonDisabled) ? () => false : cacheMap}>\n            <CircleProgress value={(cacheValue>=0) ? cacheValue : 0} max={cacheMaxValue}></CircleProgress>\n        </div>\n        {/if}\n    </div>\n    {#if selectedProjection && selectedProjection.subLabel}\n        <div class=\"projection-info\"><small>{selectedProjection.subLabel}</small></div>\n    {/if}\n    {#if (!supportWebP && mapData && mapData.mapOptions && mapData.mapOptions.tiles && mapData.mapOptions.tiles[0].endsWith('.webp'))}\n        <div class=\"nowebp\">Votre navigateur ne supporte pas l'affichage d'images au format .webp</div>\n    {/if}\n</div>\n{#if (mapData && !!ofp  && ($showPlaneOnMap || $simulate >= 0))}<MapPlane {mapData}/>{/if}\n<AircraftType bind:aircraftTypeSelectElement on:change={aircraftChange}/>\n<FormSettings mapOptions={selectedProjection} bind:this={settings} bind:kmlOptions on:change={update} on:save />\n{#if $showGramet}<Gramet/>{/if}\n\n<style>\n\n    #map {\n        flex: 1 1 auto;\n        height: auto;\n    }\n    .mapmenu {\n        position: absolute;\n        top: 10px;\n        left: 10px;\n        width: 180px;\n        user-select: none; /* supported by Chrome and Opera */\n        -webkit-user-select: none; /* Safari */\n        -moz-user-select: none; /* Firefox */\n    }\n    .projection {\n        display:flex;\n        align-items: center;\n    }\n    .projection-info {\n        margin-right: 24px;\n        font-size: 11px;\n        color: var(--bs-gray);\n        padding: 0 5px;\n        position: absolute;\n        margin-top: -3px;\n        margin-left: 2px;\n        background-color: rgba(255,255,255,0.4);\n    }\n    :global(.mapboxgl-ctrl-attrib-inner select[name=aircraftType]){\n        display: inline-block !important;\n    }\n    @media (max-width: 330px), (max-height: 720px) {\n        #map {\n            width: 100%;\n            height: 90vh;\n            margin: 0;\n        }\n        :global(main.map page) {\n            position: relative;\n        }\n        .mapmenu {\n            top :5px;\n        }\n    }\n    .hidden {\n        visibility: hidden;\n    }\n    .cacheButton {\n        margin-left: 10px;\n    }\n    :global(.cacheButton) {\n        display: inline-block;\n        position: relative;\n        cursor:pointer;\n        --progress-color: var(--bs-yellow);\n        --progress-arrowstroke: var(--bs-cyan);\n    }\n\n    :global(.cacheButton.cacheError) {\n        --progress-arrowstroke: var(--bs-red) !important;\n        --progress-trackcolor: var(--bs-gray-500) !important;\n    }\n    :global(.cacheButton.cacheProgress) {\n        --progress-arrowstroke: var(--bs-yellow);\n        --progress-trackcolor: black;\n    }\n    :global(.cacheButton.cacheProgress), :global(.cacheButton.cacheError){\n        --progress-circlefill: var(--bs-gray-100);\n    }\n    :global(.mapboxgl-ctrl button.mapboxgl-ctrl-layers){\n        display:flex;\n        align-items:center;\n        justify-content: center;\n    }\n    :global(.mapboxgl-ctrl button.mapboxgl-ctrl-layers svg){\n        width: 22px;\n        height: 22px;\n    }\n    :global(.map page) {\n        overflow: hidden;\n    }\n    :global(.mapboxgl-popup-content .airport) {\n        min-width: 180px;\n    }\n    :global(.mapboxgl-popup-content .airport p){\n        margin: 0 auto;\n        display: inline-block;\n        line-height: 1em;\n    }\n    :global(.mapboxgl-popup-content .track p strong){ /* LVLS EB highlight */\n        font-weight: normal;\n        background-color: #EEFAE3; /*very light green */\n    }\n    :global(.mapboxgl-popup-content .track p strong.error){ /* LVLS EB highlight if FL not found*/\n        background-color: #FAE3EE; /*very light pink */\n    }\n    :global(.mapboxgl-popup-content .security-1,\n            .mapboxgl-popup-content .security-2,\n            .mapboxgl-popup-content p.status) {\n        font-variant: all-small-caps;\n        font-weight: bold;\n        padding: 0.2em 0.4em;\n        border-radius: 2px;\n    }\n    :global(.mapboxgl-popup-content){\n        text-align: center;\n    }\n    :global(.mapboxgl-popup-content h1) {\n        font-size: small;\n        font-weight: bold;\n        margin-left: 5px;\n        margin-right: 5px; /* space for close button */\n    }\n    :global(.mapboxgl-popup-content .airport h1){\n        display: flex;\n        align-items: center;\n        column-gap: 1ch;\n        margin-left: 5px;\n        margin-right: 5px; /* space for close button */\n        margin-bottom: 0; /* because the flag uses a xx-large font */\n    }\n    :global(.mapboxgl-popup-content .airport .title){\n        flex: 1 1 auto;\n    }\n    :global(.mapboxgl-popup-content .flag){\n        font-size: 1.78rem;\n        margin-left: auto;\n    }\n    :global(.mapboxgl-popup-content .cc){\n        text-overflow: ellipsis;\n        overflow: hidden;\n        font-weight: normal;\n        white-space: nowrap;\n    }\n    :global(.mapboxgl-popup-content h2){\n        font-size: small;\n        font-weight: normal;\n    }\n    :global(.mapboxgl-popup-content h2 b){\n        color: #062DF8;\n        font-weight: 900;\n        margin-left: 0.25rem;\n    }\n    :global(.mapboxgl-popup-content .track p){\n        text-align: left;\n        margin-bottom: 0;\n    }\n    :global(.mapboxgl-popup-content p.security-1){\n        color:black;\n        background-color: orange;\n        border: 1px solid orange;\n        margin-left: 1rem;\n    }\n    :global(.mapboxgl-popup-content p.security-2){\n        color:white;\n        background-color: red;\n        border: 1px solid red;\n        margin-left: 1rem;\n    }\n    :global(.mapboxgl-popup-content p.status){\n        color: black;\n        font-variant: all-small-caps;\n        font-weight: bold;\n        padding: 0.2em 0.4em;\n        border: 1px solid;\n    }\n    :global(.mapboxgl-popup-content p.status-1){\n        background-color: #ea80d8;\n        border-color: #ea80d8;\n    }\n    :global(.mapboxgl-popup-content p.status-2){\n        background-color:#fbfe98;\n        border-color:#fbfe98;\n    }\n    :global(.mapboxgl-popup-content p.status-3){\n        background-color:#00b0f1;\n        border-color:#00b0f1;\n    }\n    :global(.mapboxgl-popup-content p.status-0){\n        border:1px solid #ff0000;\n    }\n    :global(.mapboxgl-popup-content p.status-text){\n        color: #aaa;\n        display: block;\n        margin-top: 0.3em;\n    }\n    .nowebp {\n        background-color: #ff0000;\n        color:white;\n        max-width: 30vw;\n        font-size:small;\n        padding: 10px;\n        margin-top: 10px;\n    }\n    :global(.mapboxgl-popup-close-button:focus), :global(.mapboxgl-popup-close-button:focus:not(:focus-visible)){\n        outline-offset: -6px;\n        outline: 2px solid lightskyblue;\n    }\n    :global(.mapboxgl-canvas-container:focus-within::after){\n        content: \"\";\n        left: 0;\n        bottom: 0px;\n        width: 30px;\n        height: 30px;\n        display: block;\n        position: absolute;\n        border: #4D90FE80 5px solid;\n        border-top: none;\n        border-right: none;\n        line-height: 30px;\n        border-bottom-left-radius: 10px;\n    }\n</style>\n","export default [\n  \"bottom-right\",\n  \"bottom-center\",\n  \"bottom-left\",\n  \"top-right\",\n  \"top-center\",\n  \"top-left\",\n  \"right-bottom\",\n  \"right-center\",\n  \"right-top\",\n  \"left-bottom\",\n  \"left-center\",\n  \"left-top\"\n]\n","const RIGHT = \"right\";\nconst LEFT = \"left\";\nconst TOP = \"top\";\nconst CENTER = \"center\";\nconst BOTTOM = \"bottom\";\n\n// for SSR\nexport function isBrowser() {\n  return typeof window !== 'undefined' && typeof document !== 'undefined';\n}\n\nexport const getNextPosition = (position, dimensions) => {\n  const clientHeight = Math.min(document.body.clientHeight, document.documentElement.clientHeight);\n  const clientWidth = Math.min(document.body.clientWidth, document.documentElement.clientWidth);\n  Object.assign(dimensions, { clientWidth, clientHeight });\n\n  const [mainPosition, secondaryPosition] = position.split('-');\n  const nextMainPosition = getMainPosition(mainPosition, dimensions);\n  const nextSecondaryPosition = getSecondaryPosition(secondaryPosition, dimensions);\n\n  return `${nextMainPosition}-${nextSecondaryPosition}`;\n}\n\nconst getMainPosition = (\n  position,\n  {\n    top,\n    bottom,\n    left,\n    right,\n    height,\n    width,\n    clientWidth,\n    clientHeight,\n  },\n) => {\n\n  const fitsOnTop = top > height;\n  const fitsOnBottom = bottom + height < clientHeight;\n\n  const fitsOnLeft = left > width;\n  const fitsOnRight = right + width < clientWidth;\n\n  const positions = {\n    top: () => !fitsOnTop && fitsOnBottom ? BOTTOM : TOP,\n    bottom: () => fitsOnTop && !fitsOnBottom ? TOP : BOTTOM,\n    left: () => !fitsOnLeft && fitsOnRight ? RIGHT : LEFT,\n    right: () => !fitsOnRight && fitsOnLeft ? LEFT : RIGHT,\n  };\n\n  return positions[position]();\n};\n\nconst getSecondaryPosition = (\n  position,\n  {\n    top,\n    bottom,\n    left,\n    right,\n    height,\n    width,\n    clientWidth,\n    clientHeight,\n  }\n) => {\n  const parentHeight = bottom - top;\n  const parentCenter = top + parentHeight / 2;\n\n  const fitsOnTop = bottom > height;\n  const fitsOnBottom = top + height < clientHeight;\n  const fitsCenter = (parentCenter - height / 2) > 0 && (parentCenter + height / 2) < clientHeight;\n  const fitsOnLeft = right > width;\n  const fitsOnRight = left + width < clientWidth;\n\n  const positions = {\n    top: () => !fitsOnTop && fitsOnBottom ? BOTTOM : TOP,\n    center: () => fitsCenter ? CENTER : positions.top(),\n    bottom: () => !fitsOnBottom && fitsOnTop ? TOP : BOTTOM,\n    left: () => !fitsOnLeft && fitsOnRight ? RIGHT : LEFT,\n    right: () => !fitsOnRight && fitsOnLeft ? LEFT : RIGHT,\n  };\n\n  return positions[position]();\n};\n","<script>\n\timport {\n\t\tbeforeUpdate,\n\t\tonMount,\n\t\tonDestroy,\n\t\ttick,\n\t\tcreateEventDispatcher,\n\t} from 'svelte';\n\timport POSITIONS from './positions';\n\timport { isBrowser, getNextPosition } from './helpers';\n\tconst dispatch = createEventDispatcher();\n\n\tconst DEFAULT_POSITION = POSITIONS[0];\n\n\texport let isOpen = false;\n\texport let updateOnScroll = false;\n\texport let closeOnScroll = false;\n\texport let position = DEFAULT_POSITION;\n\texport let closeOnClickOutside = false;\n\texport let zIndex = 1;\n\texport let onWindowKeyDown = () => {};\n\texport let style = '';\n\n\t$: className = $$restProps['class'] || '';\n\n\tlet currentPosition = null;\n\tlet parent;\n\tlet content;\n\tlet target;\n\n\tlet topStyle = 0;\n\tlet leftStyle = 0;\n\tlet widthStyle = 0;\n\tlet heightStyle = 0;\n\n\t$: hasParent = !parent || !!parent.childNodes.length;\n\t$: hasContent = !content || !!content.childNodes.length;\n\n\t$: if(!hasParent) throw new Error('parent slot is required');\n\t$: if(!hasContent) throw new Error('content slot is required');\n\n\t$: openedState = isOpen && hasParent && hasContent;\n\n\tfunction addListeners() {\n\t\tif (!isBrowser()) return;\n\t\twindow.addEventListener('resize', updatePosition);\n\t\tif (closeOnScroll) window.addEventListener('scroll', close);\n\t\telse if (updateOnScroll) window.addEventListener('scroll', updatePosition);\n\t}\n\n\tfunction removeListeners() {\n\t\tif (!isBrowser()) return;\n\t\twindow.removeEventListener('resize', updatePosition);\n\t\twindow.removeEventListener('scroll', updatePosition);\n\t\twindow.removeEventListener('scroll', close);\n\t}\n\n\tonMount(() => {\n\t\tif (openedState) {\n\t\t\taddListeners();\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (!isBrowser()) return;\n\t\tremoveListeners();\n\t});\n\n\n\tbeforeUpdate(updatePosition);\n\n\tfunction toggle(value) {\n\t\tconst prevOpen = isOpen;\n\t\tconst nextOpen = value === true || value === false ? value : !isOpen;\n\n\t\tif (nextOpen && hasParent && hasContent || !nextOpen) isOpen = nextOpen;\n\n\t\tif(prevOpen !== isOpen) {\n\t\t\tdispatch('toggle', isOpen);\n\t\t\tif (isOpen) {\n\t\t\t\taddListeners();\n\t\t\t\tdispatch('open');\n\t\t\t} else {\n\t\t\t\tdispatch('close');\n\t\t\t\tremoveListeners();\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction open() {\n\t\tif (!openedState) toggle(true);\n\t}\n\n\tfunction close() {\n\t\tif (openedState) toggle(false);\n\t}\n\n\tfunction contains (event) {\n\t\tconst path = event.path || event.composedPath();\n\t\treturn path.includes(parent) || path.includes(content);\n\t}\n\n\tfunction handleWindowClick(event) {\n\t\tif (!closeOnClickOutside || !openedState || contains(event)) return;\n\t\tclose();\n\t}\n\n\tfunction handleWindowKeyDown(event) {\n\t\tif (!onWindowKeyDown || !openedState) return;\n\t\tonWindowKeyDown(event, { isOpen: openedState, open, close, toggle, contains });\n\t}\n\n\tasync function updatePosition() {\n\t\tawait tick();\n\t\tif (!openedState) return;\n\t\tif (!POSITIONS.includes(position)) position = DEFAULT_POSITION;\n\n\t\tconst {\n\t\t\ttop,\n\t\t\tbottom,\n\t\t\tleft,\n\t\t\tright,\n\t\t\twidth: parentWidth,\n\t\t\theight: parentHeight,\n\t\t} = parent.getBoundingClientRect();\n\t\tconst { height, width } = content.getBoundingClientRect();\n\n\t\tconst dimensions = { top, bottom, left, right, height, width };\n\t\tconst nextPosition = getNextPosition(position, dimensions);\n\n\t\tif (currentPosition !== nextPosition) {\n\t\t\tcurrentPosition = nextPosition;\n\t\t}\n\n\t\ttopStyle = top;\n\t\tleftStyle = left;\n\t\twidthStyle = parentWidth;\n\t\theightStyle = parentHeight;\n\t}\n</script>\n\n<svelte:window\n\ton:mousedown={handleWindowClick}\n\ton:keydown={handleWindowKeyDown} />\n\n<div bind:this={target} class={`overlay ${className}`} style={`z-index:${zIndex}; ${style}`}>\n\t<div bind:this={parent}>\n\t\t<slot name=\"parent\" {toggle} isOpen={openedState} {open} {close} />\n\t</div>\n\t<div\n\t\tclass=\"content-wrapper\"\n\t\tstyle={`top: ${topStyle}px; left: ${leftStyle}px; width: ${widthStyle}px; height: ${heightStyle}px; z-index:${zIndex};`}\n\t>\n\t\t{#if openedState}\n\t\t\t<div class={`content ${currentPosition || ''}`} bind:this={content}>\n\t\t\t\t\t<slot name=\"content\" {toggle} isOpen={openedState} {open} {close} />\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n  .overlay {\n    position: relative;\n\t\tdisplay: inline-block;\n\t\tbox-sizing: border-box;\n  }\n\n  .content-wrapper {\n    position: fixed;\n    pointer-events: none;\n    width: max-content;\n  }\n\n  .content-wrapper > * {\n    pointer-events: all;\n  }\n\n  .content {\n    position: absolute;\n    min-width: 100%;\n  }\n\n  .top-left,\n  .top-center,\n  .top-right {\n    bottom: 100%;\n  }\n\n  .bottom-left,\n  .bottom-center,\n  .bottom-right {\n    top: 100%;\n  }\n\n  .top-left,\n  .bottom-left {\n    right: 0;\n  }\n\n  .top-center,\n  .bottom-center {\n    left: 50%;\n    transform: translateX(-50%);\n  }\n\n  .top-right,\n  .bottom-right {\n    left: 0;\n  }\n\n  .left-top,\n  .left-bottom,\n  .left-center {\n    right: 100%;\n  }\n\n  .right-top,\n  .right-bottom,\n  .right-center {\n    left: 100%;\n  }\n\n  .left-center,\n  .right-center {\n    top: 50%;\n    transform: translateY(-50%);\n  }\n\n  .left-top,\n  .right-top {\n    bottom: 0;\n  }\n\n  .left-bottom,\n  .right-bottom {\n    top: 0;\n  }\n</style>\n","<script>\n    export let href;\n    const isExternal = href && !href.startsWith('#');\n    const props = (isExternal) ? Object.assign({rel: \"noreferrer\", target: \"_blank\"}, $$restProps): $$restProps;\n</script>\n<!-- svelte-ignore a11y-missing-attribute -->\n<a {href} {...props}><slot></slot></a>","<script>\n    import {onDestroy, tick} from 'svelte';\n    import Overlay from 'svelte-overlay';\n    import {grametThumbAction, grametStatus, grametResponseStatus} from '../actions/grametAction';\n    import Link from '../components/Link.svelte';\n    import {showGramet, ofp, position} from '../stores';\n    import { focusMap } from './utils';\n    let grametUpdateAvailable = false;\n\n    const toggleGramet = () => {\n        if ($grametStatus === 'success') $showGramet = !$showGramet;\n        if (!$showGramet) focusMap();\n    }\n    const reload = async () => {\n        $grametStatus = 'reload';\n        $showGramet = false;\n        grametUpdateAvailable = false;\n        await tick;\n        $grametStatus = 'loading';\n        focusMap();\n    };\n    const grametSourceUpdate = async (event) => {\n        if (event.data.meta === 'workbox-broadcast-update' && event.data.type === 'CACHE_UPDATED') {\n                const {updatedURL} = event.data.payload;\n                if (updatedURL === $ofp.ogimetData.proxyImg) {\n                    if ($showGramet) {\n                        grametUpdateAvailable = true;\n                    }else{\n                        reload();\n                    }\n                }\n            }\n    };\n    if (navigator && navigator.serviceWorker){\n            navigator.serviceWorker.addEventListener('message', grametSourceUpdate);\n    }\n    onDestroy(() => {\n        //console.log('destroy gramet trigger');\n        if (navigator && navigator.serviceWorker){\n            navigator.serviceWorker.removeEventListener('message', grametSourceUpdate);\n        }\n    });\n</script>\n{#if $grametStatus !== 'error' && $grametStatus !== 'reload'}\n    <div class=\"gramet-thumbnail\" class:open={$showGramet} use:grametThumbAction={{ofp: $ofp, pos: $position.gramet, fl: $position.fl}} on:click={toggleGramet}>\n        <svg id=\"gt-plane\" viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n            <circle cx=\"50\" cy=\"50\" r=\"50\"/>\n        </svg>\n        {#if ($showGramet)}\n            <svg class=\"gramet-close\"><use xlink:href=\"#close-symbol\"/></svg>\n        {/if}\n    </div>\n    <Overlay  position=\"bottom-center\" style=\"margin-right: 0 !important;\" isOpen={grametUpdateAvailable}>\n        <div slot=\"parent\" class=\"d-none\"></div>\n        <div slot=\"content\" let:close style=\"width: 290px;\">\n            <div class=\"overlay card\" style=\"left: calc(-1rem - 35px); max-width: 290px; top: 20px;\">\n                <div class=\"card-header\">\n                    <span>Nouveau GRAMET disponible</span>\n                    <button type=\"button\" class=\"btn-close ms-auto\" aria-label=\"Close\" on:click={close}></button>\n                </div>\n                <div class=\"card-body\">\n                    <p class=\"text-center mt-3\"><button class=\"btn btn-primary\" on:click={reload}>Mettre à jour</button></p>\n                </div>\n            </div>\n        </div>\n    </Overlay>\n{:else if ($grametStatus !== 'reload')}\n    <Overlay  position=\"bottom-center\" on:close={focusMap}>\n        <button slot=\"parent\" class=\"btn btn-light\" let:toggle on:click={toggle}>\n            <svg class=\"gramet-error\"><use xlink:href=\"#info-symbol\"/></svg>\n        </button>\n    \n        <div slot=\"content\" let:close style=\"width: 350px;\">\n            <div class=\"overlay card\" style=\"position: absolute\">\n                <div class=\"card-header\">\n                    <span>😱: Erreur de récupération du Gramet</span>\n                    <button type=\"button\" class=\"btn-close ms-auto\" aria-label=\"Close\" on:click={close}></button>\n                </div>\n                <div class=\"card-body\">\n                <p><a href=\".\" on:click|preventDefault={() => $grametStatus = 'loading'}>essayez à nouveau</a> ou allez sur <Link href={$ofp.ogimetData.url} target=\"_blank\">ogimet</Link>.</p>\n                {#if $grametResponseStatus.status === 409}\n                    <p>Erreur construction route GRAMET: Station \"<code>{$grametResponseStatus.text}</code>\" non reconnue par ogimet,\n                    merci de me remonter l'information pour que je corrige l'application. Inutile de réessayer.</p>\n                {:else if $grametResponseStatus.text === \"no grib data\"}\n                    <p>Le serveur ogimet indique qu'il est indisponible (no grib data). Sa mise à jour débute normalement à 00:00z et c'est long...</p>\n                {:else}\n                    <p>A certaines heures le site ogimet est saturé, il faut essayer 2 ou 3 fois en temporisant de 30 secondes à chaque essai.</p>\n                    {#if $grametResponseStatus.status !== 0}\n                        <p>Pour information, le proxy a retourné: <code>{$grametResponseStatus.text || $grametResponseStatus.status}</code></p>\n                    {/if}\n                {/if}\n                </div>\n            </div>\n        </div>\n    </Overlay>\n{:else if ($grametStatus === 'reload')}\n    <div class=\"gramet-thumbnail updating\"><p>↻</p><p>Mise à jour</p></div>\n{/if}\n\n\n<style>\n.gramet-thumbnail{\n    --gramet-thumb-height: 39px;\n    height: var(--gramet-thumb-height);\n    margin-right: 1rem;\n    overflow: hidden;\n    position: relative;\n    flex: 0 1 70px; /* a cdg-dub flight is 78px*/\n    border-radius: 3px;\n    align-self: baseline;\n    display: none;\n    cursor: pointer;\n}\n.gramet-thumbnail.updating p {\n    margin: 0;\n    font-size: small;\n    text-align: center;\n}\n@media (min-width: 576px){\n    .gramet-thumbnail {\n        display:block;\n    }\n}\n.gramet-error {\n    --height: 20px;\n    height: var(--height);\n    width: 20px;\n    stroke: red;\n    transform: rotate(180deg);\n    vertical-align: text-bottom;\n    /* margin-top: calc((var(--gramet-thumb-height) - var(--height)) / 2); */\n}\n.gramet-thumbnail .gramet-close{\n    stroke: var(--bs-light);\n    width: 100%;\n    height: 100%;\n    position: relative;\n    top: 0;\n    z-index: 2;\n}\n\nbutton[slot=parent]{\n    display: flex;\n    padding: 0;\n}\n.gramet-thumbnail :global(img){\n    transition: opacity 0.5s ease-in;\n}\n#gt-plane {\n    position: absolute;\n    z-index: 1;\n    display: none;\n    fill: var(--plane-color);\n    stroke: black;\n    width: 6px;\n    stroke-width: 10px;\n}\n</style>","/* globals editolido */\nconst parisBase = ['CDG', 'ORY'];\nconst getFlightTypePNC = (departure, destination) => {\n    if (departure.longitude >= -30 && departure.longitude <= 40 && departure.latitude >=25 \n        && destination.longitude >= -30 && destination.longitude <= 40 && destination.latitude >=25) {\n        return \"MC\";\n    }\n    return \"LC\";\n}\nconst getFlightTypePNT = (distance) => {\n    if (distance <= 2100) {\n        return \"MC1\";\n    } else if (distance <=3000) {\n        return \"MC2\";\n    }\n    return \"LC\"\n}\nconst isBase = (base, iata) => {\n    if (base === 'PAR') return parisBase.includes(iata);\n    return base === iata;\n}\n\nconst getMeridians = (base, baseTZ, duties) => {\n    const meridians = [];\n    for (const duty of duties) {\n        const lastLeg = duty.legs[duty.legs.length - 1];\n        //console.log(lastLeg, parseFloat(lastLeg.destTZ) - baseTZ, isBase(lastLeg.destIATA), lastLeg.destIATA)\n        if (!isBase(base, lastLeg.destIATA)) {\n            meridians.push(Math.abs(parseFloat(lastLeg.destTZ) - baseTZ));\n        }\n    }\n    return Math.max(meridians);\n}\n\nconst addDutyMeta = (duty, {base}) => {\n    const lastLeg = duty.legs[duty.legs.length - 1];\n    if (lastLeg) {\n        duty.OUT = duty.legs[0].OUT;\n        duty.IN = lastLeg.IN;\n        duty.TVSV = duty.legs.reduce((a, v) => v.blockTime + a, 0);\n        if (!isBase(base, lastLeg.destIATA)) {\n            duty.layover = lastLeg.destIATA;\n            duty.layoverTZ = lastLeg.destTZ;\n        }\n    }\n    return duty;\n}\n\nexport const pairingData = (ofp) => {\n    const results = {};\n    if (!ofp) return results;\n    let pairing = {};\n    let duties = [];\n    let scheduledTSV;\n    let pattern, match;\n    try {\n        const pairingText = editolido.extract(ofp.text, 'CREW PAIRING', 'Generated');\n        pattern = /TSV\\s+-\\s+(\\d{2}):(\\d{2})/u;\n        match = pattern.exec(pairingText);\n        scheduledTSV = (match) ? parseInt(match[2], 10) + parseInt(match[1], 10) * 60 : 0; //in minutes\n        pattern = /DATE\\s:\\s(\\d+)\\.(\\S{3})\\.(\\d{4})/u;\n        match = pattern.exec(pairingText);\n        let month, year; // for pairing start\n        if (match) {\n            year = parseInt(match[3], 10);\n            month = editolido.months3.indexOf(match[2]) + 1; // 1-12\n            if (month <= 0) throw new Error('could not extract pairing month');\n        } else {\n            throw new Error('could not extract pairing month/year');\n        }\n        pattern = new RegExp(String.raw`>\\s${ofp.infos.depIATA}\\s\\(([-+.0-9]+)\\)`, \"u\");\n        match = pattern.exec(pairingText);\n        results.depTZ = (match) ? match[1] : '';\n        pattern = new RegExp(String.raw`>\\s${ofp.infos.destIATA}\\s\\(([-+.0-9]+)\\)`, \"u\");\n        match = pattern.exec(pairingText);\n        results.destTZ = (match) ? match[1] : '';\n        pattern = /OPERATION VERSION\\s(.+?)\\s\\d+\\sNB PAX/u;\n        match = pattern.exec(pairingText);\n        results.aircraftOpsVersion = (match) ? match[1] : '';\n        pattern = /(\\d{2})\\/(\\d{2})\\s\\S+\\s(\\S{3})\\s>\\s(\\S{3})\\s\\(([-+\\d.]+)\\)\\s(\\d{2}):(\\d{2})\\s(?:\\d{2}:\\d{2})\\s(\\d{2}):(\\d{2})/gu;\n        // eslint-disable-next-line init-declarations\n        let tz = 0;\n        let duty = {\"legs\": []};\n        let flightTypePNC = \"MC\";\n        let flightTypePNT = \"MC1\";\n        let base = undefined;\n        for (match of pairingText.matchAll(pattern)) {\n            const m = parseInt(match[2], 10); // 1-12\n            const d = parseInt(match[1], 10);\n            const y = (m < month) ? year + 1 : year;\n            const scheduledOut = new Date(Date.UTC(y, m - 1, d, parseInt(match[6], 10), parseInt(match[7], 10))); // month must be 0-11\n            const blockTime = parseInt(match[9], 10) + parseInt(match[8], 10) * 60;\n            const scheduledIN = new Date(scheduledOut.getTime() + 60000 * blockTime);\n            const depIATA = match[3];\n            const departure = editolido.iata2GeoPoint(depIATA);\n            if (!base) base = (parisBase.includes(depIATA)) ? 'PAR' : depIATA;\n            const arrival = editolido.iata2GeoPoint(match[4]);\n            const groundDistance = Math.round(departure.distanceTo(arrival, editolido.rad_to_nm));\n            if (flightTypePNC !== \"LC\" && getFlightTypePNC(departure, arrival) === \"LC\") {\n                flightTypePNC = \"LC\";\n            }\n            if (flightTypePNT !== \"LC\") {\n                const distanceType = getFlightTypePNT(groundDistance);\n                if (distanceType === \"LC\" || (distanceType === \"MC2\" && flightTypePNT === \"MC1\")){\n                    flightTypePNT = distanceType;\n                }\n            }\n            if (duty.legs.length !== 0 && scheduledOut - duty.legs[duty.legs.length - 1].IN > 36000000) { // more than 10 hours\n                duties.push(addDutyMeta(duty, {base}));\n                duty = {\"legs\": []};\n            }\n            duty.legs.push({\n                //\"depPoint\": {\"latitude\": departure.latitude.toFixed(6), \"longitude\": departure.longitude.toFixed(6)},\n                \"depICAO\": departure.name,\n                \"depIATA\": depIATA,\n                //\"destPoint\": {\"latitude\": arrival.latitude.toFixed(6), \"longitude\": arrival.longitude.toFixed(6)},\n                \"destIATA\": match[4],\n                \"destICAO\": arrival.name,\n                //\"groundDistance\": groundDistance,\n                \"destTZ\": match[5],\n                \"depTZ\": tz,\n                \"OUT\": scheduledOut,\n                \"IN\": scheduledIN,\n                \"blockTime\": blockTime,\n                \"isOFP\": (scheduledOut.toISOString() === ofp.infos.ofpOUT.toISOString())\n            });\n            tz = match[5];\n        }\n        if (duty.legs.length > 0) duties.push(addDutyMeta(duty, {base}));\n        pairing.baseTZ = tz;\n        pairing.base = base;\n        if (duties.length > 0) {\n            duties[0].legs[0].depTZ = tz;\n        }\n        pairing.flightTypePNT = (flightTypePNT === \"MC2\" && getMeridians(base, parseFloat(pairing.baseTZ), duties) >= 4) ? \"LC\" : flightTypePNT;\n        pairing.flightTypePNC = flightTypePNC;\n        //console.log(getMeridians(base, parseFloat(pairing.baseTZ), duties))\n\n    } catch (err) {\n        if (!(err instanceof editolido.StringExtractException)) {\n            console.error(err);\n        }\n        duties = [];\n    }\n    results.pairing = pairing;\n    results.pairing.duties = duties; \n    const duty = duties.filter(duty => duty.legs.reduce((a, v) => v.isOFP || a, false)).pop();\n    results.scheduledTSV = scheduledTSV; //deprecated\n    if (duty) {\n        duty.TSV = scheduledTSV;\n        if (duty.legs.length > 0) {\n            const lastLeg = duty.legs[duty.legs.length - 1];\n            if (!isBase(pairing.base, lastLeg.destIATA)) {\n                duty.layover = lastLeg.destIATA;\n                duty.layoverTZ = lastLeg.destTZ;\n            }\n        }\n    }\n    results.duty = duty;\n    return results;\n}","<script>\n    import {ofp, takeOffTime} from '../stores';\n    import plugins from \"../plugins.json\";\n    import {pairingData} from \"./pairingParser\";\n    let shareURL;\n\n    /**\n     * standalone app and safari share the same app cache\n     * This is an attempt to read a share_cache/share-shortcut fake endpoint\n     * \n     * It is not yet functional\n     */\n    const getShortcutName = async () => {\n        const cache = await caches.open(\"share_cache\");\n        const response = await cache.match('/share-shortcut');\n\n        if (!response) {\n        return null;\n        }\n\n        const responseBody = await response.json();\n        return responseBody['shortcutName'];\n    };\n    let shareShortcut;\n    getShortcutName()\n        .then(name => shareShortcut = name)\n        .catch(err => console.error(err));\n\n    function* etopsData(ofp, takeOff){\n        if (!ofp || !takeOff) return [];\n        let etopsSummary = '';\n        const ralts = ofp.infos['ralts'];\n        if(ralts.length > 0) {\n            try{\n                etopsSummary = ofp.text.extract('ETOPS SUMMARY', 'SUMMARY-').replace(ofp.removePageFooterRegex,'');\n            } catch(err){\n                console.error(err);\n            }\n        }\n        const pattern = String.raw`(EEP\\(\\S{4}\\)|ETP\\S+|EXP\\(\\S{4}\\))\\s+\\d{2}\\.\\d{2}\\s+(\\S+)\\s+(\\S+)\\s+EET (\\d{2})\\.(\\d{2}) .+? ([\\d.]+)\\/EFOB ([\\d.]+)(?:.+?(${ralts.join('|')})\\s(\\S+).+?\\sREQ\\s(\\d{2})(\\d{2})-(\\d{2})(\\d{2}))?`\n        const regex = new RegExp(pattern, 'gm');\n        const day = new Date(takeOff);\n        const delta = takeOff - ofp.infos.ofpOFF;\n        day.setUTCHours(0, 0);\n        const matches = etopsSummary.matchAll(regex);\n        for (let [,name, latString, lngString, hours, minutes, fuelRequired, efob, ralt, rwy, startHours, startMinutes, endHours, endMinutes] of matches) {\n            const latlng = editolido.dm_normalizer([latString, lngString]);\n            const eet = parseInt(hours, 10) * 60 + parseInt(minutes, 10);\n            const eto = new Date(takeOff.getTime() + eet * 60000);\n            const fuelMargin = Math.round((parseFloat(efob) - parseFloat(fuelRequired)) * 10) / 10;\n            const startWindow = (startHours !== undefined && startMinutes !== undefined) ? new Date(day.getTime() + (parseInt(startHours, 10) * 3600000) + (parseInt(startMinutes, 10) * 60000) + delta) : undefined;\n            const endWindow = (endHours !== undefined && endMinutes !== undefined) ? new Date(day.getTime() + (parseInt(endHours, 10) * 3600000) + (parseInt(endMinutes, 10) * 60000) + delta) : undefined;\n            yield([name, eto, parseFloat(fuelRequired), parseFloat(efob), fuelMargin, ralt, rwy, startWindow, endWindow, latlng, eet])\n        }\n    };\n    // note that if $ofp.infos.tripFuel = 0 (bad ofp parsing), fuelMarginTime will be infinity => no alert\n    $: fuelMarginTime = $ofp.infos.minFuelMarginETOPS / ($ofp.infos.tripFuel/$ofp.infos.flightTime);\n\n    const etopsMarkdown = (altnETOPSPoints) => {\n        const results = [];\n        const getHours = (data) => data.getUTCHours().toString().padStart(2, '0');\n        const getMinutes = (data) => data.getUTCMinutes().toString().padStart(2, '0');\n        for (const data of altnETOPSPoints) {\n            if (data.description === 'ETOPS') {\n                results.push(`\\n**Appui**: ${data.name} ${data.runway} - Plage: **${getHours(data.startWindow)}${getMinutes(data.startWindow)}-${getHours(data.endWindow)}${getMinutes(data.endWindow)}**`);\n            }else{\n                let myName;\n                if (data.description.startsWith('ETP')) {\n                    myName = `**${data.description}** ${data.name}`;\n                }else{\n                    myName = `**${data.description.substring(0,3)}**${data.description.substring(3)}`\n                }\n                results.push(`\\n${myName} ➔ ETO: **${getHours(data.ETO)}:${getMinutes(data.ETO)}** | ΔFUEL: **${data.fuelMargin}**\\n`);\n            } \n        }\n        return results;\n    };\n    const etopsList = (ofp, takeOff) => {\n        let currentRalt = '';\n        const results = [];\n        for(const [label, eto, , , fuelMargin, ralt, runway, startWindow, endWindow, latlng, eet] of etopsData(ofp, takeOff)) {\n            const res = {\n                \"latitude\": latlng.latitude,\n                \"longitude\": latlng.longitude,\n                \"EET\": eet,\n                \"ETO\": eto,\n                \"fuelMargin\": fuelMargin.toFixed(1)\n            };\n            if (label.startsWith('ETP')) {\n                res.name = `${currentRalt}/${ralt}`;\n                res.description = label;\n            }else{\n                res.name = label.substring(4,8);\n                res.description = label.substring(0,3);\n            }\n            results.push(res);\n            if(ralt) {\n                const raltPoint = ofp.infos['raltPoints'].filter(p => p.name === ralt).pop();\n                let latitude, longitude;\n                if (raltPoint) {\n                    latitude = raltPoint.latitude;\n                    longitude = raltPoint.longitude;\n                }\n                results.push({\n                    \"name\": ralt,\n                    \"description\": \"ETOPS\",\n                    latitude,\n                    longitude,\n                    runway,\n                    startWindow,\n                    endWindow\n                });\n                currentRalt = ralt;\n            }\n        }\n        return results;\n    };\n    const getOfpRouteExport = (ofp) => {\n        if (ofp.timeMatrix.length > 0) {\n            return ofp.timeMatrix.map(([p, sum, fl]) => ({\n                \"name\": p.name,\n                \"tte\": sum,\n                fl,\n                \"latitude\":  p.latitude.toFixed(6),\n                \"longitude\":  p.longitude.toFixed(6)}));\n        }\n        return ofp.route.points.map(p => ({\n            \"name\": p.name,\n            \"latitude\":  p.latitude.toFixed(6),\n            \"longitude\":  p.longitude.toFixed(6)}));\n    };\n    export const shareOFP = async (e) => {\n        if (!shareShortcut) e.preventDefault();\n        if (!(navigator && navigator.share)) {e.preventDefault(); return false;}\n        const ofp = $ofp;\n        const takeOffTime = $takeOffTime;\n        const excluded = ['EEP', 'EXP', 'raltPoints', 'rawFPL', 'inFlightStart', 'inFlightReleased'];\n        const filteredInfos = Object.fromEntries(\n            Object.entries(ofp.infos).filter(([key, val])=> !excluded.includes(key))\n        );\n        const shareData = {\n            'title': 'OFP2MAP',\n            'text': JSON.stringify({\n                ...filteredInfos,\n                lidoFPL: ofp.lidoRoute(false).join(' '),\n                'realOFF': takeOffTime,\n                \"altnETOPS\": ofp.infos.ralts,\n                'route': getOfpRouteExport(ofp),\n                ...pairingData(ofp),\n                //deprecated from 07/08/21\n                'registration': ofp.infos.aircraftRegistration,\n                'ralts': ofp.infos.ralts,\n                'etopsOutput': etopsMarkdown(etopsList(ofp, takeOffTime)), //TODO when removing, delete ref to etopsMarkdown, etopsList, etopsData\n                'ofp2map-takeoff': takeOffTime,\n                //end of deprecated\n                plugins,\n                rawText: ofp.text\n            })//.replace(/\"(?:lati|longi)tude\":\"([0-9.]+)\"/gu, (_, p1) => p1)\n        }\n\n        if (shareShortcut) {\n            shareURL = \"shortcuts://run-shortcut?name=\" + encodeURIComponent(shareShortcut) + \"&input=text&text=\" + encodeURIComponent(JSON.stringify(shareData));\n            return true;\n        }else{\n            try {\n                await navigator.share(shareData)\n            } catch(err) {\n                console.log(err);\n            }\n            return false;\n        }\n    };\n\n</script>\n\n<div class=\"infos\">\n    {#if (fuelMarginTime < 20)}<p class=\"etops\">ETOPS</p>{/if}\n    <a  href=\"{shareURL}\" class=\"details\"  class:cursor-pointer={(navigator && navigator.share)} on:click={shareOFP}>\n    <p><b>{$ofp.infos.flightNo}</b> {$ofp.infos.depICAO}-{$ofp.infos.destICAO}</p>\n    <p>{$ofp.infos.ofpTextDate} {($ofp.infos.ofp.includes('/')) ? '' : 'ofp: '}{$ofp.infos.ofp}\n        {#if (navigator && navigator.share)}<span class=\"plugin\">🧩</span>{/if}\n    </p>\n    </a>\n</div>\n\n<style>\n    .infos{\n        display: none;\n        margin-right: 1rem;\n        font-size: small;\n        flex-direction: row;\n        max-height: 38px;\n        cursor: none;\n        align-items: center;\n    }\n    .details{\n        display: flex;\n        flex-direction: column;\n        color: inherit;\n        cursor: default;\n    }\n    .details, .details:hover{\n        text-decoration: none;\n    }\n    @media (min-width: 500px){\n        .infos {\n            display: flex;\n        }\n    }\n    p{\n        margin:0\n    }\n    .cursor-pointer{\n        cursor: pointer !important;\n    }\n    :global(.etops){\n        writing-mode: vertical-rl;\n        text-orientation: upright;\n        font-size: 6px;\n        margin-right: 5px;\n        margin-left: -1em;\n        font-weight: 700;\n        background-color: var(--bs-warning);\n    }\n    .plugin {\n        width:20px;\n        height: 20px;\n        vertical-align: bottom;\n    }\n</style>","<script>\n    import {ofp, simulate, takeOffTime, showPlaneOnMap} from '../stores';\n    import blurAction from '../actions/blurAction';\n    import {focusMap} from './utils';\n    export let name=\"take-off\";\n\n    const ofpTakeOff = new Date($ofp.infos.ofpOFF.getTime());\n    //console.log($takeOffTime, $ofp)\n    const hm2input = (hours, minutes) => `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n\n    const togglePlane = () => {\n        $showPlaneOnMap = !$showPlaneOnMap;\n        focusMap();\n    };\n    const changeTime = (e) => {\n        let minutes, hours;\n        if (e.target.value == ''){\n            hours = ofpTakeOff.getUTCHours();\n            minutes = ofpTakeOff.getUTCMinutes();\n            e.target.blur();\n            focusMap();\n            e.target.value = hm2input(hours, minutes);\n        }else{\n            hours = parseFloat(e.target.value.slice(0,2));\n            minutes = parseFloat(e.target.value.slice(3));\n            //can not set focus here, input still shown!\n        }\n\n        let newTakeOff = new Date(ofpTakeOff);\n        newTakeOff.setUTCMinutes(minutes);\n        newTakeOff.setUTCHours(hours);\n        const diff = (newTakeOff.getTime() - ofpTakeOff.getTime()) / 60000;\n        if (diff < -720 ) {\n            newTakeOff = new Date(newTakeOff.getTime() + (1440 * 60000)); // +1 day\n        } else if (diff > 720 ){\n            newTakeOff = new Date(newTakeOff.getTime() - (1440 * 60000)); // -1 day\n        }\n        $takeOffTime = newTakeOff;\n        if (newTakeOff.toISOString() !== ofpTakeOff.toISOString()) {\n            e.target.classList.add(\"changed\");\n        }else{\n            e.target.classList.remove(\"changed\");\n        }\n    };\n</script>\n\n{#if $takeOffTime}\n<div>\n    <svg class:show={$showPlaneOnMap || $simulate >= 0} class:hide={!($showPlaneOnMap || $simulate >= 0)} on:click={togglePlane}><use xlink:href=\"#takeoff-symbol\"/></svg>\n    <label for=\"{name}\">Heure de décollage</label><!-- displayed in ios popup -->\n    <input id=\"{name}\" name=\"{name}\" type=\"time\" use:blurAction on:change={changeTime} value=\"{hm2input($takeOffTime.getUTCHours(), $takeOffTime.getUTCMinutes())}\" tabindex={(navigator.standalone) ? \"-1\" : null}/>\n</div>\n{/if}\n<style>\n    label{\n        display: none;\n        /* position: absolute; */\n        /* top: -50px; */\n    }\n    div {\n        display: flex;\n        align-items: flex-start;\n        /* outline: 1px solid rgba(0,0,0,0.2); */\n        /* outline-style: dashed; */\n        outline: 1px solid #ced4da55;\n        margin-top: -1px;\n    }\n    svg {\n        width: 30px;\n        height: 30px;\n        display: inline-block;\n        margin-right: 5px;\n        margin-top: -1px;\n        cursor: pointer;\n    }\n    svg.show {\n        stroke: rgba(0,0,0,.9);\n        color: var(--plane-halo-color);\n    }\n    svg.hide {\n        stroke:transparent;\n        color: rgba(0,0,0,.5);\n    }\n    input {\n        background-color: var(--bs-light);\n        border-color: transparent;\n        color:rgba(0,0,0,.5);\n        appearance: none;\n        -webkit-appearance: none;\n        -moz-appearance: none;\n    }\n    div :global(input.changed){\n        color:rgba(0,0,0,.9);\n    }\n    @media not all and (min-resolution:.001dpcm) { /* Safari hack */\n        @media all{\n            input { \n                width: 60px;\n            }\n        }\n        div {\n            margin-right: 6px; /* just enough place for the outline */\n        }\n    }\n\n</style>","// shortcuts for easier to read formulas\nconst PI   = Math.PI,\n    sin  = Math.sin,\n    cos  = Math.cos,\n    tan  = Math.tan,\n    asin = Math.asin,\n    acos = Math.acos,\n    atan = Math.atan2,\n    deg = 180 / PI,\n    rad  = PI / 180;\n\n// date/time constants and conversions\nconst dayMs = 1000 * 60 * 60 * 24,\n    J1970 = 2440588,\n    J2000 = 2451545;\n\nconst toJulian = (date) => date.valueOf() / dayMs - 0.5 + J1970;\nconst toCenturies = (date) => (toJulian(date) - J2000) / 36525.0;\n\n// modulo is not always remainder\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Remainder\nconst modulo = (a, n) => ((a % n ) + n ) % n;\n\n\n\n//const azimuth = (H, phi, dec) => atan(sin(H), cos(H) * sin(phi) - tan(dec) * cos(phi));\nconst altitude = (H, phi, dec) => asin(sin(phi) * sin(dec) + cos(phi) * cos(dec) * cos(H));\n\nconst geomMeanLongSun = (t) => {\n    const L0 = 280.46646 + t * (36000.76983 + t*(0.0003032));\n    return modulo(L0, 360); // in degrees\n};\n\nconst geomMeanAnomalySun = (t) => {\n    const M = 357.52911 + t * (35999.05029 - 0.0001537 * t);\n    return M; // in degrees\n};\n\nconst eccentricityEarthOrbit = (t) => {\n    const e = 0.016708634 - t * (0.000042037 + 0.0000001267 * t);\n    return e; // unitless\n};\n\nconst sunEqOfCenter = (t) => {\n    const m = rad * geomMeanAnomalySun(t);\n    const C = sin(m) * (1.914602 - t * (0.004817 + 0.000014 * t)) + sin(2 * m) * (0.019993 - 0.000101 * t) + sin(3 * m) * 0.000289;\n    return C; // in degrees\n};\n\nconst sunTrueLong = (t) => {\n    return geomMeanLongSun(t) + sunEqOfCenter(t); // in degrees\n};\n\nconst sunApparentLong = (t) => {\n    const o = sunTrueLong(t);\n    const omega = 125.04 - 1934.136 * t;\n    const lambda = o - 0.00569 - 0.00478 * sin(rad * omega);\n    return lambda; // in degrees\n};\n\nconst meanObliquityOfEcliptic = (t) => {\n    const seconds = 21.448 - t*(46.8150 + t*(0.00059 - t*(0.001813)));\n    const e0 = 23.0 + (26.0 + (seconds/60.0))/60.0;\n    return e0; // in degrees\n};\n\nconst obliquityCorrection = (t) => {\n    const e0 = meanObliquityOfEcliptic(t);\n    const omega = 125.04 - 1934.136 * t; // in degrees\n    const e = e0 + 0.00256 * cos(rad * omega);\n    return e; // in degrees\n};\n\nconst sunDeclinationInRadians = (t) => {\n    const e = rad * obliquityCorrection(t);\n    const lambda = rad * sunApparentLong(t);\n    const sint = sin(e) * sin(lambda);\n    const theta = asin(sint);\n    return theta; // in radians\n};\nconst sunRtAscensionInRadians = (t) => {\n    var e = rad * obliquityCorrection(t);\n    var lambda = rad * sunApparentLong(t);\n    var tananum = cos(e) * sin(lambda);\n    var tanadenom = cos(lambda);\n    var alpha = atan(tananum, tanadenom);\n    return alpha; // in radians\n};\n\n//Equation of time in minutes\nconst eqTime = (t) => {\n    const e = eccentricityEarthOrbit(t);\n    const epsilon = rad * obliquityCorrection(t);\n    const l0 = rad * geomMeanLongSun(t);\n    const m = rad * geomMeanAnomalySun(t);\n    const y = Math.pow(tan(epsilon / 2), 2);\n\n    const Etime = y * sin(2.0 * l0) - 2.0 * e * sin(m) + 4.0 * e * y * sin(m) * cos(2 * l0) - 0.5 * y * y * sin(4 * l0) - 1.25 * e * e * sin(2 * m);\n    return deg * Etime * 4.0; // in minutes of time\n};\n\n\n\nexport const sunAzEl = (date, point) => {\n    const {longitude} = point;\n    const hours = date.getUTCHours();\n    const minutes = date.getUTCMinutes();\n    const seconds = date.getUTCSeconds();\n    const t = toCenturies(date);\n    const solarTimeFix = eqTime(t) + (4 * longitude);\n    const theta = sunDeclinationInRadians(t);\n    // True Solar Time\n    let tst = ((hours * 60) + minutes + (seconds / 60) + solarTimeFix) % 1440;\n    // Solar hour angle\n    let ha = (tst / 4) - 180;\n    if (ha < -180) {\n        ha += 360;\n    }\n    const phi = point.latitude * rad;\n    let csz = (sin(phi) * sin(theta)) + (cos(phi) * cos(theta) * cos(rad * ha));\n    if (csz > 1.0) {\n        csz = 1.0\n    } else if (csz < -1.0) { \n        csz = -1.0\n    }\n    const zenith = acos(csz);\n    // const azDenom = cos(phi) * sin(zenith);\n    // let azimuth;\n    // if (Math.abs(azDenom) > 0.001) {\n    //     var azRad = ((sin(phi) * cos(zenith)) - sin(theta)) / azDenom;\n    //     if (Math.abs(azRad) > 1.0) {\n    //         if (azRad < 0) {\n    //             azRad = -1.0\n    //         } else {\n    //             azRad = 1.0\n    //         }\n    //     }\n    //     azimuth = 180.0 - deg * acos(azRad);\n    //     if (ha > 0.0) {\n    //         azimuth = -azimuth;\n    //     }\n    // } else {\n    //     azimuth = (latitude > 0.0) ? 180 : 0;\n    // }\n    // if (azimuth < 0.0) {\n    //     azimuth += 360.0\n    // }\n    // we do not need to calculate refraction for our usage (see isNight)\n    return {elevation: 90 - (deg * zenith)};\n};\nconst sunStates = [ // order important\n    [   -15, 'night'], // used for aurora prediction real astronomical night starts at -18\n    [   -12, 'astronomical twilight'],\n    [    -6, 'nautical twilight'],\n    [-0.833, 'civil twilight']\n];\nexport const sunStateMap = new Map([\n    ['night', ([prevState, newState]) => (isSunRising(prevState, newState)) ? 'astronomicalDawn': 'nightStart'],\n    ['astronomical twilight', ([prevState, newState]) => (isSunRising(prevState, newState)) ? 'nauticalDawn': 'astronomicalDusk'],\n    ['nautical twilight', ([prevState, newState]) => (isSunRising(prevState, newState)) ? 'civilDawn': 'nauticalDusk'],\n    ['civil twilight', ([prevState, newState]) => (isSunRising(prevState, newState)) ? 'sunrise': 'civilDusk'],\n    ['day', ([prevState, newState]) => (isSunRising(prevState, newState)) ? 'dayStart': 'sunset']\n]);\nexport const sunRisingStates = Array.from(sunStateMap.keys());\nexport const isSunRising = (prevState, newState) => {\n    return sunRisingStates.indexOf(newState) >= sunRisingStates.indexOf(prevState);\n};\n\nexport const sunStateAndRising = (date, point, fl) => {\n    const {state, elevation} = sunState(date, point, fl);\n    //compare sun elevation beetween date and date + 10mn\n    const isRising =  elevation < sunAzEl(new Date(date.getTime() + 600000), point).elevation;\n    return {state, isRising};\n};\n\nexport const sunState = (date, point, fl=0) => {\n    const elevation = sunAzEl(date, point).elevation;\n    // -0.833 includes refraction at sea level\n    // formula includes altitude and altitude refraction\n    // https://en.wikipedia.org/wiki/Sunrise_equation\n    const correction = 1.15 * Math.sqrt(fl * 100) / 60;\n    for (const[value, state] of sunStates) {\n        if (elevation <= value - correction) {\n            return {state, elevation};\n        }\n    }\n    return {state: 'day', elevation};\n};\n\n/* Moon Equations from https://github.com/mourner/suncalc */\nconst toDays = (date) => toJulian(date) - J2000;\nconst e = rad * 23.4397; // obliquity of the Earth\nconst rightAscension = (l, b) => atan(sin(l) * cos(e) - tan(b) * sin(e), cos(l));\nconst declination = (l, b) => asin(sin(b) * cos(e) + cos(b) * sin(e) * sin(l));\nconst siderealTime = (d, lw) => rad * (280.16 + 360.9856235 * d) - lw;\nconst moonCoords = (d) => { // geocentric ecliptic coordinates of the moon\n    const L = rad * (218.316 + 13.176396 * d), // ecliptic longitude\n        M = rad * (134.963 + 13.064993 * d), // mean anomaly\n        F = rad * (93.272 + 13.229350 * d),  // mean distance\n\n        l  = L + rad * 6.289 * sin(M), // longitude\n        b  = rad * 5.128 * sin(F),     // latitude\n        dt = 385001 - 20905 * cos(M);  // distance to the moon in km\n    return {\n        ra: rightAscension(l, b),\n        dec: declination(l, b),\n        dist: dt\n    };\n};\nexport const getMoonIllumination = (date) => {\n\n    const t = toCenturies(date),\n        s = {dec: sunDeclinationInRadians(t), ra: sunRtAscensionInRadians(t)},\n        m = moonCoords(toDays(date)),\n\n        sdist = 149598000, // distance from Earth to Sun in km\n\n        phi = acos(sin(s.dec) * sin(m.dec) + cos(s.dec) * cos(m.dec) * cos(s.ra - m.ra)),\n        inc = atan(sdist * sin(phi), m.dist - sdist * cos(phi)),\n        angle = atan(cos(s.dec) * sin(s.ra - m.ra), sin(s.dec) * cos(m.dec) -\n                cos(s.dec) * sin(m.dec) * cos(s.ra - m.ra));\n\n    return {\n        fraction: (1 + cos(inc)) / 2,\n        phase: 0.5 + 0.5 * inc * (angle < 0 ? -1 : 1) / Math.PI,\n        angle: angle\n    };\n};\nexport const getMoonPosition = function (date, point) {\n\n    var lw  = -point.longitude * rad,\n        phi = point.latitude * rad,\n        d   = toDays(date),\n\n        c = moonCoords(d),\n        H = siderealTime(d, lw) - c.ra,\n        h = altitude(H, phi, c.dec),\n        // formula 14.1 of \"Astronomical Algorithms\" 2nd edition by Jean Meeus (Willmann-Bell, Richmond) 1998.\n        pa = atan(sin(H), tan(phi) * cos(c.dec) - sin(c.dec) * cos(H));\n\n    //h = h + astroRefraction(h); // altitude correction for refraction\n\n    return {\n        //azimuth: azimuth(H, phi, c.dec),\n        altitude: h,\n        //distance: c.dist,\n        parallacticAngle: pa\n    };\n};\nexport const moonState = (date, point, fl=0) => { // true => visible\n    // + altitude of moonrise is 8mn of arc (0.133*rad)\n    // - refraction correction at this altitude is 0.008116109187895005\n    // we apply the same altitude correction that the sun (really ?)\n    const correction = rad * 1.15 * Math.sqrt(fl * 100) / 60;\n    const altitude = getMoonPosition(date, point).altitude;\n    return  {state: altitude > -0.005794821282742547 - correction, elevation: deg * altitude};\n}\nexport const moonStateMap = new Map([\n    [false, () => 'moonrise'],\n    [true, () => 'moonset']\n]);\nexport const sun = {name: 'sun', getState: sunState, stateMap: sunStateMap};\nexport const moon = {name: 'moon', getState: moonState, stateMap: moonStateMap};\n","import {derived} from \"svelte/store\";\nimport {sun, moon} from \"./suncalc\";\nimport {ofp, takeOffTime} from \"../stores\";\n\nfunction* iterateSegment({prev, next, takeOffTime, flightTime, segmentLength, getState, stateMap, increment=30000 /* 30sec */}){\n    let prevState = prev.state;\n    const min2ms = 60000;\n    const lowerLimit = prev.sum * min2ms;\n    const upperLimit = next.sum * min2ms; \n    for(let m = lowerLimit + increment; m <= upperLimit; m= m + increment){\n        let fl = prev.fl;\n        if (m >= upperLimit) fl = next.fl;\n        const date = new Date(takeOffTime + m);\n        let pos;\n        const segmentTime = upperLimit - lowerLimit;\n        if (segmentTime === 0) {\n            pos = next.p;\n        }else{\n            const fraction = (m - lowerLimit) / segmentTime;\n            pos = prev.p.atFraction(next.p, fraction, segmentLength);\n        }\n        const {state} = getState(date, pos, fl);\n        if (state !== prevState) {\n            const relpos = Math.round(1000 * m / flightTime) / 10;\n            const type =  stateMap.get(prevState)([prevState, state]);\n            yield({position: pos, type, date, fl, relpos});\n            if (state === next.state) break;\n        }\n        prevState = state;\n    }\n}\nconst getSolarDefault = () => {\n    return {[moon.name]: [], [sun.name]: [], 'route': []};\n};\n\nexport const solar = derived(\n    [ofp, takeOffTime],\n    ([$ofp, $takeOffTime]) => {\n        if (!$takeOffTime || !$ofp || $ofp.timeMatrix.length === 0) return getSolarDefault();\n        const takeOffTime = $takeOffTime.getTime();\n        const results = getSolarDefault();\n        const timeMatrix = $ofp.timeMatrix;\n        const distanceMatrix = $ofp.distanceMatrix;\n        let last = timeMatrix.length - 1;\n        const flightTime = timeMatrix[last][1] * 60000;\n        const routeMatrix = [];\n        for (const object of [sun, moon]) {\n            const matrix = [];\n            let prev = null;\n            for (const [i, [p, sum, level]] of timeMatrix.entries()) {\n                let fl = level;\n                if (i === 0 || i === last) fl = 0;\n                const date = new Date(takeOffTime + sum * 60000);\n                const state = object.getState(date, p, fl).state;\n                const next = {p, sum, fl, state};\n                if (prev && state !== prev.state) {\n                    const segmentLength = distanceMatrix[i][1] - distanceMatrix[i-1][1];\n                    const params = {\n                        prev, \n                        next, \n                        takeOffTime,\n                        flightTime,\n                        segmentLength, \n                        getState: object.getState, \n                        stateMap: object.stateMap, \n                        increment: (object.name === 'sun') ? 30000 : 60000\n                    };\n                    for (const data of iterateSegment(params)) {\n                        matrix.push(data);\n                        if (object === sun) {\n                            routeMatrix.push(data);\n                        }\n                    }\n                }\n                prev = next;\n                if (object === sun) {\n                    routeMatrix.push({position: p, type: state, date, relpos: Math.round(1000 * sum * 60000 / flightTime) / 10});\n                }\n            }\n            results[object.name] = matrix;\n        }\n        results['route'] = routeMatrix;\n        return results;\n    },\n    getSolarDefault() // initial value\n);\n","<script context=\"module\">\n    import {derived, writable} from \"svelte/store\";\n    import {landingTime, takeOffTime} from \"../stores\";\n    import {solar} from \"./solarstore\";\n    import { binarysearch } from \"./utils\";\n\n    //adjust to the time to be for today\n    const devTimeDelta = (tsref) => (Math.trunc(Date.now()/86400000) - Math.trunc(tsref/86400000)) * 86400000;\n    export const kpColor = (kp) => {\n        switch(kp){\n            case 0:\n            case 1:\n            case 2:\n                return '#69B34C';\n            case 3:\n                return '#ACB334';\n            case 4:\n                return '#FAB733'\n            case 5:\n                return '#FF8E15';\n            case 6:\n                return '#FF4E11';\n            case 7:\n            case 8:\n            case 9:\n                return '#FF0D0D';\n            default:\n                return 'lightgray';\n        }\n    };\n    export const noaaKp = writable();\n    const fetchNoaaKpAndSet = async () => {\n        return fetch('CONF_NOAA_KP_JSON')\n        .then(response => response.json())\n        .then(data => {\n            try {\n                const timetable = [];\n                for (let i=data.length - 1; i>=1; i--){\n                    const [d, k] = data[i];\n                    const t = Date.parse(d.replace(' ', 'T') + 'Z'); // Safari needs the T\n                    timetable.push([t, parseFloat(k)])\n                }\n                noaaKp.set(timetable);\n            } catch (error) {\n                console.error('kp store update error', error);\n            }\n        })\n        .catch(function(error) {\n            console.log('Could not update Kp store', error);\n        });\n    };\n    export const Kp = derived([landingTime, takeOffTime, noaaKp], ([$landingTime, $takeOffTime, $noaaKp]) => {\n        if (!$landingTime || !$takeOffTime || !$noaaKp) return undefined;\n        let res = [];\n        const tots = $takeOffTime.getTime();\n        const flightTime = $landingTime - $takeOffTime;\n        let timeDelta = 0;\n        if ('process.env.NODE_ENV' === '\"development\"') {\n            timeDelta = devTimeDelta($takeOffTime);\n        }\n        //$noaaKp timetable in reverse order so end -> takeOff, start -> landing\n        const startTs = $landingTime.getTime() + timeDelta;\n        const start = binarysearch($noaaKp, a => a[0] <= startTs)\n        const endTs = tots + timeDelta;\n        const end = binarysearch($noaaKp, a => a[0] <= endTs)\n        if (end >= 0 && start >= 0) {\n            res = $noaaKp.slice(start, end + 1);\n        }\n        const timetable = res.map(a => ({\n            date: new Date(a[0] - timeDelta),\n            kp: a[1],\n            relpos: Math.round(10000 * (a[0] - timeDelta - tots) / flightTime) / 100 //relpos might be < 0 or > 100\n        }));\n        const fn = (date) => {\n            if (date) { // a linear search is fine here (0-5 entries)\n                for (let i=0; i<timetable.length; i++){\n                    if (date >= timetable[i].date) {\n                        return timetable[i].kp;\n                    }\n                }\n            }\n            return -1;\n        }\n        return {\n            timetable,\n            get: fn\n        };\n    });\n\n    export const aurora = derived(\n        [solar, Kp],\n        ([$solar, $Kp]) => {\n            if ($solar.route.length === 0 || !$Kp) return [];\n            const segments = [];\n            let points = [];\n            for (const {position, date, type, relpos} of $solar.route) {\n                const predictedKp = $Kp.get(date);\n                if (['night', 'astronomicalDusk', 'astronomicalDawn'].includes(type) && Math.round(minKpAtPoint(position)) <= predictedKp){ //TODO Math.floor/ceil/round ?\n                    points.push({position, date, relpos, predictedKp});\n                }else if (points.length > 0) {\n                    segments.push(points);\n                    points = [];\n                }\n            }\n            if (points.length > 0) segments.push(points);\n            const periods = [];\n            const rounding = 1000 * 60 * 5; // all times rounded to 5min\n            for (const points of segments) {\n                const last = points.length - 1;\n                const start = points[0].date.getTime();\n                const end = points[last].date.getTime();\n                const offset = (points.length === 1) ? 300000 : 0; //5mn or 0\n                const roundedStart = Math.floor((start - offset) / rounding) * rounding;\n                const roundedEnd = Math.ceil((end + offset) / rounding) * rounding;\n                const relpos1 = (roundedStart / start) * points[0].relpos;\n                const relpos2 = (roundedEnd / end) * points[last].relpos;\n\n                periods.push({\n                    period: [new Date(roundedStart), new Date(roundedEnd)],\n                    relpos: [relpos1, relpos2],\n                    //points: [points[0].position, points[last].position]\n                });\n            }\n            return periods;\n        }\n    );\n\n    // export const getGeoMagneticPole = (date) => {\n    //     let year = date.getUTCFullYear();\n    //     if (year < 2016) year = 2016;\n    //     if (year > 2025) year = 2025;\n    //     // from http://wdc.kugi.kyoto-u.ac.jp/poles/polesexp.html\n    //     const poleLatLngByYear = {\n    //         '2016': [80.4, -72.6],\n    //         '2017': [80.5, -72.6],\n    //         '2018': [80.5, -72.7],\n    //         '2019': [80.6, -72.7],\n    //         '2020': [80.7, -72.7],\n    //         '2021': [80.7, -72.7],\n    //         '2022': [80.7, -72.7],\n    //         '2023': [80.8, -72.7],\n    //         '2024': [80.8, -72.6],\n    //         '2025': [80.9, -72.6]\n    //     };\n    //     return poleLatLngByYear[year.toString()];\n    // }\n    export const geoMagneticPoleLatLng = [80.7, -72.7]; // sufficent precision for us\n    export const minKpAtPoint = (p) => {\n        if (p.latitude <= 40) return [-90, 99]; // no need to compute\n        const mlat = 90 - p.distanceTo(new editolido.GeoPoint(geoMagneticPoleLatLng), editolido.rad_to_deg);\n        return (mlat > 66.5) ? 0 : (66.5 - mlat) / 2; // https://www.swpc.noaa.gov/content/tips-viewing-aurora\n    };\n</script>\n<script>\n    import {onMount} from \"svelte\";\n    import {ofp} from \"../stores\";\n\n    const predictedKpUpdated = async (event) => {\n        if (event.data.meta === 'workbox-broadcast-update' && event.data.type === 'CACHE_UPDATED') {\n            const {updatedURL} = event.data.payload;\n            if (updatedURL === 'CONF_NOAA_KP_JSON') {\n                //console.log('loading noaa kp store (sw cache updated)');\n                fetchNoaaKpAndSet();\n            }\n        }\n    };\n\n    onMount(() => {\n        if (navigator && navigator.serviceWorker){\n            navigator.serviceWorker.addEventListener('message', predictedKpUpdated);\n        }\n        const isInCache = async () => {\n            let inCache = false;\n            if (window.caches) {\n                const keys = await window.caches.open('lido-noaa').then(cache => cache.keys());\n                for (const req of keys) {\n                    if (req.url === 'CONF_NOAA_KP_JSON') {\n                        inCache = true;\n                        break;\n                    }\n                }\n            }\n            return inCache;\n        }\n\n        const unsubscribe = ofp.subscribe(async () => {\n            const inCache = await isInCache();\n            if (inCache && $Kp !== undefined) { // if offline we still need to load the predictions if not loaded yet\n                //console.log('ping noaa (ofp change)'); //predictedKpUpdate will do the real load if needed\n                fetch('CONF_NOAA_KP_JSON').catch(() => {return;});\n            }else{\n                //console.log('loading noaa kp store (ofp change)');\n                fetchNoaaKpAndSet();\n            }\n        });\n        return () => {\n            unsubscribe();\n            if (navigator && navigator.serviceWorker){\n                navigator.serviceWorker.removeEventListener('message', predictedKpUpdated);\n            }\n        }\n    });\n</script>\n","<script context=\"module\">\n    export const format = (date, withSeconds=false) => {\n        if (!date) return (withSeconds) ? '--:--:--' : '--:--';\n        if (withSeconds) {\n            return date.toJSON().slice(11, 19);\n        } else if (date.getUTCSeconds(date) < 30) {\n            return date.toJSON().slice(11, 16);\n        }\n        return (new Date(date.getTime() + 60000)).toJSON().slice(11, 16);\n    };\n    //xpos computes svg x coordinnate using relative position, if a fixed width is given, returns abolute position, else percent\n    export const timelineSize = 0.9;\n    export const xpos = (rel, fixed) => (fixed) ? `${fixed * (5 + (timelineSize * rel)) / 100}` : `${5 + (timelineSize * rel)}%`;\n    export const civilIcon = \"✽\";\n    export const eventColor = (stateOrEvent) => {\n        switch(stateOrEvent){\n            case 'dayStart'://↑\n            case 'day':\n            case 'sunrise': //↑\n                return '#89d4ff';\n            case 'sunset': //↓\n            case 'civil twilight':\n            case 'civilDawn': //↑\n                return '#2383C2'\n            case 'civilDusk': //↓ \n            case 'nautical twilight':\n            case 'nauticalDawn': //↑\n                return '#0052A2';\n            case 'nauticalDusk': //↓\n            case 'astronomical twilight':\n            case 'astronomicalDawn': //↑\n                //return '#02386E';\n            case 'astronomicalDusk': //↓\n            case 'night':\n            case 'nighStart': //↓\n                return '#000B18';\n            default:\n                if (stateOrEvent) console.error(`#ERREUR ${stateOrEvent}#`);\n                return 'red';\n        };\n    };\n</script>\n<script>\n    import {aurora, Kp} from \"./KpUpdater.svelte\";\n    import {flightProgress, landingTime, takeOffTime} from \"../stores\";\n    import {solar} from \"./solarstore\";\n    import {getMoonIllumination, getMoonPosition} from \"./suncalc.js\";\n\n\n    //Safari does not accept transform-origin in inline svg style\n    //SVG do not allow transform origin using % unit\n    //alternative => bind clientWidth  of the div wrapping the svg\n    let svgClientWidth = 364;\n    // const moonIconStyle =  (date, point) => { //not yet supported in safari\n    //     const mi = getMoonIllumination(date);\n    //     const iconOrientationCorrection = 132 * Math.PI / 180;\n    //     const oa = mi.angle - getMoonPosition(date, point).parallacticAngle; // observer angle\n    //     return `transform: rotate(${ -oa + iconOrientationCorrection}rad);`;\n    // }\n    const moonIconTransform =  (date, point, x0, y0) => {\n        const mi = getMoonIllumination(date);\n        const iconOrientationCorrection = 132;\n        const oa = mi.angle - getMoonPosition(date, point).parallacticAngle; // observer angle\n        return `rotate(${ (-oa * 180 / Math.PI) + iconOrientationCorrection}, ${x0}, ${y0})`;\n    }\n    export let departureSun;\n    export let arrivalSun;\n</script>\n<div>\n    {#if !$Kp}\n        <p>Les prédictions de Kp sont indisponibles.</p>\n    {/if}\n    <div bind:clientWidth={svgClientWidth}><svg width=\"100%\" height=\"60px\" xmlns=\"http://www.w3.org/2000/svg\">\n        <!-- <defs>\n            <linearGradient id=\"SunTimeLine\">\n                <stop offset=\"0%\"  stop-color=\"{eventColor(departureSun.state)}\"/>\n                {#each $solar.sun as {type, relpos}}\n                    <stop offset=\"{relpos}%\"  stop-color=\"{eventColor(type)}\"/>\n                {/each}\n                <stop offset=\"100%\"  stop-color=\"{eventColor(arrivalSun.state)}\"/>\n            </linearGradient>\n        </defs> -->\n        <rect\n            x=\"{xpos(0)}\"\n            width=\"{timelineSize * 100}%\"\n            fill=\"{eventColor(arrivalSun.state)}\"\n            y=\"20\" height=\"10px\"/>\n        {#each $solar.sun as event, i}\n            {#if ['sunrise', 'sunset', 'civilDawn', 'civilDusk', 'nauticalDawn', 'nauticalDusk'].includes(event.type)}\n                <line stroke=\"gray\" stroke-width=\"1\"\n                    x1=\"{xpos(event.relpos)}\"\n                    y1=\"30\"\n                    x2=\"{xpos(event.relpos)}\"\n                    y2=\"32\" />\n                {#if (event.type === 'civilDawn' || event.type === 'civilDusk')}\n                    <text fill=\"{(event.type === 'civilDawn') ? '#FCBF49' : '#000B18'}\" text-anchor=\"middle\"\n                        x=\"{xpos(event.relpos)}\"\n                        y=\"44\">{civilIcon}</text>\n                {/if}\n            {/if}\n            {#if (i === 0)}\n                <rect \n                    x=\"{xpos(0)}\"\n                    width=\"{timelineSize * (event.relpos)}%\"\n                    fill=\"{eventColor(departureSun.state)}\"\n                    y=\"20\" height=\"10px\"/>\n            {:else}\n                <rect \n                    x=\"{xpos($solar.sun[i-1].relpos)}\" \n                    width=\"{timelineSize * (event.relpos - $solar.sun[i-1].relpos)}%\"\n                    fill=\"{eventColor($solar.sun[i-1].type)}\"\n                    y=\"20\" height=\"10px\"/>\n            {/if}\n        {/each}\n        {#each $solar.moon as {type, relpos, date, position}}\n            <line stroke=\"gray\" stroke-width=\"1\"\n                x1=\"{xpos(relpos)}\"\n                y1=\"18\"\n                x2=\"{xpos(relpos)}\"\n                y2=\"20\" />\n            <text fill=\"{(type==='moonrise') ? '#FCBF49' : 'gray'}\" text-anchor=\"middle\" \n                x=\"{xpos(relpos)}\"\n                y=\"16\"\n                transform=\"{moonIconTransform(date, position, xpos(relpos, svgClientWidth), 9)}\"\n                >☾</text>\n        {/each}\n        {#each $aurora as {period, relpos}}\n            <rect stroke=\"lime\" stroke-opacity=\"60%\" fill=\"transparent\" stroke-width=\"2\"\n                x=\"{xpos(relpos[0])}\"\n                y=\"18\"\n                width=\"{timelineSize * (relpos[1] - relpos[0])}%\"\n                height=\"14\"/>\n            <text fill=\"green\"text-anchor=\"middle\" font-size=\"0.7em\"\n                x=\"{xpos(relpos[0] + (relpos[1] - relpos[0]) / 2)}\"\n                y=\"15\">{format(period[0])}</text>\n            <text fill=\"green\"text-anchor=\"middle\" font-size=\"0.7em\"\n                x=\"{xpos(relpos[0] + (relpos[1] - relpos[0]) / 2)}\"\n                y=\"42\">{format(period[1])}</text>\n        {/each}\n        <circle fill=\"#FCBF49\" stroke=\"black\" stroke-width=\"0.5\"\n            cx=\"{ xpos($flightProgress)}\" \n            cy=\"25\" r=\"2.5\" />\n        <text fill=\"black\"text-anchor=\"middle\"\n            x=\"5%\"\n            y=\"56\">{format($takeOffTime)}</text>\n        <text fill=\"black\" text-anchor=\"middle\"\n            x=\"95%\" \n            y=\"56\">{format($landingTime)}</text>\n    </svg></div>\n    {#if $aurora.length > 0}\n        <div class=\"aurora-legend\"><span>zone favorable aux aurores boréales</span></div>\n    {/if}\n</div>\n<style>\n    .aurora-legend {\n        margin: 0 auto;\n        width: 75%;\n        margin-top: -0.9em;\n        font-size: 0.7rem;\n        color: gray;\n        text-align: center;\n    }\n    .aurora-legend span{\n        border-bottom: 2px solid #00FF007F;\n    }\n</style>","<script>\n    import {Kp, kpColor ,aurora} from \"./KpUpdater.svelte\";\n    import {format, xpos, timelineSize} from \"./SunTimeLine.svelte\";\n    import {landingTime, takeOffTime, flightProgress} from \"../stores\";\n\n    const minmax = (v) => Math.min(100, Math.max(0, v));\n    $: flightKp = ($Kp) ? $Kp.timetable : [];\n\n</script>\n<div>\n    {#if (flightKp.length > 0)}\n        <svg width=\"100%\" height=\"53px\" xmlns=\"http://www.w3.org/2000/svg\">\n            {#each flightKp as {date, kp, relpos}, i}\n                <rect fill=\"{kpColor(kp)}\"\n                    x=\"{xpos(minmax(relpos))}\"\n                    y=\"7\"\n                    width=\"{timelineSize * (minmax((i===0) ? 100 : flightKp[i - 1].relpos - 0.2) - minmax(relpos))}%\"\n                    height=\"14px\"/>\n\n                <text fill=\"white\" stroke=\"white\" text-anchor=\"middle\" font-size=\"0.7em\"\n                    x=\"{xpos((minmax(relpos) + minmax((i===0) ? 100 : flightKp[i - 1].relpos)) / 2)}\"\n                    y=\"17\">{kp}</text>\n                {#if relpos > 5 && relpos < 95}\n                    <text fill=\"gray\"text-anchor=\"middle\" font-size=\"0.7em\"\n                        x=\"{xpos(relpos)}\"\n                        y=\"31\">{format(date)}</text>\n                {/if}\n            {/each}\n            <circle fill=\"#FCBF49\" stroke=\"black\" stroke-width=\"0.5\"\n                cx=\"{xpos($flightProgress)}\" \n                cy=\"20\" r=\"2.5\" />\n            <text fill=\"black\"text-anchor=\"middle\"\n                x=\"5%\"\n                y=\"49\">{format($takeOffTime)}</text>\n            <text fill=\"black\" text-anchor=\"middle\"\n                x=\"95%\" \n                y=\"49\">{format($landingTime)}</text>\n            {#if $aurora.length === 0 && !!$Kp}\n                <text fill=\"gray\" text-anchor=\"middle\" font-size=\"0.8em\"\n                    x=\"50%\" \n                    y=\"49\">aucune aurore boréale prévue sur la route</text>\n            {/if}\n        </svg>\n    {:else if !$Kp}\n        <p>Les prévisions de Kp sont indisponibles.</p>\n    {:else}\n        <p>Les prévisions sont disponibles de J-7 à J+2</p>\n    {/if}\n</div>\n<style>\n    p{\n        margin-left: 0.75rem;\n    }\n</style>","<script context=\"module\">\n    export const getMoonIlluminationPercent = (moonIllumination) => Math.round(moonIllumination.fraction * 100);\n    export const getMoonEmoji = (moonIllumination) => {\n        //https://fr.wikipedia.org/wiki/Phase_de_la_Lune\n        const phase = moonIllumination.phase;\n        const fraction = moonIllumination.fraction;\n        if (!phase || !fraction) return \"☽\";\n        if(fraction <= 0.02) {\n            return '🌑';\n        }else if (phase < 0.5 && fraction <= 0.34){\n            return '🌒';\n        }else if (phase < 0.5 && fraction <= 0.65){\n            return '🌓';\n        }else if (phase < 0.5 && fraction < 0.97){\n            return '🌔';\n        }else if (fraction >= 0.97){\n            return '🌕';\n        }else if (phase >= 0.5 && fraction > 0.65){\n            return '🌖';\n        }else if (phase >= 0.5 && fraction > 0.34){\n            return '🌗';\n        }else{\n            return '🌘';\n        }\n    };\n    export const getMoonName = (moonIllumination) => {\n        //https://en.wikipedia.org/wiki/Lunar_phase\n        //rounded to the nearest % integer\n        const phase = moonIllumination.phase;\n        const fraction = getMoonIlluminationPercent(moonIllumination);\n        if(fraction <= 0) {\n            return 'Nouvelle lune';\n        }else if (phase < 0.5 && fraction < 50) {\n            return 'Premier croissant';\n        }else if (phase < 0.5 && fraction === 50) {\n            return 'Premier quartier';\n        }else if ((phase < 0.5 && fraction < 100)){\n            return 'Gibbeuse croissante';\n        }else if (fraction === 100){\n            return 'Pleine Lune';\n        }else if (phase >= 0.5 && fraction > 50){\n            return 'Gibbeuse décroissante';\n        }else if (phase >= 0.5 && fraction === 50){\n            return 'Dernier quartier';\n        }else{\n            return 'Dernier croissant';\n        }\n    };\n</script>\n<script>\n    import {getMoonIllumination, getMoonPosition} from './suncalc';\n\n    export let date;\n    export let position;\n    export let type = null;\n\n    $: moonEmojiStyle = () => {\n        if (!date || !position) return 0;\n        const mi = getMoonIllumination(date);\n        const emojiOrientationCorrection = (mi.phase >= 0.5) ? Math.PI/2 : -Math.PI/2;\n        const oa = mi.angle - getMoonPosition(date, position).parallacticAngle;\n        return `transform: rotate(${ -oa + emojiOrientationCorrection}rad);`\n    };\n</script>\n<div class=\"moon\" class:rise={type==='moonrise'} style=\"{moonEmojiStyle()}\"><slot></slot></div>\n\n<style>\n    .moon {\n        display: inline-block;\n        transform-origin: center;\n    }\n    .rise {\n        color: #FCBF49;\n    }\n</style>\n","<script>\n    import {kpColor} from \"./KpUpdater.svelte\";\n    import SunTimeLine, {format, civilIcon, eventColor} from \"./SunTimeLine.svelte\";\n    import KpTimeLine from \"./KpTimeLine.svelte\";\n    import Moon, {getMoonName, getMoonIlluminationPercent} from \"./Moon.svelte\";\n    import {moonState, sunStateAndRising, sunRisingStates} from \"./suncalc\";\n    import {ofp, landingTime, position} from \"../stores\";\n    import {solar} from \"./solarstore\";\n\n    export let departureSun;\n    export let moonEmoji;\n    export let moonIllumination;\n    export let estimatedDate;\n\n    $: arrivalSun = ($ofp && $landingTime) ? sunStateAndRising($landingTime, $ofp.arrival, 0) : '';\n    $: isMoonVisible = ($position && estimatedDate) ? moonState(estimatedDate, $position.map, $position.fl).state : '';\n\n\n    const stateAsText = (point, date, {state, isRising}) => {\n        if (!point || !date) return '';\n        if (state === 'day') {\n            return  'de jour';\n        } else if (state === 'night' || state === 'astronomical twilight') {\n            return 'de nuit';\n        } else if (state === 'nautical twilight') {\n            return (isRising) ? \"durant l'aube nautique\" : \"durant le crépuscule nautique\";\n        }else if (state === 'civil twilight') {\n            return (isRising) ? \"durant l'aube civile\" : \"durant le crépuscule civil\";\n        }\n        return `#ERREUR ${state}#`;\n    };\n\n    const nightEventsFR = {\n        'astronomicalDawn': 'Aube astronomique',\n        'astronomicalDusk': 'Nuit astronomique',\n        'nauticalDawn': 'Aube nautique',\n        'nauticalDusk': 'Nuit nautique',\n        'civilDawn': 'Aube civile',\n        'civilDusk': 'Nuit civile',\n        'sunrise': 'Lever du soleil',\n        'sunset': 'Coucher du soleil',\n        'day': 'Jour',\n        'night': 'Nuit',\n        'moonrise': 'Lever de lune',\n        'moonset': 'Coucher de lune'\n    };\n    const _ = (t) =>  nightEventsFR[t] || t;\n    const states = sunRisingStates.slice(1); // night and astronomical twilight are the same color now\n</script>   \n<div class=\"card-body\">\n    <SunTimeLine {arrivalSun} {departureSun}/>\n    <table class=\"table\">\n        <thead>\n            <tr>\n                <th scope=\"col\">Soleil</th>\n                <th scope=\"col\" class=\"color\">\n                    <svg width=\"100%\" height=\"27px\" xmlns=\"http://www.w3.org/2000/svg\">\n                        {#each states as event, i}\n                        <rect fill=\"{eventColor(event)}\"\n                            y=\"{0 + i * 6}\"\n                            x=\"0\"\n                            width=\"45%\"\n                            height=\"5\"/>\n                        <rect fill=\"{eventColor(states[states.length -1 -i])}\"\n                            y=\"{0 + i * 6}\"\n                            x=\"55%\"\n                            width=\"45%\"\n                            height=\"5\"/>\n                        {/each}\n                    </svg>\n                </th>\n                <th scope=\"col\">Heure</th>\n                <th scope=\"col\">FL</th>\n            </tr>\n        </thead>\n        <tbody>\n            {#each $solar.sun.filter(e => ['sunrise', 'sunset', 'civilDawn', 'civilDusk', 'nauticalDawn', 'nauticalDusk'].includes(e.type)) as event, i}\n            <tr>\n                {#if event.fl !== 0}\n                    <td>{_(event.type)}\n                        {#if event.type.startsWith('civil')}\n                            <span class:rise={event.type==='civilDawn'}>{civilIcon}</span>\n                        {/if}\n                    </td>\n                    <td class=\"color {event.type}-color\"></td>\n                    <td>{format(event.date)}</td>\n                    <td>FL{event.fl}</td>\n                {:else if i===0}\n                    <td colspan=\"4\">{_(event.type)} en montée\n                        {#if event.type.startsWith('civil')}\n                            <span class:rise={event.type==='civilDawn'}>{civilIcon}</span>\n                        {/if}\n                    </td>\n                {:else}\n                    <td colspan=\"4\">Atterrissage {stateAsText($ofp.arrival, $landingTime, arrivalSun)}</td>\n                {/if}\n            </tr>\n            {:else}\n                <tr><td colspan=\"4\">Aucun événement</td></tr>\n            {/each}\n        </tbody>\n        <thead>\n            <tr>\n                <th scope=\"col\" colspan=\"4\">\n                    Lune <Moon date={estimatedDate} position={$position.map}>{moonEmoji}</Moon> {getMoonName(moonIllumination)} {getMoonIlluminationPercent(moonIllumination)}% {(isMoonVisible) ? '' : 'non visible'}\n                </th>\n            </tr>\n        </thead>\n        <tbody>\n            {#each $solar.moon as event, i}\n            <tr>\n                {#if event.fl !== 0}\n                    <td>{_(event.type)} <Moon position={event.position} type={event.type} date={event.date}>{moonEmoji}</Moon></td>\n                    <td class=\"color\"></td>\n                    <td>{format(event.date)}</td>\n                    <td>FL{event.fl}</td>\n                {:else}\n                    <td colspan=\"4\">{_(event.type)} en {(i === 0) ? 'montée' : 'descente'} <Moon position={event.position} type={event.type} date={event.date}>{moonEmoji}</Moon></td>\n                {/if}\n            </tr>\n            {:else}\n                <tr><td colspan=\"4\">Aucun événement</td></tr>\n            {/each}\n        </tbody>\n        <thead>\n            <tr>\n                <th scope=\"col\" colspan=\"4\" class=\"kp\">Prévisions de Kp\n                    <svg width=\"150px\" height=\"13px\" xmlns=\"http://www.w3.org/2000/svg\">\n                        {#each [0, 1, 2 ,3, 4, 5, 6, 7, 8, 9] as data}\n                        <rect stroke=\"{kpColor(data)}\" stroke-width=\"1\" fill=\"transparent\"\n                            x=\"{2 + data * 15}\"\n                            y=\"2\"\n                            width=\"12\"\n                            height=\"12\"/>\n                            <text fill=\"gray\"text-anchor=\"middle\" font-size=\"0.7em\"\n                                x=\"{8 + data * 15}\"\n                                y=\"11.5\">{data}</text>\n                    {/each}\n                    </svg>\n                </th>\n            </tr>\n        </thead>\n    </table>\n    <KpTimeLine/>\n</div>\n<style>\n    .table>:not(:last-child)>:last-child>* {\n        border-bottom-color: var(--light-grey);\n        border-bottom-width: 2px;\n    }\n    .table>tbody>:last-child>* {\n        border-bottom-color: transparent !important;\n        border-bottom-width: 0px !important;\n    }\n    .table th {\n        border-top: none;\n        text-align: left;\n    }\n    .table .color {\n        width: 0.75rem;\n        padding: 0;\n    }\n    .table :global(.sunrise-color) {\n        background: linear-gradient(#2383C2 0% 50%, lightskyblue 50% 100%);\n        border-top-color: #2383C2;\n        border-bottom-color: lightskyblue;\n    }\n    .table :global(.civilDawn-color) {\n        background: linear-gradient( #0052A2 0% 50%, #2383C2 50% 100%);\n        border-top-color: #0052A2;\n        border-bottom-color: #2383C2;\n    }\n    .table :global(.nauticalDawn-color) {\n        background: linear-gradient(/*#02386E*/#000B18 0% 50%, #0052A2 50% 100%);\n        border-top-color: /*#02386E*/#000B18;\n        border-bottom-color: #0052A2;\n    }\n    /* .table :global(.astronomicalDawn-color) {\n        background: linear-gradient(#000B18 0% 50%, #02386E 50% 100%);\n        border-top-color: #000B18;\n        border-bottom-color: #02386E;\n    }\n    .table :global(.astronomicalDusk-color) {\n        background: linear-gradient(#02386E 0% 50%, #000B18 50% 100%);\n        border-top-color: #02386E;\n        border-bottom-color: #000B18;\n    } */\n    .table :global(.nauticalDusk-color) {\n        background: linear-gradient(#0052A2 0% 50%, /*#02386E*/#000B18 50% 100%);\n        border-top-color: #0052A2;\n        border-bottom-color: /*#02386E*/#000B18;\n    }\n    .table :global(.civilDusk-color) {\n        background: linear-gradient(#2383C2 0% 50%, #0052A2 50% 100%);\n        border-top-color: #2383C2;\n        border-bottom-color: #0052A2;\n    }\n    .table :global(.sunset-color) {\n        background: linear-gradient(lightskyblue 0% 50%, #2383C2 50% 100%);\n        border-top-color: lightskyblue;\n        border-bottom-color: #2383C2;\n    }\n    .pin {\n        display: inline-block;\n        width: 10px;\n        height: 10px;\n        border-radius: 5px;\n        background-color: #000B18;\n    }\n    .pin-day {\n        background-color: #FCBF49;\n    }\n    .moon {\n        display: inline-block;\n        transform-origin: center;\n    }\n    .rise {\n        color: #FCBF49;\n    }\n    th[scope=col]{\n        padding-bottom: 5px;\n    }\n    th.kp {\n        position: relative;\n    }\n    th.kp svg{\n        right: 5%;\n        position: absolute;\n        bottom: 0;\n    }\n</style>","<script>\n    import {slide} from \"svelte/transition\";\n    import Overlay from \"svelte-overlay\";\n    import KpUpdater, {aurora} from \"./KpUpdater.svelte\";\n    import {format} from \"./SunTimeLine.svelte\";\n    import SunPopOver from \"./SunPopOver.svelte\";\n    import Moon, {getMoonEmoji} from \"./Moon.svelte\";\n    import {sun, moon, getMoonIllumination} from \"./suncalc\";\n    import {ofp, takeOffTime, position} from \"../stores\";\n    import {solar} from \"./solarstore\";\n    import { focusMap } from \"./utils\";\n\n    \n    const getWidgetEmojiWhenNoSunEvent = (departureSun, isMoonVisibleDuringFlight) => {\n        if (departureSun.state === 'day') return '☀️';\n        if (isMoonVisibleDuringFlight) return 'moon';\n        return '🔭';\n    };\n\n    $: departureSun = ($ofp && $takeOffTime) ? sun.getState($takeOffTime, $ofp.departure, 0) : '';\n    $: departureMoon = ($ofp && $takeOffTime) ? moon.getState($takeOffTime, $ofp.departure, 0) : '';\n    $: estimatedDate = ($takeOffTime && $position) ? new Date($takeOffTime.getTime() + $position.reltime * 60000) : $takeOffTime  || $ofp.infos.ofpOFF;\n    $: sunEvents = $solar.sun.filter(e => ['sunrise', 'sunset'].includes(e.type));\n    $: isMoonVisibleDuringFlight = $solar.moon.length > 0 || departureMoon.state;\n    $: widgetEmoji = (sunEvents.length > 0) ? '☀️': getWidgetEmojiWhenNoSunEvent(departureSun, isMoonVisibleDuringFlight); //after isMoonVisibleDuringFlight\n    $: widgetEvents = (widgetEmoji === '☀️') ? sunEvents : (widgetEmoji === 'moon') ? $solar.moon : [];\n    $: moonIllumination = (estimatedDate) ? getMoonIllumination(estimatedDate) : {};\n    $: moonEmoji = getMoonEmoji(moonIllumination);\n\n</script>\n<KpUpdater/>\n{#if $ofp && $ofp.timeMatrix.length > 0}\n    <Overlay  position=\"bottom-center\" isOpen={false} on:close={focusMap}>\n        <div slot=\"parent\" class=\"sun\" class:aurora={$aurora.length > 0} let:toggle on:click={toggle}>\n            <p class=\"icon\">\n                {#if (widgetEmoji === 'moon')}\n                    <Moon position=\"{$position.map}\" date={estimatedDate}>{moonEmoji}</Moon>\n                {:else}\n                    {widgetEmoji}\n                {/if}\n            </p>\n            <div class=\"details\" class:two=\"{widgetEvents.length === 2}\" class:three=\"{widgetEvents.length>= 3}\">\n                {#each widgetEvents.slice(0, 3) as event}\n                    <p>{(event.type.includes('rise')) ? '↥' : '↧'} {format(event.date)}</p>\n                {/each}\n            </div>\n        </div>\n        <div slot=\"content\" style=\"width: 390px;\" class=\"overlay card\" let:close in:slide={{ duration: 200 }}>\n            <h6 class=\"card-header\">\n                <span>Éphémérides du vol</span>\n                <button type=\"button\" class=\"btn-close ms-auto\" aria-label=\"Close\" on:click={close}></button></h6>\n            <SunPopOver {departureSun} {moonEmoji} {estimatedDate} {moonIllumination}/>\n        </div>\n    </Overlay>\n{/if}\n<style>\n    .sun {\n        cursor: pointer;\n        display: none;\n        position: relative;\n    }\n    @media (min-width: 320px){\n        .sun {\n            display: flex;\n        }\n    }\n    .details{\n        flex-direction: column;\n        display: none;\n    }\n    @media (min-width: 1024px){\n        .details {\n            display: flex;\n        }\n    }\n    .sun p {\n        margin: 0;\n    }\n    .sun.aurora::before, :global(.markdown .aurora::before){\n        content: \"\";\n        position: absolute;\n        background-image: url(../images/65x70_northern-lights.webp);\n        background-size: cover;\n        background-repeat: no-repeat;\n        background-position: center;\n        filter: blur(3px) opacity(40%);\n        z-index: -1;\n    }\n    .sun.aurora::before{\n        top: -8px;\n        left: -15px;\n        width: 50px;\n        height: 38px;\n    }\n    .two p {\n        font-size: small;\n    }\n    .three p {\n        font-size: xx-small;\n    }\n    .icon{\n        align-self: center;\n    }\n\n    :global(.overlay .content.bottom-bottom) { /*fix overlay misplacement*/\n        left: 50%;\n        transform: translateX(-50%);\n        top: 100%;\n    }\n\n</style>","<script>\n    import {online} from '../stores.js';\n    export let src;\n    export let title;\n    export let forcePreview = true;\n    export let tabindex = 0;\n    const symbols = /[\\r\\n%#()<>?[\\\\\\]^`{|}]/g;\n    const svgThumbnailAsStyle = (line1, line2) => {\n        const svg = `\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"250\" height=\"100\" dominant-baseline=\"middle\" text-anchor=\"middle\" font-size=\"2rem\">\n                <text x=\"0\" y=\"0\" style=\"currentColor\">\n                    <tspan x=\"125\" y=\"45\">${line1}</tspan>\n                    <tspan x=\"125\" y=\"85\">${line2}</tspan>\n                </text>\n            </svg>\n        `\n        .replace(/(?:(^\\s+)|(\\s+)$)/gmu, ' ')\n        .replace(/>\\s+</gmu,'><')\n        .replace(/\"/g, `'`)\n        .trim()\n        .replace(symbols, encodeURIComponent);\n        return `background-image: url(\"data:image/svg+xml,${svg}\");`;\n    };\n    const url = new URL(src)\n    if (forcePreview) url.hash='t=0.001'; //https://muffinman.io/blog/hack-for-ios-safari-to-display-html-video-thumbnail/\n    url.searchParams.set('dnd',1); // do not track\n</script>\n{#if $online}\n    <!-- svelte-ignore a11y-media-has-caption -->\n    <video tabindex=\"{tabindex}\" controls style=\"{svgThumbnailAsStyle(...title.split('\\\\n'))}\">\n        <source src=\"{url}\" type=\"video/mp4\">\n    </video>\n{/if}\n<style>\n    video {\n        background-position: center 50px;\n        background-repeat: no-repeat;\n        border: 1px solid var(--bs-gray-300);\n        margin-bottom: 1rem;\n        max-width: 100%;\n        max-height: 400px;\n        height: auto;\n        width: 575px;\n    }\n</style>","<script>\n    import Link from '../components/Link.svelte';\n    import CircleProgress from '../components/CircleProgress.svelte';\n    import EmbeddedVideo from '../components/EmbeddedVideo.svelte';\n    import {ofp} from '../stores.js';\n    import plugins from \"../plugins.json\";\n    $: ogimetURL = ($ofp) ? $ofp.ogimetData.url: 'http://www.ogimet.com';\n    const cbName = window.atob(\"Q2FydGFCb3NzeQ==\");\n</script>\n\n<section id=\"_intro\">\n\n## Préambule\n\nOFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l'écran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie. OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.\n\nL'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L'app ne collecte aucune donnée.\n\nAvant d'utiliser OFP2MAP en vol, il est préférable de lire la rubrique [Mode hors ligne](#_offline). Ensuite le mémo visuel devrait vous permettre de vous débrouiller. Vos retours seront appréciés pour faire évoluer l'app.\n\n</section>\n\n<section id=\"_memovisuel\">\n\n## Mémo visuel\n\n<img style=\"display: block;\" src=\"./images/map-help.webp\" alt=\"mémo visuel\" id=\"memovisuel\" usemap=\"#memo-map\">\n<!-- Image Map Generated by http://www.image-map.net/ -->\n<map name=\"memo-map\">\n    <area tabindex=\"-1\" alt=\"Choix projection\" title=\"Choix projection\" href=\"#_utilisation\" coords=\"7,64,154,201\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Mode hors ligne\" title=\"Mode hors ligne\" href=\"#_offline\" coords=\"313,236,162,74\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Éphémérides du vol\" title=\"Éphémérides du vol\" href=\"#_ephemerides\" coords=\"369,108,368,180,545,175,547,109,639,69,692,69,693,26,632,27,621,59,529,105\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"GRAMET\" title=\"GRAMET\" href=\"#_gramet\" coords=\"576,142,575,252,753,250,753,142,702,142,739,64,791,64,792,26,720,25,725,62,685,142\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"Position Estimée\" title=\"Position Estimée\" href=\"#_position\" coords=\"820,25,821,137,790,136,791,240,874,247,879,146,938,142,926,90,898,88,903,26\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"GRAMET\" title=\"GRAMET\" href=\"#_gramet\" coords=\"737,391,738,430,852,425,850,388\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"ETOPS\" title=\"ETOPS\" href=\"#_etops\" coords=\"916,201,922,334,1021,310,1009,205,962,197,951,20,932,18,937,67,946,79,949,201\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"ETOPS\" title=\"ETOPS\" href=\"#_etops\" coords=\"559,568,774,672\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Export\" title=\"Export\" href=\"#_export\" coords=\"163,35,227,60\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Plugins\" title=\"Plugins\" href=\"#_plugins\" coords=\"1023,26,1076,26,1076,66,1089,94,1084,127,967,125,964,95,1017,95\" shape=\"poly\">\n    <area tabindex=\"-1\" alt=\"Réglages des calques\" title=\"Réglages des calques\" href=\"#_reglages_des_calques\" coords=\"1152,76,1191,109\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Réglages des calques\" title=\"Réglages des calques\" href=\"#_reglages_des_calques\" coords=\"1048,245,1138,200\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Position GPS\" title=\"Position GPS\" href=\"#_position\" coords=\"1068,293,1180,382\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Position GPS\" title=\"Position GPS\" href=\"#_position\" coords=\"1155,117,1186,147\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Réglages des calques\" title=\"Réglages des calques\" href=\"#_reglages_des_calques\" coords=\"\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Style terrains\" title=\"Style terrains\" href=\"#_reglages_des_calques\" coords=\"88,541,232,638\" shape=\"rect\">\n    <area tabindex=\"-1\" alt=\"Cycle AIRAC\" title=\"Cycle AIRAC\" href=\"#_updates\" coords=\"1108,721,1190,779\" shape=\"rect\">\n</map>\n</section>\n\n<section id=\"_utilisation\">\n\n## Utilisation\n\n1. Dans Pilot Mission, onglet **Dossier de vol**, affichez le PDF nommé **Dossier de vol OFP**. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez **Enregistrer dans Fichiers**. Dans l'app, c'est cet OFP qu'il faut ensuite sélectionner.\n\n2. La carte par défaut dépend de la distance: {cbName}, puis Mercator jusqu'à 1500nm puis Lambert. Il est possible sur la carte, en haut à gauche, de basculer sur d'autres projections&#8239;:\n    - **Mercator**\n\n        Projection Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line\n\n    - **Lambert North**\n\n        Les parallèles sécants sont 30N et 65N, elle est recommandée au-dessus du 30N\n\n    - **Lambert South & Pacific**\n\n        Les parallèles sécants sont 30N et 15S, elles sont recommandées sous 30N\n\n    - **The World**\n\n        Un Atlas politique, c'est une projection Times. Les étiquettes sont en anglais.\n\n    - **=Physique=**\n\n        Un Atlas physique basé sur une projection Equal Earth (qui montre les continents et les pays à leur taille réelle). Les étiquettes sont en français.\n\n    - **{cbName} 2020**\n\n        Une carte VFR qui couvre France/Belgique/Luxembourg/Suisse. {window.atob(\"VmluY2VudCBCb3NzeQ==\")} a autorisé son utilisation. La dernière version est disponible sur <Link href=\"{`https://www.${cbName.toLowerCase()}.com`}\">{cbName}.com</Link>.\n\n\n3. Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts.  \n__<span class=\"big\">☞</span> Il est aussi possible de modifier l'angle de vue en balayant de bas en haut avec deux doigts__.\n\n<br>\n\n> OFP2MAP est compatible avec l'utilisation d'une souris, d'un trackpad ou d'un clavier, y compris sur iPad.<br/>\n> <kbd>◀︎</kbd> <kbd>▶︎</kbd> <kbd>▲</kbd> <kbd>▼</kbd> pour translater, simultanément avec <kbd>**⇧**</kbd> pour tilter ou orienter. <kbd>+</kbd> et <kbd>-</kbd> pour le zoom. Il faut que la carte ait le focus (indiqué en bas à gauche par une bordure bleu), au besoin cliquez la carte ou utilisez <kbd>⇥</kbd>.\n\n</section>\n<section id=\"_ipad\">\n\n## Particularités de l'iPad\n\nOFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur&#8239;: il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut en mode portrait et en bas à gauche en mode paysage.\n\nPour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. {#if navigator.standalone !== true}Pour mémoire, dans un navigateur, il suffit de partager l'url ou <Link href=\"http://flyingeek.github.io/lido-online/index.html\">ce lien</Link>.{/if}\n\nÀ noter que parfois, des bugs d'affichage peuvent apparaître&#8239;:  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.\n\n</section>\n<section id=\"_offline\">\n\n## Mode hors ligne <span class=\"cacheButton\"><CircleProgress value=0/></span>\n\nUne fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.\n\nPour mettre rapidement en cache un vol, il existe à droite du sélecteur de carte, un bouton de mise en cache de la projection&#8239;: <span class=\"cacheButton\"><CircleProgress value=0/></span>. Ce bouton ne s'affiche que si la projection n'est pas encore dans le cache. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache et le niveau de détails sera limité à un zoom < 7. Pour les autres projections, c'est la totalité de la carte qui sera mise en cache.\n\nLe bouton affiche la progression du téléchargement&#8239;: <span class=\"cacheButton cacheProgress\"><CircleProgress value=33/></span>, puis il disparait une fois la projection en cache. En cas d'erreur, il affiche: <span class=\"cacheButton cacheError\"><CircleProgress value=0/></span>, et vous pouvez faire une nouvelle tentative.\n\nLes premières mises en cache peuvent prendre du temps&#8239;: sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent&#8239;: 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH, 32Mo pour THE WORLD, 40Mo pour =Physique= et 40Mo pour {cbName}.\n\n> Il faut penser à mettre en cache la Mercator à chaque vol\n\n</section>\n<section id=\"_reglages_des_calques\">\n\n## Réglages des calques <svg><use xlink:href=\"#layers-symbol\"></use></svg>\n\n<figure>![layers settings help](./images/layers-settings.webp)<figcaption>Réglages des calques</figcaption></figure>La carte, en haut à droite, dispose d'un bouton pour personnaliser les calques et les couleurs. Un calque contient un type d'information, par exemple les cercles ETOPS, les FIR réglementées, les tracks, la route...\nIl est possible d'afficher ou de masquer chaque calque en utilisant la coche qui précède son nom. La plupart des calques permettent de choisir la couleur et l'opacité.\n\nLes réglages s'appliquent globalement, c'est à dire, pour toutes les projections. Exception&#8239;: pour les FIR, <svg class=\"eye\"><use xlink:href=\"#eye-symbol\"></use></svg> permet, en plus, de masquer le calque sur la projection actuelle. Il est alors indiqué <svg class=\"eye\"><use xlink:href=\"#eye-off-symbol\"></use></svg> calque masqué sur cette projection.\n<br/>\nDans un soucis de lisibilité, certains calques sont automatiquement désactivés, il est alors indiqué  <svg class=\"eye deactivated\"><use xlink:href=\"#eye-off-symbol\"></use></svg> ⚠️ calque désactivé sur cette projection.\n\nPour les aéroports (le type avion est déterminé dans l'OFP), il est possible de choisir entre 4 styles:\n\n- **statuts** reprend les couleurs du statut telles que définies dans le Manex C.\n- **vert/rouge** reprend le code couleur des Regional Planning Chart, il y ajoute le symbole <span style=\"color: #062DF8;\">✚</span> pour les terrains de support médical.\n- **bleu/vert/rouge** permet de distinguer les adéquats de support médical par la couleur de l'icône.\n- **médical** n'affiche que les terrains de support médical\n\n> Le statut est aussi disponible en cliquant sur un terrain (popup).\n\nTrois boutons permettent la sauvegarde, la restauration ou un retour aux valeurs par défaut. Le bouton RESTAURER permet, après avoir fait des modifications temporaires (non sauvegardées), de revenir rapidement aux réglages précédents.\n\n> Pour vous entraîner, je vous recommande de modifier la couleur des terrains en vert/rouge sur LC ou bleu/vert/rouge sur MC, et de sauvegarder votre choix.\n\n### Mode FOCUS&#8239;\n\nC'est un mode pensé pour basculer rapidement sur d'autres réglages pour un usage ponctuel. Par défaut le mode FOCUS n'affiche que la route. Il s'active en cliquant sur FOCUS dans le champ ROUTE. Pour quitter ce mode, réaffichez les réglages et cliquez à nouveau sur le bouton.\n\nLe mode FOCUS est personnalisable&#8239;: Après avoir activé le mode MODE FOCUS, réaffichez les réglages et modifiez les à votre convenance. Lorsque vous quitterez le mode FOCUS, ce jeu de réglages sera sauvegardé séparément et il sera rechargé à la prochaine activation.\n\nSi nécessaire, un bouton permet de revenir aux valeurs par défaut.\n\n> Idées pour utiliser ce mode&#8239;: changer la couleur de la route pour The World; avoir un jeu de réglages pour la présentation aux pax; ...\n\n</section>\n<section id=\"_gramet\">\n\n## GRAMET\n\nLe GRAMET est un météogramme représentant le temps et l'espace. Il indique, en tout point de la route, et à l'heure de passage estimée, une coupe verticale de la météo prévue.\nLe GRAMET est réalisé par <Link href=\"{ogimetURL}\">ogimet.com</Link> à partir d'une route calculée. Il est possible d'afficher le GRAMET et sa route sur la carte. La route est particulièrement utile lors des vols océaniques car il n'y a aucune station en mer.\nPour construire la route du GRAMET, on utilise non pas les waypoints, mais au plus 21 stations météo (WMO). Il y a au total 13000 WMO dans le monde. Le GRAMET débute toujours à l'heure hh:00. Pour un decollage à 19h30, il débutera à 19h, pour un décollage à 19h31, il débutera à 20h. Pour les OFP anciens, c'est l'heure actuelle qui est envoyée. En mode déconnecté, OFP2MAP utilise la version du GRAMET qu'il a mis en cache pendant 48h. Après l'heure de décollage initialement prévue, vous pouvez forcer une mise à jour, soit en rechargeant l'ofp, soit en changeant brièvement de page.\n\nPour afficher le Gramet, cliquez sur sa miniature dans la barre de menu. Pour afficher la route, direction le réglage des calques de la carte. Par défaut elle est affichée en bleu. En fonction de l'heure de décollage (modifiable), le Gramet et sa miniature affichent la position avion. Avant l'horaire prévu de décollage, un bouton play <span class=\"btn-simulator-play\" style=\"font-size: 24px; line-height:24px; --stroke-width: 2px\"></span> permet de lancer une animation.\n\nPour mieux comprendre le GRAMET, je vous conseille son <Link href=\"http://www.ogimet.com/guia_gramet.phtml.en\">Guide d'interprétation</Link>.\n\n> Le site ogimet est indisponible lorsqu'il met à jour ses données, cela intervient entre minuit et 3h (heure française). Par ailleurs, je suis limité à 10 secondes pour la durée d'exécution du proxy, ce délai est un peu faible lorsqu'ogimet est saturé (tranche 18h30-20h00) et cela peut entrainer des erreurs, cliquer sur <svg style=\"stroke: red; transform: rotate(180deg); height: 20px; width: 20px;\"><use xlink:href=\"#info-symbol\"></use></svg> vous affichera des consignes.\n\n</section>\n<section id=\"_position\">\n\n## Position avion <svg style=\"transform: scale(1.4,1.4); margin-left:5px;\"><use xlink:href=\"#takeoff-symbol\"></use></svg><svg style=\"transform: scale(1.4,1.4); margin-left:8px;\"><use xlink:href=\"#geolocate-symbol\"></use></svg>\n\nL'avion dans la barre de menu <svg><use xlink:href=\"#takeoff-symbol\"></use></svg> permet d'afficher la position estimée <svg style=\"color: var(--plane-color)\"><use xlink:href=\"#location-symbol\"></use></svg> sur la route en prenant en compte les estimées de l'OFP. En cas d'erreur lors de reconnaissance des waypoints, la position sera basée sur un simple ratio horaire, merci de me transmettre l'OFP dans ce cas (ce sera signalé par un avion rouge dans la barre de menu et par l'absence des éphémérides). L'heure de décollage est modifiable et permet d'ajuster la position estimée à la minute près.\n\nLa position estimée est affichée en permanence sur le GRAMET, la miniature du GRAMET et les timelines des éphémérides. Pour un OFP ancien, la position estimée sera toujours la destination.\n\nOFP2MAP peut aussi utiliser un GPS. En cliquant sur <svg><use xlink:href=\"#geolocate-symbol\"></use></svg>, la position GPS <svg style=\"color: #1da1f2\"><use xlink:href=\"#location-symbol\"></svg> sera affichée sur la carte. Si la localisation GPS semble ne pas fonctionner (au sol ou en vol avec un gps externe), vérifiez que vous n'avez pas désactivé la localisation dans iPad / Réglages / Confidentialité / Service de localisation / Sites Safari. Vous devez choisir «Lorsque l'app est active» ou «Demander la prochaine fois». Le Bouton <svg><use xlink:href=\"#geolocate-symbol\"></use></svg> a trois positions: OFF, ON centré, ON non centré. Si, dans la position ON centré, vous déplacez la carte, il passe en ON non centré. L'appui suivant le repassera en ON centré. Un dernier appui le mettra sur OFF.\n\n> C'est toujours la position estimée qui est utilisée pour les éphémérides\n\n</section>\n<section id=\"_etops\">\n\n## ETOPS\n\nLa capacité ETOPS est determinée depuis l'OFP et les cercles sont tracés. Un drapeau <span style=\"background-color: var(--bs-warning); padding: 0 3px; font-size: 9px;\">ETOPS</span> apparait dans le pavé d'information de l'OFP si le carburant est limitatif (20mn, soit environ 2T de marge sur 777). Pour avoir plus d'informations vous pouvez utiliser un [plugin](#_plugins).\n\nLes appuis ETOPS sont affichés avec l'icône <span class=\"big\" style=\"color: #FC2403FF;\">▲</span> (dans la couleur des cercles ETOPS). Les adéquats d'entrée et de sortie ETOPS avec le symbole <span class=\"big\" style=\"color: #095;\">▲</span> (dans la couleur des adéquats du style utilisé). La couleur des cercles des points d'entrée et de sortie est celle de la route.\n\n</section>\n<section id=\"_ephemerides\">\n\n## Éphémérides ☀️🌘🔭\n\n<figure>![éphémerides exemple](./images/ephemerides.webp)<figcaption>Exemple avec aurore boréale prévue</figcaption></figure>\n\nUn clic sur le widget révèle les éphémérides avec 2 timelines. La première synthétise le jour et la nuit le long du vol ainsi que les zones favorables à l'observation des aurores boréales. La seconde montre les prévisions de Kp. Le Kp permet de prédire les aurores boréales. Entre ces deux timelines, la Lune est un objet dynamique: l'angle des cornes va se modifier en fonction de la position estimée et cet angle est également calculé pour les levers et les couchers. Pour le soleil, l'aube nautique est indiquée, car ce n'est pas tout à fait la nuit: en vol l'horizon est partiellement discernable, et au sol on distingue encore le relief.\n\nLe symbole du widget est dynamique:\n\n- ☀️ si le soleil est visible pendant le vol\n- 🌕🌖🌗🌘🌑🌒🌓🌔 si seule la lune est visible pendant le vol\n- 🔭 si vous restez dans le noir\n- un <span class=\"aurora\">halo vert</span> se superpose si les conditions sont favorables à l'observation d'aurores boréales\n\n__Précision des calculs&#8239;:__ si vous avez bien recalé la position estimée d'OFP2MAP sur la carte (en modifiant l'heure de décollage), la précision attendue est de ±2 min sous 72° de latitude et de 10 min au-delà. Pour la lune, on est plutôt sur une précision de ±5 min. Le calcul n'est valable que pour la croisière, reportez vous à EWAS pour un calcul précis au départ ou à destination.\n\n__Correction d'altitude&#8239;:__ Si votre niveau de vol est différent de l'OFP, appliquez une correction de 15s/1000ft pour le soleil. Exemple: FL OFP 400, FL réel 360, il faut ajouter 1min pour le lever, et soustraire 1min pour le coucher.\n\n<details>\n    <summary tabindex=\"-1\">Cliquez ici pour afficher un rappel sur la chronologie des événements astronomiques</summary>\n    <p>Pour le soleil:</p>\n    <table class=\"table\">\n        <thead><tr><th>Angle</th><th>▲ Soleil levant</th><th>▼ Soleil couchant</th></tr></thead>\n        <tbody>\n            <tr><td>-0.83°</td><td>↑ Lever du soleil (fin aube civile)</td><td>↓ Coucher du soleil (début crépuscule civil)</td></tr>\n            <tr><td>-6°</td><td>↑ début aube civile (jour civil)</td><td>↓ fin du crépuscule civil (début nuit civile)</td></tr>\n            <tr><td>-12°</td><td>↑ début aube nautique (jour nautique)</td><td>↓ fin du crépuscule nautique (début nuit nautique)</td></tr>\n        </tbody>\n    </table>\n    <p>Et pour la lune:</p>\n    <table class=\"table moon\">\n        <thead><tr><th>Jour</th><th>Nom</th><th>Hémisphère nord</th><th>Hémisphère sud</th></tr></thead>\n        <tbody>\n            <tr><td>1</td><td>Nouvelle lune</td><td>🌑</td><td>🌑</td></tr>\n            <tr><td></td><td>Premier croissant</td><td>🌒</td><td>🌘</td></tr>\n            <tr><td>7</td><td>Premier quartier</td><td>🌓</td><td>🌗</td></tr>\n            <tr><td></td><td>Lune gibbeuse croissante</td><td>🌔</td><td>🌖</td></tr>\n            <tr><td>14</td><td>Pleine lune</td><td>🌕</td><td>🌕</td></tr>\n            <tr><td></td><td>Lune gibbeuse décroissante</td><td>🌖</td><td>🌔</td></tr>\n            <tr><td>21</td><td>Dernier quartier</td><td>🌗</td><td>🌓</td></tr>\n            <tr><td></td><td>Dernier croissant</td><td>🌘</td><td>🌒</td></tr>\n        </tbody>\n    </table>\n</details><!-- no space here otherwise menu will select the wrong item when going to export -->\n</section>\n<section id=\"_export\">\n\n## Export KML\n\nLa Page Export permet d'exporter la route et les tracks au format KML, elle dispose de ses propres réglages pour générer le KML. Pour l'export il est possible d'ajouter des repères. Les repères sont utiles pour afficher des informations textuelles dans MapsMe ou Avenza. Le bouton [COMME CARTE] permet de récupérer les couleurs choisies pour la carte.\n\nSur iPad, lors du téléchargement, l'export des fichiers KML affiche une page un peu particulière, utilisez le bouton <svg style=\"vertical-align: bottom;\"><use xlink:href=\"#share-symbol\" /></svg> pour choisir l'app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. Alternativement, vous pouvez utiliser , sur cette même page, [Options...] pour définir une app qui recevra les fichiers kml par défaut, puis utiliser Ouvrir dans «&#8239;nom de l'app&#8239;».\n\n Un raccourci peut être lancé depuis la page Export, il recevra les fichiers KML, la route Lido et le Gramet. Le nom du raccourci est modifiable, il faut que le raccourci soit installé avant de le lancer.\n\n</section>\n<section id=\"_plugins\">\n\n## Plugins 🧩\n\nDepuis le pavé d'informations du vol dans la barre de menu, il est possible de lancer un plugin. Les plugins sont des raccourcis qui doivent être installés au préalable.\n\nInstaller le premier plugin est un peu compliqué&#8239;: Il faut au préalable autoriser les raccourcis non fiables dans Réglages/Raccourcis (et ce après avoir lancé au moins un raccourci \"fiable\" depuis la Galerie).\n\n__Liste des plugins&#8239;:__\n\n{#each Object.entries(plugins) as [name, {url, description, version}]}\n    - <Link href=\"{url}\">{name} v{version}</Link> {description}\n{/each}\n\n> Pour un accès plus rapide aux plugins, je recommande d'installer OFP2MAP-MENU. Il faut ensuite le remonter dans le menu contextuel qui s'affiche en cliquant 🧩.\n> La vidéo ci-dessous montre la manip si vous êtes online.\n\n<EmbeddedVideo tabindex=\"-1\" src=\"https://p169.p3.n0.cdn.getcloudapp.com/items/KouJeA4l/42ec3a9e-a573-41cb-bd34-763da10c514c.mp4?source=client\" title=\"Utilisation\\nOFP2MAP-MENU\"/>\n\n</section>\n<section id=\"_updates\">\n\n## Mise à jour\n\nL'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.\n\nAprès une mise à jour, les dernières nouveautés d'OFP2MAP s'affichent. Le bouton CHANGELOG en haut de cette page permet de consulter l'historique, et vous pouvez aussi consulter la <Link href=\"https://github.com/flyingeek/lido-online/commits/master\">liste des commits</Link> sur GitHub. Je poste les nouveautés importantes dans Yammer/Mapsme et Teams/MyConcorde.\n\n</section>\n<section id=\"_credits\">\n\n## Crédits 🙏\n\n- Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme\n- =Physique= est une carte de Tom Patterson disponible sur <Link href=\"https://equal-earth.com/physical/\">Equal Earth</Link>\n- La dernière version de la carte {cbName} est disponible sur le site <Link href=\"{`https://www.${cbName.toLowerCase()}.com`}\">{cbName}.com</Link>\n- Les autres cartes sont de Jean-Baptiste Denizot forum Yammer/QGIS & Avenza Maps\n- Le GRAMET provient du site ogimet.com\n- Le site est développé en javascript à l'aide du framework SVELTE\n- La partie serveur (un proxy pour pouvoir récupérer l'image du GRAMET) est en python.\n- Eric Delord CDB 777 est l'auteur. Le code source est disponible sur GitHub pour <Link href=\"https://github.com/flyingeek/lido-online\">l'app</Link> et <Link href=\"https://github.com/flyingeek/ofp2map-gramet\">le proxy</Link>\n\nVous pouvez me contacter sur l’email AF (erdelord@…) ou sur mon compte Twitter @flyingeek.\n\nL'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel. Le site est hébergé sur GitHub.\n\n### Liens\n\n- <Link href=\"https://flyingeek.github.io/flytax/\" rel=\"noopener\"><span class=\"flytax\">Fly<span>Tax</span></span></Link> une aide aux calculs des frais professionnels (même auteur).\n- <Link href=\"https://apps.apple.com/app/id364904503\">The World HD</Link> un très bon atlas offline pour l'iPad (prix 3$).\n\n</section>\n","<script context=\"module\">\n    import {semverCompare} from \"./utils\";\n    /**\n     * filter or slice the json changelog\n     * @param json the json changelog\n     * @param {version, limit} if version, returns entries > version, if limit returns at max limit entries\n     */\n    export const filterChangeLog = (json, {version, limit}={}) => {\n        if (!json) return [];\n        let filtered = Object.entries(json.CHANGELOG);\n        if (version) {\n            filtered = filtered.filter(([k,]) => {\n                const v = k.match(/\\[([^\\]]+)\\]/);\n                return (v) ? semverCompare(v[1], version) > 0 : false;\n            });\n        }\n        return (limit) ? filtered.slice(0, limit + 1) : filtered;\n    };\n    export function parseMarkdown(markdownText) {\n        const htmlText = markdownText\n            //.replace(/^### (.*$)/gim, '<h3>$1</h3>')\n            //.replace(/^## (.*$)/gim, '<h2>$1</h2>')\n            //.replace(/^# (.*$)/gim, '<h1>$1</h1>')\n            //.replace(/^\\> (.*$)/gim, '<blockquote>$1</blockquote>')\n            .replace(/\\*\\*(.*)\\*\\*/gim, '<b>$1</b>')\n            .replace(/\\*(.*)\\*/gim, '<i>$1</i>')\n            //.replace(/\\*(.*)\\*/gim, '<i>$1</i>')\n            //.replace(/!\\[(.*?)\\]\\((.*?)\\)/gim, \"<img alt='$1' src='$2' />\")\n            .replace(/\\[(.*?)\\]\\((#.*?)\\)/gim, \"<a href='$2'>$1</a>\")\n            .replace(/\\[(.*?)\\]\\((.*?)\\)/gim, \"<a href='$2' rel='noreferrer' target='_blank'>$1</a>\")\n            .replace(/^$/g, '<br />')\n\n        return htmlText.trim()\n    }\n    const translation = {\n        \"ADDED\": \"Ajouté\",\n        \"FIXED\": \"Corrigé\",\n        \"DEPRECATED\": \"Obsolète\",\n        \"CHANGED\": \"Modifié\",\n        \"REMOVED\": \"Supprimé\",\n        \"SECURITY\": \"Sécurité\"\n    };\n    export const _ = text => translation[text.toUpperCase()] || text;\n    export const versionDateRegex = /\\[([^\\]]+)\\].+(\\d{4})-(\\d{2})-(\\d{2})/;\n    export const title2html = (text) => {\n        return text.replace(/\\[([^\\]]+)\\].+(\\d{4})-(\\d{2})-(\\d{2})/, \"<span class='version'>$1</span> <span class='date'>$4/$3/$2</span>\");\n    }\n    const badgeColors = {\n        \"ADDED\": \"primary\",\n        \"FIXED\": \"success\",\n        \"DEPRECATED\": \"warning\",\n        \"CHANGED\": \"info\",\n        \"REMOVED\": \"danger\",\n        \"SECURITY\": \"secondary\"\n    }\n    const badgeTextColors = {\n        \"ADDED\": \"text-white\",\n        \"FIXED\": \"text-white\",\n        \"DEPRECATED\": \"text-dark\",\n        \"CHANGED\": \"text-dark\",\n        \"REMOVED\": \"text-white\",\n        \"SECURITY\": \"text-white\"\n    }\n    export const badgeColor = (category) => badgeColors[category.toUpperCase()] || 'light';\n    export const badgeTextColor = (category) => badgeTextColors[category.toUpperCase()] || 'text-dark';\n</script>\n<script>\n    export let data;\n    export let limit = undefined;\n    export let version = undefined;\n</script>\n\n<ul class=\"markdown\">\n{#each filterChangeLog(data, {version, limit}) as [title, section]}\n    {#if title !== \"raw\"}\n        <li>\n            {#if title.match(versionDateRegex)}\n                <h2>{@html title2html(title)}</h2>\n            {:else}\n            <h2>{title}</h2>\n            {/if}\n            {#each Object.entries(section) as [category, content]}\n                {#if category !== \"raw\"}\n                    {#each content.raw.replace(/^\\n\\n|\\n\\n$/, '').split('\\n') as item}\n                        <div class=\"item\">{@html parseMarkdown(item).replace('- ', `- <span class=\"badge bg-${badgeColor(category)} ${badgeTextColor(category)}\">${_(category)}</span>`)}</div>\n                    {/each}\n                {:else}\n                    <div class=\"item\">{@html parseMarkdown(content)}</div>\n                {/if}\n            {/each}\n        </li>\n    {/if}\n{/each}\n</ul> \n\n<style>\n    ul{\n        padding-left: 1em;\n    }\n    li{\n        list-style: square;\n    }\n    li:not(:first-child) h2{\n        margin-top: 1rem;\n    }\n    h2{\n        font-size: 1.5rem;\n        border-bottom: 1px solid #eee;\n        font-weight: 500;\n        text-transform: uppercase;\n        font-variant: all-petite-caps;\n    }\n    h2 :global(.date){\n        font-size: 1rem;\n        color: grey;\n    }\n    h2 :global(.version)::before{\n        content: \"v\";\n        font-size: 1rem;\n    }\n    .item {\n        margin-bottom: 0.25rem;\n        margin-left: 0.5rem;\n        text-indent: -0.8em;\n    }\n    .item :global(.badge) {\n        text-indent: 0;\n        margin-right: 0.5rem;\n        min-width: 8ch;\n    }\n</style>","<script context=\"module\">\n    import {storage, stores} from './mapSettings/storage.js';\n    import {previousAppVersionKey} from '../stores';\n    const store = stores.changelogOnUpdate;\n    export const showChangelogOnUdate = () => {\n        return (storage.getItem(store) === null) ? true : !!storage.getItem(store);\n    }\n    export const setPreviousAppVersion = () => {\n        if (localStorage) {\n            localStorage.setItem(previousAppVersionKey, 'APP_VERSION');\n            return 'APP_VERSION';\n        }\n    };\n    export const getPreviousAppVersion = () => {\n        if (localStorage){\n            return localStorage.getItem(previousAppVersionKey);\n        }\n    };\n</script>\n<script>\n    import { fade } from 'svelte/transition';\n    import ChangeLog from \"./ChangeLog.svelte\";\n    import clickOutside from '../actions/clickOutsideAction';\n\n    export let title = 'CHANGELOG';\n    export let version = undefined;\n    export let visible = !!version;\n    let promise;\n    let checked = showChangelogOnUdate();\n\n    export const show = async () => {\n        visible = true;\n        promise = fetch('./CHANGELOG.json').then(response => {\n            if(response.ok) {\n                return response.json();\n            } else {\n                throw new Error('CHANGELOG.json not available');\n            }\n        });\n    };\n    export const close = () => {\n        visible = false;\n        setPreviousAppVersion();\n    };\n\n    export const save = () => {\n        storage.setItem(store, checked);\n    }\n</script>\n\n{#if visible}\n    <div class=\"modal\" tabindex=\"-1\" role=\"dialog\" in:fade>\n        <div class=\"modal-dialog modal-xl modal-dialog-centered\" role=\"document\" use:clickOutside  on:click_outside={close}>\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title\">{title}\n                        <small class=\"d-inline-block ms-4 form-check form-switch\">\n                            <input bind:checked id=\"display-on-update\" class=\"form-check-input\" type=\"checkbox\" on:change={save}>\n                            <label for=\"display-on-update\"class=\"form-check-label\">Afficher lors des mises à jour</label>\n                        </small>\n                    </h5>\n                    <button type=\"button\" class=\"btn-close\" data-dismiss=\"modal\" aria-label=\"Close\" on:click={close}></button>\n                </div>\n                <div class=\"modal-body\" class:expanded={!version}>\n                    {#await promise}\n                    <p>chargement...</p>\n                    {:then data}\n                    <ChangeLog {data} {version}/>\n                    {/await}\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"modal-backdrop show\" in:fade></div>\n{/if}\n\n<style>\n    .modal {\n        display: block;\n    }\n    .modal-body {\n        overflow-y: auto;\n        max-height: calc(90vh - 3.875rem); /* h5 height * line-height = 1.875rem  h5 margin-top = 1rem margin-bottom = 1rem */\n    }\n    .expanded {\n        height: calc(90vh - 3.875rem); /* h5 height * line-height = 1.875rem  h5 margin-top = 1rem margin-bottom = 1rem */\n    }\n</style>","<script context=\"module\">\n    export const helpRouteRegex = /^\\/help_?/u;\n    export const getContextualHelpLink = (route) => {\n        let name = \"\", href;\n        switch (route) {\n            case '/map':\n            href = '#/help_memovisuel';\n            break;\n            case '/export':\n            href = '#/help_export';\n            break;\n            default:\n            href = '#/help';\n        }\n        return {name, href: encodeURI(href)};\n    };\n</script>\n<script>\nimport Helpmarkup from './Help.md';\nimport ChangeLogModal from './ChangeLogModal.svelte';\nimport {wb, route} from '../stores';\nimport {shareAppLink, debounce, Deferred} from './utils';\nimport {onMount, tick} from \"svelte\";\nimport blurAction from '../actions/blurAction';\n\nconst version = \"APP_VERSION\";\nlet swVersion = '';\nconst updateVersion = (_wb) => {\n    return (_wb) ? _wb.messageSW({type: 'GET_VERSION'}).then(v => swVersion = v) : '';\n}\nconst reload = () => {\n    window.location.hash = '#/';\n    console.log('reload page');\n    window.location.reload();\n};\n\n$: updateVersion($wb);\nlet scrollingElement, tocSelectElement, scrollingElementScrolling;\nconst toc = [];\nlet tocNodeList;\nlet selected;\nlet observer;\nlet modal;\nlet imageMapSelector = '#memovisuel';\n\n\n$: setAndJumpTo($route);\n\nconst scrollEndCondition = (element) => {\n    const relativeOffset = element.offsetTop  - scrollingElement.offsetTop;\n    const maxOffset = Math.floor(scrollingElement.scrollHeight - scrollingElement.clientHeight);\n    return scrollingElement.scrollTop.toFixed() === relativeOffset.toFixed() || (scrollingElement.scrollTop >= maxOffset && relativeOffset >= maxOffset);\n}\nfunction scrollTo(element, callback) {\n    const onScroll = function () {\n        if (scrollEndCondition(element)) {\n            callback();\n        }\n    };\n    if (!scrollEndCondition(element)) {\n        if (scrollingElementScrolling) scrollingElementScrolling.reset();\n        scrollingElement.addEventListener('scroll', onScroll);\n        scrollingElement.scrollTo({\n            top: element.offsetTop  - scrollingElement.offsetTop,\n            behavior: 'smooth' // not supported by Safari\n        });\n        return {\n            reset: () => {\n                scrollingElement.removeEventListener('scroll', onScroll);\n                scrollingElementScrolling = undefined;\n                //console.log('scrollingElementScrolling reset')\n            }\n        };\n    }\n}\n// called from:\n// - the toc select menu\n// - setAndJumpTo (without arguments)\nconst jumpTo = (e) => {\n    if (!selected || !tocNodeList) return;\n    if (e) e.target.blur(); // the toc select\n    const element = document.getElementById(selected);\n    if (element) {\n        if (!scrollEndCondition(element)) {\n            observer.disconnect();\n            scrollingElementScrolling = scrollTo(element, () => {\n                //console.log('scroll end')\n                if (tocNodeList) {\n                    tocNodeList.forEach((elt) => {\n                        observer.observe(elt);\n                    });\n                }\n                scrollingElementScrolling.reset();\n            });\n            //if (scrollingElementScrolling) console.log('scrollingElementScrolling set');\n        }else{\n            if (scrollingElementScrolling) scrollingElementScrolling.reset();\n        }\n    }\n};\n// called from:\n// - onMount with the route\n// - the expanded toc menu\nconst setAndJumpTo = (optionalRouteOrEvent) => {\n    if (optionalRouteOrEvent) {\n        if (optionalRouteOrEvent.target) {\n            if (optionalRouteOrEvent instanceof MouseEvent) optionalRouteOrEvent.target.blur();\n            selected = optionalRouteOrEvent.target.dataset.id;\n        }else{\n            const decoded = decodeURI(optionalRouteOrEvent);\n            if (decoded.startsWith('/help')){\n                const id = decoded.replace('/help_', '_'); //we use a _ prefix in section\n                if (toc && toc.map(v => v.id).includes(id)) {\n                    selected = id;\n                    modal.close(); // in case we are reading the changelog\n                }\n            }\n        } \n    }\n    if (!selected && toc && toc.length > 0) {\n        selected = toc[0].id;\n    }\n    if (selected) {\n        jumpTo();\n    }\n}\nconst imagesOnLoadPromise = (selector) => {\n    const promises = [];\n    document.querySelectorAll(selector).forEach((img) => {\n        if (!img.complete) {\n            const d = new Deferred();\n            img.onload = () => d.resolve(img);\n            img.onerror = () =>  d.resolve(img);\n            if (!img.complete) {\n                promises.push(d.promise);\n            }\n        }\n    });\n    //console.log(Promise.all(promises));\n    return Promise.all(promises);\n};\n\nconst resizeImageMap = () => {\n    document.querySelectorAll(imageMapSelector).forEach((img) => {\n        const xScale = img.clientWidth/img.naturalWidth;\n        const yScale = img.clientHeight/img.naturalHeight;\n        const px = parseFloat(window.getComputedStyle(img).getPropertyValue('padding-left'));\n        const py = parseFloat(window.getComputedStyle(img).getPropertyValue('padding-top'));\n        document.querySelectorAll(`map[name=\"${img.useMap.substring(1)}\"] area`).forEach((area) => {\n            if(!area.dataset.coords) area.dataset.coords = area.coords;\n            const coords = area.dataset.coords\n                .split(',')\n                .map((v, i) => ((i % 2 === 0) ? xScale * Number(v) + px : yScale * Number(v) + py).toFixed(0))\n                .join(',');\n                area.coords = coords;\n        });\n    });\n};\nonMount(() => {\n    tocNodeList = scrollingElement.querySelectorAll('.markdown section[id]');\n    const observerRegistry = new Map();\n    observer = new IntersectionObserver((entries) => {\n        entries.forEach(entry => observerRegistry.set(entry.target.id, entry.isIntersecting));\n        //console.log(observerRegistry)\n        let first;\n        for (const [id, isIntercepting] of observerRegistry.entries()) {\n            if (isIntercepting) {\n                first = id;\n                break;\n            }\n        }\n        if (first) selected = first;\n    }, {\n        root: scrollingElement,\n        rootMargin: '0px',\n        threshold: 0\n    });\n    //observe all of our markdown sections\n    tocNodeList.forEach((elt) => {\n        const h2 = elt.querySelector('h2:first-of-type')\n        toc.push({id: elt.id, label: h2.innerText, html: h2.innerHTML});\n        observer.observe(elt);\n    });\n    //console.log(toc)\n\n    //remap all internal links\n    const remapper = (e) => {\n        e.preventDefault();\n        const url = new URL(e.target.href);\n        setAndJumpTo(url.hash.replace('#_', '/help_'));\n    }\n    const remapperQueryExpression = 'a[href^=\"#_\"], area[href^=\"#_\"]';\n    document.querySelectorAll(remapperQueryExpression).forEach(elt => elt.addEventListener('click', remapper));\n\n    // clicking on help link or navbar triggers a scrollToTop like function\n    const jumpToTopQueryExpression  = '.navbar-nav, .nav-link[href=\"#/help\"]';\n    document.querySelectorAll(jumpToTopQueryExpression).forEach(elt => elt.addEventListener('click', setAndJumpTo));\n\n    // we have to resize the image's map on load and on resize\n    imagesOnLoadPromise(imageMapSelector).then(() => {\n        resizeImageMap();\n    }).catch((err) => console.error(err));\n\n    tick().then(() => setAndJumpTo($route)); // tick avoid bad positionning in Safari\n\n    return () => {\n        observer.disconnect();\n        document.querySelectorAll(jumpToTopQueryExpression).forEach(elt => elt.removeEventListener('click', setAndJumpTo));\n        document.querySelectorAll(remapperQueryExpression).forEach(elt => elt.removeEventListener('click', remapper));\n        if (scrollingElementScrolling) scrollingElementScrolling.reset();\n        tocNodeList = undefined;\n        observer = undefined;\n    }\n});\n</script>\n<svelte:window on:resize={debounce(resizeImageMap, 500)}/>\n\n<ChangeLogModal bind:this={modal} />\n<div class=\"help\">\n    <aside>\n        <h1>\n            <div class=\"appInfos\">\n                <div class=\"app\"><img src=\"images/ofp2map-icons/icon-128x128.png\" alt=\"logo\"></div>\n                <div class=\"infos\"><div>OFP2MAP v{version}</div><small on:click|once={() => $wb && $wb.update() && console.log('updating SW')}>ServiceWorker&#8239;: {swVersion}</small></div>\n            </div>\n            <div class=\"actions\">\n                {#if ((navigator.standalone === true && navigator.share) || 'process.env.NODE_ENV' === '\"development\"')}\n                    <button tabindex=\"0\" class=\"share btn btn-outline-secondary btn-sm\" on:click={shareAppLink}><svg><use xlink:href=\"#share-symbol\" /></svg><!-- Partager --></button>\n                {/if}\n                {#if navigator.standalone === true || 'process.env.NODE_ENV' === '\"development\"'}\n                    <button class=\"reload btn btn-outline-secondary btn-sm\" on:click={reload}><!-- Recharger --></button>\n                {/if}\n                <button tabindex=\"0\" class=\"changelog btn btn-outline-secondary btn-sm\" on:click={modal.show}><!-- CHANGELOG --></button>\n            </div>\n            <!-- svelte-ignore a11y-no-onchange -->\n            <select bind:this={tocSelectElement} class=\"toc form-select form-select-sm\" bind:value=\"{selected}\" on:change={jumpTo} use:blurAction>\n                {#each toc as {id, label} (id)}\n                    <option value={id} selected={id === selected}>{label}</option>\n                {/each}\n            </select>\n        </h1>\n        <div class=\"toc\">\n            {#each toc as {id, html} (id)}\n                <h2 on:keydown=\"{(e) => e.key === \"Enter\" && setAndJumpTo(e)}\" tabindex=\"0\" class:selected={selected === id} data-id=\"{id}\" on:click={setAndJumpTo}>{@html html}</h2>\n            {/each}\n        </div>\n    </aside>\n    <div bind:this={scrollingElement} class=\"scrollContainer\">\n        <div class=\"markdown\">\n            <Helpmarkup/>\n        </div>\n    </div>\n</div>\n<style>\n    h1 {\n        font-size: 1rem;\n        display: flex;\n        align-items: center;\n    }\n\n    h1 button {\n        margin-left: 1rem;\n    }\n    small {\n        font-size:x-small;\n    }\n    h1, .scrollContainer {\n        background-color: white;\n    }\n    :global(#_memovisuel){\n        margin-bottom: 1rem;\n    }\n    :global(#_memovisuel h2:first-of-type){\n        position: relative;\n        padding-bottom: 1rem;\n    }\n    :global(#_memovisuel h2:first-of-type::after){\n        content: \"\\24D8\\00A0Vous pouvez cliquer sur les zones\"; /* ⓘ + nbsp;*/ \n        font-size: small;\n        background-color: var(--bs-teal);\n        position: absolute;\n        left: 50%;\n        bottom: -0.5rem;\n        transform: translate(-50%, 0);\n        padding: 0.25rem;\n        border-radius: 2px;\n        width:fit-content;\n    }\n    .toc {\n        display: none;\n    }\n    .toc :global(svg) {\n        height: 1.2rem;\n        width: 1.2rem;\n    }\n    .scrollContainer {\n        -webkit-overflow-scrolling: touch;\n        overflow-y: scroll;\n        flex: 1 1 auto;\n        height: 0;\n        z-index: 1;\n        padding-right: 1rem;\n        margin-right: -1rem;\n        padding-bottom: 50vh;\n    }\n\n    .help {\n        margin:0;\n        padding: 0.5rem 1rem;\n        flex: 1 1 auto;\n        height: 0;\n        display: flex;\n        flex-direction: column;\n        background-color: white;\n    }\n    :global(.markdown svg) {\n        height: 24px;\n        width: 24px;\n        display: inline-block;\n    }\n    :global(span.flytax){\n        color: var(--blueaf);\n        text-transform: uppercase;\n    }\n    :global(span.flytax > span){\n        color: var(--redaf);\n    }\n    :global(.markdown img) {\n        max-width: 100%;\n        height: auto;\n    }\n    :global(img#memovisuel) {\n        max-height: calc(100vh - 80px + 15px); /* 15px is for the top black part */\n    }\n    :global(.markdown figure){\n        width: 300px;\n        margin-left: 1rem;\n        float: right;\n    }\n    :global(.markdown figcaption){\n        text-align: center;\n        font-size: small;\n        font-variant: all-small-caps;\n    }\n    .appInfos {\n            display: inline-flex;\n            flex-direction: row;\n            align-items: center;\n    }\n    .app {\n        vertical-align: middle;\n        text-align: center;\n        margin-right: 0.5rem;\n    }\n    .infos {\n        display: flex;\n        flex-direction: column;\n    }\n    .app img {\n        width: 32px;\n        height: 32px;\n        border-radius: 5px;\n    }\n    .reload::before{\n        content: \"Recharger\";\n    }\n    .share::before{\n        content: \"Partager\";\n    }\n    .share svg {\n        display: none;\n    }\n    .changelog::before{\n        content: \"Changelog\";\n    }\n    select.toc {\n        display: none;\n        width: auto;\n        text-transform: uppercase;\n        color: rgba(0,0,0,.55);\n        font-weight: 700;\n        margin-left: auto;\n        max-width: 20ch;\n        text-overflow: ellipsis;\n    }\n    @media (min-width: 768px) {\n        select.toc {\n            display: inline-block;\n        }\n    }\n    /**\n    * Here we put the menu on the left side\n    */\n    @media (min-width: 992px) {\n        .help {\n            flex-direction: row;\n            /* gap replaced by a padding-left on the scrollContainer for better focus outline of details element */\n            /* column-gap: 1rem; */\n        }\n        .scrollContainer{\n            height: auto;\n            padding-left: 0.5rem;\n        }\n        div.toc {\n            display: block;\n            margin-top: 1rem;\n            margin-left: -8px; /* makes place to put a star */\n            margin-right: 3px; /* for outline focus */\n        }\n        select.toc {\n            display: none;\n        }\n        aside {\n            display: block;\n            flex: 0 0 auto;\n        }\n        \n        aside h1 {\n            flex-direction: column;\n            align-items: stretch;\n        }\n        aside h2 {\n            color: var(--bs-gray-600);\n            font-size: 1rem;\n            cursor: pointer;\n            padding: 5px 5px 5px 13px;\n            margin-left: -5px;\n            border-left: 3px solid transparent;\n            border-right: 3px solid transparent;\n            outline-offset: -2px;\n        }\n        aside h2.selected {\n            color: black;\n            border-left-color: var(--bs-pink);\n        }\n        :global(h2[data-id=\"_memovisuel\"]::before){\n            content: \"★\";\n            color: var(--bs-yellow);\n            margin-left: -11px;\n            font-size: 10px;\n            line-height: 1.2rem;\n            position: absolute;\n        }\n        .actions {\n            display: flex;\n            flex-direction: column;\n            align-items: stretch;\n            margin-top: 1rem;\n            row-gap: 0.25rem;\n        }\n        .actions button:not(.reload){\n            border: none;\n            padding: 0;\n            font-size: 1rem;\n            margin-top: 0;\n            margin-bottom: 0;\n            margin-left: 0;\n            font-weight: 500;\n            line-height: 1.2;\n            text-align: left;\n        }\n        .actions button:not(.reload):hover, .actions button:not(.reload):active{\n            color: var(--bs-gray);\n            background-color: transparent;\n        }\n        .actions button:not(.reload):focus{\n            box-shadow: none;\n        }\n        .actions button.reload{\n            position: absolute;\n            bottom: 1rem;\n            margin-left: 0;\n        }\n        .appInfos {\n            display: flex;\n            flex-direction: row;\n            align-items: center;\n        }\n        .app {\n            display: inline-block;\n        }\n        .infos {\n            display: inline-flex;\n        }\n        .reload::before{\n            content: \"Recharger l'App\";\n        }\n        .share::before{\n            content: \"Partager l'App\";\n        }\n        .changelog::after{\n            content: \"\\1F4E3\"; /* 📣 */\n            margin-left: 1ch;\n            display: inline-block;\n            /* -webkit-transform: scaleX(-1);\n            transform: scaleX(-1); */\n        }\n        .share svg {\n            display: inline-block;\n            width: calc(1rem * 1.2);\n            height: calc(1rem * 1.2);\n            margin-bottom: 3px;\n        }\n        .actions button.changelog{\n            text-transform: none;\n            border-top: 1px solid var(--bs-gray-200);\n            border-bottom: 1px solid var(--bs-gray-200);\n            padding-top: 0.75rem;\n            padding-bottom: 0.75rem;\n            width: 100%;\n            margin-top: 0.5rem;\n        }\n    }\n    /* smartphones, touchscreens */\n    /* @media (hover: none) and (pointer: coarse) {\n        div.toc h2 {\n            margin-bottom: 0.835rem;\n        }\n    } */\n    :global(.markdown .table th), :global(.markdown .table td){\n        padding: 0.25rem 0.75rem;\n    }\n    :global(.markdown .aurora::before){\n        height: 100%;\n        width: 100%;\n    }\n    :global(.markdown .aurora) {\n        position:relative;\n        display: inline-block;\n    }\n    :global(.markdown h3) {\n        font-size: 1.25rem;\n    }\n    :global(.markdown blockquote) {\n        font-style: italic;\n        border-left: 3px solid var(--bs-gray-300);\n        padding-left: 1rem;\n        background-color: var(--bs-gray-100);\n    }\n    :global(.markdown details){\n        margin-bottom: 1rem; /* extra space otherwise menu might consider the wrong item */\n    }\n    :global(.markdown li li p) {\n        margin-bottom: 0.15rem;\n    }\n</style>\n","<script>\n    import {aircraftType, ofp, route} from '../stores';\n    import GrametTrigger from './GrametTrigger.svelte';\n    import OfpInfos from './OfpInfos.svelte';\n    import TakeOffInput from './TakeOffInput.svelte';\n    import Sun from './Sun.svelte';\n    import {getContextualHelpLink, helpRouteRegex} from './Help.svelte';\n    import { focusMap } from './utils';\n\n    let menuCheckBox;\n    const collapse = (e) => {\n        menuCheckBox.checked = false;\n        if (e.target.href === '#/map') {\n          window.location.hash = '/map';\n          e.preventDefault();\n          e.stopPropagation();\n          focusMap();\n        }\n    };\n\n    $: contextualHelpLink = getContextualHelpLink($route);\n\n</script>\n<nav class=\"navbar navbar-expand-md navbar-light\">\n  <div class=\"container-fluid\">\n  <input bind:this={menuCheckBox} type=\"checkbox\" id=\"menu\">\n  <!-- following items are in reverse order to have the menu collapse nicely -->\n  <slot></slot>\n  {#if ($ofp) }\n    <OfpInfos/>\n    {#if $route === '/map'}<TakeOffInput/><GrametTrigger/><Sun/>{/if}\n  {/if}\n  <label class=\"navbar-toggler\" for=\"menu\"><span class=\"navbar-toggler-icon\"></span></label>\n  <!-- end of items in reverse order -->\n\n  <!-- collapsable menu -->\n  <ul class=\"navbar-nav collapse navbar-collapse\" id=\"navbarToggler\">\n    <li class=\"nav-item\" class:active={$route === '/'}>\n      <a class=\"nav-link\" href=\"#/\" on:click={collapse}><strong class=\"d-none\">OFP2MAP </strong><svg><use xlink:href=\"#home-symbol\"/></svg>{#if 'process.env.NODE_ENV' === '\"development\"'}<sup>dev</sup>{/if}</a>\n    </li>\n    {#if $ofp|| $aircraftType || $route === '/map'}\n    <li class=\"nav-item\" class:active={$route === '/map'}>\n      <a class=\"nav-link\" href=\"#/map\" on:click={collapse}>\n      <span>CARTE</span></a>\n    </li>\n    {/if}\n    {#if  ($ofp) || $route === '/export'}\n    <li class=\"nav-item\" class:active={$route === '/export'}>\n      <a class=\"nav-link\" href=\"#/export\" on:click={collapse}>\n      <span>EXPORT</span></a>\n    </li>\n    {/if}\n    <li class=\"nav-item\" class:active={$route.match(helpRouteRegex)}>\n      <a class=\"nav-link\" href=\"{contextualHelpLink.href}\" on:click={collapse}>\n      <span>AIDE{#if contextualHelpLink.name}<small class=\"d-none d-lg-inline-block text-small-caps\">/{contextualHelpLink.name}</small>{/if}</span></a>\n    </li>\n  </ul>\n  </div>\n</nav>\n\n<style>\n    #menu {\n      display: none;\n    }\n    sup {\n        background-color: var(--redaf);\n        color: var(--bs-white);\n        padding: 1px 3px;\n        border-radius: 3px;\n        font-weight: normal;\n        font-size: xx-small;\n        top: -10px;\n        left: -3px;\n        display: inline-block;\n        line-height: 1em;\n    }\n    svg {\n      width: 20px;\n      height: 20px;\n      margin-top: -2px;\n      fill: rgba(0,0,0,.5);\n      stroke: rgba(0,0,0,.5);\n    }\n    .active svg {\n      fill: rgba(0,0,0,.9);\n      stroke: rgba(0,0,0,.9);\n    }\n    .navbar {\n      padding-top: 0;\n      padding-bottom: 0;\n    }\n    nav > .container-fluid{\n      flex: 0 1 auto;\n      position: static; /* for no ofp prompt on home page bottom */\n      padding: 2px 10px 0 10px;\n      background-color: var(--bs-light);\n      flex-direction: row-reverse;\n    }\n\n    li {\n      margin-right: 0;\n      padding-left: 10px;\n    }\n    @media (min-width: 630px){\n        li {\n          margin-right: 10px;\n        }\n        :global(nav > div > div) {\n          margin-right: 0.8rem;\n        }\n    }\n    li span{\n      display: inline-block;\n    }\n    .nav-item.active {\n      border-left: 2px solid var(--bs-pink);\n    }\n    @media (min-width: 768px){\n      li {\n        padding-left: 0;\n      }\n      .nav-item.active {\n        border-bottom: 2px solid var(--bs-pink);\n        border-left: none;\n      }\n    }\n    @media (min-width: 830px){\n      :global(nav > div > div) {\n        margin-right: 1.6rem !important;\n      }\n    }\n    input:checked ~ .collapse{\n        display: block;\n    }\n    .nav-link small{\n      color: rgba(0,0,0,.4);\n    }\n    .nav-link {\n      outline-offset: -3px;\n    }\n</style>\n","<script context=\"module\">\n    import loader from './async-script-loader.js';\n    import {Deferred} from './utils.js';\n    import {generateKML, KmlGenerator} from './kml.js';\n    const pdfjsWorkerSrc = 'CONF_PDFJS_WORKER_JS';\n    const preloadFiles = [\n        { type: 'script', url: 'CONF_PDFJS_JS' },\n        { type: 'script', url: 'CONF_LIDOJS_JS' },\n        { type: 'script', url: 'CONF_PROJ4_JS' },\n        { type: 'script', url: 'CONF_WMO_JS' },\n        { type: 'script', url: 'CONF_MAPBOXGL_JS' },\n        { type: 'script', url: 'CONF_PINCHZOOM_JS'},\n        { type: 'link', url: 'CONF_MAPBOXGL_CSS'}\n    ];\n\n    const getPageText = async (pdf, pageNo) => {\n        const page = await pdf.getPage(pageNo);\n        const tokenizedText = await page.getTextContent();\n        return tokenizedText.items.map(token => token.str).join((pageNo === 1) ? \" \": \"\");\n    };\n    const getOFPText = async (source) => {\n        const pdfjsLib = window['pdfjs-dist/build/pdf'];\n        const ofpPages = [];\n        let processedPages = 0;\n        const pdf = await pdfjsLib.getDocument(source).promise;\n        const maxPages = pdf.numPages;\n        for (let pageNo = 1; pageNo <= maxPages; pageNo += 1) {\n            const pageText = await getPageText(pdf, pageNo);\n            if (pageText.includes(\"(Long copy #1)\")) {\n                ofpPages.push(pageText);\n                processedPages += 1;\n            } else if (processedPages !== 0){\n                break;\n            } else if (pageText.includes('FPL SUMMARY')) {\n                ofpPages.push(pageText); // for ETOPS\n            } else if (pageText.includes('CREW PAIRING')) {\n                ofpPages.push(pageText); // for ROSTERING and TSV\n            }\n        }\n        return ofpPages.join(\"\\n\");\n    };\n</script>\n<script>\n    import { createEventDispatcher } from 'svelte';\n    import {showGramet, ofp as ofpStore, ofpStatus, selectedAircraftType, takeOffTime} from '../stores';\n    import {aircraftTypes, discontinuatedAircraftTypes} from '../constants';\n    import {focusMap} from './utils';\n    export let kmlOptions;\n    let disabled = false;\n    let ready = new Deferred();\n    let name = \"file\";\n    let label = \"Choisir un OFP\";\n    let readyClass = false;\n    let pdfWorker;\n    const dispatch = createEventDispatcher();\n\n    function preload() {\n        loader(preloadFiles, () => !!window['pdfjs-dist/build/pdf'], () => {\n            const pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\n            pdfjsLib.GlobalWorkerOptions.workerSrc = pdfjsWorkerSrc;\n            if (!pdfWorker || pdfWorker.destroyed) {\n                    pdfWorker = new pdfjsLib.PDFWorker();\n            }\n            ready.resolve(true);\n            readyClass = true;\n        });\n    };\n    const getOFP = (file) => {\n        const reader = new FileReader();\n        return new Promise((resolve, reject) => {\n            reader.onload = (ev) => {\n                if (!pdfWorker || pdfWorker.destroyed) {\n                    const pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\n                    pdfWorker = new pdfjsLib.PDFWorker();\n                }\n                getOFPText({ data: ev.target.result, verbosity: 0, worker: pdfWorker })\n                .then(\n                    (text) => {\n                        if (text) {\n                            //console.log(text);\n                            try {\n                                //console.timeLog('start');\n                                const ofp = new editolido.Ofp(\"_PDFJS_\" + text);\n                                const wmoGrid = new editolido.GeoGridIndex();\n                                wmoGrid.data = window['WMO'];\n                                const data = editolido.ogimetData(ofp, wmoGrid);\n                                data.proxyImg = `CONF_GRAMET_PROXY`;\n                                data.route.description = data.wmo.join(' ');\n                                ofp.ogimetData = data;\n                                let sum = 0;\n                                let averageFL = ofp.infos.averageFL;\n                                const distanceMatrix = ofp.route.segments.map(([p1, p2]) => {\n                                    sum += p1.distanceTo(p2);\n                                    return [p2, sum, averageFL];\n                                });\n                                distanceMatrix.unshift([ofp.route.points[0], 0]);\n                                ofp.distanceMatrix = distanceMatrix;\n                                let timeMatrix = [];\n                                try{\n                                    timeMatrix = ofp.wptNamesEET(ofp.route.points);\n                                }catch(err){\n                                    console.error(err);\n                                }\n                                if (timeMatrix.length === 0) {\n                                    document.body.style.setProperty('--plane-halo-color', 'red');\n                                } else {\n                                    document.body.style.setProperty('--plane-halo-color', 'var(--plane-color)');\n                                }\n                                ofp.timeMatrix = timeMatrix;\n                                ofp.departure =  ofp.route.points[0];\n                                ofp.arrival = ofp.route.points[ofp.route.points.length - 1];\n\n                                //console.log(timeMatrix)\n                                //console.timeLog('start');\n                                try {\n                                    KmlGenerator();\n                                    generateKML(ofp, kmlOptions);\n                                    //console.timeEnd('start')\n                                    resolve(ofp);\n                                } catch (err) {\n                                    console.log(text);\n                                    console.log(ofp.infos);\n                                    // throw(err);\n                                    reject(err);\n                                }\n                            } catch (err) {\n                                // throw(err);\n                                console.log(text);\n                                reject(err);\n                            }\n                        } else {\n                            reject(Error(\"OFP non reconnu. Attention il y a 2 OFP dans PilotMission, il faut bien choisir celui nommé « Dossier de vol OFP ».\"));\n                        }\n                    },\n                    (err) => {\n                        reject(err);\n                    }\n                );\n            };\n            reader.onerror = (err) => { reject(Error(\"Fichier illisible !\")) };\n            reader.readAsArrayBuffer(file);\n        });\n    };\n    async function process(e) {\n        disabled = true;\n        $showGramet = false; // must be set here and not in App.svelte (why ?)\n        preload(); // in case click event not supported or missed\n\n        await ready.promise.then(() => {\n            const file = e.target.files[0];\n            const form = e.target.closest('form');\n            if (file) {\n                $ofpStatus = 'loading';\n                //label = e.target.value.split(/([\\\\/])/g).pop();\n                dispatch('change', label);\n                window.location.hash = '#/map'; //TODO must be here and not in the then promise below to avoid map centering issues. Why ?\n                getOFP(file).then((ofp) => {\n                    $ofpStore = ofp;\n                    $selectedAircraftType = undefined;\n                    $ofpStatus = 'success';\n                    $takeOffTime = new Date(ofp.infos.ofpOFF.getTime());\n                    form.blur();\n                    e.target.blur();\n                    focusMap();\n                }).catch((err) => {\n                    $ofpStatus = err;\n                    $ofpStore = undefined;\n                    console.trace(err);\n                }).finally(() => {\n                    form.reset(); \n                });\n            }\n        });\n        disabled = false;\n    };\n    async function processAircraftType(e) {\n        disabled = true;\n        $ofpStatus = 'loading';\n        preload(); // in case click event not supported or missed\n        await ready.promise.then(() => {\n            $ofpStore = undefined;\n            try {\n                KmlGenerator(); // to have a minimum skeleton for map settings\n                $selectedAircraftType = e.target.value;\n                $ofpStatus = 'success';\n            } catch (err) {\n                console.log(err);\n                $ofpStatus = err;\n            }\n            window.location.hash = '#/map';\n        });\n        disabled = false;\n    }\n    function simulateClickOnInput(e) {\n        if (e.key === \"Enter\") {\n            const input = e.target.querySelector('input[type=\"file\"]');\n            if (input) {\n                input.click();\n                return false; // preventDefault\n            }else{\n                console.error('input[type=\"file\"] not found');\n            }\n        }\n        return true;\n    }\n\n</script>\n<form class=\"form-inline\" on:submit|preventDefault>\n    {#if (!$ofpStore)}\n    <div class=\"input-group\" class:blink={!$ofpStore}>\n        <span class=\"input-group-text\">\n            <span class=\"d-block d-sm-none\">Choisir</span>\n            <span class=\"d-none d-sm-block\">Choisir un OFP</span>\n        </span>\n        <label on:keydown=\"{simulateClickOnInput}\" tabindex=\"0\" class=\"input-group-text btn btn-primary\" for=\"{name}\">\n            <span class=\"d-block d-sm-none\">OFP…</span>\n            <span class=\"d-none d-sm-block\">Sélectionner</span>\n            <input id={name} name={name} type=\"file\" accept=\"application/pdf\" on:change={process} disabled={disabled} on:click|once={preload} hidden>\n        </label>\n    </div>\n    {:else}\n        <label on:keydown=\"{simulateClickOnInput}\" tabindex=\"0\" class=\"btn btn-outline-secondary btn-sm\">\n            Changer<input id={name} name={name} type=\"file\" accept=\"application/pdf\" on:change={process} hidden>\n        </label>\n    {/if}\n    {#if !$ofpStore && !$selectedAircraftType}\n        <div class=\"footer\">\n        <!-- svelte-ignore a11y-no-onchange -->\n        <select tabindex=\"-1\" class=\"form-control-sm\" on:click|once={preload} disabled={disabled} on:change={processAircraftType}>\n            <option value=\"{undefined}\">pas d'ofp ?</option>\n            {#each aircraftTypes.filter(v => !discontinuatedAircraftTypes.includes(v)) as aircraft}\n            <option value={aircraft}>{aircraft}</option>\n            {/each}\n        </select>\n        </div>\n    {/if}\n</form>\n\n<style>\n    span.input-group-text{\n        background-color: var(--bs-white);\n        padding-right: 0.5rem;\n    }\n    label {\n        font-variant-caps: all-small-caps;\n    }\n    @media (min-width: 576px){\n        span.input-group-text {\n            padding-right: 50px;\n        }\n    }\n    .blink {\n        animation: blink 3s ease infinite;\n    }\n    @keyframes blink {\n        0% { transform: scale(1.0); }\n        75% { transform: scale(1.0); }\n        80% { transform: scale(1.03); }\n        95% { transform: scale(1.03); }\n        100% { transform: scale(1.0); }\n    }\n    .footer {\n        position: absolute;\n        right: 5px;\n        top: calc( 100vh - 41px);\n        text-align: right;\n        display: none;\n        z-index: 1;\n    }\n    @media (min-width: 768px){\n        :global(.home .footer){\n            display: block !important;\n        }\n    }\n    select {\n        background-color: var(--blueaf);\n        border-color: var(--blueaf);\n        color: rgba(255,255,255,  0.18);\n        margin: 5px;\n        appearance: none;\n        -webkit-appearance: none;\n        -moz-appearance: none;\n    }\n</style>","export default function (urls, test, callback) {\n    let remaining = urls.length\n  \n    function maybeCallback () {\n      remaining = --remaining\n      if (remaining < 1) {\n        callback()\n      }\n    }\n  \n    if (!test()) {\n      urls.forEach(({ type, url, options = { async: true, defer: true }}) => {\n        const isScript = type === 'script'\n        const tag = document.createElement(isScript ? 'script': 'link')\n        if (url.startsWith('http') || url.startsWith('//')){\n          tag.crossOrigin = \"anonymous\";\n        }\n        let onload = true\n        if (isScript) {\n          tag.src = url\n          tag.async = options.async\n          tag.defer = options.defer\n        } else {\n            tag.href = url\n            if ('prefetch' in options){\n                tag.rel = \"prefetch\"\n                remaining -= 1\n                onload = false\n            } else if ('preload' in options) {\n                tag.rel = 'preload'\n                remaining -= 1\n                onload = false\n            } else {\n                tag.rel = 'stylesheet'\n                remaining -= 1\n                onload = false\n            }\n        }\n        if (onload) tag.onload = maybeCallback\n        document.body.appendChild(tag)\n      })\n    } else {\n      callback()\n    }\n  }","<script>\n    import { fade } from \"svelte/transition\";\n    export let hidden=undefined;\n    export let maxWidth=undefined;\n    const fadeif = (node, animation, params) => {\n        if(hidden === undefined) {\n            return fade(node, animation, params);\n        }\n    }\n</script>\n\n<page in:fadeif style=\"{(maxWidth) ? `max-width: ${maxWidth}; align-self: center;` : ``}\" class:fadein={hidden===false} class:d-none={hidden===true}>\n    <slot></slot>\n</page>\n\n<style>\n    page {\n        flex: 1 1 auto;\n        display: flex;\n        flex-direction: column;\n        position: relative;\n    }\n    :global(page.fadein) {\n        display: flex;\n        animation: fade 0.4s linear;\n    }\n    @keyframes fade {\n        0%   {opacity: 0}\n        100% {opacity: 100}\n    }\n</style>","<script context=\"module\">\n    import {writable} from 'svelte/store';\n    import {swDismiss, swUpdated, majorUpdate, previousAppVersionKey} from '../stores';\n    import {isPatchUpdate} from '../components/utils';\n    export const swRegistration = writable();\n\n    export const showSkipWaitingPrompt = (nextVersion) => {\n        swUpdated.set(true);\n        swDismiss.set(false);\n        if (nextVersion) {\n            majorUpdate.set(!isPatchUpdate('APP_VERSION', nextVersion));\n        } else {\n            majorUpdate.set(true); // we consider missing version problem as major\n        }\n    };\n</script>\n<script>\n    import {wb, route} from '../stores';\n    import { fade } from 'svelte/transition';\n    import ChangeLogModal, {showChangelogOnUdate, getPreviousAppVersion, setPreviousAppVersion} from './ChangeLogModal.svelte';\n    import {semverCompare} from './utils'; \n    let installLabel = 'Installer';\n    const isAppUpdated = () => {\n        const previous = getPreviousAppVersion();\n        if (!previous) return false;\n        return semverCompare('APP_VERSION', previous) > 0;\n    }\n\n    $swDismiss = false;\n    export let prompt = false;\n    \n    $: showChangeLog = isAppUpdated($swUpdated) && showChangelogOnUdate($swUpdated);\n    const install = (delay=0) => {\n        if (delay) console.debug('automatic install ')\n        // $swRegistration.waiting check is needed to the 'reload the page' fallback\n        let refreshing;\n        if ($wb && $swRegistration && $swRegistration.waiting) {\n            navigator.serviceWorker.addEventListener('controllerchange', () => {\n                //console.debug('controller change')\n                if (refreshing) return;\n                refreshing = true;\n                console.debug('SWUpdate: controllerchange reload');\n                (delay) ? setTimeout(() => window.location.reload(), delay) : window.location.reload();\n            });\n            //This does not fire when Workbox mark event as isExternal (note should be fixed now in v6.2)\n            // $wb.addEventListener('controlling', () => {\n            //     //console.debug('controlling')\n            //     if (refreshing) return;\n            //     refreshing = true;\n            //     console.debug('SWUpdate: controlling reload');\n            //     window.location.reload();\n            //     (delay) ? setTimeout(() => window.location.reload(), delay) : window.location.reload();\n            // });\n            installLabel = \"En cours...\";\n            // only set if not already set (cover multiple updates loop)\n            if (!getPreviousAppVersion()) {\n                setPreviousAppVersion();\n            }\n            $swRegistration.waiting.postMessage({type: 'SKIP_WAITING'});\n            console.debug('SWUpdate: SKIP_WAITING sent');\n            // in a scenario where you dismiss update and manually reload the page we need a fallback\n            setTimeout(() => {\n                console.debug('SWUpdate: fallback reload');\n                window.location.reload();\n            }, 5000);//secure a reload after 5s\n        }else{ /* update probably done in another tab */\n            console.log($wb, $swRegistration, $swRegistration.waiting);\n            console.debug('SWUpdate: no waiting reg reload');\n            window.location.reload();\n        }\n    }\n</script>\n\n{#if (($swUpdated && !$swDismiss && !prompt))}\n<div class=\"modal\" tabindex=\"-1\">\n    <div class=\"modal-dialog\" style=\"margin-top: 15%; max-width: 270px;\">\n        <div class=\"modal-content\">\n            <h6 class=\"modal-header text-center\">\n                <span class=\"modal-title\"><span>👨🏻‍✈️</span> Mise à jour détectée</span>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" on:click={() => $swDismiss=true}></button>\n            </h6>\n            <div class=\"modal-body text-center\">\n                <button class=\"btn\" type=\"button\" on:click|preventDefault><span>Mise à jour...</span></button>\n            </div>\n        </div>\n    </div>\n</div>{install(700) || ''}\n{:else if $swUpdated && !$swDismiss}\n    <div class=\"modal\" transition:fade tabindex=\"-1\">\n        <div class=\"modal-dialog\" transition:fade style=\"position: absolute; top:0; right: 1rem; max-width: 350px;\">\n            <div class=\"modal-content\">\n                <h6 class=\"modal-header pt-2 pb-2\">\n                    <span class=\"modal-title text-center\"><span>👨🏻‍✈️</span> Mise à jour disponible</span>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\" on:click={() => $swDismiss=true}></button>\n                </h6>\n                <div class=\"modal-body text-center\">\n                    <p>Il faudra recharger l'OFP</p>\n                    <button class=\"btn btn-primary\" type=\"button\" on:click|once={() => install()}><span class:blinking={installLabel.endsWith('...')}>{installLabel}</span></button>\n                </div>\n            </div>\n        </div>\n    </div>\n{:else if showChangeLog && !$swUpdated && $route !== \"/install\"}\n    <ChangeLogModal version={getPreviousAppVersion()} title=\"NOUVEAUTÉS\"/>\n{/if}\n\n<style>\n    /* The Modal (background) */\n    .modal {\n        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */\n        display:block;\n    }\n    .modal-header {\n        background-color: var(--bs-light);\n        padding-top: 0.5rem;\n        padding-bottom: 0.5rem;\n    }\n    .blinking{\n        animation:blink 1s infinite;\n    }\n    @keyframes blink \n    {  \n        0% { opacity: 1.0; }\n        50% { opacity: 0.0; }\n        100% { opacity: 1.0; }\n    }\n</style>","<script>\n    import Logo from './Logo.svelte';\n    import SWUpdate from './SWUpdate.svelte';\n    import {usingChromeOnIOS, usingSafari} from './utils';\n    const requiredNavigator =  usingSafari && !usingChromeOnIOS;\n</script>\n\n<Logo/>\n<div class=\"prompt-container\">\n    <div class=\"prompt\">\n        <div class=\"icon-container\">\n            <img src=\"./images/ofp2map-icons/icon-128x128.png\" alt=\"OFP2MAP\">\n        </div>\n        <div class=\"prompt-content\">\n            <h3 class=\"title\">Installez OFP2MAP</h3>\n            <p class=\"text\">Si OFP2MAP est déjà sur l'écran d'accueil, ne l'installez pas une deuxième fois. <b>Attention:</b> l'installation ne peut se faire que depuis\n                le navigateur Safari, <b>si présent, cliquez sur <svg class=\"safari\"><use xlink:href=\"#safari-symbol\"/></svg> en haut à droite</b>.\n            </p>\n            {#if !requiredNavigator}\n                <p class=\"guide error\">Merci d'ouvrir cette page dans Safari</p>\n            {:else}\n                <ol class=\"guide\">\n                    <li>Dans la barre de menu, cliquez sur <svg><use xlink:href=\"#share-symbol\" /></svg></li>\n                    <li>Faites défiler, choisir&#8239;: <em>Sur l'écran d'accueil</em> <svg style=\"width:22px;height:22px;\"><use xlink:href=\"#add2home-symbol\" /></svg></li>\n                    <li>Lancez l'application depuis l'écran d'accueil</li>\n                </ol>\n            {/if}\n        </div>\n    </div>\n</div>\n<SWUpdate/>\n<style>\n    .prompt-container {\n        align-items: center;\n        box-sizing: border-box;\n        display: flex;\n        height: 100%;\n        justify-content: center;\n        padding: 30px;\n        position: fixed;\n        width: 100%;\n        margin-top: 3em;\n    }\n    .prompt{\n        background: #FFF;\n        border-radius: 2px;\n        box-shadow: 0 4px 8px rgba(0,0,0,0.125);\n        box-sizing: border-box;\n        color: #424242;\n        font-family: sans-serif;\n        max-width: 640px;\n        position: relative;\n        text-align: center;\n        z-index: 1;\n    }\n    .icon-container{\n        background: url(\"data:image/svg+xml,%3Csvg viewBox='0 0 70 70' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%23F0F0F0' d='M65,17C65,10.377 59.623,5 53,5L17,5C10.377,5 5,10.377 5,17L5,53C5,59.623 10.377,65 17,65L53,65C59.623,65 65,59.623 65,53L65,17Z' /%3E%3C/svg%3E%0A\") center center / 70px 70px repeat-x;\n        margin: 40px 0 0;\n    }\n    .icon-container img {\n        border-radius: 12px;\n        display: block;\n        margin: 0 auto;\n        width: 64px;\n    }\n    .prompt-content{\n        padding: 10px 35px;\n    }\n    h3 {\n        font-size: 24px;\n    }\n    .text{\n        font-size: 14px;\n        line-height: 20px;\n        margin: 0 0 1em;\n        text-align: justify;\n    }\n    .guide{\n        display: flex;\n        font-size: 16px;\n        justify-content: center;\n        margin: 0;\n        line-height: 35px;\n        text-align: left;\n        flex-direction: column;\n    }\n    .guide.error{\n        font-weight: 600;\n        color: red;\n    }\n    svg{\n        margin: 0 0 5px;\n        width: 30px;\n        height: 30px;\n        color: #007AFF;\n    }\n    svg.safari {\n        width: 20px;\n        height: 20px;\n    }\n    ol {\n        list-style: none;\n        counter-reset: guide-counter;\n        margin-left: 60px !important;\n    }\n    ol li {\n        counter-increment: guide-counter;\n        text-align: left;\n    }\n    ol li::before {\n        content: counter(guide-counter);\n        color: var(--blueaf);\n        font-weight: bold;\n        font-size: large;\n        margin-right: 10px;\n    }\n\n</style>\n","<script>\n  import {onMount} from 'svelte';\n  import LidoRoute from \"./components/LidoRoute.svelte\";\n  import Export from \"./components/Export.svelte\";\n  import Home from \"./components/Home.svelte\";\n  import Map from \"./components/Map.svelte\";\n  import Navbar from \"./components/Navbar.svelte\";\n  import OfpInput from './components/OfpInput.svelte';\n  import Page from \"./components/Page.svelte\";\n  import Help, {helpRouteRegex} from \"./components/Help.svelte\";\n  import SWUpdate from \"./components/SWUpdate.svelte\";\n  import {storage, stores, validate, setHistory, storeSettingsFromURL} from \"./components/mapSettings/storage.js\";\n  import {swDismiss, sidebar, route, checkSwOnVisibilityChange, ofp, ofpStatus, aircraftType} from \"./stores.js\";\n  import HomePwaInstall from './components/HomePwaInstall.svelte';\n  import {runningOnIpad} from './components/utils';\n\n  const redirect = (requestedRoute) => {\n    console.log(`unknown route ${requestedRoute}, redirecting to #/`, !!$ofp, $ofpStatus);\n    window.location.hash = '#/';\n  }\n\n  if (storage.getItem(stores.optionsKML) === null) storeSettingsFromURL(window.location.search);\n  let kmlOptions = validate(storage.getItem(stores.optionsKML) || {}); //include default\n  setHistory(kmlOptions, $route);\n\n  const ofpChange = () =>{\n    $sidebar = false;\n    $swDismiss = false;\n    //$showGramet = false; // this one is set in OfpInput instead\n  };\n  $: isHelpRoute = helpRouteRegex.test($route); // needed because in scenario: reload, go to help, load ofp, svelte shows both map and help....\n\n  onMount(() => {\n        document.addEventListener(\"visibilitychange\", checkSwOnVisibilityChange, false);\n        return () => document.removeEventListener(\"visibilitychange\", checkSwOnVisibilityChange);\n  });\n</script>\n\n<main class=\"container {$route.substr(1) || 'home'}\">\n  <div class=\"content\">\n    {#if ($route === '/install' || (navigator && navigator.standalone === false && runningOnIpad))}\n      <HomePwaInstall/>\n    {:else}\n      <Navbar>\n        <OfpInput {kmlOptions} on:change={ofpChange} />\n      </Navbar>\n      <SWUpdate prompt={!!$ofp}/>\n      {#if ($ofp || $aircraftType) && $ofpStatus === 'success'}\n        <Page hidden={$route !== '/map'}>\n          <Map id=\"map\" bind:kmlOptions ofp={$ofp} on:save={() => setHistory(kmlOptions, $route)}/>\n        </Page>\n      {/if}\n\n      {#if ($ofpStatus === 'loading')}\n        <Page><div style=\"margin: auto;\">traitement en cours...</div></Page>\n      {:else if $ofpStatus && $ofpStatus !== 'success' && $route === '/map'}\n        <Page><p class=\"ofpError\">😱: {$ofpStatus}</p></Page>\n      {:else if ($route === '/export') && $ofpStatus === 'success'}\n        <Page maxWidth=\"1400px\">\n          <Export {kmlOptions} on:save={() => setHistory(kmlOptions, $route)} />\n          <LidoRoute />\n        </Page>\n      {:else if $route === '/'}\n        <Page maxWidth=\"1400px\">\n          <Home />\n        </Page>\n      {:else if isHelpRoute}\n        <Page  maxWidth=\"1400px\"><Help /></Page>\n      {:else if !(($ofp || $aircraftType) && $route === '/map')}\n        <!-- redirect -->\n        { redirect($route) || ''}\n      {/if}\n    {/if}\n  </div>\n</main>\n\n<style>\n  :global(html, body) {\n    height: 100%;\n    min-height: 100%;\n    width: 100%;\n    position: fixed;\n    --blueaf: #002157; /* --royal-blue-dark */\n    --blueaf_rgb: 9,34,84; /* rgba(var(--blueaf_rgb), 0.5) is valid */\n    --redaf:#FA3C35; /* --tart-orange */\n    --blood-red: #6B0504; /* for visited links */\n    /*--green: #2CA58D; /* #28a745 */;\n    --snow: #FFFBFF;\n    --minion-yellow: #ECD444;\n    --light-grey: #eee; /* used to print tables */\n    --maximum-yellow-red: #FCBF49; /* used for warnings in LogWindow */\n    --electric-blue: #87F1FF;\n    --gramet-inner-height: 384px;\n    --plane-color: var(--bs-yellow);\n    --plane-halo-color: var(--plane-color);\n    --bs4-cyan: #17a2b8;\n    --bs4-info: #17a2b8;\n  }\n  .content{\n    background-color: var(--blueaf);\n    /*noinspection CssUnknownTarget*/background-image: url(\"../svg/worldmap.svg\");\n    background-attachment: fixed;\n    background-size: cover;\n    transition:background-position 0.3s ease;\n    width: 100%;\n    padding: 0;\n    flex-direction: column;\n    display: flex;\n    min-height: 100vh;\n    min-width: 100vw;\n  }\n  main.map > .content {\n    background-color: var(--bs-white);\n    background-image: none;\n  }\n  main.help >.content {\n    background-position-x: center;\n  }\n  main {\n    display: flex;\n    margin-left: 0;\n    margin-right: 0;\n    padding-left: 0;\n    padding-right: 0;\n    overflow-x: hidden;\n    max-width: 100%;\n    min-height: 100%;\n    position: relative;\n  }\n  @media (max-width: 992px), (max-height: 575px)  { /* allow scrolling long pages */\n    :global(html, body) {\n      position: relative;\n    }\n    main.home, main.gramet, main.export {\n      display:block;\n    }\n  }\n  @media (min-width: 1400px) {\n    main {\n      width: 100%;\n      margin-right: auto;\n      margin-left: auto;\n    }\n  }\n  .form-inline {\n    padding-bottom: 2px;\n  }\n  :global(.btn) {\n    text-transform: uppercase\n  }\n  :global(.form-control, .mapboxgl-ctrl-attrib, .btn, aside h2) {\n    user-select: none; /* supported by Chrome and Opera */\n    -webkit-user-select: none; /* Safari */\n    -moz-user-select: none; /* Firefox */\n    touch-action: manipulation;\n  }\n  .ofpError {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-grow: 1;\n    background-color: var(--snow);\n  }\n  :global(.table td){\n        padding: 0.5rem 0.75rem;\n  }\n  :global(label.input-group-text, label.form-control,.input-group-sm >.btn) {\n    font-variant-caps: all-small-caps;\n  }\n  @media (hover:none) {\n    /* suppress hover effect on devices that don't support hover fully */\n    :global(.focusmode .btn-outline-info:hover,.focusmode .btn-outline-info:active) {\n      color: var(--bs-info);\n      background-color: white;\n    }\n    :global(.mapboxgl-ctrl button.mapboxgl-ctrl-layers:not(:disabled):hover){\n      background-color: transparent;\n    }\n    :global(.btn-outline-secondary:not(:disabled):hover, .btn-outline-secondary:active){\n      background-color: transparent;\n      color: var(--bs-secondary);\n    }\n  }\n  :global(a) {\n    text-decoration: none;\n  }\n  :global(a:hover){\n    text-decoration: underline;\n  }\n  :global(.overlay .card-header) {\n    display:flex;\n    align-items: center;\n    padding: .5rem .75rem\n  }\n  :global(.overlay .card-body) {\n    padding: .5rem .75rem;\n    font-size: 0.875rem;\n  }\n  :global(.text-small-caps) {\n    font-variant-caps: all-small-caps !important;\n  }\n  :global(svg.user-location-estimate){\n    color: var(--plane-color);\n  }\n  :global(svg.user-location-gps){\n    color: #1da1f2;\n  }\n  :global(.big){\n    font-size: larger;\n    font-weight: bolder;\n  }\n\n</style>\n","try{self[\"workbox:window:6.2.4\"]&&_()}catch(n){}function n(n,t){return new Promise((function(r){var e=new MessageChannel;e.port1.onmessage=function(n){r(n.data)},n.postMessage(t,[e.port2])}))}function t(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,\"value\"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}function r(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}function e(n,t){var e;if(\"undefined\"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(e=function(n,t){if(n){if(\"string\"==typeof n)return r(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return\"Object\"===e&&n.constructor&&(e=n.constructor.name),\"Map\"===e||\"Set\"===e?Array.from(n):\"Arguments\"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(n,t):void 0}}(n))||t&&n&&\"number\"==typeof n.length){e&&(n=e);var i=0;return function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}return(e=n[Symbol.iterator]()).next.bind(e)}try{self[\"workbox:core:6.2.4\"]&&_()}catch(n){}var i=function(){var n=this;this.promise=new Promise((function(t,r){n.resolve=t,n.reject=r}))};function o(n,t){var r=location.href;return new URL(n,r).href===new URL(t,r).href}var u=function(n,t){this.type=n,Object.assign(this,t)};function a(n,t,r){return r?t?t(n):n:(n&&n.then||(n=Promise.resolve(n)),t?n.then(t):n)}function c(){}var f={type:\"SKIP_WAITING\"};function s(n,t){if(!t)return n&&n.then?n.then(c):Promise.resolve()}var v=function(r){var e,c;function v(n,t){var e,c;return void 0===t&&(t={}),(e=r.call(this)||this).nn={},e.tn=0,e.rn=new i,e.en=new i,e.on=new i,e.un=0,e.an=new Set,e.cn=function(){var n=e.fn,t=n.installing;e.tn>0||!o(t.scriptURL,e.sn.toString())||performance.now()>e.un+6e4?(e.vn=t,n.removeEventListener(\"updatefound\",e.cn)):(e.hn=t,e.an.add(t),e.rn.resolve(t)),++e.tn,t.addEventListener(\"statechange\",e.ln)},e.ln=function(n){var t=e.fn,r=n.target,i=r.state,o=r===e.vn,a={sw:r,isExternal:o,originalEvent:n};!o&&e.mn&&(a.isUpdate=!0),e.dispatchEvent(new u(i,a)),\"installed\"===i?e.wn=self.setTimeout((function(){\"installed\"===i&&t.waiting===r&&e.dispatchEvent(new u(\"waiting\",a))}),200):\"activating\"===i&&(clearTimeout(e.wn),o||e.en.resolve(r))},e.dn=function(n){var t=e.hn,r=t!==navigator.serviceWorker.controller;e.dispatchEvent(new u(\"controlling\",{isExternal:r,originalEvent:n,sw:t,isUpdate:e.mn})),r||e.on.resolve(t)},e.gn=(c=function(n){var t=n.data,r=n.ports,i=n.source;return a(e.getSW(),(function(){e.an.has(i)&&e.dispatchEvent(new u(\"message\",{data:t,originalEvent:n,ports:r,sw:i}))}))},function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{return Promise.resolve(c.apply(this,n))}catch(n){return Promise.reject(n)}}),e.sn=n,e.nn=t,navigator.serviceWorker.addEventListener(\"message\",e.gn),e}c=r,(e=v).prototype=Object.create(c.prototype),e.prototype.constructor=e,e.__proto__=c;var h,l,m,w=v.prototype;return w.register=function(n){var t=(void 0===n?{}:n).immediate,r=void 0!==t&&t;try{var e=this;return function(n,t){var r=n();if(r&&r.then)return r.then(t);return t(r)}((function(){if(!r&&\"complete\"!==document.readyState)return s(new Promise((function(n){return window.addEventListener(\"load\",n)})))}),(function(){return e.mn=Boolean(navigator.serviceWorker.controller),e.yn=e.pn(),a(e.bn(),(function(n){e.fn=n,e.yn&&(e.hn=e.yn,e.en.resolve(e.yn),e.on.resolve(e.yn),e.yn.addEventListener(\"statechange\",e.ln,{once:!0}));var t=e.fn.waiting;return t&&o(t.scriptURL,e.sn.toString())&&(e.hn=t,Promise.resolve().then((function(){e.dispatchEvent(new u(\"waiting\",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),e.hn&&(e.rn.resolve(e.hn),e.an.add(e.hn)),e.fn.addEventListener(\"updatefound\",e.cn),navigator.serviceWorker.addEventListener(\"controllerchange\",e.dn),e.fn}))}))}catch(n){return Promise.reject(n)}},w.update=function(){try{return this.fn?s(this.fn.update()):void 0}catch(n){return Promise.reject(n)}},w.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},w.messageSW=function(t){try{return a(this.getSW(),(function(r){return n(r,t)}))}catch(n){return Promise.reject(n)}},w.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&n(this.fn.waiting,f)},w.pn=function(){var n=navigator.serviceWorker.controller;return n&&o(n.scriptURL,this.sn.toString())?n:void 0},w.bn=function(){try{var n=this;return function(n,t){try{var r=n()}catch(n){return t(n)}if(r&&r.then)return r.then(void 0,t);return r}((function(){return a(navigator.serviceWorker.register(n.sn,n.nn),(function(t){return n.un=performance.now(),t}))}),(function(n){throw n}))}catch(n){return Promise.reject(n)}},h=v,(l=[{key:\"active\",get:function(){return this.en.promise}},{key:\"controlling\",get:function(){return this.on.promise}}])&&t(h.prototype,l),m&&t(h,m),v}(function(){function n(){this.Pn=new Map}var t=n.prototype;return t.addEventListener=function(n,t){this.Sn(n).add(t)},t.removeEventListener=function(n,t){this.Sn(n).delete(t)},t.dispatchEvent=function(n){n.target=this;for(var t,r=e(this.Sn(n.type));!(t=r()).done;){(0,t.value)(n)}},t.Sn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},n}());export{v as Workbox,n as messageSW};\n//# sourceMappingURL=workbox-window.prod.es5.mjs.map\n","import App from './App.svelte';\nimport {Workbox, messageSW} from 'workbox-window';\nimport {showSkipWaitingPrompt, swRegistration} from './components/SWUpdate.svelte';\nimport {promiseTimeout} from './components/utils';\nimport {wb} from './stores';\n\nlet app;\nlet appError = false;\nconst name = 'OFP2MAP';\ntry {\n    app = new App({\n        target: document.body\n    });\n}catch(err) {\n    appError = true;\n    try {\n        var content = document.createElement(\"p\");\n        content.innerHTML =('Erreur: ' + err.message + '<br/><br/>'\n            + name + ' a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />'\n            + 'Contactez moi sur l\\'email AF (erdelord@...) en me donnant le message d\\'erreur.'\n        );\n        document.body.appendChild(content);\n    // eslint-disable-next-line no-empty\n    }catch(e){} /* catch all here we can not interrupt the startup sequence */ \n}finally{\n    // we always register the serviceWorker to be able to unregister it\n    // or to force skipWaiting and page reload\n    // this way as soon as a new serviceWorker fix the problem, the page will load\n    if ('serviceWorker' in navigator) {\n        const workbox = new Workbox('./sw.js');\n        wb.set(workbox);\n        workbox.addEventListener('installed', (event) => {\n            if (!event.isUpdate) {\n                //console.log('Service worker installed for the first time!');\n            }else{\n                //console.log('Updated Service worker installed');\n            }\n            //console.debug('Updated Service worker installed ', event.isUpdate, event.isExternal)\n        });\n        workbox.addEventListener('activated', (event) => {\n            // `event.isUpdate` will be true if another version of the service\n            // worker was controlling the page when this version was registered.\n            if (!event.isUpdate) {\n                //console.log('Service worker activated for the first time!');\n                // If your service worker is configured to precache assets, those\n                // assets should all be available now.\n                // we should be able to remove clients.claim call in sw.js\n                // but for now we have both...\n                workbox.messageSW({ type: 'CLIENTS_CLAIM' });\n            }else{\n                //console.log('Updated Service worker activated');\n            }\n            if (event.isExternal) {\n                console.warn('External Service worker activated');\n                //window.location.reload();\n            }\n        });\n        workbox.addEventListener('waiting', (event) => {\n            //console.log(`A new service worker has installed, but it can't activate` +\n            //    ` until all tabs running the current version have fully unloaded.`);\n            if (appError) {\n                workbox.addEventListener('controlling', () => {\n                    console.warn('main.js: appError reload');\n                    window.location.reload();\n                });\n                workbox.messageSkipWaiting();\n            }else{\n                if (event.isExternal) {\n                    console.warn('External Service worker waiting');\n                }\n                promiseTimeout(400, messageSW(event.sw,{type: 'GET_VERSION'}))\n                .then(v => showSkipWaitingPrompt(v))\n                .catch(e => {\n                    console.warn(\"SW GET_VERSION:\", e);\n                    showSkipWaitingPrompt();\n                });\n            }\n        });\n        workbox.register().then(reg => {\n            if (appError && reg) reg.unregister();\n            swRegistration.set(reg);\n            //console.debug(reg);\n        }, console.error);\n    }\n}\n\nexport default app;"],"names":["noop","identity","x","assign","tar","src","k","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","src_url_equal","element_src","url","document","createElement","href","subscribe","store","callbacks","unsub","unsubscribe","get_store_value","value","_","component_subscribe","component","callback","$$","on_destroy","push","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","slice","get_slot_changes","dirty","lets","undefined","merged","len","Math","max","length","i","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","p","get_all_dirty_from_scope","exclude_internal_props","props","result","compute_rest_props","keys","rest","Set","has","null_to_empty","set_store_value","ret","set","action_destroyer","action_result","destroy","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","run_tasks","task","c","delete","f","size","loop","promise","Promise","fulfill","add","abort","append","target","node","appendChild","get_root_for_style","root","getRootNode","ownerDocument","host","append_empty_stylesheet","style_element","element","style","head","append_stylesheet","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","d","name","svg_element","createElementNS","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","prevent_default","preventDefault","call","this","attr","attribute","removeAttribute","getAttribute","setAttribute","set_attributes","attributes","descriptors","getOwnPropertyDescriptors","__proto__","key","cssText","xlink_attr","setAttributeNS","to_number","set_data","wholeText","set_input_value","input","set_style","important","setProperty","select_option","select","option","__value","selected","select_value","selected_option","querySelector","crossorigin","is_crossorigin","parent","error","toggle_class","toggle","classList","custom_event","type","detail","bubbles","e","createEvent","initCustomEvent","active_docs","current_component","active","create_rule","duration","delay","ease","uid","step","keyframes","t","rule","str","hash","charCodeAt","doc","stylesheet","__svelte_stylesheet","sheet","current_rules","__svelte_rules","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","deleteRule","clear","set_current_component","get_current_component","Error","onMount","on_mount","onDestroy","createEventDispatcher","bubble","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","resolve","update_scheduled","schedule_update","then","flush","tick","add_render_callback","add_flush_callback","flushing","seen_callbacks","update","pop","fragment","before_update","after_update","wait","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","null_transition","create_in_transition","params","animation_name","config","running","cleanup","go","easing","css","start_time","end_time","started","start","invalidate","end","create_bidirectional_transition","intro","running_program","pending_program","clear_animation","init","program","abs","group","handle_promise","info","token","index","resolved","child_ctx","current","needs_flush","blocks","m","mount","catch","hasCatch","pending","globals","globalThis","global","destroy_block","lookup","update_keyed_each","old_blocks","get_key","dynamic","list","create_each_block","get_context","n","old_indexes","new_blocks","new_lookup","Map","deltas","get","will_move","did_move","first","new_block","old_block","new_key","old_key","bind","bound","create_component","mount_component","customElement","new_on_destroy","map","destroy_component","instance","create_fragment","not_equal","append_styles","parent_component","on_disconnect","context","skip_bound","ready","fill","make_dirty","hydrate","nodes","Array","from","childNodes","children","l","SvelteComponent","$destroy","$on","splice","$set","$$props","obj","$$set","Deferred","constructor","reject","runningOnIpad","navigator","platform","maxTouchPoints","usingChromeOnIOS","test","userAgent","usingSafari","debounce","func","immediate","timeout","args","arguments","later","apply","callNow","clearTimeout","setTimeout","folderName","clamp","num","min","isInside","intersect","edge","bbox","bitCode","code","promiseTimeout","ms","id","race","matchMedia","matches","semverCompare","pa","pb","na","Number","nb","isNaN","shareAppLink","async","shareData","title","location","pathname","share","err","binarysearch","sortedArray","condition","ans","mid","trunc","focusMap","evenIfHidden","canvas","focus","cubicOut","fade","linear","getComputedStyle","opacity","fly","y","target_opacity","transform","od","u","slide","height","parseFloat","padding_top","paddingTop","padding_bottom","paddingBottom","margin_top","marginTop","margin_bottom","marginBottom","border_top_width","borderTopWidth","border_bottom_width","borderBottomWidth","subscriber_queue","readable","writable","stop","subscribers","new_value","run_queue","subscriber","derived","stores","initial_value","single","isArray","stores_array","auto","inited","values","sync","unsubscribers","aircraftTypes","discontinuatedAircraftTypes","previousAppVersionKey","wb","swDismiss","swUpdated","majorUpdate","sidebar","focusMode","showGramet","showPlaneOnMap","resetValue","reset","resetable","mapZoom","simulate","ofp","ofpStatus","takeOffTime","landingTime","$ofp","$takeOffTime","timeMatrix","getTime","infos","flightTime","selectedAircraftType","aircraftType","$selectedAircraftType","aircraft","swLastUpdateDate","checkSWUpdate","serviceWorker","getRegistration","reg","waiting","console","checkSwOnVisibilityChange","visibilityState","visible","changeVisibleState","online","update_network_status","onLine","route","hashchange","meta","metaContent","substr","replace","$route","startsWith","flightProgress","$simulate","$showPlaneOnMap","$visible","interval","frequency","setValue","clearInterval","setInterval","takeOff","landing","computePosition","pos","position","$flightProgress","latitude","longitude","gramet","fl","reltime","distanceMatrix","firstPoint","lastPoint","routeDistance","firstFL","lastFL","posTime","sum","segmentLength","fraction","atFraction","posDistance","copyPermission","permissions","query","state","areaDom","valueCopy","lidoRoute","timeOut","copied","success","clipboard","writeText","execCommand","copyText","kmlExportDefaultOptions","routeDisplay","routePin","routeColor","alternateDisplay","alternatePin","alternateColor","natDisplay","natPin","natColor","greatCircleDisplay","greatCircleColor","skeleton","kmlGen","kmlOptions","addFolders","enabled","color","pinId","natIncompleteColor","KmlGenerator","editolido","KMLGenerator","updateKml","endsWith","folder","changeFolderState","changeFolderPin","changeFolderColor","toUpperCase","label","swatchStyle","pickerStyle","kmlRegex","kml2mapColor","v","hex","range","kml2swatch","defaultSwatch","parseInt","g","swatch","kmlColor","colorName","pinName","debounceDispatch","toString","blur","kmlDefaultOptions","natPinPosition","ogimetDisplay","ogimetColor","airportDisplay","airportPin","airportLabel","firDisplay","firHide","etopsDisplay","etopsColor","iconTextChange","lineWidthChange","iconSizeChange","freeze","optionsKML","shortcut","downloadType","exportKML","focusKML","changelogOnUpdate","storage","getItem","localStorage","JSON","parse","removeItem","setItem","toSave","stringify","hasItem","validate","defaultOptions","validated","entries","match","toFixed","trim","setHistory","includedStores","includes","diff","encodeURIComponent","permalink","origin","history","replaceState","defaultValue","shortcutName","disabled","kml","render","kmlAvenza","template","avenzaTemplate","styleTemplate","avenzaStyleTemplate","iconTemplate","avenzaIconTemplate","icons","AVENZAICONS","kmlGoogleEarth","googleEarthStyleTemplate","grametProxyURL","ogimetData","proxyImg","blurAction","handleVisibilityChange","optionColors","cssRoot","filename","setCssColor","blobURL","blob","Blob","URL","createObjectURL","revokeObjectURL","extension","checked","displayName","labels","STATUS","ICAO","selectedPin","selectedLabel","decimals","previousValue","clickOutside","handleClick","contains","defaultPrevented","CustomEvent","jsonPoint","lngLat","properties","geometry","coordinates","featureCollection","features","jsonLine","haloLightColor","haloTextBlur","ratio","extraFactor","textSize","computeIconTextSize","haloTextWidth","getContrastColor","opacityProperty","R","G","B","splitKmlColor","computeIconSize","computeLineWidthSize","getIconSizeExpression","iconSize","getIconColorExpression","overrideColor","getTextColorExpression","getOpacityColorExpression","overrideOpacity","minOpacity","getTextKmlColorExpression","kmlcolor","overrideKmlColor","getOpacityKmlColorExpression","addPoints","affine","minZoom","maxZoom","prefix","folder2prefix","visibility","addSource","lngLats","newPair","geoPoints2LngLats","geoPoint","addLayer","markerLayer","addLine","affineLine","lineWidth","dashes","lineLayer","addLines","results","line","sublines","sublen","subline","ar","interpolateTextSize","magnification","hexcolor","source","layout","paint","changeIconSizeGeneric","getLayer","setLayoutProperty","changeIconTextGeneric","mapOptions","interpolateMinZoom","mapboxOptions","interpolateMaxZoom","changeLineWidthGeneric","setPaintProperty","changeLineGeneric","iconImageExpression","getLayoutProperty","iconImage","changeDisplayGeneric","ogimetMapIdCondition","show","hide","mapData","affineAndClip","points","changeLine","changeLineWidth","firMapIdCondition","orangeStripeLayer","redStripeLayer","layers","changeFirDisplay","layer","fetch","response","json","greatCircleMapIdCondition","routeName","depICAO","destICAO","greatCircle","Route","dashToCamelCase","camelCaseToDash","toLowerCase","compare","obj1","obj2","focusOptions","focusBackup","focusStore","storedOptions","focusOptionsDefault","reduce","updateAll","hasChange","endFocusMode","$focusMode","isDefault","isChanged","isFocusDefault","hideOnThisProjection","$sidebar","projections","sort","exportOptions","allowedOptions","allowedMapOptions","isLikeMap","standalone","isoCountries","NY","TY","AF","AX","AL","DZ","AS","AD","AO","AI","AQ","AG","AR","AM","AW","AU","AT","AZ","BS","BH","BD","BB","BY","BE","BQ","BZ","BJ","BM","BT","BO","BA","BW","BV","BR","IO","BN","BG","BF","BI","KH","CM","CA","CV","KY","CF","TD","CL","CN","CX","CC","CO","CW","KM","CG","CD","CK","CR","CI","HR","CU","CY","CZ","DK","DJ","DM","DO","EC","EG","SV","GQ","ER","EE","ET","FK","FO","FJ","FI","FR","GF","PF","TF","GA","GM","GE","DE","GH","GI","GR","GL","GD","GP","GU","GT","GG","GN","GW","GY","HT","HM","VA","HN","HK","HU","IS","IN","ID","IR","IQ","IE","IM","IL","IT","JM","JP","JE","JO","KZ","KE","KI","KR","KW","KG","LA","LV","LB","LS","LR","LY","LI","LT","LU","MO","MK","MG","MW","MY","MV","ML","MT","MH","MQ","MR","MU","YT","MX","FM","MD","MC","MN","ME","MS","MA","MZ","MM","NA","NR","NP","NL","AN","NC","NZ","NI","NE","NG","NU","NF","MP","NO","OM","PK","PW","PS","PA","PG","PY","PE","PH","PN","PL","PT","PR","QA","RE","RO","RU","RW","BL","SH","KN","LC","MF","PM","VC","WS","SM","ST","SA","SN","RS","SC","SL","SG","SK","SI","SB","SO","SX","ZA","GS","ES","LK","SD","SR","SJ","SZ","SE","CH","SY","TW","TJ","TZ","TH","TL","TG","TK","TO","TT","TN","TR","TM","TC","TV","UG","UA","AE","GB","US","UM","UY","UZ","VU","VE","VN","VG","VI","WF","EH","XK","YE","ZM","ZW","adequateLayer","emergencyLayer","etopsLayer","MEDICAL_COLOR","TEXT_COLOR","getEtopsNames","raltNames","ralts","epNames","concat","medicalCondition","levelCondition","level","level0Condition","adequateCondition","raltCondition","airportLabeller","labelling","medicalFormatter","adequateFilter","etopsFilter","etopsNames","isEtops","emergencyFilter","adequateSymbolSortKey","departure","arrival","adequateIconColorMap","adequateIconColor","etopsIconColor","interpolateIconSize","adequateIconSize","iconRatio","etopsIconSize","emergencyIconSize","adequateIconHaloWidth","etopsIconHaloWidth","adequateIconHaloColor","etopsIconHaloColor","adequateTextColor","etopsTextColor","adequateTextField","etopsTextField","emergencyTextField","adequateTextSize","etopsTextSize","emergencyTextSize","adequateTextHaloBlur","emergencyTextHaloBlur","adequateTextHaloWidth","emergencyTextHaloWidth","changeAdequatesColor","changeAirportETOPSColor","changeAirportETOPSDisplay","changeAirportDisplay","baseLayerOptions","affineOrDrop","projFeatures","feature","emergencyOptions","emergencyIconImage","emergencyIconColor","adequateOptions","etopsOptions","etopsTextHaloWidth","addAirportPopup","focusAfterOpen","closeOnMove","closeButton","icao","iata","icao2iata","aircraftTypeStore","security","statusText","statusNum","isMedical","h","cc","html","codePoints","codePointAt","String","fromCodePoint","countryCodeEmoji","countryCodeName","charAt","popup","mapboxgl","Popup","on","setLngLat","setHTML","addTo","remove","getCanvas","cursor","changeMarker","setFilter","change","etopsTextHaloBlur","changeIconSize","changeLabel","epCircleLayer","etopsCircleLayer","changeETOPSDisplay","etopsTime","maxETOPS","circle","changeETOPSCircleColor","alternateRoute","wptCoordinatesAlternate","changeIconText","rnatLabelLayer","changeMyTrackLabels","rmainLayer","getPaintProperty","contrastColor","lines","rnat","markers","track","tracks","natLetter","natDirection","natLabel","description","point","isMine","overrideTextColor","noPin","lng","trackPopup","entry","isARINC","arinc_normalizer","asDM","eet","flInTitle","pattern","RegExp","raw","highlighted","eto","toISOString","substring","closePopup","off","initialLoad","myTrack","entryPoint","popupData","lat","addEntryPointPopup","setTextHalo","fir","airport","etops","ogimet","ralt","changeEPCircleColor","TWO_PI","PI","FORTPI","adjust_lon","sign","forward","lon","dlon","long0","T","tan","S","sin","S2","x0","y0","inverse","atan","names","asin","cos","sqrt","A1","A2","A3","A4","M","lambda","phi","l2","l6","delta","createMap","onLoadCb","proj4","Proj","times","eqearth","container","center","zoom","attributionControl","customAttribution","airportsAttribution","atob","affineAndClamp","_setCacheLimits","loadImage","image","addImage","pixelRatio","sdf","defs","affine2xy","xy2wgs84","xy","extent","affineTransform","mercatorBounds","x1","y1","u0","v0","u1","v1","mercatorHeight","w","dy","minX","minY","maxX","maxY","viewport","customXY","customXY2xy","XY","customXY2wgs84","X","Y","codeB","lastCode","codeA","part","lineclip","Infinity","getBounds","fitBounds","padding","top","bottom","left","right","geolocateControl","GeolocateControl","positionOptions","enableHighAccuracy","fitBoundsOptions","trackUserLocation","originalOnSuccess","_onSuccess","coords","accuracy","geolocate","addControl","onAdd","_map","_container","className","_button","_focusModeUnsubscribe","innerHTML","mapControlHTML","_toggleSidebar","onRemove","patchKeyboard","patchEvent","keyCode","stopPropagation","KeyboardEvent","ctrlKey","shiftKey","altKey","metaKey","repeat","isComposing","charCode","which","hidePlane","storeZoom","leading","trailing","remaining","throttle","floor","getZoom","EPSILON","geolocateControlElt","tiles","tileSize","minzoom","maxzoom","loadMapLayers","getCanvasContainer","capture","TilesCache","dbName","version","dbPromise","open","indexedDB","onsuccess","onerror","onupgradeneeded","getImageIdFromURL","fetchImageFromDB","imageId","storeName","imageInStoreReq","transaction","objectStore","putImageInDB","imagePutReq","put","getCacheHandler","_cacheHandler","isNotCached","imageID","getKey","countTiles","countStoreReq","count","close","request","Response","clone","imageBlob","status","lon2tile","pow","lat2tile","log","findMissingCacheTiles","tilesCaches","cacheAll","tilesCount","cacheName","tilesMax","matrix","cacheZoom","caches","sw","ne","promises","swXY","neXY","_requestManager","_skuToken","accessToken","all","progressPath","angle","path","aircraftTypeSelectElement","ofpAircraftType","planeMarker","planeElement","placePlane","Marker","$position","blankStyle","metadata","js","android","ios","bearing","pitch","sources","sprite","glyphs","created","modified","owner","draft","tilesResolution","renderWorldCopies","subLabel","validity","isInBounds","dep","dest","bounds","autoSelectedId","authorizedOptions","cbMapOption","find","northOption","distanceTo","rad_to_nm","grametStatus","grametResponseStatus","grametThumbAction","plane","getElementById","objectURL","img","iWidth","scale","currentOfp","viewportHeight","clientHeight","viewportWidth","clientWidth","body","gInnerHeight","getPropertyValue","position2pixel","grametMargin","imageOffsetForPosition","pixelPosX","margin","lock","planePosition","planeLevel","round","loadListener","gHeight","cloneNode","display","crossOrigin","cloneLoadListener","errorListener","objectFit","offset","createImg","ok","headers","message","setGramet","pinchZoom","maxHeight","dataset","width","iHeight","cHeight","allowImgScroll","pinchzoomChange","setTransform","setHeight","gWidth","nWidth","prop","mapResizeAction","currentMap","resizeMap","resize","observer","IntersectionObserver","intersectionRatio","threshold","observe","unobserve","disconnect","selectedProjection","cacheMaxValue","cacheValue","cacheError","tilesMissing","settings","afterMapLoad","attribution","module","fromEntries","updateMapLayers","$aircraftType","cacheButtonDisabled","supportWebP","Image","onload","canUseWebP","mapIsCached","showPlaneState","cache","urls","fetchCallback","queue","currentRequests","fetcher","fetchSimultaneously","RIGHT","LEFT","TOP","BOTTOM","isBrowser","getMainPosition","fitsOnTop","fitsOnBottom","fitsOnLeft","fitsOnRight","getSecondaryPosition","parentCenter","fitsCenter","positions","DEFAULT_POSITION","POSITIONS","content","isOpen","updateOnScroll","closeOnScroll","closeOnClickOutside","zIndex","onWindowKeyDown","currentPosition","topStyle","leftStyle","widthStyle","heightStyle","addListeners","updatePosition","removeListeners","prevOpen","nextOpen","hasParent","hasContent","openedState","composedPath","parentWidth","parentHeight","getBoundingClientRect","nextPosition","dimensions","documentElement","mainPosition","secondaryPosition","getNextPosition","$$restProps","levels","updates","to_null_out","accounted_for","rel","grametUpdateAvailable","reload","$grametStatus","$showGramet","grametSourceUpdate","updatedURL","payload","parisBase","getFlightTypePNC","destination","isBase","base","addDutyMeta","duty","lastLeg","legs","OUT","TVSV","blockTime","destIATA","layover","layoverTZ","destTZ","pairingData","scheduledTSV","pairing","duties","pairingText","extract","month","year","exec","months3","depIATA","depTZ","aircraftOpsVersion","tz","flightTypePNC","flightTypePNT","matchAll","scheduledOut","UTC","scheduledIN","iata2GeoPoint","groundDistance","distanceType","distance","isOFP","ofpOUT","baseTZ","meridians","getMeridians","StringExtractException","TSV","flightNo","ofpTextDate","shareURL","shareShortcut","getShortcutName","etopsMarkdown","altnETOPSPoints","getHours","getUTCHours","padStart","getMinutes","getUTCMinutes","runway","startWindow","endWindow","myName","ETO","fuelMargin","etopsList","currentRalt","latlng","etopsSummary","removePageFooterRegex","regex","day","ofpOFF","setUTCHours","latString","lngString","hours","minutes","fuelRequired","efob","rwy","startHours","startMinutes","endHours","endMinutes","dm_normalizer","etopsData","res","EET","raltPoint","getOfpRouteExport","tte","fuelMarginTime","minFuelMarginETOPS","tripFuel","excluded","filteredInfos","val","lidoFPL","realOFF","altnETOPS","registration","aircraftRegistration","etopsOutput","plugins","rawText","ofpTakeOff","hm2input","newTakeOff","setUTCMinutes","acos","atan2","deg","rad","J2000","toJulian","date","valueOf","toCenturies","geomMeanLongSun","modulo","geomMeanAnomalySun","sunTrueLong","sunEqOfCenter","sunApparentLong","obliquityCorrection","meanObliquityOfEcliptic","sunDeclinationInRadians","sint","sunRtAscensionInRadians","tananum","tanadenom","sunAzEl","seconds","getUTCSeconds","solarTimeFix","eccentricityEarthOrbit","epsilon","l0","Etime","eqTime","theta","ha","csz","zenith","elevation","sunStates","sunStateMap","prevState","newState","isSunRising","sunRisingStates","sunState","correction","toDays","rightAscension","declination","moonCoords","F","dt","ra","dec","dist","getMoonIllumination","s","sdist","inc","phase","getMoonPosition","lw","H","siderealTime","altitude","parallacticAngle","moonState","moonStateMap","sun","getState","stateMap","moon","iterateSegment","prev","increment","lowerLimit","upperLimit","segmentTime","relpos","getSolarDefault","solar","last","routeMatrix","object","kpColor","kp","noaaKp","fetchNoaaKpAndSet","timetable","Kp","$landingTime","$noaaKp","tots","startTs","endTs","aurora","$solar","$Kp","segments","predictedKp","minKpAtPoint","periods","rounding","roundedStart","roundedEnd","ceil","relpos1","relpos2","period","geoMagneticPoleLatLng","mlat","GeoPoint","rad_to_deg","predictedKpUpdated","inCache","req","isInCache","xpos","civilIcon","timelineSize","eventColor","format","iframe","tabIndex","contentWindow","withSeconds","toJSON","fixed","stateOrEvent","svgClientWidth","departureSun","arrivalSun","flightKp","getMoonIlluminationPercent","moonIllumination","getMoonName","moonEmojiStyle","mi","emojiOrientationCorrection","moonEmoji","estimatedDate","nightEventsFR","astronomicalDawn","astronomicalDusk","nauticalDawn","nauticalDusk","civilDawn","civilDusk","sunrise","sunset","night","moonrise","moonset","states","isRising","sunStateAndRising","isMoonVisible","departureMoon","sunEvents","isMoonVisibleDuringFlight","widgetEmoji","getWidgetEmojiWhenNoSunEvent","widgetEvents","getMoonEmoji","symbols","forcePreview","tabindex","searchParams","line1","line2","cbName","ogimetURL","versionDateRegex","title2html","parseMarkdown","badgeColor","badgeTextColor","filterChangeLog","limit","filtered","CHANGELOG","markdownText","translation","ADDED","FIXED","DEPRECATED","CHANGED","REMOVED","SECURITY","badgeColors","badgeTextColors","category","showChangelogOnUdate","setPreviousAppVersion","getPreviousAppVersion","helpRouteRegex","imageMapSelector","swVersion","scrollingElement","tocSelectElement","scrollingElementScrolling","toc","tocNodeList","modal","scrollEndCondition","relativeOffset","offsetTop","maxOffset","scrollHeight","scrollTop","jumpTo","onScroll","scrollTo","behavior","elt","setAndJumpTo","optionalRouteOrEvent","MouseEvent","decoded","decodeURI","resizeImageMap","querySelectorAll","xScale","naturalWidth","yScale","naturalHeight","px","py","useMap","area","observerRegistry","isIntersecting","isIntercepting","rootMargin","h2","innerText","remapper","remapperQueryExpression","jumpToTopQueryExpression","selector","complete","imagesOnLoadPromise","_wb","$wb","messageSW","menuCheckBox","contextualHelpLink","encodeURI","getContextualHelpLink","simulateClickOnInput","preloadFiles","getPageText","pdf","pageNo","page","getPage","getTextContent","items","click","pdfWorker","preload","maybeCallback","defer","isScript","tag","loader","pdfjsLib","GlobalWorkerOptions","workerSrc","destroyed","PDFWorker","getOFP","file","reader","FileReader","ev","ofpPages","processedPages","getDocument","maxPages","numPages","pageText","getOFPText","verbosity","worker","Ofp","wmoGrid","GeoGridIndex","wmo","averageFL","p1","p2","unshift","wptNamesEET","setName","wptCoordinates","natmarks","isComplete","addPoint","generateKML","readAsArrayBuffer","files","form","closest","$ofpStatus","$ofpStore","finally","hidden","maxWidth","swRegistration","showSkipWaitingPrompt","nextVersion","cParts","nParts","isPatchUpdate","installLabel","$swDismiss","prompt","install","refreshing","$swRegistration","postMessage","showChangeLog","isAppUpdated","rawData","item","decodeURIComponent","valid","storeSettingsFromURL","search","isHelpRoute","requestedRoute","self","MessageChannel","port1","onmessage","port2","Symbol","iterator","prototype","done","TypeError","nn","tn","rn","en","un","an","cn","installing","scriptURL","sn","vn","hn","ln","isExternal","originalEvent","mn","isUpdate","wn","dn","controller","gn","ports","getSW","register","readyState","Boolean","yn","pn","bn","once","wasWaitingBeforeRegister","messageSkipWaiting","enumerable","configurable","defineProperty","Pn","Sn","app","appError","App","workbox","Workbox","unregister"],"mappings":"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"}