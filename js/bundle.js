var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function i(e){e.forEach(o)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(e,t,n){e.$$.on_destroy.push(l(t,n))}function u(e,t,n,o){if(e){const r=p(e,t,n,o);return e[0](r)}}function p(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function d(e,t,n,o,r,i,s){const a=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,i);if(a){const r=p(t,n,o,s);e.p(r,a)}}function m(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function f(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function g(e){return null==e?"":e}function h(e,t,n=t){return e.set(n),t}function v(t){return t&&s(t.destroy)?t.destroy:e}const y="undefined"!=typeof window;let $=y?()=>window.performance.now():()=>Date.now(),b=y?e=>requestAnimationFrame(e):e;const x=new Set;function w(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&b(w)}function k(e){let t;return 0===x.size&&b(w),{promise:new Promise((n=>{x.add(t={c:e,f:n})})),abort(){x.delete(t)}}}function P(e,t){e.appendChild(t)}function C(e,t,n){e.insertBefore(t,n||null)}function L(e){e.parentNode.removeChild(e)}function E(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function O(e){return document.createElement(e)}function M(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function S(e){return document.createTextNode(e)}function F(){return S(" ")}function T(){return S("")}function j(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function A(e){return function(t){return t.preventDefault(),e.call(this,t)}}function I(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function z(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:I(e,o,t[o])}function D(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function R(e){return""===e?null:+e}function W(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function N(e,t){e.value=null==t?"":t}function U(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function H(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function q(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function G(e,t,n){e.classList[n?"add":"remove"](t)}function B(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const K=new Set;let Z,X=0;function J(e,t,n,o,r,i,s,a=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*i(e);c+=100*e+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=e.ownerDocument;K.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(O("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,X+=1,p}function V(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),X-=r,X||b((()=>{X||(K.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),K.clear())})))}function Y(e){Z=e}function Q(){if(!Z)throw new Error("Function called outside component initialization");return Z}function ee(e){Q().$$.on_mount.push(e)}function te(e){Q().$$.on_destroy.push(e)}function ne(){const e=Q();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=B(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function oe(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const re=[],ie=[],se=[],ae=[],le=Promise.resolve();let ce=!1;function ue(){ce||(ce=!0,le.then(he))}function pe(){return ue(),le}function de(e){se.push(e)}function me(e){ae.push(e)}let fe=!1;const ge=new Set;function he(){if(!fe){fe=!0;do{for(let e=0;e<re.length;e+=1){const t=re[e];Y(t),ve(t.$$)}for(Y(null),re.length=0;ie.length;)ie.pop()();for(let e=0;e<se.length;e+=1){const t=se[e];ge.has(t)||(ge.add(t),t())}se.length=0}while(re.length);for(;ae.length;)ae.pop()();ce=!1,fe=!1,ge.clear()}}function ve(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(de)}}let ye;function $e(){return ye||(ye=Promise.resolve(),ye.then((()=>{ye=null}))),ye}function be(e,t,n){e.dispatchEvent(B(`${t?"intro":"outro"}${n}`))}const xe=new Set;let we;function ke(){we={r:0,c:[],p:we}}function Pe(){we.r||i(we.c),we=we.p}function Ce(e,t){e&&e.i&&(xe.delete(e),e.i(t))}function Le(e,t,n,o){if(e&&e.o){if(xe.has(e))return;xe.add(e),we.c.push((()=>{xe.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const Ee={duration:0};function Oe(n,o,r,a){let l=o(n,r),c=a?0:1,u=null,p=null,d=null;function m(){d&&V(n,d)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(o){const{delay:r=0,duration:s=300,easing:a=t,tick:g=e,css:h}=l||Ee,v={start:$()+r,b:o};o||(v.group=we,we.r+=1),u||p?p=v:(h&&(m(),d=J(n,c,o,s,r,a,h)),o&&g(0,1),u=f(v,s),de((()=>be(n,o,"start"))),k((e=>{if(p&&e>p.start&&(u=f(p,s),p=null,be(n,u.b,"start"),h&&(m(),d=J(n,c,u.b,u.duration,0,a,l.css))),u)if(e>=u.end)g(c=u.b,1-c),be(n,u.b,"end"),p||(u.b?m():--u.group.r||i(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*a(t/u.duration),g(c,1-c)}return!(!u&&!p)})))}return{run(e){s(l)?$e().then((()=>{l=l(),g(e)})):g(e)},end(){m(),u=p=null}}}const Me="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Se(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Fe(e){e&&e.c()}function Te(e,t,n,r){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(t,n),r||de((()=>{const t=l.map(o).filter(s);c?c.push(...t):i(t),e.$$.on_mount=[]})),u.forEach(de)}function _e(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function je(t,n,o,s,a,l,c=[-1]){const u=Z;Y(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:r(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(re.push(e),ue(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(L)}else p.fragment&&p.fragment.c();n.intro&&Ce(t.$$.fragment),Te(t,n.target,n.anchor,n.customElement),he()}Y(u)}class Ae{$destroy(){_e(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Ie{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const ze="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,De=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),Re=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),We=matchMedia("(hover: hover)").matches;function Ne(e,t,n){let o;return function(){const r=this,i=arguments,s=function(){o=null,n||e.apply(r,i)},a=n&&!o;clearTimeout(o),o=setTimeout(s,t),a&&e.apply(r,i)}}function Ue(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function He(e){switch(e){case"rmain":return"route";case"ralt":return"alternate";case"rnat":return"nat";default:return e}}function qe(e,t,n){return e<=t?t:e>=n?n:e}function Ge(e,t,n){return!(e<t)&&!(e>n)}function Be(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Ke(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ze(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}const Xe=async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1};function Je(e){const t=e-1;return t*t*t+1}function Ve(e,{delay:n=0,duration:o=400,easing:r=t}={}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*i}}function Ye(e,{delay:t=0,duration:n=400,easing:o=Je,x:r=0,y:i=0,opacity:s=0}={}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-s);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*i}px);\n\t\t\topacity: ${l-u*t}`}}const Qe=[];function et(e,t){return{subscribe:tt(e,t).subscribe}}function tt(t,n=e){let o;const r=[];function i(e){if(a(t,e)&&(t=e,o)){const e=!Qe.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Qe.push(n,t)}if(e){for(let e=0;e<Qe.length;e+=2)Qe[e][0](Qe[e+1]);Qe.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(s,a=e){const l=[s,a];return r.push(l),1===r.length&&(o=n(i)||e),s(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}function nt(t,n,o){const r=!Array.isArray(t),a=r?[t]:t,c=n.length<2;return et(o,(t=>{let o=!1;const u=[];let p=0,d=e;const m=()=>{if(p)return;d();const o=n(r?u[0]:u,t);c?t(o):d=s(o)?o:e},f=a.map(((e,t)=>l(e,(e=>{u[t]=e,p&=~(1<<t),o&&m()}),(()=>{p|=1<<t}))));return o=!0,m(),function(){i(f),d()}}))}const ot=tt(),rt=tt(!1),it=tt(!1),st=tt(!1),at=tt(!1),lt=tt(!1),ct=function(e){const{subscribe:t,set:n,update:o}=tt(e);return{subscribe:t,set:n,update:o,reset:()=>n("object"==typeof e?{...e}:Array.isArray(e)?[...e]:e)}}(!1),ut=tt(-1),pt=tt(),dt=tt(),mt=tt(new Date),ft=nt([pt,dt],(([e,t])=>!!e&&!e.isFake&&"success"===t),!1);let gt=new Date;const ht=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-gt>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting?(it.set(!0),st.set(!0)):e.update(),rt.set(!1),gt=new Date)}),console.error)}},vt=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&ht()},yt=et(!0,(e=>{const t=()=>{document&&document.visibilityState?"visible"===document.visibilityState?e(!0):e(!1):e(!0)};return document.addEventListener("visibilitychange",t),t(),()=>{document.removeEventListener("visibilitychange",t)}})),$t=et({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),bt=et("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(at.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),ht()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}})),xt=nt([pt,ut,mt,ct,yt],(([e,t,n,o,r],i)=>{let s;const a=o?1e4:6e4;if(e&&!e.isFake){const o=e=>{e<100?i(e):(i(100),clearInterval(s),s=void 0,ut.set(-1))};if(t>=0){let e=t;s=setInterval((()=>{o(e),e++}),100)}else{const t=n,l=new Date(t),c=e.infos.duration;l.setUTCMinutes(l.getUTCMinutes()+c[1]),l.setUTCHours(l.getUTCHours()+c[0]);const u=()=>{let e=new Date;return e<=t?0:e>=l?100:(e-t)/(3600*c[0]+60*c[1])/10},p=u();p<100?(r&&(s=setInterval((()=>{const e=u();o(e)}),a)),i(p)):i(100)}}else i(0);return()=>{s&&clearInterval(s)}}),0),wt=nt([pt,xt],(([e,t])=>{if(!e||e.isFake)return{map:{latitude:0,longitude:0},gramet:t,fl:300};const n=e.timeMatrix,o=e.distanceMatrix,r=o[0][0],i=o[o.length-1][0],s=o[o.length-1][1],a=0!==n.length?n[0][2]:o[0][2],l=0!==n.length?n[n.length-1][2]:o[o.length-1][2];if(t<=0)return{map:r,gramet:0,fl:a};if(t>=100)return{map:i,gramet:100,fl:l};if(0!==n.length){const e=t*n[n.length-1][1]/100;for(const[t,[i,l,c]]of n.entries())if(l>=e){if(e-l==0)return{map:i,gramet:100*o[t][1]/s,fl:c};const u=n[t-1];if(u){const n=o[t][1]-o[t-1][1],r=(l-e)/(l-u[1]);return{map:i.atFraction(u[0],r,n),gramet:100*(o[t][1]-r*n)/s,fl:u[2]}}return{map:r,gramet:0,fl:a}}}else{const e=t*o[o.length-1][1]/100;for(const[n,[i,s,l]]of o.entries())if(s>=e){if(e-s==0)return{map:i,gramet:t,fl:l};const c=o[n-1];if(c){const n=s-c[1];return{map:i.atFraction(c[0],(s-e)/n,n),gramet:t,fl:c[2]}}return{map:r,gramet:0,fl:a}}}return{map:i,gramet:100,fl:l}}),{map:{latitude:0,longitude:0},gramet:0,fl:300});function kt(e){let t;return{c(){t=O("textarea"),t.value=e[0],I(t,"class","svelte-12a0ij3")},m(n,o){C(n,t,o),e[5](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&L(t),e[5](null)}}}function Pt(t){let n,o,r;return{c(){n=O("a"),n.textContent="copier la route",I(n,"role","button"),I(n,"class","btn btn-primary svelte-12a0ij3"),I(n,"href","lhs-mpilot://")},m(e,i){C(e,n,i),o||(r=j(n,"click",t[4]),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function Ct(t){let n,o,r,i,s;return{c(){n=O("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=O("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',I(n,"role","button"),I(n,"class","btn btn-primary svelte-12a0ij3"),I(n,"href","lhs-mpilot://"),I(r,"class","card-text")},m(e,a){C(e,n,a),C(e,o,a),C(e,r,a),i||(s=j(n,"click",t[4]),i=!0)},p:e,d(e){e&&L(n),e&&L(o),e&&L(r),i=!1,s()}}}function Lt(n){let o,r,a;return{c(){o=O("span"),o.textContent="copié!",I(o,"class","svelte-12a0ij3")},m(e,t){C(e,o,t),a=!0},i(e){a||(r&&r.end(1),a=!0)},o(n){r=function(n,o,r){let a,l=o(n,r),c=!0;const u=we;function p(){const{delay:o=0,duration:r=300,easing:s=t,tick:p=e,css:d}=l||Ee;d&&(a=J(n,1,0,r,o,s,d));const m=$()+o,f=m+r;de((()=>be(n,!1,"start"))),k((e=>{if(c){if(e>=f)return p(0,1),be(n,!1,"end"),--u.r||i(u.c),!1;if(e>=m){const t=s((e-m)/r);p(1-t,t)}}return c}))}return u.r+=1,s(l)?$e().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(a&&V(n,a),c=!1)}}}(o,Ve,{}),a=!1},d(e){e&&L(o),e&&r&&r.end()}}}function Et(e){let t,n,o,r,i,s,a,l,c,u,p,d,m=null!=e[0]&&kt(e);let f=(ze?Ct:Pt)(e),g=e[2]&&Lt();return{c(){m&&m.c(),t=F(),n=O("div"),o=O("div"),r=O("h5"),r.textContent="Route Lido",i=F(),s=O("p"),s.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",a=F(),f.c(),l=F(),c=O("div"),u=S(e[3]),p=F(),g&&g.c(),I(r,"class","card-title"),I(s,"class","card-text"),I(c,"class","text-monospace svelte-12a0ij3"),I(o,"class","card-body"),I(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),C(e,t,h),C(e,n,h),P(n,o),P(o,r),P(o,i),P(o,s),P(o,a),f.m(o,null),P(o,l),P(o,c),P(c,u),P(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=kt(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&Ce(g,1):(g=Lt(),g.c(),Ce(g,1),g.m(c,null)):g&&(ke(),Le(g,1,1,(()=>{g=null})),Pe())},i(e){d||(Ce(g),d=!0)},o(e){Le(g),d=!1},d(e){m&&m.d(e),e&&L(t),e&&L(n),f.d(),g&&g.d()}}}let Ot=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Ot=!0)}))}catch(e){}function Mt(e,t,n){let o;c(e,pt,(e=>n(6,o=e)));let r,i=null;const s=o?o.lidoRoute().join(" "):"";let a=!1;return[i,r,a,s,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Ot)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,i=e),await pe(),r.focus(),r.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,i=null)}return t}(s);ze||(n(2,a=t),setTimeout((function(){n(2,a=!1)}),3e3),e.preventDefault())},function(e){ie[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class St extends Ae{constructor(e){super(),je(this,e,Mt,Et,a,{})}}const Ft={routeDisplay:!0,routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC",iconTextChange:"1.0",lineWidthChange:"1.0",iconSizeChange:"1.0"};function Tt(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const _t=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Tt(window.kmlGen,Ft)),window.kmlGen);function jt(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function At(e){let t,n,o,r=e[14].label+"";return{c(){t=O("option"),n=S(r),t.__value=e[16],t.value=t.__value,t.selected=o=e[16]===e[1]},m(e,o){C(e,t,o),P(t,n)},p(e,n){2&n&&o!==(o=e[16]===e[1])&&(t.selected=o)},d(e){e&&L(t)}}}function It(t){let n,o,r,a,l,c,u,p,d,m,f,g,h,y,$,b,x,w,k=Ht,S=[];for(let e=0;e<k.length;e+=1)S[e]=At(jt(t,k,e));return{c(){n=O("kmlcolor"),o=O("pin"),r=M("svg"),a=M("use"),l=F(),c=O("select");for(let e=0;e<S.length;e+=1)S[e].c();u=F(),p=O("picker"),d=O("label"),m=O("input"),h=F(),y=O("input"),D(a,"xlink:href","#marker-symbol"),U(a,"stroke",0===t[1]?"#fff":Ht[t[1]].color),U(a,"fill",Ht[t[1]].color),I(o,"class","form-control svelte-1b9oa5t"),I(c,"name",t[4]),I(c,"class","custom-select"),void 0===t[1]&&de((()=>t[8].call(c))),I(m,"type","color"),I(d,"style",f=Ut(t[2])),I(y,"type","range"),I(y,"min","30"),I(y,"max","255"),I(p,"class","form-control"),I(p,"style",$=Nt(t[2][0])),I(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,a),P(n,l),P(n,c);for(let e=0;e<S.length;e+=1)S[e].m(c,null);H(c,t[1]),P(n,u),P(n,p),P(p,d),P(d,m),N(m,t[2][0]),P(p,h),P(p,y),N(y,t[2][1]),x||(w=[j(c,"change",t[8]),j(c,"change",t[9]),j(m,"input",t[10]),v(g=t[5].call(null,d,t[2])),j(y,"change",t[11]),j(y,"input",t[11]),v(b=t[6].call(null,n,t[0]))],x=!0)},p(e,[t]){if(2&t&&U(a,"stroke",0===e[1]?"#fff":Ht[e[1]].color),2&t&&U(a,"fill",Ht[e[1]].color),2&t){let n;for(k=Ht,n=0;n<k.length;n+=1){const o=jt(e,k,n);S[n]?S[n].p(o,t):(S[n]=At(o),S[n].c(),S[n].m(c,null))}for(;n<S.length;n+=1)S[n].d(1);S.length=k.length}2&t&&H(c,e[1]),4&t&&N(m,e[2][0]),4&t&&f!==(f=Ut(e[2]))&&I(d,"style",f),g&&s(g.update)&&4&t&&g.update.call(null,e[2]),4&t&&N(y,e[2][1]),4&t&&$!==($=Nt(e[2][0]))&&I(p,"style",$),b&&s(b.update)&&1&t&&b.update.call(null,e[0])},i:e,o:e,d(e){e&&L(n),E(S,e),x=!1,i(w)}}}const zt=/^[A-F0-9]{8}$/i,Dt=e=>{let[t,n]=Wt(e);return[t,n/255]},Rt=["#FF0000",255],Wt=e=>{try{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]}catch(e){return Rt}},Nt=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Ut=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Ht=[{label:"Aucun repère",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function qt(e,t,n){const o=ne();let{kmlColor:r="FF0000FF"}=t,{selected:i=0}=t,{name:s}=t;const a=s+"-color",l=s+"-pin";let c=Rt;const u=Ne(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"selected"in e&&n(1,i=e.selected),"name"in e&&n(7,s=e.name)},[r,i,c,o,l,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),u("change",{name:a,value:r})}}},function(e){return n(2,c=Wt(r)),{update(e){n(2,c=Wt(e)),u("change",{name:a,value:e.toUpperCase()})}}},s,function(){i=q(this),n(1,i)},e=>{e.target.blur(),o("change",{name:l,value:i})},function(){c[0]=this.value,n(2,c)},function(){c[1]=R(this.value),n(2,c)}]}class Gt extends Ae{constructor(e){super(),je(this,e,qt,It,a,{kmlColor:0,selected:1,name:7})}}const Bt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),Kt=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){const n=JSON.stringify(t);"{}"!==n&&localStorage.setItem(e,n)}removeItem(e){localStorage.removeItem(e)}},Zt=(e,t,n="Mon OFP2MAP")=>{const o={};for(const[t,n]of Object.entries(Bt)){let r=Kt.getItem(n);if(t===Bt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==Ft[t])))t[n]=e[n];r=t}if(null!==r)if(t===Bt.optionsKML)for(const[e,t]of Object.entries(r))o[e]=t;else o[t]=r}const r=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),i=window.location.origin+window.location.pathname+(r?"?"+r:"")+"#"+t;window.history.replaceState(o,n,i)};function Xt(t){let n,o,r,s,a,l,c,u,p,d;return{c(){n=O("div"),o=O("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',r=F(),s=O("input"),a=F(),l=O("div"),c=O("a"),u=S("Lancer"),I(o,"class","input-group-prepend"),I(s,"class","form-control svelte-1ecyaux"),I(s,"placeholder","Nom du raccourci"),I(s,"type","text"),I(c,"class","btn btn-outline-secondary svelte-1ecyaux"),I(c,"href",t[1]),G(c,"disabled",!(t[0].trim()&&ze)),I(l,"class","input-group-append"),I(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(n,r),P(n,s),N(s,t[0]),P(n,a),P(n,l),P(l,c),P(c,u),p||(d=[j(s,"input",t[4]),j(s,"change",t[3]),j(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&s.value!==e[0]&&N(s,e[0]),2&t&&I(c,"href",e[1]),1&t&&G(c,"disabled",!(e[0].trim()&&ze))},i:e,o:e,d(e){e&&L(n),p=!1,i(d)}}}const Jt="OFP2MAP";function Vt(e,t,n){let o;c(e,pt,(e=>n(5,o=e)));const r=ne(),i=Bt.shortcut;let s,a=Kt.getItem(i)||Jt;const l=o?o.lidoRoute().join(" "):"";return[a,s,function(e){const t=a.trim();if(t&&ze){const e=_t(),r={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:o.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(r)))}else e.preventDefault()},function(){const e=a.trim();e===Jt?Kt.removeItem(i):Kt.setItem(i,e),r("save",[i,e])},function(){a=this.value,n(0,a)}]}class Yt extends Ae{constructor(e){super(),je(this,e,Vt,Xt,a,{})}}function Qt(t){let n,o,r,s,a,l,c,u,p,d,m,f,g,h,v,y=nn[0]+"",$=nn[1]+"";return{c(){n=O("div"),o=O("select"),r=O("option"),s=S(y),l=O("option"),c=S($),p=F(),d=O("div"),m=O("a"),f=S(t[0]),r.selected=a=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,I(o,"class","custom-select svelte-19hokx5"),I(o,"aria-label","Example select with button addon"),void 0===t[1]&&de((()=>t[6].call(o))),I(m,"class","btn btn-success"),I(m,"download",g=navigator.standalone?null:t[3]),I(m,"href",t[2]),I(m,"target",en),I(d,"class","input-group-append"),I(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(o,l),P(l,c),H(o,t[1]),P(n,p),P(n,d),P(d,m),P(m,f),h||(v=[j(o,"change",t[6]),j(o,"change",t[5]),j(m,"click",t[4])],h=!0)},p(e,[t]){2&t&&a!==(a=0===e[1])&&(r.selected=a),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&H(o,e[1]),1&t&&W(f,e[0]),8&t&&g!==(g=navigator.standalone?null:e[3])&&I(m,"download",g),4&t&&I(m,"href",e[2])},i:e,o:e,d(e){e&&L(n),h=!1,i(v)}}}const en=navigator.standalone||navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,tn=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},nn=["KML Mapsme","KML Avenza"];function on(e,t,n){const o=ne();let{label:r}=t;const i=Bt.downloadType;let s=Kt.getItem(i)||1;"string"==typeof s&&(s=parseInt(s,10)),(s<0||s>=nn.length)&&(s=0);let a="",l="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,s,a,l,function(e){const t=_t(),o=["_mapsme.kml","_avenza.kml",".geojson"][s];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),0===s)n(2,a=tn(t.render()));else{if(1!==s)return e.preventDefault(),!1;n(2,a=tn(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})))}},function(){1===s?Kt.removeItem(i):Kt.setItem(i,s),o("save",[i,s])},function(){s=q(this),n(1,s)}]}class rn extends Ae{constructor(e){super(),je(this,e,on,Qt,a,{label:0})}}function sn(t){let n,o,r,i,s,a,l,c,u,p,d,m,f,g,h;return l=new rn({props:{label:"Télécharger"}}),l.$on("save",t[0]),m=new Yt({}),m.$on("save",t[1]),{c(){n=O("div"),o=O("div"),r=O("h5"),r.textContent="Export",i=F(),s=O("div"),a=O("div"),Fe(l.$$.fragment),c=F(),u=O("small"),u.textContent="Le fichier est généré en fonction des options choisies sur la carte.",p=F(),d=O("div"),Fe(m.$$.fragment),f=F(),g=O("small"),g.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',I(r,"class","card-title"),I(u,"class","text-muted"),I(a,"class","col-12 col-sm-6 col-md-6"),I(g,"class","text-muted"),I(d,"class","col-12 col-sm-6 col-md-6"),I(s,"class","row"),I(o,"class","card-body"),I(n,"class","card mb-3 svelte-17snbjk")},m(e,t){C(e,n,t),P(n,o),P(o,r),P(o,i),P(o,s),P(s,a),Te(l,a,null),P(a,c),P(a,u),P(s,p),P(s,d),Te(m,d,null),P(d,f),P(d,g),h=!0},p:e,i(e){h||(Ce(l.$$.fragment,e),Ce(m.$$.fragment,e),h=!0)},o(e){Le(l.$$.fragment,e),Le(m.$$.fragment,e),h=!1},d(e){e&&L(n),_e(l),_e(m)}}}function an(e){return[function(t){oe(e,t)},function(t){oe(e,t)}]}class ln extends Ae{constructor(e){super(),je(this,e,an,sn,a,{})}}function cn(t){let n;return{c(){n=S(" ")},m(e,t){C(e,n,t)},p:e,d(e){e&&L(n)}}}function un(t){let n,o,r;return{c(){n=O("button"),n.textContent="Partager l'App",I(n,"class","btn btn-link")},m(e,t){C(e,n,t),o||(r=j(n,"click",Xe),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function pn(t){let n,o,r,i,s;let a=(!0===navigator.standalone&&navigator.share?un:cn)(t);return{c(){n=O("h1"),o=S("Cartographie pour l'OFP \n    "),r=O("img"),s=F(),a.c(),r.src!==(i="svg/Air_France_Logo.svg")&&I(r,"src","svg/Air_France_Logo.svg"),I(r,"alt","logo Air France"),I(r,"class","svelte-drdjg7"),I(n,"class","svelte-drdjg7")},m(e,t){C(e,n,t),P(n,o),P(n,r),P(n,s),a.m(n,null)},p(e,[t]){a.p(e,t)},i:e,o:e,d(e){e&&L(n),a.d()}}}class dn extends Ae{constructor(e){super(),je(this,e,null,pn,a,{})}}function mn(t){let n,o,r,i;return n=new dn({}),{c(){Fe(n.$$.fragment),o=F(),r=O("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card avenza svelte-16k91og"><div class="card-header svelte-16k91og">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card mapsme svelte-16k91og"><div class="card-header svelte-16k91og">Multiples Projections</div> \n      <div class="card-body"><p class="card-text">Des cartes LAMBERT conformes, un ATLAS, et une MERCATOR avec 12 niveaux de zoom. Export en format KML vers Mapsme ou Avenza</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card ogimet svelte-16k91og"><div class="card-header svelte-16k91og">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET qui est un météogramme combinant l&#39;espace et le temps</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card shortcuts svelte-16k91og"><div class="card-header svelte-16k91og">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Avec l&#39;app Raccourcis, automatisez en récupérant le KML, le Gramet, ou une route Lido optimisée</p></div></div></div></div>',I(r,"class","row svelte-16k91og")},m(e,t){Te(n,e,t),C(e,o,t),C(e,r,t),i=!0},p:e,i(e){i||(Ce(n.$$.fragment,e),i=!0)},o(e){Le(n.$$.fragment,e),i=!1},d(e){_e(n,e),e&&L(o),e&&L(r)}}}class fn extends Ae{constructor(e){super(),je(this,e,null,mn,a,{})}}function gn(t){let n,o,r,a,l,c,u,p,d,m,f,g,h,y,$,b,x;return{c(){n=O("kmlcolor"),o=O("div"),r=O("label"),a=O("input"),l=S(t[2]),c=F(),u=O("picker"),p=O("label"),d=O("input"),g=F(),h=O("input"),I(a,"name",t[4]),a.checked=t[1],I(a,"type","checkbox"),I(r,"for",t[4]),I(r,"class","input-group-text"),I(o,"class","input-group-prepend"),I(d,"type","color"),I(p,"style",m=Ut(t[3])),I(h,"type","range"),I(h,"min","30"),I(h,"max","255"),I(u,"class","form-control"),I(u,"style",y=Nt(t[3][0])),I(n,"class","input-group checkbox-combo")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,a),P(r,l),P(n,c),P(n,u),P(u,p),P(p,d),N(d,t[3][0]),P(u,g),P(u,h),N(h,t[3][1]),b||(x=[j(a,"change",t[8]),j(d,"input",t[9]),v(f=t[5].call(null,p,t[3])),j(h,"change",t[10]),j(h,"input",t[10]),v($=t[6].call(null,n,t[0]))],b=!0)},p(e,[t]){2&t&&(a.checked=e[1]),4&t&&W(l,e[2]),8&t&&N(d,e[3][0]),8&t&&m!==(m=Ut(e[3]))&&I(p,"style",m),f&&s(f.update)&&8&t&&f.update.call(null,e[3]),8&t&&N(h,e[3][1]),8&t&&y!==(y=Nt(e[3][0]))&&I(u,"style",y),$&&s($.update)&&1&t&&$.update.call(null,e[0])},i:e,o:e,d(e){e&&L(n),b=!1,i(x)}}}function hn(e,t,n){const o=ne();let{kmlColor:r="FF0000FF"}=t,{checked:i}=t,{name:s}=t,{label:a="Couleur"}=t;const l=s+"-color",c=s+"-display";let u=Rt;const p=Ne(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"checked"in e&&n(1,i=e.checked),"name"in e&&n(7,s=e.name),"label"in e&&n(2,a=e.label)},[r,i,a,u,c,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),p("change",{name:l,value:r})}}},function(e){return n(3,u=Wt(r)),{update(e){n(3,u=Wt(e)),p("change",{name:l,value:e.toUpperCase()})}}},s,function(t){oe(e,t)},function(){u[0]=this.value,n(3,u)},function(){u[1]=R(this.value),n(3,u)}]}class vn extends Ae{constructor(e){super(),je(this,e,hn,gn,a,{kmlColor:0,checked:1,name:7,label:2})}}function yn(e,t,n){const o=e.slice();return o[9]=t[n],o[11]=n,o}function $n(e){let t,n,o,r=e[9].label+"";return{c(){t=O("option"),n=S(r),t.__value=e[11],t.value=t.__value,t.selected=o=e[11]===e[0]},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[11]===e[0])&&(t.selected=o)},d(e){e&&L(t)}}}function bn(t){let n,o,r,s,a,l,c,u,p,d=xn,m=[];for(let e=0;e<d.length;e+=1)m[e]=$n(yn(t,d,e));return{c(){n=O("div"),o=O("div"),r=O("label"),s=O("input"),a=S("Airports"),l=F(),c=O("select");for(let e=0;e<m.length;e+=1)m[e].c();I(s,"name",t[3]),s.checked=t[1],I(s,"type","checkbox"),I(r,"for",t[3]),I(r,"class","input-group-text"),I(o,"class","input-group-prepend"),I(c,"name",t[4]),I(c,"class","custom-select svelte-aqi3t3"),void 0===t[0]&&de((()=>t[7].call(c))),I(n,"class","input-group checkbox-combo")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(r,a),P(n,l),P(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);H(c,t[0]),u||(p=[j(s,"change",t[6]),j(c,"change",t[7]),j(c,"change",t[8])],u=!0)},p(e,[t]){if(2&t&&(s.checked=e[1]),1&t){let n;for(d=xn,n=0;n<d.length;n+=1){const o=yn(e,d,n);m[n]?m[n].p(o,t):(m[n]=$n(o),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}1&t&&H(c,e[0])},i:e,o:e,d(e){e&&L(n),E(m,e),u=!1,i(p)}}}const xn=[{label:"statuts"},{label:"vert/rouge"}];function wn(e,t,n){const o=ne();let{selected:r=0}=t,{name:i="airport"}=t,{checked:s}=t;const a=i+"-display",l=i+"-pin";return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(5,i=e.name),"checked"in e&&n(1,s=e.checked)},[r,s,o,a,l,i,function(t){oe(e,t)},function(){r=q(this),n(0,r)},e=>{e.target.blur(),o("change",{name:l,value:r})}]}class kn extends Ae{constructor(e){super(),je(this,e,wn,bn,a,{selected:0,name:5,checked:1})}}function Pn(t){let n,o,r,s,a,l,c,u,p,d,m,f,g;return{c(){n=O("div"),o=O("div"),r=O("label"),s=S(t[2]),a=F(),l=O("button"),l.textContent="-",c=F(),u=O("div"),p=S(t[0]),d=F(),m=O("button"),m.textContent="+",I(r,"for",t[1]),I(r,"class","input-group-text svelte-si7r19"),I(o,"class","input-group-prepend"),I(l,"class","form-control svelte-si7r19"),I(l,"type","button"),I(u,"class"," form-control svelte-si7r19"),I(m,"class","form-control svelte-si7r19"),I(m,"type","button"),I(n,"class","input-group input-group-sm svelte-si7r19")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(n,a),P(n,l),P(n,c),P(n,u),P(u,p),P(n,d),P(n,m),f||(g=[j(l,"click",t[4]),j(m,"click",t[3])],f=!0)},p(e,[t]){4&t&&W(s,e[2]),2&t&&I(r,"for",e[1]),1&t&&W(p,e[0])},i:e,o:e,d(e){e&&L(n),f=!1,i(g)}}}function Cn(e,t,n){const o=ne();let{name:r}=t,{label:i}=t,{value:s}=t,{min:a=.9}=t,{max:l=1.4}=t,{step:c=.1}=t;return e.$$set=e=>{"name"in e&&n(1,r=e.name),"label"in e&&n(2,i=e.label),"value"in e&&n(0,s=e.value),"min"in e&&n(5,a=e.min),"max"in e&&n(6,l=e.max),"step"in e&&n(7,c=e.step)},[s,r,i,()=>{const e=s;n(0,s=Math.min(Math.max(parseFloat(s)+c,a),l).toFixed(1)),s!==e&&o("change",{name:r,value:s})},()=>{const e=s;n(0,s=Math.min(Math.max(parseFloat(s)-c,a),l).toFixed(1)),s!==e&&o("change",{name:r,value:s})},a,l,c]}class Ln extends Ae{constructor(e){super(),je(this,e,Cn,Pn,a,{name:1,label:2,value:0,min:5,max:6,step:7})}}function En(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function On(e){let t,n,o,r,s,a,l,c,u,p,d,m,f,g,h,y,$,b,x,w,k,E,M,T,_,z,D,R,W,N,U,H,q,B,K,Z,X,J,V,Y,Q,ee,te,ne,oe,re,ie,se,ae,le,ce,ue,pe,me,fe,ge,he,ve,ye,$e,be,xe,we,ke,Pe;c=new Gt({props:{name:"route",kmlColor:e[0].routeColor,selected:e[0].routePin}}),c.$on("change",e[4]),y=new Gt({props:{name:"alternate",kmlColor:e[0].alternateColor,selected:e[0].alternatePin}}),y.$on("change",e[4]),T=new Gt({props:{name:"nat",kmlColor:e[0].natColor,selected:e[0].natPin}}),T.$on("change",e[4]),W=new vn({props:{name:"great-circle",label:"Orthodromie",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay}}),W.$on("change",e[4]),H=new vn({props:{name:"ogimet",label:"Route GRAMET",kmlColor:e[0].ogimetColor,checked:e[0].ogimetDisplay}}),H.$on("change",e[4]),K=new vn({props:{name:"etops",label:"ETOPS",kmlColor:e[0].etopsColor,checked:e[0].etopsDisplay}}),K.$on("change",e[4]),J=new kn({props:{name:"airport",selected:e[0].airportPin,checked:e[0].airportDisplay}}),J.$on("change",e[4]),ie=new Ln({props:{name:"icon-text-change",label:"Label",value:e[0].iconTextChange}}),ie.$on("change",e[4]),ae=new Ln({props:{name:"line-width-change",label:"Ligne",value:e[0].lineWidthChange,min:.6,max:2,step:.1}}),ae.$on("change",e[4]),ce=new Ln({props:{name:"icon-size-change",label:"Icône",value:e[0].iconSizeChange,min:.6,max:2,step:.1}}),ce.$on("change",e[4]);let Ee=!e[1]&&Mn(e);return{c(){t=O("div"),n=O("a"),n.innerHTML='<svg class="svelte-1tbpz3x"><use xlink:href="#close-symbol"></use></svg>',o=F(),r=O("form"),s=O("fieldset"),a=O("legend"),a.textContent="Route",l=F(),Fe(c.$$.fragment),u=F(),p=O("fieldset"),d=O("legend"),m=O("input"),g=S("Dégagement"),h=F(),Fe(y.$$.fragment),$=F(),b=O("fieldset"),x=O("legend"),w=O("input"),E=S("Tracks"),M=F(),Fe(T.$$.fragment),_=F(),z=O("small"),z.textContent="Positionné à l'entrée des tracks, un track incomplet restera rouge.",D=F(),R=O("fieldset"),Fe(W.$$.fragment),N=F(),U=O("fieldset"),Fe(H.$$.fragment),q=F(),B=O("fieldset"),Fe(K.$$.fragment),Z=F(),X=O("fieldset"),Fe(J.$$.fragment),V=F(),Y=O("fieldset"),Q=O("legend"),ee=O("input"),ne=S("FIR SÛRETÉ"),oe=F(),re=O("fieldset"),Fe(ie.$$.fragment),se=F(),Fe(ae.$$.fragment),le=F(),Fe(ce.$$.fragment),ue=F(),pe=O("div"),me=O("button"),fe=S("Mémoriser"),he=F(),ve=O("button"),ye=S("Restaurer"),be=F(),Ee&&Ee.c(),I(n,"class","closeB svelte-1tbpz3x"),I(n,"role","button"),I(n,"href","."),I(s,"class","form-group svelte-1tbpz3x"),I(m,"name","alternate-display"),m.checked=f=e[0].alternateDisplay,I(m,"type","checkbox"),I(p,"class","form-group svelte-1tbpz3x"),I(w,"name","nat-display"),w.checked=k=e[0].natDisplay,I(w,"type","checkbox"),I(z,"class","form-text text-muted svelte-1tbpz3x"),I(b,"class","form-group svelte-1tbpz3x"),I(R,"class","form-group svelte-1tbpz3x"),I(U,"class","form-group svelte-1tbpz3x"),I(B,"class","form-group svelte-1tbpz3x"),I(X,"class","form-group svelte-1tbpz3x"),I(ee,"name","fir-display"),ee.checked=te=e[0].firDisplay,I(ee,"type","checkbox"),I(Y,"class","form-group svelte-1tbpz3x"),I(re,"class","form-group svelte-1tbpz3x"),me.disabled=ge=!e[2],I(me,"class","btn btn-primary btn-sm mb-2 svelte-1tbpz3x"),I(me,"type","button"),ve.disabled=$e=!e[2],I(ve,"class","btn btn-secondary btn-sm mb-2 svelte-1tbpz3x"),I(ve,"type","button"),I(pe,"class","last svelte-1tbpz3x"),I(r,"class","svelte-1tbpz3x"),I(t,"class","settings svelte-1tbpz3x"),G(t,"sidebar",e[3])},m(i,f){C(i,t,f),P(t,n),P(t,o),P(t,r),P(r,s),P(s,a),P(s,l),Te(c,s,null),P(r,u),P(r,p),P(p,d),P(d,m),P(d,g),P(p,h),Te(y,p,null),P(r,$),P(r,b),P(b,x),P(x,w),P(x,E),P(b,M),Te(T,b,null),P(b,_),P(b,z),P(r,D),P(r,R),Te(W,R,null),P(r,N),P(r,U),Te(H,U,null),P(r,q),P(r,B),Te(K,B,null),P(r,Z),P(r,X),Te(J,X,null),P(r,V),P(r,Y),P(Y,Q),P(Q,ee),P(Q,ne),P(r,oe),P(r,re),Te(ie,re,null),P(re,se),Te(ae,re,null),P(re,le),Te(ce,re,null),P(r,ue),P(r,pe),P(pe,me),P(me,fe),P(pe,he),P(pe,ve),P(ve,ye),P(pe,be),Ee&&Ee.m(pe,null),we=!0,ke||(Pe=[j(n,"click",A(e[10])),j(m,"change",e[4]),j(w,"change",e[4]),j(ee,"change",e[4]),j(me,"click",e[7]),j(ve,"click",e[6]),j(r,"submit",A(e[9])),v(En.call(null,t)),j(t,"click_outside",e[11])],ke=!0)},p(e,n){const o={};1&n&&(o.kmlColor=e[0].routeColor),1&n&&(o.selected=e[0].routePin),c.$set(o),(!we||1&n&&f!==(f=e[0].alternateDisplay))&&(m.checked=f);const r={};1&n&&(r.kmlColor=e[0].alternateColor),1&n&&(r.selected=e[0].alternatePin),y.$set(r),(!we||1&n&&k!==(k=e[0].natDisplay))&&(w.checked=k);const i={};1&n&&(i.kmlColor=e[0].natColor),1&n&&(i.selected=e[0].natPin),T.$set(i);const s={};1&n&&(s.kmlColor=e[0].greatCircleColor),1&n&&(s.checked=e[0].greatCircleDisplay),W.$set(s);const a={};1&n&&(a.kmlColor=e[0].ogimetColor),1&n&&(a.checked=e[0].ogimetDisplay),H.$set(a);const l={};1&n&&(l.kmlColor=e[0].etopsColor),1&n&&(l.checked=e[0].etopsDisplay),K.$set(l);const u={};1&n&&(u.selected=e[0].airportPin),1&n&&(u.checked=e[0].airportDisplay),J.$set(u),(!we||1&n&&te!==(te=e[0].firDisplay))&&(ee.checked=te);const p={};1&n&&(p.value=e[0].iconTextChange),ie.$set(p);const d={};1&n&&(d.value=e[0].lineWidthChange),ae.$set(d);const g={};1&n&&(g.value=e[0].iconSizeChange),ce.$set(g),(!we||4&n&&ge!==(ge=!e[2]))&&(me.disabled=ge),(!we||4&n&&$e!==($e=!e[2]))&&(ve.disabled=$e),e[1]?Ee&&(Ee.d(1),Ee=null):Ee?Ee.p(e,n):(Ee=Mn(e),Ee.c(),Ee.m(pe,null)),8&n&&G(t,"sidebar",e[3])},i(e){we||(Ce(c.$$.fragment,e),Ce(y.$$.fragment,e),Ce(T.$$.fragment,e),Ce(W.$$.fragment,e),Ce(H.$$.fragment,e),Ce(K.$$.fragment,e),Ce(J.$$.fragment,e),Ce(ie.$$.fragment,e),Ce(ae.$$.fragment,e),Ce(ce.$$.fragment,e),de((()=>{xe||(xe=Oe(t,Ye,{duration:300,x:200,y:0},!0)),xe.run(1)})),we=!0)},o(e){Le(c.$$.fragment,e),Le(y.$$.fragment,e),Le(T.$$.fragment,e),Le(W.$$.fragment,e),Le(H.$$.fragment,e),Le(K.$$.fragment,e),Le(J.$$.fragment,e),Le(ie.$$.fragment,e),Le(ae.$$.fragment,e),Le(ce.$$.fragment,e),xe||(xe=Oe(t,Ye,{duration:300,x:200,y:0},!1)),xe.run(0),we=!1},d(e){e&&L(t),_e(c),_e(y),_e(T),_e(W),_e(H),_e(K),_e(J),_e(ie),_e(ae),_e(ce),Ee&&Ee.d(),e&&xe&&xe.end(),ke=!1,i(Pe)}}}function Mn(t){let n,o,r;return{c(){n=O("button"),n.textContent="Reset",I(n,"class","btn btn-outline-dark btn-sm reset svelte-1tbpz3x"),I(n,"type","button")},m(e,i){C(e,n,i),o||(r=j(n,"click",t[5]),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function Sn(e){let t,n,o=e[3]&&On(e);return{c(){o&&o.c(),t=T()},m(e,r){o&&o.m(e,r),C(e,t,r),n=!0},p(e,[n]){e[3]?o?(o.p(e,n),8&n&&Ce(o,1)):(o=On(e),o.c(),Ce(o,1),o.m(t.parentNode,t)):o&&(ke(),Le(o,1,1,(()=>{o=null})),Pe())},i(e){n||(Ce(o),n=!0)},o(e){Le(o),n=!1},d(e){o&&o.d(e),e&&L(t)}}}function Fn(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Tn(e,t,n){let o,r,i;c(e,at,(e=>n(3,i=e)));const s=ne(),a=Bt.optionsKML;let{kmlOptions:l}=t,u={...Ft,...Kt.getItem(a)||{}};function p(e){let t=!1;for(const[r,i]of Object.entries(e))l[r]!==i&&(n(0,l[r]=i,l),s("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:i}),t=!0);var o;t&&n(0,l={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=Fn(Ft,l)),257&e.$$.dirty&&n(2,r=!Fn(u,l))},[l,o,r,i,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));l[r]!==o&&(n(0,l[r]=o,l),s("change",{name:t,value:o}))},function(){p(Ft)},function(){p(u)},function(){if(o)Kt.removeItem(a);else{const e={};for(const t of Object.keys(l).filter((e=>l[e]!==Ft[e])))e[t]=l[t];Kt.setItem(a,e)}s("save"),n(8,u={...l})},u,function(t){oe(e,t)},()=>{h(at,i=!i,i)},()=>h(at,i=!1,i)]}class _n extends Ae{constructor(e){super(),je(this,e,Tn,Sn,a,{kmlOptions:0})}}function jn(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function An(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function In(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const zn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"],Dn=(e,t=10,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?10:o},Rn=(e,t=2)=>{const n=e*t;return isNaN(n)?1:n},Wn=(e,t=1,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?1:o};function Nn(e,t,n,o,r){const i=He(t),s=r[`${i}Pin`],a=r[`${i}Display`],l=r[`${i}Color`],c=Dn(r.iconTextChange);e.addSource(`${t}-marker-source`,An(((e,t,n)=>{let o=[];const r=e.length;for(let i=0;i<r;i++){const r=t?t([e[i].longitude,e[i].latitude]):[e[i].longitude,e[i].latitude];r&&o.push(n?n(r,e[i]):r)}return o})(n,o,((e,t)=>jn(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(qn(t,s,l,a,c))}function Un(e,t,n,o,r,i,s,a){o?e.addSource(`${t}-line-source`,An(o(n).map((e=>In(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:In(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(Gn(t,r,i,s,a))}function Hn(e,t,n,o,r,i,s,a){if(o){const r=n.length,i=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)i.push(In(t[e]))}e.addSource(`${t}-line-source`,An(i))}else e.addSource(`${t}-line-source`,An(n.map((e=>In(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(Gn(t,r,i,s,a))}function qn(e,t,n,o,r){const[i,s]=Dt(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":r,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?zn[t]:i,"icon-halo-width":1,"icon-halo-color":"#000","text-color":i,"text-opacity":Math.max(s,.7)}}}function Gn(e,t,n,o=2,r=!1){const[i,s]=Dt(t);return{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":i,"line-opacity":s,"line-width":o,"line-dasharray":r?[10,10]:[1]}}}function Bn(e,t,n=1){const{map:o,value:r,kmlOptions:i}=t,s=`${e}-marker-layer`,a=i[`${He(e)}Pin`];return o.getLayer(s)&&o.setLayoutProperty(s,"icon-size",a?Wn(r,n):.2),!0}function Kn(e,t,n=10){const{map:o,value:r}=t,i=`${e}-marker-layer`;return o.getLayer(i)&&o.setLayoutProperty(i,"text-size",Dn(r,n)),!0}function Zn(e,t,n=2){const{map:o,value:r}=t,i=`${e}-line-layer`;return o.getLayer(i)&&o.setPaintProperty(i,"line-width",Rn(r,n)),!0}function Xn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`;if(n.getLayer(i)&&n.getLayer(r)){const e=o,t=zn[e],s=n.getPaintProperty(r,"line-color");n.setPaintProperty(i,"icon-color",0!==e?t:s),n.setPaintProperty(i,"text-color",s),n.setLayoutProperty(i,"icon-size",0!==e?1:.2),n.setLayoutProperty(i,"icon-image",0!==e?"sdf-marker-15":"sdf-triangle"),n.setLayoutProperty(i,"icon-anchor",0!==e?"bottom":"center")}return!0}function Jn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`,[s,a]=Dt(o);return n.getLayer(r)&&(n.setPaintProperty(r,"line-color",s),n.setPaintProperty(r,"line-opacity",a)),n.getLayer(i)&&n.setPaintProperty(i,"text-color",s),!0}function Vn(e,t,n){const{map:o}=n,r=`${e}-line-layer`,i=`${e}-marker-layer`;return o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(i)&&o.setLayoutProperty(i,"visibility",t?"visible":"none"),!0}const Yn="airport-layer",Qn="airport-emer-layer",eo="airport-source",to=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),no=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],oo=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],ro=e=>0===e?3:0,io=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"],so=(e,t)=>["case",["in",["get","name"],["literal",e]],Dn(t,10),Dn(t,8,1.15)],ao=e=>Dn(e,8,1.15),lo=(e,t)=>["case",["in",["get","name"],["literal",e]],Wn(t,1),Wn(t,.6)],co=e=>["case",["==",2,["get","level"]],Wn(e,.5,1.2),Wn(e,.4,1.2)];function uo(e,t){const{map:n}=e;n.getLayer(Yn)&&n.setLayoutProperty(Yn,"visibility",t?"visible":"none"),n.getLayer(Qn)&&n.setLayoutProperty(Qn,"visibility",t?"visible":"none")}const po=e=>{const t=e.isFake?[]:e.infos.ralts;let n=[];return e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(n=[e.infos.EEP.name,e.infos.EXP.name]),[t,n.concat(t)]};var mo={show:e=>uo(e,!0),hide:e=>uo(e,!1),add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r}=e,{affineOrDrop:i}=n,s=i;let a=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(a=[o.infos.EEP,o.infos.EXP]);const l=o.isFake?o.isFake:o.infos.aircraft,c=o.infos.raltPoints,u=r.etopsColor,p=r.airportPin,d=r.airportDisplay,[m]=Dt(u),f=a.map((e=>e.name)),g=c.map((e=>e.name)),h=f.concat(g);fetch("data/airports.2103.geojson").then((e=>e.json())).then((e=>{if(s){const t=[];for(let n of e.features)n.geometry.coordinates=s(n.geometry.coordinates),void 0!==n.geometry.coordinates&&t.push(n);e.features=t}t.addSource(eo,{type:"geojson",data:e}),t.addLayer({id:Qn,type:"symbol",source:eo,layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":co(r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":ao(r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:no(l,!1)}),t.addLayer({id:Yn,type:"symbol",source:eo,layout:{"icon-image":["case",["in",["get","name"],["literal",h]],"sdf-triangle","sdf-airport"],"icon-size":lo(h,r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":so(h,r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":oo(l,h)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":ro(p),"icon-color":to(p,l,g,m),"text-color":io(g,m),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:no(l)});const n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!We}),o=function(e){const o=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.title;for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;n.setLngLat(o).setHTML(r).addTo(t)},i=()=>t.getCanvas().style.cursor="pointer",a=()=>t.getCanvas().style.cursor="",c=function(){a(),n.remove()};We?(t.on("mouseenter",Yn,(e=>{i(),o(e)})),t.on("mouseenter",Qn,(e=>{i(),o(e)})),t.on("mouseleave",Yn,c),t.on("mouseleave",Qn,c)):(t.on("mouseenter",Yn,i),t.on("mouseenter",Qn,i),t.on("click",Yn,o),t.on("click",Qn,o),t.on("mouseleave",Yn,a),t.on("mouseleave",Qn,a))}))},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,i=o.isFake?[]:o.infos.ralts,[s]=Dt(n.etopsColor),a=n.airportPin;t.getLayer(Yn)&&(t.setPaintProperty(Yn,"icon-color",to(a,r,i,s)),t.setPaintProperty(Yn,"text-color",io(i,s)),t.setPaintProperty(Yn,"icon-halo-width",ro(a)))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,[i,s]=po(r),[a]=Dt(n.etopsColor),l=n.airportPin;t.setFilter(Yn,no(o)),t.setPaintProperty(Yn,"icon-color",to(l,o,i,a)),t.setLayoutProperty(Yn,"symbol-sort-key",oo(o,s)),t.setFilter(Qn,no(o,!1))},changeIconText:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=po(o);t.getLayer(Yn)&&t.setLayoutProperty(Yn,"text-size",so(r,n.iconTextChange)),t.getLayer(Qn)&&t.setLayoutProperty(Qn,"text-size",ao(n.iconTextChange))},changeIconSize:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=po(o);t.getLayer(Yn)&&t.setLayoutProperty(Yn,"icon-size",lo(r,n.iconSizeChange)),t.getLayer(Qn)&&t.setLayoutProperty(Qn,"icon-size",co(n.iconSizeChange))}};const fo="etops-ep-circle-line-layer",go="etops-etops-circle-line-layer";function ho(e,t){const{map:n}=e;n.getLayer(go)&&n.setLayoutProperty(go,"visibility",t?"visible":"none"),n.getLayer(fo)&&n.setLayoutProperty(fo,"visibility",t?"visible":"none")}var vo={show:e=>ho(e,!0),hide:e=>ho(e,!1),add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(o.isFake)return;const i=Rn(r.lineWidthChange,1);if(o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n;o.infos.EEP,o.infos.EXP;const s=o.infos.ETOPS,a=r.etopsDisplay;Hn(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,a,i,!0),Hn(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*s))),e,r.etopsColor,a,i,!0)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=Dt(e.value);t.getLayer(go)&&(t.setPaintProperty(go,"line-color",n),t.setPaintProperty(go,"line-opacity",o))}(e),changeLineWidth:function(e){const{map:t,value:n}=e,o=Rn(n,1);return t.getLayer(go)&&t.setPaintProperty(go,"line-width",o),t.getLayer(fo)&&t.setPaintProperty(fo,"line-width",o),!0}};const yo="fir-reg-line-layer",$o="fir-reg-layer",bo="fir-reg-source";function xo(e,t){const{map:n}=e;n.getLayer($o)&&n.setLayoutProperty($o,"visibility",t?"visible":"none"),n.getLayer(yo)&&n.setLayoutProperty(yo,"visibility",t?"visible":"none")}var wo={show:e=>xo(e,!0),hide:e=>xo(e,!1),add:e=>{const{map:t,mapData:n,kmlOptions:o,mapOptions:r}=e;if("jb_pacific"===r.id)return;const{affine:i}=n,s=o.firDisplay;fetch("data/fir-reg.2103.geojson").then((e=>e.json())).then((e=>{if(i)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>i(e)))]}t.addSource(bo,{type:"geojson",data:e}),t.addLayer({id:$o,type:"fill",source:bo,layout:{visibility:s?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),t.addLayer({id:yo,type:"line",source:bo,layout:{visibility:s?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))}};const ko="great-circle";var Po={show:Vn.bind(null,ko,!0),hide:Vn.bind(null,ko,!1),add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r}=e;if(t.isFake)return;const{affineAndClip:i}=o,s=`${t.infos.departure}-${t.infos.destination}`,a=t.route,l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${s}`});Un(r,ko,l.points,i,n.greatCircleColor,n.greatCircleDisplay)},changeLine:Jn.bind(null,ko)};const Co="ogimet";var Lo={show:Vn.bind(null,Co,!0),hide:Vn.bind(null,Co,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i}=r;Un(t,Co,n.ogimetData.route.points,i,o.ogimetColor,o.ogimetDisplay)},changeLine:Jn.bind(null,Co)};const Eo="ralt";var Oo={show:Vn.bind(null,Eo,!0),hide:Vn.bind(null,Eo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:s}=r,a=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route Dégagement"});Un(t,Eo,a.points,i,o.alternateColor,o.alternateDisplay),Nn(t,Eo,a.points,s,o)},changeLine:Jn.bind(null,Eo),changeMarker:Xn.bind(null,Eo),changeIconText:Kn.bind(null,Eo),changeLineWidth:Zn.bind(null,Eo),changeIconSize:Bn.bind(null,Eo)};const Mo="rmain";var So={show:Vn.bind(null,Mo,!0),hide:Vn.bind(null,Mo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:s}=r,a=n.route;a.name=`${n.infos.departure}-${n.infos.destination}`,a.description=n.description,Un(t,Mo,a.points,i,o.routeColor,!0),Nn(t,Mo,a.points,s,o)},changeLine:e=>Jn(Mo,e)&&function(e){const{map:t,kmlOptions:n}=e,[o,r]=Dt(n.routeColor);t.getLayer(fo)&&(t.setPaintProperty(fo,"line-color",o),t.setPaintProperty(fo,"line-opacity",r))}(e),changeMarker:Xn.bind(null,Mo),changeIconText:Kn.bind(null,Mo),changeLineWidth:Zn.bind(null,Mo),changeIconSize:Bn.bind(null,Mo)};const Fo="rnat";const To={airport:mo,etops:vo,fir:wo,greatcircle:Po,ogimet:Lo,ralt:Oo,rmain:So,rnat:{show:e=>Vn(Fo,!0,e)&&Vn("rnat-incomplete",!0,e),hide:e=>Vn(Fo,!1,e)&&Vn("rnat-incomplete",!1,e),add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r}=e;if(n.isFake)return;const{affineOrDrop:i,affineAndClip:s}=o,a=i,l=s,c=r.natColor,u=r.natPin,p=r.natDisplay,d={rnat:[],"rnat-incomplete":[]},m={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(l){const n=l(e.points),o=n.length;for(let r=0;r<o;r++)d[t].push(In(n[r],e.name))}else d[t].push(In(e.points.map((e=>[e.longitude,e.latitude])),e.name));const n=e.points[0];let o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude];if(o&&m[t].push(jn(o,`${e.name}\n${n.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude],o&&m[t].push(jn(o,`${e.name}\n${n.name}`,e.description))}}t.addSource("rnat-marker-source",An(m.rnat)),t.addSource("rnat-incomplete-marker-source",An(m["rnat-incomplete"])),t.addSource("rnat-line-source",An(d.rnat)),t.addSource("rnat-incomplete-line-source",An(d["rnat-incomplete"]));const f=Dn(r.iconTextChange,10),g=Rn(r.lineWidthChange,1);t.addLayer(Gn("rnat",c,p,g)),t.addLayer(Gn("rnat-incomplete",r.natIncompleteColor,p,g)),t.addLayer(qn("rnat",u,c,p,f)),t.addLayer(qn("rnat-incomplete",u,c,p,f));const h=e=>{for(var n=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties.description;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(t)},v=e=>{const n=e+"-marker-layer";t.on("click",n,h),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};v("rnat"),v("rnat-incomplete")},changeLine:Jn.bind(null,Fo),changeMarker:Xn.bind(null,Fo),changeIconText:function(e){const{map:t,value:n}=e,o=Dn(n,10);return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","text-size",o),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","text-size",o),!0},changeLineWidth:function(e){const{map:t,value:n}=e,o=Rn(n,1);return t.getLayer("rnat-line-layer")&&t.setPaintProperty("rnat-line-layer","line-width",o),t.getLayer("rnat-incomplete-line-layer")&&t.setPaintProperty("rnat-incomplete-line-layer","line-width",o),!0},changeIconSize:function(e){const{map:t,value:n,kmlOptions:o}=e,r=o.natPin?Wn(n,1):.2;return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","icon-size",r),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","icon-size",r),!0}}},_o=2*Math.PI,jo=Math.PI/4,Ao=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*_o};var Io={init:function(){},forward:function(e){var t=e.x,n=e.y,o=Ao(t-this.long0),r=Math.tan(n/2),i=Math.sin(jo*r),s=i*i,a=this.x0+this.a*o*(.74482-.34588*s),l=this.y0+1.70711*this.a*r;return e.x=a,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(jo*t),o=n*n,r=Ao(this.long0+e.x/this.a/(.74482-.34588*o)),i=2*Math.atan(t);return e.x=r,e.y=i,e},names:["The Times","times"]};function zo(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(Io);let i={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${t.id.startsWith("jb_")?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const s=new mapboxgl.Map({...t.mapboxOptions,...i});let a,l,c,u;s._setCacheLimits(320,32),s.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||s.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||s.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||s.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-star-sdf.png",(function(e,t){e||s.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let p,d=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const i=[-20026376.39,-20048966.1,20026376.39,20048966.1],s=i[2]-i[0],a=i[3]-i[1],[l,c,u,p]=t.extent,[d,m]=t.ratio,f=s/d*m*(a/s),[g,h,v,y]=[i[0],i[3]-f,i[2],i[3]];e=(v-g)/(u-l),n=g-e*l,o=(y-h)/(p-c),r=h-o*c}else{const[i,s,a,l]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(a-i),n=c-e*i,o=(d-u)/(l-s),r=u-o*s}const[i,s,p,f]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>m(h(e));d=e=>h(g(e)),a=e=>m(d(e)),l=e=>{let[t,n]=g(e);return t=qe(t,i,p),n=qe(n,s,f),v([t,n])},c=e=>{let[t,n]=g(e);if(Ge(t,i,p)&&Ge(n,s,f))return v([t,n])},u=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,i,s,a,l=e.length,c=Ke(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],s=a=Ke(i=e[o],t);;){if(!(c|s)){u.push(r),s!==a?(u.push(i),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(i);break}if(c&s)break;c?c=Ke(r=Be(r,i,c,t),t):s=Ke(i=Be(r,i,s,t),t)}c=a}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let f=[];if(!n.isFake){for(const e of n.tracks)f=f.concat(e.points);f=f.concat(n.route.points,n.wptCoordinatesAlternate()),p=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(f,l),s.fitBounds(p,{padding:{top:30,bottom:80,left:30,right:30}})}const g=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(a){const e=g._onSuccess;g._onSuccess=function(t){const[n,o]=a([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const h={map:s,affine:a,affineAndClamp:l,affineAndClip:u,affineOrDrop:c,bbox:p,mapOptions:t,geolocate:g};return s.addControl(new class{onAdd(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl  mapboxgl-ctrl-group",this._button=document.createElement("button"),this._button.className="mapboxgl-ctrl-layers",this._button.setAttribute("type","button"),this._button.setAttribute("title","Personnaliser la carte"),this._button.innerHTML='<svg><use xlink:href="#layers-symbol"/></svg>',this._container.appendChild(this._button),this._toggleSidebar=()=>at.update((e=>!e)),this._button.addEventListener("click",this._toggleSidebar),this._container}onRemove(){this._button.removeEventListener("click",this._toggleSidebar),this._container.parentNode.removeChild(this._container),this._map=void 0}}),s.addControl(g),s.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),Object.values(To).forEach((t=>t.add&&t.add(e)))})({ofp:n,kmlOptions:o,mapData:h,map:s,mapOptions:t}),r&&r(s,t)})),h}class Do{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const i=indexedDB.open(e,t);i.onsuccess=()=>{o(i)},i.onerror=()=>{r("Error while opening DB")},i.onupgradeneeded=n?n.bind(null,i):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const i=n.result.transaction(t,"readonly").objectStore(t).get(e);i.onsuccess=()=>{o(i.result)},i.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,i)=>{const s=o.result.transaction(t,"readwrite").objectStore(t),a=s.put(n,e);a.onsuccess=()=>{const t=s.get(e);t.onsuccess=()=>{r(t.result)}},a.onerror=()=>{i("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,i)=>{const s=o.result.transaction(e,"readonly").objectStore(e).getKey(n);s.onsuccess=()=>{r(void 0===s.result?t:null)},s.onerror=()=>{i("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function Ro(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Wo(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const No=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(!n)return[];const i=new Do("lido-tiles");if(o.cacheAll){const e=await i.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return i.close(),caches[o.id]=!0,[]}const[s,a]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,p;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:Ro(s[0],e),y:Wo(s[1],e)},r={x:Ro(a[0],e),y:Wo(a[1],e)}),o.matrix?[u,p]=o.matrix[e]:[u,p]=[c,c];for(let s=t.x;s<=r.x;s++)for(let a=r.y;a<=t.y;a++)if(s>=0&&a>=0&&s<u&&a<p){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",s).replace("{y}",a)),l.push(i.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.63g5ah66/${e}/${s}/${a}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${e}/${s}/${a}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return i.close(),c.filter((e=>null!==e))};function Uo(e){let t,n,o,r,i,s;const a=e[4].default,l=u(a,e,e[3],null);return{c(){t=M("svg"),n=M("path"),o=M("path"),i=F(),l&&l.c(),I(n,"d","M50,5A45 45 0 1 1 49.9999 5"),I(n,"class","svelte-1bp2w4i"),I(o,"d",r=e[0]()),I(o,"class","svelte-1bp2w4i"),I(t,"viewBox","0 0 100 100"),I(t,"class","svelte-1bp2w4i")},m(e,r){C(e,t,r),P(t,n),P(t,o),C(e,i,r),l&&l.m(e,r),s=!0},p(e,[t]){(!s||1&t&&r!==(r=e[0]()))&&I(o,"d",r),l&&l.p&&8&t&&d(l,a,e,e[3],t,null,null)},i(e){s||(Ce(l,e),s=!0)},o(e){Le(l,e),s=!1},d(e){e&&L(t),e&&L(i),l&&l.d(e)}}}function Ho(e,t,n){let o,{$$slots:r={},$$scope:i}=t,{value:s=0}=t,{max:a=100}=t;return e.$$set=e=>{"value"in e&&n(1,s=e.value),"max"in e&&n(2,a=e.max),"$$scope"in e&&n(3,i=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(s<=0)return"";if(s>=a)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(s/a),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,s,a,i,r]}class qo extends Ae{constructor(e){super(),je(this,e,Ho,Uo,a,{value:1,max:2})}}function Go(e,t,n){const o=e.slice();return o[16]=t[n],o}function Bo(t){let n,o,r,i,s;return{c(){n=O("label"),o=S("Changer"),r=O("input"),I(r,"id",er),I(r,"name",er),I(r,"type","file"),I(r,"accept","application/pdf"),r.hidden=!0,I(n,"class","btn btn-outline-secondary btn-sm svelte-zl0ce")},m(e,a){C(e,n,a),P(n,o),P(n,r),i||(s=j(r,"change",t[6]),i=!0)},p:e,d(e){e&&L(n),i=!1,s()}}}function Ko(e){let t,n,o,r,s,a,l;return{c(){t=O("div"),n=O("input"),o=F(),r=O("label"),s=S(e[1]),I(n,"id",er),I(n,"name",er),I(n,"type","file"),I(n,"accept","application/pdf"),n.disabled=e[0],I(n,"class","custom-file-input svelte-zl0ce"),I(r,"class","custom-file-label text-truncate svelte-zl0ce"),I(r,"for",er),G(r,"ready",e[2]),I(t,"class","custom-file svelte-zl0ce"),G(t,"blink",!e[3])},m(i,c){C(i,t,c),P(t,n),P(t,o),P(t,r),P(r,s),a||(l=[j(n,"change",e[6]),j(n,"click",e[5],{once:!0})],a=!0)},p(e,o){1&o&&(n.disabled=e[0]),2&o&&W(s,e[1]),4&o&&G(r,"ready",e[2]),8&o&&G(t,"blink",!e[3])},d(e){e&&L(t),a=!1,i(l)}}}function Zo(e){let t,n,o,r,s,a=Yo,l=[];for(let t=0;t<a.length;t+=1)l[t]=Xo(Go(e,a,t));return{c(){t=O("div"),n=O("select"),o=O("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,I(n,"class","form-control-sm svelte-zl0ce"),n.disabled=e[0],I(t,"class","footer svelte-zl0ce")},m(i,a){C(i,t,a),P(t,n),P(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);r||(s=[j(n,"click",e[5],{once:!0}),j(n,"change",e[7])],r=!0)},p(e,t){if(0&t){let o;for(a=Yo,o=0;o<a.length;o+=1){const r=Go(e,a,o);l[o]?l[o].p(r,t):(l[o]=Xo(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}1&t&&(n.disabled=e[0])},d(e){e&&L(t),E(l,e),r=!1,i(s)}}}function Xo(t){let n,o,r=t[16]+"";return{c(){n=O("option"),o=S(r),n.__value=t[16],n.value=n.__value},m(e,t){C(e,n,t),P(n,o)},p:e,d(e){e&&L(n)}}}function Jo(t){let n,o,r,i;function s(e,t){return e[4]?Bo:Ko}let a=s(t),l=a(t),c=!t[3]&&Zo(t);return{c(){n=O("form"),l.c(),o=F(),c&&c.c(),I(n,"class","form-inline")},m(e,s){C(e,n,s),l.m(n,null),P(n,o),c&&c.m(n,null),r||(i=j(n,"submit",A(t[9])),r=!0)},p(e,[t]){a===(a=s(e))&&l?l.p(e,t):(l.d(1),l=a(e),l&&(l.c(),l.m(n,o))),e[3]?c&&(c.d(1),c=null):c?c.p(e,t):(c=Zo(e),c.c(),c.m(n,null))},i:e,o:e,d(e){e&&L(n),l.d(),c&&c.d(),r=!1,i()}}}const Vo=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.16.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.16.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"script",url:"https://unpkg.com/pinch-zoom-element-js@1.1.2/dist/pinch-zoom-min.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],Yo=["318","319","320","321","330","340","350","380","787","772","773","77F"],Qo=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let er="file";function tr(e,t,n){let o,r,i,s;c(e,lt,(e=>n(11,o=e))),c(e,dt,(e=>n(12,r=e))),c(e,pt,(e=>n(3,i=e))),c(e,ft,(e=>n(4,s=e)));let a,{kmlOptions:l}=t,u=!1,p=new Ie,d="Choisir un OFP",m=!1;const f=ne();function g(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const i="script"===e,s=document.createElement(i?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(s.crossOrigin="anonymous");let a=!0;i?(s.src=t,s.async=n.async,s.defer=n.defer):(s.href=t,"prefetch"in n?(s.rel="prefetch",o-=1,a=!1):"preload"in n?(s.rel="preload",o-=1,a=!1):(s.rel="stylesheet",o-=1,a=!1)),a&&(s.onload=r),document.body.appendChild(s)}))}(Vo,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",a&&!a.destroyed||(a=new e.PDFWorker),p.resolve(!0),n(2,m=!0)}))}const v=e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onload=e=>{if(!a||a.destroyed){const e=window["pdfjs-dist/build/pdf"];a=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,i=r.numPages;for(let e=1;e<=i;e+=1){const t=await Qo(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:a}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const i=editolido.ogimetData(t,r);i.proxyImg=`https://ofp2map-gramet.vercel.app/api/${i.proxy}__${i.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,i.route.description=i.wmo.join(" "),t.ogimetData=i;let s=0,a=t.infos.fl;const c=t.route.segments.map((([e,t])=>(s+=e.distanceTo(t),[t,s,a])));c.unshift([t.route.points[0],0]),t.distanceMatrix=c;let u=[];try{u=t.wptNamesEET(t.route.points)}catch(e){}0===u.length?document.body.style.setProperty("--plane-halo-color","red"):document.body.style.setProperty("--plane-halo-color","var(--plane-color)"),t.timeMatrix=u;try{_t(),function(e,t){let n={...Ft,...t};const o=_t();Tt(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const i=`${e.infos.departure}-${e.infos.destination}`,s=new editolido.Route(e.wptCoordinates(),{name:i,description:r}),a=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),l=new editolido.Route([s.points[0],s.points[s.points.length-1]]).split(300,{name:`Ortho ${i}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",s),o.addPoints("rmain",s,{excluded:c}),o.addLine("ralt",a),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",a)}(t,l),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>{o(e)}))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(8,l=e.kmlOptions)},[u,d,m,i,s,g,async function(e){n(0,u=!0),h(lt,o=!1,o),g(),await p.promise.then((()=>{const t=e.target.files[0],o=e.target.closest("form");t&&(h(dt,r="loading",r),n(1,d=e.target.value.split(/([\\/])/g).pop()),f("change",d),v(t).then((t=>{h(pt,i=t,i),h(dt,r="success",r),o.blur(),e.target.blur(),o.reset()}),(e=>{h(dt,r=e,r),o.reset()})),window.location.hash="#/map")})),n(0,u=!1)},async function(e){n(0,u=!0),h(dt,r="loading",r),g(),await p.promise.then((()=>{let t=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");try{_t(),t.isFake=e.target.value,h(pt,i=t,i),h(dt,r="success",r)}catch(e){h(dt,r=e,r)}window.location.hash="#/map"})),n(0,u=!1)},l,function(t){oe(e,t)}]}class nr extends Ae{constructor(e){super(),je(this,e,tr,Jo,a,{kmlOptions:8})}}function or(e){const t=()=>{document&&document.visibilityState&&"visible"!==document.visibilityState&&e&&e.blur&&e.blur()};return document.addEventListener("visibilitychange",t,!1),{destroy(){document.removeEventListener("visibilitychange",t)}}}function rr(e,t,n){const o=e.slice();return o[6]=t[n],o}function ir(e){let t;return{c(){t=O("option"),t.textContent="???",t.__value="???",t.value=t.__value,t.selected=!0},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function sr(e){let t,n,o,r=e[6]+"";return{c(){t=O("option"),n=S(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&L(t)}}}function ar(t){let n,o,r,s,a="???"===t[0]&&ir(),l=Yo,c=[];for(let e=0;e<l.length;e+=1)c[e]=sr(rr(t,l,e));return{c(){n=O("select"),a&&a.c(),o=T();for(let e=0;e<c.length;e+=1)c[e].c();I(n,"name","aircraftType"),I(n,"class","svelte-1xpiicm"),void 0===t[0]&&de((()=>t[5].call(n)))},m(e,i){C(e,n,i),a&&a.m(n,null),P(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[4](n),H(n,t[0]),r||(s=[j(n,"change",t[5]),j(n,"change",t[3]),v(or.call(null,n))],r=!0)},p(e,[t]){if("???"===e[0]?a||(a=ir(),a.c(),a.m(n,o)):a&&(a.d(1),a=null),1&t){let o;for(l=Yo,o=0;o<l.length;o+=1){const r=rr(e,l,o);c[o]?c[o].p(r,t):(c[o]=sr(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}1&t&&H(n,e[0])},i:e,o:e,d(e){e&&L(n),a&&a.d(),E(c,e),t[4](null),r=!1,i(s)}}}function lr(e,t,n){let{selectedAircraft:o="???"}=t,{aircraftTypeSelectElement:r=null}=t,{ofp:i}=t;return ee((()=>{"???"===o&&i&&n(0,o=i.isFake?i.isFake:i.infos.aircraft),-1===Yo.indexOf(o)&&n(0,o="???")})),e.$$set=e=>{"selectedAircraft"in e&&n(0,o=e.selectedAircraft),"aircraftTypeSelectElement"in e&&n(1,r=e.aircraftTypeSelectElement),"ofp"in e&&n(2,i=e.ofp)},[o,r,i,function(t){oe(e,t)},function(e){ie[e?"unshift":"push"]((()=>{r=e,n(1,r)}))},function(){o=q(this),n(0,o)}]}class cr extends Ae{constructor(e){super(),je(this,e,lr,ar,a,{selectedAircraft:0,aircraftTypeSelectElement:1,ofp:2})}}function ur(e,t,n){let o,r;c(e,wt,(e=>n(1,o=e)));let{mapData:i}=t;const s=window.document.createElement("div");s.classList.add("mapboxgl-user-location-dot","map-plane");const a=e=>{if(r){const t=i.affine,[n,o]=t?t([e.longitude,e.latitude]):[e.longitude,e.latitude];r.setLngLat([n,o])}};return ee((()=>{r=new mapboxgl.Marker(s),a(o.map),r.addTo(i.map)})),te((()=>{r&&(r.remove(),r=void 0)})),e.$$set=e=>{"mapData"in e&&n(0,i=e.mapData)},e.$$.update=()=>{2&e.$$.dirty&&a(o.map)},[i,o]}class pr extends Ae{constructor(e){super(),je(this,e,ur,null,a,{mapData:0})}}const dr={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},mr=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,fr=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv1",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:dr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:mr},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:dr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:mr},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:dr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:mr},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:dr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:mr}];function gr(e,t,n){const o=e.slice();return o[6]=t[n],o[8]=n,o}function hr(e){let t,n,o,r=(e[6].proj4&&e[2](e[6])?`${e[6].label.toUpperCase()}`:e[6].label)+"";return{c(){t=O("option"),n=S(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6].id===e[0].id},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[6].id===e[0].id)&&(t.selected=o)},d(e){e&&L(t)}}}function vr(t){let n,o,r,s=fr,a=[];for(let e=0;e<s.length;e+=1)a[e]=hr(gr(t,s,e));return{c(){n=O("select");for(let e=0;e<a.length;e+=1)a[e].c();I(n,"name",t[1]),I(n,"class","form-control form-control-sm svelte-1uc3ace"),void 0===t[0]&&de((()=>t[5].call(n)))},m(e,i){C(e,n,i);for(let e=0;e<a.length;e+=1)a[e].m(n,null);H(n,t[0]),o||(r=[j(n,"change",t[5]),j(n,"change",t[4]),v(or.call(null,n))],o=!0)},p(e,[t]){if(5&t){let o;for(s=fr,o=0;o<s.length;o+=1){const r=gr(e,s,o);a[o]?a[o].p(r,t):(a[o]=hr(r),a[o].c(),a[o].m(n,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=s.length}2&t&&I(n,"name",e[1]),1&t&&H(n,e[0])},i:e,o:e,d(e){e&&L(n),E(a,e),o=!1,i(r)}}}function yr(e,t,n){let{name:o="map-style"}=t,{ofp:r}=t,{selected:i=fr[0]}=t;return ee((()=>{if(i.id===fr[0].id&&r&&!r.isFake){const e=r.route.points[0],t=r.route.points[r.route.points.length-1];t.latitude>30&&e.latitude>30?n(0,i=fr[1]):t.longitude<-80&&e.longitude<-80?n(0,i=fr[3]):n(0,i=fr[2])}})),e.$$set=e=>{"name"in e&&n(1,o=e.name),"ofp"in e&&n(3,r=e.ofp),"selected"in e&&n(0,i=e.selected)},[i,o,function(e){if(!e.proj4||!r||r.isFake)return!0;const t=r.route.points[0],n=r.route.points[r.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},r,function(t){oe(e,t)},function(){i=q(this),n(0,i)}]}class $r extends Ae{constructor(e){super(),je(this,e,yr,vr,a,{name:1,ofp:3,selected:0})}}function br(t){let n,o,r,s,a,l,c,u=t[2]>=0?"◼︎":"▶︎";return{c(){n=O("label"),o=S(u),r=F(),s=O("input"),I(s,"name",t[0]),I(s,"type","checkbox"),s.checked=a=t[2]>=0,I(s,"class","svelte-1t9v15q"),I(n,"for",t[0]),I(n,"class","svelte-1t9v15q")},m(e,i){C(e,n,i),P(n,o),P(n,r),P(n,s),t[4](s),l||(c=[j(s,"change",t[3]),j(n,"click",t[3])],l=!0)},p(e,[t]){4&t&&u!==(u=e[2]>=0?"◼︎":"▶︎")&&W(o,u),1&t&&I(s,"name",e[0]),4&t&&a!==(a=e[2]>=0)&&(s.checked=a),1&t&&I(n,"for",e[0])},i:e,o:e,d(e){e&&L(n),t[4](null),l=!1,i(c)}}}function xr(e,t,n){let o;c(e,ut,(e=>n(2,o=e)));let r,{name:i="simulator"}=t;return e.$$set=e=>{"name"in e&&n(0,i=e.name)},[i,r,o,()=>{n(1,r.checked=!r.checked,r),h(ut,o=r.checked?0:-1,o)},function(e){ie[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class wr extends Ae{constructor(e){super(),je(this,e,xr,br,a,{name:0})}}const kr=tt(),Pr=tt({});function Cr(e,{ofp:t,pos:n,fl:o}){const r=document.getElementById("gt-plane");let i,s,a,l,c,u=parseFloat(n),p=t,d=o;const m=e.clientHeight,f=e.clientWidth,g=getComputedStyle(document.body),h=parseFloat(g.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),v=e=>65*c+(l-130*c)*e/100,y=e=>{const t=v(e),n=65*c,o=f/3,r=n+o,i=l-n-(f-o);return t>r&&t<i?o-t:t<=r?o-r:o-i},$=(e,t,n,o)=>{e&&(e.style.left=n+(v(t)-e.clientWidth/2)+"px",e.style.top=(h-Math.round(-6e-4*o*o+.8985*o+46.264))*c-e.clientHeight/2+"px")},b=()=>{const t=s.height||700;a=s.cloneNode(),a.id="grametImg",a.style.display="none",a.crossOrigin="anonymous",a.addEventListener("load",x),a.addEventListener("error",w),document.body.appendChild(a),s.style.height=t/h*m+"px",s.style.objectFit="contain",s.style.position="absolute",s.style.opacity=.01,e.appendChild(s),l=s.clientWidth;const n=s.clientHeight/t;c=n;const o=y(u);s.style.top=`-${33*n}px`,s.style.left=`${o}px`},x=()=>{kr.set("success"),r.style.display="block",s.style.opacity=1;const e=y(u);$(r,u,e,d)},w=()=>{r.style.display="none",kr.set("error")},k=()=>{s&&s.removeEventListener("load",b),s&&s.removeEventListener("error",w),s&&s.remove(),lt.set(!1),a&&a.removeEventListener("load",x),a&&a.removeEventListener("error",w),a&&a.remove(),a=void 0,s=void 0,i&&URL.revokeObjectURL(i),i=void 0},P=async e=>{s=document.createElement("img"),kr.set("loading"),r.style.display="none",fetch(e.ogimetData.proxyImg).then((function(e){e.ok?(Pr.set({status:e.status,text:e.statusText||"OK"}),e.blob().then((e=>{i=URL.createObjectURL(e),s.addEventListener("load",b),s.addEventListener("error",w),s.src=i}))):(w(),e.headers?Pr.set({status:e.status,text:e.statusText||e.headers.get("X-ofp2map-status")}):Pr.set({status:e.status,text:e.statusText||""}))})).catch((function(e){w(),Pr.set({status:0,text:e.message})}))};return P(t),{update({ofp:e,pos:t,fl:n}){if(u=parseFloat(t),e!==p)p=e,k(),P(e);else{const e=y(u);s.style.left=e+"px",d=n,$(r,u,e,n)}},destroy(){k()}}}const Lr=(e,{pos:t,fl:n})=>{const o=e.parentNode.querySelector("svg"),r=document.getElementById("grametImg"),i=getComputedStyle(document.body),s=parseFloat(i.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),a=parseFloat(e.parentNode.dataset.maxHeight||"370"),l=r.width,c=r.height,u=document.querySelector("nav").clientWidth;let p;p=0!==l?Math.min(u/l*c,a):Math.min(c,a);let d,m,f=parseFloat(t),g=0,h=0,v=n;const y=e=>(65+(l-130)*e/100)*d,$=(e,t,n)=>{e.style.left=g+(y(t)-e.clientWidth+2)+"px",e.style.top=(s+33-2-Math.round(-6e-4*n*n+.8985*n+46.264))*d-e.clientHeight/2+h+"px"},b=e=>{const t=y(e),n=u/3,o=0+n,r=l*d-0-(u-n);return t>o&&t<r?n-t:t<=o?n-o:n-r},x=()=>{g=e.x,h=e.y,d=e.scale,m=u<=l*d,$(o,f,v)};return f<=0||f>=100?(d=0===l?a/(s+70):Math.min(u/l,p/(s+70)),h=0):(d=p/s,h=-33*d),u>l*d?(g=(u-l*d)/2,m=!1):(g=b(f),m=!0),$(o,f,v),r.style.display="block",e.style.maxHeight=`${a}px`,e.appendChild(r),e.setTransform({scale:d,x:g,y:h}),e.addEventListener("change",x),{update({pos:t,fl:n}){f=parseFloat(t),v=n,m&&(g=b(f),e.setTransform({x:g})),$(o,f,n)},destroy(){r.style.display="none",document.body.appendChild(r),e.removeEventListener("change",x)}}},Er=e=>{const t=document.getElementById("grametImg"),n=t.width,o=t.height||700,r=parseFloat(e.dataset.maxHeight||"370"),i=document.querySelector("nav").clientWidth;let s=1;0!==n&&(s=i/n);const a=Math.min(s*o,r);e.style.height=`${a}px`};function Or(e){let t,n;return t=new wr({}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Mr(e){let t,n,o,r,a,l,c,u,p,d,m,f=(0===e[0].gramet||100===e[0].gramet||e[1]>=0)&&Or();return{c(){var e,o,i;t=O("div"),n=O("pinch-zoom"),r=F(),a=M("svg"),l=M("use"),c=F(),f&&f.c(),i="0.3",(o="min-scale")in(e=n)?e[o]=i:I(e,o,i),D(l,"xlink:href","#plane-symbol"),I(a,"class","svelte-dwqlg"),I(t,"class","pinch-zoom-parent svelte-dwqlg"),I(t,"data-max-height",Sr)},m(i,s){C(i,t,s),P(t,n),P(t,r),P(t,a),P(a,l),P(t,c),f&&f.m(t,null),p=!0,d||(m=[v(o=Lr.call(null,n,{pos:e[0].gramet,fl:e[0].fl})),v(Er.call(null,t))],d=!0)},p(n,[r]){e=n,o&&s(o.update)&&1&r&&o.update.call(null,{pos:e[0].gramet,fl:e[0].fl}),0===e[0].gramet||100===e[0].gramet||e[1]>=0?f?3&r&&Ce(f,1):(f=Or(),f.c(),Ce(f,1),f.m(t,null)):f&&(ke(),Le(f,1,1,(()=>{f=null})),Pe())},i(e){p||(Ce(f),de((()=>{u||(u=Oe(t,Ye,{y:Sr},!0)),u.run(1)})),p=!0)},o(e){Le(f),u||(u=Oe(t,Ye,{y:Sr},!1)),u.run(0),p=!1},d(e){e&&L(t),f&&f.d(),e&&u&&u.end(),d=!1,i(m)}}}const Sr=370;function Fr(e,t,n){let o,r;return c(e,wt,(e=>n(0,o=e))),c(e,ut,(e=>n(1,r=e))),[o,r]}class Tr extends Ae{constructor(e){super(),je(this,e,Fr,Mr,a,{})}}function _r(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const i=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",i,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",i),n&&n.remove()}}}function jr(e){let t,n,o,r,i;return n=new qo({props:{value:e[9],max:e[8],$$slots:{default:[Ar]},$$scope:{ctx:e}}}),{c(){t=O("div"),Fe(n.$$.fragment),I(t,"class","cacheButton svelte-1nye16d"),G(t,"cacheError",e[10]),G(t,"cacheProgress",e[9]>0||e[8]>0)},m(a,l){C(a,t,l),Te(n,t,null),o=!0,r||(i=j(t,"click",(function(){s(e[12]?Wr:e[21])&&(e[12]?Wr:e[21]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const i={};512&r[0]&&(i.value=e[9]),256&r[0]&&(i.max=e[8]),536870912&r[0]&&(i.$$scope={dirty:r,ctx:e}),n.$set(i),1024&r[0]&&G(t,"cacheError",e[10]),768&r[0]&&G(t,"cacheProgress",e[9]>0||e[8]>0)},i(e){o||(Ce(n.$$.fragment,e),o=!0)},o(e){Le(n.$$.fragment,e),o=!1},d(e){e&&L(t),_e(n),r=!1,i()}}}function Ar(e){let t;const n=e[23].default,o=u(n,e,e[29],null),r=o||function(e){let t;return{c(){t=O("span"),t.textContent="↓",I(t,"class","svelte-1nye16d")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}();return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){o&&o.p&&536870912&t[0]&&d(o,n,e,e[29],t,null,null)},i(e){t||(Ce(r,e),t=!0)},o(e){Le(r,e),t=!1},d(e){r&&r.d(e)}}}function Ir(e){let t,n;return t=new pr({props:{mapData:e[4]}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};16&n[0]&&(o.mapData=e[4]),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function zr(e){let t,n;return t=new Tr({}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Dr(e){let t,n,o,r,i,a,l,c,u,p,d,m,f,g,h,y,$,b,x,w;function k(t){e[24](t)}let E={ofp:e[1]};void 0!==e[5]&&(E.selected=e[5]),i=new $r({props:E}),ie.push((()=>Se(i,"selected",k))),i.$on("change",e[18]);let M=e[5]&&!e[1].isFake&&window.indexedDB&&e[14]&&!0!==e[11][e[5].id]&&!e[13]&&jr(e),S=e[4]&&!!e[1]&&!e[1].isFake&&(e[15]||e[16]>=0)&&Ir(e);function _(t){e[25](t)}function j(t){e[26](t)}let A={ofp:e[1]};function z(t){e[27](t)}void 0!==e[6]&&(A.selectedAircraft=e[6]),void 0!==e[7]&&(A.aircraftTypeSelectElement=e[7]),p=new cr({props:A}),ie.push((()=>Se(p,"selectedAircraft",_))),ie.push((()=>Se(p,"aircraftTypeSelectElement",j))),p.$on("change",e[19]);let D={};void 0!==e[0]&&(D.kmlOptions=e[0]),g=new _n({props:D}),ie.push((()=>Se(g,"kmlOptions",z))),g.$on("change",e[20]),g.$on("save",e[28]);let R=e[17]&&zr();return{c(){t=O("div"),o=F(),r=O("div"),Fe(i.$$.fragment),l=F(),M&&M.c(),c=F(),S&&S.c(),u=F(),Fe(p.$$.fragment),f=F(),Fe(g.$$.fragment),y=F(),R&&R.c(),$=T(),I(t,"id",e[2]),I(t,"class","svelte-1nye16d"),I(r,"class","mapmenu svelte-1nye16d")},m(s,a){C(s,t,a),C(s,o,a),C(s,r,a),Te(i,r,null),P(r,l),M&&M.m(r,null),C(s,c,a),S&&S.m(s,a),C(s,u,a),Te(p,s,a),C(s,f,a),Te(g,s,a),C(s,y,a),R&&R.m(s,a),C(s,$,a),b=!0,x||(w=v(n=_r.call(null,t,e[3])),x=!0)},p(e,o){(!b||4&o[0])&&I(t,"id",e[2]),n&&s(n.update)&&8&o[0]&&n.update.call(null,e[3]);const l={};2&o[0]&&(l.ofp=e[1]),!a&&32&o[0]&&(a=!0,l.selected=e[5],me((()=>a=!1))),i.$set(l),e[5]&&!e[1].isFake&&window.indexedDB&&e[14]&&!0!==e[11][e[5].id]&&!e[13]?M?(M.p(e,o),26658&o[0]&&Ce(M,1)):(M=jr(e),M.c(),Ce(M,1),M.m(r,null)):M&&(ke(),Le(M,1,1,(()=>{M=null})),Pe()),e[4]&&e[1]&&!e[1].isFake&&(e[15]||e[16]>=0)?S?(S.p(e,o),98322&o[0]&&Ce(S,1)):(S=Ir(e),S.c(),Ce(S,1),S.m(u.parentNode,u)):S&&(ke(),Le(S,1,1,(()=>{S=null})),Pe());const c={};2&o[0]&&(c.ofp=e[1]),!d&&64&o[0]&&(d=!0,c.selectedAircraft=e[6],me((()=>d=!1))),!m&&128&o[0]&&(m=!0,c.aircraftTypeSelectElement=e[7],me((()=>m=!1))),p.$set(c);const f={};!h&&1&o[0]&&(h=!0,f.kmlOptions=e[0],me((()=>h=!1))),g.$set(f),e[17]?R?131072&o[0]&&Ce(R,1):(R=zr(),R.c(),Ce(R,1),R.m($.parentNode,$)):R&&(ke(),Le(R,1,1,(()=>{R=null})),Pe())},i(e){b||(Ce(i.$$.fragment,e),Ce(M),Ce(S),Ce(p.$$.fragment,e),Ce(g.$$.fragment,e),Ce(R),b=!0)},o(e){Le(i.$$.fragment,e),Le(M),Le(S),Le(p.$$.fragment,e),Le(g.$$.fragment,e),Le(R),b=!1},d(e){e&&L(t),e&&L(o),e&&L(r),_e(i),M&&M.d(),e&&L(c),S&&S.d(e),e&&L(u),_e(p,e),e&&L(f),_e(g,e),e&&L(y),R&&R.d(e),e&&L($),x=!1,w()}}}const Rr=e=>{ct.set(!1)},Wr=()=>!1;function Nr(e,t,n){let o,r,i,s,a;c(e,$t,(e=>n(14,r=e))),c(e,ct,(e=>n(15,i=e))),c(e,ut,(e=>n(16,s=e))),c(e,lt,(e=>n(17,a=e)));let{$$slots:u={},$$scope:p}=t;const d=ne();let m,f,g,h,v,{kmlOptions:y}=t,{ofp:$}=t,b=0,x=0,w=!1,k=[];const P={};let{id:C="map"}=t;async function L(){$&&!$.isFake?n(22,k=await No(0,f)):n(22,k=[]);const e=document.querySelector(`#${C} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(v),e.appendChild(document.createTextNode(`${"2103".substring(0,2)}.${"2103".substring(2,4)}`)))}const E=e=>{(e=>{const{name:t,value:n}=e,o=Ue(t);if("icontext"===o)return Object.values(To).forEach((t=>t.changeIconText&&t.changeIconText(e)));if("linewidth"===o)return Object.values(To).forEach((t=>t.changeLineWidth&&t.changeLineWidth(e)));if("iconsize"===o)return Object.values(To).forEach((t=>t.changeIconSize&&t.changeIconSize(e)));const r=To[o];r&&(t.endsWith("-display")?n?r.show&&r.show(e):r.hide&&r.hide(e):t.endsWith("-pin")?r.changeMarker&&r.changeMarker(e):t.endsWith("-color")?r.changeLine&&r.changeLine(e):t.endsWith("-change")&&r.change&&r.change(e))})({map:m,mapData:f,name:e.detail.name,value:e.detail.value,ofp:$,kmlOptions:y,aircraftType:h}),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-")||e.endsWith("-change"))return;const n=_t(),o=Ue(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),d("save")};let O=!1;return ee((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",n(4,f=zo(C,g,$,y,L)),Rr(),ct.reset(),n(3,m=f.map),f.geolocate.on("trackuserlocationstart",Rr)})),te((()=>{f.geolocate.off("trackuserlocationstart",Rr),n(3,m=void 0),n(4,f=void 0)})),e.$$set=e=>{"kmlOptions"in e&&n(0,y=e.kmlOptions),"ofp"in e&&n(1,$=e.ofp),"id"in e&&n(2,C=e.id),"$$scope"in e&&n(29,p=e.$$scope)},e.$$.update=()=>{4194304&e.$$.dirty[0]&&n(13,o=0===k.length)},[y,$,C,m,f,g,h,v,b,x,w,P,O,o,r,i,s,a,function(e){e.target.blur(),m&&m.remove(),n(9,x=0),n(10,w=!1),n(22,k=[]),n(8,b=0),f&&f.geolocate&&f.geolocate.off("trackuserlocationstart",Rr);const t=function(e){let t;return l(e,(e=>t=e))(),t}(ct);Rr(),n(4,f=zo(C,g,$,y,L)),n(3,m=f.map),f.geolocate.on("trackuserlocationstart",Rr),setTimeout((async()=>{await pe,ct.set(t)}),0)},function(e){e.target.blur(),E({detail:{value:h,name:"airport-change"}})},E,async e=>{if(O)return!1;n(12,O=!0);try{n(8,b=k.length),n(10,w=!1);try{await Ze(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(12,O=!1),n(10,w=!0),!1}n(9,x=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const i=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(i),e()),o>=5||r>n.length-1)return;const s=r++,a=n[s];o++;try{await fetch(a),t&&t()}catch{}o--,delete n[s]}),100)}))}(k,(()=>n(9,x++,x))),x>=b&&(n(11,P[g.id]=!0,P),n(11,P),n(22,k=[]),n(8,b=0))}finally{n(12,O=!1)}},k,u,function(e){g=e,n(5,g)},function(e){h=e,n(6,h)},function(e){v=e,n(7,v)},function(e){y=e,n(0,y)},function(t){oe(e,t)},p]}class Ur extends Ae{constructor(e){super(),je(this,e,Nr,Dr,a,{kmlOptions:0,ofp:1,id:2},[-1,-1])}}var Hr=["bottom-right","bottom-center","bottom-left","top-right","top-center","top-left","right-bottom","right-center","right-top","left-bottom","left-center","left-top"];const qr="right",Gr="left",Br="top",Kr="bottom";function Zr(){return"undefined"!=typeof window&&"undefined"!=typeof document}const Xr=(e,{top:t,bottom:n,left:o,right:r,height:i,width:s,clientWidth:a,clientHeight:l})=>{const c=t>i,u=n+i<l,p=o>s,d=r+s<a;return{top:()=>!c&&u?Kr:Br,bottom:()=>c&&!u?Br:Kr,left:()=>!p&&d?qr:Gr,right:()=>!d&&p?Gr:qr}[e]()},Jr=(e,{top:t,bottom:n,left:o,right:r,height:i,width:s,clientWidth:a,clientHeight:l})=>{const c=t+(n-t)/2,u=n>i,p=t+i<l,d=c-i/2>0&&c+i/2<l,m=r>s,f=o+s<a,g={top:()=>!u&&p?Kr:Br,center:()=>d?"center":g.top(),bottom:()=>!p&&u?Br:Kr,left:()=>!m&&f?qr:Gr,right:()=>!f&&m?Gr:qr};return g[e]()},{window:Vr}=Me,Yr=e=>({isOpen:2048&e[0]}),Qr=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]}),ei=e=>({isOpen:2048&e[0]}),ti=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]});function ni(e){let t,n,o;const r=e[26].content,i=u(r,e,e[25],Qr);return{c(){t=O("div"),i&&i.c(),I(t,"class",n=g(`content ${e[4]||""}`)+" svelte-d6atc3")},m(n,r){C(n,t,r),i&&i.m(t,null),e[28](t),o=!0},p(e,s){i&&i.p&&33556480&s[0]&&d(i,r,e,e[25],s,Yr,Qr),(!o||16&s[0]&&n!==(n=g(`content ${e[4]||""}`)+" svelte-d6atc3"))&&I(t,"class",n)},i(e){o||(Ce(i,e),o=!0)},o(e){Le(i,e),o=!1},d(n){n&&L(t),i&&i.d(n),e[28](null)}}}function oi(e){let t,n,o,r,s,a,l,c,p,m;const f=e[26].parent,h=u(f,e,e[25],ti);let v=e[11]&&ni(e);return{c(){t=O("div"),n=O("div"),h&&h.c(),o=F(),r=O("div"),v&&v.c(),I(n,"class","svelte-d6atc3"),I(r,"class","content-wrapper svelte-d6atc3"),I(r,"style",s=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`),I(t,"class",a=g(`overlay ${e[10]}`)+" svelte-d6atc3"),I(t,"style",l=`z-index:${e[0]}; ${e[1]}`)},m(i,s){C(i,t,s),P(t,n),h&&h.m(n,null),e[27](n),P(t,o),P(t,r),v&&v.m(r,null),e[29](t),c=!0,p||(m=[j(Vr,"mousedown",e[15]),j(Vr,"keydown",e[16])],p=!0)},p(e,n){h&&h.p&&33556480&n[0]&&d(h,f,e,e[25],n,ei,ti),e[11]?v?(v.p(e,n),2048&n[0]&&Ce(v,1)):(v=ni(e),v.c(),Ce(v,1),v.m(r,null)):v&&(ke(),Le(v,1,1,(()=>{v=null})),Pe()),(!c||961&n[0]&&s!==(s=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`))&&I(r,"style",s),(!c||1024&n[0]&&a!==(a=g(`overlay ${e[10]}`)+" svelte-d6atc3"))&&I(t,"class",a),(!c||3&n[0]&&l!==(l=`z-index:${e[0]}; ${e[1]}`))&&I(t,"style",l)},i(e){c||(Ce(h,e),Ce(v),c=!0)},o(e){Le(h,e),Le(v),c=!1},d(n){n&&L(t),h&&h.d(n),e[27](null),v&&v.d(),e[29](null),p=!1,i(m)}}}function ri(e,t,o){let r,i,s,a;const l=["isOpen","updateOnScroll","closeOnScroll","position","closeOnClickOutside","zIndex","onWindowKeyDown","style"];let c=f(t,l),{$$slots:u={},$$scope:p}=t;const d=ne(),g=Hr[0];let h,v,y,{isOpen:$=!1}=t,{updateOnScroll:b=!1}=t,{closeOnScroll:x=!1}=t,{position:w=g}=t,{closeOnClickOutside:k=!1}=t,{zIndex:P=1}=t,{onWindowKeyDown:C=(()=>{})}=t,{style:L=""}=t,E=null,O=0,M=0,S=0,F=0;function T(){Zr()&&(window.addEventListener("resize",R),x?window.addEventListener("scroll",z):b&&window.addEventListener("scroll",R))}function _(){Zr()&&(window.removeEventListener("resize",R),window.removeEventListener("scroll",R),window.removeEventListener("scroll",z))}var j;function A(e){const t=$,n=!0===e||!1===e?e:!$;(n&&i&&s||!n)&&o(17,$=n),t!==$&&(d("toggle",$),$?(T(),d("open")):(d("close"),_()))}function I(){a||A(!0)}function z(){a&&A(!1)}function D(e){const t=e.path||e.composedPath();return t.includes(h)||t.includes(v)}async function R(){if(await pe(),!a)return;Hr.includes(w)||o(18,w=g);const{top:e,bottom:t,left:n,right:r,width:i,height:s}=h.getBoundingClientRect(),{height:l,width:c}=v.getBoundingClientRect(),u=((e,t)=>{const n=Math.min(document.body.clientHeight,document.documentElement.clientHeight),o=Math.min(document.body.clientWidth,document.documentElement.clientWidth);Object.assign(t,{clientWidth:o,clientHeight:n});const[r,i]=e.split("-");return`${Xr(r,t)}-${Jr(i,t)}`})(w,{top:e,bottom:t,left:n,right:r,height:l,width:c});E!==u&&o(4,E=u),o(6,O=e),o(7,M=n),o(8,S=i),o(9,F=s)}return ee((()=>{a&&T()})),te((()=>{Zr()&&_()})),j=R,Q().$$.before_update.push(j),e.$$set=e=>{t=n(n({},t),m(e)),o(36,c=f(t,l)),"isOpen"in e&&o(17,$=e.isOpen),"updateOnScroll"in e&&o(19,b=e.updateOnScroll),"closeOnScroll"in e&&o(20,x=e.closeOnScroll),"position"in e&&o(18,w=e.position),"closeOnClickOutside"in e&&o(21,k=e.closeOnClickOutside),"zIndex"in e&&o(0,P=e.zIndex),"onWindowKeyDown"in e&&o(22,C=e.onWindowKeyDown),"style"in e&&o(1,L=e.style),"$$scope"in e&&o(25,p=e.$$scope)},e.$$.update=()=>{if(o(10,r=c.class||""),4&e.$$.dirty[0]&&o(23,i=!h||!!h.childNodes.length),8&e.$$.dirty[0]&&o(24,s=!v||!!v.childNodes.length),8388608&e.$$.dirty[0]&&!i)throw new Error("parent slot is required");if(16777216&e.$$.dirty[0]&&!s)throw new Error("content slot is required");25296896&e.$$.dirty[0]&&o(11,a=$&&i&&s)},[P,L,h,v,E,y,O,M,S,F,r,a,A,I,z,function(e){k&&a&&!D(e)&&z()},function(e){C&&a&&C(e,{isOpen:a,open:I,close:z,toggle:A,contains:D})},$,w,b,x,k,C,i,s,p,u,function(e){ie[e?"unshift":"push"]((()=>{h=e,o(2,h)}))},function(e){ie[e?"unshift":"push"]((()=>{v=e,o(3,v)}))},function(e){ie[e?"unshift":"push"]((()=>{y=e,o(5,y)}))}]}class ii extends Ae{constructor(e){super(),je(this,e,ri,oi,a,{isOpen:17,updateOnScroll:19,closeOnScroll:20,position:18,closeOnClickOutside:21,zIndex:0,onWindowKeyDown:22,style:1},[-1,-1])}}function si(e){let t,o;const r=e[3].default,i=u(r,e,e[2],null);let s=[{href:e[0]},e[1]],a={};for(let e=0;e<s.length;e+=1)a=n(a,s[e]);return{c(){t=O("a"),i&&i.c(),z(t,a)},m(e,n){C(e,t,n),i&&i.m(t,null),o=!0},p(e,[n]){i&&i.p&&4&n&&d(i,r,e,e[2],n,null,null),z(t,a=function(e,t){const n={},o={},r={$$scope:1};let i=e.length;for(;i--;){const s=e[i],a=t[i];if(a){for(const e in s)e in a||(o[e]=1);for(const e in a)r[e]||(n[e]=a[e],r[e]=1);e[i]=a}else for(const e in s)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(s,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||(Ce(i,e),o=!0)},o(e){Le(i,e),o=!1},d(e){e&&L(t),i&&i.d(e)}}}function ai(e,t,o){const r=["href"];let i=f(t,r),{$$slots:s={},$$scope:a}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},i):i;return e.$$set=e=>{t=n(n({},t),m(e)),o(5,i=f(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,a=e.$$scope)},[l,c,a,s]}class li extends Ae{constructor(e){super(),je(this,e,ai,si,a,{href:0})}}function ci(e){let t,n;return t=new ii({props:{position:"bottom-center",$$slots:{content:[vi,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[pi,({toggle:e})=>({11:e}),({toggle:e})=>e?2048:0]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};7210&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function ui(e){let t,n,o,r,a,l,c,u,p,d,m=e[2]&&yi();return c=new ii({props:{position:"bottom-center",isOpen:e[0],$$slots:{content:[bi,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[$i]},$$scope:{ctx:e}}}),{c(){t=O("div"),n=M("svg"),o=M("circle"),r=F(),m&&m.c(),l=F(),Fe(c.$$.fragment),I(o,"cx","50"),I(o,"cy","50"),I(o,"r","50"),I(n,"id","gt-plane"),I(n,"viewBox","0 0 100 100"),I(n,"xmlns","http://www.w3.org/2000/svg"),I(n,"class","svelte-1wx3a70"),I(t,"class","gramet-thumbnail svelte-1wx3a70"),G(t,"open",e[2])},m(i,s){C(i,t,s),P(t,n),P(n,o),P(t,r),m&&m.m(t,null),C(i,l,s),Te(c,i,s),u=!0,p||(d=[v(a=Cr.call(null,t,{ofp:e[3],pos:e[4].gramet,fl:e[4].fl})),j(t,"click",e[6])],p=!0)},p(e,n){e[2]?m||(m=yi(),m.c(),m.m(t,null)):m&&(m.d(1),m=null),a&&s(a.update)&&24&n&&a.update.call(null,{ofp:e[3],pos:e[4].gramet,fl:e[4].fl}),4&n&&G(t,"open",e[2]);const o={};1&n&&(o.isOpen=e[0]),5120&n&&(o.$$scope={dirty:n,ctx:e}),c.$set(o)},i(e){u||(Ce(c.$$.fragment,e),u=!0)},o(e){Le(c.$$.fragment,e),u=!1},d(e){e&&L(t),m&&m.d(),e&&L(l),_e(c,e),p=!1,i(d)}}}function pi(e){let t,n,o;return{c(){t=O("button"),t.innerHTML='<svg class="gramet-error svelte-1wx3a70"><use xlink:href="#info-symbol"></use></svg>',I(t,"slot","parent"),I(t,"class","btn btn-light svelte-1wx3a70")},m(r,i){C(r,t,i),n||(o=j(t,"click",(function(){s(e[11])&&e[11].apply(this,arguments)})),n=!0)},p(t,n){e=t},d(e){e&&L(t),n=!1,o()}}}function di(e){let t;return{c(){t=S("ogimet")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function mi(e){let t,n,o,r=0!==e[5].status&&hi(e);return{c(){t=O("p"),t.textContent="A certaines heures le site ogimet est saturé, il faut essayer 2 ou 3 fois en temporisant de 30 secondes à chaque essai.",n=F(),r&&r.c(),o=T()},m(e,i){C(e,t,i),C(e,n,i),r&&r.m(e,i),C(e,o,i)},p(e,t){0!==e[5].status?r?r.p(e,t):(r=hi(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(e){e&&L(t),e&&L(n),r&&r.d(e),e&&L(o)}}}function fi(t){let n;return{c(){n=O("p"),n.textContent="Le serveur ogimet indique qu'il est indisponible (no grib data). Sa mise à jour débute normalement à 00:00z et c'est long..."},m(e,t){C(e,n,t)},p:e,d(e){e&&L(n)}}}function gi(e){let t,n,o,r,i,s=e[5].text+"";return{c(){t=O("p"),n=S('Erreur construction route GRAMET: Station "'),o=O("code"),r=S(s),i=S("\" non reconnue par ogimet,\n                    merci de me remonter l'information pour que je corrige l'application. Inutile de réessayer.")},m(e,s){C(e,t,s),P(t,n),P(t,o),P(o,r),P(t,i)},p(e,t){32&t&&s!==(s=e[5].text+"")&&W(r,s)},d(e){e&&L(t)}}}function hi(e){let t,n,o,r,i=(e[5].text||e[5].status)+"";return{c(){t=O("p"),n=S("Pour information, le proxy a retourné: "),o=O("code"),r=S(i)},m(e,i){C(e,t,i),P(t,n),P(t,o),P(o,r)},p(e,t){32&t&&i!==(i=(e[5].text||e[5].status)+"")&&W(r,i)},d(e){e&&L(t)}}}function vi(e){let t,n,o,r,a,l,c,u,p,d,m,f,g,h,v,y;function $(e,t){return 409===e[5].status?gi:"no grib data"===e[5].text?fi:mi}m=new li({props:{href:e[3].ogimetData.url,target:"_blank",$$slots:{default:[di]},$$scope:{ctx:e}}});let b=$(e),x=b(e);return{c(){t=O("div"),n=O("div"),o=O("h3"),r=S("😱: Erreur de récupération du Gramet"),a=O("button"),a.innerHTML='<svg class="svelte-1wx3a70"><use xlink:href="#close-symbol"></use></svg>',l=F(),c=O("div"),u=O("p"),p=O("a"),p.textContent="essayez à nouveau",d=S(" ou allez sur "),Fe(m.$$.fragment),f=S("."),g=F(),x.c(),I(a,"type","button"),I(a,"class","close svelte-1wx3a70"),I(a,"aria-label","Close"),I(o,"class","popover-header"),I(p,"href","."),I(c,"class","popover-body"),I(n,"class","popover"),I(n,"role","tooltip"),U(n,"width","330px"),U(n,"max-width","330px"),I(t,"slot","content")},m(i,$){C(i,t,$),P(t,n),P(n,o),P(o,r),P(o,a),P(n,l),P(n,c),P(c,u),P(u,p),P(u,d),Te(m,u,null),P(u,f),P(c,g),x.m(c,null),h=!0,v||(y=[j(a,"click",(function(){s(e[10])&&e[10].apply(this,arguments)})),j(p,"click",A(e[8]))],v=!0)},p(t,n){e=t;const o={};8&n&&(o.href=e[3].ogimetData.url),4096&n&&(o.$$scope={dirty:n,ctx:e}),m.$set(o),b===(b=$(e))&&x?x.p(e,n):(x.d(1),x=b(e),x&&(x.c(),x.m(c,null)))},i(e){h||(Ce(m.$$.fragment,e),h=!0)},o(e){Le(m.$$.fragment,e),h=!1},d(e){e&&L(t),_e(m),x.d(),v=!1,i(y)}}}function yi(e){let t,n;return{c(){t=M("svg"),n=M("use"),D(n,"xlink:href","#close-symbol"),I(t,"class","gramet-close svelte-1wx3a70")},m(e,o){C(e,t,o),P(t,n)},d(e){e&&L(t)}}}function $i(e){let t;return{c(){t=O("div"),I(t,"slot","parent"),I(t,"class","d-none")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function bi(e){let t,n,o,r,a,l,c,u,p,d,m;return{c(){t=O("div"),n=O("div"),o=O("h3"),r=S("Nouveau GRAMET disponible"),a=O("button"),a.innerHTML='<svg class="svelte-1wx3a70"><use xlink:href="#close-symbol"></use></svg>',l=F(),c=O("div"),u=O("p"),p=O("button"),p.textContent="Mettre à jour",I(a,"type","button"),I(a,"class","close svelte-1wx3a70"),I(a,"aria-label","Close"),I(o,"class","popover-header"),I(p,"class","btn btn-primary"),I(u,"class","text-center"),I(c,"class","popover-body"),I(n,"class","popover"),I(n,"role","tooltip"),U(n,"left","calc(-2rem - 70px)"),U(n,"width","290px"),U(n,"max-width","290px"),U(n,"top","20px"),I(t,"slot","content")},m(i,f){C(i,t,f),P(t,n),P(n,o),P(o,r),P(o,a),P(n,l),P(n,c),P(c,u),P(u,p),d||(m=[j(a,"click",(function(){s(e[10])&&e[10].apply(this,arguments)})),j(p,"click",e[7])],d=!0)},p(t,n){e=t},d(e){e&&L(t),d=!1,i(m)}}}function xi(e){let t,n,o,r;const i=[ui,ci],s=[];function a(e,t){return"error"!==e[1]&&"reload"!==e[1]?0:"reload"!==e[1]?1:-1}return~(t=a(e))&&(n=s[t]=i[t](e)),{c(){n&&n.c(),o=T()},m(e,n){~t&&s[t].m(e,n),C(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?~t&&s[t].p(e,r):(n&&(ke(),Le(s[l],1,1,(()=>{s[l]=null})),Pe()),~t?(n=s[t],n?n.p(e,r):(n=s[t]=i[t](e),n.c()),Ce(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Ce(n),r=!0)},o(e){Le(n),r=!1},d(e){~t&&s[t].d(e),e&&L(o)}}}function wi(e,t,n){let o,r,i,s,a;c(e,kr,(e=>n(1,o=e))),c(e,lt,(e=>n(2,r=e))),c(e,pt,(e=>n(3,i=e))),c(e,wt,(e=>n(4,s=e))),c(e,Pr,(e=>n(5,a=e)));let l=!1;const u=async e=>{if("workbox-broadcast-update"===e.data.meta&&"CACHE_UPDATED"===e.data.type){const{updatedURL:t}=e.data.payload;t===i.ogimetData.proxyImg&&n(0,l=!0)}};navigator&&navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",u),te((()=>{navigator&&navigator.serviceWorker&&navigator.serviceWorker.removeEventListener("message",u)}));return[l,o,r,i,s,a,()=>{"success"===o&&h(lt,r=!r,r)},async()=>{h(kr,o="reload",o),h(lt,r=!1,r),n(0,l=!1),await pe,h(kr,o="loading",o)},()=>h(kr,o="loading",o)]}class ki extends Ae{constructor(e){super(),je(this,e,wi,xi,a,{})}}function Pi(e){let t;return{c(){t=O("p"),t.textContent="ETOPS",I(t,"class","etops svelte-cgn8wq")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Ci(t){let n,o,r,i,s,a,l,c,u,p,d,m,f,g,h,v,y,$,b,x=t[1].infos.flight+"",w=t[1].infos.departure+"",k=t[1].infos.destination+"",E=t[1].infos.date+"",T=t[1].infos.ofp.includes("/")?"":"ofp: ",_=t[1].infos.ofp+"",A=t[2]<20&&Pi(),z=navigator&&navigator.share&&function(e){let t,n;return{c(){t=M("svg"),n=M("use"),D(n,"xlink:href","#share-symbol"),I(t,"class","svelte-cgn8wq")},m(e,o){C(e,t,o),P(t,n)},d(e){e&&L(t)}}}();return{c(){n=O("div"),A&&A.c(),o=F(),r=O("div"),i=O("p"),s=O("b"),a=S(x),l=F(),c=S(w),u=S("-"),p=S(k),d=F(),m=O("p"),f=S(E),g=F(),h=S(T),v=S(_),y=F(),z&&z.c(),I(i,"class","svelte-cgn8wq"),I(m,"class","svelte-cgn8wq"),I(r,"class","details svelte-cgn8wq"),I(n,"class","infos svelte-cgn8wq")},m(e,x){C(e,n,x),A&&A.m(n,null),P(n,o),P(n,r),P(r,i),P(i,s),P(s,a),P(i,l),P(i,c),P(i,u),P(i,p),P(r,d),P(r,m),P(m,f),P(m,g),P(m,h),P(m,v),P(m,y),z&&z.m(m,null),$||(b=j(n,"click",navigator&&navigator.share?t[0]:null),$=!0)},p(e,[t]){e[2]<20?A||(A=Pi(),A.c(),A.m(n,o)):A&&(A.d(1),A=null),2&t&&x!==(x=e[1].infos.flight+"")&&W(a,x),2&t&&w!==(w=e[1].infos.departure+"")&&W(c,w),2&t&&k!==(k=e[1].infos.destination+"")&&W(p,k),2&t&&E!==(E=e[1].infos.date+"")&&W(f,E),2&t&&T!==(T=e[1].infos.ofp.includes("/")?"":"ofp: ")&&W(h,T),2&t&&_!==(_=e[1].infos.ofp+"")&&W(v,_)},i:e,o:e,d(e){e&&L(n),A&&A.d(),z&&z.d(),$=!1,b()}}}function*Li(e,t){let n="";const o=e.infos.ralts;if(o.length>0)try{n=e.text.extract("ETOPS SUMMARY","SUMMARY-").replace(e.removePageFooterRegex,"")}catch(e){}const r=String.raw`(EEP\(\S{4}\)|ETP\S+|EXP\(\S{4}\))\s.+?EET (\d{2})\.(\d{2}) .+? ([\d.]+)\/EFOB ([\d.]+)(?:.+?(${o.join("|")})\s(\S+).+?\sREQ\s(\d{2})(\d{2})-(\d{2})(\d{2}))?`,i=new RegExp(r,"gm"),s=new Date(t),a=t-e.infos.takeoff;s.setUTCHours(0,0);const l=n.matchAll(i);for(let[,e,n,o,r,i,c,u,p,d,m,f]of l){const l=new Date(t.getTime()+36e5*parseInt(n,10)+6e4*parseInt(o,10)),g=Math.round(10*(parseFloat(i)-parseFloat(r)))/10,h=void 0!==p&&void 0!==d?new Date(s.getTime()+36e5*parseInt(p,10)+6e4*parseInt(d,10)+a):void 0,v=void 0!==m&&void 0!==f?new Date(s.getTime()+36e5*parseInt(m,10)+6e4*parseInt(f,10)+a):void 0;yield[e,l,parseFloat(r),parseFloat(i),g,c,u,h,v]}}function Ei(e,t,n){let o,r,i;c(e,pt,(e=>n(1,r=e))),c(e,mt,(e=>n(3,i=e)));const s=(e,t)=>{let n="";const o=e=>e.getUTCHours().toString().padStart(2,"0"),r=e=>e.getUTCMinutes().toString().padStart(2,"0"),i=[];for(const[s,a,,,l,c,u,p,d]of Li(e,t)){let e,t;t=s.startsWith("ETP")?`**${s}** ${n}/${c}`:`**${s.substring(0,3)}**${s.substring(3)}`,e=`\n${t} ➔ ETO: **${o(a)}:${r(a)}** | ΔFUEL: **${l.toFixed(1)}**\n`,c&&(n=c,e+=`\n**Appui**: ${c} ${u} - Plage: **${o(p)}${r(p)}-${o(d)}${r(d)}**`),i.push(e)}return i};return e.$$.update=()=>{10&e.$$.dirty&&n(2,o=((e,t)=>{const n=[];for(const[,o,,r,i]of Li(e,t))n.push([o,r,i]);if(n.length>1){const e=(n[0][1]-n[n.length-1][1])/(n[n.length-1][0]-n[0][0])*6e4;return Math.min(...n.map((t=>t[2]/e)))}return n.length>0?n[0][2]/8*60:180})(r,i))},[async()=>{const e={title:"OFP2MAP",text:JSON.stringify({...r.infos,text:r.text,"ofp2map-takeoff":i,etopsOutput:s(r,i)})};try{await navigator.share(e)}catch(e){}return!1},r,o,i]}class Oi extends Ae{constructor(e){super(),je(this,e,Ei,Ci,a,{shareOFP:0})}get shareOFP(){return this.$$.ctx[0]}}function Mi(t){let n,o,r,s,a,l,c,u,p,d,m;return{c(){n=O("div"),o=M("svg"),r=M("use"),s=F(),a=O("label"),l=S("Heure de décollage"),c=F(),u=O("input"),D(r,"xlink:href","#takeoff-symbol"),I(o,"class","svelte-16mu92i"),G(o,"show",t[2]||t[3]>=0),G(o,"hide",!(t[2]||t[3]>=0)),I(a,"for",t[0]),I(a,"class","svelte-16mu92i"),I(u,"id",t[0]),I(u,"name",t[0]),I(u,"type","time"),u.value=p=t[4](t[1].getUTCHours(),t[1].getUTCMinutes()),I(u,"class","svelte-16mu92i"),I(n,"class","svelte-16mu92i")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(n,s),P(n,a),P(a,l),P(n,c),P(n,u),d||(m=[j(o,"click",t[7]),v(or.call(null,u)),j(u,"change",t[5])],d=!0)},p(e,[t]){12&t&&G(o,"show",e[2]||e[3]>=0),12&t&&G(o,"hide",!(e[2]||e[3]>=0)),1&t&&I(a,"for",e[0]),1&t&&I(u,"id",e[0]),1&t&&I(u,"name",e[0]),2&t&&p!==(p=e[4](e[1].getUTCHours(),e[1].getUTCMinutes()))&&(u.value=p)},i:e,o:e,d(e){e&&L(n),d=!1,i(m)}}}function Si(e,t,n){let o,r,i,s,a;c(e,pt,(e=>n(6,r=e))),c(e,mt,(e=>n(8,i=e))),c(e,ct,(e=>n(2,s=e))),c(e,ut,(e=>n(3,a=e)));let{name:l="take-off"}=t;const u=(e,t)=>`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return e.$$set=e=>{"name"in e&&n(0,l=e.name)},e.$$.update=()=>{64&e.$$.dirty&&n(1,o=(e=>{const t=new Date(e.infos.datetime);return t.setUTCMinutes(t.getMinutes()+r.infos.taxitime),h(mt,i=t,i),t})(r))},[l,o,s,a,u,e=>{let t,n;""==e.target.value?(n=o.getUTCHours(),t=o.getUTCMinutes(),e.target.blur(),e.target.value=u(n,t)):(n=parseFloat(e.target.value.slice(0,2)),t=parseFloat(e.target.value.slice(3)));let r=new Date(o);r.setUTCMinutes(t),r.setUTCHours(n);const s=(r.getTime()-o.getTime())/6e4;s<-720?r=new Date(r.getTime()+864e5):s>720&&(r=new Date(r.getTime()-864e5)),h(mt,i=r,i),r.toISOString()!==o.toISOString()?e.target.classList.add("changed"):e.target.classList.remove("changed")},r,()=>h(ct,s=!s,s)]}class Fi extends Ae{constructor(e){super(),je(this,e,Si,Mi,a,{name:0})}}function Ti(e){let t;return{c(){t=O("li"),t.innerHTML='<a class="nav-link" href="#/map"><span class="svelte-s04fhf">CARTE</span></a>',I(t,"class","nav-item svelte-s04fhf"),G(t,"active","/map"===e[0])},m(e,n){C(e,t,n)},p(e,n){1&n&&G(t,"active","/map"===e[0])},d(e){e&&L(t)}}}function _i(e){let t;return{c(){t=O("li"),t.innerHTML='<a class="nav-link" href="#/export"><span class="svelte-s04fhf">EXPORT</span></a>',I(t,"class","nav-item svelte-s04fhf"),G(t,"active","/export"===e[0])},m(e,n){C(e,t,n)},p(e,n){1&n&&G(t,"active","/export"===e[0])},d(e){e&&L(t)}}}function ji(e){let t,n,o,r,i,s="/map"===e[0]&&Ai();return n=new Fi({}),r=new Oi({}),{c(){s&&s.c(),t=F(),Fe(n.$$.fragment),o=F(),Fe(r.$$.fragment)},m(e,a){s&&s.m(e,a),C(e,t,a),Te(n,e,a),C(e,o,a),Te(r,e,a),i=!0},p(e,n){"/map"===e[0]?s?1&n&&Ce(s,1):(s=Ai(),s.c(),Ce(s,1),s.m(t.parentNode,t)):s&&(ke(),Le(s,1,1,(()=>{s=null})),Pe())},i(e){i||(Ce(s),Ce(n.$$.fragment,e),Ce(r.$$.fragment,e),i=!0)},o(e){Le(s),Le(n.$$.fragment,e),Le(r.$$.fragment,e),i=!1},d(e){s&&s.d(e),e&&L(t),_e(n,e),e&&L(o),_e(r,e)}}}function Ai(e){let t,n;return t=new ki({}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Ii(e){let t,n,o,r,i,s,a,l,c,p,m,f,g,h,v,y,$,b=(e[1]||"/map"===e[0])&&Ti(e),x=(e[2]||"/export"===e[0])&&_i(e),w=e[2]&&ji(e);const k=e[4].default,E=u(k,e,e[3],null);return{c(){t=O("nav"),n=O("input"),o=F(),r=O("label"),r.innerHTML='<span class="navbar-toggler-icon"></span>',i=F(),s=O("ul"),a=O("li"),l=O("a"),c=M("svg"),p=M("use"),m=F(),b&&b.c(),f=F(),x&&x.c(),g=F(),h=O("li"),h.innerHTML='<a class="nav-link" href="#/help"><span class="svelte-s04fhf">AIDE</span></a>',v=F(),w&&w.c(),y=F(),E&&E.c(),I(n,"type","checkbox"),I(n,"id","menu"),I(n,"class","svelte-s04fhf"),I(r,"class","navbar-toggler"),I(r,"for","menu"),D(p,"xlink:href","#home-symbol"),I(c,"class","svelte-s04fhf"),I(l,"class","nav-link"),I(l,"href","#/"),I(a,"class","nav-item svelte-s04fhf"),G(a,"active","/"===e[0]),I(h,"class","nav-item svelte-s04fhf"),G(h,"active","/help"===e[0]),I(s,"class","navbar-nav collapse navbar-collapse svelte-s04fhf"),I(s,"id","navbarToggler"),I(t,"class","navbar navbar-expand-md navbar-light svelte-s04fhf")},m(e,u){C(e,t,u),P(t,n),P(t,o),P(t,r),P(t,i),P(t,s),P(s,a),P(a,l),P(l,c),P(c,p),P(s,m),b&&b.m(s,null),P(s,f),x&&x.m(s,null),P(s,g),P(s,h),P(t,v),w&&w.m(t,null),P(t,y),E&&E.m(t,null),$=!0},p(e,[n]){1&n&&G(a,"active","/"===e[0]),e[1]||"/map"===e[0]?b?b.p(e,n):(b=Ti(e),b.c(),b.m(s,f)):b&&(b.d(1),b=null),e[2]||"/export"===e[0]?x?x.p(e,n):(x=_i(e),x.c(),x.m(s,g)):x&&(x.d(1),x=null),1&n&&G(h,"active","/help"===e[0]),e[2]?w?(w.p(e,n),4&n&&Ce(w,1)):(w=ji(e),w.c(),Ce(w,1),w.m(t,y)):w&&(ke(),Le(w,1,1,(()=>{w=null})),Pe()),E&&E.p&&8&n&&d(E,k,e,e[3],n,null,null)},i(e){$||(Ce(w),Ce(E,e),$=!0)},o(e){Le(w),Le(E,e),$=!1},d(e){e&&L(t),b&&b.d(),x&&x.d(),w&&w.d(),E&&E.d(e)}}}function zi(e,t,n){let o,r,i;c(e,bt,(e=>n(0,o=e))),c(e,pt,(e=>n(1,r=e))),c(e,ft,(e=>n(2,i=e)));let{$$slots:s={},$$scope:a}=t;return e.$$set=e=>{"$$scope"in e&&n(3,a=e.$$scope)},[o,r,i,a,s]}class Di extends Ae{constructor(e){super(),je(this,e,zi,Ii,a,{})}}function Ri(n){let o,r,i;const a=n[3].default,l=u(a,n,n[2],null);return{c(){o=O("page"),l&&l.c(),I(o,"class","svelte-1de5e3b"),G(o,"fadein",!1===n[0]),G(o,"d-none",!0===n[0])},m(e,t){C(e,o,t),l&&l.m(o,null),i=!0},p(e,[t]){l&&l.p&&4&t&&d(l,a,e,e[2],t,null,null),1&t&&G(o,"fadein",!1===e[0]),1&t&&G(o,"d-none",!0===e[0])},i(a){i||(Ce(l,a),r||de((()=>{r=function(n,o,r){let i,a,l=o(n,r),c=!1,u=0;function p(){i&&V(n,i)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:m}=l||Ee;m&&(i=J(n,0,1,r,o,s,m,u++)),d(0,1);const f=$()+o,g=f+r;a&&a.abort(),c=!0,de((()=>be(n,!0,"start"))),a=k((e=>{if(c){if(e>=g)return d(1,0),be(n,!0,"end"),p(),c=!1;if(e>=f){const t=s((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(V(n),s(l)?(l=l(),$e().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),i=!0)},o(e){Le(l,e),i=!1},d(e){e&&L(o),l&&l.d(e)}}}function Wi(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:i}=t;return e.$$set=e=>{"hidden"in e&&n(0,i=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[i,(e,t,n)=>{if(void 0===i)return Ve(e,t)},r,o]}class Ni extends Ae{constructor(e){super(),je(this,e,Wi,Ri,a,{hidden:0})}}function Ui(e){let t;return{c(){t=S("ogimet.com")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Hi(e){let t;return{c(){t=S("Guide d'interprétation")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function qi(e){let t;return{c(){t=O("span"),t.innerHTML="Fly<span>Tax</span>",I(t,"class","flytax")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Gi(e){let t,n,o,r,i,s,a,l,c,u,p,d,m,f,g,h,v,y,$,b,x,w,k,E,M,T,_,j,A,z,D,R,W,N,U,H,q,G,B,K,Z,X,J,V,Y,Q,ee,te,ne,oe,re,ie,se,ae,le,ce,ue,pe,de,me,fe,ge,he,ve,ye,$e,be,xe,we,ke,Pe,Ee,Oe,Me,Se,je,Ae,Ie,ze,De,Re,We,Ne,Ue,He=!0!==navigator.standalone&&function(e){let t,n,o;return{c(){t=S("Pour mémoire, dans un navigateur, il suffit de partager l'url ou "),n=O("a"),n.textContent="ce lien",o=S("."),I(n,"href","http://flyingeek.github.io/lido-online/index.html")},m(e,r){C(e,t,r),C(e,n,r),C(e,o,r)},d(e){e&&L(t),e&&L(n),e&&L(o)}}}();return N=new li({props:{href:e[0],$$slots:{default:[Ui]},$$scope:{ctx:e}}}),Z=new li({props:{href:"http://www.ogimet.com/guia_gramet.phtml.en",$$slots:{default:[Hi]},$$scope:{ctx:e}}}),We=new li({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[qi]},$$scope:{ctx:e}}}),{c(){t=O("h2"),t.textContent="Préambule",n=F(),o=O("p"),o.textContent="OFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l'écran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie.",r=F(),i=O("p"),i.textContent="OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.",s=F(),a=O("p"),a.textContent="L'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L'app ne collecte aucune donnée.",l=F(),c=O("h2"),c.textContent="Utilisation",u=F(),p=O("ol"),p.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner.</p></li> \n<li><p>La carte dispose d&#39;un bouton pour personnaliser les calques et les couleurs. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP. Pour vous entrainer, je vous recommande de modifier la couleur des terrains en vert/rouge et de sauvegarder votre choix.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur d&#39;autres projections.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li> \n<li>THE WORLD permet de disposer d&#39;un Atlas off-line, c&#39;est une projection Times</li> \n<li>MERCATOR est une Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line</li></ul></li>",d=F(),m=O("ol"),m.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts. Si vous activez le bouton de géolocalisation, la carte peut se centrer automatiquement.</li>",f=F(),g=O("h2"),g.textContent="Mémo visuel",h=F(),v=O("p"),v.innerHTML='<img src="./images/map-help.webp" alt="map help" title="Aide Carte"/>',y=F(),$=O("h2"),$.textContent="Particularités de l'iPad",b=F(),x=O("p"),x.textContent="OFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.",w=F(),k=O("p"),E=S("Pour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. "),He&&He.c(),M=F(),T=O("p"),T.innerHTML='L&#39;export des fichiers KML affiche une page nommée &quot;data:&quot;, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share-symbol"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. En raison d&#39;un bug d&#39;iOS, il est impossible de nommer le fichier pour le moment.',_=F(),j=O("p"),j.textContent="À noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",A=F(),z=O("h2"),z.textContent="GRAMET",D=F(),R=O("p"),W=S("Le GRAMET est un météogramme représentant le temps et l'espace. Il indique, en tout point de la route, et à l'heure de passage estimée, une coupe verticale de la météo prévue.\nLe GRAMET est réalisé par "),Fe(N.$$.fragment),U=S(" à partir d'une route calculée. Il est possible d'afficher le GRAMET et sa route sur la carte. La route est particulièrement utile lors des vols océaniques car il n'y a aucune station en mer.\nPour construire la route du GRAMET, on utilise non pas les waypoints, mais au plus 21 stations météo (WMO). Il y a au total 13000 WMO dans le monde. Le GRAMET débute toujours à l'heure hh:00. Pour un decollage à 19h30, il débutera à 19h, pour un décollage à 19h31, il débutera à 20h. Pour les OFP anciens, c'est l'heure actuelle qui est envoyée. De plus OFP2MAP utilise la version du GRAMET qu'il a mis en cache pendant 48h."),H=F(),q=O("p"),q.textContent="Pour afficher le Gramet, cliquez sur sa miniature à gauche de l'OFP. Pour afficher la route, direction le réglage des calques de la carte. Par défaut elle est affichée en bleu. En fonction de l'heure de décollage (modifiable), le Gramet et sa miniature affiche la position avion. Avant l'horaire prévu de décollage, un bouton play permet de lancer une animation.",G=F(),B=O("p"),K=S("Pour mieux comprendre le GRAMET, je vous conseille son "),Fe(Z.$$.fragment),X=S("."),J=F(),V=O("h2"),V.textContent="Position avion",Y=F(),Q=O("p"),Q.textContent="Il est possible d'afficher la position avion sur la carte (bouton en forme de mire). Si vous l'autorisez, la position GPS sera prise en compte.",ee=F(),te=O("p"),te.textContent="En l'absence de GPS, l'avion dans la barre de menu (à gauche de l'heure de décollage) permet d'afficher la position estimée. Si la reconnaissance des waypoints s'est bien effectuée, les estimées de l'OFP seront prises en compte. Sinon, ce sera un simple ratio horaire, merci de me transmettre l'OFP dans ce cas (ce sera signalé par un avion rouge dans la barre de menu). L'heure de décollage est modifiable et permet toujours d'ajuster la position estimée.",ne=F(),oe=O("h2"),oe.textContent="Mode off-line",re=F(),ie=O("p"),ie.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.",se=F(),ae=O("p"),ae.textContent="Il existe aussi un bouton de mise en cache : le pictogramme ↓ situé à droite du sélecteur de carte. Sur les cartes LAMBERT ou THE WORLD, il mettra en cache la totalité de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache.",le=F(),ce=O("p"),ce.textContent="Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent : 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH et 32Mo pour THE WORLD.",ue=F(),pe=O("h2"),pe.textContent="ETOPS",de=F(),me=O("p"),me.textContent="La capacité ETOPS est determinée depuis l'OFP et les cercles sont tracés. Un drapeau ETOPS apparait dans le pavé d'information de l'OFP si le carburant est limitatif (20mn, soit environ 2T de marge sur 777). Pour avoir plus d'informations vous pouvez utiliser un plugin (voir ci-dessous).",fe=F(),ge=O("h2"),ge.textContent="Plugins (Raccourcis)",he=F(),ve=O("p"),ve.innerHTML='Sur iOS, OFP2MAP permet de lancer des raccourcis. Il est possible d&#39;exporter la route au format KML depuis le menu EXPORT mais il est aussi possible de lancer des raccourcis ayant accès au contenu de l&#39;OFP depuis le pavé d&#39;informations du vol dans la barre de menu. Un exemple de plugin est le <a href="https://www.icloud.com/shortcuts/85acce199353490c9f3a3db0618da19e">cartouche ETOPS</a> qu&#39;il faut au préalable installer dans l&#39;app Raccourcis. Si vous souhaitez créer un plugin, <a href="https://www.icloud.com/shortcuts/d484cdf5939b4cb2a54535ae94c371d1">OFP2MAP-PLUGIN</a> permet de visualiser les données (format json) transmises par OFP2MAP.',ye=F(),$e=O("h2"),$e.textContent="Mise à jour",be=F(),xe=O("p"),xe.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",we=F(),ke=O("h2"),ke.textContent="Crédits",Pe=F(),Ee=O("ul"),Ee.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',Oe=F(),Me=O("h2"),Me.textContent="Hébergement",Se=F(),je=O("p"),je.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",Ae=F(),Ie=O("h2"),Ie.textContent="Liens",ze=F(),De=O("ul"),Re=O("li"),Fe(We.$$.fragment),Ne=S(" une aide aux calculs des frais professionnels (même auteur)."),I(m,"start","5")},m(e,L){C(e,t,L),C(e,n,L),C(e,o,L),C(e,r,L),C(e,i,L),C(e,s,L),C(e,a,L),C(e,l,L),C(e,c,L),C(e,u,L),C(e,p,L),C(e,d,L),C(e,m,L),C(e,f,L),C(e,g,L),C(e,h,L),C(e,v,L),C(e,y,L),C(e,$,L),C(e,b,L),C(e,x,L),C(e,w,L),C(e,k,L),P(k,E),He&&He.m(k,null),C(e,M,L),C(e,T,L),C(e,_,L),C(e,j,L),C(e,A,L),C(e,z,L),C(e,D,L),C(e,R,L),P(R,W),Te(N,R,null),P(R,U),C(e,H,L),C(e,q,L),C(e,G,L),C(e,B,L),P(B,K),Te(Z,B,null),P(B,X),C(e,J,L),C(e,V,L),C(e,Y,L),C(e,Q,L),C(e,ee,L),C(e,te,L),C(e,ne,L),C(e,oe,L),C(e,re,L),C(e,ie,L),C(e,se,L),C(e,ae,L),C(e,le,L),C(e,ce,L),C(e,ue,L),C(e,pe,L),C(e,de,L),C(e,me,L),C(e,fe,L),C(e,ge,L),C(e,he,L),C(e,ve,L),C(e,ye,L),C(e,$e,L),C(e,be,L),C(e,xe,L),C(e,we,L),C(e,ke,L),C(e,Pe,L),C(e,Ee,L),C(e,Oe,L),C(e,Me,L),C(e,Se,L),C(e,je,L),C(e,Ae,L),C(e,Ie,L),C(e,ze,L),C(e,De,L),P(De,Re),Te(We,Re,null),P(Re,Ne),Ue=!0},p(e,[t]){const n={};1&t&&(n.href=e[0]),8&t&&(n.$$scope={dirty:t,ctx:e}),N.$set(n);const o={};8&t&&(o.$$scope={dirty:t,ctx:e}),Z.$set(o);const r={};8&t&&(r.$$scope={dirty:t,ctx:e}),We.$set(r)},i(e){Ue||(Ce(N.$$.fragment,e),Ce(Z.$$.fragment,e),Ce(We.$$.fragment,e),Ue=!0)},o(e){Le(N.$$.fragment,e),Le(Z.$$.fragment,e),Le(We.$$.fragment,e),Ue=!1},d(e){e&&L(t),e&&L(n),e&&L(o),e&&L(r),e&&L(i),e&&L(s),e&&L(a),e&&L(l),e&&L(c),e&&L(u),e&&L(p),e&&L(d),e&&L(m),e&&L(f),e&&L(g),e&&L(h),e&&L(v),e&&L(y),e&&L($),e&&L(b),e&&L(x),e&&L(w),e&&L(k),He&&He.d(),e&&L(M),e&&L(T),e&&L(_),e&&L(j),e&&L(A),e&&L(z),e&&L(D),e&&L(R),_e(N),e&&L(H),e&&L(q),e&&L(G),e&&L(B),_e(Z),e&&L(J),e&&L(V),e&&L(Y),e&&L(Q),e&&L(ee),e&&L(te),e&&L(ne),e&&L(oe),e&&L(re),e&&L(ie),e&&L(se),e&&L(ae),e&&L(le),e&&L(ce),e&&L(ue),e&&L(pe),e&&L(de),e&&L(me),e&&L(fe),e&&L(ge),e&&L(he),e&&L(ve),e&&L(ye),e&&L($e),e&&L(be),e&&L(xe),e&&L(we),e&&L(ke),e&&L(Pe),e&&L(Ee),e&&L(Oe),e&&L(Me),e&&L(Se),e&&L(je),e&&L(Ae),e&&L(Ie),e&&L(ze),e&&L(De),_e(We)}}}function Bi(e,t,n){let o,r,i;return c(e,ft,(e=>n(1,r=e))),c(e,pt,(e=>n(2,i=e))),e.$$.update=()=>{6&e.$$.dirty&&n(0,o=r?i.ogimetData.url:"http://www.ogimet.com")},[o,r,i]}class Ki extends Ae{constructor(e){super(),je(this,e,Bi,Gi,a,{})}}function Zi(t){let n,o,r,i,s=navigator.share&&function(t){let n,o,r;return{c(){n=O("button"),n.textContent="Partager l'App",I(n,"class","btn btn-outline-secondary btn-sm svelte-ng50vg")},m(e,t){C(e,n,t),o||(r=j(n,"click",Xe),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}();return{c(){s&&s.c(),n=F(),o=O("button"),o.textContent="Recharger l'App",I(o,"class","btn btn-outline-secondary btn-sm svelte-ng50vg")},m(e,a){s&&s.m(e,a),C(e,n,a),C(e,o,a),r||(i=j(o,"click",t[2]),r=!0)},p(e,t){navigator.share&&s.p(e,t)},d(e){s&&s.d(e),e&&L(n),e&&L(o),r=!1,i()}}}function Xi(e){let t,n,o,r,i,s,a,l,c,u,p,d,m,f,g,h=!0===navigator.standalone&&Zi(e);return d=new Ki({}),{c(){t=O("div"),n=O("h1"),o=O("div"),o.innerHTML='<img src="images/ofp2map-icons/icon-128x128.png" alt="logo" class="svelte-ng50vg"/><span class="svelte-ng50vg">OFP2MAP</span>',r=S(" v"),i=S(Ji),s=F(),a=O("small"),l=S("/ ServiceWorker : "),c=S(e[1]),u=F(),h&&h.c(),p=F(),Fe(d.$$.fragment),I(o,"class","app svelte-ng50vg"),I(a,"class","svelte-ng50vg"),I(n,"class","svelte-ng50vg"),I(t,"class","markdown svelte-ng50vg")},m(v,y){C(v,t,y),P(t,n),P(n,o),P(n,r),P(n,i),P(n,s),P(n,a),P(a,l),P(a,c),P(n,u),h&&h.m(n,null),P(t,p),Te(d,t,null),m=!0,f||(g=j(a,"click",e[3],{once:!0}),f=!0)},p(e,[t]){(!m||2&t)&&W(c,e[1]),!0===navigator.standalone&&h.p(e,t)},i(e){m||(Ce(d.$$.fragment,e),m=!0)},o(e){Le(d.$$.fragment,e),m=!1},d(e){e&&L(t),h&&h.d(),_e(d),f=!1,g()}}}const Ji="1.8.2";function Vi(e,t,n){let o;c(e,ot,(e=>n(0,o=e)));let r="";return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=o)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,r=e)))},[o,r,()=>{window.location.hash="#/",window.location.reload()},()=>o&&o.update()&&void 0]}class Yi extends Ae{constructor(e){super(),je(this,e,Vi,Xi,a,{})}}function Qi(e){let t,n,o,r,s,a,l,c,u,p,d,m,f,g,h,v;return{c(){t=O("div"),n=O("div"),o=O("strong"),o.innerHTML='<span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour disponible',r=F(),s=O("button"),s.innerHTML='<span aria-hidden="true">×</span>',a=F(),l=O("div"),c=O("p"),c.textContent="Il faudra recharger l'OFP",u=F(),p=O("button"),d=O("span"),m=S(e[1]),I(o,"class","svelte-395rpc"),I(s,"type","button"),I(s,"class","close svelte-395rpc"),I(s,"aria-label","Close"),I(n,"class","toast-header svelte-395rpc"),I(d,"class","svelte-395rpc"),G(d,"blinking",e[1].endsWith("...")),I(p,"class","btn btn-primary"),I(p,"type","button"),I(l,"class","toast-body text-center"),I(t,"class","toast svelte-395rpc"),U(t,"position","fixed"),U(t,"top","0"),U(t,"right","0")},m(i,f){C(i,t,f),P(t,n),P(n,o),P(n,r),P(n,s),P(t,a),P(t,l),P(l,c),P(l,u),P(l,p),P(p,d),P(d,m),g=!0,h||(v=[j(s,"click",e[6]),j(p,"click",e[7],{once:!0})],h=!0)},p(e,t){(!g||2&t)&&W(m,e[1]),2&t&&G(d,"blinking",e[1].endsWith("..."))},i(e){g||(de((()=>{f||(f=Oe(t,Ve,{},!0)),f.run(1)})),g=!0)},o(e){f||(f=Oe(t,Ve,{},!1)),f.run(0),g=!1},d(e){e&&L(t),e&&f&&f.end(),h=!1,i(v)}}}function es(t){let n,o,r,i,s,a,l,c,u,p,d=(t[4](700)||"")+"";return{c(){n=O("div"),o=O("div"),r=O("div"),r.innerHTML='<strong class="svelte-395rpc"><span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour détectée</strong>',i=F(),s=O("div"),a=O("button"),a.innerHTML="<span>Mise à jour...</span>",l=F(),c=S(d),I(r,"class","toast-header svelte-395rpc"),I(a,"class","btn"),I(a,"type","button"),I(s,"class","toast-body text-center"),I(o,"class","toast svelte-395rpc"),I(n,"class","modal svelte-395rpc")},m(e,d){C(e,n,d),P(n,o),P(o,r),P(o,i),P(o,s),P(s,a),P(n,l),C(e,c,d),u||(p=j(a,"click",A(t[5])),u=!0)},p:e,i:e,o:e,d(e){e&&L(n),e&&L(c),u=!1,p()}}}function ts(e){let t,n,o,r;const i=[es,Qi],s=[];function a(e,t){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:-1:0}return~(t=a(e))&&(n=s[t]=i[t](e)),{c(){n&&n.c(),o=T()},m(e,n){~t&&s[t].m(e,n),C(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?~t&&s[t].p(e,r):(n&&(ke(),Le(s[l],1,1,(()=>{s[l]=null})),Pe()),~t?(n=s[t],n?n.p(e,r):(n=s[t]=i[t](e),n.c()),Ce(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Ce(n),r=!0)},o(e){Le(n),r=!1},d(e){~t&&s[t].d(e),e&&L(o)}}}const ns=tt(),os=e=>{it.set(!0),rt.set(!1),e?st.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.8.2",e)):st.set(!0)};function rs(t,n,o){let r,i,s,a,l=e;c(t,rt,(e=>o(2,r=e))),c(t,ot,(e=>o(8,i=e))),c(t,ns,(e=>o(9,s=e))),c(t,it,(e=>o(3,a=e))),t.$$.on_destroy.push((()=>l()));let u="Installer";h(rt,r=!1,r);let{prompt:p=!1}=n;const d=(e=0)=>{let t;i&&s&&s.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,u="En cours..."),s.waiting.postMessage({type:"SKIP_WAITING"})):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,p=e.prompt)},[p,u,r,a,d,function(e){oe(t,e)},()=>h(rt,r=!0,r),()=>d()]}class is extends Ae{constructor(e){super(),je(this,e,rs,ts,a,{prompt:0})}}function ss(e){let t;return{c(){t=O("ol"),t.innerHTML='<li class="svelte-3tetng">Dans la barre de menu, cliquez sur <svg class="svelte-3tetng"><use xlink:href="#share-symbol"></use></svg></li> \n                    <li class="svelte-3tetng">Faites défiler, choisir : <em>Sur l&#39;écran d&#39;accueil</em>  <svg style="width:22px;height:22px;" class="svelte-3tetng"><use xlink:href="#add2home-symbol"></use></svg></li> \n                    <li class="svelte-3tetng">Lancez l&#39;application depuis l&#39;écran d&#39;accueil</li>',I(t,"class","guide svelte-3tetng")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function as(e){let t;return{c(){t=O("p"),t.textContent="Merci d'ouvrir cette page dans Safari",I(t,"class","guide error svelte-3tetng")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function ls(t){let n,o,r,i,s,a,l,c,u,p,d,m,f,g;n=new dn({});let h=function(e,t){return e[0]?ss:as}(t)(t);return f=new is({}),{c(){Fe(n.$$.fragment),o=F(),r=O("div"),i=O("div"),s=O("div"),s.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-3tetng"/>',a=F(),l=O("div"),c=O("h3"),c.textContent="Installez OFP2MAP",u=F(),p=O("p"),p.innerHTML='Si OFP2MAP est déjà sur l&#39;écran d&#39;accueil, ne l&#39;installez pas une deuxième fois. Attention: l&#39;installation ne peut se faire que depuis\n                le navigateur Safari, si présent, cliquez sur <svg class="safari svelte-3tetng"><use xlink:href="#safari-symbol"></use></svg> en haut à droite.',d=F(),h.c(),m=F(),Fe(f.$$.fragment),I(s,"class","icon-container svelte-3tetng"),I(c,"class","title svelte-3tetng"),I(p,"class","text svelte-3tetng"),I(l,"class","prompt-content svelte-3tetng"),I(i,"class","prompt svelte-3tetng"),I(r,"class","prompt-container svelte-3tetng")},m(e,t){Te(n,e,t),C(e,o,t),C(e,r,t),P(r,i),P(i,s),P(i,a),P(i,l),P(l,c),P(l,u),P(l,p),P(l,d),h.m(l,null),C(e,m,t),Te(f,e,t),g=!0},p:e,i(e){g||(Ce(n.$$.fragment,e),Ce(f.$$.fragment,e),g=!0)},o(e){Le(n.$$.fragment,e),Le(f.$$.fragment,e),g=!1},d(e){_e(n,e),e&&L(o),e&&L(r),h.d(),e&&L(m),_e(f,e)}}}function cs(e){return[Re&&!De]}class us extends Ae{constructor(e){super(),je(this,e,cs,ls,a,{})}}function ps(e){let t,n,o,r,i,s,a,l,c;t=new Di({props:{$$slots:{default:[ms]},$$scope:{ctx:e}}}),o=new is({props:{prompt:!!e[1]}});let u=e[1]&&"success"===e[2]&&fs(e);const p=[xs,bs,$s,ys,vs,hs],d=[];function m(e,t){return"loading"===e[2]?0:e[2]&&"success"!==e[2]&&"/map"===e[3]?1:"/export"===e[3]&&"success"===e[2]?2:"/"===e[3]?3:"/help"===e[3]?4:e[1]&&"/map"===e[3]?-1:5}return~(s=m(e))&&(a=d[s]=p[s](e)),{c(){Fe(t.$$.fragment),n=F(),Fe(o.$$.fragment),r=F(),u&&u.c(),i=F(),a&&a.c(),l=T()},m(e,a){Te(t,e,a),C(e,n,a),Te(o,e,a),C(e,r,a),u&&u.m(e,a),C(e,i,a),~s&&d[s].m(e,a),C(e,l,a),c=!0},p(e,n){const r={};2049&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};2&n&&(c.prompt=!!e[1]),o.$set(c),e[1]&&"success"===e[2]?u?(u.p(e,n),6&n&&Ce(u,1)):(u=fs(e),u.c(),Ce(u,1),u.m(i.parentNode,i)):u&&(ke(),Le(u,1,1,(()=>{u=null})),Pe());let f=s;s=m(e),s===f?~s&&d[s].p(e,n):(a&&(ke(),Le(d[f],1,1,(()=>{d[f]=null})),Pe()),~s?(a=d[s],a?a.p(e,n):(a=d[s]=p[s](e),a.c()),Ce(a,1),a.m(l.parentNode,l)):a=null)},i(e){c||(Ce(t.$$.fragment,e),Ce(o.$$.fragment,e),Ce(u),Ce(a),c=!0)},o(e){Le(t.$$.fragment,e),Le(o.$$.fragment,e),Le(u),Le(a),c=!1},d(e){_e(t,e),e&&L(n),_e(o,e),e&&L(r),u&&u.d(e),e&&L(i),~s&&d[s].d(e),e&&L(l)}}}function ds(t){let n,o;return n=new us({}),{c(){Fe(n.$$.fragment)},m(e,t){Te(n,e,t),o=!0},p:e,i(e){o||(Ce(n.$$.fragment,e),o=!0)},o(e){Le(n.$$.fragment,e),o=!1},d(e){_e(n,e)}}}function ms(e){let t,n;return t=new nr({props:{kmlOptions:e[0]}}),t.$on("change",e[5]),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.kmlOptions=e[0]),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function fs(e){let t,n;return t=new Ni({props:{hidden:"/map"!==e[3],$$slots:{default:[gs]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.hidden="/map"!==e[3]),2059&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function gs(e){let t,n,o;function r(t){e[6](t)}let i={id:"map",ofp:e[1]};return void 0!==e[0]&&(i.kmlOptions=e[0]),t=new Ur({props:i}),ie.push((()=>Se(t,"kmlOptions",r))),t.$on("save",e[7]),{c(){Fe(t.$$.fragment)},m(e,n){Te(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[1]),!n&&1&o&&(n=!0,r.kmlOptions=e[0],me((()=>n=!1))),t.$set(r)},i(e){o||(Ce(t.$$.fragment,e),o=!0)},o(e){Le(t.$$.fragment,e),o=!1},d(e){_e(t,e)}}}function hs(t){let n,o=t[4](t[3])+"";return{c(){n=S(o)},m(e,t){C(e,n,t)},p(e,t){8&t&&o!==(o=e[4](e[3])+"")&&W(n,o)},i:e,o:e,d(e){e&&L(n)}}}function vs(e){let t,n;return t=new Ni({props:{$$slots:{default:[ws]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};2048&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function ys(e){let t,n;return t=new Ni({props:{$$slots:{default:[ks]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};2048&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function $s(e){let t,n;return t=new Ni({props:{$$slots:{default:[Ps]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};2057&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function bs(e){let t,n;return t=new Ni({props:{$$slots:{default:[Cs]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};2052&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function xs(e){let t,n;return t=new Ni({props:{$$slots:{default:[Ls]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},p(e,n){const o={};2048&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function ws(e){let t,n;return t=new Yi({}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function ks(e){let t,n;return t=new fn({}),{c(){Fe(t.$$.fragment)},m(e,o){Te(t,e,o),n=!0},i(e){n||(Ce(t.$$.fragment,e),n=!0)},o(e){Le(t.$$.fragment,e),n=!1},d(e){_e(t,e)}}}function Ps(t){let n,o,r,i;return n=new ln({}),n.$on("save",t[8]),r=new St({}),{c(){Fe(n.$$.fragment),o=F(),Fe(r.$$.fragment)},m(e,t){Te(n,e,t),C(e,o,t),Te(r,e,t),i=!0},p:e,i(e){i||(Ce(n.$$.fragment,e),Ce(r.$$.fragment,e),i=!0)},o(e){Le(n.$$.fragment,e),Le(r.$$.fragment,e),i=!1},d(e){_e(n,e),e&&L(o),_e(r,e)}}}function Cs(e){let t,n,o;return{c(){t=O("p"),n=S("😱: "),o=S(e[2]),I(t,"class","ofpError svelte-nv33jc")},m(e,r){C(e,t,r),P(t,n),P(t,o)},p(e,t){4&t&&W(o,e[2])},d(e){e&&L(t)}}}function Ls(e){let t;return{c(){t=O("div"),t.textContent="traitement en cours...",U(t,"margin","auto")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Es(e){let t,n,o,r,i,s;const a=[ds,ps],l=[];return o=navigator&&!1===navigator.standalone&&ze?0:1,r=l[o]=a[o](e),{c(){t=O("main"),n=O("div"),r.c(),I(n,"class","content svelte-nv33jc"),I(t,"class",i="container "+(e[3].substr(1)||"home")+" svelte-nv33jc")},m(e,r){C(e,t,r),P(t,n),l[o].m(n,null),s=!0},p(e,[n]){r.p(e,n),(!s||8&n&&i!==(i="container "+(e[3].substr(1)||"home")+" svelte-nv33jc"))&&I(t,"class",i)},i(e){s||(Ce(r),s=!0)},o(e){Le(r),s=!1},d(e){e&&L(t),l[o].d()}}}function Os(e,t,n){let o,r,i,s,a;c(e,pt,(e=>n(1,o=e))),c(e,dt,(e=>n(2,r=e))),c(e,bt,(e=>n(3,i=e))),c(e,at,(e=>n(9,s=e))),c(e,rt,(e=>n(10,a=e)));(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in Ft){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(zt)?t=o.toUpperCase():e.endsWith("Display")?t=!!o:e.endsWith("Change")&&(o*=1,isNaN(o)||(t=o.toFixed(1))),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||Kt.setItem(Bt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&Kt.setItem(Bt.shortcut,o));Kt.setItem(Bt.optionsKML,n)})(window.location.search);let l=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Ft&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(zt)?t[n]=o.toUpperCase():n.endsWith("Display")?t[n]=!!o:n.endsWith("Change")&&(o*=1,isNaN(o)||(t[n]=o.toFixed(1))));return{...Ft,...t}})(Kt.getItem(Bt.optionsKML)||{});Zt(l,i);ee((()=>(document.addEventListener("visibilitychange",vt,!1),()=>document.removeEventListener("visibilitychange",vt))));return[l,o,r,i,e=>{window.location.hash="#/"},()=>{h(at,s=!1,s),h(rt,a=!1,a)},function(e){l=e,n(0,l)},()=>Zt(l,i),()=>Zt(l,i)]}class Ms extends Ae{constructor(e){super(),je(this,e,Os,Es,a,{})}}try{self["workbox:window:6.1.2"]&&_()}catch(Ss){}function Ss(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function Fs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ts(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Fs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fs(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.1.2"]&&_()}catch(Ss){}var _s=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function js(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var As=function(e,t){this.type=e,Object.assign(this,t)};function Is(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function zs(){}var Ds={type:"SKIP_WAITING"};function Rs(e,t){if(!t)return e&&e.then?e.then(zs):Promise.resolve()}var Ws=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new _s,o.en=new _s,o.on=new _s,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!js(t.scriptURL,o.sn)||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,i=n===o.vn,s={sw:n,isExternal:i,originalEvent:e};!i&&o.mn&&(s.isUpdate=!0),o.dispatchEvent(new As(r,s)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new As("waiting",s))}),200):"activating"===r&&(clearTimeout(o.wn),i||o.en.resolve(n))},o.dn=function(e){var t=o.hn;t===navigator.serviceWorker.controller&&(o.dispatchEvent(new As("controlling",{sw:t,originalEvent:e,isUpdate:o.mn})),o.on.resolve(t))},o.gn=(r=function(e){var t=e.data,n=e.source;return Is(o.getSW(),(function(){o.an.has(n)&&o.dispatchEvent(new As("message",{data:t,sw:n,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,i=o.prototype;return i.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return Rs(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),Is(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&js(t.scriptURL,o.sn)&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new As("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn,{once:!0}),o.fn}))}))}catch(e){return Promise.reject(e)}},i.update=function(){try{return this.fn?Rs(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},i.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(e){try{return Is(this.getSW(),(function(t){return Ss(t,e)}))}catch(e){return Promise.reject(e)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Ss(this.fn.waiting,Ds)},i.pn=function(){var e=navigator.serviceWorker.controller;return e&&js(e.scriptURL,this.sn)?e:void 0},i.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return Is(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=Ts(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let Ns,Us=!1;try{Ns=new Ms({target:document.body})}catch(e){Us=!0;try{var Hs=document.createElement("p");Hs.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(Hs)}catch(Ts){}}finally{if("serviceWorker"in navigator){const e=new Ws("./sw.js");ot.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{Us?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,Ze(400,Ss(t.sw,{type:"GET_VERSION"})).then((e=>os(e))).catch((e=>{os()})))})),e.register().then((e=>{Us&&e&&e.unregister(),ns.set(e)}),console.error)}}return Ns}();
//# sourceMappingURL=bundle.js.map
