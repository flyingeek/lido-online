var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function l(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function a(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}function d(e){return null==e?"":e}function p(e,t,n=t){return e.set(n),t}function m(t){return t&&l(t.destroy)?t.destroy:e}const f="undefined"!=typeof window;let g=f?()=>window.performance.now():()=>Date.now(),v=f?e=>requestAnimationFrame(e):e;const h=new Set;function y(e){h.forEach(t=>{t.c(e)||(h.delete(t),t.f())}),0!==h.size&&v(y)}function $(e){let t;return 0===h.size&&v(y),{promise:new Promise(n=>{h.add(t={c:e,f:n})}),abort(){h.delete(t)}}}function b(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function x(e){e.parentNode.removeChild(e)}function w(e){return document.createElement(e)}function C(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function P(e){return document.createTextNode(e)}function F(){return P(" ")}function L(){return P("")}function j(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function I(e){return function(t){return t.preventDefault(),e.call(this,t)}}function O(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function S(e,t){t=""+t,e.data!==t&&(e.data=t)}function T(e,t){(null!=t||e.value)&&(e.value=t)}function M(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function R(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function D(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function z(e,t,n){e.classList[n?"add":"remove"](t)}function E(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const A=new Set;let N,W=0;function G(e,t,n,o,r,l,s,i=0){const a=16.666/o;let c="{\n";for(let e=0;e<=1;e+=a){const o=t+(n-t)*l(e);c+=100*e+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,p=e.ownerDocument;A.add(p);const m=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(w("style")).sheet),f=p.__svelte_rules||(p.__svelte_rules={});f[d]||(f[d]=!0,m.insertRule(`@keyframes ${d} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?g+", ":""}${d} ${o}ms linear ${r}ms 1 both`,W+=1,d}function U(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),W-=r,W||v(()=>{W||(A.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),A.clear())}))}function q(e){N=e}function H(){if(!N)throw new Error("Function called outside component initialization");return N}function B(){const e=H();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=E(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}function K(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const J=[],Z=[],V=[],X=[],Y=Promise.resolve();let Q=!1;function ee(){Q||(Q=!0,Y.then(le))}function te(e){V.push(e)}function ne(e){X.push(e)}let oe=!1;const re=new Set;function le(){if(!oe){oe=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];q(t),se(t.$$)}for(J.length=0;Z.length;)Z.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];re.has(t)||(re.add(t),t())}V.length=0}while(J.length);for(;X.length;)X.pop()();Q=!1,oe=!1,re.clear()}}function se(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(te)}}let ie;function ae(){return ie||(ie=Promise.resolve(),ie.then(()=>{ie=null})),ie}function ce(e,t,n){e.dispatchEvent(E(`${t?"intro":"outro"}${n}`))}const ue=new Set;let de;function pe(){de={r:0,c:[],p:de}}function me(){de.r||r(de.c),de=de.p}function fe(e,t){e&&e.i&&(ue.delete(e),e.i(t))}function ge(e,t,n,o){if(e&&e.o){if(ue.has(e))return;ue.add(e),de.c.push(()=>{ue.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const ve={duration:0};function he(e,t){const n=t.token={};function o(e,o,r,l){if(t.token!==n)return;t.resolved=l;let s=t.ctx;void 0!==r&&(s=s.slice(),s[r]=l);const i=e&&(t.current=e)(s);let a=!1;t.block&&(t.blocks?t.blocks.forEach((e,n)=>{n!==o&&e&&(pe(),ge(e,1,1,()=>{t.blocks[n]=null}),me())}):t.block.d(1),i.c(),fe(i,1),i.m(t.mount(),t.anchor),a=!0),t.block=i,t.blocks&&(t.blocks[o]=i),a&&le()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=H();if(e.then(e=>{q(n),o(t.then,1,t.value,e),q(null)},e=>{q(n),o(t.catch,2,t.error,e),q(null)}),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const ye="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function $e(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function be(e){e&&e.c()}function ke(e,t,o){const{fragment:s,on_mount:i,on_destroy:a,after_update:c}=e.$$;s&&s.m(t,o),te(()=>{const t=i.map(n).filter(l);a?a.push(...t):r(t),e.$$.on_mount=[]}),c.forEach(te)}function xe(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function we(t,n,l,s,i,a,c=[-1]){const u=N;q(t);const d=n.props||{},p=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:i,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c};let m=!1;if(p.ctx=l?l(t,d,(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=r)&&(p.bound[e]&&p.bound[e](r),m&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),ee(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n}):[],p.update(),m=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(x)}else p.fragment&&p.fragment.c();n.intro&&fe(t.$$.fragment),ke(t,n.target,n.anchor),le()}q(u)}class Ce{$destroy(){xe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}class Pe{constructor(){this.promise=new Promise((e,t)=>{this.reject=t,this.resolve=e})}}const Fe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;function Le(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function je(e,{delay:n=0,duration:o=400,easing:r=t}){const l=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*l}}function Ie(e){let t;return{c(){t=w("textarea"),t.value=e[0],O(t,"class","svelte-177r5gj")},m(n,o){k(n,t,o),e[8](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&x(t),e[8](null)}}}function Oe(t){let n,o;return{c(){n=w("a"),n.textContent="copier la route",O(n,"role","button"),O(n,"class","btn btn-primary svelte-177r5gj"),O(n,"href","lhs-mpilot://")},m(e,r,l){k(e,n,r),l&&o(),o=j(n,"click",t[4])},p:e,d(e){e&&x(n),o()}}}function _e(t){let n,o,r,l;return{c(){n=w("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=w("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',O(n,"role","button"),O(n,"class","btn btn-primary svelte-177r5gj"),O(n,"href","lhs-mpilot://"),O(r,"class","card-text")},m(e,s,i){k(e,n,s),k(e,o,s),k(e,r,s),i&&l(),l=j(n,"click",t[4])},p:e,d(e){e&&x(n),e&&x(o),e&&x(r),l()}}}function Se(n){let o,s,i;return{c(){o=w("span"),o.textContent="copié!",O(o,"class","svelte-177r5gj")},m(e,t){k(e,o,t),i=!0},i(e){i||(s&&s.end(1),i=!0)},o(n){s=function(n,o,s){let i,a=o(n,s),c=!0;const u=de;function d(){const{delay:o=0,duration:l=300,easing:s=t,tick:d=e,css:p}=a||ve;p&&(i=G(n,1,0,l,o,s,p));const m=g()+o,f=m+l;te(()=>ce(n,!1,"start")),$(e=>{if(c){if(e>=f)return d(0,1),ce(n,!1,"end"),--u.r||r(u.c),!1;if(e>=m){const t=s((e-m)/l);d(1-t,t)}}return c})}return u.r+=1,l(a)?ae().then(()=>{a=a(),d()}):d(),{end(e){e&&a.tick&&a.tick(1,0),c&&(i&&U(n,i),c=!1)}}}(o,je,{}),i=!1},d(e){e&&x(o),e&&s&&s.end()}}}function Te(e){let t,n,o,r,l,s,i,a,c,u,d,p,m=null!=e[0]&&Ie(e);let f=(Fe?_e:Oe)(e),g=e[2]&&Se();return{c(){m&&m.c(),t=F(),n=w("div"),o=w("div"),r=w("h5"),r.textContent="Route Lido",l=F(),s=w("p"),s.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",i=F(),f.c(),a=F(),c=w("div"),u=P(e[3]),d=F(),g&&g.c(),O(r,"class","card-title"),O(s,"class","card-text"),O(c,"class","text-monospace svelte-177r5gj"),O(o,"class","card-body"),O(n,"class","card mb-3 svelte-177r5gj")},m(e,v){m&&m.m(e,v),k(e,t,v),k(e,n,v),b(n,o),b(o,r),b(o,l),b(o,s),b(o,i),f.m(o,null),b(o,a),b(o,c),b(c,u),b(c,d),g&&g.m(c,null),p=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=Ie(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&fe(g,1):(g=Se(),g.c(),fe(g,1),g.m(c,null)):g&&(pe(),ge(g,1,1,()=>{g=null}),me())},i(e){p||(fe(g),p=!0)},o(e){ge(g),p=!1},d(e){m&&m.d(e),e&&x(t),e&&x(n),f.d(),g&&g.d()}}}let Me=!1;try{navigator.permissions.query({name:"clipboard-write"}).then(e=>{"granted"!=e.state&&"prompt"!=e.state||(Me=!0)})}catch(e){}function Re(e,t,n){let o,{ofp:r}=t,l=null;const s=r?r.lidoRoute().join(" "):"";let i=!1;async function a(e){let t=!0;if(Me)navigator.clipboard.writeText(e).then(()=>t=!0,()=>t=!1);else{n(0,l=e),await(ee(),Y),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,l=null)}return t}return e.$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[l,o,i,s,e=>{e.target.classList.remove("hasactive");const t=a(s);Fe||(n(2,i=t),setTimeout((function(){n(2,i=!1)}),3e3),e.preventDefault())},r,e=>{e.target.classList.remove("hasactive"),show=!show},a,function(e){Z[e?"unshift":"push"](()=>{n(1,o=e)})}]}class De extends Ce{constructor(e){super(),we(this,e,Re,Te,s,{ofp:5})}}const ze={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000"};function Ee(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const Ae=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Ee(window.kmlGen,ze)),window.kmlGen);function Ne(t){let n,o,s,i,a,c,u,d,p,f,g,v,h,y,$,C,L,I;return{c(){n=w("kmlcolor"),o=w("div"),s=w("label"),i=P("Couleur"),a=F(),c=w("picker"),u=w("label"),d=w("input"),g=F(),v=w("input"),y=F(),$=w("input"),O(s,"for",t[1]),O(s,"class","input-group-text svelte-4j1cdk"),O(o,"class","input-group-prepend"),O(d,"type","color"),O(d,"class","svelte-4j1cdk"),O(u,"style",p=He(t[2])),O(u,"class","svelte-4j1cdk"),O(v,"type","range"),O(v,"min","30"),O(v,"max","255"),O(v,"class","svelte-4j1cdk"),O(c,"class","form-control svelte-4j1cdk"),O(c,"style",h=qe(t[2][0])),O($,"name",t[1]),O($,"class","form-control text-monospace svelte-4j1cdk"),O($,"style",C=Be(t[0])),O($,"type","text"),O($,"maxlength","8"),O(n,"class","input-group svelte-4j1cdk")},m(e,l,p){k(e,n,l),b(n,o),b(o,s),b(s,i),b(n,a),b(n,c),b(c,u),b(u,d),T(d,t[2][0]),b(c,g),b(c,v),T(v,t[2][1]),b(n,y),b(n,$),T($,t[0]),p&&r(I),I=[j(d,"input",t[7]),m(f=t[4].call(null,u,t[0])),j(v,"change",t[8]),j(v,"input",t[8]),m(L=t[3].call(null,$,t[2])),j($,"input",t[9])]},p(e,[t]){2&t&&O(s,"for",e[1]),4&t&&T(d,e[2][0]),4&t&&p!==(p=He(e[2]))&&O(u,"style",p),f&&l(f.update)&&1&t&&f.update.call(null,e[0]),4&t&&T(v,e[2][1]),4&t&&h!==(h=qe(e[2][0]))&&O(c,"style",h),2&t&&O($,"name",e[1]),1&t&&C!==(C=Be(e[0]))&&O($,"style",C),L&&l(L.update)&&4&t&&L.update.call(null,e[2]),1&t&&$.value!==e[0]&&T($,e[0])},i:e,o:e,d(e){e&&x(n),r(I)}}}const We=/^[A-F0-9]{8}$/i,Ge=e=>{let[t,n]=Ue(e);return[t,n/255]},Ue=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},qe=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map(e=>parseInt(e,16));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},He=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Be=e=>e.match(We)?"":"border-color: #F00;";function Ke(e,t,n){const o=B();let r,{kmlColor:l="FF0000FF"}=t,{name:s}=t;try{r=Ue(l)}catch(e){r=["#FF0000",255]}const i=function(e,t,n){let o;return function(){const r=this,l=arguments,s=function(){o=null,n||e.apply(r,l)},i=n&&!o;clearTimeout(o),o=setTimeout(s,t),i&&e.apply(r,l)}}(o,500);return e.$set=e=>{"kmlColor"in e&&n(0,l=e.kmlColor),"name"in e&&n(1,s=e.name)},[l,s,r,function(e){return{update(e){const[t,o]=e;n(0,l=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),i("change",{name:s,value:l})}}},function(e){return{update(e){if(e.match(We)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),i("change",{name:s,value:e.toUpperCase()})}}}},o,i,function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?void 0:+e,n(2,r)},function(){l=this.value,n(0,l)}]}class Je extends Ce{constructor(e){super(),we(this,e,Ke,Ne,s,{kmlColor:0,name:1})}}function Ze(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ve(e){let t,n,o,r,l=e[4].label+"";return{c(){t=w("option"),n=P(l),t.__value=o=e[6],t.value=t.__value,t.selected=r=e[6]===e[0]},m(e,o){k(e,t,o),b(t,n)},p(e,n){1&n&&r!==(r=e[6]===e[0])&&(t.selected=r)},d(e){e&&x(t)}}}function Xe(t){let n,o,s,i,a,c,u,d,p,m,f,g=Ye,v=[];for(let e=0;e<g.length;e+=1)v[e]=Ve(Ze(t,g,e));return{c(){n=w("div"),o=w("div"),s=w("label"),i=P("Repère"),a=F(),c=w("span"),u=C("svg"),d=C("use"),p=F(),m=w("select");for(let e=0;e<v.length;e+=1)v[e].c();O(s,"class","input-group-text svelte-1j0ign2"),O(s,"for",t[1]),_(d,"xlink:href","#marker"),M(d,"stroke",0===t[0]?"#fff":"#000"),M(d,"fill",Ye[t[0]].color),O(u,"class","svelte-1j0ign2"),O(c,"class","input-group-text svelte-1j0ign2"),O(o,"class","input-group-prepend"),O(m,"name",t[1]),O(m,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&te(()=>t[3].call(m)),O(n,"class","input-group svelte-1j0ign2")},m(e,g,h){k(e,n,g),b(n,o),b(o,s),b(s,i),b(o,a),b(o,c),b(c,u),b(u,d),b(n,p),b(n,m);for(let e=0;e<v.length;e+=1)v[e].m(m,null);R(m,t[0]),h&&r(f),f=[j(m,"change",t[3]),j(m,"change",(function(){l(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))]},p(e,[n]){if(t=e,2&n&&O(s,"for",t[1]),1&n&&M(d,"stroke",0===t[0]?"#fff":"#000"),1&n&&M(d,"fill",Ye[t[0]].color),1&n){let e;for(g=Ye,e=0;e<g.length;e+=1){const o=Ze(t,g,e);v[e]?v[e].p(o,n):(v[e]=Ve(o),v[e].c(),v[e].m(m,null))}for(;e<v.length;e+=1)v[e].d(1);v.length=g.length}2&n&&O(m,"name",t[1]),1&n&&R(m,t[0])},i:e,o:e,d(e){e&&x(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(v,e),r(f)}}}const Ye=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Qe(e,t,n){const o=B();let{selected:r=0}=t,{name:l}=t;return e.$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,l=e.name)},[r,l,o,function(){r=D(this),n(0,r)}]}class et extends Ce{constructor(e){super(),we(this,e,Qe,Xe,s,{selected:0,name:1})}}const tt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),nt=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function ot(t){let n,o;return{c(){n=w("button"),n.textContent="Revenir aux valeurs par défaut",O(n,"class","btn btn-link btn-sm float-right"),O(n,"type","button")},m(e,r,l){k(e,n,r),l&&o(),o=j(n,"click",t[7])},p:e,d(e){e&&x(n),o()}}}function rt(e){let t,n,o,l,s,i,a,c,u,p,m,f,g,v,h,y,$,L,S,T,M,R,D,E,A,N,W,G,U,q,H,B,K,J,Z,V,X,Y,Q,ee,te,ne,oe,re,le,se,ie,ae,ce,ue,de,pe,me,ve,he,ye,$e,we,Ce,Pe,Fe,Le,je,Ie,Oe,_e,Se,Te,Me,Re,De,ze,Ee,Ae,Ne,We,Ge,Ue,qe,He,Be,Ke,Ze,Ve;const Xe=new Je({props:{name:"route-color",kmlColor:e[0].routeColor}});Xe.$on("change",e[6]);const Ye=new et({props:{name:"route-pin",selected:e[0].routePin}});Ye.$on("change",e[6]);const Qe=new Je({props:{name:"alternate-color",kmlColor:e[0].alternateColor}});Qe.$on("change",e[6]);const tt=new et({props:{name:"alternate-pin",selected:e[0].alternatePin}});tt.$on("change",e[6]);const nt=new Je({props:{name:"nat-color",kmlColor:e[0].natColor}});nt.$on("change",e[6]);const rt=new et({props:{name:"nat-pin",selected:e[0].natPin}});rt.$on("change",e[6]);const lt=new Je({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}});lt.$on("change",e[6]);const st=new Je({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}});st.$on("change",e[6]);let it=!e[4]&&ot(e);return{c(){t=w("div"),n=w("a"),o=C("svg"),l=C("use"),s=F(),i=w("form"),a=w("fieldset"),c=w("legend"),c.textContent="Route",u=F(),p=w("div"),m=w("div"),be(Xe.$$.fragment),g=F(),v=w("div"),be(Ye.$$.fragment),y=F(),$=w("fieldset"),L=w("legend"),S=w("input"),M=P("Dégagement"),R=F(),D=w("div"),E=w("div"),be(Qe.$$.fragment),N=F(),W=w("div"),be(tt.$$.fragment),U=F(),q=w("fieldset"),H=w("legend"),B=w("input"),J=P("Tracks"),Z=F(),V=w("div"),X=w("div"),be(nt.$$.fragment),Y=F(),Q=w("small"),Q.textContent="Un track incomplet restera rouge.",te=F(),ne=w("div"),be(rt.$$.fragment),oe=F(),re=w("small"),re.textContent="Positionné à l'entrée des tracks.",se=F(),ie=w("div"),ae=w("div"),ce=w("fieldset"),ue=w("legend"),de=w("input"),me=P("Orthodromie"),ve=F(),he=w("div"),ye=w("div"),be(lt.$$.fragment),we=F(),Ce=w("div"),Pe=w("fieldset"),Fe=w("legend"),Le=w("input"),Ie=P("Route du GRAMET"),Oe=F(),_e=w("div"),Se=w("div"),be(st.$$.fragment),Me=F(),Re=w("div"),De=w("div"),ze=w("button"),Ee=P("Mémoriser"),Ne=F(),We=w("button"),Ge=P("Restaurer"),He=F(),Be=w("div"),it&&it.c(),_(l,"xlink:href","#bars"),O(o,"class","svelte-1tnnmv1"),z(o,"blink",e[3]),O(n,"class","hamburger svelte-1tnnmv1"),O(n,"role","button"),O(n,"href","."),O(c,"class","svelte-1tnnmv1"),O(m,"class",f=d(e[2])+" svelte-1tnnmv1"),O(v,"class",h=d(e[2])+" svelte-1tnnmv1"),O(p,"class","row"),O(a,"class","form-group"),O(S,"name","alternate-display"),S.checked=T=e[0].alternateDisplay,O(S,"type","checkbox"),O(S,"class","svelte-1tnnmv1"),O(L,"class","svelte-1tnnmv1"),O(E,"class",A=d(e[2])+" svelte-1tnnmv1"),O(W,"class",G=d(e[2])+" svelte-1tnnmv1"),O(D,"class","row"),O($,"class","form-group"),O(B,"name","nat-display"),B.checked=K=e[0].natDisplay,O(B,"type","checkbox"),O(B,"class","svelte-1tnnmv1"),O(H,"class","svelte-1tnnmv1"),O(Q,"class","form-text text-muted svelte-1tnnmv1"),O(X,"class",ee=d(e[2])+" svelte-1tnnmv1"),O(re,"class","form-text text-muted svelte-1tnnmv1"),O(ne,"class",le=d(e[2])+" svelte-1tnnmv1"),O(V,"class","row"),O(q,"class","form-group"),O(de,"name","great-circle-display"),de.checked=pe=e[0].greatCircleDisplay,O(de,"type","checkbox"),O(de,"class","svelte-1tnnmv1"),O(ue,"class","svelte-1tnnmv1"),O(ye,"class","col"),O(he,"class","row"),O(ce,"class","form-group"),O(ae,"class",$e=d(e[2])+" svelte-1tnnmv1"),O(Le,"name","ogimet-display"),Le.checked=je=e[0].ogimetDisplay,O(Le,"type","checkbox"),O(Le,"class","svelte-1tnnmv1"),O(Fe,"class","svelte-1tnnmv1"),O(Se,"class","col"),O(_e,"class","row"),O(Pe,"class","form-group"),O(Ce,"class",Te=d(e[2])+" svelte-1tnnmv1"),O(ie,"class","row"),ze.disabled=Ae=!e[5],O(ze,"class","btn btn-primary btn-sm mb-2"),O(ze,"type","button"),We.disabled=Ue=!e[5],O(We,"class","btn btn-secondary btn-sm mb-2"),O(We,"type","button"),O(De,"class",qe=d(e[2])+" svelte-1tnnmv1"),O(Be,"class",Ke=d(e[2])+" svelte-1tnnmv1"),O(Re,"class","row"),O(i,"class","svelte-1tnnmv1"),O(t,"class","settings svelte-1tnnmv1"),z(t,"sidebar",e[1])},m(d,f,h){k(d,t,f),b(t,n),b(n,o),b(o,l),b(t,s),b(t,i),b(i,a),b(a,c),b(a,u),b(a,p),b(p,m),ke(Xe,m,null),b(p,g),b(p,v),ke(Ye,v,null),b(i,y),b(i,$),b($,L),b(L,S),b(L,M),b($,R),b($,D),b(D,E),ke(Qe,E,null),b(D,N),b(D,W),ke(tt,W,null),b(i,U),b(i,q),b(q,H),b(H,B),b(H,J),b(q,Z),b(q,V),b(V,X),ke(nt,X,null),b(X,Y),b(X,Q),b(V,te),b(V,ne),ke(rt,ne,null),b(ne,oe),b(ne,re),b(i,se),b(i,ie),b(ie,ae),b(ae,ce),b(ce,ue),b(ue,de),b(ue,me),b(ce,ve),b(ce,he),b(he,ye),ke(lt,ye,null),b(ie,we),b(ie,Ce),b(Ce,Pe),b(Pe,Fe),b(Fe,Le),b(Fe,Ie),b(Pe,Oe),b(Pe,_e),b(_e,Se),ke(st,Se,null),b(i,Me),b(i,Re),b(Re,De),b(De,ze),b(ze,Ee),b(De,Ne),b(De,We),b(We,Ge),b(Re,He),b(Re,Be),it&&it.m(Be,null),Ze=!0,h&&r(Ve),Ve=[j(n,"click",I(e[15])),j(S,"change",e[6]),j(B,"change",e[6]),j(de,"change",e[6]),j(Le,"change",e[6]),j(ze,"click",e[9]),j(We,"click",e[8]),j(i,"submit",I(e[14]))]},p(e,[n]){8&n&&z(o,"blink",e[3]);const r={};1&n&&(r.kmlColor=e[0].routeColor),Xe.$set(r),(!Ze||4&n&&f!==(f=d(e[2])+" svelte-1tnnmv1"))&&O(m,"class",f);const l={};1&n&&(l.selected=e[0].routePin),Ye.$set(l),(!Ze||4&n&&h!==(h=d(e[2])+" svelte-1tnnmv1"))&&O(v,"class",h),(!Ze||1&n&&T!==(T=e[0].alternateDisplay))&&(S.checked=T);const s={};1&n&&(s.kmlColor=e[0].alternateColor),Qe.$set(s),(!Ze||4&n&&A!==(A=d(e[2])+" svelte-1tnnmv1"))&&O(E,"class",A);const i={};1&n&&(i.selected=e[0].alternatePin),tt.$set(i),(!Ze||4&n&&G!==(G=d(e[2])+" svelte-1tnnmv1"))&&O(W,"class",G),(!Ze||1&n&&K!==(K=e[0].natDisplay))&&(B.checked=K);const a={};1&n&&(a.kmlColor=e[0].natColor),nt.$set(a),(!Ze||4&n&&ee!==(ee=d(e[2])+" svelte-1tnnmv1"))&&O(X,"class",ee);const c={};1&n&&(c.selected=e[0].natPin),rt.$set(c),(!Ze||4&n&&le!==(le=d(e[2])+" svelte-1tnnmv1"))&&O(ne,"class",le),(!Ze||1&n&&pe!==(pe=e[0].greatCircleDisplay))&&(de.checked=pe);const u={};1&n&&(u.kmlColor=e[0].greatCircleColor),lt.$set(u),(!Ze||4&n&&$e!==($e=d(e[2])+" svelte-1tnnmv1"))&&O(ae,"class",$e),(!Ze||1&n&&je!==(je=e[0].ogimetDisplay))&&(Le.checked=je);const p={};1&n&&(p.kmlColor=e[0].ogimetColor),st.$set(p),(!Ze||4&n&&Te!==(Te=d(e[2])+" svelte-1tnnmv1"))&&O(Ce,"class",Te),(!Ze||32&n&&Ae!==(Ae=!e[5]))&&(ze.disabled=Ae),(!Ze||32&n&&Ue!==(Ue=!e[5]))&&(We.disabled=Ue),(!Ze||4&n&&qe!==(qe=d(e[2])+" svelte-1tnnmv1"))&&O(De,"class",qe),e[4]?it&&(it.d(1),it=null):it?it.p(e,n):(it=ot(e),it.c(),it.m(Be,null)),(!Ze||4&n&&Ke!==(Ke=d(e[2])+" svelte-1tnnmv1"))&&O(Be,"class",Ke),2&n&&z(t,"sidebar",e[1])},i(e){Ze||(fe(Xe.$$.fragment,e),fe(Ye.$$.fragment,e),fe(Qe.$$.fragment,e),fe(tt.$$.fragment,e),fe(nt.$$.fragment,e),fe(rt.$$.fragment,e),fe(lt.$$.fragment,e),fe(st.$$.fragment,e),Ze=!0)},o(e){ge(Xe.$$.fragment,e),ge(Ye.$$.fragment,e),ge(Qe.$$.fragment,e),ge(tt.$$.fragment,e),ge(nt.$$.fragment,e),ge(rt.$$.fragment,e),ge(lt.$$.fragment,e),ge(st.$$.fragment,e),Ze=!1},d(e){e&&x(t),xe(Xe),xe(Ye),xe(Qe),xe(tt),xe(nt),xe(rt),xe(lt),xe(st),it&&it.d(),r(Ve)}}}function lt(e,t){return JSON.stringify(e)===JSON.stringify(t)}function st(e,t,n){const o=B(),r=tt.optionsKML;let{kmlOptions:l}=t,{mode:s="col-12 col-sm-6 col-md-12 col-lg-12 col-xl-12"}=t,i={...ze,...nt.getItem(r)||{}},{sidebar:a}=t,c=lt(ze,l);function u(e){let t=!1;for(const[s,i]of Object.entries(e))l[s]!==i&&(n(0,l[s]=i,l),o("change",{name:(r=s,r.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:i}),t=!0);var r;t&&n(0,l={...e})}let d,p;return e.$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions),"mode"in e&&n(2,s=e.mode),"sidebar"in e&&n(1,a=e.sidebar)},e.$$.update=()=>{1&e.$$.dirty&&n(4,d=lt(ze,l)),1025&e.$$.dirty&&n(5,p=!lt(i,l))},[l,a,s,c,d,p,function(e){const t=e.detail?e.detail.name:e.target.name,r=e.detail?e.detail.value:e.target.checked,s=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));l[s]!==r&&(n(0,l[s]=r,l),o("change",{name:t,value:r}))},function(){u(ze)},function(){u(i)},function(){if(d)nt.removeItem(r);else{const e={};for(const t of Object.keys(l).filter(e=>l[e]!==ze[e]))e[t]=l[t];nt.setItem(r,e)}o("save"),n(10,i={...l})},i,o,r,u,function(t){K(e,t)},()=>{n(1,a=!a),n(3,c=!1)}]}class it extends Ce{constructor(e){super(),we(this,e,st,rt,s,{kmlOptions:0,mode:2,sidebar:1})}}function at(t){let n,o,l,s,i,a,c,u,d;return{c(){n=w("div"),o=w("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',l=F(),s=w("input"),i=F(),a=w("div"),c=w("a"),u=P("Lancer"),O(o,"class","input-group-prepend"),O(s,"class","form-control svelte-1ecyaux"),O(s,"placeholder","Nom du raccourci"),O(s,"type","text"),O(c,"class","btn btn-outline-secondary svelte-1ecyaux"),O(c,"href",t[1]),z(c,"disabled",!(t[0].trim()&&Fe)),O(a,"class","input-group-append"),O(n,"class","input-group")},m(e,p,m){k(e,n,p),b(n,o),b(n,l),b(n,s),T(s,t[0]),b(n,i),b(n,a),b(a,c),b(c,u),m&&r(d),d=[j(s,"input",t[8]),j(s,"change",t[3]),j(c,"click",t[2])]},p(e,[t]){1&t&&s.value!==e[0]&&T(s,e[0]),2&t&&O(c,"href",e[1]),1&t&&z(c,"disabled",!(e[0].trim()&&Fe))},i:e,o:e,d(e){e&&x(n),r(d)}}}function ct(e,t,n){const o=B(),r=tt.shortcut;let l,s=nt.getItem(r)||"Lido Online",{ofp:i}=t;const a=i?i.lidoRoute().join(" "):"";return e.$set=e=>{"ofp"in e&&n(4,i=e.ofp)},[s,l,function(e){const t=s.trim();if(t&&Fe){const e=Ae(),o={lidoRoute:a,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})};n(1,l="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=s.trim();"Lido Online"===e?nt.removeItem(r):nt.setItem(r,e),o("save",[r,e])},i,o,r,a,function(){s=this.value,n(0,s)}]}class ut extends Ce{constructor(e){super(),we(this,e,ct,at,s,{ofp:4})}}const dt=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function l(e,t){return e.getElementsByTagName(t)}function s(e,t){return e.getAttribute(t)}function i(e,t){return parseFloat(s(e,t))}function a(e,t){var n=l(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function d(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=a(e,t[o]))&&(r[t[o]]=u(n));return r}function p(e,t){for(var n in t)e[n]=t[n]}function m(e){return c(e.replace(t,"").split(","))}function f(e){for(var t=e.replace(n,"").split(o),r=[],l=0;l<t.length;l++)r.push(m(t[l]));return r}function g(e){var t,n=[i(e,"lon"),i(e,"lat")],o=a(e,"ele"),r=a(e,"gpxtpx:hr")||a(e,"hr"),l=a(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:l?u(l):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},i={},d=["Polygon","LineString","Point","Track","gx:Track"],p=l(e,"Placemark"),g=l(e,"Style"),h=l(e,"StyleMap"),y=0;y<g.length;y++){var $=r(v(g[y])).toString(16);n["#"+s(g[y],"id")]=$,o[$]=g[y]}for(var b=0;b<h.length;b++){n["#"+s(h[b],"id")]=r(v(h[b])).toString(16);for(var k=l(h[b],"Pair"),x={},w=0;w<k.length;w++)x[u(a(k[w],"key"))]=u(a(k[w],"styleUrl"));i["#"+s(h[b],"id")]=x}for(var C=0;C<p.length;C++)t.features=t.features.concat(L(p[C]));function P(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function F(e){var t=l(e,"coord"),n=[],o=[];0===t.length&&(t=l(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var s=l(e,"when"),i=0;i<s.length;i++)o.push(u(s[i]));return{coords:n,times:o}}function L(e){var t,r=function e(t){var n,o,r,s,i,c=[],p=[];if(a(t,"MultiGeometry"))return e(a(t,"MultiGeometry"));if(a(t,"MultiTrack"))return e(a(t,"MultiTrack"));if(a(t,"gx:MultiTrack"))return e(a(t,"gx:MultiTrack"));for(r=0;r<d.length;r++)if(o=l(t,d[r]))for(s=0;s<o.length;s++)if(n=o[s],"Point"===d[r])c.push({type:"Point",coordinates:m(u(a(n,"coordinates")))});else if("LineString"===d[r])c.push({type:"LineString",coordinates:f(u(a(n,"coordinates")))});else if("Polygon"===d[r]){var g=l(n,"LinearRing"),v=[];for(i=0;i<g.length;i++)v.push(f(u(a(g[i],"coordinates"))));c.push({type:"Polygon",coordinates:v})}else if("Track"===d[r]||"gx:Track"===d[r]){var h=F(n);c.push({type:"LineString",coordinates:h.coords}),h.times.length&&p.push(h.times)}return{geoms:c,coordTimes:p}}(e),c={},p=u(a(e,"name")),g=u(a(e,"address")),v=u(a(e,"styleUrl")),h=u(a(e,"description")),y=a(e,"TimeSpan"),$=a(e,"TimeStamp"),b=a(e,"ExtendedData"),k=a(e,"LineStyle"),x=a(e,"PolyStyle"),w=a(e,"visibility");if(!r.geoms.length)return[];if(p&&(c.name=p),g&&(c.address=g),v){"#"!==v[0]&&(v="#"+v),c.styleUrl=v,n[v]&&(c.styleHash=n[v]),i[v]&&(c.styleMapHash=i[v],c.styleHash=n[i[v].normal]);var C=o[c.styleHash];if(C){k||(k=a(C,"LineStyle")),x||(x=a(C,"PolyStyle"));var L=a(C,"IconStyle");if(L){var j=a(L,"Icon");if(j){var I=u(a(j,"href"));I&&(c.icon=I)}}}}if(h&&(c.description=h),y){var O=u(a(y,"begin")),_=u(a(y,"end"));c.timespan={begin:O,end:_}}if($&&(c.timestamp=u(a($,"when"))),k){var S=P(u(a(k,"color"))),T=S[0],M=S[1],R=parseFloat(u(a(k,"width")));T&&(c.stroke=T),isNaN(M)||(c["stroke-opacity"]=M),isNaN(R)||(c["stroke-width"]=R)}if(x){var D=P(u(a(x,"color"))),z=D[0],E=D[1],A=u(a(x,"fill")),N=u(a(x,"outline"));z&&(c.fill=z),isNaN(E)||(c["fill-opacity"]=E),A&&(c["fill-opacity"]="1"===A?c["fill-opacity"]||1:0),N&&(c["stroke-opacity"]="1"===N?c["stroke-opacity"]||1:0)}if(b){var W=l(b,"Data"),G=l(b,"SimpleData");for(t=0;t<W.length;t++)c[W[t].getAttribute("name")]=u(a(W[t],"value"));for(t=0;t<G.length;t++)c[G[t].getAttribute("name")]=u(G[t])}w&&(c.visibility=u(w)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var U={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return s(e,"id")&&(U.id=s(e,"id")),[U]}return t},gpx:function(e){var t,n,o=l(e,"trk"),r=l(e,"rte"),i=l(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=v(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=h(r[t]))&&c.features.push(n);for(t=0;t<i.length;t++)c.features.push(y(i[t]));function m(e,t){for(var n=0;n<t;n++)e.push(null);return e}function f(e,t){var n=l(e,t),o=[],r=[],s=[],i=n.length;if(i<2)return{};for(var a=0;a<i;a++){var c=g(n[a]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||s.length)&&(s.length||m(s,a),s.push(c.heartRate||null))}return{line:o,times:r,heartRates:s}}function v(e){for(var t,n=l(e,"trkseg"),o=[],r=[],s=[],i=0;i<n.length;i++)if((t=f(n[i],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),s.length||t.heartRates&&t.heartRates.length)){if(!s.length)for(var c=0;c<i;c++)s.push(m([],o[c].length));t.heartRates&&t.heartRates.length?s.push(t.heartRates):s.push(m([],t.line.length||0))}if(0!==o.length){var u=b(e);return p(u,$(a(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),s.length&&(u.heartRates=1===o.length?s[0]:s),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function h(e){var t=f(e,"rtept");if(t.line){var n=b(e);return p(n,$(a(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=b(e);return p(t,d(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function $(e){var t={};if(e){var n=a(e,"line");if(n){var o=u(a(n,"color")),r=parseFloat(u(a(n,"opacity"))),l=parseFloat(u(a(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(l)||(t["stroke-width"]=96*l/25.4)}}return t}function b(e){var t=d(e,["name","cmt","desc","type","time","keywords"]),n=l(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)p(o={href:s(n[r],"href")},d(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function pt(t){let n,o,l,s,i,a,c,u,d,p,m,f,g,v,h,y,$,C,L,I=gt[0]+"",_=gt[1]+"",T=gt[2]+"";return{c(){n=w("div"),o=w("select"),l=w("option"),s=P(I),c=w("option"),u=P(_),m=w("option"),f=P(T),h=F(),y=w("div"),$=w("a"),C=P(t[0]),l.selected=i=0===t[1],l.__value=a=0,l.value=l.__value,c.selected=d=1===t[1],c.__value=p=1,c.value=c.__value,m.selected=g=2===t[1],m.__value=v=2,m.value=m.__value,O(o,"class","custom-select svelte-19hokx5"),O(o,"aria-label","Example select with button addon"),void 0===t[1]&&te(()=>t[8].call(o)),O($,"class","btn btn-success"),O($,"download",t[3]),O($,"href",t[2]),O($,"target",mt),O(y,"class","input-group-append"),O(n,"class","input-group")},m(e,i,a){k(e,n,i),b(n,o),b(o,l),b(l,s),b(o,c),b(c,u),b(o,m),b(m,f),R(o,t[1]),b(n,h),b(n,y),b(y,$),b($,C),a&&r(L),L=[j(o,"change",t[8]),j(o,"change",t[5]),j($,"click",t[4])]},p(e,[t]){2&t&&i!==(i=0===e[1])&&(l.selected=i),2&t&&d!==(d=1===e[1])&&(c.selected=d),2&t&&g!==(g=2===e[1])&&(m.selected=g),2&t&&R(o,e[1]),1&t&&S(C,e[0]),8&t&&O($,"download",e[3]),4&t&&O($,"href",e[2])},i:e,o:e,d(e){e&&x(n),r(L)}}}const mt=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,ft=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},gt=["KML Mapsme","KML Avenza","GeoJson"];function vt(e,t,n){const o=B();let{label:r}=t;const l=tt.downloadType;let s=nt.getItem(l)||1;"string"==typeof s&&(s=parseInt(s,10));let i="",a="";return e.$set=e=>{"label"in e&&n(0,r=e.label)},[r,s,i,a,function(e){const t=Ae(),o=["_mapsme.kml","_avenza.kml",".geojson"][s];let r=t.name;if(r?(r=r.trim(),n(3,a=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,a="editolido"+o),0===s)n(2,i=ft(t.render()));else if(1===s)n(2,i=ft(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==s)return e.preventDefault(),!1;n(2,i=ft(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return dt.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===s?nt.removeItem(l):nt.setItem(l,s),o("save",[l,s])},o,l,function(){s=D(this),n(1,s)}]}class ht extends Ce{constructor(e){super(),we(this,e,vt,pt,s,{label:0})}}function yt(e){let t,n,o,r,l,s,i,a,c;const u=new ht({props:{label:"Télécharger"}});u.$on("save",e[1]);const d=new ut({props:{ofp:e[0]}});return d.$on("save",e[2]),{c(){t=w("div"),n=w("div"),be(u.$$.fragment),o=F(),r=w("small"),r.textContent="Le fichier est généré en fonction des options choisies.",l=F(),s=w("div"),be(d.$$.fragment),i=F(),a=w("small"),a.innerHTML='Sur iOS on peut lancer un raccourci.\n            <a href="https://www.icloud.com/shortcuts/8833e7fb6e484ec7be86ab9bd8c056d7" target="_blank">\n                Exemple de raccourci\n            </a>',O(r,"class","text-muted svelte-1slqiqh"),O(n,"class","col-12 col-sm-6 col-md-6 svelte-1slqiqh"),O(a,"class","text-muted svelte-1slqiqh"),O(s,"class","col-12 col-sm-6 col-md-6 svelte-1slqiqh"),O(t,"class","row svelte-1slqiqh")},m(e,p){k(e,t,p),b(t,n),ke(u,n,null),b(n,o),b(n,r),b(t,l),b(t,s),ke(d,s,null),b(s,i),b(s,a),c=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){c||(fe(u.$$.fragment,e),fe(d.$$.fragment,e),c=!0)},o(e){ge(u.$$.fragment,e),ge(d.$$.fragment,e),c=!1},d(e){e&&x(t),xe(u),xe(d)}}}function $t(e,t,n){let{ofp:o}=t;return e.$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){K(e,t)},function(t){K(e,t)}]}class bt extends Ce{constructor(e){super(),we(this,e,$t,yt,s,{ofp:0})}}function kt(e){let t;return{c(){t=w("div"),t.innerHTML='<span class="sr-only">Loading...</span>',O(t,"class","spinner-border text-warning"),O(t,"role","status")},m(e,n){k(e,t,n)},d(e){e&&x(t)}}}function xt(e){let t,n,o,r,l,s,i,a,c,u;return{c(){t=w("div"),n=w("p"),o=P("😱: Erreur de récupération du Gramet, "),r=w("a"),r.textContent="essayez à nouveau",l=P(" ou allez sur "),s=w("a"),i=P("ogimet"),c=P("."),O(r,"href","."),O(s,"href",a=e[0].ogimetData.url),O(s,"target","_blank"),O(n,"class","svelte-i1m2fr"),O(t,"class","error svelte-i1m2fr")},m(a,d,p){k(a,t,d),b(t,n),b(n,o),b(n,r),b(n,l),b(n,s),b(s,i),b(n,c),p&&u(),u=j(r,"click",I(e[4]))},p(e,t){1&t&&a!==(a=e[0].ogimetData.url)&&O(s,"href",a)},d(e){e&&x(t),u()}}}function wt(e){let t,n,o;return{c(){t=w("img"),O(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&O(t,"src",n),O(t,"alt","gramet demo"),O(t,"class","img-fluid svelte-i1m2fr")},m(n,l,s){k(n,t,l),s&&r(o),o=[j(t,"error",e[2]),j(t,"load",e[3])]},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&O(t,"src",n)},d(e){e&&x(t),r(o)}}}function Ct(t){let n,o,r,l,s,i,a,c,u,d,p,m,f,g,v,h,y,$,C,L,j,I="loading"===t[1]&&kt();function _(e,t){return"error"!==e[1]?wt:xt}let S=_(t),T=S(t);return{c(){n=w("div"),o=w("h1"),o.innerHTML='Le GRAMET est un météogramme représentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et à l&#39;heure de passage estimée, une coupe verticale de la météo prévue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interprétation</a>',r=F(),l=w("div"),I&&I.c(),s=F(),T.c(),i=F(),a=w("div"),c=w("div"),u=w("div"),d=w("div"),p=w("div"),p.textContent="Route Ogimet",m=F(),f=w("div"),g=w("p"),v=P("Le GRAMET est réalisé par "),h=w("a"),y=P("www.ogimet.com"),C=P(" à partir\n    d'une route calculée. Il est possible d'afficher la route sur la carte. Celà est\n    particulièrement utile lors des vols océaniques car il n'y a aucune station en mer."),L=F(),j=w("div"),j.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Après avoir sélectionner les stations météo proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectué pour réduire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',O(o,"class","svelte-i1m2fr"),O(l,"class","text-center svelte-i1m2fr"),O(p,"class","card-header svelte-i1m2fr"),O(h,"class","text-warning"),O(h,"href",$=t[0].ogimetData.url),O(h,"target","_blank"),O(g,"class","card-text"),O(f,"class","card-body"),O(d,"class","card ogimet svelte-i1m2fr"),O(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),O(j,"class","col-12 col-sm-6 col-md-6 col-xl-6"),O(c,"class","card-deck"),O(a,"class","row")},m(e,t){k(e,n,t),b(n,o),b(n,r),b(n,l),I&&I.m(l,null),b(l,s),T.m(l,null),b(n,i),b(n,a),b(a,c),b(c,u),b(u,d),b(d,p),b(d,m),b(d,f),b(f,g),b(g,v),b(g,h),b(h,y),b(g,C),b(c,L),b(c,j)},p(e,[t]){"loading"===e[1]?I||(I=kt(),I.c(),I.m(l,s)):I&&(I.d(1),I=null),S===(S=_(e))&&T?T.p(e,t):(T.d(1),T=S(e),T&&(T.c(),T.m(l,null))),1&t&&$!==($=e[0].ogimetData.url)&&O(h,"href",$)},i:e,o:e,d(e){e&&x(n),I&&I.d(),T.d()}}}function Pt(e,t,n){let o="loading",{ofp:r}=t;return e.$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class Ft extends Ce{constructor(e){super(),we(this,e,Pt,Ct,s,{ofp:0})}}function Lt(t){let n,o,r;return{c(){n=w("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-19djfbb"> en KML/GeoJSON',o=F(),r=w("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3"><div class="card avenza svelte-19djfbb"><div class="card-header svelte-19djfbb">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card mapsme svelte-19djfbb"><div class="card-header svelte-19djfbb">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le thème par défaut s&#39;accorde parfaitement avec les fichiers avions, également compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card ogimet svelte-19djfbb"><div class="card-header svelte-19djfbb">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card shortcuts svelte-19djfbb"><div class="card-header svelte-19djfbb">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Récupérez le KML, le Gramet, et une route Lido optimisée dans l&#39;app Raccourcis</p></div></div></div></div>',O(n,"class","text-center svelte-19djfbb"),O(r,"class","row")},m(e,t){k(e,n,t),k(e,o,t),k(e,r,t)},p:e,i:e,o:e,d(e){e&&x(n),e&&x(o),e&&x(r)}}}class jt extends Ce{constructor(e){super(),we(this,e,null,Lt,s,{})}}function It(e,t){const n=t.ofp,o=t.kmlOptions;mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q";const r=new mapboxgl.Map({container:e.id,style:"mapbox://styles/mapbox/streets-v11",center:[0,49],zoom:2});window.lidoMap=r,r.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||r.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),r.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||r.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),r.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||r.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),r.loadImage("sdf/map-star-sdf.png",(function(e,t){e||r.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),r.on("load",(function(){!function(e,t,n){t={...ze,...t};const o=e.description,r=`${e.infos.departure}-${e.infos.destination}`,l=new editolido.Route(e.wptCoordinates(),{name:r,description:o}),s=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),i=new editolido.Route([l.points[0],l.points[l.points.length-1]]).split(300,{name:"Ortho "+r});Dt(n,"greatcircle",i.points,t.greatCircleColor,t.greatCircleDisplay),Dt(n,"ogimet",e.ogimetData.route.points,t.ogimetColor,t.ogimetDisplay),Dt(n,"ralt",s.points,t.alternateColor,t.alternateDisplay),Dt(n,"rmain",l.points,t.routeColor,!0),Et(n,"ralt",s.points,t.alternatePin,t.alternateDisplay,t.alternateColor),Et(n,"rmain",l.points,t.routePin,!0,t.routeColor),n.addSource("fir-reg-source",{type:"geojson",data:"data/fir-reg.2007d.geojson"}),n.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"#F00","#FF7F00"],"fill-opacity":["case",["==","FIR-RED",["get","type"]],.25,.2]}}),n.addSource("airports-source",{type:"geojson",attribution:`Airports/FIR ${e.infos.aircraft} ${"2007d".substring(0,2)}.${"2007d".substring(2,4)} © Olivier Ravet - Yammer/Maps.me`,data:"data/airports.2007d.geojson"}),n.addLayer({id:"airports-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,visibility:"visible","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","symbol-sort-key":["get",""+e.infos.aircraft]},paint:{"icon-color":["case",["==",1,["get","level"]],"#B71","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:["!",["in",""+e.infos.aircraft,["get","type"]]]}),n.addLayer({id:"airports-layer",type:"symbol",source:"airports-source",layout:{"icon-image":"sdf-airport","icon-size":.6,"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,visibility:"visible","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","symbol-sort-key":["get",""+e.infos.aircraft]},paint:{"icon-color":["case",["==",0,["get","level"]],"#095","#B71"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:["in",""+e.infos.aircraft,["get","type"]]}),function(e,t,n,o,r){const l={rnat:[],"rnat-incomplete":[]},s={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete",n=e.points.map(e=>[e.longitude,e.latitude]);l[t].push(Mt(n,e.name));const o=e.points[0];if(s[t].push(Tt(o,`${e.name}\n${o.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];s[t].push(Tt(n,`${e.name}\n${n.name}`,e.description))}}e.addSource("rnat-marker-source",St(s.rnat)),e.addSource("rnat-incomplete-marker-source",St(s["rnat-incomplete"])),e.addSource("rnat-line-source",St(l.rnat)),e.addSource("rnat-incomplete-line-source",St(l["rnat-incomplete"])),e.addLayer(_t("rnat",n,r)),e.addLayer(_t("rnat-incomplete",ze.natIncompleteColor,r)),e.addLayer(Ot("rnat",o,n,r)),e.addLayer(Ot("rnat-incomplete",o,n,r));const i=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},a=t=>{const n=t+"-marker-layer";e.on("click",n,i),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};a("rnat"),a("rnat-incomplete")}(n,e,t.natColor,t.natPin,t.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,l,s){const[i]=Ge(o),[a]=Ge(s),c=n.map(e=>Tt(e,e.name,e.description));e.addSource(t+"-marker-source",St(c.reverse())),e.addLayer({id:t+"-marker-layer",type:"symbol",source:t+"-marker-source",layout:{"icon-image":"sdf-triangle","icon-size":1,"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:r?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":["case",["==","ETOPS",["get","description"]],i,a],"icon-halo-width":1,"icon-halo-color":"#000","text-color":["case",["==","ETOPS",["get","description"]],i,a],"text-opacity":1}});for(let i=0;i<n.length;i+=1)0===i?Dt(e,t+"-eep-circle",n[0].circle(420),s,r):1===i?Dt(e,t+"-exp-circle",n[1].circle(420),s,r):Dt(e,`${t}-etops${i-2}-circle`,n[i].circle(7*l),o,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),"800324FC",!0,e.infos.ETOPS,t.routeColor)}(n,o,r),async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet")}));let l=void 0;let s=[];for(const e of n.tracks)s=s.concat(e.points);s=s.concat(n.route.points,n.wptCoordinatesAlternate()),l=((e,t=[1/0,1/0,-1/0,-1/0])=>{for(const n of e)t[0]>n.longitude&&(t[0]=n.longitude),t[1]>n.latitude&&(t[1]=n.latitude),t[2]<n.longitude&&(t[2]=n.longitude),t[3]<n.latitude&&(t[3]=n.latitude);return t[0]-=1,t[1]-=1,t[2]+=1,t[3]+=1,t})(s),r.fitBounds(l,{padding:{top:30,bottom:80,left:30,right:30}}),r.addControl(new mapboxgl.FullscreenControl);const i=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!1});return r.addControl(i),document.addEventListener("webkitfullscreenchange",(function(e){document.webkitfullscreen,r.resize()})),{update(e){"/map"===e.route&&r&&r.resize()},destroy(){r.remove(),window.map=void 0}}}function Ot(e,t,n,o){const[r,l]=Ge(n);return{id:e+"-marker-layer",type:"symbol",source:e+"-marker-source",layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?zt[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(l,.7)}}}function _t(e,t,n){const[o,r]=Ge(t);let l=2,s=[1];return-1!==e.indexOf("-eep")||-1!==e.indexOf("-exp")||-1!==e.indexOf("-etops")?(l=1,s=[10,10]):-1!==e.indexOf("rnat")&&(l=1),{id:e+"-line-layer",type:"line",source:e+"-line-source",layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":l,"line-dasharray":s}}}function St(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Tt(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function Mt(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}function Rt(e){return!("ogimet"===e||"greatcircle"===e)}function Dt(e,t,n,o,r){e.addSource(t+"-line-source",{type:"geojson",data:Mt(n.map(e=>[e.longitude,e.latitude]))}),e.addLayer(_t(t,o,r))}const zt=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function Et(e,t,n,o,r,l){const s=n.map(e=>Tt(e,e.name.replace(/00\.0/g,"")));e.addSource(t+"-marker-source",St(s)),e.addLayer(Ot(t,o,l,r))}function At(e,t,n){const o=t+"-marker-layer",r=t+"-line-layer";e.setLayoutProperty(r,"visibility",n?"visible":"none"),Rt(t)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function Nt(e,t,n){const o=Le(t);t.endsWith("-display")?("rnat"===o&&At(e,"rnat-incomplete",n),At(e,o,n)):t.endsWith("-pin")?function(e,t,n){const o=zt[n],r=t+"-marker-layer",l=t+"-line-layer",s=e.getPaintProperty(l,"line-color");e.setPaintProperty(r,"icon-color",0!==n?o:s),e.setPaintProperty(r,"text-color",s),e.setLayoutProperty(r,"icon-size",0!==n?1:.2),e.setLayoutProperty(r,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(r,"icon-anchor",0!==n?"bottom":"center")}(e,o,n):t.endsWith("-color")&&function(e,t,n){const[o,r]=Ge(n),l=t+"-marker-layer",s=t+"-line-layer";if(e.setPaintProperty(s,"line-color",o),e.setPaintProperty(s,"line-opacity",r),Rt(t)&&e.setPaintProperty(l,"text-color",o),"rmain"===t){const t="etops-marker-layer",n="etops-eep-circle-line-layer",l="etops-exp-circle-line-layer";if(e.getLayer(t)){const s=e.getPaintProperty(t,"icon-color");s.pop(),s.push(o),e.setPaintProperty(t,"icon-color",s),e.setPaintProperty(t,"text-color",s),e.setPaintProperty(n,"line-color",o),e.setPaintProperty(l,"line-color",o),e.setPaintProperty(n,"line-opacity",r),e.setPaintProperty(l,"line-opacity",r)}}}(e,o,n)}function Wt(t){let n,o,r;return{c(){n=w("div"),O(n,"id","map"),O(n,"class","svelte-1l2r18a")},m(e,l,s){k(e,n,l),s&&r(),r=m(o=It.call(null,n,{ofp:t[1],kmlOptions:t[0],route:t[2]}))},p(e,[t]){o&&l(o.update)&&7&t&&o.update.call(null,{ofp:e[1],kmlOptions:e[0],route:e[2]})},i:e,o:e,d(e){e&&x(n),r()}}}function Gt(e,t,n){let{kmlOptions:o}=t,{ofp:r}=t,{route:l}=t;return e.$set=e=>{"kmlOptions"in e&&n(0,o=e.kmlOptions),"ofp"in e&&n(1,r=e.ofp),"route"in e&&n(2,l=e.route)},[o,r,l]}class Ut extends Ce{constructor(e){super(),we(this,e,Gt,Wt,s,{kmlOptions:0,ofp:1,route:2})}}function qt(e){let t,n;return{c(){t=w("li"),n=w("a"),n.textContent="CARTE",O(n,"class","nav-link svelte-1967td7"),O(n,"href","#/map"),z(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1967td7"),z(t,"active","/map"===e[0])},m(e,o){k(e,t,o),b(t,n)},p(e,o){2&o&&z(n,"disabled",!e[1]),1&o&&z(t,"active","/map"===e[0])},d(e){e&&x(t)}}}function Ht(e){let t,n;return{c(){t=w("li"),n=w("a"),n.textContent="GRAMET",O(n,"class","nav-link svelte-1967td7"),O(n,"href","#/gramet"),z(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1967td7"),z(t,"active","/gramet"===e[0])},m(e,o){k(e,t,o),b(t,n)},p(e,o){2&o&&z(n,"disabled",!e[1]),1&o&&z(t,"active","/gramet"===e[0])},d(e){e&&x(t)}}}function Bt(e){let t,n;return{c(){t=w("li"),n=w("a"),n.textContent="ROUTE",O(n,"class","nav-link svelte-1967td7"),O(n,"href","#/route"),z(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1967td7"),z(t,"active","/route"===e[0])},m(e,o){k(e,t,o),b(t,n)},p(e,o){2&o&&z(n,"disabled",!e[1]),1&o&&z(t,"active","/route"===e[0])},d(e){e&&x(t)}}}function Kt(e){let t,n,o,r,l,s,i,d,p,m,f=(e[1]||"/map"===e[0])&&qt(e),g=(e[1]||"/gramet"===e[0])&&Ht(e),v=(e[1]||"/route"===e[0])&&Bt(e);const h=e[3].default,y=a(h,e,e[2],null);return{c(){t=w("nav"),n=w("ul"),o=w("li"),o.innerHTML='<a class="nav-link" href="#/"><svg class="svelte-1967td7"><use xlink:href="#home"></use></svg></a>',r=F(),f&&f.c(),l=F(),g&&g.c(),s=F(),v&&v.c(),i=F(),d=w("li"),d.innerHTML='<a class="nav-link" href="#/help">AIDE</a>',p=F(),y&&y.c(),O(o,"class","nav-item svelte-1967td7"),z(o,"active","/"===e[0]),O(d,"class","nav-item svelte-1967td7"),z(d,"active","/help"===e[0]),O(n,"class","navbar-nav mr-auto"),O(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-1967td7")},m(e,a){k(e,t,a),b(t,n),b(n,o),b(n,r),f&&f.m(n,null),b(n,l),g&&g.m(n,null),b(n,s),v&&v.m(n,null),b(n,i),b(n,d),b(t,p),y&&y.m(t,null),m=!0},p(e,[t]){1&t&&z(o,"active","/"===e[0]),e[1]||"/map"===e[0]?f?f.p(e,t):(f=qt(e),f.c(),f.m(n,l)):f&&(f.d(1),f=null),e[1]||"/gramet"===e[0]?g?g.p(e,t):(g=Ht(e),g.c(),g.m(n,s)):g&&(g.d(1),g=null),e[1]||"/route"===e[0]?v?v.p(e,t):(v=Bt(e),v.c(),v.m(n,i)):v&&(v.d(1),v=null),1&t&&z(d,"active","/help"===e[0]),y&&y.p&&4&t&&y.p(c(h,e,e[2],null),u(h,e[2],t,null))},i(e){m||(fe(y,e),m=!0)},o(e){ge(y,e),m=!1},d(e){e&&x(t),f&&f.d(),g&&g.d(),v&&v.d(),y&&y.d(e)}}}function Jt(e,t,n){let{route:o}=t,{promise:r}=t,{$$slots:l={},$$scope:s}=t;return e.$set=e=>{"route"in e&&n(0,o=e.route),"promise"in e&&n(1,r=e.promise),"$$scope"in e&&n(2,s=e.$$scope)},[o,r,s,l]}class Zt extends Ce{constructor(e){super(),we(this,e,Jt,Kt,s,{route:0,promise:1})}}function Vt(t){let n,o,l,s,i,a;return{c(){n=w("div"),o=w("input"),l=F(),s=w("label"),i=P(t[2]),O(o,"id",en),O(o,"name",en),O(o,"type","file"),O(o,"accept","application/pdf"),o.disabled=t[1],O(o,"class","custom-file-input"),O(s,"class","custom-file-label text-truncate svelte-1jgqkzg"),O(s,"for",en),z(s,"ready",t[3]),O(n,"class","custom-file svelte-1jgqkzg"),z(n,"blink",!t[0])},m(e,c,u){k(e,n,c),b(n,o),b(n,l),b(n,s),b(s,i),u&&r(a),a=[j(o,"change",t[5]),j(o,"click",t[4],{once:!0})]},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&S(i,e[2]),8&t&&z(s,"ready",e[3]),1&t&&z(n,"blink",!e[0])},i:e,o:e,d(e){e&&x(n),r(a)}}}const Xt="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",Yt=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.2.8.min.js"},{type:"script",url:"./js/wmo.1.2.8.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"},{type:"link",url:Xt,options:{prefetch:!0}}],Qt=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map(e=>e.str).join("")};let en="file";function tn(e,t,n){let{promise:o}=t,{kmlOptions:r}=t,l=!1,s=new Pe,i="Choisir un OFP",a=!1;const c=B();function u(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach(({type:e,url:t,options:n={async:!0,defer:!0}})=>{const l="script"===e,s=document.createElement(l?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(s.crossOrigin="anonymous");let i=!0;l?(s.src=t,s.async=n.async,s.defer=n.defer):(s.href=t,"prefetch"in n?(s.rel="prefetch",o-=1,i=!1):"preload"in n?(s.rel="preload",o-=1,i=!1):(s.rel="stylesheet",o-=1,i=!1)),i&&(s.onload=r),document.body.appendChild(s)})}(Yt,()=>!!window["pdfjs-dist/build/pdf"],()=>{window["pdfjs-dist/build/pdf"].GlobalWorkerOptions.workerSrc=Xt,s.resolve(!0),n(3,a=!0)})}const d=e=>{const t=new FileReader;return new Promise((n,o)=>{t.onload=e=>{(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,l=r.numPages;for(let e=1;e<=l;e+=1){const t=await Qt(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result}).then(e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e);try{Ae();!function(e,t){let n={...ze,...t};const o=Ae();Ee(o,n);const r=e.description;o.setName(r);const l=`${e.infos.departure}-${e.infos.destination}`,s=new editolido.Route(e.wptCoordinates(),{name:l,description:r}),i=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),a=new editolido.Route([s.points[0],s.points[s.points.length-1]]).split(300,{name:"Ortho "+l});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",a),o.addLine("rmain",s),o.addPoints("rmain",s,{excluded:c}),o.addLine("ralt",i);const u=new editolido.GeoGridIndex;u.data=window.WMO;const d=editolido.ogimetData(e,u),p=d.route;d.proxyImg="https://editolido.alwaysdata.net/proxy_gramet/"+d.route.name.replace(/[^a-z0-9\-_]/giu,"_")+".png?url="+encodeURIComponent(d.url),e.ogimetData=d,p.description=d.wmo.join(" "),o.addLine("ogimet",p),o.addPoints("ralt",i)}(t,r),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))},e=>o(e))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)})};return e.$set=e=>{"promise"in e&&n(0,o=e.promise),"kmlOptions"in e&&n(6,r=e.kmlOptions)},[o,l,i,a,u,async function(e){n(1,l=!0),u(),await s.promise.then(()=>{const t=e.target.files[0];t&&(n(2,i=e.target.value.split(/([\\/])/g).pop()),c("change",i),n(0,o=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))}),n(1,l=!1)},r]}class nn extends Ce{constructor(e){super(),we(this,e,tn,Vt,s,{promise:0,kmlOptions:6})}}function on(n){let o,r,s;const i=n[3].default,d=a(i,n,n[2],null);return{c(){o=w("page"),d&&d.c(),O(o,"class","svelte-7uc4nn"),z(o,"fadein",!1===n[0]),z(o,"d-none",!0===n[0])},m(e,t){k(e,o,t),d&&d.m(o,null),s=!0},p(e,[t]){d&&d.p&&4&t&&d.p(c(i,e,e[2],null),u(i,e[2],t,null)),1&t&&z(o,"fadein",!1===e[0]),1&t&&z(o,"d-none",!0===e[0])},i(i){s||(fe(d,i),r||te(()=>{r=function(n,o,r){let s,i,a=o(n,r),c=!1,u=0;function d(){s&&U(n,s)}function p(){const{delay:o=0,duration:r=300,easing:l=t,tick:p=e,css:m}=a||ve;m&&(s=G(n,0,1,r,o,l,m,u++)),p(0,1);const f=g()+o,v=f+r;i&&i.abort(),c=!0,te(()=>ce(n,!0,"start")),i=$(e=>{if(c){if(e>=v)return p(1,0),ce(n,!0,"end"),d(),c=!1;if(e>=f){const t=l((e-f)/r);p(t,1-t)}}return c})}let m=!1;return{start(){m||(U(n),l(a)?(a=a(),ae().then(p)):p())},invalidate(){m=!1},end(){c&&(d(),c=!1)}}}(o,n[1],{}),r.start()}),s=!0)},o(e){ge(d,e),s=!1},d(e){e&&x(o),d&&d.d(e)}}}function rn(e,t,n){let{hidden:o}=t;let{$$slots:r={},$$scope:l}=t;return e.$set=e=>{"hidden"in e&&n(0,o=e.hidden),"$$scope"in e&&n(2,l=e.$$scope)},[o,(e,t,n)=>{if(void 0===o)return je(e,t)},l,r]}class ln extends Ce{constructor(e){super(),we(this,e,rn,on,s,{hidden:0})}}const sn=[];const an=function(t,n=e){let o;const r=[];function l(e){if(s(t,e)&&(t=e,o)){const e=!sn.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),sn.push(n,t)}if(e){for(let e=0;e<sn.length;e+=2)sn[e][0](sn[e+1]);sn.length=0}}}return{set:l,update:function(e){l(e(t))},subscribe:function(s,i=e){const a=[s,i];return r.push(a),1===r.length&&(o=n(l)||e),s(t),()=>{const e=r.indexOf(a);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}(!1);function cn(e){let t,n,o,r,l,s,i=e[2].msg+"",a=0!==e[2].code&&pn(e);return{c(){t=w("p"),n=P("Service Worker status: "),o=w("span"),r=P(i),s=F(),a&&a.c(),O(o,"data-status",l=e[2].code),O(o,"class","svelte-fbozdp")},m(e,l){k(e,t,l),b(t,n),b(t,o),b(o,r),b(t,s),a&&a.m(t,null)},p(e,n){4&n&&i!==(i=e[2].msg+"")&&S(r,i),4&n&&l!==(l=e[2].code)&&O(o,"data-status",l),0!==e[2].code?a?a.p(e,n):(a=pn(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&x(t),a&&a.d()}}}function un(e){let t,n,o,r,l,s,i,a=e[2].msg+"";return{c(){t=w("p"),n=P("Service Worker status: "),o=w("span"),r=P(a),s=w("a"),s.textContent="Installer",O(o,"data-status",l=e[2].code),O(o,"class","svelte-fbozdp"),O(s,"href",".")},m(l,a,c){k(l,t,a),b(t,n),b(t,o),b(o,r),b(t,s),c&&i(),i=j(s,"click",I(e[4]))},p(e,t){4&t&&a!==(a=e[2].msg+"")&&S(r,a),4&t&&l!==(l=e[2].code)&&O(o,"data-status",l)},d(e){e&&x(t),i()}}}function dn(t){let n,o,r,l;return{c(){n=w("p"),o=P("La page n'est pas controllée par le service worker. "),r=w("a"),r.textContent="Recharger la page",O(r,"href","./index.html")},m(e,s,i){k(e,n,s),b(n,o),b(n,r),i&&l(),l=j(r,"click",t[5])},p:e,d(e){e&&x(n),l()}}}function pn(e){let t;function n(e,t){return e[0]===vn?fn:mn}let o=n(e),r=o(e);return{c(){r.c(),t=L()},m(e,n){r.m(e,n),k(e,t,n)},p(e,l){o===(o=n(e))&&r?r.p(e,l):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&x(t)}}}function mn(e){let t;return{c(){t=P(e[0])},m(e,n){k(e,t,n)},p(e,n){1&n&&S(t,e[0])},d(e){e&&x(t)}}}function fn(e){let t,n,o;return{c(){t=w("a"),n=P(e[0]),O(t,"href",".")},m(r,l,s){k(r,t,l),b(t,n),s&&o(),o=j(t,"click",I(e[7]))},p(e,t){1&t&&S(n,e[0])},d(e){e&&x(t),o()}}}function gn(t){let n,o,l,s,i,a,c=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[3]?2===e[2].code?un:cn:dn}let o=n(e),r=o(e);return{c(){r.c(),t=L()},m(e,n){r.m(e,n),k(e,t,n)},p(e,l){o===(o=n(e))&&r?r.p(e,l):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&x(t)}}}(t),u=!0===navigator.standalone&&function(t){let n,o,l,s,i,a,c,u,d,p,m,f;return{c(){n=w("p"),n.textContent="En cas de problème:",o=F(),l=w("p"),s=w("a"),s.textContent="Recharger l'App",i=P(" c'est l'équivalent d'un rechargement de page."),a=F(),c=w("p"),u=w("a"),u.textContent="Réinitialiser l'App",d=P(" va en plus réinitialiser le service Worker (il faut être connecté)."),p=F(),m=w("p"),m.textContent="Dans les 2 cas vos réglages sont conservés mais l'OFP est remis à zéro.",O(s,"class","btn btn-primary btn-sm"),O(s,"href","./index.html"),O(u,"class","btn btn-danger btn-sm"),O(u,"href","./index.html")},m(e,g,v){k(e,n,g),k(e,o,g),k(e,l,g),b(l,s),b(l,i),k(e,a,g),k(e,c,g),b(c,u),b(c,d),k(e,p,g),k(e,m,g),v&&r(f),f=[j(s,"click",t[5]),j(u,"click",t[6])]},p:e,d(e){e&&x(n),e&&x(o),e&&x(l),e&&x(a),e&&x(c),e&&x(p),e&&x(m),r(f)}}}(t);return{c(){n=w("div"),o=w("p"),l=P("Application version: 0.3.1"),s=P(t[1]),i=F(),c&&c.c(),a=F(),u&&u.c(),O(n,"class","svelte-fbozdp")},m(e,t){k(e,n,t),b(n,o),b(o,l),b(o,s),b(n,i),c&&c.m(n,null),b(n,a),u&&u.m(n,null)},p(e,[t]){2&t&&S(s,e[1]),navigator.serviceWorker&&c.p(e,t),!0===navigator.standalone&&u.p(e,t)},i:e,o:e,d(e){e&&x(n),c&&c.d(),u&&u.d()}}}const vn="Vérifier Mise à jour";function hn(e,t,n){let o;i(e,an,e=>n(10,o=e));let r=window.serviceWorker,l=!0;!r&&navigator.serviceWorker&&navigator.serviceWorker.ready.then(e=>(n(8,r=e),e)).catch(e=>n(9,l=!1));let s=navigator.serviceWorker&&navigator.serviceWorker.controller,a=vn;const c=e=>e?e.installing?{code:1,msg:"🔹 installing"}:e.waiting?{code:2,msg:"🔸 waiting"}:e.active?{code:3,msg:"🟢"}:void 0:{code:0,msg:"🔺 unknown"},u=()=>{window.location.reload()};let d,m,f;return e.$$.update=()=>{256&e.$$.dirty&&n(2,m=c(r)),512&e.$$.dirty&&n(3,f=s&&l)},n(1,d=window.editolido?" / lidojs: v"+window.editolido.version:""),[a,d,m,f,()=>{r.waiting&&(p(an,o=!0),r.waiting.postMessage("SKIP_WAITING"))},u,e=>{if(!window.confirm("Vous devez être connecté au réseau, ceci ne devrait être utile qu'en cas de bug, Réinitialiser ?"))return e.preventDefault(),!1;r&&r.unregister(),u()},()=>{n(0,a="Vérification... "),p(an,o=!1),r.update().then(e=>{3!==c(e).code?(n(0,a=""),n(8,r)):n(0,a="À jour")}).catch(e=>n(0,a=e))}]}class yn extends Ce{constructor(e){super(),we(this,e,hn,gn,s,{})}}function $n(t){return{c:e,m:e,p:e,d:e}}function bn(e){let t,n=e[5]&&!e[1]&&kn(e);return{c(){n&&n.c(),t=L()},m(e,o){n&&n.m(e,o),k(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=kn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&x(t)}}}function kn(e){let t,n,o,l,s,i,a,c,u,d;function p(e,t){return e[0]?xn:wn}let m=p(e),f=m(e);function g(...t){return e[4](e[5],...t)}return{c(){t=w("div"),n=w("div"),o=w("strong"),o.innerHTML='<span class="svelte-5snzlz">👨🏻‍✈️</span>Mise à jour disponible',l=F(),s=w("button"),s.innerHTML='<span aria-hidden="true">×</span>',i=F(),a=w("div"),f.c(),c=F(),u=w("button"),u.textContent="Installer",O(o,"class","mr-auto svelte-5snzlz"),O(s,"type","button"),O(s,"class","ml-2 mb-1 close"),O(s,"aria-label","Close"),O(n,"class","toast-header"),O(u,"type","button"),O(u,"class","btn"),z(u,"btn-primary",!e[0]),z(u,"btn-danger",e[0]),O(a,"class","toast-body text-center"),O(t,"class","toast svelte-5snzlz"),M(t,"position","absolute"),M(t,"top","0"),M(t,"right","0")},m(p,m,v){k(p,t,m),b(t,n),b(n,o),b(n,l),b(n,s),b(t,i),b(t,a),f.m(a,null),b(a,c),b(a,u),v&&r(d),d=[j(s,"click",e[3]),j(u,"click",g)]},p(t,n){m!==(m=p(e=t))&&(f.d(1),f=m(e),f&&(f.c(),f.m(a,c))),1&n&&z(u,"btn-primary",!e[0]),1&n&&z(u,"btn-danger",e[0])},d(e){e&&x(t),f.d(),r(d)}}}function xn(e){let t;return{c(){t=w("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){k(e,t,n)},d(e){e&&x(t)}}}function wn(e){let t;return{c(){t=w("p"),t.textContent="Celà va recharger l'App"},m(e,n){k(e,t,n)},d(e){e&&x(t)}}}function Cn(t){return{c:e,m:e,p:e,d:e}}function Pn(t){let n,o,r={ctx:t,current:null,token:null,pending:Cn,then:bn,catch:$n,value:5};return he(o=window.isSWUpdateAvailable.promise,r),{c(){n=L(),r.block.c()},m(e,t){k(e,n,t),r.block.m(e,r.anchor=t),r.mount=()=>n.parentNode,r.anchor=n},p(e,[n]){{const o=(t=e).slice();o[5]=r.resolved,r.block.p(o,n)}},i:e,o:e,d(e){e&&x(n),r.block.d(e),r.token=null,r=null}}}function Fn(e,t,n){let o;i(e,an,e=>n(1,o=e));let{loaded:r=!1}=t;const l=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,l,()=>p(an,o=!0),e=>l(e)]}class Ln extends Ce{constructor(e){super(),we(this,e,Fn,Pn,s,{loaded:0})}}const{window:jn}=ye;function In(e){let t,n,o,r;function l(t){e[11].call(null,t)}let s={kmlOptions:e[3]};void 0!==e[2]&&(s.promise=e[2]);const i=new nn({props:s});return Z.push(()=>$e(i,"promise",l)),i.$on("change",e[7]),{c(){t=w("form"),be(i.$$.fragment),O(t,"class","form-inline svelte-kji15h"),z(t,"invisible","/help"===e[1])},m(n,l,s){k(n,t,l),ke(i,t,null),o=!0,s&&r(),r=j(t,"submit",I(e[10]))},p(e,o){const r={};8&o&&(r.kmlOptions=e[3]),!n&&4&o&&(n=!0,r.promise=e[2],ne(()=>n=!1)),i.$set(r),2&o&&z(t,"invisible","/help"===e[1])},i(e){o||(fe(i.$$.fragment,e),o=!0)},o(e){ge(i.$$.fragment,e),o=!1},d(e){e&&x(t),xe(i),r()}}}function On(e){let t,n,o,r={ctx:e,current:null,token:null,pending:Mn,then:Sn,catch:_n,value:14,error:15,blocks:[,,,]};return he(n=e[2],r),{c(){t=L(),r.block.c()},m(e,n){k(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,4&o&&n!==(n=e[2])&&he(n,r));else{const t=e.slice();t[14]=r.resolved,r.block.p(t,o)}},i(e){o||(fe(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ge(r.blocks[e])}o=!1},d(e){e&&x(t),r.block.d(e),r.token=null,r=null}}}function _n(t){let n,o,r,l=t[15].message+"";return{c(){n=w("p"),o=P("😱: "),r=P(l),z(n,"d-none","/map"!==t[1])},m(e,t){k(e,n,t),b(n,o),b(n,r)},p(e,t){4&t&&l!==(l=e[15].message+"")&&S(r,l),2&t&&z(n,"d-none","/map"!==e[1])},i:e,o:e,d(e){e&&x(n)}}}function Sn(e){let t;const n=new ln({props:{hidden:"/map"!==e[1],$$slots:{default:[Tn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};2&t&&(o.hidden="/map"!==e[1]),65550&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Tn(e){let t,n;const o=new Ut({props:{kmlOptions:e[3],ofp:e[14],route:e[1]}}),r=new bt({props:{ofp:e[14]}});return r.$on("save",e[5]),{c(){be(o.$$.fragment),t=F(),be(r.$$.fragment)},m(e,l){ke(o,e,l),k(e,t,l),ke(r,e,l),n=!0},p(e,t){const n={};8&t&&(n.kmlOptions=e[3]),4&t&&(n.ofp=e[14]),2&t&&(n.route=e[1]),o.$set(n);const l={};4&t&&(l.ofp=e[14]),r.$set(l)},i(e){n||(fe(o.$$.fragment,e),fe(r.$$.fragment,e),n=!0)},o(e){ge(o.$$.fragment,e),ge(r.$$.fragment,e),n=!1},d(e){xe(o,e),e&&x(t),xe(r,e)}}}function Mn(e){let t;const n=new ln({props:{hidden:"/map"!==e[1],$$slots:{default:[Rn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};2&t&&(o.hidden="/map"!==e[1]),65536&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Rn(e){let t;return{c(){t=w("div"),t.textContent="traitement en cours...",M(t,"margin","auto")},m(e,n){k(e,t,n)},d(e){e&&x(t)}}}function Dn(e){let t;const n=new ln({props:{$$slots:{default:[An]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};65536&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function zn(e){let t;const n=new ln({props:{$$slots:{default:[Nn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};65536&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function En(e){let t,n,o,r={ctx:e,current:null,token:null,pending:Kn,then:Gn,catch:Wn,value:14,error:15,blocks:[,,,]};return he(n=e[2],r),{c(){t=L(),r.block.c()},m(e,n){k(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,4&o&&n!==(n=e[2])&&he(n,r));else{const t=e.slice();t[14]=r.resolved,r.block.p(t,o)}},i(e){o||(fe(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ge(r.blocks[e])}o=!1},d(e){e&&x(t),r.block.d(e),r.token=null,r=null}}}function An(e){let t;const n=new yn({});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Nn(e){let t;const n=new jt({});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Wn(t){let n,o,r,l=t[15].message+"";return{c(){n=w("p"),o=P("😱: "),r=P(l)},m(e,t){k(e,n,t),b(n,o),b(n,r)},p(e,t){4&t&&l!==(l=e[15].message+"")&&S(r,l)},i:e,o:e,d(e){e&&x(n)}}}function Gn(e){let t,n,o,r;const l=[qn,Un],s=[];function i(e,t){return"/gramet"===e[1]?0:"/route"===e[1]?1:-1}return~(t=i(e))&&(n=s[t]=l[t](e)),{c(){n&&n.c(),o=L()},m(e,n){~t&&s[t].m(e,n),k(e,o,n),r=!0},p(e,r){let a=t;t=i(e),t===a?~t&&s[t].p(e,r):(n&&(pe(),ge(s[a],1,1,()=>{s[a]=null}),me()),~t?(n=s[t],n||(n=s[t]=l[t](e),n.c()),fe(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(fe(n),r=!0)},o(e){ge(n),r=!1},d(e){~t&&s[t].d(e),e&&x(o)}}}function Un(e){let t;const n=new ln({props:{$$slots:{default:[Hn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};65540&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function qn(e){let t;const n=new ln({props:{$$slots:{default:[Bn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};65540&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Hn(e){let t;const n=new De({props:{ofp:e[14]}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};4&t&&(o.ofp=e[14]),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Bn(e){let t;const n=new Ft({props:{ofp:e[14]}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};4&t&&(o.ofp=e[14]),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Kn(e){let t;const n=new ln({props:{$$slots:{default:[Jn]},$$scope:{ctx:e}}});return{c(){be(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};65536&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(fe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){xe(n,e)}}}function Jn(e){let t;return{c(){t=w("div"),t.textContent="traitement en cours...",M(t,"margin","auto")},m(e,n){k(e,t,n)},d(e){e&&x(t)}}}function Zn(e){let t,n,o;function r(t){e[12].call(null,t)}function l(t){e[13].call(null,t)}let s={};void 0!==e[3]&&(s.kmlOptions=e[3]),void 0!==e[0]&&(s.sidebar=e[0]);const i=new it({props:s});return Z.push(()=>$e(i,"kmlOptions",r)),Z.push(()=>$e(i,"sidebar",l)),i.$on("change",e[6]),i.$on("save",e[5]),{c(){be(i.$$.fragment)},m(e,t){ke(i,e,t),o=!0},p(e,o){const r={};!t&&8&o&&(t=!0,r.kmlOptions=e[3],ne(()=>t=!1)),!n&&1&o&&(n=!0,r.sidebar=e[0],ne(()=>n=!1)),i.$set(r)},i(e){o||(fe(i.$$.fragment,e),o=!0)},o(e){ge(i.$$.fragment,e),o=!1},d(e){xe(i,e)}}}function Vn(e){let t,n,o,r,l,s,i,a,c,u,d;const p=new Zt({props:{promise:e[2],route:e[1],$$slots:{default:[In]},$$scope:{ctx:e}}}),m=new Ln({props:{loaded:!!e[2]}});let f=e[2]&&On(e);const g=[En,zn,Dn],v=[];function h(e,t){return"/gramet"===e[1]||"/route"===e[1]?0:"/"===e[1]?1:"/help"===e[1]?2:-1}~(s=h(e))&&(i=v[s]=g[s](e));let y="/map"===e[1]&&Zn(e);return{c(){t=w("main"),n=w("div"),be(p.$$.fragment),o=F(),be(m.$$.fragment),r=F(),f&&f.c(),l=F(),i&&i.c(),a=F(),y&&y.c(),O(n,"class","content svelte-kji15h"),O(t,"class",c="container "+(e[1].substr(1)||"home")+" svelte-kji15h")},m(i,c,g){k(i,t,c),b(t,n),ke(p,n,null),b(n,o),ke(m,n,null),b(n,r),f&&f.m(n,null),b(n,l),~s&&v[s].m(n,null),b(t,a),y&&y.m(t,null),u=!0,g&&d(),d=j(jn,"hashchange",e[4])},p(e,[o]){const r={};4&o&&(r.promise=e[2]),2&o&&(r.route=e[1]),65550&o&&(r.$$scope={dirty:o,ctx:e}),p.$set(r);const a={};4&o&&(a.loaded=!!e[2]),m.$set(a),e[2]?f?(f.p(e,o),4&o&&fe(f,1)):(f=On(e),f.c(),fe(f,1),f.m(n,l)):f&&(pe(),ge(f,1,1,()=>{f=null}),me());let d=s;s=h(e),s===d?~s&&v[s].p(e,o):(i&&(pe(),ge(v[d],1,1,()=>{v[d]=null}),me()),~s?(i=v[s],i||(i=v[s]=g[s](e),i.c()),fe(i,1),i.m(n,null)):i=null),"/map"===e[1]?y?(y.p(e,o),2&o&&fe(y,1)):(y=Zn(e),y.c(),fe(y,1),y.m(t,null)):y&&(pe(),ge(y,1,1,()=>{y=null}),me()),(!u||2&o&&c!==(c="container "+(e[1].substr(1)||"home")+" svelte-kji15h"))&&O(t,"class",c)},i(e){u||(fe(p.$$.fragment,e),fe(m.$$.fragment,e),fe(f),fe(i),fe(y),u=!0)},o(e){ge(p.$$.fragment,e),ge(m.$$.fragment,e),ge(f),ge(i),ge(y),u=!1},d(e){e&&x(t),xe(p),xe(m),f&&f.d(),~s&&v[s].d(),y&&y.d(),d()}}}function Xn(e,t,n){let o;i(e,an,e=>n(9,o=e));let r=!1,l="/",s=window.location.href,a=void 0;(e=>{const t={},n={};if(e.length>1){(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}))}for(let[e,o]of Object.entries(t))if(e in ze){let t=void 0;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(We)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||nt.setItem(tt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&nt.setItem(tt.shortcut,o));nt.setItem(tt.optionsKML,n)})(window.location.search);let c=(e=>{const t={};for(let[n,o]of Object.entries(e))n in ze&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(We)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...ze,...t}})(nt.getItem(tt.optionsKML)||{});const u=e=>{n(1,l=window.location.hash.substr(1)||"/"),a||"/map"!==l&&"/gramet"!==l&&"/route"!==l||n(1,l="/"),"/map"===l&&r&&n(0,r=!1)};u();const d=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(tt)){let r=nt.getItem(o);if(n===tt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter(t=>e[t]!==ze[t]))t[n]=e[n];r=t}if(null!==r)if(n===tt.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(c);let n=Object.entries(t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");s=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+l,history.replaceState(t,"Mon Convertisseur d'OFP",s)};d();return[r,l,a,c,u,d,e=>{window.lidoMap&&Nt(window.lidoMap,e.detail.name,e.detail.value),function(e,t){const n=Ae(),o=Le(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),d()},()=>{r&&n(0,r=!1),o&&p(an,o=!1),window.serviceWorker.update().catch(e=>{})},s,o,function(t){K(e,t)},function(e){a=e,n(2,a)},function(e){c=e,n(3,c)},function(e){r=e,n(0,r)}]}return new class extends Ce{constructor(e){super(),we(this,e,Xn,Vn,s,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
