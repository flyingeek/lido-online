var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function i(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o,r,s,l){const a=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(a){const r=c(t,n,o,l);e.p(r,a)}}function p(e){return null==e?"":e}function d(e,t,n=t){return e.set(n),t}function f(t){return t&&s(t.destroy)?t.destroy:e}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),v=m?e=>requestAnimationFrame(e):e;const h=new Set;function y(e){h.forEach(t=>{t.c(e)||(h.delete(t),t.f())}),0!==h.size&&v(y)}function $(e){let t;return 0===h.size&&v(y),{promise:new Promise(n=>{h.add(t={c:e,f:n})}),abort(){h.delete(t)}}}function b(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function F(){return L(" ")}function _(){return L("")}function j(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function O(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function S(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function I(e,t){e.value=null==t?"":t}function A(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function q(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function z(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function R(e,t,n){e.classList[n?"add":"remove"](t)}function D(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const E=new Set;let N,W=0;function G(e,t,n,o,r,s,l,a=0){const i=16.666/o;let c="{\n";for(let e=0;e<=1;e+=i){const o=t+(n-t)*s(e);c+=100*e+`%{${l(o,1-o)}}\n`}const u=c+`100% {${l(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=e.ownerDocument;E.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(C("style")).sheet),m=d.__svelte_rules||(d.__svelte_rules={});m[p]||(m[p]=!0,f.insertRule(`@keyframes ${p} ${u}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?g+", ":""}${p} ${o}ms linear ${r}ms 1 both`,W+=1,p}function U(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),W-=r,W||v(()=>{W||(E.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),E.clear())}))}function H(e){N=e}function B(){if(!N)throw new Error("Function called outside component initialization");return N}function K(){const e=B();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=D(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}function Z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const J=[],X=[],V=[],Y=[],Q=Promise.resolve();let ee=!1;function te(){ee||(ee=!0,Q.then(le))}function ne(e){V.push(e)}function oe(e){Y.push(e)}let re=!1;const se=new Set;function le(){if(!re){re=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];H(t),ae(t.$$)}for(H(null),J.length=0;X.length;)X.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];se.has(t)||(se.add(t),t())}V.length=0}while(J.length);for(;Y.length;)Y.pop()();ee=!1,re=!1,se.clear()}}function ae(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let ie;function ce(){return ie||(ie=Promise.resolve(),ie.then(()=>{ie=null})),ie}function ue(e,t,n){e.dispatchEvent(D(`${t?"intro":"outro"}${n}`))}const pe=new Set;let de;function fe(){de={r:0,c:[],p:de}}function me(){de.r||r(de.c),de=de.p}function ge(e,t){e&&e.i&&(pe.delete(e),e.i(t))}function ve(e,t,n,o){if(e&&e.o){if(pe.has(e))return;pe.add(e),de.c.push(()=>{pe.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const he={duration:0};function ye(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let l=t.ctx;void 0!==r&&(l=l.slice(),l[r]=s);const a=e&&(t.current=e)(l);let i=!1;t.block&&(t.blocks?t.blocks.forEach((e,n)=>{n!==o&&e&&(fe(),ve(e,1,1,()=>{t.blocks[n]=null}),me())}):t.block.d(1),a.c(),ge(a,1),a.m(t.mount(),t.anchor),i=!0),t.block=a,t.blocks&&(t.blocks[o]=a),i&&le()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=B();if(e.then(e=>{H(n),o(t.then,1,t.value,e),H(null)},e=>{if(H(n),o(t.catch,2,t.error,e),H(null),!t.hasCatch)throw e}),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const $e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function be(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function xe(e){e&&e.c()}function ke(e,t,o){const{fragment:l,on_mount:a,on_destroy:i,after_update:c}=e.$$;l&&l.m(t,o),ne(()=>{const t=a.map(n).filter(s);i?i.push(...t):r(t),e.$$.on_mount=[]}),c.forEach(ne)}function we(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(t,n,s,l,a,i,c=[-1]){const u=N;H(t);const p=n.props||{},d=t.$$={fragment:null,ctx:null,props:i,update:e,not_equal:a,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c,skip_bound:!1};let f=!1;if(d.ctx=s?s(t,p,(e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),f&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),te(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n}):[],d.update(),f=!0,r(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(k)}else d.fragment&&d.fragment.c();n.intro&&ge(t.$$.fragment),ke(t,n.target,n.anchor),le()}H(u)}class Pe{$destroy(){we(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Le{constructor(){this.promise=new Promise((e,t)=>{this.reject=t,this.resolve=e})}}const Fe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,_e=matchMedia("(hover: hover)").matches;function je(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function Me(e,t,n){return e<=t?t:e>=n?n:e}function Oe(e,t,n){return!(e<t)&&!(e>n)}function Te(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Se(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ie(e,{delay:n=0,duration:o=400,easing:r=t}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function Ae(e){let t;return{c(){t=C("textarea"),t.value=e[0],O(t,"class","svelte-12a0ij3")},m(n,o){x(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&k(t),e[6](null)}}}function qe(t){let n,o,r;return{c(){n=C("a"),n.textContent="copier la route",O(n,"role","button"),O(n,"class","btn btn-primary svelte-12a0ij3"),O(n,"href","lhs-mpilot://")},m(e,s){x(e,n,s),o||(r=j(n,"click",t[4]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function ze(t){let n,o,r,s,l;return{c(){n=C("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=C("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',O(n,"role","button"),O(n,"class","btn btn-primary svelte-12a0ij3"),O(n,"href","lhs-mpilot://"),O(r,"class","card-text")},m(e,a){x(e,n,a),x(e,o,a),x(e,r,a),s||(l=j(n,"click",t[4]),s=!0)},p:e,d(e){e&&k(n),e&&k(o),e&&k(r),s=!1,l()}}}function Re(n){let o,l,a;return{c(){o=C("span"),o.textContent="copié!",O(o,"class","svelte-12a0ij3")},m(e,t){x(e,o,t),a=!0},i(e){a||(l&&l.end(1),a=!0)},o(n){l=function(n,o,l){let a,i=o(n,l),c=!0;const u=de;function p(){const{delay:o=0,duration:s=300,easing:l=t,tick:p=e,css:d}=i||he;d&&(a=G(n,1,0,s,o,l,d));const f=g()+o,m=f+s;ne(()=>ue(n,!1,"start")),$(e=>{if(c){if(e>=m)return p(0,1),ue(n,!1,"end"),--u.r||r(u.c),!1;if(e>=f){const t=l((e-f)/s);p(1-t,t)}}return c})}return u.r+=1,s(i)?ce().then(()=>{i=i(),p()}):p(),{end(e){e&&i.tick&&i.tick(1,0),c&&(a&&U(n,a),c=!1)}}}(o,Ie,{}),a=!1},d(e){e&&k(o),e&&l&&l.end()}}}function De(e){let t,n,o,r,s,l,a,i,c,u,p,d,f=null!=e[0]&&Ae(e);let m=(Fe?ze:qe)(e),g=e[2]&&Re();return{c(){f&&f.c(),t=F(),n=C("div"),o=C("div"),r=C("h5"),r.textContent="Route Lido",s=F(),l=C("p"),l.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",a=F(),m.c(),i=F(),c=C("div"),u=L(e[3]),p=F(),g&&g.c(),O(r,"class","card-title"),O(l,"class","card-text"),O(c,"class","text-monospace svelte-12a0ij3"),O(o,"class","card-body"),O(n,"class","card mb-3 svelte-12a0ij3")},m(e,v){f&&f.m(e,v),x(e,t,v),x(e,n,v),b(n,o),b(o,r),b(o,s),b(o,l),b(o,a),m.m(o,null),b(o,i),b(o,c),b(c,u),b(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?f?f.p(e,n):(f=Ae(e),f.c(),f.m(t.parentNode,t)):f&&(f.d(1),f=null),m.p(e,n),e[2]?g?4&n&&ge(g,1):(g=Re(),g.c(),ge(g,1),g.m(c,null)):g&&(fe(),ve(g,1,1,()=>{g=null}),me())},i(e){d||(ge(g),d=!0)},o(e){ve(g),d=!1},d(e){f&&f.d(e),e&&k(t),e&&k(n),m.d(),g&&g.d()}}}let Ee=!1;try{navigator.permissions.query({name:"clipboard-write"}).then(e=>{"granted"!=e.state&&"prompt"!=e.state||(Ee=!0)})}catch(e){}function Ne(e,t,n){let o,{ofp:r}=t,s=null;const l=r?r.lidoRoute().join(" "):"";let a=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,a,l,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Ee)navigator.clipboard.writeText(e).then(()=>t=!0,()=>t=!1);else{n(0,s=e),await(te(),Q),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(l);Fe||(n(2,a=t),setTimeout((function(){n(2,a=!1)}),3e3),e.preventDefault())},r,function(e){X[e?"unshift":"push"](()=>{o=e,n(1,o)})}]}class We extends Pe{constructor(e){super(),Ce(this,e,Ne,De,l,{ofp:5})}}function Ge(t){let n,o,l,a,i,c,u,p,d,m,g,v,h,y,$,w,P,_,M;return{c(){n=C("kmlcolor"),o=C("div"),l=C("label"),a=L("Couleur"),i=F(),c=C("picker"),u=C("label"),p=C("input"),g=F(),v=C("input"),y=F(),$=C("input"),O(l,"for",t[1]),O(l,"class","input-group-text svelte-1hvk4hi"),O(o,"class","input-group-prepend"),O(p,"type","color"),O(p,"class","svelte-1hvk4hi"),O(u,"style",d=Ze(t[2])),O(u,"class","svelte-1hvk4hi"),O(v,"type","range"),O(v,"min","30"),O(v,"max","255"),O(v,"class","svelte-1hvk4hi"),O(c,"class","form-control svelte-1hvk4hi"),O(c,"style",h=Ke(t[2][0])),O($,"name",t[1]),O($,"class","form-control text-monospace svelte-1hvk4hi"),O($,"style",w=Je(t[0])),O($,"type","text"),O($,"maxlength","8"),O(n,"class","input-group svelte-1hvk4hi")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,a),b(n,i),b(n,c),b(c,u),b(u,p),I(p,t[2][0]),b(c,g),b(c,v),I(v,t[2][1]),b(n,y),b(n,$),I($,t[0]),_||(M=[j(p,"input",t[5]),f(m=t[4].call(null,u,t[0])),j(v,"change",t[6]),j(v,"input",t[6]),f(P=t[3].call(null,$,t[2])),j($,"input",t[7])],_=!0)},p(e,[t]){2&t&&O(l,"for",e[1]),4&t&&I(p,e[2][0]),4&t&&d!==(d=Ze(e[2]))&&O(u,"style",d),m&&s(m.update)&&1&t&&m.update.call(null,e[0]),4&t&&I(v,e[2][1]),4&t&&h!==(h=Ke(e[2][0]))&&O(c,"style",h),2&t&&O($,"name",e[1]),1&t&&w!==(w=Je(e[0]))&&O($,"style",w),P&&s(P.update)&&4&t&&P.update.call(null,e[2]),1&t&&$.value!==e[0]&&I($,e[0])},i:e,o:e,d(e){e&&k(n),_=!1,r(M)}}}const Ue=/^[A-F0-9]{8}$/i,He=e=>{let[t,n]=Be(e);return[t,n/255]},Be=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},Ke=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map(e=>parseInt(e,16));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Ze=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Je=e=>e.match(Ue)?"":"border-color: #F00;";function Xe(e,t,n){const o=K();let r,{kmlColor:s="FF0000FF"}=t,{name:l}=t;try{r=Be(s)}catch(e){r=["#FF0000",255]}const a=function(e,t,n){let o;return function(){const r=this,s=arguments,l=function(){o=null,n||e.apply(r,s)},a=n&&!o;clearTimeout(o),o=setTimeout(l,t),a&&e.apply(r,s)}}(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,l=e.name)},[s,l,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),a("change",{name:l,value:s})}}},function(e){return{update(e){if(e.match(Ue)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),a("change",{name:l,value:e.toUpperCase()})}}}},function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?null:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class Ve extends Pe{constructor(e){super(),Ce(this,e,Xe,Ge,l,{kmlColor:0,name:1})}}const Ye={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,etopsDisplay:!0,etopsColor:"FF0324FC"};function Qe(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const et=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Qe(window.kmlGen,Ye)),window.kmlGen);function tt(e,t){let n={...Ye,...t};const o=et();Qe(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,l=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),a=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),i=new editolido.Route([l.points[0],l.points[l.points.length-1]]).split(300,{name:"Ortho "+s});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",i),o.addLine("rmain",l),o.addPoints("rmain",l,{excluded:c}),o.addLine("ralt",a),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",a)}const nt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),ot=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function rt(t){let n,o,s,l,a,i,c,u,p,d;return{c(){n=C("div"),o=C("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',s=F(),l=C("input"),a=F(),i=C("div"),c=C("a"),u=L("Lancer"),O(o,"class","input-group-prepend"),O(l,"class","form-control svelte-1ecyaux"),O(l,"placeholder","Nom du raccourci"),O(l,"type","text"),O(c,"class","btn btn-outline-secondary svelte-1ecyaux"),O(c,"href",t[1]),R(c,"disabled",!(t[0].trim()&&Fe)),O(i,"class","input-group-append"),O(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,l),I(l,t[0]),b(n,a),b(n,i),b(i,c),b(c,u),p||(d=[j(l,"input",t[5]),j(l,"change",t[3]),j(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&l.value!==e[0]&&I(l,e[0]),2&t&&O(c,"href",e[1]),1&t&&R(c,"disabled",!(e[0].trim()&&Fe))},i:e,o:e,d(e){e&&k(n),p=!1,r(d)}}}function st(e,t,n){const o=K(),r=nt.shortcut;let s,l=ot.getItem(r)||"OFP2MAP",{ofp:a}=t;const i=a?a.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,a=e.ofp)},[l,s,function(e){const t=l.trim();if(t&&Fe){const e=et(),o={lidoRoute:i,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:a.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=l.trim();"OFP2MAP"===e?ot.removeItem(r):ot.setItem(r,e),o("save",[r,e])},a,function(){l=this.value,n(0,l)}]}class lt extends Pe{constructor(e){super(),Ce(this,e,st,rt,l,{ofp:4})}}const at=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function s(e,t){return e.getElementsByTagName(t)}function l(e,t){return e.getAttribute(t)}function a(e,t){return parseFloat(l(e,t))}function i(e,t){var n=s(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function p(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=i(e,t[o]))&&(r[t[o]]=u(n));return r}function d(e,t){for(var n in t)e[n]=t[n]}function f(e){return c(e.replace(t,"").split(","))}function m(e){for(var t=e.replace(n,"").split(o),r=[],s=0;s<t.length;s++)r.push(f(t[s]));return r}function g(e){var t,n=[a(e,"lon"),a(e,"lat")],o=i(e,"ele"),r=i(e,"gpxtpx:hr")||i(e,"hr"),s=i(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:s?u(s):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},a={},p=["Polygon","LineString","Point","Track","gx:Track"],d=s(e,"Placemark"),g=s(e,"Style"),h=s(e,"StyleMap"),y=0;y<g.length;y++){var $=r(v(g[y])).toString(16);n["#"+l(g[y],"id")]=$,o[$]=g[y]}for(var b=0;b<h.length;b++){n["#"+l(h[b],"id")]=r(v(h[b])).toString(16);for(var x=s(h[b],"Pair"),k={},w=0;w<x.length;w++)k[u(i(x[w],"key"))]=u(i(x[w],"styleUrl"));a["#"+l(h[b],"id")]=k}for(var C=0;C<d.length;C++)t.features=t.features.concat(F(d[C]));function P(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function L(e){var t=s(e,"coord"),n=[],o=[];0===t.length&&(t=s(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var l=s(e,"when"),a=0;a<l.length;a++)o.push(u(l[a]));return{coords:n,times:o}}function F(e){var t,r=function e(t){var n,o,r,l,a,c=[],d=[];if(i(t,"MultiGeometry"))return e(i(t,"MultiGeometry"));if(i(t,"MultiTrack"))return e(i(t,"MultiTrack"));if(i(t,"gx:MultiTrack"))return e(i(t,"gx:MultiTrack"));for(r=0;r<p.length;r++)if(o=s(t,p[r]))for(l=0;l<o.length;l++)if(n=o[l],"Point"===p[r])c.push({type:"Point",coordinates:f(u(i(n,"coordinates")))});else if("LineString"===p[r])c.push({type:"LineString",coordinates:m(u(i(n,"coordinates")))});else if("Polygon"===p[r]){var g=s(n,"LinearRing"),v=[];for(a=0;a<g.length;a++)v.push(m(u(i(g[a],"coordinates"))));c.push({type:"Polygon",coordinates:v})}else if("Track"===p[r]||"gx:Track"===p[r]){var h=L(n);c.push({type:"LineString",coordinates:h.coords}),h.times.length&&d.push(h.times)}return{geoms:c,coordTimes:d}}(e),c={},d=u(i(e,"name")),g=u(i(e,"address")),v=u(i(e,"styleUrl")),h=u(i(e,"description")),y=i(e,"TimeSpan"),$=i(e,"TimeStamp"),b=i(e,"ExtendedData"),x=i(e,"LineStyle"),k=i(e,"PolyStyle"),w=i(e,"visibility");if(!r.geoms.length)return[];if(d&&(c.name=d),g&&(c.address=g),v){"#"!==v[0]&&(v="#"+v),c.styleUrl=v,n[v]&&(c.styleHash=n[v]),a[v]&&(c.styleMapHash=a[v],c.styleHash=n[a[v].normal]);var C=o[c.styleHash];if(C){x||(x=i(C,"LineStyle")),k||(k=i(C,"PolyStyle"));var F=i(C,"IconStyle");if(F){var _=i(F,"Icon");if(_){var j=u(i(_,"href"));j&&(c.icon=j)}}}}if(h&&(c.description=h),y){var M=u(i(y,"begin")),O=u(i(y,"end"));c.timespan={begin:M,end:O}}if($&&(c.timestamp=u(i($,"when"))),x){var T=P(u(i(x,"color"))),S=T[0],I=T[1],A=parseFloat(u(i(x,"width")));S&&(c.stroke=S),isNaN(I)||(c["stroke-opacity"]=I),isNaN(A)||(c["stroke-width"]=A)}if(k){var q=P(u(i(k,"color"))),z=q[0],R=q[1],D=u(i(k,"fill")),E=u(i(k,"outline"));z&&(c.fill=z),isNaN(R)||(c["fill-opacity"]=R),D&&(c["fill-opacity"]="1"===D?c["fill-opacity"]||1:0),E&&(c["stroke-opacity"]="1"===E?c["stroke-opacity"]||1:0)}if(b){var N=s(b,"Data"),W=s(b,"SimpleData");for(t=0;t<N.length;t++)c[N[t].getAttribute("name")]=u(i(N[t],"value"));for(t=0;t<W.length;t++)c[W[t].getAttribute("name")]=u(W[t])}w&&(c.visibility=u(w)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var G={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return l(e,"id")&&(G.id=l(e,"id")),[G]}return t},gpx:function(e){var t,n,o=s(e,"trk"),r=s(e,"rte"),a=s(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=v(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=h(r[t]))&&c.features.push(n);for(t=0;t<a.length;t++)c.features.push(y(a[t]));function f(e,t){for(var n=0;n<t;n++)e.push(null);return e}function m(e,t){var n=s(e,t),o=[],r=[],l=[],a=n.length;if(a<2)return{};for(var i=0;i<a;i++){var c=g(n[i]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||l.length)&&(l.length||f(l,i),l.push(c.heartRate||null))}return{line:o,times:r,heartRates:l}}function v(e){for(var t,n=s(e,"trkseg"),o=[],r=[],l=[],a=0;a<n.length;a++)if((t=m(n[a],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),l.length||t.heartRates&&t.heartRates.length)){if(!l.length)for(var c=0;c<a;c++)l.push(f([],o[c].length));t.heartRates&&t.heartRates.length?l.push(t.heartRates):l.push(f([],t.line.length||0))}if(0!==o.length){var u=b(e);return d(u,$(i(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),l.length&&(u.heartRates=1===o.length?l[0]:l),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function h(e){var t=m(e,"rtept");if(t.line){var n=b(e);return d(n,$(i(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=b(e);return d(t,p(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function $(e){var t={};if(e){var n=i(e,"line");if(n){var o=u(i(n,"color")),r=parseFloat(u(i(n,"opacity"))),s=parseFloat(u(i(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(s)||(t["stroke-width"]=96*s/25.4)}}return t}function b(e){var t=p(e,["name","cmt","desc","type","time","keywords"]),n=s(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)d(o={href:l(n[r],"href")},p(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function it(t){let n,o,s,l,a,i,c,u,p,d,f,m,g,v,h,y,$,w,P,_,M=pt[0]+"",T=pt[1]+"",I=pt[2]+"";return{c(){n=C("div"),o=C("select"),s=C("option"),l=L(M),c=C("option"),u=L(T),f=C("option"),m=L(I),h=F(),y=C("div"),$=C("a"),w=L(t[0]),s.selected=a=0===t[1],s.__value=i=0,s.value=s.__value,c.selected=p=1===t[1],c.__value=d=1,c.value=c.__value,f.selected=g=2===t[1],f.__value=v=2,f.value=f.__value,O(o,"class","custom-select svelte-19hokx5"),O(o,"aria-label","Example select with button addon"),void 0===t[1]&&ne(()=>t[6].call(o)),O($,"class","btn btn-success"),O($,"download",t[3]),O($,"href",t[2]),O($,"target",ct),O(y,"class","input-group-append"),O(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(o,s),b(s,l),b(o,c),b(c,u),b(o,f),b(f,m),q(o,t[1]),b(n,h),b(n,y),b(y,$),b($,w),P||(_=[j(o,"change",t[6]),j(o,"change",t[5]),j($,"click",t[4])],P=!0)},p(e,[t]){2&t&&a!==(a=0===e[1])&&(s.selected=a),2&t&&p!==(p=1===e[1])&&(c.selected=p),2&t&&g!==(g=2===e[1])&&(f.selected=g),2&t&&q(o,e[1]),1&t&&S(w,e[0]),8&t&&O($,"download",e[3]),4&t&&O($,"href",e[2])},i:e,o:e,d(e){e&&k(n),P=!1,r(_)}}}const ct=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,ut=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},pt=["KML Mapsme","KML Avenza","GeoJson"];function dt(e,t,n){const o=K();let{label:r}=t;const s=nt.downloadType;let l=ot.getItem(s)||1;"string"==typeof l&&(l=parseInt(l,10));let a="",i="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,l,a,i,function(e){const t=et(),o=["_mapsme.kml","_avenza.kml",".geojson"][l];let r=t.name;if(r?(r=r.trim(),n(3,i=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,i="editolido"+o),0===l)n(2,a=ut(t.render()));else if(1===l)n(2,a=ut(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==l)return e.preventDefault(),!1;n(2,a=ut(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return at.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===l?ot.removeItem(s):ot.setItem(s,l),o("save",[s,l])},function(){l=z(this),n(1,l)}]}class ft extends Pe{constructor(e){super(),Ce(this,e,dt,it,l,{label:0})}}function mt(e){let t,n,o,r,s,l,a,i,c,u,p,d,f,m,g;return a=new ft({props:{label:"Télécharger"}}),a.$on("save",e[1]),d=new lt({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=C("div"),n=C("div"),o=C("h5"),o.textContent="Export",r=F(),s=C("div"),l=C("div"),xe(a.$$.fragment),i=F(),c=C("small"),c.textContent="Le fichier est généré en fonction des options choisies sur la carte.",u=F(),p=C("div"),xe(d.$$.fragment),f=F(),m=C("small"),m.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',O(o,"class","card-title"),O(c,"class","text-muted"),O(l,"class","col-12 col-sm-6 col-md-6"),O(m,"class","text-muted"),O(p,"class","col-12 col-sm-6 col-md-6"),O(s,"class","row"),O(n,"class","card-body"),O(t,"class","card mb-3 svelte-17snbjk")},m(e,v){x(e,t,v),b(t,n),b(n,o),b(n,r),b(n,s),b(s,l),ke(a,l,null),b(l,i),b(l,c),b(s,u),b(s,p),ke(d,p,null),b(p,f),b(p,m),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||(ge(a.$$.fragment,e),ge(d.$$.fragment,e),g=!0)},o(e){ve(a.$$.fragment,e),ve(d.$$.fragment,e),g=!1},d(e){e&&k(t),we(a),we(d)}}}function gt(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){Z(e,t)},function(t){Z(e,t)}]}class vt extends Pe{constructor(e){super(),Ce(this,e,gt,mt,l,{ofp:0})}}function ht(e){let t;return{c(){t=C("div"),t.innerHTML='<span class="sr-only">Loading...</span>',O(t,"class","spinner-border text-warning"),O(t,"role","status")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function yt(e){let t,n,o,r,s,l,a,i,c,u,p;return{c(){t=C("div"),n=C("p"),o=L("😱: Erreur de récupération du Gramet, "),r=C("a"),r.textContent="essayez à nouveau",s=L(" ou allez sur "),l=C("a"),a=L("ogimet"),c=L("."),O(r,"href","."),O(l,"href",i=e[0].ogimetData.url),O(l,"target","_blank"),O(n,"class","svelte-i1m2fr"),O(t,"class","error svelte-i1m2fr")},m(i,d){x(i,t,d),b(t,n),b(n,o),b(n,r),b(n,s),b(n,l),b(l,a),b(n,c),u||(p=j(r,"click",M(e[4])),u=!0)},p(e,t){1&t&&i!==(i=e[0].ogimetData.url)&&O(l,"href",i)},d(e){e&&k(t),u=!1,p()}}}function $t(e){let t,n,o,s;return{c(){t=C("img"),O(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&O(t,"src",n),O(t,"alt","gramet demo"),O(t,"class","img-fluid svelte-i1m2fr")},m(n,r){x(n,t,r),o||(s=[j(t,"error",e[2]),j(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&O(t,"src",n)},d(e){e&&k(t),o=!1,r(s)}}}function bt(t){let n,o,r,s,l,a,i,c,u,p,d,f,m,g,v,h,y,$,w,P,_,j="loading"===t[1]&&ht();function M(e,t){return"error"!==e[1]?$t:yt}let T=M(t),S=T(t);return{c(){n=C("div"),o=C("h1"),o.innerHTML='Le GRAMET est un météogramme représentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et à l&#39;heure de passage estimée, une coupe verticale de la météo prévue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interprétation</a>',r=F(),s=C("div"),j&&j.c(),l=F(),S.c(),a=F(),i=C("div"),c=C("div"),u=C("div"),p=C("div"),d=C("div"),d.textContent="Route Ogimet",f=F(),m=C("div"),g=C("p"),v=L("Le GRAMET est réalisé par "),h=C("a"),y=L("www.ogimet.com"),w=L(" à partir\n    d'une route calculée. Il est possible d'afficher la route sur la carte. Celà est\n    particulièrement utile lors des vols océaniques car il n'y a aucune station en mer."),P=F(),_=C("div"),_.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Après avoir sélectionner les stations météo proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectué pour réduire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',O(o,"class","svelte-i1m2fr"),O(s,"class","text-center svelte-i1m2fr"),O(d,"class","card-header svelte-i1m2fr"),O(h,"class","text-warning"),O(h,"href",$=t[0].ogimetData.url),O(h,"target","_blank"),O(g,"class","card-text"),O(m,"class","card-body"),O(p,"class","card ogimet svelte-i1m2fr"),O(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),O(_,"class","col-12 col-sm-6 col-md-6 col-xl-6"),O(c,"class","card-deck"),O(i,"class","row")},m(e,t){x(e,n,t),b(n,o),b(n,r),b(n,s),j&&j.m(s,null),b(s,l),S.m(s,null),b(n,a),b(n,i),b(i,c),b(c,u),b(u,p),b(p,d),b(p,f),b(p,m),b(m,g),b(g,v),b(g,h),b(h,y),b(g,w),b(c,P),b(c,_)},p(e,[t]){"loading"===e[1]?j||(j=ht(),j.c(),j.m(s,l)):j&&(j.d(1),j=null),T===(T=M(e))&&S?S.p(e,t):(S.d(1),S=T(e),S&&(S.c(),S.m(s,null))),1&t&&$!==($=e[0].ogimetData.url)&&O(h,"href",$)},i:e,o:e,d(e){e&&k(n),j&&j.d(),S.d()}}}function xt(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class kt extends Pe{constructor(e){super(),Ce(this,e,xt,bt,l,{ofp:0})}}function wt(t){let n,o,r;return{c(){n=C("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-2y0613"/> en KML/GeoJSON',o=F(),r=C("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card avenza svelte-2y0613"><div class="card-header svelte-2y0613">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card mapsme svelte-2y0613"><div class="card-header svelte-2y0613">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le thème par défaut s&#39;accorde parfaitement avec les fichiers avions, également compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card ogimet svelte-2y0613"><div class="card-header svelte-2y0613">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card shortcuts svelte-2y0613"><div class="card-header svelte-2y0613">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Récupérez le KML, le Gramet, et une route Lido optimisée dans l&#39;app Raccourcis</p></div></div></div></div>',O(n,"class","text-center svelte-2y0613"),O(r,"class","row svelte-2y0613")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r)}}}class Ct extends Pe{constructor(e){super(),Ce(this,e,null,wt,l,{})}}function Pt(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Lt(e){let t,n,o,r,s=e[4].label+"";return{c(){t=C("option"),n=L(s),t.__value=o=e[6],t.value=t.__value,t.selected=r=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&r!==(r=e[6]===e[0])&&(t.selected=r)},d(e){e&&k(t)}}}function Ft(t){let n,o,l,a,i,c,u,p,d,f,m,g,v=_t,h=[];for(let e=0;e<v.length;e+=1)h[e]=Lt(Pt(t,v,e));return{c(){n=C("div"),o=C("div"),l=C("label"),a=L("Repère"),i=F(),c=C("span"),u=P("svg"),p=P("use"),d=F(),f=C("select");for(let e=0;e<h.length;e+=1)h[e].c();O(l,"class","input-group-text svelte-1j0ign2"),O(l,"for",t[1]),T(p,"xlink:href","#marker"),A(p,"stroke",0===t[0]?"#fff":"#000"),A(p,"fill",_t[t[0]].color),O(u,"class","svelte-1j0ign2"),O(c,"class","input-group-text svelte-1j0ign2"),O(o,"class","input-group-prepend"),O(f,"name",t[1]),O(f,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ne(()=>t[3].call(f)),O(n,"class","input-group svelte-1j0ign2")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,a),b(o,i),b(o,c),b(c,u),b(u,p),b(n,d),b(n,f);for(let e=0;e<h.length;e+=1)h[e].m(f,null);q(f,t[0]),m||(g=[j(f,"change",t[3]),j(f,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],m=!0)},p(e,[n]){if(t=e,2&n&&O(l,"for",t[1]),1&n&&A(p,"stroke",0===t[0]?"#fff":"#000"),1&n&&A(p,"fill",_t[t[0]].color),1&n){let e;for(v=_t,e=0;e<v.length;e+=1){const o=Pt(t,v,e);h[e]?h[e].p(o,n):(h[e]=Lt(o),h[e].c(),h[e].m(f,null))}for(;e<h.length;e+=1)h[e].d(1);h.length=v.length}2&n&&O(f,"name",t[1]),1&n&&q(f,t[0])},i:e,o:e,d(e){e&&k(n),w(h,e),m=!1,r(g)}}}const _t=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function jt(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=z(this),n(0,r)}]}class Mt extends Pe{constructor(e){super(),Ce(this,e,jt,Ft,l,{selected:0,name:1})}}function Ot(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Tt(e){let t,n,o,r,s=e[4].label+"";return{c(){t=C("option"),n=L(s),t.__value=o=e[6],t.value=t.__value,t.selected=r=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&r!==(r=e[6]===e[0])&&(t.selected=r)},d(e){e&&k(t)}}}function St(t){let n,o,l,a,i,c,u,p,d=It,f=[];for(let e=0;e<d.length;e+=1)f[e]=Tt(Ot(t,d,e));return{c(){n=C("div"),o=C("div"),l=C("label"),a=L("Couleur"),i=F(),c=C("select");for(let e=0;e<f.length;e+=1)f[e].c();O(l,"class","input-group-text svelte-90luj4"),O(l,"for",t[1]),O(o,"class","input-group-prepend"),O(c,"name",t[1]),O(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ne(()=>t[3].call(c)),O(n,"class","input-group svelte-90luj4")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,a),b(n,i),b(n,c);for(let e=0;e<f.length;e+=1)f[e].m(c,null);q(c,t[0]),u||(p=[j(c,"change",t[3]),j(c,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],u=!0)},p(e,[n]){if(t=e,2&n&&O(l,"for",t[1]),1&n){let e;for(d=It,e=0;e<d.length;e+=1){const o=Ot(t,d,e);f[e]?f[e].p(o,n):(f[e]=Tt(o),f[e].c(),f[e].m(c,null))}for(;e<f.length;e+=1)f[e].d(1);f.length=d.length}2&n&&O(c,"name",t[1]),1&n&&q(c,t[0])},i:e,o:e,d(e){e&&k(n),w(f,e),u=!1,r(p)}}}const It=[{label:"statuts"},{label:"vert/rouge"}];function At(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=z(this),n(0,r)}]}class qt extends Pe{constructor(e){super(),Ce(this,e,At,St,l,{selected:0,name:1})}}const zt=[];function Rt(t,n=e){let o;const r=[];function s(e){if(l(t,e)&&(t=e,o)){const e=!zt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),zt.push(n,t)}if(e){for(let e=0;e<zt.length;e+=2)zt[e][0](zt[e+1]);zt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(l,a=e){const i=[l,a];return r.push(i),1===r.length&&(o=n(s)||e),l(t),()=>{const e=r.indexOf(i);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const Dt=Rt(!1),Et=Rt(!1),Nt=Rt(navigator.onLine);function Wt(t){let n,o,r;return{c(){n=C("button"),n.textContent="Revenir aux valeurs par défaut",O(n,"class","btn btn-link btn-sm float-right"),O(n,"type","button")},m(e,s){x(e,n,s),o||(r=j(n,"click",t[7]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function Gt(e){let t,n,o,s,l,a,i,c,u,d,f,m,g,v,h,y,$,w,_,S,I,A,q,z,D,E,N,W,G,U,H,B,K,Z,J,X,V,Y,Q,ee,te,ne,oe,re,se,le,ae,ie,ce,ue,pe,de,fe,me,he,ye,$e,be,Ce,Pe,Le,Fe,_e,je,Me,Oe,Te,Se,Ie,Ae,qe,ze,Re,De,Ee,Ne,We,Ge,Ue,He,Be,Ke,Ze,Je,Xe,Ye,Qe,et,tt,nt,ot,rt,st,lt,at,it,ct,ut,pt,dt,ft,mt,gt,vt,ht,yt,$t,bt,xt,kt,wt,Ct,Pt,Lt,Ft,_t,jt,Ot,Tt,St,It,At;y=new Ve({props:{name:"route-color",kmlColor:e[0].routeColor}}),y.$on("change",e[6]),S=new Mt({props:{name:"route-pin",selected:e[0].routePin}}),S.$on("change",e[6]),H=new Ve({props:{name:"alternate-color",kmlColor:e[0].alternateColor}}),H.$on("change",e[6]),J=new Mt({props:{name:"alternate-pin",selected:e[0].alternatePin}}),J.$on("change",e[6]),le=new Ve({props:{name:"nat-color",kmlColor:e[0].natColor}}),le.$on("change",e[6]),de=new Mt({props:{name:"nat-pin",selected:e[0].natPin}}),de.$on("change",e[6]),Te=new Ve({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}}),Te.$on("change",e[6]),Ue=new Ve({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}}),Ue.$on("change",e[6]),rt=new Ve({props:{name:"etops-color",kmlColor:e[0].etopsColor}}),rt.$on("change",e[6]),vt=new qt({props:{name:"airport-pin",selected:e[0].airportPin}}),vt.$on("change",e[6]);let zt=!e[3]&&Wt(e);return{c(){t=C("div"),n=C("a"),o=P("svg"),s=P("use"),l=F(),a=C("a"),i=P("svg"),c=P("use"),u=F(),d=C("form"),f=C("fieldset"),m=C("legend"),m.textContent="Route",g=F(),v=C("div"),h=C("div"),xe(y.$$.fragment),w=F(),_=C("div"),xe(S.$$.fragment),A=F(),q=C("fieldset"),z=C("legend"),D=C("input"),N=L("Dégagement"),W=F(),G=C("div"),U=C("div"),xe(H.$$.fragment),K=F(),Z=C("div"),xe(J.$$.fragment),V=F(),Y=C("fieldset"),Q=C("legend"),ee=C("input"),ne=L("Tracks"),oe=F(),re=C("div"),se=C("div"),xe(le.$$.fragment),ae=F(),ie=C("small"),ie.textContent="Un track incomplet restera rouge.",ue=F(),pe=C("div"),xe(de.$$.fragment),fe=F(),me=C("small"),me.textContent="Positionné à l'entrée des tracks.",ye=F(),$e=C("div"),be=C("div"),Ce=C("fieldset"),Pe=C("legend"),Le=C("input"),_e=L("Orthodromie"),je=F(),Me=C("div"),Oe=C("div"),xe(Te.$$.fragment),Ie=F(),Ae=C("div"),qe=C("fieldset"),ze=C("legend"),Re=C("input"),Ee=L("Route du GRAMET"),Ne=F(),We=C("div"),Ge=C("div"),xe(Ue.$$.fragment),Be=F(),Ke=C("div"),Ze=C("div"),Je=C("fieldset"),Xe=C("legend"),Ye=C("input"),et=L("Etops"),tt=F(),nt=C("div"),ot=C("div"),xe(rt.$$.fragment),lt=F(),at=C("div"),it=C("fieldset"),ct=C("legend"),ut=C("input"),dt=L("Airports"),ft=F(),mt=C("div"),gt=C("div"),xe(vt.$$.fragment),yt=F(),$t=C("div"),bt=C("div"),xt=C("button"),kt=L("Mémoriser"),Ct=F(),Pt=C("button"),Lt=L("Restaurer"),jt=F(),Ot=C("div"),zt&&zt.c(),T(s,"xlink:href","#bars"),O(o,"class","svelte-qfeyuc"),R(o,"blink",e[2]),O(n,"class","hamburger svelte-qfeyuc"),O(n,"role","button"),O(n,"href","."),T(c,"xlink:href","#close"),O(i,"class","svelte-qfeyuc"),R(i,"blink",e[2]),O(a,"class","closeB svelte-qfeyuc"),O(a,"role","button"),O(a,"href","."),O(m,"class","svelte-qfeyuc"),O(h,"class",$=p(e[1])+" svelte-qfeyuc"),O(_,"class",I=p(e[1])+" svelte-qfeyuc"),O(v,"class","row"),O(f,"class","form-group svelte-qfeyuc"),O(D,"name","alternate-display"),D.checked=E=e[0].alternateDisplay,O(D,"type","checkbox"),O(D,"class","svelte-qfeyuc"),O(z,"class","svelte-qfeyuc"),O(U,"class",B=p(e[1])+" svelte-qfeyuc"),O(Z,"class",X=p(e[1])+" svelte-qfeyuc"),O(G,"class","row"),O(q,"class","form-group svelte-qfeyuc"),O(ee,"name","nat-display"),ee.checked=te=e[0].natDisplay,O(ee,"type","checkbox"),O(ee,"class","svelte-qfeyuc"),O(Q,"class","svelte-qfeyuc"),O(ie,"class","form-text text-muted svelte-qfeyuc"),O(se,"class",ce=p(e[1])+" svelte-qfeyuc"),O(me,"class","form-text text-muted svelte-qfeyuc"),O(pe,"class",he=p(e[1])+" svelte-qfeyuc"),O(re,"class","row"),O(Y,"class","form-group svelte-qfeyuc"),O(Le,"name","great-circle-display"),Le.checked=Fe=e[0].greatCircleDisplay,O(Le,"type","checkbox"),O(Le,"class","svelte-qfeyuc"),O(Pe,"class","svelte-qfeyuc"),O(Oe,"class","col"),O(Me,"class","row"),O(Ce,"class","form-group svelte-qfeyuc"),O(be,"class",Se=p(e[1])+" svelte-qfeyuc"),O(Re,"name","ogimet-display"),Re.checked=De=e[0].ogimetDisplay,O(Re,"type","checkbox"),O(Re,"class","svelte-qfeyuc"),O(ze,"class","svelte-qfeyuc"),O(Ge,"class","col"),O(We,"class","row"),O(qe,"class","form-group svelte-qfeyuc"),O(Ae,"class",He=p(e[1])+" svelte-qfeyuc"),O($e,"class","row"),O(Ye,"name","etops-display"),Ye.checked=Qe=e[0].etopsDisplay,O(Ye,"type","checkbox"),O(Ye,"class","svelte-qfeyuc"),O(Xe,"class","svelte-qfeyuc"),O(ot,"class","col"),O(nt,"class","row"),O(Je,"class","form-group svelte-qfeyuc"),O(Ze,"class",st=p(e[1])+" svelte-qfeyuc"),O(ut,"name","airport-display"),ut.checked=pt=e[0].airportDisplay,O(ut,"type","checkbox"),O(ut,"class","svelte-qfeyuc"),O(ct,"class","svelte-qfeyuc"),O(gt,"class","col"),O(mt,"class","row"),O(it,"class","form-group svelte-qfeyuc"),O(at,"class",ht=p(e[1])+" svelte-qfeyuc"),O(Ke,"class","row"),xt.disabled=wt=!e[4],O(xt,"class","btn btn-primary btn-sm mb-2"),O(xt,"type","button"),Pt.disabled=Ft=!e[4],O(Pt,"class","btn btn-secondary btn-sm mb-2"),O(Pt,"type","button"),O(bt,"class",_t=p(e[1])+" svelte-qfeyuc"),O(Ot,"class",Tt=p(e[1])+" svelte-qfeyuc"),O($t,"class","row last svelte-qfeyuc"),O(d,"class","svelte-qfeyuc"),O(t,"class","settings svelte-qfeyuc"),R(t,"sidebar",e[5])},m(r,p){x(r,t,p),b(t,n),b(n,o),b(o,s),b(t,l),b(t,a),b(a,i),b(i,c),b(t,u),b(t,d),b(d,f),b(f,m),b(f,g),b(f,v),b(v,h),ke(y,h,null),b(v,w),b(v,_),ke(S,_,null),b(d,A),b(d,q),b(q,z),b(z,D),b(z,N),b(q,W),b(q,G),b(G,U),ke(H,U,null),b(G,K),b(G,Z),ke(J,Z,null),b(d,V),b(d,Y),b(Y,Q),b(Q,ee),b(Q,ne),b(Y,oe),b(Y,re),b(re,se),ke(le,se,null),b(se,ae),b(se,ie),b(re,ue),b(re,pe),ke(de,pe,null),b(pe,fe),b(pe,me),b(d,ye),b(d,$e),b($e,be),b(be,Ce),b(Ce,Pe),b(Pe,Le),b(Pe,_e),b(Ce,je),b(Ce,Me),b(Me,Oe),ke(Te,Oe,null),b($e,Ie),b($e,Ae),b(Ae,qe),b(qe,ze),b(ze,Re),b(ze,Ee),b(qe,Ne),b(qe,We),b(We,Ge),ke(Ue,Ge,null),b(d,Be),b(d,Ke),b(Ke,Ze),b(Ze,Je),b(Je,Xe),b(Xe,Ye),b(Xe,et),b(Je,tt),b(Je,nt),b(nt,ot),ke(rt,ot,null),b(Ke,lt),b(Ke,at),b(at,it),b(it,ct),b(ct,ut),b(ct,dt),b(it,ft),b(it,mt),b(mt,gt),ke(vt,gt,null),b(d,yt),b(d,$t),b($t,bt),b(bt,xt),b(xt,kt),b(bt,Ct),b(bt,Pt),b(Pt,Lt),b($t,jt),b($t,Ot),zt&&zt.m(Ot,null),St=!0,It||(At=[j(n,"click",M(e[11])),j(a,"click",M(e[12])),j(D,"change",e[6]),j(ee,"change",e[6]),j(Le,"change",e[6]),j(Re,"change",e[6]),j(Ye,"change",e[6]),j(ut,"change",e[6]),j(xt,"click",e[9]),j(Pt,"click",e[8]),j(d,"submit",M(e[10]))],It=!0)},p(e,[n]){4&n&&R(o,"blink",e[2]),4&n&&R(i,"blink",e[2]);const r={};1&n&&(r.kmlColor=e[0].routeColor),y.$set(r),(!St||2&n&&$!==($=p(e[1])+" svelte-qfeyuc"))&&O(h,"class",$);const s={};1&n&&(s.selected=e[0].routePin),S.$set(s),(!St||2&n&&I!==(I=p(e[1])+" svelte-qfeyuc"))&&O(_,"class",I),(!St||1&n&&E!==(E=e[0].alternateDisplay))&&(D.checked=E);const l={};1&n&&(l.kmlColor=e[0].alternateColor),H.$set(l),(!St||2&n&&B!==(B=p(e[1])+" svelte-qfeyuc"))&&O(U,"class",B);const a={};1&n&&(a.selected=e[0].alternatePin),J.$set(a),(!St||2&n&&X!==(X=p(e[1])+" svelte-qfeyuc"))&&O(Z,"class",X),(!St||1&n&&te!==(te=e[0].natDisplay))&&(ee.checked=te);const c={};1&n&&(c.kmlColor=e[0].natColor),le.$set(c),(!St||2&n&&ce!==(ce=p(e[1])+" svelte-qfeyuc"))&&O(se,"class",ce);const u={};1&n&&(u.selected=e[0].natPin),de.$set(u),(!St||2&n&&he!==(he=p(e[1])+" svelte-qfeyuc"))&&O(pe,"class",he),(!St||1&n&&Fe!==(Fe=e[0].greatCircleDisplay))&&(Le.checked=Fe);const d={};1&n&&(d.kmlColor=e[0].greatCircleColor),Te.$set(d),(!St||2&n&&Se!==(Se=p(e[1])+" svelte-qfeyuc"))&&O(be,"class",Se),(!St||1&n&&De!==(De=e[0].ogimetDisplay))&&(Re.checked=De);const f={};1&n&&(f.kmlColor=e[0].ogimetColor),Ue.$set(f),(!St||2&n&&He!==(He=p(e[1])+" svelte-qfeyuc"))&&O(Ae,"class",He),(!St||1&n&&Qe!==(Qe=e[0].etopsDisplay))&&(Ye.checked=Qe);const m={};1&n&&(m.kmlColor=e[0].etopsColor),rt.$set(m),(!St||2&n&&st!==(st=p(e[1])+" svelte-qfeyuc"))&&O(Ze,"class",st),(!St||1&n&&pt!==(pt=e[0].airportDisplay))&&(ut.checked=pt);const g={};1&n&&(g.selected=e[0].airportPin),vt.$set(g),(!St||2&n&&ht!==(ht=p(e[1])+" svelte-qfeyuc"))&&O(at,"class",ht),(!St||16&n&&wt!==(wt=!e[4]))&&(xt.disabled=wt),(!St||16&n&&Ft!==(Ft=!e[4]))&&(Pt.disabled=Ft),(!St||2&n&&_t!==(_t=p(e[1])+" svelte-qfeyuc"))&&O(bt,"class",_t),e[3]?zt&&(zt.d(1),zt=null):zt?zt.p(e,n):(zt=Wt(e),zt.c(),zt.m(Ot,null)),(!St||2&n&&Tt!==(Tt=p(e[1])+" svelte-qfeyuc"))&&O(Ot,"class",Tt),32&n&&R(t,"sidebar",e[5])},i(e){St||(ge(y.$$.fragment,e),ge(S.$$.fragment,e),ge(H.$$.fragment,e),ge(J.$$.fragment,e),ge(le.$$.fragment,e),ge(de.$$.fragment,e),ge(Te.$$.fragment,e),ge(Ue.$$.fragment,e),ge(rt.$$.fragment,e),ge(vt.$$.fragment,e),St=!0)},o(e){ve(y.$$.fragment,e),ve(S.$$.fragment,e),ve(H.$$.fragment,e),ve(J.$$.fragment,e),ve(le.$$.fragment,e),ve(de.$$.fragment,e),ve(Te.$$.fragment,e),ve(Ue.$$.fragment,e),ve(rt.$$.fragment,e),ve(vt.$$.fragment,e),St=!1},d(e){e&&k(t),we(y),we(S),we(H),we(J),we(le),we(de),we(Te),we(Ue),we(rt),we(vt),zt&&zt.d(),It=!1,r(At)}}}function Ut(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ht(e,t,n){let o;a(e,Et,e=>n(5,o=e));const r=K(),s=nt.optionsKML;let{kmlOptions:l}=t,{mode:i="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,c={...Ye,...ot.getItem(s)||{}},u=Ut(Ye,l);function p(e){let t=!1;for(const[s,a]of Object.entries(e))l[s]!==a&&(n(0,l[s]=a,l),r("change",{name:(o=s,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:a}),t=!0);var o;t&&n(0,l={...e})}let f,m;return e.$$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions),"mode"in e&&n(1,i=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,f=Ut(Ye,l)),8193&e.$$.dirty&&n(4,m=!Ut(c,l))},[l,i,u,f,m,o,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,s=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));l[s]!==o&&(n(0,l[s]=o,l),r("change",{name:t,value:o}))},function(){p(Ye)},function(){p(c)},function(){if(f)ot.removeItem(s);else{const e={};for(const t of Object.keys(l).filter(e=>l[e]!==Ye[e]))e[t]=l[t];ot.setItem(s,e)}r("save"),n(13,c={...l})},function(t){Z(e,t)},()=>{d(Et,o=!o,o),n(2,u=!1)},()=>{d(Et,o=!o,o),n(2,u=!1)}]}class Bt extends Pe{constructor(e){super(),Ce(this,e,Ht,Gt,l,{kmlOptions:0,mode:1})}}const Kt=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",""+e]],"#ea80d8",["==",7,["get",""+e]],"#ea80d8",["==",6,["get",""+e]],"#dddddd",["==",5,["get",""+e]],"#dddddd",["==",4,["get",""+e]],"#fbfe98",["==",3,["get",""+e]],"#fbfe98",["==",2,["get",""+e]],"#00b0f1",["==",1,["get",""+e]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Zt=(e,t=!0)=>t?["in",""+e,["get","type"]]:["!",["in",""+e,["get","type"]]],Jt=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",""+e]],Xt=e=>0===e?3:0,Vt=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function Yt(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function Qt(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function en(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const tn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function nn(e,t,n,o,r,s,l){e.addSource(t+"-marker-source",Qt(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,(e,t)=>Yt(e,t.name.replace(/00\.0/g,""))))),e.addLayer(sn(t,r,l,s))}function on(e,t,n,o,r,s){o?e.addSource(t+"-line-source",Qt(o(n).map(e=>en(e)))):e.addSource(t+"-line-source",{type:"geojson",data:en(n.map(e=>[e.longitude,e.latitude]))}),e.addLayer(ln(t,r,s))}function rn(e,t,n,o,r,s){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(en(t[e]))}e.addSource(t+"-line-source",Qt(s))}else e.addSource(t+"-line-source",Qt(n.map(e=>en(e.map(e=>[e.longitude,e.latitude])))));e.addLayer(ln(t,r,s))}function sn(e,t,n,o){const[r,s]=He(n);return{id:e+"-marker-layer",type:"symbol",source:e+"-marker-source",layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?tn[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function ln(e,t,n){const[o,r]=He(t);let s=2,l=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,l=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:e+"-line-layer",type:"line",source:e+"-line-source",layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":l}}}const an=2*Math.PI,cn=Math.PI/4,un=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*an};var pn={init:function(){},forward:function(e){var t=e.x,n=e.y,o=un(t-this.long0),r=Math.tan(n/2),s=Math.sin(cn*r),l=s*s,a=this.x0+this.a*o*(.74482-.34588*l),i=this.y0+1.70711*this.a*r;return e.x=a,e.y=i,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(cn*t),o=n*n,r=un(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};function dn(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(pn);const s=t.id.startsWith("jb_");let l={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${s?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const a=new mapboxgl.Map({...t.mapboxOptions,...l});let i,c,u,p;a.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||a.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||a.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||a.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-star-sdf.png",(function(e,t){e||a.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let d=e=>window.proj4("EPSG:3857",e),f=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],l=s[2]-s[0],a=s[3]-s[1],[i,c,u,p]=t.extent,[d,f]=t.ratio,m=l/d*f*(a/l),[g,v,h,y]=[s[0],s[3]-m,s[2],s[3]];e=(h-g)/(u-i),n=g-e*i,o=(y-v)/(p-c),r=v-o*c}else{const[s,l,a,i]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(a-s),n=c-e*s,o=(d-u)/(i-l),r=u-o*l}const[s,l,a,m]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("CUSTOM",e),v=t=>[e*t[0]+n,o*t[1]+r],h=e=>f(v(e));d=e=>v(g(e)),i=e=>f(d(e)),c=e=>{let[t,n]=g(e);return t=Me(t,s,a),n=Me(n,l,m),h([t,n])},u=e=>{let[t,n]=g(e);if(Oe(t,s,a)&&Oe(n,l,m))return h([t,n])},p=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,l,a,i=e.length,c=Se(e[0],t),u=[];for(n||(n=[]),o=1;o<i;o++){for(r=e[o-1],l=a=Se(s=e[o],t);;){if(!(c|l)){u.push(r),l!==a?(u.push(s),o<i-1&&(n.push(u),u=[])):o===i-1&&u.push(s);break}if(c&l)break;c?c=Se(r=Te(r,s,c,t),t):l=Se(s=Te(r,s,l,t),t)}c=a}return u.length&&n.push(u),n}(e.map(e=>g([e.longitude,e.latitude])),t.extent).map(e=>e.map(e=>h(e)))}}let m=void 0;let g=[];if(!n.isFake){for(const e of n.tracks)g=g.concat(e.points);g=g.concat(n.route.points,n.wptCoordinatesAlternate()),m=((e,t=[1/0,1/0,-1/0,-1/0])=>{for(const[n,o]of e.map(e=>c?c([e.longitude,e.latitude]):[e.longitude,e.latitude]))t[0]>n&&(t[0]=n),t[1]>o&&(t[1]=o),t[2]<n&&(t[2]=n),t[3]<o&&(t[3]=o);return t[0]-=1,t[1]-=1,t[2]+=1,t[3]+=1,t})(g),a.fitBounds(m,{padding:{top:30,bottom:80,left:30,right:30}})}const v=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(i){const e=v._onSuccess;v._onSuccess=function(t){const[n,o]=i([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}return a.addControl(v),a.on("load",(function(){t.tiles&&(a.addSource("jb-raster",{type:"raster",tiles:t.tiles,tileSize:t.tileSize}),a.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),function(e,t,n,o,r,s,l,a){const i={...Ye,...t},c=e.description;if(!e.isFake){const t=`${e.infos.departure}-${e.infos.destination}`,o=new editolido.Route(e.wptCoordinates(),{name:t,description:c}),r=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),a=new editolido.Route([o.points[0],o.points[o.points.length-1]]).split(300,{name:"Ortho "+t});on(n,"greatcircle",a.points,l,i.greatCircleColor,i.greatCircleDisplay),on(n,"ogimet",e.ogimetData.route.points,l,i.ogimetColor,i.ogimetDisplay),on(n,"ralt",r.points,l,i.alternateColor,i.alternateDisplay),on(n,"rmain",o.points,l,i.routeColor,!0),nn(n,"ralt",r.points,s,i.alternatePin,i.alternateDisplay,i.alternateColor),nn(n,"rmain",o.points,s,i.routePin,!0,i.routeColor)}"jb_pacific"!==a.id&&((e,t)=>{fetch("data/fir-reg.2102.geojson").then(e=>e.json()).then(n=>{if(t)for(let e=0;e<n.features.length;e++){const o=n.features[e].geometry.coordinates[0];n.features[e].geometry.coordinates=[o.map(e=>t(e))]}e.addSource("fir-reg-source",{type:"geojson",data:n}),e.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),e.addLayer({id:"fir-reg-line-layer",type:"line",source:"fir-reg-source",layout:{},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})})})(n,o);let u=[];e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(u=[e.infos.EEP,e.infos.EXP]);((e,t,n,o,r,s,l)=>{const[a]=He(s),i=o.map(e=>e.name),c=r.map(e=>e.name),u=i.concat(c);fetch("data/airports.2102.geojson").then(e=>e.json()).then(o=>{if(t){const e=[];for(let n of o.features)n.geometry.coordinates=t(n.geometry.coordinates),void 0!==n.geometry.coordinates&&e.push(n);o.features=e}e.addSource("airports-source",{type:"geojson",data:o}),e.addLayer({id:"airport-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:"visible","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Zt(n,!1)}),e.addLayer({id:"airport-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["in",["get","name"],["literal",u]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",u]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:"visible","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",u]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Jt(n,u)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":Xt(l),"icon-color":Kt(l,n,c,a),"text-color":Vt(c,a),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Zt(n)});const r=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!_e}),s=function(t){const n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.title;for(;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;r.setLngLat(n).setHTML(o).addTo(e)},i=()=>e.getCanvas().style.cursor="pointer",p=()=>e.getCanvas().style.cursor="",d=function(){p(),r.remove()};_e?(e.on("mouseenter","airport-layer",e=>{i(),s(e)}),e.on("mouseenter","airport-emer-layer",e=>{i(),s(e)}),e.on("mouseleave","airport-layer",d),e.on("mouseleave","airport-emer-layer",d)):(e.on("mouseenter","airport-layer",i),e.on("mouseenter","airport-emer-layer",i),e.on("click","airport-layer",s),e.on("click","airport-emer-layer",s),e.on("mouseleave","airport-layer",p),e.on("mouseleave","airport-emer-layer",p))})})(n,s,e.isFake?e.isFake:e.infos.aircraft,u,e.infos.raltPoints,i.etopsColor,i.airportPin),e.isFake||(function(e,t,n,o,r,s,l){const a={rnat:[],"rnat-incomplete":[]},i={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(o){const n=o(e.points),r=n.length;for(let o=0;o<r;o++)a[t].push(en(n[o],e.name))}else a[t].push(en(e.points.map(e=>[e.longitude,e.latitude]),e.name));const r=e.points[0];let s=n?n([r.longitude,r.latitude]):[r.longitude,r.latitude];if(s&&i[t].push(Yt(s,`${e.name}\n${r.name}`,e.description)),e.isMine){const o=e.points[e.points.length-1];s=n?n([o.longitude,o.latitude]):[o.longitude,o.latitude],s&&i[t].push(Yt(s,`${e.name}\n${o.name}`,e.description))}}e.addSource("rnat-marker-source",Qt(i.rnat)),e.addSource("rnat-incomplete-marker-source",Qt(i["rnat-incomplete"])),e.addSource("rnat-line-source",Qt(a.rnat)),e.addSource("rnat-incomplete-line-source",Qt(a["rnat-incomplete"])),e.addLayer(ln("rnat",r,l)),e.addLayer(ln("rnat-incomplete",Ye.natIncompleteColor,l)),e.addLayer(sn("rnat",s,r,l)),e.addLayer(sn("rnat-incomplete",s,r,l));const c=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},u=t=>{const n=t+"-marker-layer";e.on("click",n,c),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};u("rnat"),u("rnat-incomplete")}(n,e,s,l,i.natColor,i.natPin,i.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,s,l,a){rn(e,t+"-ep-circle",[n[0].circle(420,48),n[1].circle(420,48)],o,l,r),rn(e,t+"-etops-circle",n.slice(2).map(e=>e.circle(7*s)),o,a,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),l,!0,e.infos.ETOPS,i.routeColor,i.etopsColor))}(n,o,a,i,0,u,p,t);const s=document.querySelector(`#${e} .mapboxgl-ctrl-attrib-inner`);s&&(s.appendChild(document.createTextNode(" | ")),s.appendChild(r),s.appendChild(document.createTextNode(`${"2102".substring(0,2)}.${"2102".substring(2,4)}`))),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2")})),a}function fn(e,t,n){if("etops"===t)return function(e,t){let n="etops-etops-circle-line-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="etops-ep-circle-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("airport"===t)return function(e,t){let n="airport-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="airport-emer-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);const o=t+"-marker-layer",r=t+"-line-layer";e.getLayer(r)&&e.setLayoutProperty(r,"visibility",n?"visible":"none"),e.getLayer(o)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function mn(e,t,n){const[o,r]=He(n);if("etops"===t)return function(e,t){const[n,o]=He(t),r="etops-etops-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n);const s=t+"-marker-layer",l=t+"-line-layer";e.getLayer(l)&&(e.setPaintProperty(l,"line-color",o),e.setPaintProperty(l,"line-opacity",r)),e.getLayer(s)&&e.setPaintProperty(s,"text-color",o),"rmain"===t&&function(e,t){const[n,o]=He(t),r="etops-ep-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n)}function gn(e,t,n,o,r,s){if("airport"===t)return function(e,t,n,o,r){const[s]=He(r),l="airport-layer";e.getLayer(l)&&(e.setPaintProperty(l,"icon-color",Kt(t,n,o,s)),e.setPaintProperty(l,"text-color",Vt(o,s)),e.setPaintProperty(l,"icon-halo-width",Xt(t)))}(e,n,o,r,s);const l=tn[n],a=t+"-marker-layer",i=t+"-line-layer";if(e.getLayer(a)){const t=e.getPaintProperty(i,"line-color");e.setPaintProperty(a,"icon-color",0!==n?l:t),e.setPaintProperty(a,"text-color",t),e.setLayoutProperty(a,"icon-size",0!==n?1:.2),e.setLayoutProperty(a,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(a,"icon-anchor",0!==n?"bottom":"center")}}function vn(e,t,n,o,r,s){const l=je(t);if("aircraftType"===t){let t=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(t=[o.infos.EEP.name,o.infos.EXP.name]),function(e,t,n,o,r,s){const[l]=He(s),a="airport-layer";e.setFilter(a,Zt(n)),e.setPaintProperty(a,"icon-color",Kt(t,n,o,l)),e.setLayoutProperty(a,"symbol-sort-key",Jt(n,r)),e.setFilter("airport-emer-layer",Zt(n,!1))}(e,r.airportPin,s,o.infos.ralts,t.concat(o.infos.ralts),r.etopsColor)}else t.endsWith("-display")?("rnat"===l&&fn(e,"rnat-incomplete",n),fn(e,l,n)):t.endsWith("-pin")?gn(e,l,n,s,o.infos.ralts,r.etopsColor):t.endsWith("-color")&&mn(e,l,n)}const hn={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},{window:yn}=$e;function $n(e,t,n){const o=e.slice();return o[24]=t[n],o[26]=n,o}function bn(e,t,n){const o=e.slice();return o[27]=t[n],o[26]=n,o}function xn(e){let t,n,o,r,s=(e[27].proj4&&e[11](e[27])?""+e[27].label.toUpperCase():e[27].label)+"";return{c(){t=C("option"),n=L(s),t.__value=o=e[26],t.value=t.__value,t.selected=r=e[26]===e[3]},m(e,o){x(e,t,o),b(t,n)},p(e,n){8&n&&r!==(r=e[26]===e[3])&&(t.selected=r)},d(e){e&&k(t)}}}function kn(e){let t,n,o,r,s=e[24]+"";return{c(){t=C("option"),n=L(s),t.__value=o=e[26],t.value=t.__value,t.selected=r=e[26]===e[4]},m(e,o){x(e,t,o),b(t,n)},p(e,n){16&n&&r!==(r=e[26]===e[4])&&(t.selected=r)},d(e){e&&k(t)}}}function wn(e){let t,n=("???"!==e[24]||"???"===e[4]&&"???"===e[24])&&kn(e);return{c(){n&&n.c(),t=_()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){"???"!==e[24]||"???"===e[4]&&"???"===e[24]?n?n.p(e,o):(n=kn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Cn(e){let t,n,o,l,a,i,c,u,p,d,m,g,v,h=e[7],y=[];for(let t=0;t<h.length;t+=1)y[t]=xn(bn(e,h,t));let $=e[6],P=[];for(let t=0;t<$.length;t+=1)P[t]=wn($n(e,$,t));function L(t){e[18].call(null,t)}let _={};return void 0!==e[0]&&(_.kmlOptions=e[0]),p=new Bt({props:_}),X.push(()=>be(p,"kmlOptions",L)),p.$on("change",e[12]),p.$on("save",e[19]),{c(){t=C("div"),o=F(),l=C("div"),a=C("select");for(let e=0;e<y.length;e+=1)y[e].c();i=F(),c=C("select");for(let e=0;e<P.length;e+=1)P[e].c();u=F(),xe(p.$$.fragment),O(t,"id",e[2]),O(t,"class","svelte-elcmhy"),O(a,"name",Pn),O(a,"class","form-control form-control-sm svelte-elcmhy"),void 0===e[3]&&ne(()=>e[15].call(a)),O(l,"class","mapmenu svelte-elcmhy"),O(c,"name","aircraftType"),O(c,"class","svelte-elcmhy"),void 0===e[4]&&ne(()=>e[17].call(c))},m(r,s){x(r,t,s),x(r,o,s),x(r,l,s),b(l,a);for(let e=0;e<y.length;e+=1)y[e].m(a,null);q(a,e[3]),x(r,i,s),x(r,c,s);for(let e=0;e<P.length;e+=1)P[e].m(c,null);e[16](c),q(c,e[4]),x(r,u,s),ke(p,r,s),m=!0,g||(v=[j(yn,"orientationchange",e[13]),f(n=e[10].call(null,t,{route:e[1]})),j(a,"change",e[15]),j(a,"change",e[8]),j(c,"change",e[17]),j(c,"change",e[9])],g=!0)},p(e,[o]){if((!m||4&o)&&O(t,"id",e[2]),n&&s(n.update)&&2&o&&n.update.call(null,{route:e[1]}),2184&o){let t;for(h=e[7],t=0;t<h.length;t+=1){const n=bn(e,h,t);y[t]?y[t].p(n,o):(y[t]=xn(n),y[t].c(),y[t].m(a,null))}for(;t<y.length;t+=1)y[t].d(1);y.length=h.length}if(8&o&&q(a,e[3]),80&o){let t;for($=e[6],t=0;t<$.length;t+=1){const n=$n(e,$,t);P[t]?P[t].p(n,o):(P[t]=wn(n),P[t].c(),P[t].m(c,null))}for(;t<P.length;t+=1)P[t].d(1);P.length=$.length}16&o&&q(c,e[4]);const r={};!d&&1&o&&(d=!0,r.kmlOptions=e[0],oe(()=>d=!1)),p.$set(r)},i(e){m||(ge(p.$$.fragment,e),m=!0)},o(e){ve(p.$$.fragment,e),m=!1},d(n){n&&k(t),n&&k(o),n&&k(l),w(y,n),n&&k(i),n&&k(c),w(P,n),e[16](null),n&&k(u),we(p,n),g=!1,r(v)}}}const Pn="map-style";function Ln(e,t,n){const o=K();let r,{kmlOptions:s}=t,{ofp:l}=t,{route:a}=t,i=void 0,c=-1,u=-1;const p=["???","318","319","320","321","330","340","350","380","787","772","773","77F"],d=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,f=[{label:"Mercator",id:"atlas",mapboxOptions:{style:"mapbox://styles/flyingeek/ckc4yge17166a1ip66rkf0zhr",renderWorldCopies:!1,maxZoom:12}},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:hn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],tileSize:d},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:hn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],tileSize:d},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:hn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],tileSize:d},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:hn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],tileSize:d}];let{id:m="map"}=t;function g(){i&&i.remove()}var v;return v=()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",i=dn(m,f[c],l,s,r)},B().$$.on_mount.push(v),e.$$set=e=>{"kmlOptions"in e&&n(0,s=e.kmlOptions),"ofp"in e&&n(14,l=e.ofp),"route"in e&&n(1,a=e.route),"id"in e&&n(2,m=e.id)},[s,a,m,c,u,r,p,f,function(e){e.target.blur(),g(),i=dn(m,f[c],l,s,r)},function(e){e.target.blur(),vn(i,"aircraftType",p[e.target.value],l,s,p[e.target.value])},function(e,t){if(-1===c&&l&&!l.isFake){const e=l.route.points[0],t=l.route.points[l.route.points.length-1];t.latitude>30&&e.latitude>30?n(3,c=1):t.longitude<-80&&e.longitude<-80?n(3,c=3):n(3,c=2)}return-1===c&&n(3,c=0),-1===u&&l&&n(4,u=l.isFake?p.indexOf(l.isFake):p.indexOf(l.infos.aircraft)),-1===u&&n(4,u=0),{update(e){"/map"===e.route&&i&&i.resize()},destroy(){g()}}},function(e){if(!e.proj4||!l||l.isFake)return!0;const t=l.route.points[0],n=l.route.points[l.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},e=>{vn(i,e.detail.name,e.detail.value,l,s,p[u]),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-"))return;const n=et(),o=je(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),o("save")},e=>{"/map"===a&&i&&i.resize()},l,function(){c=z(this),n(3,c)},function(e){X[e?"unshift":"push"](()=>{r=e,n(5,r)})},function(){u=z(this),n(4,u)},function(e){s=e,n(0,s)},function(t){Z(e,t)}]}class Fn extends Pe{constructor(e){super(),Ce(this,e,Ln,Cn,l,{kmlOptions:0,ofp:14,route:1,id:2})}}function _n(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#marker"></use></svg> \n      <span class="svelte-1nd81uv">CARTE</span>',O(n,"class","nav-link svelte-1nd81uv"),O(n,"href","#/map"),R(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/map"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/map"===e[0])},d(e){e&&k(t)}}}function jn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#cloud"></use></svg> \n      <span class="svelte-1nd81uv">GRAMET</span>',O(n,"class","nav-link svelte-1nd81uv"),O(n,"href","#/gramet"),R(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/gramet"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/gramet"===e[0])},d(e){e&&k(t)}}}function Mn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#export"></use></svg> \n      <span class="svelte-1nd81uv">EXPORT</span>',O(n,"class","nav-link svelte-1nd81uv"),O(n,"href","#/export"),R(n,"disabled",!e[1]),O(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/export"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/export"===e[0])},d(e){e&&k(t)}}}function On(t){let n,o,r,s;return{c(){n=C("li"),o=C("a"),o.textContent="PARTAGER",O(o,"class","nav-link"),O(o,"href","."),O(n,"class","nav-item optional svelte-1nd81uv")},m(e,l){x(e,n,l),b(n,o),r||(s=j(o,"click",M(t[2])),r=!0)},p:e,d(e){e&&k(n),r=!1,s()}}}function Tn(e){let t,n,o,r,s,l,a,c,p,d,f,m=(e[1]||"/map"===e[0])&&_n(e),g=(e[1]&&!e[1].isFakeOfp||"/gramet"===e[0])&&jn(e),v=(e[1]&&!e[1].isFakeOfp||"/export"===e[0])&&Mn(e),h=e[1]&&navigator.share&&On(e);const y=e[4].default,$=i(y,e,e[3],null);return{c(){t=C("nav"),n=C("ul"),o=C("li"),o.innerHTML='<a class="nav-link" href="#/"><svg class="svelte-1nd81uv"><use xlink:href="#home"></use></svg></a>',r=F(),m&&m.c(),s=F(),g&&g.c(),l=F(),v&&v.c(),a=F(),c=C("li"),c.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-1nd81uv"><use xlink:href="#info"></use></svg> \n      <span class="svelte-1nd81uv">AIDE</span></a>',p=F(),h&&h.c(),d=F(),$&&$.c(),O(o,"class","nav-item svelte-1nd81uv"),R(o,"active","/"===e[0]),O(c,"class","nav-item svelte-1nd81uv"),R(c,"active","/help"===e[0]),O(n,"class","navbar-nav mr-auto svelte-1nd81uv"),O(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-1nd81uv")},m(e,i){x(e,t,i),b(t,n),b(n,o),b(n,r),m&&m.m(n,null),b(n,s),g&&g.m(n,null),b(n,l),v&&v.m(n,null),b(n,a),b(n,c),b(n,p),h&&h.m(n,null),b(t,d),$&&$.m(t,null),f=!0},p(e,[t]){1&t&&R(o,"active","/"===e[0]),e[1]||"/map"===e[0]?m?m.p(e,t):(m=_n(e),m.c(),m.m(n,s)):m&&(m.d(1),m=null),e[1]&&!e[1].isFakeOfp||"/gramet"===e[0]?g?g.p(e,t):(g=jn(e),g.c(),g.m(n,l)):g&&(g.d(1),g=null),e[1]&&!e[1].isFakeOfp||"/export"===e[0]?v?v.p(e,t):(v=Mn(e),v.c(),v.m(n,a)):v&&(v.d(1),v=null),1&t&&R(c,"active","/help"===e[0]),e[1]&&navigator.share?h?h.p(e,t):(h=On(e),h.c(),h.m(n,null)):h&&(h.d(1),h=null),$&&$.p&&8&t&&u($,y,e,e[3],t,null,null)},i(e){f||(ge($,e),f=!0)},o(e){ve($,e),f=!1},d(e){e&&k(t),m&&m.d(),g&&g.d(),v&&v.d(),h&&h.d(),$&&$.d(e)}}}function Sn(e,t,n){let{$$slots:o={},$$scope:r}=t,{route:s}=t,{promise:l}=t;return e.$$set=e=>{"route"in e&&n(0,s=e.route),"promise"in e&&n(1,l=e.promise),"$$scope"in e&&n(3,r=e.$$scope)},[s,l,async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},r,o]}class In extends Pe{constructor(e){super(),Ce(this,e,Sn,Tn,l,{route:0,promise:1})}}function An(e,t,n){const o=e.slice();return o[12]=t[n],o}function qn(e){let t,n,o,s,l,a=En,i=[];for(let t=0;t<a.length;t+=1)i[t]=zn(An(e,a,t));return{c(){t=C("div"),n=C("select"),o=C("option"),o.textContent="pas d'ofp ?";for(let e=0;e<i.length;e+=1)i[e].c();o.__value="none",o.value=o.__value,O(n,"class","form-control-sm svelte-14yxy04"),n.disabled=e[1],O(t,"class","footer svelte-14yxy04")},m(r,a){x(r,t,a),b(t,n),b(n,o);for(let e=0;e<i.length;e+=1)i[e].m(n,null);s||(l=[j(n,"click",e[4],{once:!0}),j(n,"change",e[6])],s=!0)},p(e,t){if(0&t){let o;for(a=En,o=0;o<a.length;o+=1){const r=An(e,a,o);i[o]?i[o].p(r,t):(i[o]=zn(r),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=a.length}2&t&&(n.disabled=e[1])},d(e){e&&k(t),w(i,e),s=!1,r(l)}}}function zn(t){let n,o,r,s=t[12]+"";return{c(){n=C("option"),o=L(s),n.__value=r=t[12],n.value=n.__value},m(e,t){x(e,n,t),b(n,o)},p:e,d(e){e&&k(n)}}}function Rn(t){let n,o,s,l,a,i,c,u,p,d=!t[0]&&qn(t);return{c(){n=C("div"),o=C("input"),s=F(),l=C("label"),a=L(t[2]),i=F(),d&&d.c(),c=_(),O(o,"id",Wn),O(o,"name",Wn),O(o,"type","file"),O(o,"accept","application/pdf"),o.disabled=t[1],O(o,"class","custom-file-input svelte-14yxy04"),O(l,"class","custom-file-label text-truncate svelte-14yxy04"),O(l,"for",Wn),R(l,"ready",t[3]),O(n,"class","custom-file svelte-14yxy04"),R(n,"blink",!t[0])},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,l),b(l,a),x(e,i,r),d&&d.m(e,r),x(e,c,r),u||(p=[j(o,"change",t[5]),j(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&S(a,e[2]),8&t&&R(l,"ready",e[3]),1&t&&R(n,"blink",!e[0]),e[0]?d&&(d.d(1),d=null):d?d.p(e,t):(d=qn(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&k(n),e&&k(i),d&&d.d(e),e&&k(c),u=!1,r(p)}}}const Dn=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.6.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.6.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}];let En=["318","319","320","321","330","340","350","380","787","772","773","77F"];const Nn=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map(e=>e.str).join("")};let Wn="file";function Gn(e,t,n){let o,{promise:r}=t,{kmlOptions:s}=t,l=!1,a=new Le,i="Choisir un OFP",c=!1;const u=K();function p(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach(({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,l=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(l.crossOrigin="anonymous");let a=!0;s?(l.src=t,l.async=n.async,l.defer=n.defer):(l.href=t,"prefetch"in n?(l.rel="prefetch",o-=1,a=!1):"preload"in n?(l.rel="preload",o-=1,a=!1):(l.rel="stylesheet",o-=1,a=!1)),a&&(l.onload=r),document.body.appendChild(l)})}(Dn,()=>!!window["pdfjs-dist/build/pdf"],()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",o&&!o.destroyed||(o=new e.PDFWorker),a.resolve(!0),n(3,c=!0)})}const d=e=>{const t=new FileReader;return new Promise((n,r)=>{t.onload=e=>{if(!o||o.destroyed){const e=window["pdfjs-dist/build/pdf"];o=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Nn(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:o}).then(e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),o=new editolido.GeoGridIndex;o.data=window.WMO;const l=editolido.ogimetData(t,o);l.proxyImg=`https://ofp2map-gramet.vercel.app/api/${l.proxy}__${l.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,l.route.description=l.wmo.join(" "),t.ogimetData=l;try{et();tt(t,s),n(t)}catch(e){r(e)}}catch(e){r(e)}else r(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))},e=>r(e))},t.onerror=e=>{r(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)})};return e.$$set=e=>{"promise"in e&&n(0,r=e.promise),"kmlOptions"in e&&n(7,s=e.kmlOptions)},[r,l,i,c,p,async function(e){n(1,l=!0),p(),await a.promise.then(()=>{const t=e.target.files[0];t&&(n(2,i=e.target.value.split(/([\\/])/g).pop()),u("change",i),n(0,r=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))}),n(1,l=!1)},async function(e){n(1,l=!0),p(),await a.promise.then(()=>{n(0,r=new Promise((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{et();tt(o,s),t(o)}catch(e){n(e)}})),n(0,r.isFakeOfp=!0,r),window.location.hash="#/map"}),n(1,l=!1)},s]}class Un extends Pe{constructor(e){super(),Ce(this,e,Gn,Rn,l,{promise:0,kmlOptions:7})}}function Hn(n){let o,r,l;const a=n[3].default,c=i(a,n,n[2],null);return{c(){o=C("page"),c&&c.c(),O(o,"class","svelte-7uc4nn"),R(o,"fadein",!1===n[0]),R(o,"d-none",!0===n[0])},m(e,t){x(e,o,t),c&&c.m(o,null),l=!0},p(e,[t]){c&&c.p&&4&t&&u(c,a,e,e[2],t,null,null),1&t&&R(o,"fadein",!1===e[0]),1&t&&R(o,"d-none",!0===e[0])},i(a){l||(ge(c,a),r||ne(()=>{r=function(n,o,r){let l,a,i=o(n,r),c=!1,u=0;function p(){l&&U(n,l)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:f}=i||he;f&&(l=G(n,0,1,r,o,s,f,u++)),d(0,1);const m=g()+o,v=m+r;a&&a.abort(),c=!0,ne(()=>ue(n,!0,"start")),a=$(e=>{if(c){if(e>=v)return d(1,0),ue(n,!0,"end"),p(),c=!1;if(e>=m){const t=s((e-m)/r);d(t,1-t)}}return c})}let f=!1;return{start(){f||(U(n),s(i)?(i=i(),ce().then(d)):d())},invalidate(){f=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()}),l=!0)},o(e){ve(c,e),l=!1},d(e){e&&k(o),c&&c.d(e)}}}function Bn(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return Ie(e,t)},r,o]}class Kn extends Pe{constructor(e){super(),Ce(this,e,Bn,Hn,l,{hidden:0})}}function Zn(t){let n,o,r,s,l,a,i,c,u,p,d,f,m,g,v,h,y,$,b,w,P,L,_,j,M,T,S,I,A,q,z;return{c(){n=C("h2"),n.textContent="Préambule",o=F(),r=C("p"),r.textContent="Cette app a été conçue pour le PilotPad. Elle nécessite des navigateurs récents pour fonctionner. Safari 13 iOS/Mac est compatible, Chrome 83 fonctionne aussi. Firefox dernière version devrait fonctionner (non testé).\nL'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. GitHub (détenu par Microsoft), hébergeur du site, utilise des cookies. L'app en elle même ne collecte aucune données.",s=F(),l=C("h2"),l.textContent="Utilisation",a=F(),i=C("ol"),i.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner. Le &quot;drag and drop&quot; est également possible dans le champ d&#39;input de l&#39;OFP.</p></li> \n<li><p>Après avoir ouvert ce site dans Safari sur iPad, il est possible d&#39;afficher le menu de personnalisation en cliquant sur  l&#39;icône en haut à droite (le &quot;hamburger&quot;). Dans les résolutions plus faibles, sur iPhone ou en mode &quot;split view&quot;, ces réglages sont affichés sous la carte. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur une projection Web Mercator.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li></ul></li>",c=F(),u=C("ol"),u.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</li>",p=F(),d=C("h2"),d.textContent="Mode off-line",f=F(),m=C("p"),m.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Il est aussi probable que le cache de l'App (50Mo) vous permettra de naviguer sur les cartes déjà visualisées.",g=F(),v=C("h2"),v.textContent="Sauvegarde des paramètres",h=F(),y=C("p"),y.textContent="L'app permet de sauvegarder vos paramètres dans le navigateur. Toutefois Apple ne conserve plus les données au-delà\nde 7 jours, vos réglages risquent donc de disparaître. La solution: après avoir paramétré l'app, mémorisez vos choix dans la \"sidebar\" puis, sauvegardez l'url de la page dans vos favoris.\nL'URL contient l'ensemble des détails nécessaires à la restauration. Si vous utilisez cette méthode, pensez à bien \nsauvegarder l'URL après vos modifications. Dans un premier temps, contentez-vous de sauvegarder avec le bouton «Mémoriser»,\ntestez sur différents OFP, puis une fois satisfait, sauvegardez dans vos favoris.",$=F(),b=C("h2"),b.textContent="Installation sur l'écran d'accueil",w=F(),P=C("p"),P.textContent="L'app peut être installée sur l'écran d'accueil ce qui permet d'avoir la carte sur un écran plus grand. Il y a toutefois quelques inconvénients: durée de sauvegarde des paramétres ?, des bugs d'affichage apparaissent lorsque l'on retourne sur l'app (l'app est zoomée, il faut dézoomer en utilisant un pinch de deux doigts sur la barre de menu). Enfin l'app sur l'écran d'accueil ne permet pas de recharger la page si on rencontre un problème, il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.",L=F(),_=C("h2"),_.textContent="Mise à jour",j=F(),M=C("p"),M.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut \napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",T=F(),S=C("h2"),S.textContent="Crédits",I=F(),A=C("ul"),A.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',q=F(),z=C("p"),z.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",O(u,"start","5")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t),x(e,s,t),x(e,l,t),x(e,a,t),x(e,i,t),x(e,c,t),x(e,u,t),x(e,p,t),x(e,d,t),x(e,f,t),x(e,m,t),x(e,g,t),x(e,v,t),x(e,h,t),x(e,y,t),x(e,$,t),x(e,b,t),x(e,w,t),x(e,P,t),x(e,L,t),x(e,_,t),x(e,j,t),x(e,M,t),x(e,T,t),x(e,S,t),x(e,I,t),x(e,A,t),x(e,q,t),x(e,z,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r),e&&k(s),e&&k(l),e&&k(a),e&&k(i),e&&k(c),e&&k(u),e&&k(p),e&&k(d),e&&k(f),e&&k(m),e&&k(g),e&&k(v),e&&k(h),e&&k(y),e&&k($),e&&k(b),e&&k(w),e&&k(P),e&&k(L),e&&k(_),e&&k(j),e&&k(M),e&&k(T),e&&k(S),e&&k(I),e&&k(A),e&&k(q),e&&k(z)}}}class Jn extends Pe{constructor(e){super(),Ce(this,e,null,Zn,l,{})}}function Xn(e){let t,n,o,r,s,l,a=e[1].msg+"",i=0!==e[1].code&&Qn(e);return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(a),l=F(),i&&i.c(),O(o,"data-status",s=e[1].code),O(o,"class","svelte-jp9cw7"),O(t,"class","svelte-jp9cw7")},m(e,s){x(e,t,s),b(t,n),b(t,o),b(o,r),b(t,l),i&&i.m(t,null)},p(e,n){2&n&&a!==(a=e[1].msg+"")&&S(r,a),2&n&&s!==(s=e[1].code)&&O(o,"data-status",s),0!==e[1].code?i?i.p(e,n):(i=Qn(e),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},d(e){e&&k(t),i&&i.d()}}}function Vn(e){let t,n,o,r,s,l,a,i,c=e[1].msg+"";return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(c),l=C("a"),l.textContent="Installer",O(o,"data-status",s=e[1].code),O(o,"class","svelte-jp9cw7"),O(l,"href","."),O(t,"class","svelte-jp9cw7")},m(s,c){x(s,t,c),b(t,n),b(t,o),b(o,r),b(t,l),a||(i=j(l,"click",M(e[4])),a=!0)},p(e,t){2&t&&c!==(c=e[1].msg+"")&&S(r,c),2&t&&s!==(s=e[1].code)&&O(o,"data-status",s)},d(e){e&&k(t),a=!1,i()}}}function Yn(t){let n,o,r,s,l;return{c(){n=C("p"),o=L("La page n'est pas controllée par le service worker. "),r=C("a"),r.textContent="Recharger la page",O(r,"href","./index.html"),O(n,"class","svelte-jp9cw7")},m(e,a){x(e,n,a),b(n,o),b(n,r),s||(l=j(r,"click",t[5]),s=!0)},p:e,d(e){e&&k(n),s=!1,l()}}}function Qn(e){let t;function n(e,t){return e[0]===ao?to:eo}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function eo(e){let t;return{c(){t=L(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&S(t,e[0])},d(e){e&&k(t)}}}function to(e){let t;function n(e,t){return e[3]?oo:no}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function no(t){let n;return{c(){n=L("non connecté")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function oo(e){let t,n,o,r;return{c(){t=C("a"),n=L(e[0]),O(t,"href",".")},m(s,l){x(s,t,l),b(t,n),o||(r=j(t,"click",M(e[7])),o=!0)},p(e,t){1&t&&S(n,e[0])},d(e){e&&k(t),o=!1,r()}}}function ro(t){let n;return{c(){n=C("p"),n.textContent="Vos réglages seront conservés mais l'OFP sera remis à zéro.",O(n,"class","svelte-jp9cw7")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function so(t){let n,o,r,s,l,a,i;return{c(){n=C("p"),o=C("a"),o.textContent="Réinitialiser l'App",r=L(" va en plus réinitialiser le service Worker (il faut être connecté)."),s=F(),l=C("p"),l.textContent="Dans les 2 cas vos réglages sont conservés mais l'OFP est remis à zéro.",O(o,"class","btn btn-danger btn-sm"),O(o,"href","./index.html"),O(n,"class","svelte-jp9cw7"),O(l,"class","svelte-jp9cw7")},m(e,c){x(e,n,c),b(n,o),b(n,r),x(e,s,c),x(e,l,c),a||(i=j(o,"click",t[6]),a=!0)},p:e,d(e){e&&k(n),e&&k(s),e&&k(l),a=!1,i()}}}function lo(e){let t,n,o,r,s,l,a,i,c=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[2]?2===e[1].code?Vn:Xn:Yn}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}(e),u=!0===navigator.standalone&&function(e){let t,n,o,r,s,l,a,i,c;function u(e,t){return e[3]?so:ro}let p=u(e),d=p(e);return{c(){t=C("p"),t.innerHTML="<b>En cas de problème:</b>",n=F(),o=C("p"),r=C("a"),r.textContent="Recharger l'App",s=L(" c'est l'équivalent d'un rechargement de page."),l=F(),d.c(),a=_(),O(t,"class","svelte-jp9cw7"),O(r,"class","btn btn-primary btn-sm svelte-jp9cw7"),O(r,"href","./index.html"),O(o,"class","svelte-jp9cw7")},m(u,p){x(u,t,p),x(u,n,p),x(u,o,p),b(o,r),b(o,s),x(u,l,p),d.m(u,p),x(u,a,p),i||(c=j(r,"click",e[5]),i=!0)},p(e,t){p===(p=u(e))&&d?d.p(e,t):(d.d(1),d=p(e),d&&(d.c(),d.m(a.parentNode,a)))},d(e){e&&k(t),e&&k(n),e&&k(o),e&&k(l),d.d(e),e&&k(a),i=!1,c()}}}(e);return a=new Jn({}),{c(){t=C("div"),n=C("p"),n.textContent="Application version: 1.2.31",o=F(),c&&c.c(),r=F(),u&&u.c(),s=F(),l=C("div"),xe(a.$$.fragment),O(n,"class","svelte-jp9cw7"),O(t,"class","info svelte-jp9cw7"),O(l,"class","markdown svelte-jp9cw7")},m(e,p){x(e,t,p),b(t,n),b(t,o),c&&c.m(t,null),b(t,r),u&&u.m(t,null),x(e,s,p),x(e,l,p),ke(a,l,null),i=!0},p(e,[t]){navigator.serviceWorker&&c.p(e,t),!0===navigator.standalone&&u.p(e,t)},i(e){i||(ge(a.$$.fragment,e),i=!0)},o(e){ve(a.$$.fragment,e),i=!1},d(e){e&&k(t),c&&c.d(),u&&u.d(),e&&k(s),e&&k(l),we(a)}}}const ao="Vérifier Mise à jour";function io(e,t,n){let o,r;a(e,Dt,e=>n(11,o=e)),a(e,Nt,e=>n(3,r=e));let s=window.serviceWorker,l=!0;!s&&navigator.serviceWorker&&navigator.serviceWorker.ready.then(e=>(n(8,s=e),e)).catch(e=>n(9,l=!1));let i=navigator.serviceWorker&&navigator.serviceWorker.controller,c=ao;const u=e=>e?e.installing?{code:1,msg:"🔹 installing"}:e.waiting?{code:2,msg:"🔸 waiting"}:e.active?{code:3,msg:"🟢"}:void 0:{code:0,msg:"🔺 unknown"},p=()=>{window.location.reload()};let f,m,g;return e.$$.update=()=>{256&e.$$.dirty&&n(1,m=u(s)),512&e.$$.dirty&&n(2,g=i&&l)},f=window.editolido?" / lidojs: v"+window.editolido.version:"",[c,m,g,r,()=>{s.waiting&&(d(Dt,o=!0,o),s.waiting.postMessage("SKIP_WAITING"))},p,e=>{if(!window.confirm("Vous devez être connecté au réseau, ceci ne devrait être utile qu'en cas de bug, Réinitialiser ?"))return e.preventDefault(),!1;s&&s.unregister(),p()},()=>{n(0,c="Vérification... "),d(Dt,o=!1,o),s.update().then(e=>{3!==u(e).code?(n(0,c=""),n(8,s)):n(0,c="À jour")}).catch(e=>n(0,c=e))}]}class co extends Pe{constructor(e){super(),Ce(this,e,io,lo,l,{})}}function uo(t){return{c:e,m:e,p:e,d:e}}function po(e){let t,n=e[5]&&!e[1]&&fo(e);return{c(){n&&n.c(),t=_()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=fo(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function fo(e){let t,n,o,s,l,a,i,c,u,p,d;function f(e,t){return e[0]?mo:go}let m=f(e),g=m(e);function v(...t){return e[4](e[5],...t)}return{c(){t=C("div"),n=C("div"),o=C("strong"),o.innerHTML='<span class="svelte-5snzlz">👨🏻‍✈️</span>Mise à jour disponible',s=F(),l=C("button"),l.innerHTML='<span aria-hidden="true">×</span>',a=F(),i=C("div"),g.c(),c=F(),u=C("button"),u.textContent="Installer",O(o,"class","mr-auto svelte-5snzlz"),O(l,"type","button"),O(l,"class","ml-2 mb-1 close"),O(l,"aria-label","Close"),O(n,"class","toast-header"),O(u,"type","button"),O(u,"class","btn"),R(u,"btn-primary",!e[0]),R(u,"btn-danger",e[0]),O(i,"class","toast-body text-center"),O(t,"class","toast svelte-5snzlz"),A(t,"position","absolute"),A(t,"top","0"),A(t,"right","0")},m(r,f){x(r,t,f),b(t,n),b(n,o),b(n,s),b(n,l),b(t,a),b(t,i),g.m(i,null),b(i,c),b(i,u),p||(d=[j(l,"click",e[3]),j(u,"click",v)],p=!0)},p(t,n){m!==(m=f(e=t))&&(g.d(1),g=m(e),g&&(g.c(),g.m(i,c))),1&n&&R(u,"btn-primary",!e[0]),1&n&&R(u,"btn-danger",e[0])},d(e){e&&k(t),g.d(),p=!1,r(d)}}}function mo(e){let t;return{c(){t=C("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function go(e){let t;return{c(){t=C("p"),t.textContent="Celà va recharger l'App"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function vo(t){return{c:e,m:e,p:e,d:e}}function ho(t){let n,o,r={ctx:t,current:null,token:null,hasCatch:!1,pending:vo,then:po,catch:uo,value:5};return ye(o=window.isSWUpdateAvailable.promise,r),{c(){n=_(),r.block.c()},m(e,t){x(e,n,t),r.block.m(e,r.anchor=t),r.mount=()=>n.parentNode,r.anchor=n},p(e,[n]){{const o=(t=e).slice();o[5]=r.resolved,r.block.p(o,n)}},i:e,o:e,d(e){e&&k(n),r.block.d(e),r.token=null,r=null}}}function yo(e,t,n){let o;a(e,Dt,e=>n(1,o=e));let{loaded:r=!1}=t;const s=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,s,()=>d(Dt,o=!0,o),e=>s(e)]}class $o extends Pe{constructor(e){super(),Ce(this,e,yo,ho,l,{loaded:0})}}const{window:bo}=$e;function xo(e){let t,n,o,r,s,l;function a(t){e[9].call(null,t)}let i={kmlOptions:e[2]};return void 0!==e[1]&&(i.promise=e[1]),n=new Un({props:i}),X.push(()=>be(n,"promise",a)),n.$on("change",e[5]),{c(){t=C("form"),xe(n.$$.fragment),O(t,"class","form-inline svelte-1pvavz"),R(t,"invisible","/help"===e[0])},m(o,a){x(o,t,a),ke(n,t,null),r=!0,s||(l=j(t,"submit",M(e[8])),s=!0)},p(e,r){const s={};4&r&&(s.kmlOptions=e[2]),!o&&2&r&&(o=!0,s.promise=e[1],oe(()=>o=!1)),n.$set(s),1&r&&R(t,"invisible","/help"===e[0])},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&k(t),we(n),s=!1,l()}}}function ko(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Lo,then:Co,catch:wo,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=_(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function wo(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s),R(n,"d-none","/map"!==t[0])},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&S(r,s),1&t&&R(n,"d-none","/map"!==e[0])},i:e,o:e,d(e){e&&k(n)}}}function Co(e){let t,n;return t=new Kn({props:{hidden:"/map"!==e[0],$$slots:{default:[Po]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131079&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Po(e){let t,n,o;function r(t){e[10].call(null,t)}let s={id:"map",ofp:e[15],route:e[0]};return void 0!==e[2]&&(s.kmlOptions=e[2]),t=new Fn({props:s}),X.push(()=>be(t,"kmlOptions",r)),t.$on("save",e[4]),{c(){xe(t.$$.fragment)},m(e,n){ke(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[15]),1&o&&(r.route=e[0]),!n&&4&o&&(n=!0,r.kmlOptions=e[2],oe(()=>n=!1)),t.$set(r)},i(e){o||(ge(t.$$.fragment,e),o=!0)},o(e){ve(t.$$.fragment,e),o=!1},d(e){we(t,e)}}}function Lo(e){let t,n;return t=new Kn({props:{hidden:"/map"!==e[0],$$slots:{default:[Fo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Fo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",A(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function _o(e){let t,n;return t=new Kn({props:{$$slots:{default:[Oo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function jo(e){let t,n;return t=new Kn({props:{$$slots:{default:[To]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Mo(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Do,then:Io,catch:So,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=_(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function Oo(e){let t,n;return t=new co({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function To(e){let t,n;return t=new Ct({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function So(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s)},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&S(r,s)},i:e,o:e,d(e){e&&k(n)}}}function Io(e){let t,n,o,r;const s=[qo,Ao],l=[];function a(e,t){return"/gramet"===e[0]?0:"/export"===e[0]?1:-1}return~(t=a(e))&&(n=l[t]=s[t](e)),{c(){n&&n.c(),o=_()},m(e,n){~t&&l[t].m(e,n),x(e,o,n),r=!0},p(e,r){let i=t;t=a(e),t===i?~t&&l[t].p(e,r):(n&&(fe(),ve(l[i],1,1,()=>{l[i]=null}),me()),~t?(n=l[t],n||(n=l[t]=s[t](e),n.c()),ge(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(ge(n),r=!0)},o(e){ve(n),r=!1},d(e){~t&&l[t].d(e),e&&k(o)}}}function Ao(e){let t,n;return t=new Kn({props:{$$slots:{default:[zo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function qo(e){let t,n;return t=new Kn({props:{$$slots:{default:[Ro]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function zo(e){let t,n,o,r;return t=new vt({props:{ofp:e[15]}}),t.$on("save",e[4]),o=new We({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment),n=F(),xe(o.$$.fragment)},m(e,s){ke(t,e,s),x(e,n,s),ke(o,e,s),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[15]),t.$set(r);const s={};2&n&&(s.ofp=e[15]),o.$set(s)},i(e){r||(ge(t.$$.fragment,e),ge(o.$$.fragment,e),r=!0)},o(e){ve(t.$$.fragment,e),ve(o.$$.fragment,e),r=!1},d(e){we(t,e),e&&k(n),we(o,e)}}}function Ro(e){let t,n;return t=new kt({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[15]),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Do(e){let t,n;return t=new Kn({props:{$$slots:{default:[Eo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Eo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",A(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function No(e){let t,n,o,s,l,a,i,c,u,p,d,f,m;o=new In({props:{promise:e[1],route:e[0],$$slots:{default:[xo]},$$scope:{ctx:e}}}),l=new $o({props:{loaded:!!e[1]}});let g=e[1]&&ko(e);const v=[Mo,jo,_o],h=[];function y(e,t){return"/gramet"===e[0]||"/export"===e[0]?0:"/"===e[0]?1:"/help"===e[0]?2:-1}return~(c=y(e))&&(u=h[c]=v[c](e)),{c(){t=C("main"),n=C("div"),xe(o.$$.fragment),s=F(),xe(l.$$.fragment),a=F(),g&&g.c(),i=F(),u&&u.c(),O(n,"class","content svelte-1pvavz"),O(t,"class",p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz")},m(r,u){x(r,t,u),b(t,n),ke(o,n,null),b(n,s),ke(l,n,null),b(n,a),g&&g.m(n,null),b(n,i),~c&&h[c].m(n,null),d=!0,f||(m=[j(bo,"hashchange",e[3]),j(bo,"online",e[6]),j(bo,"offline",e[7])],f=!0)},p(e,[r]){const s={};2&r&&(s.promise=e[1]),1&r&&(s.route=e[0]),131079&r&&(s.$$scope={dirty:r,ctx:e}),o.$set(s);const a={};2&r&&(a.loaded=!!e[1]),l.$set(a),e[1]?g?(g.p(e,r),2&r&&ge(g,1)):(g=ko(e),g.c(),ge(g,1),g.m(n,i)):g&&(fe(),ve(g,1,1,()=>{g=null}),me());let f=c;c=y(e),c===f?~c&&h[c].p(e,r):(u&&(fe(),ve(h[f],1,1,()=>{h[f]=null}),me()),~c?(u=h[c],u||(u=h[c]=v[c](e),u.c()),ge(u,1),u.m(n,null)):u=null),(!d||1&r&&p!==(p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz"))&&O(t,"class",p)},i(e){d||(ge(o.$$.fragment,e),ge(l.$$.fragment,e),ge(g),ge(u),d=!0)},o(e){ve(o.$$.fragment,e),ve(l.$$.fragment,e),ve(g),ve(u),d=!1},d(e){e&&k(t),we(o),we(l),g&&g.d(),~c&&h[c].d(),f=!1,r(m)}}}function Wo(e,t,n){let o,r,s;a(e,Et,e=>n(12,o=e)),a(e,Dt,e=>n(13,r=e)),a(e,Nt,e=>n(14,s=e));let l="/",i=window.location.href,c=void 0;(e=>{const t={},n={};if(e.length>1){(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}))}for(let[e,o]of Object.entries(t))if(e in Ye){let t=void 0;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(Ue)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||ot.setItem(nt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&ot.setItem(nt.shortcut,o));ot.setItem(nt.optionsKML,n)})(window.location.search);let u=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Ye&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(Ue)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...Ye,...t}})(ot.getItem(nt.optionsKML)||{});const p=e=>{const t=document.querySelector("meta[name=viewport]"),r=t?t.getAttribute("content"):"";n(0,l=window.location.hash.substr(1)||"/"),c||"/map"!==l&&"/gramet"!==l&&"/export"!==l||n(0,l="/"),"/map"===l?(o&&d(Et,o=!1,o),r&&t.setAttribute("content",r+",maximum-scale=1")):r&&t.setAttribute("content",r.replace(",maximum-scale=1",""))};p();const f=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(nt)){let r=ot.getItem(o);if(n===nt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter(t=>e[t]!==Ye[t]))t[n]=e[n];r=t}if(null!==r)if(n===nt.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(u);let n=Object.entries(t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");i=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+l,history.replaceState(t,"Mon OFP2MAP",i)};f();return[l,c,u,p,f,()=>{o&&d(Et,o=!1,o),r&&d(Dt,r=!1,r),window.serviceWorker&&window.serviceWorker.update&&window.serviceWorker.update().catch(e=>{})},()=>{d(Nt,s=!0,s)},()=>{d(Nt,s=!1,s)},function(t){Z(e,t)},function(e){c=e,n(1,c)},function(e){u=e,n(2,u)}]}return new class extends Pe{constructor(e){super(),Ce(this,e,Wo,No,l,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
