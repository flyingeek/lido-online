var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function i(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o,r,s,a){const l=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(l){const r=c(t,n,o,a);e.p(r,l)}}function p(e){return null==e?"":e}function d(e,t,n=t){return e.set(n),t}function f(t){return t&&s(t.destroy)?t.destroy:e}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),v=m?e=>requestAnimationFrame(e):e;const h=new Set;function y(e){h.forEach((t=>{t.c(e)||(h.delete(t),t.f())})),0!==h.size&&v(y)}function $(e){let t;return 0===h.size&&v(y),{promise:new Promise((n=>{h.add(t={c:e,f:n})})),abort(){h.delete(t)}}}function b(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function F(){return L(" ")}function j(){return L("")}function _(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function O(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function z(e,t){e.value=null==t?"":t}function I(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function q(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function D(e,t,n){e.classList[n?"add":"remove"](t)}function R(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const E=new Set;let N,W=0;function G(e,t,n,o,r,s,a,l=0){const i=16.666/o;let c="{\n";for(let e=0;e<=1;e+=i){const o=t+(n-t)*s(e);c+=100*e+`%{${a(o,1-o)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${l}`,d=e.ownerDocument;E.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(C("style")).sheet),m=d.__svelte_rules||(d.__svelte_rules={});m[p]||(m[p]=!0,f.insertRule(`@keyframes ${p} ${u}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,W+=1,p}function H(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),W-=r,W||v((()=>{W||(E.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),E.clear())})))}function U(e){N=e}function Z(){if(!N)throw new Error("Function called outside component initialization");return N}function B(){const e=Z();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=R(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function K(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const J=[],V=[],X=[],Y=[],Q=Promise.resolve();let ee=!1;function te(){ee||(ee=!0,Q.then(ae))}function ne(e){X.push(e)}function oe(e){Y.push(e)}let re=!1;const se=new Set;function ae(){if(!re){re=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];U(t),le(t.$$)}for(U(null),J.length=0;V.length;)V.pop()();for(let e=0;e<X.length;e+=1){const t=X[e];se.has(t)||(se.add(t),t())}X.length=0}while(J.length);for(;Y.length;)Y.pop()();ee=!1,re=!1,se.clear()}}function le(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let ie;function ce(){return ie||(ie=Promise.resolve(),ie.then((()=>{ie=null}))),ie}function ue(e,t,n){e.dispatchEvent(R(`${t?"intro":"outro"}${n}`))}const pe=new Set;let de;function fe(){de={r:0,c:[],p:de}}function me(){de.r||r(de.c),de=de.p}function ge(e,t){e&&e.i&&(pe.delete(e),e.i(t))}function ve(e,t,n,o){if(e&&e.o){if(pe.has(e))return;pe.add(e),de.c.push((()=>{pe.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const he={duration:0};function ye(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let a=t.ctx;void 0!==r&&(a=a.slice(),a[r]=s);const l=e&&(t.current=e)(a);let i=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(fe(),ve(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),me())})):t.block.d(1),l.c(),ge(l,1),l.m(t.mount(),t.anchor),i=!0),t.block=l,t.blocks&&(t.blocks[o]=l),i&&ae()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=Z();if(e.then((e=>{U(n),o(t.then,1,t.value,e),U(null)}),(e=>{if(U(n),o(t.catch,2,t.error,e),U(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const $e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function be(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function xe(e){e&&e.c()}function ke(e,t,o){const{fragment:a,on_mount:l,on_destroy:i,after_update:c}=e.$$;a&&a.m(t,o),ne((()=>{const t=l.map(n).filter(s);i?i.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(ne)}function we(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(t,n,s,a,l,i,c=[-1]){const u=N;U(t);const p=t.$$={fragment:null,ctx:null,props:i,update:e,not_equal:l,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=s?s(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),te(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(k)}else p.fragment&&p.fragment.c();n.intro&&ge(t.$$.fragment),ke(t,n.target,n.anchor),ae()}U(u)}class Pe{$destroy(){we(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Le{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Fe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,je=matchMedia("(hover: hover)").matches;function _e(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function Me(e,t,n){return e<=t?t:e>=n?n:e}function Te(e,t,n){return!(e<t)&&!(e>n)}function Se(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Oe(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function ze(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Ie(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const Ae=(e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n};function qe(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function De(e){let t;return{c(){t=C("textarea"),t.value=e[0],T(t,"class","svelte-12a0ij3")},m(n,o){x(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&k(t),e[6](null)}}}function Re(t){let n,o,r;return{c(){n=C("a"),n.textContent="copier la route",T(n,"role","button"),T(n,"class","btn btn-primary svelte-12a0ij3"),T(n,"href","lhs-mpilot://")},m(e,s){x(e,n,s),o||(r=_(n,"click",t[4]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function Ee(t){let n,o,r,s,a;return{c(){n=C("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=C("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',T(n,"role","button"),T(n,"class","btn btn-primary svelte-12a0ij3"),T(n,"href","lhs-mpilot://"),T(r,"class","card-text")},m(e,l){x(e,n,l),x(e,o,l),x(e,r,l),s||(a=_(n,"click",t[4]),s=!0)},p:e,d(e){e&&k(n),e&&k(o),e&&k(r),s=!1,a()}}}function Ne(n){let o,a,l;return{c(){o=C("span"),o.textContent="copié!",T(o,"class","svelte-12a0ij3")},m(e,t){x(e,o,t),l=!0},i(e){l||(a&&a.end(1),l=!0)},o(n){a=function(n,o,a){let l,i=o(n,a),c=!0;const u=de;function p(){const{delay:o=0,duration:s=300,easing:a=t,tick:p=e,css:d}=i||he;d&&(l=G(n,1,0,s,o,a,d));const f=g()+o,m=f+s;ne((()=>ue(n,!1,"start"))),$((e=>{if(c){if(e>=m)return p(0,1),ue(n,!1,"end"),--u.r||r(u.c),!1;if(e>=f){const t=a((e-f)/s);p(1-t,t)}}return c}))}return u.r+=1,s(i)?ce().then((()=>{i=i(),p()})):p(),{end(e){e&&i.tick&&i.tick(1,0),c&&(l&&H(n,l),c=!1)}}}(o,qe,{}),l=!1},d(e){e&&k(o),e&&a&&a.end()}}}function We(e){let t,n,o,r,s,a,l,i,c,u,p,d,f=null!=e[0]&&De(e);let m=(Fe?Ee:Re)(e),g=e[2]&&Ne();return{c(){f&&f.c(),t=F(),n=C("div"),o=C("div"),r=C("h5"),r.textContent="Route Lido",s=F(),a=C("p"),a.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",l=F(),m.c(),i=F(),c=C("div"),u=L(e[3]),p=F(),g&&g.c(),T(r,"class","card-title"),T(a,"class","card-text"),T(c,"class","text-monospace svelte-12a0ij3"),T(o,"class","card-body"),T(n,"class","card mb-3 svelte-12a0ij3")},m(e,v){f&&f.m(e,v),x(e,t,v),x(e,n,v),b(n,o),b(o,r),b(o,s),b(o,a),b(o,l),m.m(o,null),b(o,i),b(o,c),b(c,u),b(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?f?f.p(e,n):(f=De(e),f.c(),f.m(t.parentNode,t)):f&&(f.d(1),f=null),m.p(e,n),e[2]?g?4&n&&ge(g,1):(g=Ne(),g.c(),ge(g,1),g.m(c,null)):g&&(fe(),ve(g,1,1,(()=>{g=null})),me())},i(e){d||(ge(g),d=!0)},o(e){ve(g),d=!1},d(e){f&&f.d(e),e&&k(t),e&&k(n),m.d(),g&&g.d()}}}let Ge=!1;try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Ge=!0)}))}catch(e){}function He(e,t,n){let o,{ofp:r}=t,s=null;const a=r?r.lidoRoute().join(" "):"";let l=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,l,a,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Ge)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await(te(),Q),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(a);Fe||(n(2,l=t),setTimeout((function(){n(2,l=!1)}),3e3),e.preventDefault())},r,function(e){V[e?"unshift":"push"]((()=>{o=e,n(1,o)}))}]}class Ue extends Pe{constructor(e){super(),Ce(this,e,He,We,a,{ofp:5})}}function Ze(t){let n,o,a,l,i,c,u,p,d,m,g,v,h,y,$,w,P,j,M;return{c(){n=C("kmlcolor"),o=C("div"),a=C("label"),l=L("Couleur"),i=F(),c=C("picker"),u=C("label"),p=C("input"),g=F(),v=C("input"),y=F(),$=C("input"),T(a,"for",t[1]),T(a,"class","input-group-text svelte-1hvk4hi"),T(o,"class","input-group-prepend"),T(p,"type","color"),T(p,"class","svelte-1hvk4hi"),T(u,"style",d=Xe(t[2])),T(u,"class","svelte-1hvk4hi"),T(v,"type","range"),T(v,"min","30"),T(v,"max","255"),T(v,"class","svelte-1hvk4hi"),T(c,"class","form-control svelte-1hvk4hi"),T(c,"style",h=Ve(t[2][0])),T($,"name",t[1]),T($,"class","form-control text-monospace svelte-1hvk4hi"),T($,"style",w=Ye(t[0])),T($,"type","text"),T($,"maxlength","8"),T(n,"class","input-group svelte-1hvk4hi")},m(e,r){x(e,n,r),b(n,o),b(o,a),b(a,l),b(n,i),b(n,c),b(c,u),b(u,p),z(p,t[2][0]),b(c,g),b(c,v),z(v,t[2][1]),b(n,y),b(n,$),z($,t[0]),j||(M=[_(p,"input",t[5]),f(m=t[4].call(null,u,t[0])),_(v,"change",t[6]),_(v,"input",t[6]),f(P=t[3].call(null,$,t[2])),_($,"input",t[7])],j=!0)},p(e,[t]){2&t&&T(a,"for",e[1]),4&t&&z(p,e[2][0]),4&t&&d!==(d=Xe(e[2]))&&T(u,"style",d),m&&s(m.update)&&1&t&&m.update.call(null,e[0]),4&t&&z(v,e[2][1]),4&t&&h!==(h=Ve(e[2][0]))&&T(c,"style",h),2&t&&T($,"name",e[1]),1&t&&w!==(w=Ye(e[0]))&&T($,"style",w),P&&s(P.update)&&4&t&&P.update.call(null,e[2]),1&t&&$.value!==e[0]&&z($,e[0])},i:e,o:e,d(e){e&&k(n),j=!1,r(M)}}}const Be=/^[A-F0-9]{8}$/i,Ke=e=>{let[t,n]=Je(e);return[t,n/255]},Je=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},Ve=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Xe=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Ye=e=>e.match(Be)?"":"border-color: #F00;";function Qe(e,t,n){const o=B();let r,{kmlColor:s="FF0000FF"}=t,{name:a}=t;try{r=Je(s)}catch(e){r=["#FF0000",255]}const l=function(e,t,n){let o;return function(){const r=this,s=arguments,a=function(){o=null,n||e.apply(r,s)},l=n&&!o;clearTimeout(o),o=setTimeout(a,t),l&&e.apply(r,s)}}(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,a=e.name)},[s,a,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),l("change",{name:a,value:s})}}},function(e){return{update(e){if(e.match(Be)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),l("change",{name:a,value:e.toUpperCase()})}}}},function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?null:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class et extends Pe{constructor(e){super(),Ce(this,e,Qe,Ze,a,{kmlColor:0,name:1})}}const tt={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC"};function nt(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const ot=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,nt(window.kmlGen,tt)),window.kmlGen);function rt(e,t){let n={...tt,...t};const o=ot();nt(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,a=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),l=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),i=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",i),o.addLine("rmain",a),o.addPoints("rmain",a,{excluded:c}),o.addLine("ralt",l),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",l)}const st=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),at=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function lt(t){let n,o,s,a,l,i,c,u,p,d;return{c(){n=C("div"),o=C("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',s=F(),a=C("input"),l=F(),i=C("div"),c=C("a"),u=L("Lancer"),T(o,"class","input-group-prepend"),T(a,"class","form-control svelte-1ecyaux"),T(a,"placeholder","Nom du raccourci"),T(a,"type","text"),T(c,"class","btn btn-outline-secondary svelte-1ecyaux"),T(c,"href",t[1]),D(c,"disabled",!(t[0].trim()&&Fe)),T(i,"class","input-group-append"),T(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,a),z(a,t[0]),b(n,l),b(n,i),b(i,c),b(c,u),p||(d=[_(a,"input",t[5]),_(a,"change",t[3]),_(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&a.value!==e[0]&&z(a,e[0]),2&t&&T(c,"href",e[1]),1&t&&D(c,"disabled",!(e[0].trim()&&Fe))},i:e,o:e,d(e){e&&k(n),p=!1,r(d)}}}const it="OFP2MAP";function ct(e,t,n){const o=B(),r=st.shortcut;let s,a=at.getItem(r)||it,{ofp:l}=t;const i=l?l.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,l=e.ofp)},[a,s,function(e){const t=a.trim();if(t&&Fe){const e=ot(),o={lidoRoute:i,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:l.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=a.trim();e===it?at.removeItem(r):at.setItem(r,e),o("save",[r,e])},l,function(){a=this.value,n(0,a)}]}class ut extends Pe{constructor(e){super(),Ce(this,e,ct,lt,a,{ofp:4})}}const pt=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function s(e,t){return e.getElementsByTagName(t)}function a(e,t){return e.getAttribute(t)}function l(e,t){return parseFloat(a(e,t))}function i(e,t){var n=s(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function p(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=i(e,t[o]))&&(r[t[o]]=u(n));return r}function d(e,t){for(var n in t)e[n]=t[n]}function f(e){return c(e.replace(t,"").split(","))}function m(e){for(var t=e.replace(n,"").split(o),r=[],s=0;s<t.length;s++)r.push(f(t[s]));return r}function g(e){var t,n=[l(e,"lon"),l(e,"lat")],o=i(e,"ele"),r=i(e,"gpxtpx:hr")||i(e,"hr"),s=i(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:s?u(s):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},l={},p=["Polygon","LineString","Point","Track","gx:Track"],d=s(e,"Placemark"),g=s(e,"Style"),h=s(e,"StyleMap"),y=0;y<g.length;y++){var $=r(v(g[y])).toString(16);n["#"+a(g[y],"id")]=$,o[$]=g[y]}for(var b=0;b<h.length;b++){n["#"+a(h[b],"id")]=r(v(h[b])).toString(16);for(var x=s(h[b],"Pair"),k={},w=0;w<x.length;w++)k[u(i(x[w],"key"))]=u(i(x[w],"styleUrl"));l["#"+a(h[b],"id")]=k}for(var C=0;C<d.length;C++)t.features=t.features.concat(j(d[C]));function P(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function L(e){var t=s(e,"coord"),n=[],o=[];0===t.length&&(t=s(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var a=s(e,"when"),l=0;l<a.length;l++)o.push(u(a[l]));return{coords:n,times:o}}function F(e){var t,n,o,r,a,l=[],c=[];if(i(e,"MultiGeometry"))return F(i(e,"MultiGeometry"));if(i(e,"MultiTrack"))return F(i(e,"MultiTrack"));if(i(e,"gx:MultiTrack"))return F(i(e,"gx:MultiTrack"));for(o=0;o<p.length;o++)if(n=s(e,p[o]))for(r=0;r<n.length;r++)if(t=n[r],"Point"===p[o])l.push({type:"Point",coordinates:f(u(i(t,"coordinates")))});else if("LineString"===p[o])l.push({type:"LineString",coordinates:m(u(i(t,"coordinates")))});else if("Polygon"===p[o]){var d=s(t,"LinearRing"),g=[];for(a=0;a<d.length;a++)g.push(m(u(i(d[a],"coordinates"))));l.push({type:"Polygon",coordinates:g})}else if("Track"===p[o]||"gx:Track"===p[o]){var v=L(t);l.push({type:"LineString",coordinates:v.coords}),v.times.length&&c.push(v.times)}return{geoms:l,coordTimes:c}}function j(e){var t,r=F(e),c={},p=u(i(e,"name")),d=u(i(e,"address")),f=u(i(e,"styleUrl")),m=u(i(e,"description")),g=i(e,"TimeSpan"),v=i(e,"TimeStamp"),h=i(e,"ExtendedData"),y=i(e,"LineStyle"),$=i(e,"PolyStyle"),b=i(e,"visibility");if(!r.geoms.length)return[];if(p&&(c.name=p),d&&(c.address=d),f){"#"!==f[0]&&(f="#"+f),c.styleUrl=f,n[f]&&(c.styleHash=n[f]),l[f]&&(c.styleMapHash=l[f],c.styleHash=n[l[f].normal]);var x=o[c.styleHash];if(x){y||(y=i(x,"LineStyle")),$||($=i(x,"PolyStyle"));var k=i(x,"IconStyle");if(k){var w=i(k,"Icon");if(w){var C=u(i(w,"href"));C&&(c.icon=C)}}}}if(m&&(c.description=m),g){var L=u(i(g,"begin")),j=u(i(g,"end"));c.timespan={begin:L,end:j}}if(v&&(c.timestamp=u(i(v,"when"))),y){var _=P(u(i(y,"color"))),M=_[0],T=_[1],S=parseFloat(u(i(y,"width")));M&&(c.stroke=M),isNaN(T)||(c["stroke-opacity"]=T),isNaN(S)||(c["stroke-width"]=S)}if($){var O=P(u(i($,"color"))),z=O[0],I=O[1],A=u(i($,"fill")),q=u(i($,"outline"));z&&(c.fill=z),isNaN(I)||(c["fill-opacity"]=I),A&&(c["fill-opacity"]="1"===A?c["fill-opacity"]||1:0),q&&(c["stroke-opacity"]="1"===q?c["stroke-opacity"]||1:0)}if(h){var D=s(h,"Data"),R=s(h,"SimpleData");for(t=0;t<D.length;t++)c[D[t].getAttribute("name")]=u(i(D[t],"value"));for(t=0;t<R.length;t++)c[R[t].getAttribute("name")]=u(R[t])}b&&(c.visibility=u(b)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var E={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return a(e,"id")&&(E.id=a(e,"id")),[E]}return t},gpx:function(e){var t,n,o=s(e,"trk"),r=s(e,"rte"),l=s(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=v(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=h(r[t]))&&c.features.push(n);for(t=0;t<l.length;t++)c.features.push(y(l[t]));function f(e,t){for(var n=0;n<t;n++)e.push(null);return e}function m(e,t){var n=s(e,t),o=[],r=[],a=[],l=n.length;if(l<2)return{};for(var i=0;i<l;i++){var c=g(n[i]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||a.length)&&(a.length||f(a,i),a.push(c.heartRate||null))}return{line:o,times:r,heartRates:a}}function v(e){for(var t,n=s(e,"trkseg"),o=[],r=[],a=[],l=0;l<n.length;l++)if((t=m(n[l],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),a.length||t.heartRates&&t.heartRates.length)){if(!a.length)for(var c=0;c<l;c++)a.push(f([],o[c].length));t.heartRates&&t.heartRates.length?a.push(t.heartRates):a.push(f([],t.line.length||0))}if(0!==o.length){var u=b(e);return d(u,$(i(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),a.length&&(u.heartRates=1===o.length?a[0]:a),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function h(e){var t=m(e,"rtept");if(t.line){var n=b(e);return d(n,$(i(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=b(e);return d(t,p(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function $(e){var t={};if(e){var n=i(e,"line");if(n){var o=u(i(n,"color")),r=parseFloat(u(i(n,"opacity"))),s=parseFloat(u(i(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(s)||(t["stroke-width"]=96*s/25.4)}}return t}function b(e){var t=p(e,["name","cmt","desc","type","time","keywords"]),n=s(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)d(o={href:a(n[r],"href")},p(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function dt(t){let n,o,s,a,l,i,c,u,p,d,f,m,g,v,h,y,$,w=gt[0]+"",P=gt[1]+"",j=gt[2]+"";return{c(){n=C("div"),o=C("select"),s=C("option"),a=L(w),i=C("option"),c=L(P),p=C("option"),d=L(j),m=F(),g=C("div"),v=C("a"),h=L(t[0]),s.selected=l=0===t[1],s.__value=0,s.value=s.__value,i.selected=u=1===t[1],i.__value=1,i.value=i.__value,p.selected=f=2===t[1],p.__value=2,p.value=p.__value,T(o,"class","custom-select svelte-19hokx5"),T(o,"aria-label","Example select with button addon"),void 0===t[1]&&ne((()=>t[6].call(o))),T(v,"class","btn btn-success"),T(v,"download",t[3]),T(v,"href",t[2]),T(v,"target",ft),T(g,"class","input-group-append"),T(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(o,s),b(s,a),b(o,i),b(i,c),b(o,p),b(p,d),A(o,t[1]),b(n,m),b(n,g),b(g,v),b(v,h),y||($=[_(o,"change",t[6]),_(o,"change",t[5]),_(v,"click",t[4])],y=!0)},p(e,[t]){2&t&&l!==(l=0===e[1])&&(s.selected=l),2&t&&u!==(u=1===e[1])&&(i.selected=u),2&t&&f!==(f=2===e[1])&&(p.selected=f),2&t&&A(o,e[1]),1&t&&O(h,e[0]),8&t&&T(v,"download",e[3]),4&t&&T(v,"href",e[2])},i:e,o:e,d(e){e&&k(n),y=!1,r($)}}}const ft=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,mt=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},gt=["KML Mapsme","KML Avenza","GeoJson"];function vt(e,t,n){const o=B();let{label:r}=t;const s=st.downloadType;let a=at.getItem(s)||1;"string"==typeof a&&(a=parseInt(a,10));let l="",i="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,a,l,i,function(e){const t=ot(),o=["_mapsme.kml","_avenza.kml",".geojson"][a];let r=t.name;if(r?(r=r.trim(),n(3,i=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,i="editolido"+o),0===a)n(2,l=mt(t.render()));else if(1===a)n(2,l=mt(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==a)return e.preventDefault(),!1;n(2,l=mt(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return pt.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===a?at.removeItem(s):at.setItem(s,a),o("save",[s,a])},function(){a=q(this),n(1,a)}]}class ht extends Pe{constructor(e){super(),Ce(this,e,vt,dt,a,{label:0})}}function yt(e){let t,n,o,r,s,a,l,i,c,u,p,d,f,m,g;return l=new ht({props:{label:"Télécharger"}}),l.$on("save",e[1]),d=new ut({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=C("div"),n=C("div"),o=C("h5"),o.textContent="Export",r=F(),s=C("div"),a=C("div"),xe(l.$$.fragment),i=F(),c=C("small"),c.textContent="Le fichier est généré en fonction des options choisies sur la carte.",u=F(),p=C("div"),xe(d.$$.fragment),f=F(),m=C("small"),m.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',T(o,"class","card-title"),T(c,"class","text-muted"),T(a,"class","col-12 col-sm-6 col-md-6"),T(m,"class","text-muted"),T(p,"class","col-12 col-sm-6 col-md-6"),T(s,"class","row"),T(n,"class","card-body"),T(t,"class","card mb-3 svelte-17snbjk")},m(e,v){x(e,t,v),b(t,n),b(n,o),b(n,r),b(n,s),b(s,a),ke(l,a,null),b(a,i),b(a,c),b(s,u),b(s,p),ke(d,p,null),b(p,f),b(p,m),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||(ge(l.$$.fragment,e),ge(d.$$.fragment,e),g=!0)},o(e){ve(l.$$.fragment,e),ve(d.$$.fragment,e),g=!1},d(e){e&&k(t),we(l),we(d)}}}function $t(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){K(e,t)},function(t){K(e,t)}]}class bt extends Pe{constructor(e){super(),Ce(this,e,$t,yt,a,{ofp:0})}}function xt(e){let t;return{c(){t=C("div"),t.innerHTML='<span class="sr-only">Loading...</span>',T(t,"class","spinner-border text-warning"),T(t,"role","status")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function kt(e){let t,n,o,r,s,a,l,i,c,u,p;return{c(){t=C("div"),n=C("p"),o=L("😱: Erreur de récupération du Gramet, "),r=C("a"),r.textContent="essayez à nouveau",s=L(" ou allez sur "),a=C("a"),l=L("ogimet"),c=L("."),T(r,"href","."),T(a,"href",i=e[0].ogimetData.url),T(a,"target","_blank"),T(n,"class","svelte-i1m2fr"),T(t,"class","error svelte-i1m2fr")},m(i,d){x(i,t,d),b(t,n),b(n,o),b(n,r),b(n,s),b(n,a),b(a,l),b(n,c),u||(p=_(r,"click",M(e[4])),u=!0)},p(e,t){1&t&&i!==(i=e[0].ogimetData.url)&&T(a,"href",i)},d(e){e&&k(t),u=!1,p()}}}function wt(e){let t,n,o,s;return{c(){t=C("img"),T(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&T(t,"src",n),T(t,"alt","gramet demo"),T(t,"class","img-fluid svelte-i1m2fr")},m(n,r){x(n,t,r),o||(s=[_(t,"error",e[2]),_(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&T(t,"src",n)},d(e){e&&k(t),o=!1,r(s)}}}function Ct(t){let n,o,r,s,a,l,i,c,u,p,d,f,m,g,v,h,y,$,w,P,j,_="loading"===t[1]&&xt();function M(e,t){return"error"!==e[1]?wt:kt}let S=M(t),O=S(t);return{c(){n=C("div"),o=C("h1"),o.innerHTML='Le GRAMET est un météogramme représentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et à l&#39;heure de passage estimée, une coupe verticale de la météo prévue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interprétation</a>',r=F(),s=C("div"),_&&_.c(),a=F(),O.c(),l=F(),i=C("div"),c=C("div"),u=C("div"),p=C("div"),d=C("div"),d.textContent="Route Ogimet",f=F(),m=C("div"),g=C("p"),v=L("Le GRAMET est réalisé par "),h=C("a"),y=L("www.ogimet.com"),w=L(" à partir\n    d'une route calculée. Il est possible d'afficher la route sur la carte. Celà est\n    particulièrement utile lors des vols océaniques car il n'y a aucune station en mer."),P=F(),j=C("div"),j.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Après avoir sélectionner les stations météo proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectué pour réduire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',T(o,"class","svelte-i1m2fr"),T(s,"class","text-center svelte-i1m2fr"),T(d,"class","card-header svelte-i1m2fr"),T(h,"class","text-warning"),T(h,"href",$=t[0].ogimetData.url),T(h,"target","_blank"),T(g,"class","card-text"),T(m,"class","card-body"),T(p,"class","card ogimet svelte-i1m2fr"),T(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),T(j,"class","col-12 col-sm-6 col-md-6 col-xl-6"),T(c,"class","card-deck"),T(i,"class","row")},m(e,t){x(e,n,t),b(n,o),b(n,r),b(n,s),_&&_.m(s,null),b(s,a),O.m(s,null),b(n,l),b(n,i),b(i,c),b(c,u),b(u,p),b(p,d),b(p,f),b(p,m),b(m,g),b(g,v),b(g,h),b(h,y),b(g,w),b(c,P),b(c,j)},p(e,[t]){"loading"===e[1]?_||(_=xt(),_.c(),_.m(s,a)):_&&(_.d(1),_=null),S===(S=M(e))&&O?O.p(e,t):(O.d(1),O=S(e),O&&(O.c(),O.m(s,null))),1&t&&$!==($=e[0].ogimetData.url)&&T(h,"href",$)},i:e,o:e,d(e){e&&k(n),_&&_.d(),O.d()}}}function Pt(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class Lt extends Pe{constructor(e){super(),Ce(this,e,Pt,Ct,a,{ofp:0})}}function Ft(t){let n,o,r;return{c(){n=C("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-2y0613"/> en KML/GeoJSON',o=F(),r=C("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card avenza svelte-2y0613"><div class="card-header svelte-2y0613">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card mapsme svelte-2y0613"><div class="card-header svelte-2y0613">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le thème par défaut s&#39;accorde parfaitement avec les fichiers avions, également compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card ogimet svelte-2y0613"><div class="card-header svelte-2y0613">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card shortcuts svelte-2y0613"><div class="card-header svelte-2y0613">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Récupérez le KML, le Gramet, et une route Lido optimisée dans l&#39;app Raccourcis</p></div></div></div></div>',T(n,"class","text-center svelte-2y0613"),T(r,"class","row svelte-2y0613")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r)}}}class jt extends Pe{constructor(e){super(),Ce(this,e,null,Ft,a,{})}}function _t(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Mt(e){let t,n,o,r=e[4].label+"";return{c(){t=C("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function Tt(t){let n,o,a,l,i,c,u,p,d,f,m,g,v=St,h=[];for(let e=0;e<v.length;e+=1)h[e]=Mt(_t(t,v,e));return{c(){n=C("div"),o=C("div"),a=C("label"),l=L("Repère"),i=F(),c=C("span"),u=P("svg"),p=P("use"),d=F(),f=C("select");for(let e=0;e<h.length;e+=1)h[e].c();T(a,"class","input-group-text svelte-1j0ign2"),T(a,"for",t[1]),S(p,"xlink:href","#marker"),I(p,"stroke",0===t[0]?"#fff":"#000"),I(p,"fill",St[t[0]].color),T(u,"class","svelte-1j0ign2"),T(c,"class","input-group-text svelte-1j0ign2"),T(o,"class","input-group-prepend"),T(f,"name",t[1]),T(f,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ne((()=>t[3].call(f))),T(n,"class","input-group svelte-1j0ign2")},m(e,r){x(e,n,r),b(n,o),b(o,a),b(a,l),b(o,i),b(o,c),b(c,u),b(u,p),b(n,d),b(n,f);for(let e=0;e<h.length;e+=1)h[e].m(f,null);A(f,t[0]),m||(g=[_(f,"change",t[3]),_(f,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],m=!0)},p(e,[n]){if(t=e,2&n&&T(a,"for",t[1]),1&n&&I(p,"stroke",0===t[0]?"#fff":"#000"),1&n&&I(p,"fill",St[t[0]].color),1&n){let e;for(v=St,e=0;e<v.length;e+=1){const o=_t(t,v,e);h[e]?h[e].p(o,n):(h[e]=Mt(o),h[e].c(),h[e].m(f,null))}for(;e<h.length;e+=1)h[e].d(1);h.length=v.length}2&n&&T(f,"name",t[1]),1&n&&A(f,t[0])},i:e,o:e,d(e){e&&k(n),w(h,e),m=!1,r(g)}}}const St=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Ot(e,t,n){const o=B();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=q(this),n(0,r)}]}class zt extends Pe{constructor(e){super(),Ce(this,e,Ot,Tt,a,{selected:0,name:1})}}function It(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function At(e){let t,n,o,r=e[4].label+"";return{c(){t=C("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function qt(t){let n,o,a,l,i,c,u,p,d=Dt,f=[];for(let e=0;e<d.length;e+=1)f[e]=At(It(t,d,e));return{c(){n=C("div"),o=C("div"),a=C("label"),l=L("Couleur"),i=F(),c=C("select");for(let e=0;e<f.length;e+=1)f[e].c();T(a,"class","input-group-text svelte-90luj4"),T(a,"for",t[1]),T(o,"class","input-group-prepend"),T(c,"name",t[1]),T(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ne((()=>t[3].call(c))),T(n,"class","input-group svelte-90luj4")},m(e,r){x(e,n,r),b(n,o),b(o,a),b(a,l),b(n,i),b(n,c);for(let e=0;e<f.length;e+=1)f[e].m(c,null);A(c,t[0]),u||(p=[_(c,"change",t[3]),_(c,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],u=!0)},p(e,[n]){if(t=e,2&n&&T(a,"for",t[1]),1&n){let e;for(d=Dt,e=0;e<d.length;e+=1){const o=It(t,d,e);f[e]?f[e].p(o,n):(f[e]=At(o),f[e].c(),f[e].m(c,null))}for(;e<f.length;e+=1)f[e].d(1);f.length=d.length}2&n&&T(c,"name",t[1]),1&n&&A(c,t[0])},i:e,o:e,d(e){e&&k(n),w(f,e),u=!1,r(p)}}}const Dt=[{label:"statuts"},{label:"vert/rouge"}];function Rt(e,t,n){const o=B();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=q(this),n(0,r)}]}class Et extends Pe{constructor(e){super(),Ce(this,e,Rt,qt,a,{selected:0,name:1})}}const Nt=[];function Wt(t,n=e){let o;const r=[];function s(e){if(a(t,e)&&(t=e,o)){const e=!Nt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Nt.push(n,t)}if(e){for(let e=0;e<Nt.length;e+=2)Nt[e][0](Nt[e+1]);Nt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(a,l=e){const i=[a,l];return r.push(i),1===r.length&&(o=n(s)||e),a(t),()=>{const e=r.indexOf(i);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const Gt=Wt(!1),Ht=Wt(!1),Ut=Wt(navigator.onLine);function Zt(t){let n,o,r;return{c(){n=C("button"),n.textContent="Revenir aux valeurs par défaut",T(n,"class","btn btn-link btn-sm float-right"),T(n,"type","button")},m(e,s){x(e,n,s),o||(r=_(n,"click",t[7]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function Bt(e){let t,n,o,s,a,l,i,c,u,d,f,m,g,v,h,y,$,w,j,O,z,I,A,q,R,E,N,W,G,H,U,Z,B,K,J,V,X,Y,Q,ee,te,ne,oe,re,se,ae,le,ie,ce,ue,pe,de,fe,me,he,ye,$e,be,Ce,Pe,Le,Fe,je,_e,Me,Te,Se,Oe,ze,Ie,Ae,qe,De,Re,Ee,Ne,We,Ge,He,Ue,Ze,Be,Ke,Je,Ve,Xe,Ye,Qe,tt,nt,ot,rt,st,at,lt,it,ct,ut,pt,dt,ft,mt,gt,vt,ht,yt,$t,bt,xt,kt,wt,Ct,Pt,Lt,Ft,jt,_t,Mt,Tt,St,Ot,It,At,qt,Dt,Rt,Nt,Wt,Gt,Ht,Ut;y=new et({props:{name:"route-color",kmlColor:e[0].routeColor}}),y.$on("change",e[6]),O=new zt({props:{name:"route-pin",selected:e[0].routePin}}),O.$on("change",e[6]),U=new et({props:{name:"alternate-color",kmlColor:e[0].alternateColor}}),U.$on("change",e[6]),J=new zt({props:{name:"alternate-pin",selected:e[0].alternatePin}}),J.$on("change",e[6]),ae=new et({props:{name:"nat-color",kmlColor:e[0].natColor}}),ae.$on("change",e[6]),de=new zt({props:{name:"nat-pin",selected:e[0].natPin}}),de.$on("change",e[6]),Se=new et({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}}),Se.$on("change",e[6]),He=new et({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}}),He.$on("change",e[6]),rt=new et({props:{name:"etops-color",kmlColor:e[0].etopsColor}}),rt.$on("change",e[6]),vt=new Et({props:{name:"airport-pin",selected:e[0].airportPin}}),vt.$on("change",e[6]);let Bt=!e[3]&&Zt(e);return{c(){t=C("div"),n=C("a"),o=P("svg"),s=P("use"),a=F(),l=C("a"),i=P("svg"),c=P("use"),u=F(),d=C("form"),f=C("fieldset"),m=C("legend"),m.textContent="Route",g=F(),v=C("div"),h=C("div"),xe(y.$$.fragment),w=F(),j=C("div"),xe(O.$$.fragment),I=F(),A=C("fieldset"),q=C("legend"),R=C("input"),N=L("Dégagement"),W=F(),G=C("div"),H=C("div"),xe(U.$$.fragment),B=F(),K=C("div"),xe(J.$$.fragment),X=F(),Y=C("fieldset"),Q=C("legend"),ee=C("input"),ne=L("Tracks"),oe=F(),re=C("div"),se=C("div"),xe(ae.$$.fragment),le=F(),ie=C("small"),ie.textContent="Un track incomplet restera rouge.",ue=F(),pe=C("div"),xe(de.$$.fragment),fe=F(),me=C("small"),me.textContent="Positionné à l'entrée des tracks.",ye=F(),$e=C("div"),be=C("div"),Ce=C("fieldset"),Pe=C("legend"),Le=C("input"),je=L("Orthodromie"),_e=F(),Me=C("div"),Te=C("div"),xe(Se.$$.fragment),ze=F(),Ie=C("div"),Ae=C("fieldset"),qe=C("legend"),De=C("input"),Ee=L("Route du GRAMET"),Ne=F(),We=C("div"),Ge=C("div"),xe(He.$$.fragment),Ze=F(),Be=C("div"),Ke=C("div"),Je=C("fieldset"),Ve=C("legend"),Xe=C("input"),Qe=L("Etops"),tt=F(),nt=C("div"),ot=C("div"),xe(rt.$$.fragment),at=F(),lt=C("div"),it=C("fieldset"),ct=C("legend"),ut=C("input"),dt=L("Airports"),ft=F(),mt=C("div"),gt=C("div"),xe(vt.$$.fragment),yt=F(),$t=C("div"),bt=C("div"),xt=C("fieldset"),kt=C("legend"),wt=C("input"),Pt=L("FIR SÛRETÉ"),Ft=F(),jt=C("div"),_t=C("div"),Mt=C("button"),Tt=L("Mémoriser"),Ot=F(),It=C("button"),At=L("Restaurer"),Rt=F(),Nt=C("div"),Bt&&Bt.c(),S(s,"xlink:href","#bars"),T(o,"class","svelte-qfeyuc"),D(o,"blink",e[2]),T(n,"class","hamburger svelte-qfeyuc"),T(n,"role","button"),T(n,"href","."),S(c,"xlink:href","#close"),T(i,"class","svelte-qfeyuc"),D(i,"blink",e[2]),T(l,"class","closeB svelte-qfeyuc"),T(l,"role","button"),T(l,"href","."),T(m,"class","svelte-qfeyuc"),T(h,"class",$=p(e[1])+" svelte-qfeyuc"),T(j,"class",z=p(e[1])+" svelte-qfeyuc"),T(v,"class","row"),T(f,"class","form-group svelte-qfeyuc"),T(R,"name","alternate-display"),R.checked=E=e[0].alternateDisplay,T(R,"type","checkbox"),T(R,"class","svelte-qfeyuc"),T(q,"class","svelte-qfeyuc"),T(H,"class",Z=p(e[1])+" svelte-qfeyuc"),T(K,"class",V=p(e[1])+" svelte-qfeyuc"),T(G,"class","row"),T(A,"class","form-group svelte-qfeyuc"),T(ee,"name","nat-display"),ee.checked=te=e[0].natDisplay,T(ee,"type","checkbox"),T(ee,"class","svelte-qfeyuc"),T(Q,"class","svelte-qfeyuc"),T(ie,"class","form-text text-muted svelte-qfeyuc"),T(se,"class",ce=p(e[1])+" svelte-qfeyuc"),T(me,"class","form-text text-muted svelte-qfeyuc"),T(pe,"class",he=p(e[1])+" svelte-qfeyuc"),T(re,"class","row"),T(Y,"class","form-group svelte-qfeyuc"),T(Le,"name","great-circle-display"),Le.checked=Fe=e[0].greatCircleDisplay,T(Le,"type","checkbox"),T(Le,"class","svelte-qfeyuc"),T(Pe,"class","svelte-qfeyuc"),T(Te,"class","col"),T(Me,"class","row"),T(Ce,"class","form-group svelte-qfeyuc"),T(be,"class",Oe=p(e[1])+" svelte-qfeyuc"),T(De,"name","ogimet-display"),De.checked=Re=e[0].ogimetDisplay,T(De,"type","checkbox"),T(De,"class","svelte-qfeyuc"),T(qe,"class","svelte-qfeyuc"),T(Ge,"class","col"),T(We,"class","row"),T(Ae,"class","form-group svelte-qfeyuc"),T(Ie,"class",Ue=p(e[1])+" svelte-qfeyuc"),T($e,"class","row"),T(Xe,"name","etops-display"),Xe.checked=Ye=e[0].etopsDisplay,T(Xe,"type","checkbox"),T(Xe,"class","svelte-qfeyuc"),T(Ve,"class","svelte-qfeyuc"),T(ot,"class","col"),T(nt,"class","row"),T(Je,"class","form-group svelte-qfeyuc"),T(Ke,"class",st=p(e[1])+" svelte-qfeyuc"),T(ut,"name","airport-display"),ut.checked=pt=e[0].airportDisplay,T(ut,"type","checkbox"),T(ut,"class","svelte-qfeyuc"),T(ct,"class","svelte-qfeyuc"),T(gt,"class","col"),T(mt,"class","row"),T(it,"class","form-group svelte-qfeyuc"),T(lt,"class",ht=p(e[1])+" svelte-qfeyuc"),T(Be,"class","row"),T(wt,"name","fir-display"),wt.checked=Ct=e[0].firDisplay,T(wt,"type","checkbox"),T(wt,"class","svelte-qfeyuc"),T(kt,"class","svelte-qfeyuc"),T(xt,"class","form-group svelte-qfeyuc"),T(bt,"class",Lt=p(e[1])+" svelte-qfeyuc"),T($t,"class","row"),Mt.disabled=St=!e[4],T(Mt,"class","btn btn-primary btn-sm mb-2"),T(Mt,"type","button"),It.disabled=qt=!e[4],T(It,"class","btn btn-secondary btn-sm mb-2"),T(It,"type","button"),T(_t,"class",Dt=p(e[1])+" svelte-qfeyuc"),T(Nt,"class",Wt=p(e[1])+" svelte-qfeyuc"),T(jt,"class","row last svelte-qfeyuc"),T(d,"class","svelte-qfeyuc"),T(t,"class","settings svelte-qfeyuc"),D(t,"sidebar",e[5])},m(r,p){x(r,t,p),b(t,n),b(n,o),b(o,s),b(t,a),b(t,l),b(l,i),b(i,c),b(t,u),b(t,d),b(d,f),b(f,m),b(f,g),b(f,v),b(v,h),ke(y,h,null),b(v,w),b(v,j),ke(O,j,null),b(d,I),b(d,A),b(A,q),b(q,R),b(q,N),b(A,W),b(A,G),b(G,H),ke(U,H,null),b(G,B),b(G,K),ke(J,K,null),b(d,X),b(d,Y),b(Y,Q),b(Q,ee),b(Q,ne),b(Y,oe),b(Y,re),b(re,se),ke(ae,se,null),b(se,le),b(se,ie),b(re,ue),b(re,pe),ke(de,pe,null),b(pe,fe),b(pe,me),b(d,ye),b(d,$e),b($e,be),b(be,Ce),b(Ce,Pe),b(Pe,Le),b(Pe,je),b(Ce,_e),b(Ce,Me),b(Me,Te),ke(Se,Te,null),b($e,ze),b($e,Ie),b(Ie,Ae),b(Ae,qe),b(qe,De),b(qe,Ee),b(Ae,Ne),b(Ae,We),b(We,Ge),ke(He,Ge,null),b(d,Ze),b(d,Be),b(Be,Ke),b(Ke,Je),b(Je,Ve),b(Ve,Xe),b(Ve,Qe),b(Je,tt),b(Je,nt),b(nt,ot),ke(rt,ot,null),b(Be,at),b(Be,lt),b(lt,it),b(it,ct),b(ct,ut),b(ct,dt),b(it,ft),b(it,mt),b(mt,gt),ke(vt,gt,null),b(d,yt),b(d,$t),b($t,bt),b(bt,xt),b(xt,kt),b(kt,wt),b(kt,Pt),b(d,Ft),b(d,jt),b(jt,_t),b(_t,Mt),b(Mt,Tt),b(_t,Ot),b(_t,It),b(It,At),b(jt,Rt),b(jt,Nt),Bt&&Bt.m(Nt,null),Gt=!0,Ht||(Ut=[_(n,"click",M(e[12])),_(l,"click",M(e[13])),_(R,"change",e[6]),_(ee,"change",e[6]),_(Le,"change",e[6]),_(De,"change",e[6]),_(Xe,"change",e[6]),_(ut,"change",e[6]),_(wt,"change",e[6]),_(Mt,"click",e[9]),_(It,"click",e[8]),_(d,"submit",M(e[11]))],Ht=!0)},p(e,[n]){4&n&&D(o,"blink",e[2]),4&n&&D(i,"blink",e[2]);const r={};1&n&&(r.kmlColor=e[0].routeColor),y.$set(r),(!Gt||2&n&&$!==($=p(e[1])+" svelte-qfeyuc"))&&T(h,"class",$);const s={};1&n&&(s.selected=e[0].routePin),O.$set(s),(!Gt||2&n&&z!==(z=p(e[1])+" svelte-qfeyuc"))&&T(j,"class",z),(!Gt||1&n&&E!==(E=e[0].alternateDisplay))&&(R.checked=E);const a={};1&n&&(a.kmlColor=e[0].alternateColor),U.$set(a),(!Gt||2&n&&Z!==(Z=p(e[1])+" svelte-qfeyuc"))&&T(H,"class",Z);const l={};1&n&&(l.selected=e[0].alternatePin),J.$set(l),(!Gt||2&n&&V!==(V=p(e[1])+" svelte-qfeyuc"))&&T(K,"class",V),(!Gt||1&n&&te!==(te=e[0].natDisplay))&&(ee.checked=te);const c={};1&n&&(c.kmlColor=e[0].natColor),ae.$set(c),(!Gt||2&n&&ce!==(ce=p(e[1])+" svelte-qfeyuc"))&&T(se,"class",ce);const u={};1&n&&(u.selected=e[0].natPin),de.$set(u),(!Gt||2&n&&he!==(he=p(e[1])+" svelte-qfeyuc"))&&T(pe,"class",he),(!Gt||1&n&&Fe!==(Fe=e[0].greatCircleDisplay))&&(Le.checked=Fe);const d={};1&n&&(d.kmlColor=e[0].greatCircleColor),Se.$set(d),(!Gt||2&n&&Oe!==(Oe=p(e[1])+" svelte-qfeyuc"))&&T(be,"class",Oe),(!Gt||1&n&&Re!==(Re=e[0].ogimetDisplay))&&(De.checked=Re);const f={};1&n&&(f.kmlColor=e[0].ogimetColor),He.$set(f),(!Gt||2&n&&Ue!==(Ue=p(e[1])+" svelte-qfeyuc"))&&T(Ie,"class",Ue),(!Gt||1&n&&Ye!==(Ye=e[0].etopsDisplay))&&(Xe.checked=Ye);const m={};1&n&&(m.kmlColor=e[0].etopsColor),rt.$set(m),(!Gt||2&n&&st!==(st=p(e[1])+" svelte-qfeyuc"))&&T(Ke,"class",st),(!Gt||1&n&&pt!==(pt=e[0].airportDisplay))&&(ut.checked=pt);const g={};1&n&&(g.selected=e[0].airportPin),vt.$set(g),(!Gt||2&n&&ht!==(ht=p(e[1])+" svelte-qfeyuc"))&&T(lt,"class",ht),(!Gt||1&n&&Ct!==(Ct=e[0].firDisplay))&&(wt.checked=Ct),(!Gt||2&n&&Lt!==(Lt=p(e[1])+" svelte-qfeyuc"))&&T(bt,"class",Lt),(!Gt||16&n&&St!==(St=!e[4]))&&(Mt.disabled=St),(!Gt||16&n&&qt!==(qt=!e[4]))&&(It.disabled=qt),(!Gt||2&n&&Dt!==(Dt=p(e[1])+" svelte-qfeyuc"))&&T(_t,"class",Dt),e[3]?Bt&&(Bt.d(1),Bt=null):Bt?Bt.p(e,n):(Bt=Zt(e),Bt.c(),Bt.m(Nt,null)),(!Gt||2&n&&Wt!==(Wt=p(e[1])+" svelte-qfeyuc"))&&T(Nt,"class",Wt),32&n&&D(t,"sidebar",e[5])},i(e){Gt||(ge(y.$$.fragment,e),ge(O.$$.fragment,e),ge(U.$$.fragment,e),ge(J.$$.fragment,e),ge(ae.$$.fragment,e),ge(de.$$.fragment,e),ge(Se.$$.fragment,e),ge(He.$$.fragment,e),ge(rt.$$.fragment,e),ge(vt.$$.fragment,e),Gt=!0)},o(e){ve(y.$$.fragment,e),ve(O.$$.fragment,e),ve(U.$$.fragment,e),ve(J.$$.fragment,e),ve(ae.$$.fragment,e),ve(de.$$.fragment,e),ve(Se.$$.fragment,e),ve(He.$$.fragment,e),ve(rt.$$.fragment,e),ve(vt.$$.fragment,e),Gt=!1},d(e){e&&k(t),we(y),we(O),we(U),we(J),we(ae),we(de),we(Se),we(He),we(rt),we(vt),Bt&&Bt.d(),Ht=!1,r(Ut)}}}function Kt(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Jt(e,t,n){let o,r,s;l(e,Ht,(e=>n(5,s=e)));const a=B(),i=st.optionsKML;let{kmlOptions:c}=t,{mode:u="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,p={...tt,...at.getItem(i)||{}},f=Kt(tt,c);function m(e){let t=!1;for(const[r,s]of Object.entries(e))c[r]!==s&&(n(0,c[r]=s,c),a("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:s}),t=!0);var o;t&&n(0,c={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,c=e.kmlOptions),"mode"in e&&n(1,u=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,o=Kt(tt,c)),1025&e.$$.dirty&&n(4,r=!Kt(p,c))},[c,u,f,o,r,s,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));c[r]!==o&&(n(0,c[r]=o,c),a("change",{name:t,value:o}))},function(){m(tt)},function(){m(p)},function(){if(o)at.removeItem(i);else{const e={};for(const t of Object.keys(c).filter((e=>c[e]!==tt[e])))e[t]=c[t];at.setItem(i,e)}a("save"),n(10,p={...c})},p,function(t){K(e,t)},()=>{d(Ht,s=!s,s),n(2,f=!1)},()=>{d(Ht,s=!s,s),n(2,f=!1)}]}class Vt extends Pe{constructor(e){super(),Ce(this,e,Jt,Bt,a,{kmlOptions:0,mode:1})}}const Xt=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Yt=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],Qt=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],en=e=>0===e?3:0,tn=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function nn(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function on(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function rn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const sn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function an(e,t,n,o,r,s,a){e.addSource(`${t}-marker-source`,on(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>nn(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(un(t,r,a,s))}function ln(e,t,n,o,r,s){o?e.addSource(`${t}-line-source`,on(o(n).map((e=>rn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:rn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(pn(t,r,s))}function cn(e,t,n,o,r,s){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(rn(t[e]))}e.addSource(`${t}-line-source`,on(s))}else e.addSource(`${t}-line-source`,on(n.map((e=>rn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(pn(t,r,s))}function un(e,t,n,o){const[r,s]=Ke(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?sn[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function pn(e,t,n){const[o,r]=Ke(t);let s=2,a=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,a=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":a}}}const dn=2*Math.PI,fn=Math.PI/4,mn=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*dn};var gn={init:function(){},forward:function(e){var t=e.x,n=e.y,o=mn(t-this.long0),r=Math.tan(n/2),s=Math.sin(fn*r),a=s*s,l=this.x0+this.a*o*(.74482-.34588*a),i=this.y0+1.70711*this.a*r;return e.x=l,e.y=i,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(fn*t),o=n*n,r=mn(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};const vn="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q";function hn(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(gn);const s=t.id.startsWith("jb_");let a={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${s?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const l=new mapboxgl.Map({...t.mapboxOptions,...a});let i,c,u,p;l.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||l.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||l.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||l.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-star-sdf.png",(function(e,t){e||l.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let d,f=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],a=s[2]-s[0],l=s[3]-s[1],[i,c,u,p]=t.extent,[d,f]=t.ratio,m=a/d*f*(l/a),[g,v,h,y]=[s[0],s[3]-m,s[2],s[3]];e=(h-g)/(u-i),n=g-e*i,o=(y-v)/(p-c),r=v-o*c}else{const[s,a,l,i]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(l-s),n=c-e*s,o=(d-u)/(i-a),r=u-o*a}const[s,a,l,d]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),v=t=>[e*t[0]+n,o*t[1]+r],h=e=>m(v(e));f=e=>v(g(e)),i=e=>m(f(e)),c=e=>{let[t,n]=g(e);return t=Me(t,s,l),n=Me(n,a,d),h([t,n])},u=e=>{let[t,n]=g(e);if(Te(t,s,l)&&Te(n,a,d))return h([t,n])},p=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,a,l,i=e.length,c=Oe(e[0],t),u=[];for(n||(n=[]),o=1;o<i;o++){for(r=e[o-1],a=l=Oe(s=e[o],t);;){if(!(c|a)){u.push(r),a!==l?(u.push(s),o<i-1&&(n.push(u),u=[])):o===i-1&&u.push(s);break}if(c&a)break;c?c=Oe(r=Se(r,s,c,t),t):a=Oe(s=Se(r,s,a,t),t)}c=l}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>h(e)))))}}let g=[];if(!n.isFake){for(const e of n.tracks)g=g.concat(e.points);g=g.concat(n.route.points,n.wptCoordinatesAlternate()),d=Ae(g,c),l.fitBounds(d,{padding:{top:30,bottom:80,left:30,right:30}})}const v=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(i){const e=v._onSuccess;v._onSuccess=function(t){const[n,o]=i([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}return l.addControl(v),l.affineAndClamp=c,l.on("load",(function(){t.tiles&&(l.addSource("jb-raster",{type:"raster",tiles:t.tiles,tileSize:t.tileSize}),l.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),function(e,t,n,o,r,s,a,l){const i={...tt,...t},c=e.description;if(!e.isFake){const t=`${e.infos.departure}-${e.infos.destination}`,o=new editolido.Route(e.wptCoordinates(),{name:t,description:c}),r=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"});ln(n,"greatcircle",new editolido.Route([o.points[0],o.points[o.points.length-1]]).split(300,{name:`Ortho ${t}`}).points,a,i.greatCircleColor,i.greatCircleDisplay),ln(n,"ogimet",e.ogimetData.route.points,a,i.ogimetColor,i.ogimetDisplay),ln(n,"ralt",r.points,a,i.alternateColor,i.alternateDisplay),ln(n,"rmain",o.points,a,i.routeColor,!0),an(n,"ralt",r.points,s,i.alternatePin,i.alternateDisplay,i.alternateColor),an(n,"rmain",o.points,s,i.routePin,!0,i.routeColor)}"jb_pacific"!==l.id&&((e,t,n)=>{fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((o=>{if(t)for(let e=0;e<o.features.length;e++){const n=o.features[e].geometry.coordinates[0];o.features[e].geometry.coordinates=[n.map((e=>t(e)))]}e.addSource("fir-reg-source",{type:"geojson",data:o}),e.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),e.addLayer({id:"fir-reg-line-layer",type:"line",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))})(n,o,i.firDisplay);let u=[];e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(u=[e.infos.EEP,e.infos.EXP]);((e,t,n,o,r,s,a,l)=>{const[i]=Ke(s),c=o.map((e=>e.name)),u=r.map((e=>e.name)),p=c.concat(u);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((o=>{if(t){const e=[];for(let n of o.features)n.geometry.coordinates=t(n.geometry.coordinates),void 0!==n.geometry.coordinates&&e.push(n);o.features=e}e.addSource("airports-source",{type:"geojson",data:o}),e.addLayer({id:"airport-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:l?"visible":"none","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Yt(n,!1)}),e.addLayer({id:"airport-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["in",["get","name"],["literal",p]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",p]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:l?"visible":"none","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",p]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Qt(n,p)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":en(a),"icon-color":Xt(a,n,u,i),"text-color":tn(u,i),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Yt(n)});const r=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!je}),s=function(t){const n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.title;for(;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;r.setLngLat(n).setHTML(o).addTo(e)},c=()=>e.getCanvas().style.cursor="pointer",d=()=>e.getCanvas().style.cursor="",f=function(){d(),r.remove()};je?(e.on("mouseenter","airport-layer",(e=>{c(),s(e)})),e.on("mouseenter","airport-emer-layer",(e=>{c(),s(e)})),e.on("mouseleave","airport-layer",f),e.on("mouseleave","airport-emer-layer",f)):(e.on("mouseenter","airport-layer",c),e.on("mouseenter","airport-emer-layer",c),e.on("click","airport-layer",s),e.on("click","airport-emer-layer",s),e.on("mouseleave","airport-layer",d),e.on("mouseleave","airport-emer-layer",d))}))})(n,s,e.isFake?e.isFake:e.infos.aircraft,u,e.infos.raltPoints,i.etopsColor,i.airportPin,i.airportDisplay),e.isFake||(function(e,t,n,o,r,s,a){const l={rnat:[],"rnat-incomplete":[]},i={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(o){const n=o(e.points),r=n.length;for(let o=0;o<r;o++)l[t].push(rn(n[o],e.name))}else l[t].push(rn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const r=e.points[0];let s=n?n([r.longitude,r.latitude]):[r.longitude,r.latitude];if(s&&i[t].push(nn(s,`${e.name}\n${r.name}`,e.description)),e.isMine){const o=e.points[e.points.length-1];s=n?n([o.longitude,o.latitude]):[o.longitude,o.latitude],s&&i[t].push(nn(s,`${e.name}\n${o.name}`,e.description))}}e.addSource("rnat-marker-source",on(i.rnat)),e.addSource("rnat-incomplete-marker-source",on(i["rnat-incomplete"])),e.addSource("rnat-line-source",on(l.rnat)),e.addSource("rnat-incomplete-line-source",on(l["rnat-incomplete"])),e.addLayer(pn("rnat",r,a)),e.addLayer(pn("rnat-incomplete",tt.natIncompleteColor,a)),e.addLayer(un("rnat",s,r,a)),e.addLayer(un("rnat-incomplete",s,r,a));const c=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},u=t=>{const n=t+"-marker-layer";e.on("click",n,c),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};u("rnat"),u("rnat-incomplete")}(n,e,s,a,i.natColor,i.natPin,i.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,s,a,l){cn(e,`${t}-ep-circle`,[n[0].circle(420,48),n[1].circle(420,48)],o,a,r),cn(e,`${t}-etops-circle`,n.slice(2).map((e=>e.circle(7*s))),o,l,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),a,i.etopsDisplay,e.infos.ETOPS,i.routeColor,i.etopsColor))}(n,o,l,i,0,u,p,t);const s=document.querySelector(`#${e} .mapboxgl-ctrl-attrib-inner`);s&&(s.appendChild(document.createTextNode(" | ")),s.appendChild(r),s.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`))),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2")})),l}function yn(e,t,n){if("etops"===t)return function(e,t){let n="etops-etops-circle-line-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="etops-ep-circle-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("fir"===t)return function(e,t){let n="fir-reg-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="fir-reg-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("airport"===t)return function(e,t){let n="airport-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="airport-emer-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);const o=t+"-marker-layer",r=t+"-line-layer";e.getLayer(r)&&e.setLayoutProperty(r,"visibility",n?"visible":"none"),e.getLayer(o)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function $n(e,t,n){const[o,r]=Ke(n);if("etops"===t)return function(e,t){const[n,o]=Ke(t),r="etops-etops-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n);const s=t+"-marker-layer",a=t+"-line-layer";e.getLayer(a)&&(e.setPaintProperty(a,"line-color",o),e.setPaintProperty(a,"line-opacity",r)),e.getLayer(s)&&e.setPaintProperty(s,"text-color",o),"rmain"===t&&function(e,t){const[n,o]=Ke(t),r="etops-ep-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n)}function bn(e,t,n,o,r,s){if("airport"===t)return function(e,t,n,o,r){const[s]=Ke(r),a="airport-layer";e.getLayer(a)&&(e.setPaintProperty(a,"icon-color",Xt(t,n,o,s)),e.setPaintProperty(a,"text-color",tn(o,s)),e.setPaintProperty(a,"icon-halo-width",en(t)))}(e,n,o,r,s);const a=sn[n],l=t+"-marker-layer",i=t+"-line-layer";if(e.getLayer(l)){const t=e.getPaintProperty(i,"line-color");e.setPaintProperty(l,"icon-color",0!==n?a:t),e.setPaintProperty(l,"text-color",t),e.setLayoutProperty(l,"icon-size",0!==n?1:.2),e.setLayoutProperty(l,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(l,"icon-anchor",0!==n?"bottom":"center")}}function xn(e,t,n,o,r,s){const a=_e(t);if("aircraftType"===t){let t=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(t=[o.infos.EEP.name,o.infos.EXP.name]),function(e,t,n,o,r,s){const[a]=Ke(s),l="airport-layer";e.setFilter(l,Yt(n)),e.setPaintProperty(l,"icon-color",Xt(t,n,o,a)),e.setLayoutProperty(l,"symbol-sort-key",Qt(n,r)),e.setFilter("airport-emer-layer",Yt(n,!1))}(e,r.airportPin,s,o.infos.ralts,t.concat(o.infos.ralts),r.etopsColor)}else t.endsWith("-display")?("rnat"===a&&yn(e,"rnat-incomplete",n),yn(e,a,n)):t.endsWith("-pin")?bn(e,a,n,s,o.infos.ralts,r.etopsColor):t.endsWith("-color")&&$n(e,a,n)}const kn={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},{window:wn}=$e;function Cn(e,t,n){const o=e.slice();return o[33]=t[n],o[35]=n,o}function Pn(e,t,n){const o=e.slice();return o[36]=t[n],o[35]=n,o}function Ln(e){let t,n,o,r=(e[36].proj4&&e[17](e[36])?`${e[36].label.toUpperCase()}`:e[36].label)+"";return{c(){t=C("option"),n=L(r),t.__value=e[35],t.value=t.__value,t.selected=o=e[35]===e[4]},m(e,o){x(e,t,o),b(t,n)},p(e,n){16&n[0]&&o!==(o=e[35]===e[4])&&(t.selected=o)},d(e){e&&k(t)}}}function Fn(e){let t,n,o,r,s,a,l,i,c;return{c(){t=C("button"),n=C("div"),o=P("svg"),r=P("path"),s=P("path"),l=C("div"),l.innerHTML='<span class="svelte-iz74i6">↓</span>',T(r,"d","M50,5A45 45 0 1 1 49.9999 5"),T(r,"class","svelte-iz74i6"),T(s,"d",a=e[10]()),T(s,"class","svelte-iz74i6"),T(o,"viewBox","0 0 100 100"),T(o,"class","svelte-iz74i6"),T(n,"class","svelte-iz74i6"),T(l,"class","svelte-iz74i6"),T(t,"type","button"),T(t,"class","btn btn-outline-info svelte-iz74i6"),D(t,"error",e[8])},m(a,u){x(a,t,u),b(t,n),b(n,o),b(o,r),b(o,s),b(t,l),e[24](t),i||(c=_(t,"click",e[20]),i=!0)},p(e,n){1024&n[0]&&a!==(a=e[10]())&&T(s,"d",a),256&n[0]&&D(t,"error",e[8])},d(n){n&&k(t),e[24](null),i=!1,c()}}}function jn(e){let t,n,o,r=e[33]+"";return{c(){t=C("option"),n=L(r),t.__value=e[35],t.value=t.__value,t.selected=o=e[35]===e[5]},m(e,o){x(e,t,o),b(t,n)},p(e,n){32&n[0]&&o!==(o=e[35]===e[5])&&(t.selected=o)},d(e){e&&k(t)}}}function _n(e){let t,n=("???"!==e[33]||"???"===e[5]&&"???"===e[33])&&jn(e);return{c(){n&&n.c(),t=j()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){"???"!==e[33]||"???"===e[5]&&"???"===e[33]?n?n.p(e,o):(n=jn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Mn(e){let t,n,o,a,l,i,c,u,p,d,m,g,v,h,y=e[13],$=[];for(let t=0;t<y.length;t+=1)$[t]=Ln(Pn(e,y,t));let P=e[4]>=0&&!e[1].isFake&&navigator&&!0===navigator.standalone&&e[11]&&!0!==e[9][e[13][e[4]].id]&&Fn(e),L=e[12],j=[];for(let t=0;t<L.length;t+=1)j[t]=_n(Cn(e,L,t));function M(t){e[27](t)}let S={};return void 0!==e[0]&&(S.kmlOptions=e[0]),d=new Vt({props:S}),V.push((()=>be(d,"kmlOptions",M))),d.$on("change",e[18]),d.$on("save",e[28]),{c(){t=C("div"),o=F(),a=C("div"),l=C("select");for(let e=0;e<$.length;e+=1)$[e].c();i=F(),P&&P.c(),c=F(),u=C("select");for(let e=0;e<j.length;e+=1)j[e].c();p=F(),xe(d.$$.fragment),T(t,"id",e[3]),T(t,"class","svelte-iz74i6"),T(l,"name",Tn),T(l,"class","form-control form-control-sm svelte-iz74i6"),void 0===e[4]&&ne((()=>e[23].call(l))),T(a,"class","mapmenu svelte-iz74i6"),T(u,"name","aircraftType"),T(u,"class","svelte-iz74i6"),void 0===e[5]&&ne((()=>e[26].call(u)))},m(r,s){x(r,t,s),x(r,o,s),x(r,a,s),b(a,l);for(let e=0;e<$.length;e+=1)$[e].m(l,null);A(l,e[4]),b(a,i),P&&P.m(a,null),x(r,c,s),x(r,u,s);for(let e=0;e<j.length;e+=1)j[e].m(u,null);e[25](u),A(u,e[5]),x(r,p,s),ke(d,r,s),g=!0,v||(h=[_(wn,"orientationchange",e[19]),f(n=e[16].call(null,t,{route:e[2]})),_(l,"change",e[23]),_(l,"change",e[14]),_(u,"change",e[26]),_(u,"change",e[15])],v=!0)},p(e,o){if((!g||8&o[0])&&T(t,"id",e[3]),n&&s(n.update)&&4&o[0]&&n.update.call(null,{route:e[2]}),139280&o[0]){let t;for(y=e[13],t=0;t<y.length;t+=1){const n=Pn(e,y,t);$[t]?$[t].p(n,o):($[t]=Ln(n),$[t].c(),$[t].m(l,null))}for(;t<$.length;t+=1)$[t].d(1);$.length=y.length}if(16&o[0]&&A(l,e[4]),e[4]>=0&&!e[1].isFake&&navigator&&!0===navigator.standalone&&e[11]&&!0!==e[9][e[13][e[4]].id]?P?P.p(e,o):(P=Fn(e),P.c(),P.m(a,null)):P&&(P.d(1),P=null),4128&o[0]){let t;for(L=e[12],t=0;t<L.length;t+=1){const n=Cn(e,L,t);j[t]?j[t].p(n,o):(j[t]=_n(n),j[t].c(),j[t].m(u,null))}for(;t<j.length;t+=1)j[t].d(1);j.length=L.length}32&o[0]&&A(u,e[5]);const r={};!m&&1&o[0]&&(m=!0,r.kmlOptions=e[0],oe((()=>m=!1))),d.$set(r)},i(e){g||(ge(d.$$.fragment,e),g=!0)},o(e){ve(d.$$.fragment,e),g=!1},d(n){n&&k(t),n&&k(o),n&&k(a),w($,n),P&&P.d(),n&&k(c),n&&k(u),w(j,n),e[25](null),n&&k(p),we(d,n),v=!1,r(h)}}}const Tn="map-style";function Sn(e,t,n){let o,r;l(e,Ut,(e=>n(11,r=e)));const s=B();let a,i,c,{kmlOptions:u}=t,{ofp:p}=t,{route:d}=t,f=-1,m=-1,g=100,v=0,h=!1;const y={},$=["???","318","319","320","321","330","340","350","380","787","772","773","77F"],b=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,x=[{label:"Mercator",id:"atlas",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:kn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,tileSize:b},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:kn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,tileSize:b},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:kn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheZoom:4,tileSize:b},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:kn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,tileSize:b}];let{id:k="map"}=t;function w(){a&&a.remove()}var C;return C=()=>{mapboxgl.accessToken=vn,a=hn(k,x[f],p,u,i)},Z().$$.on_mount.push(C),e.$$set=e=>{"kmlOptions"in e&&n(0,u=e.kmlOptions),"ofp"in e&&n(1,p=e.ofp),"route"in e&&n(2,d=e.route),"id"in e&&n(3,k=e.id)},e.$$.update=()=>{6291456&e.$$.dirty[0]&&n(10,o=()=>{if(v<=0)return"";if(v>=g)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(v/g),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[u,p,d,k,f,m,i,c,h,y,o,r,$,x,function(e){e.target.blur(),w(),n(22,v=0),n(8,h=!1),a=hn(k,x[f],p,u,i)},function(e){e.target.blur(),xn(a,"aircraftType",$[e.target.value],p,u,$[e.target.value])},function(e,t){if(-1===f&&p&&!p.isFake){const e=p.route.points[0],t=p.route.points[p.route.points.length-1];t.latitude>30&&e.latitude>30?n(4,f=1):t.longitude<-80&&e.longitude<-80?n(4,f=3):n(4,f=2)}return-1===f&&n(4,f=0),-1===m&&p&&n(5,m=p.isFake?$.indexOf(p.isFake):$.indexOf(p.infos.aircraft)),-1===m&&n(5,m=0),{update(e){"/map"===e.route&&a&&a.resize()},destroy(){w()}}},function(e){if(!e.proj4||!p||p.isFake)return!0;const t=p.route.points[0],n=p.route.points[p.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},e=>{xn(a,e.detail.name,e.detail.value,p,u,$[m]),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-"))return;const n=ot(),o=_e(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),s("save")},e=>{"/map"===d&&a&&a.resize()},async e=>{let t,o;if(c.blur(),t)return!1;t=!0;try{await function(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return t=!1,c.blur(),n(8,h=!0),!1}const r=a.affineAndClamp,s=x[f];let l=[];if(!p.isFake){for(const e of p.tracks)l=l.concat(e.points);l=l.concat(p.route.points,p.wptCoordinatesAlternate()),o=Ae(l,r);const[e,t]=[[o[0],o[1]],[o[2],o[3]]],i=[];for(let n=1;n<=s.cacheZoom;n++){const o={x:ze(e[0],n),y:Ie(e[1],n)},r={x:ze(t[0],n),y:Ie(t[1],n)},a=Math.pow(2,n);let l,c;s.matrix?[l,c]=s.matrix[n]:[l,c]=[a,a];for(let e=o.x;e<=r.x;e++)for(let t=r.y;t<=o.y;t++)e>=0&&t>=0&&e<l&&t<c&&i.push([n,e,t])}if(s.tiles){n(21,g=i.length);for(const[e,t,o]of i)try{await fetch(s.tiles[0].replace("{z}",e).replace("{x}",t).replace("{y}",o)),n(22,v+=1)}catch(e){}}else{n(21,g=2*i.length);for(const[e,t,o]of i){let r=`https://api.mapbox.com/v4/denizotjb.63g5ah66/${e}/${t}/${o}@2x.webp?sku=${a._requestManager._skuToken}&access_token=${vn}`;try{await fetch(r),n(22,v+=1)}catch(e){}r=`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${e}/${t}/${o}.vector.pbf?sku=${a._requestManager._skuToken}&access_token=${vn}`;try{await fetch(r),n(22,v+=1)}catch(e){}}}v>=g&&(n(9,y[s.id]=!0,y),n(9,y))}t=!1},g,v,function(){f=q(this),n(4,f)},function(e){V[e?"unshift":"push"]((()=>{c=e,n(7,c)}))},function(e){V[e?"unshift":"push"]((()=>{i=e,n(6,i)}))},function(){m=q(this),n(5,m)},function(e){u=e,n(0,u)},function(t){K(e,t)}]}class On extends Pe{constructor(e){super(),Ce(this,e,Sn,Mn,a,{kmlOptions:0,ofp:1,route:2,id:3},[-1,-1])}}function zn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#marker"></use></svg> \n      <span class="svelte-1nd81uv">CARTE</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/map"),D(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),D(t,"active","/map"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&D(n,"disabled",!e[1]),1&o&&D(t,"active","/map"===e[0])},d(e){e&&k(t)}}}function In(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#cloud"></use></svg> \n      <span class="svelte-1nd81uv">GRAMET</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/gramet"),D(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),D(t,"active","/gramet"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&D(n,"disabled",!e[1]),1&o&&D(t,"active","/gramet"===e[0])},d(e){e&&k(t)}}}function An(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#export"></use></svg> \n      <span class="svelte-1nd81uv">EXPORT</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/export"),D(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),D(t,"active","/export"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&D(n,"disabled",!e[1]),1&o&&D(t,"active","/export"===e[0])},d(e){e&&k(t)}}}function qn(t){let n,o,r,s;return{c(){n=C("li"),o=C("a"),o.textContent="PARTAGER",T(o,"class","nav-link"),T(o,"href","."),T(n,"class","nav-item optional svelte-1nd81uv")},m(e,a){x(e,n,a),b(n,o),r||(s=_(o,"click",M(t[2])),r=!0)},p:e,d(e){e&&k(n),r=!1,s()}}}function Dn(e){let t,n,o,r,s,a,l,c,p,d,f,m=(e[1]||"/map"===e[0])&&zn(e),g=(e[1]&&!e[1].isFakeOfp||"/gramet"===e[0])&&In(e),v=(e[1]&&!e[1].isFakeOfp||"/export"===e[0])&&An(e),h=e[1]&&navigator.share&&qn(e);const y=e[4].default,$=i(y,e,e[3],null);return{c(){t=C("nav"),n=C("ul"),o=C("li"),o.innerHTML='<a class="nav-link" href="#/"><svg class="svelte-1nd81uv"><use xlink:href="#home"></use></svg></a>',r=F(),m&&m.c(),s=F(),g&&g.c(),a=F(),v&&v.c(),l=F(),c=C("li"),c.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-1nd81uv"><use xlink:href="#info"></use></svg> \n      <span class="svelte-1nd81uv">AIDE</span></a>',p=F(),h&&h.c(),d=F(),$&&$.c(),T(o,"class","nav-item svelte-1nd81uv"),D(o,"active","/"===e[0]),T(c,"class","nav-item svelte-1nd81uv"),D(c,"active","/help"===e[0]),T(n,"class","navbar-nav mr-auto svelte-1nd81uv"),T(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-1nd81uv")},m(e,i){x(e,t,i),b(t,n),b(n,o),b(n,r),m&&m.m(n,null),b(n,s),g&&g.m(n,null),b(n,a),v&&v.m(n,null),b(n,l),b(n,c),b(n,p),h&&h.m(n,null),b(t,d),$&&$.m(t,null),f=!0},p(e,[t]){1&t&&D(o,"active","/"===e[0]),e[1]||"/map"===e[0]?m?m.p(e,t):(m=zn(e),m.c(),m.m(n,s)):m&&(m.d(1),m=null),e[1]&&!e[1].isFakeOfp||"/gramet"===e[0]?g?g.p(e,t):(g=In(e),g.c(),g.m(n,a)):g&&(g.d(1),g=null),e[1]&&!e[1].isFakeOfp||"/export"===e[0]?v?v.p(e,t):(v=An(e),v.c(),v.m(n,l)):v&&(v.d(1),v=null),1&t&&D(c,"active","/help"===e[0]),e[1]&&navigator.share?h?h.p(e,t):(h=qn(e),h.c(),h.m(n,null)):h&&(h.d(1),h=null),$&&$.p&&8&t&&u($,y,e,e[3],t,null,null)},i(e){f||(ge($,e),f=!0)},o(e){ve($,e),f=!1},d(e){e&&k(t),m&&m.d(),g&&g.d(),v&&v.d(),h&&h.d(),$&&$.d(e)}}}function Rn(e,t,n){let{$$slots:o={},$$scope:r}=t,{route:s}=t,{promise:a}=t;return e.$$set=e=>{"route"in e&&n(0,s=e.route),"promise"in e&&n(1,a=e.promise),"$$scope"in e&&n(3,r=e.$$scope)},[s,a,async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},r,o]}class En extends Pe{constructor(e){super(),Ce(this,e,Rn,Dn,a,{route:0,promise:1})}}function Nn(e,t,n){const o=e.slice();return o[12]=t[n],o}function Wn(e){let t,n,o,s,a,l=Zn,i=[];for(let t=0;t<l.length;t+=1)i[t]=Gn(Nn(e,l,t));return{c(){t=C("div"),n=C("select"),o=C("option"),o.textContent="pas d'ofp ?";for(let e=0;e<i.length;e+=1)i[e].c();o.__value="none",o.value=o.__value,T(n,"class","form-control-sm svelte-14yxy04"),n.disabled=e[1],T(t,"class","footer svelte-14yxy04")},m(r,l){x(r,t,l),b(t,n),b(n,o);for(let e=0;e<i.length;e+=1)i[e].m(n,null);s||(a=[_(n,"click",e[4],{once:!0}),_(n,"change",e[6])],s=!0)},p(e,t){if(0&t){let o;for(l=Zn,o=0;o<l.length;o+=1){const r=Nn(e,l,o);i[o]?i[o].p(r,t):(i[o]=Gn(r),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=l.length}2&t&&(n.disabled=e[1])},d(e){e&&k(t),w(i,e),s=!1,r(a)}}}function Gn(t){let n,o,r=t[12]+"";return{c(){n=C("option"),o=L(r),n.__value=t[12],n.value=n.__value},m(e,t){x(e,n,t),b(n,o)},p:e,d(e){e&&k(n)}}}function Hn(t){let n,o,s,a,l,i,c,u,p,d=!t[0]&&Wn(t);return{c(){n=C("div"),o=C("input"),s=F(),a=C("label"),l=L(t[2]),i=F(),d&&d.c(),c=j(),T(o,"id",Kn),T(o,"name",Kn),T(o,"type","file"),T(o,"accept","application/pdf"),o.disabled=t[1],T(o,"class","custom-file-input svelte-14yxy04"),T(a,"class","custom-file-label text-truncate svelte-14yxy04"),T(a,"for",Kn),D(a,"ready",t[3]),T(n,"class","custom-file svelte-14yxy04"),D(n,"blink",!t[0])},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,a),b(a,l),x(e,i,r),d&&d.m(e,r),x(e,c,r),u||(p=[_(o,"change",t[5]),_(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&O(l,e[2]),8&t&&D(a,"ready",e[3]),1&t&&D(n,"blink",!e[0]),e[0]?d&&(d.d(1),d=null):d?d.p(e,t):(d=Wn(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&k(n),e&&k(i),d&&d.d(e),e&&k(c),u=!1,r(p)}}}const Un=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.6.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.6.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}];let Zn=["318","319","320","321","330","340","350","380","787","772","773","77F"];const Bn=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let Kn="file";function Jn(e,t,n){let o,{promise:r}=t,{kmlOptions:s}=t,a=!1,l=new Le,i="Choisir un OFP",c=!1;const u=B();function p(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,a=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(a.crossOrigin="anonymous");let l=!0;s?(a.src=t,a.async=n.async,a.defer=n.defer):(a.href=t,"prefetch"in n?(a.rel="prefetch",o-=1,l=!1):"preload"in n?(a.rel="preload",o-=1,l=!1):(a.rel="stylesheet",o-=1,l=!1)),l&&(a.onload=r),document.body.appendChild(a)}))}(Un,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",o&&!o.destroyed||(o=new e.PDFWorker),l.resolve(!0),n(3,c=!0)}))}const d=e=>{const t=new FileReader;return new Promise(((n,r)=>{t.onload=e=>{if(!o||o.destroyed){const e=window["pdfjs-dist/build/pdf"];o=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Bn(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:o}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),o=new editolido.GeoGridIndex;o.data=window.WMO;const a=editolido.ogimetData(t,o);a.proxyImg=`https://ofp2map-gramet.vercel.app/api/${a.proxy}__${a.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,a.route.description=a.wmo.join(" "),t.ogimetData=a;try{ot();rt(t,s),n(t)}catch(e){r(e)}}catch(e){r(e)}else r(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>r(e)))},t.onerror=e=>{r(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"promise"in e&&n(0,r=e.promise),"kmlOptions"in e&&n(7,s=e.kmlOptions)},[r,a,i,c,p,async function(e){n(1,a=!0),p(),await l.promise.then((()=>{const t=e.target.files[0];t&&(n(2,i=e.target.value.split(/([\\/])/g).pop()),u("change",i),n(0,r=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))})),n(1,a=!1)},async function(e){n(1,a=!0),p(),await l.promise.then((()=>{n(0,r=new Promise(((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{ot();rt(o,s),t(o)}catch(e){n(e)}}))),n(0,r.isFakeOfp=!0,r),window.location.hash="#/map"})),n(1,a=!1)},s]}class Vn extends Pe{constructor(e){super(),Ce(this,e,Jn,Hn,a,{promise:0,kmlOptions:7})}}function Xn(n){let o,r,a;const l=n[3].default,c=i(l,n,n[2],null);return{c(){o=C("page"),c&&c.c(),T(o,"class","svelte-7uc4nn"),D(o,"fadein",!1===n[0]),D(o,"d-none",!0===n[0])},m(e,t){x(e,o,t),c&&c.m(o,null),a=!0},p(e,[t]){c&&c.p&&4&t&&u(c,l,e,e[2],t,null,null),1&t&&D(o,"fadein",!1===e[0]),1&t&&D(o,"d-none",!0===e[0])},i(l){a||(ge(c,l),r||ne((()=>{r=function(n,o,r){let a,l,i=o(n,r),c=!1,u=0;function p(){a&&H(n,a)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:f}=i||he;f&&(a=G(n,0,1,r,o,s,f,u++)),d(0,1);const m=g()+o,v=m+r;l&&l.abort(),c=!0,ne((()=>ue(n,!0,"start"))),l=$((e=>{if(c){if(e>=v)return d(1,0),ue(n,!0,"end"),p(),c=!1;if(e>=m){const t=s((e-m)/r);d(t,1-t)}}return c}))}let f=!1;return{start(){f||(H(n),s(i)?(i=i(),ce().then(d)):d())},invalidate(){f=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),a=!0)},o(e){ve(c,e),a=!1},d(e){e&&k(o),c&&c.d(e)}}}function Yn(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return qe(e,t)},r,o]}class Qn extends Pe{constructor(e){super(),Ce(this,e,Yn,Xn,a,{hidden:0})}}function eo(t){let n,o,r,s,a,l,i,c,u,p,d,f,m,g,v,h,y,$,b,w,P,L,j,_,M,S,O,z,I,A,q,D,R,E,N;return{c(){n=C("h2"),n.textContent="Préambule",o=F(),r=C("p"),r.textContent="Cette app a été conçue pour le PilotPad. Elle nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi. Firefox dernière version devrait fonctionner (non testé).\nL'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. GitHub (détenu par Microsoft), hébergeur du site, utilise des cookies. L'app en elle même ne collecte aucune données.",s=F(),a=C("h2"),a.textContent="Utilisation",l=F(),i=C("ol"),i.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner. Le &quot;drag and drop&quot; est également possible dans le champ d&#39;input de l&#39;OFP.</p></li> \n<li><p>Après avoir ouvert ce site dans Safari sur iPad, il est possible d&#39;afficher le menu de personnalisation en cliquant sur  l&#39;icône en haut à droite (le &quot;hamburger&quot;). Dans les résolutions plus faibles, sur iPhone ou en mode &quot;split view&quot;, ces réglages sont affichés sous la carte. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur une projection Web Mercator ou sur l&#39;Atlas &quot;The World&quot;.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li> \n<li>The World permet de disposer d&#39;un Atlas off-line</li> \n<li>Mercator est plutôt destinée à un usage online, le thème est inspiré des cartes VFR et on peut zoomer de manière importante.</li></ul></li>",c=F(),u=C("ol"),u.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</li>",p=F(),d=C("h2"),d.textContent="Mode off-line",f=F(),m=C("p"),m.innerHTML="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l&#39;exporter. Il est aussi probable que le cache de l&#39;App vous permettra de naviguer sur les cartes déjà visualisées. Vous disposez d&#39;un cache de 50Mo pendant 7 jours, voir <em>Installation sur l&#39;écran d&#39;accueil</em> pour augmenter ces valeurs.",g=F(),v=C("h2"),v.textContent="Sauvegarde des paramètres",h=F(),y=C("p"),y.textContent="L'app permet de sauvegarder vos paramètres dans le navigateur. Toutefois Apple ne conserve plus les données au-delà\nde 7 jours, vos réglages risquent donc de disparaître. La solution: après avoir paramétré l'app, mémorisez vos choix dans la \"sidebar\" puis, sauvegardez l'url de la page dans vos favoris.\nL'URL contient l'ensemble des détails nécessaires à la restauration. Si vous utilisez cette méthode, pensez à bien \nsauvegarder l'URL après vos modifications. Dans un premier temps, contentez-vous de sauvegarder avec le bouton «Mémoriser»,\ntestez sur différents OFP, puis une fois satisfait, sauvegardez dans vos favoris.",$=F(),b=C("h2"),b.textContent="Installation sur l'écran d'accueil",w=F(),P=C("p"),P.innerHTML='Il est recommandé d&#39;installer l&#39;app sur l&#39;écran d&#39;accueil en utilisant le menu « partage » <svg style="width: 1em; display: inline-block; height: 1em; vertical-align: bottom;"><use xlink:href="#share"></use></svg> de Safari. Ceci permet:',L=F(),j=C("ul"),j.innerHTML="<li>un stockage longue durée des préférences, des cartes Lambert et de l&#39;Atlas.</li> \n<li>de disposer d&#39;un cache plus important : les cartes Lambert et L&#39;Atlas peuvent être stockés en totalité. La Web Mercator dispose d&#39;un cache de niveau 6 (il y a 12 niveaux de zoom sur la Mercator).</li> \n<li>de mettre en cache facilement la partie de la carte correspondant à la route. Pour celà, cliquez sur le symbole ↓ situé à droite du sélecteur de carte. Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données.</li> \n<li>d&#39;avoir un écran plus grand.</li>",_=F(),M=C("p"),M.textContent="Par contre, on ne peut recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.\nÀ noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",S=F(),O=C("h2"),O.textContent="Mise à jour",z=F(),I=C("p"),I.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut \napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",A=F(),q=C("h2"),q.textContent="Crédits",D=F(),R=C("ul"),R.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',E=F(),N=C("p"),N.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",T(u,"start","5")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t),x(e,s,t),x(e,a,t),x(e,l,t),x(e,i,t),x(e,c,t),x(e,u,t),x(e,p,t),x(e,d,t),x(e,f,t),x(e,m,t),x(e,g,t),x(e,v,t),x(e,h,t),x(e,y,t),x(e,$,t),x(e,b,t),x(e,w,t),x(e,P,t),x(e,L,t),x(e,j,t),x(e,_,t),x(e,M,t),x(e,S,t),x(e,O,t),x(e,z,t),x(e,I,t),x(e,A,t),x(e,q,t),x(e,D,t),x(e,R,t),x(e,E,t),x(e,N,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r),e&&k(s),e&&k(a),e&&k(l),e&&k(i),e&&k(c),e&&k(u),e&&k(p),e&&k(d),e&&k(f),e&&k(m),e&&k(g),e&&k(v),e&&k(h),e&&k(y),e&&k($),e&&k(b),e&&k(w),e&&k(P),e&&k(L),e&&k(j),e&&k(_),e&&k(M),e&&k(S),e&&k(O),e&&k(z),e&&k(I),e&&k(A),e&&k(q),e&&k(D),e&&k(R),e&&k(E),e&&k(N)}}}class to extends Pe{constructor(e){super(),Ce(this,e,null,eo,a,{})}}function no(e){let t,n,o,r,s,a,l=e[1].msg+"",i=0!==e[1].code&&so(e);return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(l),a=F(),i&&i.c(),T(o,"data-status",s=e[1].code),T(o,"class","svelte-jp9cw7"),T(t,"class","svelte-jp9cw7")},m(e,s){x(e,t,s),b(t,n),b(t,o),b(o,r),b(t,a),i&&i.m(t,null)},p(e,n){2&n&&l!==(l=e[1].msg+"")&&O(r,l),2&n&&s!==(s=e[1].code)&&T(o,"data-status",s),0!==e[1].code?i?i.p(e,n):(i=so(e),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},d(e){e&&k(t),i&&i.d()}}}function oo(e){let t,n,o,r,s,a,l,i,c=e[1].msg+"";return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(c),a=C("a"),a.textContent="Installer",T(o,"data-status",s=e[1].code),T(o,"class","svelte-jp9cw7"),T(a,"href","."),T(t,"class","svelte-jp9cw7")},m(s,c){x(s,t,c),b(t,n),b(t,o),b(o,r),b(t,a),l||(i=_(a,"click",M(e[4])),l=!0)},p(e,t){2&t&&c!==(c=e[1].msg+"")&&O(r,c),2&t&&s!==(s=e[1].code)&&T(o,"data-status",s)},d(e){e&&k(t),l=!1,i()}}}function ro(t){let n,o,r,s,a;return{c(){n=C("p"),o=L("La page n'est pas controllée par le service worker. "),r=C("a"),r.textContent="Recharger la page",T(r,"href","./index.html"),T(n,"class","svelte-jp9cw7")},m(e,l){x(e,n,l),b(n,o),b(n,r),s||(a=_(r,"click",t[5]),s=!0)},p:e,d(e){e&&k(n),s=!1,a()}}}function so(e){let t;function n(e,t){return e[0]===mo?lo:ao}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function ao(e){let t;return{c(){t=L(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&O(t,e[0])},d(e){e&&k(t)}}}function lo(e){let t;function n(e,t){return e[3]?co:io}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function io(t){let n;return{c(){n=L("non connecté")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function co(e){let t,n,o,r;return{c(){t=C("a"),n=L(e[0]),T(t,"href",".")},m(s,a){x(s,t,a),b(t,n),o||(r=_(t,"click",M(e[7])),o=!0)},p(e,t){1&t&&O(n,e[0])},d(e){e&&k(t),o=!1,r()}}}function uo(t){let n;return{c(){n=C("p"),n.textContent="Vos réglages seront conservés mais l'OFP sera remis à zéro.",T(n,"class","svelte-jp9cw7")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function po(t){let n,o,r,s,a,l,i;return{c(){n=C("p"),o=C("a"),o.textContent="Réinitialiser l'App",r=L(" va en plus réinitialiser le service Worker (il faut être connecté)."),s=F(),a=C("p"),a.textContent="Dans les 2 cas vos réglages sont conservés mais l'OFP est remis à zéro.",T(o,"class","btn btn-danger btn-sm"),T(o,"href","./index.html"),T(n,"class","svelte-jp9cw7"),T(a,"class","svelte-jp9cw7")},m(e,c){x(e,n,c),b(n,o),b(n,r),x(e,s,c),x(e,a,c),l||(i=_(o,"click",t[6]),l=!0)},p:e,d(e){e&&k(n),e&&k(s),e&&k(a),l=!1,i()}}}function fo(e){let t,n,o,r,s,a,l,i,c=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[2]?2===e[1].code?oo:no:ro}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}(e),u=!0===navigator.standalone&&function(e){let t,n,o,r,s,a,l,i,c;function u(e,t){return e[3]?po:uo}let p=u(e),d=p(e);return{c(){t=C("p"),t.innerHTML="<b>En cas de problème:</b>",n=F(),o=C("p"),r=C("a"),r.textContent="Recharger l'App",s=L(" c'est l'équivalent d'un rechargement de page."),a=F(),d.c(),l=j(),T(t,"class","svelte-jp9cw7"),T(r,"class","btn btn-primary btn-sm svelte-jp9cw7"),T(r,"href","./index.html"),T(o,"class","svelte-jp9cw7")},m(u,p){x(u,t,p),x(u,n,p),x(u,o,p),b(o,r),b(o,s),x(u,a,p),d.m(u,p),x(u,l,p),i||(c=_(r,"click",e[5]),i=!0)},p(e,t){p===(p=u(e))&&d?d.p(e,t):(d.d(1),d=p(e),d&&(d.c(),d.m(l.parentNode,l)))},d(e){e&&k(t),e&&k(n),e&&k(o),e&&k(a),d.d(e),e&&k(l),i=!1,c()}}}(e);return l=new to({}),{c(){t=C("div"),n=C("p"),n.textContent="Application version: 1.3.7",o=F(),c&&c.c(),r=F(),u&&u.c(),s=F(),a=C("div"),xe(l.$$.fragment),T(n,"class","svelte-jp9cw7"),T(t,"class","info svelte-jp9cw7"),T(a,"class","markdown svelte-jp9cw7")},m(e,p){x(e,t,p),b(t,n),b(t,o),c&&c.m(t,null),b(t,r),u&&u.m(t,null),x(e,s,p),x(e,a,p),ke(l,a,null),i=!0},p(e,[t]){navigator.serviceWorker&&c.p(e,t),!0===navigator.standalone&&u.p(e,t)},i(e){i||(ge(l.$$.fragment,e),i=!0)},o(e){ve(l.$$.fragment,e),i=!1},d(e){e&&k(t),c&&c.d(),u&&u.d(),e&&k(s),e&&k(a),we(l)}}}const mo="Vérifier Mise à jour";function go(e,t,n){let o,r,s,a;l(e,Gt,(e=>n(11,s=e))),l(e,Ut,(e=>n(3,a=e)));let i=window.serviceWorker,c=!0;!i&&navigator.serviceWorker&&navigator.serviceWorker.ready.then((e=>(n(8,i=e),e))).catch((e=>n(9,c=!1)));let u=navigator.serviceWorker&&navigator.serviceWorker.controller,p=mo;const f=e=>e?e.installing?{code:1,msg:"🔹 installing"}:e.waiting?{code:2,msg:"🔸 waiting"}:e.active?{code:3,msg:"🟢"}:void 0:{code:0,msg:"🔺 unknown"},m=()=>{window.location.reload()};return e.$$.update=()=>{256&e.$$.dirty&&n(1,o=f(i)),512&e.$$.dirty&&n(2,r=u&&c)},window.editolido&&window.editolido.version,[p,o,r,a,()=>{i.waiting&&(d(Gt,s=!0,s),i.waiting.postMessage("SKIP_WAITING"))},m,e=>{if(!window.confirm("Vous devez être connecté au réseau, ceci ne devrait être utile qu'en cas de bug, Réinitialiser ?"))return e.preventDefault(),!1;i&&i.unregister(),m()},()=>{n(0,p="Vérification... "),d(Gt,s=!1,s),i.update().then((e=>{3!==f(e).code?(n(0,p=""),n(8,i)):n(0,p="À jour")})).catch((e=>n(0,p=e)))},i,c]}class vo extends Pe{constructor(e){super(),Ce(this,e,go,fo,a,{})}}function ho(t){return{c:e,m:e,p:e,d:e}}function yo(e){let t,n=e[5]&&!e[1]&&$o(e);return{c(){n&&n.c(),t=j()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=$o(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function $o(e){let t,n,o,s,a,l,i,c,u,p,d;function f(e,t){return e[0]?bo:xo}let m=f(e),g=m(e);function v(){return e[4](e[5])}return{c(){t=C("div"),n=C("div"),o=C("strong"),o.innerHTML='<span class="svelte-5snzlz">👨🏻‍✈️</span>Mise à jour disponible',s=F(),a=C("button"),a.innerHTML='<span aria-hidden="true">×</span>',l=F(),i=C("div"),g.c(),c=F(),u=C("button"),u.textContent="Installer",T(o,"class","mr-auto svelte-5snzlz"),T(a,"type","button"),T(a,"class","ml-2 mb-1 close"),T(a,"aria-label","Close"),T(n,"class","toast-header"),T(u,"type","button"),T(u,"class","btn"),D(u,"btn-primary",!e[0]),D(u,"btn-danger",e[0]),T(i,"class","toast-body text-center"),T(t,"class","toast svelte-5snzlz"),I(t,"position","absolute"),I(t,"top","0"),I(t,"right","0")},m(r,f){x(r,t,f),b(t,n),b(n,o),b(n,s),b(n,a),b(t,l),b(t,i),g.m(i,null),b(i,c),b(i,u),p||(d=[_(a,"click",e[3]),_(u,"click",v)],p=!0)},p(t,n){m!==(m=f(e=t))&&(g.d(1),g=m(e),g&&(g.c(),g.m(i,c))),1&n&&D(u,"btn-primary",!e[0]),1&n&&D(u,"btn-danger",e[0])},d(e){e&&k(t),g.d(),p=!1,r(d)}}}function bo(e){let t;return{c(){t=C("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function xo(e){let t;return{c(){t=C("p"),t.textContent="Celà va recharger l'App"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ko(t){return{c:e,m:e,p:e,d:e}}function wo(t){let n,o={ctx:t,current:null,token:null,hasCatch:!1,pending:ko,then:yo,catch:ho,value:5};return ye(window.isSWUpdateAvailable.promise,o),{c(){n=j(),o.block.c()},m(e,t){x(e,n,t),o.block.m(e,o.anchor=t),o.mount=()=>n.parentNode,o.anchor=n},p(e,[n]){{const r=(t=e).slice();r[5]=o.resolved,o.block.p(r,n)}},i:e,o:e,d(e){e&&k(n),o.block.d(e),o.token=null,o=null}}}function Co(e,t,n){let o;l(e,Gt,(e=>n(1,o=e)));let{loaded:r=!1}=t;const s=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,s,()=>d(Gt,o=!0,o),e=>s(e)]}class Po extends Pe{constructor(e){super(),Ce(this,e,Co,wo,a,{loaded:0})}}const{window:Lo}=$e;function Fo(e){let t,n,o,r,s,a;function l(t){e[9](t)}let i={kmlOptions:e[2]};return void 0!==e[1]&&(i.promise=e[1]),n=new Vn({props:i}),V.push((()=>be(n,"promise",l))),n.$on("change",e[5]),{c(){t=C("form"),xe(n.$$.fragment),T(t,"class","form-inline svelte-1pvavz"),D(t,"invisible","/help"===e[0])},m(o,l){x(o,t,l),ke(n,t,null),r=!0,s||(a=_(t,"submit",M(e[8])),s=!0)},p(e,r){const s={};4&r&&(s.kmlOptions=e[2]),!o&&2&r&&(o=!0,s.promise=e[1],oe((()=>o=!1))),n.$set(s),1&r&&D(t,"invisible","/help"===e[0])},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&k(t),we(n),s=!1,a()}}}function jo(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:So,then:Mo,catch:_o,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=j(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function _o(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s),D(n,"d-none","/map"!==t[0])},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&O(r,s),1&t&&D(n,"d-none","/map"!==e[0])},i:e,o:e,d(e){e&&k(n)}}}function Mo(e){let t,n;return t=new Qn({props:{hidden:"/map"!==e[0],$$slots:{default:[To]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131079&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function To(e){let t,n,o;function r(t){e[10](t)}let s={id:"map",ofp:e[15],route:e[0]};return void 0!==e[2]&&(s.kmlOptions=e[2]),t=new On({props:s}),V.push((()=>be(t,"kmlOptions",r))),t.$on("save",e[4]),{c(){xe(t.$$.fragment)},m(e,n){ke(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[15]),1&o&&(r.route=e[0]),!n&&4&o&&(n=!0,r.kmlOptions=e[2],oe((()=>n=!1))),t.$set(r)},i(e){o||(ge(t.$$.fragment,e),o=!0)},o(e){ve(t.$$.fragment,e),o=!1},d(e){we(t,e)}}}function So(e){let t,n;return t=new Qn({props:{hidden:"/map"!==e[0],$$slots:{default:[Oo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Oo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",I(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function zo(e){let t,n;return t=new Qn({props:{$$slots:{default:[qo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Io(e){let t,n;return t=new Qn({props:{$$slots:{default:[Do]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Ao(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Uo,then:Eo,catch:Ro,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=j(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function qo(e){let t,n;return t=new vo({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Do(e){let t,n;return t=new jt({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Ro(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s)},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&O(r,s)},i:e,o:e,d(e){e&&k(n)}}}function Eo(e){let t,n,o,r;const s=[Wo,No],a=[];function l(e,t){return"/gramet"===e[0]?0:"/export"===e[0]?1:-1}return~(t=l(e))&&(n=a[t]=s[t](e)),{c(){n&&n.c(),o=j()},m(e,n){~t&&a[t].m(e,n),x(e,o,n),r=!0},p(e,r){let i=t;t=l(e),t===i?~t&&a[t].p(e,r):(n&&(fe(),ve(a[i],1,1,(()=>{a[i]=null})),me()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=s[t](e),n.c()),ge(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(ge(n),r=!0)},o(e){ve(n),r=!1},d(e){~t&&a[t].d(e),e&&k(o)}}}function No(e){let t,n;return t=new Qn({props:{$$slots:{default:[Go]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Wo(e){let t,n;return t=new Qn({props:{$$slots:{default:[Ho]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Go(e){let t,n,o,r;return t=new bt({props:{ofp:e[15]}}),t.$on("save",e[4]),o=new Ue({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment),n=F(),xe(o.$$.fragment)},m(e,s){ke(t,e,s),x(e,n,s),ke(o,e,s),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[15]),t.$set(r);const s={};2&n&&(s.ofp=e[15]),o.$set(s)},i(e){r||(ge(t.$$.fragment,e),ge(o.$$.fragment,e),r=!0)},o(e){ve(t.$$.fragment,e),ve(o.$$.fragment,e),r=!1},d(e){we(t,e),e&&k(n),we(o,e)}}}function Ho(e){let t,n;return t=new Lt({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[15]),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Uo(e){let t,n;return t=new Qn({props:{$$slots:{default:[Zo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Zo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",I(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Bo(e){let t,n,o,s,a,l,i,c,u,p,d,f,m;o=new En({props:{promise:e[1],route:e[0],$$slots:{default:[Fo]},$$scope:{ctx:e}}}),a=new Po({props:{loaded:!!e[1]}});let g=e[1]&&jo(e);const v=[Ao,Io,zo],h=[];function y(e,t){return"/gramet"===e[0]||"/export"===e[0]?0:"/"===e[0]?1:"/help"===e[0]?2:-1}return~(c=y(e))&&(u=h[c]=v[c](e)),{c(){t=C("main"),n=C("div"),xe(o.$$.fragment),s=F(),xe(a.$$.fragment),l=F(),g&&g.c(),i=F(),u&&u.c(),T(n,"class","content svelte-1pvavz"),T(t,"class",p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz")},m(r,u){x(r,t,u),b(t,n),ke(o,n,null),b(n,s),ke(a,n,null),b(n,l),g&&g.m(n,null),b(n,i),~c&&h[c].m(n,null),d=!0,f||(m=[_(Lo,"hashchange",e[3]),_(Lo,"online",e[6]),_(Lo,"offline",e[7])],f=!0)},p(e,[r]){const s={};2&r&&(s.promise=e[1]),1&r&&(s.route=e[0]),131079&r&&(s.$$scope={dirty:r,ctx:e}),o.$set(s);const l={};2&r&&(l.loaded=!!e[1]),a.$set(l),e[1]?g?(g.p(e,r),2&r&&ge(g,1)):(g=jo(e),g.c(),ge(g,1),g.m(n,i)):g&&(fe(),ve(g,1,1,(()=>{g=null})),me());let f=c;c=y(e),c===f?~c&&h[c].p(e,r):(u&&(fe(),ve(h[f],1,1,(()=>{h[f]=null})),me()),~c?(u=h[c],u?u.p(e,r):(u=h[c]=v[c](e),u.c()),ge(u,1),u.m(n,null)):u=null),(!d||1&r&&p!==(p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz"))&&T(t,"class",p)},i(e){d||(ge(o.$$.fragment,e),ge(a.$$.fragment,e),ge(g),ge(u),d=!0)},o(e){ve(o.$$.fragment,e),ve(a.$$.fragment,e),ve(g),ve(u),d=!1},d(e){e&&k(t),we(o),we(a),g&&g.d(),~c&&h[c].d(),f=!1,r(m)}}}function Ko(e,t,n){let o,r,s;l(e,Ht,(e=>n(12,o=e))),l(e,Gt,(e=>n(13,r=e))),l(e,Ut,(e=>n(14,s=e)));let a,i="/",c=window.location.href;(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in tt){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(Be)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||at.setItem(st.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&at.setItem(st.shortcut,o));at.setItem(st.optionsKML,n)})(window.location.search);let u=(e=>{const t={};for(let[n,o]of Object.entries(e))n in tt&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(Be)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...tt,...t}})(at.getItem(st.optionsKML)||{});const p=e=>{const t=document.querySelector("meta[name=viewport]"),r=t?t.getAttribute("content"):"";n(0,i=window.location.hash.substr(1)||"/"),a||"/map"!==i&&"/gramet"!==i&&"/export"!==i||n(0,i="/"),"/map"===i?(o&&d(Ht,o=!1,o),r&&t.setAttribute("content",r+",maximum-scale=1")):r&&t.setAttribute("content",r.replace(",maximum-scale=1",""))};p();const f=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(st)){let r=at.getItem(o);if(n===st.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==tt[t])))t[n]=e[n];r=t}if(null!==r)if(n===st.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(u);let n=Object.entries(t).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&");c=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+i,history.replaceState(t,"Mon OFP2MAP",c)};f();return[i,a,u,p,f,()=>{o&&d(Ht,o=!1,o),r&&d(Gt,r=!1,r),window.serviceWorker&&window.serviceWorker.update&&window.serviceWorker.update().catch((e=>{}))},()=>{d(Ut,s=!0,s)},()=>{d(Ut,s=!1,s)},function(t){K(e,t)},function(e){a=e,n(1,a)},function(e){u=e,n(2,u)}]}return new class extends Pe{constructor(e){super(),Ce(this,e,Ko,Bo,a,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
