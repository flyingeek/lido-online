var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function a(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o,r,s,l){const i=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(i){const r=c(t,n,o,l);e.p(r,i)}}function p(e){return null==e?"":e}function d(e,t,n=t){return e.set(n),t}function f(t){return t&&s(t.destroy)?t.destroy:e}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),v=m?e=>requestAnimationFrame(e):e;const h=new Set;function y(e){h.forEach((t=>{t.c(e)||(h.delete(t),t.f())})),0!==h.size&&v(y)}function $(e){let t;return 0===h.size&&v(y),{promise:new Promise((n=>{h.add(t={c:e,f:n})})),abort(){h.delete(t)}}}function b(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function F(){return L(" ")}function _(){return L("")}function j(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function O(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function I(e,t){e.value=null==t?"":t}function q(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function D(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function R(e,t,n){e.classList[n?"add":"remove"](t)}function z(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const E=new Set;let N,W=0;function G(e,t,n,o,r,s,l,i=0){const a=16.666/o;let c="{\n";for(let e=0;e<=1;e+=a){const o=t+(n-t)*s(e);c+=100*e+`%{${l(o,1-o)}}\n`}const u=c+`100% {${l(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,d=e.ownerDocument;E.add(d);const f=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(C("style")).sheet),m=d.__svelte_rules||(d.__svelte_rules={});m[p]||(m[p]=!0,f.insertRule(`@keyframes ${p} ${u}`,f.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,W+=1,p}function H(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),W-=r,W||v((()=>{W||(E.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),E.clear())})))}function U(e){N=e}function B(){if(!N)throw new Error("Function called outside component initialization");return N}function K(){const e=B();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=z(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function Z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const J=[],V=[],X=[],Y=[],Q=Promise.resolve();let ee=!1;function te(){ee||(ee=!0,Q.then(le))}function ne(e){X.push(e)}function oe(e){Y.push(e)}let re=!1;const se=new Set;function le(){if(!re){re=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];U(t),ie(t.$$)}for(U(null),J.length=0;V.length;)V.pop()();for(let e=0;e<X.length;e+=1){const t=X[e];se.has(t)||(se.add(t),t())}X.length=0}while(J.length);for(;Y.length;)Y.pop()();ee=!1,re=!1,se.clear()}}function ie(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let ae;function ce(){return ae||(ae=Promise.resolve(),ae.then((()=>{ae=null}))),ae}function ue(e,t,n){e.dispatchEvent(z(`${t?"intro":"outro"}${n}`))}const pe=new Set;let de;function fe(){de={r:0,c:[],p:de}}function me(){de.r||r(de.c),de=de.p}function ge(e,t){e&&e.i&&(pe.delete(e),e.i(t))}function ve(e,t,n,o){if(e&&e.o){if(pe.has(e))return;pe.add(e),de.c.push((()=>{pe.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const he={duration:0};function ye(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let l=t.ctx;void 0!==r&&(l=l.slice(),l[r]=s);const i=e&&(t.current=e)(l);let a=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(fe(),ve(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),me())})):t.block.d(1),i.c(),ge(i,1),i.m(t.mount(),t.anchor),a=!0),t.block=i,t.blocks&&(t.blocks[o]=i),a&&le()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=B();if(e.then((e=>{U(n),o(t.then,1,t.value,e),U(null)}),(e=>{if(U(n),o(t.catch,2,t.error,e),U(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const $e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function be(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function xe(e){e&&e.c()}function ke(e,t,o){const{fragment:l,on_mount:i,on_destroy:a,after_update:c}=e.$$;l&&l.m(t,o),ne((()=>{const t=i.map(n).filter(s);a?a.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(ne)}function we(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(t,n,s,l,i,a,c=[-1]){const u=N;U(t);const p=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:i,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=s?s(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),te(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!l&&l(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(k)}else p.fragment&&p.fragment.c();n.intro&&ge(t.$$.fragment),ke(t,n.target,n.anchor),le()}U(u)}class Pe{$destroy(){we(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Le{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Fe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,_e=matchMedia("(hover: hover)").matches;function je(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function Me(e,t,n){return e<=t?t:e>=n?n:e}function Te(e,t,n){return!(e<t)&&!(e>n)}function Se(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Oe(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ie(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function qe(e){let t;return{c(){t=C("textarea"),t.value=e[0],T(t,"class","svelte-12a0ij3")},m(n,o){x(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&k(t),e[6](null)}}}function Ae(t){let n,o,r;return{c(){n=C("a"),n.textContent="copier la route",T(n,"role","button"),T(n,"class","btn btn-primary svelte-12a0ij3"),T(n,"href","lhs-mpilot://")},m(e,s){x(e,n,s),o||(r=j(n,"click",t[4]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function De(t){let n,o,r,s,l;return{c(){n=C("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=C("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',T(n,"role","button"),T(n,"class","btn btn-primary svelte-12a0ij3"),T(n,"href","lhs-mpilot://"),T(r,"class","card-text")},m(e,i){x(e,n,i),x(e,o,i),x(e,r,i),s||(l=j(n,"click",t[4]),s=!0)},p:e,d(e){e&&k(n),e&&k(o),e&&k(r),s=!1,l()}}}function Re(n){let o,l,i;return{c(){o=C("span"),o.textContent="copié!",T(o,"class","svelte-12a0ij3")},m(e,t){x(e,o,t),i=!0},i(e){i||(l&&l.end(1),i=!0)},o(n){l=function(n,o,l){let i,a=o(n,l),c=!0;const u=de;function p(){const{delay:o=0,duration:s=300,easing:l=t,tick:p=e,css:d}=a||he;d&&(i=G(n,1,0,s,o,l,d));const f=g()+o,m=f+s;ne((()=>ue(n,!1,"start"))),$((e=>{if(c){if(e>=m)return p(0,1),ue(n,!1,"end"),--u.r||r(u.c),!1;if(e>=f){const t=l((e-f)/s);p(1-t,t)}}return c}))}return u.r+=1,s(a)?ce().then((()=>{a=a(),p()})):p(),{end(e){e&&a.tick&&a.tick(1,0),c&&(i&&H(n,i),c=!1)}}}(o,Ie,{}),i=!1},d(e){e&&k(o),e&&l&&l.end()}}}function ze(e){let t,n,o,r,s,l,i,a,c,u,p,d,f=null!=e[0]&&qe(e);let m=(Fe?De:Ae)(e),g=e[2]&&Re();return{c(){f&&f.c(),t=F(),n=C("div"),o=C("div"),r=C("h5"),r.textContent="Route Lido",s=F(),l=C("p"),l.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",i=F(),m.c(),a=F(),c=C("div"),u=L(e[3]),p=F(),g&&g.c(),T(r,"class","card-title"),T(l,"class","card-text"),T(c,"class","text-monospace svelte-12a0ij3"),T(o,"class","card-body"),T(n,"class","card mb-3 svelte-12a0ij3")},m(e,v){f&&f.m(e,v),x(e,t,v),x(e,n,v),b(n,o),b(o,r),b(o,s),b(o,l),b(o,i),m.m(o,null),b(o,a),b(o,c),b(c,u),b(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?f?f.p(e,n):(f=qe(e),f.c(),f.m(t.parentNode,t)):f&&(f.d(1),f=null),m.p(e,n),e[2]?g?4&n&&ge(g,1):(g=Re(),g.c(),ge(g,1),g.m(c,null)):g&&(fe(),ve(g,1,1,(()=>{g=null})),me())},i(e){d||(ge(g),d=!0)},o(e){ve(g),d=!1},d(e){f&&f.d(e),e&&k(t),e&&k(n),m.d(),g&&g.d()}}}let Ee=!1;try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Ee=!0)}))}catch(e){}function Ne(e,t,n){let o,{ofp:r}=t,s=null;const l=r?r.lidoRoute().join(" "):"";let i=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,i,l,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Ee)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await(te(),Q),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(l);Fe||(n(2,i=t),setTimeout((function(){n(2,i=!1)}),3e3),e.preventDefault())},r,function(e){V[e?"unshift":"push"]((()=>{o=e,n(1,o)}))}]}class We extends Pe{constructor(e){super(),Ce(this,e,Ne,ze,l,{ofp:5})}}function Ge(t){let n,o,l,i,a,c,u,p,d,m,g,v,h,y,$,w,P,_,M;return{c(){n=C("kmlcolor"),o=C("div"),l=C("label"),i=L("Couleur"),a=F(),c=C("picker"),u=C("label"),p=C("input"),g=F(),v=C("input"),y=F(),$=C("input"),T(l,"for",t[1]),T(l,"class","input-group-text svelte-1hvk4hi"),T(o,"class","input-group-prepend"),T(p,"type","color"),T(p,"class","svelte-1hvk4hi"),T(u,"style",d=Ze(t[2])),T(u,"class","svelte-1hvk4hi"),T(v,"type","range"),T(v,"min","30"),T(v,"max","255"),T(v,"class","svelte-1hvk4hi"),T(c,"class","form-control svelte-1hvk4hi"),T(c,"style",h=Ke(t[2][0])),T($,"name",t[1]),T($,"class","form-control text-monospace svelte-1hvk4hi"),T($,"style",w=Je(t[0])),T($,"type","text"),T($,"maxlength","8"),T(n,"class","input-group svelte-1hvk4hi")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,i),b(n,a),b(n,c),b(c,u),b(u,p),I(p,t[2][0]),b(c,g),b(c,v),I(v,t[2][1]),b(n,y),b(n,$),I($,t[0]),_||(M=[j(p,"input",t[5]),f(m=t[4].call(null,u,t[0])),j(v,"change",t[6]),j(v,"input",t[6]),f(P=t[3].call(null,$,t[2])),j($,"input",t[7])],_=!0)},p(e,[t]){2&t&&T(l,"for",e[1]),4&t&&I(p,e[2][0]),4&t&&d!==(d=Ze(e[2]))&&T(u,"style",d),m&&s(m.update)&&1&t&&m.update.call(null,e[0]),4&t&&I(v,e[2][1]),4&t&&h!==(h=Ke(e[2][0]))&&T(c,"style",h),2&t&&T($,"name",e[1]),1&t&&w!==(w=Je(e[0]))&&T($,"style",w),P&&s(P.update)&&4&t&&P.update.call(null,e[2]),1&t&&$.value!==e[0]&&I($,e[0])},i:e,o:e,d(e){e&&k(n),_=!1,r(M)}}}const He=/^[A-F0-9]{8}$/i,Ue=e=>{let[t,n]=Be(e);return[t,n/255]},Be=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},Ke=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Ze=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Je=e=>e.match(He)?"":"border-color: #F00;";function Ve(e,t,n){const o=K();let r,{kmlColor:s="FF0000FF"}=t,{name:l}=t;try{r=Be(s)}catch(e){r=["#FF0000",255]}const i=function(e,t,n){let o;return function(){const r=this,s=arguments,l=function(){o=null,n||e.apply(r,s)},i=n&&!o;clearTimeout(o),o=setTimeout(l,t),i&&e.apply(r,s)}}(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,l=e.name)},[s,l,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),i("change",{name:l,value:s})}}},function(e){return{update(e){if(e.match(He)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),i("change",{name:l,value:e.toUpperCase()})}}}},function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?null:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class Xe extends Pe{constructor(e){super(),Ce(this,e,Ve,Ge,l,{kmlColor:0,name:1})}}const Ye={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC"};function Qe(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const et=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Qe(window.kmlGen,Ye)),window.kmlGen);function tt(e,t){let n={...Ye,...t};const o=et();Qe(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,l=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),i=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),a=new editolido.Route([l.points[0],l.points[l.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",a),o.addLine("rmain",l),o.addPoints("rmain",l,{excluded:c}),o.addLine("ralt",i),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",i)}const nt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),ot=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function rt(t){let n,o,s,l,i,a,c,u,p,d;return{c(){n=C("div"),o=C("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',s=F(),l=C("input"),i=F(),a=C("div"),c=C("a"),u=L("Lancer"),T(o,"class","input-group-prepend"),T(l,"class","form-control svelte-1ecyaux"),T(l,"placeholder","Nom du raccourci"),T(l,"type","text"),T(c,"class","btn btn-outline-secondary svelte-1ecyaux"),T(c,"href",t[1]),R(c,"disabled",!(t[0].trim()&&Fe)),T(a,"class","input-group-append"),T(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,l),I(l,t[0]),b(n,i),b(n,a),b(a,c),b(c,u),p||(d=[j(l,"input",t[5]),j(l,"change",t[3]),j(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&l.value!==e[0]&&I(l,e[0]),2&t&&T(c,"href",e[1]),1&t&&R(c,"disabled",!(e[0].trim()&&Fe))},i:e,o:e,d(e){e&&k(n),p=!1,r(d)}}}const st="OFP2MAP";function lt(e,t,n){const o=K(),r=nt.shortcut;let s,l=ot.getItem(r)||st,{ofp:i}=t;const a=i?i.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,i=e.ofp)},[l,s,function(e){const t=l.trim();if(t&&Fe){const e=et(),o={lidoRoute:a,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:i.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=l.trim();e===st?ot.removeItem(r):ot.setItem(r,e),o("save",[r,e])},i,function(){l=this.value,n(0,l)}]}class it extends Pe{constructor(e){super(),Ce(this,e,lt,rt,l,{ofp:4})}}const at=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function s(e,t){return e.getElementsByTagName(t)}function l(e,t){return e.getAttribute(t)}function i(e,t){return parseFloat(l(e,t))}function a(e,t){var n=s(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function p(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=a(e,t[o]))&&(r[t[o]]=u(n));return r}function d(e,t){for(var n in t)e[n]=t[n]}function f(e){return c(e.replace(t,"").split(","))}function m(e){for(var t=e.replace(n,"").split(o),r=[],s=0;s<t.length;s++)r.push(f(t[s]));return r}function g(e){var t,n=[i(e,"lon"),i(e,"lat")],o=a(e,"ele"),r=a(e,"gpxtpx:hr")||a(e,"hr"),s=a(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:s?u(s):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},i={},p=["Polygon","LineString","Point","Track","gx:Track"],d=s(e,"Placemark"),g=s(e,"Style"),h=s(e,"StyleMap"),y=0;y<g.length;y++){var $=r(v(g[y])).toString(16);n["#"+l(g[y],"id")]=$,o[$]=g[y]}for(var b=0;b<h.length;b++){n["#"+l(h[b],"id")]=r(v(h[b])).toString(16);for(var x=s(h[b],"Pair"),k={},w=0;w<x.length;w++)k[u(a(x[w],"key"))]=u(a(x[w],"styleUrl"));i["#"+l(h[b],"id")]=k}for(var C=0;C<d.length;C++)t.features=t.features.concat(_(d[C]));function P(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function L(e){var t=s(e,"coord"),n=[],o=[];0===t.length&&(t=s(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var l=s(e,"when"),i=0;i<l.length;i++)o.push(u(l[i]));return{coords:n,times:o}}function F(e){var t,n,o,r,l,i=[],c=[];if(a(e,"MultiGeometry"))return F(a(e,"MultiGeometry"));if(a(e,"MultiTrack"))return F(a(e,"MultiTrack"));if(a(e,"gx:MultiTrack"))return F(a(e,"gx:MultiTrack"));for(o=0;o<p.length;o++)if(n=s(e,p[o]))for(r=0;r<n.length;r++)if(t=n[r],"Point"===p[o])i.push({type:"Point",coordinates:f(u(a(t,"coordinates")))});else if("LineString"===p[o])i.push({type:"LineString",coordinates:m(u(a(t,"coordinates")))});else if("Polygon"===p[o]){var d=s(t,"LinearRing"),g=[];for(l=0;l<d.length;l++)g.push(m(u(a(d[l],"coordinates"))));i.push({type:"Polygon",coordinates:g})}else if("Track"===p[o]||"gx:Track"===p[o]){var v=L(t);i.push({type:"LineString",coordinates:v.coords}),v.times.length&&c.push(v.times)}return{geoms:i,coordTimes:c}}function _(e){var t,r=F(e),c={},p=u(a(e,"name")),d=u(a(e,"address")),f=u(a(e,"styleUrl")),m=u(a(e,"description")),g=a(e,"TimeSpan"),v=a(e,"TimeStamp"),h=a(e,"ExtendedData"),y=a(e,"LineStyle"),$=a(e,"PolyStyle"),b=a(e,"visibility");if(!r.geoms.length)return[];if(p&&(c.name=p),d&&(c.address=d),f){"#"!==f[0]&&(f="#"+f),c.styleUrl=f,n[f]&&(c.styleHash=n[f]),i[f]&&(c.styleMapHash=i[f],c.styleHash=n[i[f].normal]);var x=o[c.styleHash];if(x){y||(y=a(x,"LineStyle")),$||($=a(x,"PolyStyle"));var k=a(x,"IconStyle");if(k){var w=a(k,"Icon");if(w){var C=u(a(w,"href"));C&&(c.icon=C)}}}}if(m&&(c.description=m),g){var L=u(a(g,"begin")),_=u(a(g,"end"));c.timespan={begin:L,end:_}}if(v&&(c.timestamp=u(a(v,"when"))),y){var j=P(u(a(y,"color"))),M=j[0],T=j[1],S=parseFloat(u(a(y,"width")));M&&(c.stroke=M),isNaN(T)||(c["stroke-opacity"]=T),isNaN(S)||(c["stroke-width"]=S)}if($){var O=P(u(a($,"color"))),I=O[0],q=O[1],A=u(a($,"fill")),D=u(a($,"outline"));I&&(c.fill=I),isNaN(q)||(c["fill-opacity"]=q),A&&(c["fill-opacity"]="1"===A?c["fill-opacity"]||1:0),D&&(c["stroke-opacity"]="1"===D?c["stroke-opacity"]||1:0)}if(h){var R=s(h,"Data"),z=s(h,"SimpleData");for(t=0;t<R.length;t++)c[R[t].getAttribute("name")]=u(a(R[t],"value"));for(t=0;t<z.length;t++)c[z[t].getAttribute("name")]=u(z[t])}b&&(c.visibility=u(b)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var E={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return l(e,"id")&&(E.id=l(e,"id")),[E]}return t},gpx:function(e){var t,n,o=s(e,"trk"),r=s(e,"rte"),i=s(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=v(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=h(r[t]))&&c.features.push(n);for(t=0;t<i.length;t++)c.features.push(y(i[t]));function f(e,t){for(var n=0;n<t;n++)e.push(null);return e}function m(e,t){var n=s(e,t),o=[],r=[],l=[],i=n.length;if(i<2)return{};for(var a=0;a<i;a++){var c=g(n[a]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||l.length)&&(l.length||f(l,a),l.push(c.heartRate||null))}return{line:o,times:r,heartRates:l}}function v(e){for(var t,n=s(e,"trkseg"),o=[],r=[],l=[],i=0;i<n.length;i++)if((t=m(n[i],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),l.length||t.heartRates&&t.heartRates.length)){if(!l.length)for(var c=0;c<i;c++)l.push(f([],o[c].length));t.heartRates&&t.heartRates.length?l.push(t.heartRates):l.push(f([],t.line.length||0))}if(0!==o.length){var u=b(e);return d(u,$(a(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),l.length&&(u.heartRates=1===o.length?l[0]:l),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function h(e){var t=m(e,"rtept");if(t.line){var n=b(e);return d(n,$(a(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=b(e);return d(t,p(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function $(e){var t={};if(e){var n=a(e,"line");if(n){var o=u(a(n,"color")),r=parseFloat(u(a(n,"opacity"))),s=parseFloat(u(a(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(s)||(t["stroke-width"]=96*s/25.4)}}return t}function b(e){var t=p(e,["name","cmt","desc","type","time","keywords"]),n=s(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)d(o={href:l(n[r],"href")},p(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function ct(t){let n,o,s,l,i,a,c,u,p,d,f,m,g,v,h,y,$,w=dt[0]+"",P=dt[1]+"",_=dt[2]+"";return{c(){n=C("div"),o=C("select"),s=C("option"),l=L(w),a=C("option"),c=L(P),p=C("option"),d=L(_),m=F(),g=C("div"),v=C("a"),h=L(t[0]),s.selected=i=0===t[1],s.__value=0,s.value=s.__value,a.selected=u=1===t[1],a.__value=1,a.value=a.__value,p.selected=f=2===t[1],p.__value=2,p.value=p.__value,T(o,"class","custom-select svelte-19hokx5"),T(o,"aria-label","Example select with button addon"),void 0===t[1]&&ne((()=>t[6].call(o))),T(v,"class","btn btn-success"),T(v,"download",t[3]),T(v,"href",t[2]),T(v,"target",ut),T(g,"class","input-group-append"),T(n,"class","input-group")},m(e,r){x(e,n,r),b(n,o),b(o,s),b(s,l),b(o,a),b(a,c),b(o,p),b(p,d),A(o,t[1]),b(n,m),b(n,g),b(g,v),b(v,h),y||($=[j(o,"change",t[6]),j(o,"change",t[5]),j(v,"click",t[4])],y=!0)},p(e,[t]){2&t&&i!==(i=0===e[1])&&(s.selected=i),2&t&&u!==(u=1===e[1])&&(a.selected=u),2&t&&f!==(f=2===e[1])&&(p.selected=f),2&t&&A(o,e[1]),1&t&&O(h,e[0]),8&t&&T(v,"download",e[3]),4&t&&T(v,"href",e[2])},i:e,o:e,d(e){e&&k(n),y=!1,r($)}}}const ut=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,pt=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},dt=["KML Mapsme","KML Avenza","GeoJson"];function ft(e,t,n){const o=K();let{label:r}=t;const s=nt.downloadType;let l=ot.getItem(s)||1;"string"==typeof l&&(l=parseInt(l,10));let i="",a="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,l,i,a,function(e){const t=et(),o=["_mapsme.kml","_avenza.kml",".geojson"][l];let r=t.name;if(r?(r=r.trim(),n(3,a=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,a="editolido"+o),0===l)n(2,i=pt(t.render()));else if(1===l)n(2,i=pt(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==l)return e.preventDefault(),!1;n(2,i=pt(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return at.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===l?ot.removeItem(s):ot.setItem(s,l),o("save",[s,l])},function(){l=D(this),n(1,l)}]}class mt extends Pe{constructor(e){super(),Ce(this,e,ft,ct,l,{label:0})}}function gt(e){let t,n,o,r,s,l,i,a,c,u,p,d,f,m,g;return i=new mt({props:{label:"Télécharger"}}),i.$on("save",e[1]),d=new it({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=C("div"),n=C("div"),o=C("h5"),o.textContent="Export",r=F(),s=C("div"),l=C("div"),xe(i.$$.fragment),a=F(),c=C("small"),c.textContent="Le fichier est généré en fonction des options choisies sur la carte.",u=F(),p=C("div"),xe(d.$$.fragment),f=F(),m=C("small"),m.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',T(o,"class","card-title"),T(c,"class","text-muted"),T(l,"class","col-12 col-sm-6 col-md-6"),T(m,"class","text-muted"),T(p,"class","col-12 col-sm-6 col-md-6"),T(s,"class","row"),T(n,"class","card-body"),T(t,"class","card mb-3 svelte-17snbjk")},m(e,v){x(e,t,v),b(t,n),b(n,o),b(n,r),b(n,s),b(s,l),ke(i,l,null),b(l,a),b(l,c),b(s,u),b(s,p),ke(d,p,null),b(p,f),b(p,m),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||(ge(i.$$.fragment,e),ge(d.$$.fragment,e),g=!0)},o(e){ve(i.$$.fragment,e),ve(d.$$.fragment,e),g=!1},d(e){e&&k(t),we(i),we(d)}}}function vt(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){Z(e,t)},function(t){Z(e,t)}]}class ht extends Pe{constructor(e){super(),Ce(this,e,vt,gt,l,{ofp:0})}}function yt(e){let t;return{c(){t=C("div"),t.innerHTML='<span class="sr-only">Loading...</span>',T(t,"class","spinner-border text-warning"),T(t,"role","status")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function $t(e){let t,n,o,r,s,l,i,a,c,u,p;return{c(){t=C("div"),n=C("p"),o=L("😱: Erreur de récupération du Gramet, "),r=C("a"),r.textContent="essayez à nouveau",s=L(" ou allez sur "),l=C("a"),i=L("ogimet"),c=L("."),T(r,"href","."),T(l,"href",a=e[0].ogimetData.url),T(l,"target","_blank"),T(n,"class","svelte-i1m2fr"),T(t,"class","error svelte-i1m2fr")},m(a,d){x(a,t,d),b(t,n),b(n,o),b(n,r),b(n,s),b(n,l),b(l,i),b(n,c),u||(p=j(r,"click",M(e[4])),u=!0)},p(e,t){1&t&&a!==(a=e[0].ogimetData.url)&&T(l,"href",a)},d(e){e&&k(t),u=!1,p()}}}function bt(e){let t,n,o,s;return{c(){t=C("img"),T(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&T(t,"src",n),T(t,"alt","gramet demo"),T(t,"class","img-fluid svelte-i1m2fr")},m(n,r){x(n,t,r),o||(s=[j(t,"error",e[2]),j(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&T(t,"src",n)},d(e){e&&k(t),o=!1,r(s)}}}function xt(t){let n,o,r,s,l,i,a,c,u,p,d,f,m,g,v,h,y,$,w,P,_,j="loading"===t[1]&&yt();function M(e,t){return"error"!==e[1]?bt:$t}let S=M(t),O=S(t);return{c(){n=C("div"),o=C("h1"),o.innerHTML='Le GRAMET est un météogramme représentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et à l&#39;heure de passage estimée, une coupe verticale de la météo prévue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interprétation</a>',r=F(),s=C("div"),j&&j.c(),l=F(),O.c(),i=F(),a=C("div"),c=C("div"),u=C("div"),p=C("div"),d=C("div"),d.textContent="Route Ogimet",f=F(),m=C("div"),g=C("p"),v=L("Le GRAMET est réalisé par "),h=C("a"),y=L("www.ogimet.com"),w=L(" à partir\n    d'une route calculée. Il est possible d'afficher la route sur la carte. Celà est\n    particulièrement utile lors des vols océaniques car il n'y a aucune station en mer."),P=F(),_=C("div"),_.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Après avoir sélectionner les stations météo proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectué pour réduire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',T(o,"class","svelte-i1m2fr"),T(s,"class","text-center svelte-i1m2fr"),T(d,"class","card-header svelte-i1m2fr"),T(h,"class","text-warning"),T(h,"href",$=t[0].ogimetData.url),T(h,"target","_blank"),T(g,"class","card-text"),T(m,"class","card-body"),T(p,"class","card ogimet svelte-i1m2fr"),T(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),T(_,"class","col-12 col-sm-6 col-md-6 col-xl-6"),T(c,"class","card-deck"),T(a,"class","row")},m(e,t){x(e,n,t),b(n,o),b(n,r),b(n,s),j&&j.m(s,null),b(s,l),O.m(s,null),b(n,i),b(n,a),b(a,c),b(c,u),b(u,p),b(p,d),b(p,f),b(p,m),b(m,g),b(g,v),b(g,h),b(h,y),b(g,w),b(c,P),b(c,_)},p(e,[t]){"loading"===e[1]?j||(j=yt(),j.c(),j.m(s,l)):j&&(j.d(1),j=null),S===(S=M(e))&&O?O.p(e,t):(O.d(1),O=S(e),O&&(O.c(),O.m(s,null))),1&t&&$!==($=e[0].ogimetData.url)&&T(h,"href",$)},i:e,o:e,d(e){e&&k(n),j&&j.d(),O.d()}}}function kt(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class wt extends Pe{constructor(e){super(),Ce(this,e,kt,xt,l,{ofp:0})}}function Ct(t){let n,o,r;return{c(){n=C("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-2y0613"/> en KML/GeoJSON',o=F(),r=C("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card avenza svelte-2y0613"><div class="card-header svelte-2y0613">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card mapsme svelte-2y0613"><div class="card-header svelte-2y0613">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le thème par défaut s&#39;accorde parfaitement avec les fichiers avions, également compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card ogimet svelte-2y0613"><div class="card-header svelte-2y0613">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card shortcuts svelte-2y0613"><div class="card-header svelte-2y0613">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Récupérez le KML, le Gramet, et une route Lido optimisée dans l&#39;app Raccourcis</p></div></div></div></div>',T(n,"class","text-center svelte-2y0613"),T(r,"class","row svelte-2y0613")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r)}}}class Pt extends Pe{constructor(e){super(),Ce(this,e,null,Ct,l,{})}}function Lt(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ft(e){let t,n,o,r=e[4].label+"";return{c(){t=C("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function _t(t){let n,o,l,i,a,c,u,p,d,f,m,g,v=jt,h=[];for(let e=0;e<v.length;e+=1)h[e]=Ft(Lt(t,v,e));return{c(){n=C("div"),o=C("div"),l=C("label"),i=L("Repère"),a=F(),c=C("span"),u=P("svg"),p=P("use"),d=F(),f=C("select");for(let e=0;e<h.length;e+=1)h[e].c();T(l,"class","input-group-text svelte-1j0ign2"),T(l,"for",t[1]),S(p,"xlink:href","#marker"),q(p,"stroke",0===t[0]?"#fff":"#000"),q(p,"fill",jt[t[0]].color),T(u,"class","svelte-1j0ign2"),T(c,"class","input-group-text svelte-1j0ign2"),T(o,"class","input-group-prepend"),T(f,"name",t[1]),T(f,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ne((()=>t[3].call(f))),T(n,"class","input-group svelte-1j0ign2")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,i),b(o,a),b(o,c),b(c,u),b(u,p),b(n,d),b(n,f);for(let e=0;e<h.length;e+=1)h[e].m(f,null);A(f,t[0]),m||(g=[j(f,"change",t[3]),j(f,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],m=!0)},p(e,[n]){if(t=e,2&n&&T(l,"for",t[1]),1&n&&q(p,"stroke",0===t[0]?"#fff":"#000"),1&n&&q(p,"fill",jt[t[0]].color),1&n){let e;for(v=jt,e=0;e<v.length;e+=1){const o=Lt(t,v,e);h[e]?h[e].p(o,n):(h[e]=Ft(o),h[e].c(),h[e].m(f,null))}for(;e<h.length;e+=1)h[e].d(1);h.length=v.length}2&n&&T(f,"name",t[1]),1&n&&A(f,t[0])},i:e,o:e,d(e){e&&k(n),w(h,e),m=!1,r(g)}}}const jt=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Mt(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class Tt extends Pe{constructor(e){super(),Ce(this,e,Mt,_t,l,{selected:0,name:1})}}function St(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ot(e){let t,n,o,r=e[4].label+"";return{c(){t=C("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),b(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function It(t){let n,o,l,i,a,c,u,p,d=qt,f=[];for(let e=0;e<d.length;e+=1)f[e]=Ot(St(t,d,e));return{c(){n=C("div"),o=C("div"),l=C("label"),i=L("Couleur"),a=F(),c=C("select");for(let e=0;e<f.length;e+=1)f[e].c();T(l,"class","input-group-text svelte-90luj4"),T(l,"for",t[1]),T(o,"class","input-group-prepend"),T(c,"name",t[1]),T(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ne((()=>t[3].call(c))),T(n,"class","input-group svelte-90luj4")},m(e,r){x(e,n,r),b(n,o),b(o,l),b(l,i),b(n,a),b(n,c);for(let e=0;e<f.length;e+=1)f[e].m(c,null);A(c,t[0]),u||(p=[j(c,"change",t[3]),j(c,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],u=!0)},p(e,[n]){if(t=e,2&n&&T(l,"for",t[1]),1&n){let e;for(d=qt,e=0;e<d.length;e+=1){const o=St(t,d,e);f[e]?f[e].p(o,n):(f[e]=Ot(o),f[e].c(),f[e].m(c,null))}for(;e<f.length;e+=1)f[e].d(1);f.length=d.length}2&n&&T(c,"name",t[1]),1&n&&A(c,t[0])},i:e,o:e,d(e){e&&k(n),w(f,e),u=!1,r(p)}}}const qt=[{label:"statuts"},{label:"vert/rouge"}];function At(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class Dt extends Pe{constructor(e){super(),Ce(this,e,At,It,l,{selected:0,name:1})}}const Rt=[];function zt(t,n=e){let o;const r=[];function s(e){if(l(t,e)&&(t=e,o)){const e=!Rt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Rt.push(n,t)}if(e){for(let e=0;e<Rt.length;e+=2)Rt[e][0](Rt[e+1]);Rt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(l,i=e){const a=[l,i];return r.push(a),1===r.length&&(o=n(s)||e),l(t),()=>{const e=r.indexOf(a);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const Et=zt(!1),Nt=zt(!1),Wt=zt(navigator.onLine);function Gt(t){let n,o,r;return{c(){n=C("button"),n.textContent="Revenir aux valeurs par défaut",T(n,"class","btn btn-link btn-sm float-right"),T(n,"type","button")},m(e,s){x(e,n,s),o||(r=j(n,"click",t[7]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function Ht(e){let t,n,o,s,l,i,a,c,u,d,f,m,g,v,h,y,$,w,_,O,I,q,A,D,z,E,N,W,G,H,U,B,K,Z,J,V,X,Y,Q,ee,te,ne,oe,re,se,le,ie,ae,ce,ue,pe,de,fe,me,he,ye,$e,be,Ce,Pe,Le,Fe,_e,je,Me,Te,Se,Oe,Ie,qe,Ae,De,Re,ze,Ee,Ne,We,Ge,He,Ue,Be,Ke,Ze,Je,Ve,Ye,Qe,et,tt,nt,ot,rt,st,lt,it,at,ct,ut,pt,dt,ft,mt,gt,vt,ht,yt,$t,bt,xt,kt,wt,Ct,Pt,Lt,Ft,_t,jt,Mt,St,Ot,It,qt,At,Rt,zt,Et,Nt,Wt,Ht,Ut,Bt;y=new Xe({props:{name:"route-color",kmlColor:e[0].routeColor}}),y.$on("change",e[6]),O=new Tt({props:{name:"route-pin",selected:e[0].routePin}}),O.$on("change",e[6]),U=new Xe({props:{name:"alternate-color",kmlColor:e[0].alternateColor}}),U.$on("change",e[6]),J=new Tt({props:{name:"alternate-pin",selected:e[0].alternatePin}}),J.$on("change",e[6]),le=new Xe({props:{name:"nat-color",kmlColor:e[0].natColor}}),le.$on("change",e[6]),de=new Tt({props:{name:"nat-pin",selected:e[0].natPin}}),de.$on("change",e[6]),Se=new Xe({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}}),Se.$on("change",e[6]),He=new Xe({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}}),He.$on("change",e[6]),rt=new Xe({props:{name:"etops-color",kmlColor:e[0].etopsColor}}),rt.$on("change",e[6]),vt=new Dt({props:{name:"airport-pin",selected:e[0].airportPin}}),vt.$on("change",e[6]);let Kt=!e[3]&&Gt(e);return{c(){t=C("div"),n=C("a"),o=P("svg"),s=P("use"),l=F(),i=C("a"),a=P("svg"),c=P("use"),u=F(),d=C("form"),f=C("fieldset"),m=C("legend"),m.textContent="Route",g=F(),v=C("div"),h=C("div"),xe(y.$$.fragment),w=F(),_=C("div"),xe(O.$$.fragment),q=F(),A=C("fieldset"),D=C("legend"),z=C("input"),N=L("Dégagement"),W=F(),G=C("div"),H=C("div"),xe(U.$$.fragment),K=F(),Z=C("div"),xe(J.$$.fragment),X=F(),Y=C("fieldset"),Q=C("legend"),ee=C("input"),ne=L("Tracks"),oe=F(),re=C("div"),se=C("div"),xe(le.$$.fragment),ie=F(),ae=C("small"),ae.textContent="Un track incomplet restera rouge.",ue=F(),pe=C("div"),xe(de.$$.fragment),fe=F(),me=C("small"),me.textContent="Positionné à l'entrée des tracks.",ye=F(),$e=C("div"),be=C("div"),Ce=C("fieldset"),Pe=C("legend"),Le=C("input"),_e=L("Orthodromie"),je=F(),Me=C("div"),Te=C("div"),xe(Se.$$.fragment),Ie=F(),qe=C("div"),Ae=C("fieldset"),De=C("legend"),Re=C("input"),Ee=L("Route du GRAMET"),Ne=F(),We=C("div"),Ge=C("div"),xe(He.$$.fragment),Be=F(),Ke=C("div"),Ze=C("div"),Je=C("fieldset"),Ve=C("legend"),Ye=C("input"),et=L("Etops"),tt=F(),nt=C("div"),ot=C("div"),xe(rt.$$.fragment),lt=F(),it=C("div"),at=C("fieldset"),ct=C("legend"),ut=C("input"),dt=L("Airports"),ft=F(),mt=C("div"),gt=C("div"),xe(vt.$$.fragment),yt=F(),$t=C("div"),bt=C("div"),xt=C("fieldset"),kt=C("legend"),wt=C("input"),Pt=L("FIR SÛRETÉ"),Ft=F(),_t=C("div"),jt=C("div"),Mt=C("button"),St=L("Mémoriser"),It=F(),qt=C("button"),At=L("Restaurer"),Et=F(),Nt=C("div"),Kt&&Kt.c(),S(s,"xlink:href","#bars"),T(o,"class","svelte-qfeyuc"),R(o,"blink",e[2]),T(n,"class","hamburger svelte-qfeyuc"),T(n,"role","button"),T(n,"href","."),S(c,"xlink:href","#close"),T(a,"class","svelte-qfeyuc"),R(a,"blink",e[2]),T(i,"class","closeB svelte-qfeyuc"),T(i,"role","button"),T(i,"href","."),T(m,"class","svelte-qfeyuc"),T(h,"class",$=p(e[1])+" svelte-qfeyuc"),T(_,"class",I=p(e[1])+" svelte-qfeyuc"),T(v,"class","row"),T(f,"class","form-group svelte-qfeyuc"),T(z,"name","alternate-display"),z.checked=E=e[0].alternateDisplay,T(z,"type","checkbox"),T(z,"class","svelte-qfeyuc"),T(D,"class","svelte-qfeyuc"),T(H,"class",B=p(e[1])+" svelte-qfeyuc"),T(Z,"class",V=p(e[1])+" svelte-qfeyuc"),T(G,"class","row"),T(A,"class","form-group svelte-qfeyuc"),T(ee,"name","nat-display"),ee.checked=te=e[0].natDisplay,T(ee,"type","checkbox"),T(ee,"class","svelte-qfeyuc"),T(Q,"class","svelte-qfeyuc"),T(ae,"class","form-text text-muted svelte-qfeyuc"),T(se,"class",ce=p(e[1])+" svelte-qfeyuc"),T(me,"class","form-text text-muted svelte-qfeyuc"),T(pe,"class",he=p(e[1])+" svelte-qfeyuc"),T(re,"class","row"),T(Y,"class","form-group svelte-qfeyuc"),T(Le,"name","great-circle-display"),Le.checked=Fe=e[0].greatCircleDisplay,T(Le,"type","checkbox"),T(Le,"class","svelte-qfeyuc"),T(Pe,"class","svelte-qfeyuc"),T(Te,"class","col"),T(Me,"class","row"),T(Ce,"class","form-group svelte-qfeyuc"),T(be,"class",Oe=p(e[1])+" svelte-qfeyuc"),T(Re,"name","ogimet-display"),Re.checked=ze=e[0].ogimetDisplay,T(Re,"type","checkbox"),T(Re,"class","svelte-qfeyuc"),T(De,"class","svelte-qfeyuc"),T(Ge,"class","col"),T(We,"class","row"),T(Ae,"class","form-group svelte-qfeyuc"),T(qe,"class",Ue=p(e[1])+" svelte-qfeyuc"),T($e,"class","row"),T(Ye,"name","etops-display"),Ye.checked=Qe=e[0].etopsDisplay,T(Ye,"type","checkbox"),T(Ye,"class","svelte-qfeyuc"),T(Ve,"class","svelte-qfeyuc"),T(ot,"class","col"),T(nt,"class","row"),T(Je,"class","form-group svelte-qfeyuc"),T(Ze,"class",st=p(e[1])+" svelte-qfeyuc"),T(ut,"name","airport-display"),ut.checked=pt=e[0].airportDisplay,T(ut,"type","checkbox"),T(ut,"class","svelte-qfeyuc"),T(ct,"class","svelte-qfeyuc"),T(gt,"class","col"),T(mt,"class","row"),T(at,"class","form-group svelte-qfeyuc"),T(it,"class",ht=p(e[1])+" svelte-qfeyuc"),T(Ke,"class","row"),T(wt,"name","fir-display"),wt.checked=Ct=e[0].firDisplay,T(wt,"type","checkbox"),T(wt,"class","svelte-qfeyuc"),T(kt,"class","svelte-qfeyuc"),T(xt,"class","form-group svelte-qfeyuc"),T(bt,"class",Lt=p(e[1])+" svelte-qfeyuc"),T($t,"class","row"),Mt.disabled=Ot=!e[4],T(Mt,"class","btn btn-primary btn-sm mb-2"),T(Mt,"type","button"),qt.disabled=Rt=!e[4],T(qt,"class","btn btn-secondary btn-sm mb-2"),T(qt,"type","button"),T(jt,"class",zt=p(e[1])+" svelte-qfeyuc"),T(Nt,"class",Wt=p(e[1])+" svelte-qfeyuc"),T(_t,"class","row last svelte-qfeyuc"),T(d,"class","svelte-qfeyuc"),T(t,"class","settings svelte-qfeyuc"),R(t,"sidebar",e[5])},m(r,p){x(r,t,p),b(t,n),b(n,o),b(o,s),b(t,l),b(t,i),b(i,a),b(a,c),b(t,u),b(t,d),b(d,f),b(f,m),b(f,g),b(f,v),b(v,h),ke(y,h,null),b(v,w),b(v,_),ke(O,_,null),b(d,q),b(d,A),b(A,D),b(D,z),b(D,N),b(A,W),b(A,G),b(G,H),ke(U,H,null),b(G,K),b(G,Z),ke(J,Z,null),b(d,X),b(d,Y),b(Y,Q),b(Q,ee),b(Q,ne),b(Y,oe),b(Y,re),b(re,se),ke(le,se,null),b(se,ie),b(se,ae),b(re,ue),b(re,pe),ke(de,pe,null),b(pe,fe),b(pe,me),b(d,ye),b(d,$e),b($e,be),b(be,Ce),b(Ce,Pe),b(Pe,Le),b(Pe,_e),b(Ce,je),b(Ce,Me),b(Me,Te),ke(Se,Te,null),b($e,Ie),b($e,qe),b(qe,Ae),b(Ae,De),b(De,Re),b(De,Ee),b(Ae,Ne),b(Ae,We),b(We,Ge),ke(He,Ge,null),b(d,Be),b(d,Ke),b(Ke,Ze),b(Ze,Je),b(Je,Ve),b(Ve,Ye),b(Ve,et),b(Je,tt),b(Je,nt),b(nt,ot),ke(rt,ot,null),b(Ke,lt),b(Ke,it),b(it,at),b(at,ct),b(ct,ut),b(ct,dt),b(at,ft),b(at,mt),b(mt,gt),ke(vt,gt,null),b(d,yt),b(d,$t),b($t,bt),b(bt,xt),b(xt,kt),b(kt,wt),b(kt,Pt),b(d,Ft),b(d,_t),b(_t,jt),b(jt,Mt),b(Mt,St),b(jt,It),b(jt,qt),b(qt,At),b(_t,Et),b(_t,Nt),Kt&&Kt.m(Nt,null),Ht=!0,Ut||(Bt=[j(n,"click",M(e[12])),j(i,"click",M(e[13])),j(z,"change",e[6]),j(ee,"change",e[6]),j(Le,"change",e[6]),j(Re,"change",e[6]),j(Ye,"change",e[6]),j(ut,"change",e[6]),j(wt,"change",e[6]),j(Mt,"click",e[9]),j(qt,"click",e[8]),j(d,"submit",M(e[11]))],Ut=!0)},p(e,[n]){4&n&&R(o,"blink",e[2]),4&n&&R(a,"blink",e[2]);const r={};1&n&&(r.kmlColor=e[0].routeColor),y.$set(r),(!Ht||2&n&&$!==($=p(e[1])+" svelte-qfeyuc"))&&T(h,"class",$);const s={};1&n&&(s.selected=e[0].routePin),O.$set(s),(!Ht||2&n&&I!==(I=p(e[1])+" svelte-qfeyuc"))&&T(_,"class",I),(!Ht||1&n&&E!==(E=e[0].alternateDisplay))&&(z.checked=E);const l={};1&n&&(l.kmlColor=e[0].alternateColor),U.$set(l),(!Ht||2&n&&B!==(B=p(e[1])+" svelte-qfeyuc"))&&T(H,"class",B);const i={};1&n&&(i.selected=e[0].alternatePin),J.$set(i),(!Ht||2&n&&V!==(V=p(e[1])+" svelte-qfeyuc"))&&T(Z,"class",V),(!Ht||1&n&&te!==(te=e[0].natDisplay))&&(ee.checked=te);const c={};1&n&&(c.kmlColor=e[0].natColor),le.$set(c),(!Ht||2&n&&ce!==(ce=p(e[1])+" svelte-qfeyuc"))&&T(se,"class",ce);const u={};1&n&&(u.selected=e[0].natPin),de.$set(u),(!Ht||2&n&&he!==(he=p(e[1])+" svelte-qfeyuc"))&&T(pe,"class",he),(!Ht||1&n&&Fe!==(Fe=e[0].greatCircleDisplay))&&(Le.checked=Fe);const d={};1&n&&(d.kmlColor=e[0].greatCircleColor),Se.$set(d),(!Ht||2&n&&Oe!==(Oe=p(e[1])+" svelte-qfeyuc"))&&T(be,"class",Oe),(!Ht||1&n&&ze!==(ze=e[0].ogimetDisplay))&&(Re.checked=ze);const f={};1&n&&(f.kmlColor=e[0].ogimetColor),He.$set(f),(!Ht||2&n&&Ue!==(Ue=p(e[1])+" svelte-qfeyuc"))&&T(qe,"class",Ue),(!Ht||1&n&&Qe!==(Qe=e[0].etopsDisplay))&&(Ye.checked=Qe);const m={};1&n&&(m.kmlColor=e[0].etopsColor),rt.$set(m),(!Ht||2&n&&st!==(st=p(e[1])+" svelte-qfeyuc"))&&T(Ze,"class",st),(!Ht||1&n&&pt!==(pt=e[0].airportDisplay))&&(ut.checked=pt);const g={};1&n&&(g.selected=e[0].airportPin),vt.$set(g),(!Ht||2&n&&ht!==(ht=p(e[1])+" svelte-qfeyuc"))&&T(it,"class",ht),(!Ht||1&n&&Ct!==(Ct=e[0].firDisplay))&&(wt.checked=Ct),(!Ht||2&n&&Lt!==(Lt=p(e[1])+" svelte-qfeyuc"))&&T(bt,"class",Lt),(!Ht||16&n&&Ot!==(Ot=!e[4]))&&(Mt.disabled=Ot),(!Ht||16&n&&Rt!==(Rt=!e[4]))&&(qt.disabled=Rt),(!Ht||2&n&&zt!==(zt=p(e[1])+" svelte-qfeyuc"))&&T(jt,"class",zt),e[3]?Kt&&(Kt.d(1),Kt=null):Kt?Kt.p(e,n):(Kt=Gt(e),Kt.c(),Kt.m(Nt,null)),(!Ht||2&n&&Wt!==(Wt=p(e[1])+" svelte-qfeyuc"))&&T(Nt,"class",Wt),32&n&&R(t,"sidebar",e[5])},i(e){Ht||(ge(y.$$.fragment,e),ge(O.$$.fragment,e),ge(U.$$.fragment,e),ge(J.$$.fragment,e),ge(le.$$.fragment,e),ge(de.$$.fragment,e),ge(Se.$$.fragment,e),ge(He.$$.fragment,e),ge(rt.$$.fragment,e),ge(vt.$$.fragment,e),Ht=!0)},o(e){ve(y.$$.fragment,e),ve(O.$$.fragment,e),ve(U.$$.fragment,e),ve(J.$$.fragment,e),ve(le.$$.fragment,e),ve(de.$$.fragment,e),ve(Se.$$.fragment,e),ve(He.$$.fragment,e),ve(rt.$$.fragment,e),ve(vt.$$.fragment,e),Ht=!1},d(e){e&&k(t),we(y),we(O),we(U),we(J),we(le),we(de),we(Se),we(He),we(rt),we(vt),Kt&&Kt.d(),Ut=!1,r(Bt)}}}function Ut(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Bt(e,t,n){let o,r,s;i(e,Nt,(e=>n(5,s=e)));const l=K(),a=nt.optionsKML;let{kmlOptions:c}=t,{mode:u="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,p={...Ye,...ot.getItem(a)||{}},f=Ut(Ye,c);function m(e){let t=!1;for(const[r,s]of Object.entries(e))c[r]!==s&&(n(0,c[r]=s,c),l("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:s}),t=!0);var o;t&&n(0,c={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,c=e.kmlOptions),"mode"in e&&n(1,u=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,o=Ut(Ye,c)),1025&e.$$.dirty&&n(4,r=!Ut(p,c))},[c,u,f,o,r,s,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));c[r]!==o&&(n(0,c[r]=o,c),l("change",{name:t,value:o}))},function(){m(Ye)},function(){m(p)},function(){if(o)ot.removeItem(a);else{const e={};for(const t of Object.keys(c).filter((e=>c[e]!==Ye[e])))e[t]=c[t];ot.setItem(a,e)}l("save"),n(10,p={...c})},p,function(t){Z(e,t)},()=>{d(Nt,s=!s,s),n(2,f=!1)},()=>{d(Nt,s=!s,s),n(2,f=!1)}]}class Kt extends Pe{constructor(e){super(),Ce(this,e,Bt,Ht,l,{kmlOptions:0,mode:1})}}const Zt=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Jt=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],Vt=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],Xt=e=>0===e?3:0,Yt=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function Qt(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function en(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function tn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const nn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function on(e,t,n,o,r,s,l){e.addSource(`${t}-marker-source`,en(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>Qt(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(ln(t,r,l,s))}function rn(e,t,n,o,r,s){o?e.addSource(`${t}-line-source`,en(o(n).map((e=>tn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:tn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(an(t,r,s))}function sn(e,t,n,o,r,s){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(tn(t[e]))}e.addSource(`${t}-line-source`,en(s))}else e.addSource(`${t}-line-source`,en(n.map((e=>tn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(an(t,r,s))}function ln(e,t,n,o){const[r,s]=Ue(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?nn[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function an(e,t,n){const[o,r]=Ue(t);let s=2,l=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,l=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":l}}}const cn=2*Math.PI,un=Math.PI/4,pn=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*cn};var dn={init:function(){},forward:function(e){var t=e.x,n=e.y,o=pn(t-this.long0),r=Math.tan(n/2),s=Math.sin(un*r),l=s*s,i=this.x0+this.a*o*(.74482-.34588*l),a=this.y0+1.70711*this.a*r;return e.x=i,e.y=a,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(un*t),o=n*n,r=pn(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};function fn(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(dn);const s=t.id.startsWith("jb_");let l={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${s?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const i=new mapboxgl.Map({...t.mapboxOptions,...l});let a,c,u,p;i.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||i.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||i.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||i.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-star-sdf.png",(function(e,t){e||i.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let d,f=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],l=s[2]-s[0],i=s[3]-s[1],[a,c,u,p]=t.extent,[d,f]=t.ratio,m=l/d*f*(i/l),[g,v,h,y]=[s[0],s[3]-m,s[2],s[3]];e=(h-g)/(u-a),n=g-e*a,o=(y-v)/(p-c),r=v-o*c}else{const[s,l,i,a]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(i-s),n=c-e*s,o=(d-u)/(a-l),r=u-o*l}const[s,l,i,d]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),v=t=>[e*t[0]+n,o*t[1]+r],h=e=>m(v(e));f=e=>v(g(e)),a=e=>m(f(e)),c=e=>{let[t,n]=g(e);return t=Me(t,s,i),n=Me(n,l,d),h([t,n])},u=e=>{let[t,n]=g(e);if(Te(t,s,i)&&Te(n,l,d))return h([t,n])},p=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,l,i,a=e.length,c=Oe(e[0],t),u=[];for(n||(n=[]),o=1;o<a;o++){for(r=e[o-1],l=i=Oe(s=e[o],t);;){if(!(c|l)){u.push(r),l!==i?(u.push(s),o<a-1&&(n.push(u),u=[])):o===a-1&&u.push(s);break}if(c&l)break;c?c=Oe(r=Se(r,s,c,t),t):l=Oe(s=Se(r,s,l,t),t)}c=i}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>h(e)))))}}let g=[];if(!n.isFake){for(const e of n.tracks)g=g.concat(e.points);g=g.concat(n.route.points,n.wptCoordinatesAlternate()),d=((e,t=[1/0,1/0,-1/0,-1/0])=>{for(const[n,o]of e.map((e=>c?c([e.longitude,e.latitude]):[e.longitude,e.latitude])))t[0]>n&&(t[0]=n),t[1]>o&&(t[1]=o),t[2]<n&&(t[2]=n),t[3]<o&&(t[3]=o);return t[0]-=1,t[1]-=1,t[2]+=1,t[3]+=1,t})(g),i.fitBounds(d,{padding:{top:30,bottom:80,left:30,right:30}})}const v=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(a){const e=v._onSuccess;v._onSuccess=function(t){const[n,o]=a([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}return i.addControl(v),i.on("load",(function(){t.tiles&&(i.addSource("jb-raster",{type:"raster",tiles:t.tiles,tileSize:t.tileSize}),i.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),function(e,t,n,o,r,s,l,i){const a={...Ye,...t},c=e.description;if(!e.isFake){const t=`${e.infos.departure}-${e.infos.destination}`,o=new editolido.Route(e.wptCoordinates(),{name:t,description:c}),r=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"});rn(n,"greatcircle",new editolido.Route([o.points[0],o.points[o.points.length-1]]).split(300,{name:`Ortho ${t}`}).points,l,a.greatCircleColor,a.greatCircleDisplay),rn(n,"ogimet",e.ogimetData.route.points,l,a.ogimetColor,a.ogimetDisplay),rn(n,"ralt",r.points,l,a.alternateColor,a.alternateDisplay),rn(n,"rmain",o.points,l,a.routeColor,!0),on(n,"ralt",r.points,s,a.alternatePin,a.alternateDisplay,a.alternateColor),on(n,"rmain",o.points,s,a.routePin,!0,a.routeColor)}"jb_pacific"!==i.id&&((e,t,n)=>{fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((o=>{if(t)for(let e=0;e<o.features.length;e++){const n=o.features[e].geometry.coordinates[0];o.features[e].geometry.coordinates=[n.map((e=>t(e)))]}e.addSource("fir-reg-source",{type:"geojson",data:o}),e.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),e.addLayer({id:"fir-reg-line-layer",type:"line",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))})(n,o,a.firDisplay);let u=[];e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(u=[e.infos.EEP,e.infos.EXP]);((e,t,n,o,r,s,l,i)=>{const[a]=Ue(s),c=o.map((e=>e.name)),u=r.map((e=>e.name)),p=c.concat(u);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((o=>{if(t){const e=[];for(let n of o.features)n.geometry.coordinates=t(n.geometry.coordinates),void 0!==n.geometry.coordinates&&e.push(n);o.features=e}e.addSource("airports-source",{type:"geojson",data:o}),e.addLayer({id:"airport-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:i?"visible":"none","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Jt(n,!1)}),e.addLayer({id:"airport-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["in",["get","name"],["literal",p]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",p]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:i?"visible":"none","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",p]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Vt(n,p)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":Xt(l),"icon-color":Zt(l,n,u,a),"text-color":Yt(u,a),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Jt(n)});const r=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!_e}),s=function(t){const n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.title;for(;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;r.setLngLat(n).setHTML(o).addTo(e)},c=()=>e.getCanvas().style.cursor="pointer",d=()=>e.getCanvas().style.cursor="",f=function(){d(),r.remove()};_e?(e.on("mouseenter","airport-layer",(e=>{c(),s(e)})),e.on("mouseenter","airport-emer-layer",(e=>{c(),s(e)})),e.on("mouseleave","airport-layer",f),e.on("mouseleave","airport-emer-layer",f)):(e.on("mouseenter","airport-layer",c),e.on("mouseenter","airport-emer-layer",c),e.on("click","airport-layer",s),e.on("click","airport-emer-layer",s),e.on("mouseleave","airport-layer",d),e.on("mouseleave","airport-emer-layer",d))}))})(n,s,e.isFake?e.isFake:e.infos.aircraft,u,e.infos.raltPoints,a.etopsColor,a.airportPin,a.airportDisplay),e.isFake||(function(e,t,n,o,r,s,l){const i={rnat:[],"rnat-incomplete":[]},a={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(o){const n=o(e.points),r=n.length;for(let o=0;o<r;o++)i[t].push(tn(n[o],e.name))}else i[t].push(tn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const r=e.points[0];let s=n?n([r.longitude,r.latitude]):[r.longitude,r.latitude];if(s&&a[t].push(Qt(s,`${e.name}\n${r.name}`,e.description)),e.isMine){const o=e.points[e.points.length-1];s=n?n([o.longitude,o.latitude]):[o.longitude,o.latitude],s&&a[t].push(Qt(s,`${e.name}\n${o.name}`,e.description))}}e.addSource("rnat-marker-source",en(a.rnat)),e.addSource("rnat-incomplete-marker-source",en(a["rnat-incomplete"])),e.addSource("rnat-line-source",en(i.rnat)),e.addSource("rnat-incomplete-line-source",en(i["rnat-incomplete"])),e.addLayer(an("rnat",r,l)),e.addLayer(an("rnat-incomplete",Ye.natIncompleteColor,l)),e.addLayer(ln("rnat",s,r,l)),e.addLayer(ln("rnat-incomplete",s,r,l));const c=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},u=t=>{const n=t+"-marker-layer";e.on("click",n,c),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};u("rnat"),u("rnat-incomplete")}(n,e,s,l,a.natColor,a.natPin,a.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,s,l,i){sn(e,`${t}-ep-circle`,[n[0].circle(420,48),n[1].circle(420,48)],o,l,r),sn(e,`${t}-etops-circle`,n.slice(2).map((e=>e.circle(7*s))),o,i,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),l,a.etopsDisplay,e.infos.ETOPS,a.routeColor,a.etopsColor))}(n,o,i,a,0,u,p,t);const s=document.querySelector(`#${e} .mapboxgl-ctrl-attrib-inner`);s&&(s.appendChild(document.createTextNode(" | ")),s.appendChild(r),s.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`))),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2")})),i}function mn(e,t,n){if("etops"===t)return function(e,t){let n="etops-etops-circle-line-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="etops-ep-circle-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("fir"===t)return function(e,t){let n="fir-reg-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="fir-reg-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("airport"===t)return function(e,t){let n="airport-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="airport-emer-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);const o=t+"-marker-layer",r=t+"-line-layer";e.getLayer(r)&&e.setLayoutProperty(r,"visibility",n?"visible":"none"),e.getLayer(o)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function gn(e,t,n){const[o,r]=Ue(n);if("etops"===t)return function(e,t){const[n,o]=Ue(t),r="etops-etops-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n);const s=t+"-marker-layer",l=t+"-line-layer";e.getLayer(l)&&(e.setPaintProperty(l,"line-color",o),e.setPaintProperty(l,"line-opacity",r)),e.getLayer(s)&&e.setPaintProperty(s,"text-color",o),"rmain"===t&&function(e,t){const[n,o]=Ue(t),r="etops-ep-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n)}function vn(e,t,n,o,r,s){if("airport"===t)return function(e,t,n,o,r){const[s]=Ue(r),l="airport-layer";e.getLayer(l)&&(e.setPaintProperty(l,"icon-color",Zt(t,n,o,s)),e.setPaintProperty(l,"text-color",Yt(o,s)),e.setPaintProperty(l,"icon-halo-width",Xt(t)))}(e,n,o,r,s);const l=nn[n],i=t+"-marker-layer",a=t+"-line-layer";if(e.getLayer(i)){const t=e.getPaintProperty(a,"line-color");e.setPaintProperty(i,"icon-color",0!==n?l:t),e.setPaintProperty(i,"text-color",t),e.setLayoutProperty(i,"icon-size",0!==n?1:.2),e.setLayoutProperty(i,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(i,"icon-anchor",0!==n?"bottom":"center")}}function hn(e,t,n,o,r,s){const l=je(t);if("aircraftType"===t){let t=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(t=[o.infos.EEP.name,o.infos.EXP.name]),function(e,t,n,o,r,s){const[l]=Ue(s),i="airport-layer";e.setFilter(i,Jt(n)),e.setPaintProperty(i,"icon-color",Zt(t,n,o,l)),e.setLayoutProperty(i,"symbol-sort-key",Vt(n,r)),e.setFilter("airport-emer-layer",Jt(n,!1))}(e,r.airportPin,s,o.infos.ralts,t.concat(o.infos.ralts),r.etopsColor)}else t.endsWith("-display")?("rnat"===l&&mn(e,"rnat-incomplete",n),mn(e,l,n)):t.endsWith("-pin")?vn(e,l,n,s,o.infos.ralts,r.etopsColor):t.endsWith("-color")&&gn(e,l,n)}const yn={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},{window:$n}=$e;function bn(e,t,n){const o=e.slice();return o[24]=t[n],o[26]=n,o}function xn(e,t,n){const o=e.slice();return o[27]=t[n],o[26]=n,o}function kn(e){let t,n,o,r=(e[27].proj4&&e[11](e[27])?`${e[27].label.toUpperCase()}`:e[27].label)+"";return{c(){t=C("option"),n=L(r),t.__value=e[26],t.value=t.__value,t.selected=o=e[26]===e[3]},m(e,o){x(e,t,o),b(t,n)},p(e,n){8&n&&o!==(o=e[26]===e[3])&&(t.selected=o)},d(e){e&&k(t)}}}function wn(e){let t,n,o,r=e[24]+"";return{c(){t=C("option"),n=L(r),t.__value=e[26],t.value=t.__value,t.selected=o=e[26]===e[4]},m(e,o){x(e,t,o),b(t,n)},p(e,n){16&n&&o!==(o=e[26]===e[4])&&(t.selected=o)},d(e){e&&k(t)}}}function Cn(e){let t,n=("???"!==e[24]||"???"===e[4]&&"???"===e[24])&&wn(e);return{c(){n&&n.c(),t=_()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){"???"!==e[24]||"???"===e[4]&&"???"===e[24]?n?n.p(e,o):(n=wn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Pn(e){let t,n,o,l,i,a,c,u,p,d,m,g,v,h=e[7],y=[];for(let t=0;t<h.length;t+=1)y[t]=kn(xn(e,h,t));let $=e[6],P=[];for(let t=0;t<$.length;t+=1)P[t]=Cn(bn(e,$,t));function L(t){e[18](t)}let _={};return void 0!==e[0]&&(_.kmlOptions=e[0]),p=new Kt({props:_}),V.push((()=>be(p,"kmlOptions",L))),p.$on("change",e[12]),p.$on("save",e[19]),{c(){t=C("div"),o=F(),l=C("div"),i=C("select");for(let e=0;e<y.length;e+=1)y[e].c();a=F(),c=C("select");for(let e=0;e<P.length;e+=1)P[e].c();u=F(),xe(p.$$.fragment),T(t,"id",e[2]),T(t,"class","svelte-elcmhy"),T(i,"name",Ln),T(i,"class","form-control form-control-sm svelte-elcmhy"),void 0===e[3]&&ne((()=>e[15].call(i))),T(l,"class","mapmenu svelte-elcmhy"),T(c,"name","aircraftType"),T(c,"class","svelte-elcmhy"),void 0===e[4]&&ne((()=>e[17].call(c)))},m(r,s){x(r,t,s),x(r,o,s),x(r,l,s),b(l,i);for(let e=0;e<y.length;e+=1)y[e].m(i,null);A(i,e[3]),x(r,a,s),x(r,c,s);for(let e=0;e<P.length;e+=1)P[e].m(c,null);e[16](c),A(c,e[4]),x(r,u,s),ke(p,r,s),m=!0,g||(v=[j($n,"orientationchange",e[13]),f(n=e[10].call(null,t,{route:e[1]})),j(i,"change",e[15]),j(i,"change",e[8]),j(c,"change",e[17]),j(c,"change",e[9])],g=!0)},p(e,[o]){if((!m||4&o)&&T(t,"id",e[2]),n&&s(n.update)&&2&o&&n.update.call(null,{route:e[1]}),2184&o){let t;for(h=e[7],t=0;t<h.length;t+=1){const n=xn(e,h,t);y[t]?y[t].p(n,o):(y[t]=kn(n),y[t].c(),y[t].m(i,null))}for(;t<y.length;t+=1)y[t].d(1);y.length=h.length}if(8&o&&A(i,e[3]),80&o){let t;for($=e[6],t=0;t<$.length;t+=1){const n=bn(e,$,t);P[t]?P[t].p(n,o):(P[t]=Cn(n),P[t].c(),P[t].m(c,null))}for(;t<P.length;t+=1)P[t].d(1);P.length=$.length}16&o&&A(c,e[4]);const r={};!d&&1&o&&(d=!0,r.kmlOptions=e[0],oe((()=>d=!1))),p.$set(r)},i(e){m||(ge(p.$$.fragment,e),m=!0)},o(e){ve(p.$$.fragment,e),m=!1},d(n){n&&k(t),n&&k(o),n&&k(l),w(y,n),n&&k(a),n&&k(c),w(P,n),e[16](null),n&&k(u),we(p,n),g=!1,r(v)}}}const Ln="map-style";function Fn(e,t,n){const o=K();let r,s,{kmlOptions:l}=t,{ofp:i}=t,{route:a}=t,c=-1,u=-1;const p=["???","318","319","320","321","330","340","350","380","787","772","773","77F"],d=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,f=[{label:"Mercator",id:"atlas",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12}},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:yn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],tileSize:d},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:yn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],tileSize:d},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:yn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],tileSize:d},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:yn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],tileSize:d}];let{id:m="map"}=t;function g(){r&&r.remove()}var v;return v=()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",r=fn(m,f[c],i,l,s)},B().$$.on_mount.push(v),e.$$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions),"ofp"in e&&n(14,i=e.ofp),"route"in e&&n(1,a=e.route),"id"in e&&n(2,m=e.id)},[l,a,m,c,u,s,p,f,function(e){e.target.blur(),g(),r=fn(m,f[c],i,l,s)},function(e){e.target.blur(),hn(r,"aircraftType",p[e.target.value],i,l,p[e.target.value])},function(e,t){if(-1===c&&i&&!i.isFake){const e=i.route.points[0],t=i.route.points[i.route.points.length-1];t.latitude>30&&e.latitude>30?n(3,c=1):t.longitude<-80&&e.longitude<-80?n(3,c=3):n(3,c=2)}return-1===c&&n(3,c=0),-1===u&&i&&n(4,u=i.isFake?p.indexOf(i.isFake):p.indexOf(i.infos.aircraft)),-1===u&&n(4,u=0),{update(e){"/map"===e.route&&r&&r.resize()},destroy(){g()}}},function(e){if(!e.proj4||!i||i.isFake)return!0;const t=i.route.points[0],n=i.route.points[i.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},e=>{hn(r,e.detail.name,e.detail.value,i,l,p[u]),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-"))return;const n=et(),o=je(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),o("save")},e=>{"/map"===a&&r&&r.resize()},i,function(){c=D(this),n(3,c)},function(e){V[e?"unshift":"push"]((()=>{s=e,n(5,s)}))},function(){u=D(this),n(4,u)},function(e){l=e,n(0,l)},function(t){Z(e,t)}]}class _n extends Pe{constructor(e){super(),Ce(this,e,Fn,Pn,l,{kmlOptions:0,ofp:14,route:1,id:2})}}function jn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#marker"></use></svg> \n      <span class="svelte-1nd81uv">CARTE</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/map"),R(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/map"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/map"===e[0])},d(e){e&&k(t)}}}function Mn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#cloud"></use></svg> \n      <span class="svelte-1nd81uv">GRAMET</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/gramet"),R(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/gramet"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/gramet"===e[0])},d(e){e&&k(t)}}}function Tn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1nd81uv"><use xlink:href="#export"></use></svg> \n      <span class="svelte-1nd81uv">EXPORT</span>',T(n,"class","nav-link svelte-1nd81uv"),T(n,"href","#/export"),R(n,"disabled",!e[1]),T(t,"class","nav-item svelte-1nd81uv"),R(t,"active","/export"===e[0])},m(e,o){x(e,t,o),b(t,n)},p(e,o){2&o&&R(n,"disabled",!e[1]),1&o&&R(t,"active","/export"===e[0])},d(e){e&&k(t)}}}function Sn(t){let n,o,r,s;return{c(){n=C("li"),o=C("a"),o.textContent="PARTAGER",T(o,"class","nav-link"),T(o,"href","."),T(n,"class","nav-item optional svelte-1nd81uv")},m(e,l){x(e,n,l),b(n,o),r||(s=j(o,"click",M(t[2])),r=!0)},p:e,d(e){e&&k(n),r=!1,s()}}}function On(e){let t,n,o,r,s,l,i,c,p,d,f,m=(e[1]||"/map"===e[0])&&jn(e),g=(e[1]&&!e[1].isFakeOfp||"/gramet"===e[0])&&Mn(e),v=(e[1]&&!e[1].isFakeOfp||"/export"===e[0])&&Tn(e),h=e[1]&&navigator.share&&Sn(e);const y=e[4].default,$=a(y,e,e[3],null);return{c(){t=C("nav"),n=C("ul"),o=C("li"),o.innerHTML='<a class="nav-link" href="#/"><svg class="svelte-1nd81uv"><use xlink:href="#home"></use></svg></a>',r=F(),m&&m.c(),s=F(),g&&g.c(),l=F(),v&&v.c(),i=F(),c=C("li"),c.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-1nd81uv"><use xlink:href="#info"></use></svg> \n      <span class="svelte-1nd81uv">AIDE</span></a>',p=F(),h&&h.c(),d=F(),$&&$.c(),T(o,"class","nav-item svelte-1nd81uv"),R(o,"active","/"===e[0]),T(c,"class","nav-item svelte-1nd81uv"),R(c,"active","/help"===e[0]),T(n,"class","navbar-nav mr-auto svelte-1nd81uv"),T(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-1nd81uv")},m(e,a){x(e,t,a),b(t,n),b(n,o),b(n,r),m&&m.m(n,null),b(n,s),g&&g.m(n,null),b(n,l),v&&v.m(n,null),b(n,i),b(n,c),b(n,p),h&&h.m(n,null),b(t,d),$&&$.m(t,null),f=!0},p(e,[t]){1&t&&R(o,"active","/"===e[0]),e[1]||"/map"===e[0]?m?m.p(e,t):(m=jn(e),m.c(),m.m(n,s)):m&&(m.d(1),m=null),e[1]&&!e[1].isFakeOfp||"/gramet"===e[0]?g?g.p(e,t):(g=Mn(e),g.c(),g.m(n,l)):g&&(g.d(1),g=null),e[1]&&!e[1].isFakeOfp||"/export"===e[0]?v?v.p(e,t):(v=Tn(e),v.c(),v.m(n,i)):v&&(v.d(1),v=null),1&t&&R(c,"active","/help"===e[0]),e[1]&&navigator.share?h?h.p(e,t):(h=Sn(e),h.c(),h.m(n,null)):h&&(h.d(1),h=null),$&&$.p&&8&t&&u($,y,e,e[3],t,null,null)},i(e){f||(ge($,e),f=!0)},o(e){ve($,e),f=!1},d(e){e&&k(t),m&&m.d(),g&&g.d(),v&&v.d(),h&&h.d(),$&&$.d(e)}}}function In(e,t,n){let{$$slots:o={},$$scope:r}=t,{route:s}=t,{promise:l}=t;return e.$$set=e=>{"route"in e&&n(0,s=e.route),"promise"in e&&n(1,l=e.promise),"$$scope"in e&&n(3,r=e.$$scope)},[s,l,async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},r,o]}class qn extends Pe{constructor(e){super(),Ce(this,e,In,On,l,{route:0,promise:1})}}function An(e,t,n){const o=e.slice();return o[12]=t[n],o}function Dn(e){let t,n,o,s,l,i=Nn,a=[];for(let t=0;t<i.length;t+=1)a[t]=Rn(An(e,i,t));return{c(){t=C("div"),n=C("select"),o=C("option"),o.textContent="pas d'ofp ?";for(let e=0;e<a.length;e+=1)a[e].c();o.__value="none",o.value=o.__value,T(n,"class","form-control-sm svelte-14yxy04"),n.disabled=e[1],T(t,"class","footer svelte-14yxy04")},m(r,i){x(r,t,i),b(t,n),b(n,o);for(let e=0;e<a.length;e+=1)a[e].m(n,null);s||(l=[j(n,"click",e[4],{once:!0}),j(n,"change",e[6])],s=!0)},p(e,t){if(0&t){let o;for(i=Nn,o=0;o<i.length;o+=1){const r=An(e,i,o);a[o]?a[o].p(r,t):(a[o]=Rn(r),a[o].c(),a[o].m(n,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=i.length}2&t&&(n.disabled=e[1])},d(e){e&&k(t),w(a,e),s=!1,r(l)}}}function Rn(t){let n,o,r=t[12]+"";return{c(){n=C("option"),o=L(r),n.__value=t[12],n.value=n.__value},m(e,t){x(e,n,t),b(n,o)},p:e,d(e){e&&k(n)}}}function zn(t){let n,o,s,l,i,a,c,u,p,d=!t[0]&&Dn(t);return{c(){n=C("div"),o=C("input"),s=F(),l=C("label"),i=L(t[2]),a=F(),d&&d.c(),c=_(),T(o,"id",Gn),T(o,"name",Gn),T(o,"type","file"),T(o,"accept","application/pdf"),o.disabled=t[1],T(o,"class","custom-file-input svelte-14yxy04"),T(l,"class","custom-file-label text-truncate svelte-14yxy04"),T(l,"for",Gn),R(l,"ready",t[3]),T(n,"class","custom-file svelte-14yxy04"),R(n,"blink",!t[0])},m(e,r){x(e,n,r),b(n,o),b(n,s),b(n,l),b(l,i),x(e,a,r),d&&d.m(e,r),x(e,c,r),u||(p=[j(o,"change",t[5]),j(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&O(i,e[2]),8&t&&R(l,"ready",e[3]),1&t&&R(n,"blink",!e[0]),e[0]?d&&(d.d(1),d=null):d?d.p(e,t):(d=Dn(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&k(n),e&&k(a),d&&d.d(e),e&&k(c),u=!1,r(p)}}}const En=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.6.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.6.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}];let Nn=["318","319","320","321","330","340","350","380","787","772","773","77F"];const Wn=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let Gn="file";function Hn(e,t,n){let o,{promise:r}=t,{kmlOptions:s}=t,l=!1,i=new Le,a="Choisir un OFP",c=!1;const u=K();function p(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,l=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(l.crossOrigin="anonymous");let i=!0;s?(l.src=t,l.async=n.async,l.defer=n.defer):(l.href=t,"prefetch"in n?(l.rel="prefetch",o-=1,i=!1):"preload"in n?(l.rel="preload",o-=1,i=!1):(l.rel="stylesheet",o-=1,i=!1)),i&&(l.onload=r),document.body.appendChild(l)}))}(En,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",o&&!o.destroyed||(o=new e.PDFWorker),i.resolve(!0),n(3,c=!0)}))}const d=e=>{const t=new FileReader;return new Promise(((n,r)=>{t.onload=e=>{if(!o||o.destroyed){const e=window["pdfjs-dist/build/pdf"];o=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Wn(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:o}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),o=new editolido.GeoGridIndex;o.data=window.WMO;const l=editolido.ogimetData(t,o);l.proxyImg=`https://ofp2map-gramet.vercel.app/api/${l.proxy}__${l.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,l.route.description=l.wmo.join(" "),t.ogimetData=l;try{et();tt(t,s),n(t)}catch(e){r(e)}}catch(e){r(e)}else r(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>r(e)))},t.onerror=e=>{r(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"promise"in e&&n(0,r=e.promise),"kmlOptions"in e&&n(7,s=e.kmlOptions)},[r,l,a,c,p,async function(e){n(1,l=!0),p(),await i.promise.then((()=>{const t=e.target.files[0];t&&(n(2,a=e.target.value.split(/([\\/])/g).pop()),u("change",a),n(0,r=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))})),n(1,l=!1)},async function(e){n(1,l=!0),p(),await i.promise.then((()=>{n(0,r=new Promise(((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{et();tt(o,s),t(o)}catch(e){n(e)}}))),n(0,r.isFakeOfp=!0,r),window.location.hash="#/map"})),n(1,l=!1)},s]}class Un extends Pe{constructor(e){super(),Ce(this,e,Hn,zn,l,{promise:0,kmlOptions:7})}}function Bn(n){let o,r,l;const i=n[3].default,c=a(i,n,n[2],null);return{c(){o=C("page"),c&&c.c(),T(o,"class","svelte-7uc4nn"),R(o,"fadein",!1===n[0]),R(o,"d-none",!0===n[0])},m(e,t){x(e,o,t),c&&c.m(o,null),l=!0},p(e,[t]){c&&c.p&&4&t&&u(c,i,e,e[2],t,null,null),1&t&&R(o,"fadein",!1===e[0]),1&t&&R(o,"d-none",!0===e[0])},i(i){l||(ge(c,i),r||ne((()=>{r=function(n,o,r){let l,i,a=o(n,r),c=!1,u=0;function p(){l&&H(n,l)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:f}=a||he;f&&(l=G(n,0,1,r,o,s,f,u++)),d(0,1);const m=g()+o,v=m+r;i&&i.abort(),c=!0,ne((()=>ue(n,!0,"start"))),i=$((e=>{if(c){if(e>=v)return d(1,0),ue(n,!0,"end"),p(),c=!1;if(e>=m){const t=s((e-m)/r);d(t,1-t)}}return c}))}let f=!1;return{start(){f||(H(n),s(a)?(a=a(),ce().then(d)):d())},invalidate(){f=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),l=!0)},o(e){ve(c,e),l=!1},d(e){e&&k(o),c&&c.d(e)}}}function Kn(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return Ie(e,t)},r,o]}class Zn extends Pe{constructor(e){super(),Ce(this,e,Kn,Bn,l,{hidden:0})}}function Jn(t){let n,o,r,s,l,i,a,c,u,p,d,f,m,g,v,h,y,$,b,w,P,L,_,j,M,S,O,I,q,A,D,R,z,E,N;return{c(){n=C("h2"),n.textContent="Préambule",o=F(),r=C("p"),r.textContent="Cette app a été conçue pour le PilotPad. Elle nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi. Firefox dernière version devrait fonctionner (non testé).\nL'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. GitHub (détenu par Microsoft), hébergeur du site, utilise des cookies. L'app en elle même ne collecte aucune données.",s=F(),l=C("h2"),l.textContent="Utilisation",i=F(),a=C("ol"),a.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner. Le &quot;drag and drop&quot; est également possible dans le champ d&#39;input de l&#39;OFP.</p></li> \n<li><p>Après avoir ouvert ce site dans Safari sur iPad, il est possible d&#39;afficher le menu de personnalisation en cliquant sur  l&#39;icône en haut à droite (le &quot;hamburger&quot;). Dans les résolutions plus faibles, sur iPhone ou en mode &quot;split view&quot;, ces réglages sont affichés sous la carte. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur une projection Web Mercator ou sur l&#39;Atlas &quot;The World&quot;.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li> \n<li>The World permet de disposer d&#39;un Atlas off-line</li> \n<li>Mercator est plutôt destinée à un usage online, le thème est inspiré des cartes VFR et on peut zoomer de manière importante.</li></ul></li>",c=F(),u=C("ol"),u.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</li>",p=F(),d=C("h2"),d.textContent="Mode off-line",f=F(),m=C("p"),m.innerHTML="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l&#39;exporter. Il est aussi probable que le cache de l&#39;App vous permettra de naviguer sur les cartes déjà visualisées. Vous disposez d&#39;un cache de 50Mo pendant 7 jours, voir <em>Installation sur l&#39;écran d&#39;accueil</em> pour augmenter ces valeurs.",g=F(),v=C("h2"),v.textContent="Sauvegarde des paramètres",h=F(),y=C("p"),y.textContent="L'app permet de sauvegarder vos paramètres dans le navigateur. Toutefois Apple ne conserve plus les données au-delà\nde 7 jours, vos réglages risquent donc de disparaître. La solution: après avoir paramétré l'app, mémorisez vos choix dans la \"sidebar\" puis, sauvegardez l'url de la page dans vos favoris.\nL'URL contient l'ensemble des détails nécessaires à la restauration. Si vous utilisez cette méthode, pensez à bien \nsauvegarder l'URL après vos modifications. Dans un premier temps, contentez-vous de sauvegarder avec le bouton «Mémoriser»,\ntestez sur différents OFP, puis une fois satisfait, sauvegardez dans vos favoris.",$=F(),b=C("h2"),b.textContent="Installation sur l'écran d'accueil",w=F(),P=C("p"),P.innerHTML='Il est recommandé d&#39;installer l&#39;app sur l&#39;écran d&#39;accueil en utilisant le menu « partage » <svg style="width: 1em; display: inline-block; height: 1em; vertical-align: bottom;"><use xlink:href="#share"></use></svg> de Safari. Ceci permet:',L=F(),_=C("ul"),_.innerHTML="<li>un stockage longue durée des préférences, des cartes Lambert et de l&#39;Atlas</li> \n<li>de disposer d&#39;un cache plus important : les cartes Lambert et L&#39;Atlas peuvent être stockés en totalité. La Web Mercator dispose quant à elle d&#39;environ 40Mo.</li> \n<li>d&#39;avoir un écran plus grand</li>",j=F(),M=C("p"),M.textContent="Par contre, on ne peut recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.\nÀ noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",S=F(),O=C("h2"),O.textContent="Mise à jour",I=F(),q=C("p"),q.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut \napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",A=F(),D=C("h2"),D.textContent="Crédits",R=F(),z=C("ul"),z.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',E=F(),N=C("p"),N.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",T(u,"start","5")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t),x(e,s,t),x(e,l,t),x(e,i,t),x(e,a,t),x(e,c,t),x(e,u,t),x(e,p,t),x(e,d,t),x(e,f,t),x(e,m,t),x(e,g,t),x(e,v,t),x(e,h,t),x(e,y,t),x(e,$,t),x(e,b,t),x(e,w,t),x(e,P,t),x(e,L,t),x(e,_,t),x(e,j,t),x(e,M,t),x(e,S,t),x(e,O,t),x(e,I,t),x(e,q,t),x(e,A,t),x(e,D,t),x(e,R,t),x(e,z,t),x(e,E,t),x(e,N,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r),e&&k(s),e&&k(l),e&&k(i),e&&k(a),e&&k(c),e&&k(u),e&&k(p),e&&k(d),e&&k(f),e&&k(m),e&&k(g),e&&k(v),e&&k(h),e&&k(y),e&&k($),e&&k(b),e&&k(w),e&&k(P),e&&k(L),e&&k(_),e&&k(j),e&&k(M),e&&k(S),e&&k(O),e&&k(I),e&&k(q),e&&k(A),e&&k(D),e&&k(R),e&&k(z),e&&k(E),e&&k(N)}}}class Vn extends Pe{constructor(e){super(),Ce(this,e,null,Jn,l,{})}}function Xn(e){let t,n,o,r,s,l,i=e[1].msg+"",a=0!==e[1].code&&eo(e);return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(i),l=F(),a&&a.c(),T(o,"data-status",s=e[1].code),T(o,"class","svelte-jp9cw7"),T(t,"class","svelte-jp9cw7")},m(e,s){x(e,t,s),b(t,n),b(t,o),b(o,r),b(t,l),a&&a.m(t,null)},p(e,n){2&n&&i!==(i=e[1].msg+"")&&O(r,i),2&n&&s!==(s=e[1].code)&&T(o,"data-status",s),0!==e[1].code?a?a.p(e,n):(a=eo(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&k(t),a&&a.d()}}}function Yn(e){let t,n,o,r,s,l,i,a,c=e[1].msg+"";return{c(){t=C("p"),n=L("Service Worker status: "),o=C("span"),r=L(c),l=C("a"),l.textContent="Installer",T(o,"data-status",s=e[1].code),T(o,"class","svelte-jp9cw7"),T(l,"href","."),T(t,"class","svelte-jp9cw7")},m(s,c){x(s,t,c),b(t,n),b(t,o),b(o,r),b(t,l),i||(a=j(l,"click",M(e[4])),i=!0)},p(e,t){2&t&&c!==(c=e[1].msg+"")&&O(r,c),2&t&&s!==(s=e[1].code)&&T(o,"data-status",s)},d(e){e&&k(t),i=!1,a()}}}function Qn(t){let n,o,r,s,l;return{c(){n=C("p"),o=L("La page n'est pas controllée par le service worker. "),r=C("a"),r.textContent="Recharger la page",T(r,"href","./index.html"),T(n,"class","svelte-jp9cw7")},m(e,i){x(e,n,i),b(n,o),b(n,r),s||(l=j(r,"click",t[5]),s=!0)},p:e,d(e){e&&k(n),s=!1,l()}}}function eo(e){let t;function n(e,t){return e[0]===ao?no:to}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function to(e){let t;return{c(){t=L(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&O(t,e[0])},d(e){e&&k(t)}}}function no(e){let t;function n(e,t){return e[3]?ro:oo}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function oo(t){let n;return{c(){n=L("non connecté")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function ro(e){let t,n,o,r;return{c(){t=C("a"),n=L(e[0]),T(t,"href",".")},m(s,l){x(s,t,l),b(t,n),o||(r=j(t,"click",M(e[7])),o=!0)},p(e,t){1&t&&O(n,e[0])},d(e){e&&k(t),o=!1,r()}}}function so(t){let n;return{c(){n=C("p"),n.textContent="Vos réglages seront conservés mais l'OFP sera remis à zéro.",T(n,"class","svelte-jp9cw7")},m(e,t){x(e,n,t)},p:e,d(e){e&&k(n)}}}function lo(t){let n,o,r,s,l,i,a;return{c(){n=C("p"),o=C("a"),o.textContent="Réinitialiser l'App",r=L(" va en plus réinitialiser le service Worker (il faut être connecté)."),s=F(),l=C("p"),l.textContent="Dans les 2 cas vos réglages sont conservés mais l'OFP est remis à zéro.",T(o,"class","btn btn-danger btn-sm"),T(o,"href","./index.html"),T(n,"class","svelte-jp9cw7"),T(l,"class","svelte-jp9cw7")},m(e,c){x(e,n,c),b(n,o),b(n,r),x(e,s,c),x(e,l,c),i||(a=j(o,"click",t[6]),i=!0)},p:e,d(e){e&&k(n),e&&k(s),e&&k(l),i=!1,a()}}}function io(e){let t,n,o,r,s,l,i,a,c=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[2]?2===e[1].code?Yn:Xn:Qn}let o=n(e),r=o(e);return{c(){r.c(),t=_()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}(e),u=!0===navigator.standalone&&function(e){let t,n,o,r,s,l,i,a,c;function u(e,t){return e[3]?lo:so}let p=u(e),d=p(e);return{c(){t=C("p"),t.innerHTML="<b>En cas de problème:</b>",n=F(),o=C("p"),r=C("a"),r.textContent="Recharger l'App",s=L(" c'est l'équivalent d'un rechargement de page."),l=F(),d.c(),i=_(),T(t,"class","svelte-jp9cw7"),T(r,"class","btn btn-primary btn-sm svelte-jp9cw7"),T(r,"href","./index.html"),T(o,"class","svelte-jp9cw7")},m(u,p){x(u,t,p),x(u,n,p),x(u,o,p),b(o,r),b(o,s),x(u,l,p),d.m(u,p),x(u,i,p),a||(c=j(r,"click",e[5]),a=!0)},p(e,t){p===(p=u(e))&&d?d.p(e,t):(d.d(1),d=p(e),d&&(d.c(),d.m(i.parentNode,i)))},d(e){e&&k(t),e&&k(n),e&&k(o),e&&k(l),d.d(e),e&&k(i),a=!1,c()}}}(e);return i=new Vn({}),{c(){t=C("div"),n=C("p"),n.textContent="Application version: 1.3.6",o=F(),c&&c.c(),r=F(),u&&u.c(),s=F(),l=C("div"),xe(i.$$.fragment),T(n,"class","svelte-jp9cw7"),T(t,"class","info svelte-jp9cw7"),T(l,"class","markdown svelte-jp9cw7")},m(e,p){x(e,t,p),b(t,n),b(t,o),c&&c.m(t,null),b(t,r),u&&u.m(t,null),x(e,s,p),x(e,l,p),ke(i,l,null),a=!0},p(e,[t]){navigator.serviceWorker&&c.p(e,t),!0===navigator.standalone&&u.p(e,t)},i(e){a||(ge(i.$$.fragment,e),a=!0)},o(e){ve(i.$$.fragment,e),a=!1},d(e){e&&k(t),c&&c.d(),u&&u.d(),e&&k(s),e&&k(l),we(i)}}}const ao="Vérifier Mise à jour";function co(e,t,n){let o,r,s,l;i(e,Et,(e=>n(11,s=e))),i(e,Wt,(e=>n(3,l=e)));let a=window.serviceWorker,c=!0;!a&&navigator.serviceWorker&&navigator.serviceWorker.ready.then((e=>(n(8,a=e),e))).catch((e=>n(9,c=!1)));let u=navigator.serviceWorker&&navigator.serviceWorker.controller,p=ao;const f=e=>e?e.installing?{code:1,msg:"🔹 installing"}:e.waiting?{code:2,msg:"🔸 waiting"}:e.active?{code:3,msg:"🟢"}:void 0:{code:0,msg:"🔺 unknown"},m=()=>{window.location.reload()};return e.$$.update=()=>{256&e.$$.dirty&&n(1,o=f(a)),512&e.$$.dirty&&n(2,r=u&&c)},window.editolido&&window.editolido.version,[p,o,r,l,()=>{a.waiting&&(d(Et,s=!0,s),a.waiting.postMessage("SKIP_WAITING"))},m,e=>{if(!window.confirm("Vous devez être connecté au réseau, ceci ne devrait être utile qu'en cas de bug, Réinitialiser ?"))return e.preventDefault(),!1;a&&a.unregister(),m()},()=>{n(0,p="Vérification... "),d(Et,s=!1,s),a.update().then((e=>{3!==f(e).code?(n(0,p=""),n(8,a)):n(0,p="À jour")})).catch((e=>n(0,p=e)))},a,c]}class uo extends Pe{constructor(e){super(),Ce(this,e,co,io,l,{})}}function po(t){return{c:e,m:e,p:e,d:e}}function fo(e){let t,n=e[5]&&!e[1]&&mo(e);return{c(){n&&n.c(),t=_()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=mo(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function mo(e){let t,n,o,s,l,i,a,c,u,p,d;function f(e,t){return e[0]?go:vo}let m=f(e),g=m(e);function v(){return e[4](e[5])}return{c(){t=C("div"),n=C("div"),o=C("strong"),o.innerHTML='<span class="svelte-5snzlz">👨🏻‍✈️</span>Mise à jour disponible',s=F(),l=C("button"),l.innerHTML='<span aria-hidden="true">×</span>',i=F(),a=C("div"),g.c(),c=F(),u=C("button"),u.textContent="Installer",T(o,"class","mr-auto svelte-5snzlz"),T(l,"type","button"),T(l,"class","ml-2 mb-1 close"),T(l,"aria-label","Close"),T(n,"class","toast-header"),T(u,"type","button"),T(u,"class","btn"),R(u,"btn-primary",!e[0]),R(u,"btn-danger",e[0]),T(a,"class","toast-body text-center"),T(t,"class","toast svelte-5snzlz"),q(t,"position","absolute"),q(t,"top","0"),q(t,"right","0")},m(r,f){x(r,t,f),b(t,n),b(n,o),b(n,s),b(n,l),b(t,i),b(t,a),g.m(a,null),b(a,c),b(a,u),p||(d=[j(l,"click",e[3]),j(u,"click",v)],p=!0)},p(t,n){m!==(m=f(e=t))&&(g.d(1),g=m(e),g&&(g.c(),g.m(a,c))),1&n&&R(u,"btn-primary",!e[0]),1&n&&R(u,"btn-danger",e[0])},d(e){e&&k(t),g.d(),p=!1,r(d)}}}function go(e){let t;return{c(){t=C("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function vo(e){let t;return{c(){t=C("p"),t.textContent="Celà va recharger l'App"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function ho(t){return{c:e,m:e,p:e,d:e}}function yo(t){let n,o={ctx:t,current:null,token:null,hasCatch:!1,pending:ho,then:fo,catch:po,value:5};return ye(window.isSWUpdateAvailable.promise,o),{c(){n=_(),o.block.c()},m(e,t){x(e,n,t),o.block.m(e,o.anchor=t),o.mount=()=>n.parentNode,o.anchor=n},p(e,[n]){{const r=(t=e).slice();r[5]=o.resolved,o.block.p(r,n)}},i:e,o:e,d(e){e&&k(n),o.block.d(e),o.token=null,o=null}}}function $o(e,t,n){let o;i(e,Et,(e=>n(1,o=e)));let{loaded:r=!1}=t;const s=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,s,()=>d(Et,o=!0,o),e=>s(e)]}class bo extends Pe{constructor(e){super(),Ce(this,e,$o,yo,l,{loaded:0})}}const{window:xo}=$e;function ko(e){let t,n,o,r,s,l;function i(t){e[9](t)}let a={kmlOptions:e[2]};return void 0!==e[1]&&(a.promise=e[1]),n=new Un({props:a}),V.push((()=>be(n,"promise",i))),n.$on("change",e[5]),{c(){t=C("form"),xe(n.$$.fragment),T(t,"class","form-inline svelte-1pvavz"),R(t,"invisible","/help"===e[0])},m(o,i){x(o,t,i),ke(n,t,null),r=!0,s||(l=j(t,"submit",M(e[8])),s=!0)},p(e,r){const s={};4&r&&(s.kmlOptions=e[2]),!o&&2&r&&(o=!0,s.promise=e[1],oe((()=>o=!1))),n.$set(s),1&r&&R(t,"invisible","/help"===e[0])},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&k(t),we(n),s=!1,l()}}}function wo(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Fo,then:Po,catch:Co,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=_(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function Co(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s),R(n,"d-none","/map"!==t[0])},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&O(r,s),1&t&&R(n,"d-none","/map"!==e[0])},i:e,o:e,d(e){e&&k(n)}}}function Po(e){let t,n;return t=new Zn({props:{hidden:"/map"!==e[0],$$slots:{default:[Lo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131079&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Lo(e){let t,n,o;function r(t){e[10](t)}let s={id:"map",ofp:e[15],route:e[0]};return void 0!==e[2]&&(s.kmlOptions=e[2]),t=new _n({props:s}),V.push((()=>be(t,"kmlOptions",r))),t.$on("save",e[4]),{c(){xe(t.$$.fragment)},m(e,n){ke(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[15]),1&o&&(r.route=e[0]),!n&&4&o&&(n=!0,r.kmlOptions=e[2],oe((()=>n=!1))),t.$set(r)},i(e){o||(ge(t.$$.fragment,e),o=!0)},o(e){ve(t.$$.fragment,e),o=!1},d(e){we(t,e)}}}function Fo(e){let t,n;return t=new Zn({props:{hidden:"/map"!==e[0],$$slots:{default:[_o]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function _o(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",q(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function jo(e){let t,n;return t=new Zn({props:{$$slots:{default:[So]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Mo(e){let t,n;return t=new Zn({props:{$$slots:{default:[Oo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function To(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Eo,then:qo,catch:Io,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=_(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function So(e){let t,n;return t=new uo({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Oo(e){let t,n;return t=new Pt({}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Io(t){let n,o,r,s=t[16].message+"";return{c(){n=C("p"),o=L("😱: "),r=L(s)},m(e,t){x(e,n,t),b(n,o),b(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&O(r,s)},i:e,o:e,d(e){e&&k(n)}}}function qo(e){let t,n,o,r;const s=[Do,Ao],l=[];function i(e,t){return"/gramet"===e[0]?0:"/export"===e[0]?1:-1}return~(t=i(e))&&(n=l[t]=s[t](e)),{c(){n&&n.c(),o=_()},m(e,n){~t&&l[t].m(e,n),x(e,o,n),r=!0},p(e,r){let a=t;t=i(e),t===a?~t&&l[t].p(e,r):(n&&(fe(),ve(l[a],1,1,(()=>{l[a]=null})),me()),~t?(n=l[t],n?n.p(e,r):(n=l[t]=s[t](e),n.c()),ge(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(ge(n),r=!0)},o(e){ve(n),r=!1},d(e){~t&&l[t].d(e),e&&k(o)}}}function Ao(e){let t,n;return t=new Zn({props:{$$slots:{default:[Ro]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Do(e){let t,n;return t=new Zn({props:{$$slots:{default:[zo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Ro(e){let t,n,o,r;return t=new ht({props:{ofp:e[15]}}),t.$on("save",e[4]),o=new We({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment),n=F(),xe(o.$$.fragment)},m(e,s){ke(t,e,s),x(e,n,s),ke(o,e,s),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[15]),t.$set(r);const s={};2&n&&(s.ofp=e[15]),o.$set(s)},i(e){r||(ge(t.$$.fragment,e),ge(o.$$.fragment,e),r=!0)},o(e){ve(t.$$.fragment,e),ve(o.$$.fragment,e),r=!1},d(e){we(t,e),e&&k(n),we(o,e)}}}function zo(e){let t,n;return t=new wt({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[15]),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function Eo(e){let t,n;return t=new Zn({props:{$$slots:{default:[No]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){ke(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){we(t,e)}}}function No(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",q(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Wo(e){let t,n,o,s,l,i,a,c,u,p,d,f,m;o=new qn({props:{promise:e[1],route:e[0],$$slots:{default:[ko]},$$scope:{ctx:e}}}),l=new bo({props:{loaded:!!e[1]}});let g=e[1]&&wo(e);const v=[To,Mo,jo],h=[];function y(e,t){return"/gramet"===e[0]||"/export"===e[0]?0:"/"===e[0]?1:"/help"===e[0]?2:-1}return~(c=y(e))&&(u=h[c]=v[c](e)),{c(){t=C("main"),n=C("div"),xe(o.$$.fragment),s=F(),xe(l.$$.fragment),i=F(),g&&g.c(),a=F(),u&&u.c(),T(n,"class","content svelte-1pvavz"),T(t,"class",p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz")},m(r,u){x(r,t,u),b(t,n),ke(o,n,null),b(n,s),ke(l,n,null),b(n,i),g&&g.m(n,null),b(n,a),~c&&h[c].m(n,null),d=!0,f||(m=[j(xo,"hashchange",e[3]),j(xo,"online",e[6]),j(xo,"offline",e[7])],f=!0)},p(e,[r]){const s={};2&r&&(s.promise=e[1]),1&r&&(s.route=e[0]),131079&r&&(s.$$scope={dirty:r,ctx:e}),o.$set(s);const i={};2&r&&(i.loaded=!!e[1]),l.$set(i),e[1]?g?(g.p(e,r),2&r&&ge(g,1)):(g=wo(e),g.c(),ge(g,1),g.m(n,a)):g&&(fe(),ve(g,1,1,(()=>{g=null})),me());let f=c;c=y(e),c===f?~c&&h[c].p(e,r):(u&&(fe(),ve(h[f],1,1,(()=>{h[f]=null})),me()),~c?(u=h[c],u?u.p(e,r):(u=h[c]=v[c](e),u.c()),ge(u,1),u.m(n,null)):u=null),(!d||1&r&&p!==(p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz"))&&T(t,"class",p)},i(e){d||(ge(o.$$.fragment,e),ge(l.$$.fragment,e),ge(g),ge(u),d=!0)},o(e){ve(o.$$.fragment,e),ve(l.$$.fragment,e),ve(g),ve(u),d=!1},d(e){e&&k(t),we(o),we(l),g&&g.d(),~c&&h[c].d(),f=!1,r(m)}}}function Go(e,t,n){let o,r,s;i(e,Nt,(e=>n(12,o=e))),i(e,Et,(e=>n(13,r=e))),i(e,Wt,(e=>n(14,s=e)));let l,a="/",c=window.location.href;(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in Ye){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(He)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||ot.setItem(nt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&ot.setItem(nt.shortcut,o));ot.setItem(nt.optionsKML,n)})(window.location.search);let u=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Ye&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(He)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...Ye,...t}})(ot.getItem(nt.optionsKML)||{});const p=e=>{const t=document.querySelector("meta[name=viewport]"),r=t?t.getAttribute("content"):"";n(0,a=window.location.hash.substr(1)||"/"),l||"/map"!==a&&"/gramet"!==a&&"/export"!==a||n(0,a="/"),"/map"===a?(o&&d(Nt,o=!1,o),r&&t.setAttribute("content",r+",maximum-scale=1")):r&&t.setAttribute("content",r.replace(",maximum-scale=1",""))};p();const f=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(nt)){let r=ot.getItem(o);if(n===nt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==Ye[t])))t[n]=e[n];r=t}if(null!==r)if(n===nt.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(u);let n=Object.entries(t).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&");c=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+a,history.replaceState(t,"Mon OFP2MAP",c)};f();return[a,l,u,p,f,()=>{o&&d(Nt,o=!1,o),r&&d(Et,r=!1,r),window.serviceWorker&&window.serviceWorker.update&&window.serviceWorker.update().catch((e=>{}))},()=>{d(Wt,s=!0,s)},()=>{d(Wt,s=!1,s)},function(t){Z(e,t)},function(e){l=e,n(1,l)},function(e){u=e,n(2,u)}]}return new class extends Pe{constructor(e){super(),Ce(this,e,Go,Wo,l,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
