var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function a(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}function d(e){return null==e?"":e}function p(e,t,n=t){return e.set(n),t}function m(t){return t&&s(t.destroy)?t.destroy:e}const f="undefined"!=typeof window;let g=f?()=>window.performance.now():()=>Date.now(),v=f?e=>requestAnimationFrame(e):e;const h=new Set;function y(e){h.forEach(t=>{t.c(e)||(h.delete(t),t.f())}),0!==h.size&&v(y)}function b(e){let t;return 0===h.size&&v(y),{promise:new Promise(n=>{h.add(t={c:e,f:n})}),abort(){h.delete(t)}}}function $(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function w(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function F(e){return document.createTextNode(e)}function z(){return F(" ")}function L(){return F("")}function j(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function _(e){return function(t){return t.preventDefault(),e.call(this,t)}}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function O(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function T(e,t){t=""+t,e.data!==t&&(e.data=t)}function M(e,t){(null!=t||e.value)&&(e.value=t)}function I(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function D(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function E(e,t,n){e.classList[n?"add":"remove"](t)}function R(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const N=new Set;let W,G=0;function q(e,t,n,o,r,s,i,l=0){const a=16.666/o;let c="{\n";for(let e=0;e<=1;e+=a){const o=t+(n-t)*s(e);c+=100*e+`%{${i(o,1-o)}}\n`}const u=c+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${l}`,p=e.ownerDocument;N.add(p);const m=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(C("style")).sheet),f=p.__svelte_rules||(p.__svelte_rules={});f[d]||(f[d]=!0,m.insertRule(`@keyframes ${d} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?g+", ":""}${d} ${o}ms linear ${r}ms 1 both`,G+=1,d}function U(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),G-=r,G||v(()=>{G||(N.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),N.clear())}))}function H(e){W=e}function B(){if(!W)throw new Error("Function called outside component initialization");return W}function K(){const e=B();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=R(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}function Z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const J=[],X=[],V=[],Y=[],Q=Promise.resolve();let ee=!1;function te(){ee||(ee=!0,Q.then(ie))}function ne(e){V.push(e)}function oe(e){Y.push(e)}let re=!1;const se=new Set;function ie(){if(!re){re=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];H(t),le(t.$$)}for(J.length=0;X.length;)X.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];se.has(t)||(se.add(t),t())}V.length=0}while(J.length);for(;Y.length;)Y.pop()();ee=!1,re=!1,se.clear()}}function le(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let ae;function ce(){return ae||(ae=Promise.resolve(),ae.then(()=>{ae=null})),ae}function ue(e,t,n){e.dispatchEvent(R(`${t?"intro":"outro"}${n}`))}const de=new Set;let pe;function me(){pe={r:0,c:[],p:pe}}function fe(){pe.r||r(pe.c),pe=pe.p}function ge(e,t){e&&e.i&&(de.delete(e),e.i(t))}function ve(e,t,n,o){if(e&&e.o){if(de.has(e))return;de.add(e),pe.c.push(()=>{de.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const he={duration:0};function ye(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let i=t.ctx;void 0!==r&&(i=i.slice(),i[r]=s);const l=e&&(t.current=e)(i);let a=!1;t.block&&(t.blocks?t.blocks.forEach((e,n)=>{n!==o&&e&&(me(),ve(e,1,1,()=>{t.blocks[n]=null}),fe())}):t.block.d(1),l.c(),ge(l,1),l.m(t.mount(),t.anchor),a=!0),t.block=l,t.blocks&&(t.blocks[o]=l),a&&ie()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=B();if(e.then(e=>{H(n),o(t.then,1,t.value,e),H(null)},e=>{H(n),o(t.catch,2,t.error,e),H(null)}),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const be="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function $e(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function xe(e){e&&e.c()}function ke(e,t,o){const{fragment:i,on_mount:l,on_destroy:a,after_update:c}=e.$$;i&&i.m(t,o),ne(()=>{const t=l.map(n).filter(s);a?a.push(...t):r(t),e.$$.on_mount=[]}),c.forEach(ne)}function we(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(t,n,s,i,l,a,c=[-1]){const u=W;H(t);const d=n.props||{},p=t.$$={fragment:null,ctx:null,props:a,update:e,not_equal:l,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c};let m=!1;if(p.ctx=s?s(t,d,(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=r)&&(p.bound[e]&&p.bound[e](r),m&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),te(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n}):[],p.update(),m=!0,r(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(k)}else p.fragment&&p.fragment.c();n.intro&&ge(t.$$.fragment),ke(t,n.target,n.anchor),ie()}H(u)}class Pe{$destroy(){we(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}class Fe{constructor(){this.promise=new Promise((e,t)=>{this.reject=t,this.resolve=e})}}const ze="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;function Le(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function je(e,t,n){return e<=t?t:e>=n?n:e}function _e(e,t,n){return!(e<t)&&!(e>n)}function Se(e,{delay:n=0,duration:o=400,easing:r=t}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function Oe(e){let t;return{c(){t=C("textarea"),t.value=e[0],S(t,"class","svelte-12a0ij3")},m(n,o){x(n,t,o),e[8](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&k(t),e[8](null)}}}function Te(t){let n,o;return{c(){n=C("a"),n.textContent="copier la route",S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://")},m(e,r,s){x(e,n,r),s&&o(),o=j(n,"click",t[4])},p:e,d(e){e&&k(n),o()}}}function Me(t){let n,o,r,s;return{c(){n=C("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=z(),r=C("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura √©t√© copi√©e automatiquement).</small>',S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://"),S(r,"class","card-text")},m(e,i,l){x(e,n,i),x(e,o,i),x(e,r,i),l&&s(),s=j(n,"click",t[4])},p:e,d(e){e&&k(n),e&&k(o),e&&k(r),s()}}}function Ie(n){let o,i,l;return{c(){o=C("span"),o.textContent="copi√©!",S(o,"class","svelte-12a0ij3")},m(e,t){x(e,o,t),l=!0},i(e){l||(i&&i.end(1),l=!0)},o(n){i=function(n,o,i){let l,a=o(n,i),c=!0;const u=pe;function d(){const{delay:o=0,duration:s=300,easing:i=t,tick:d=e,css:p}=a||he;p&&(l=q(n,1,0,s,o,i,p));const m=g()+o,f=m+s;ne(()=>ue(n,!1,"start")),b(e=>{if(c){if(e>=f)return d(0,1),ue(n,!1,"end"),--u.r||r(u.c),!1;if(e>=m){const t=i((e-m)/s);d(1-t,t)}}return c})}return u.r+=1,s(a)?ce().then(()=>{a=a(),d()}):d(),{end(e){e&&a.tick&&a.tick(1,0),c&&(l&&U(n,l),c=!1)}}}(o,Se,{}),l=!1},d(e){e&&k(o),e&&i&&i.end()}}}function Ae(e){let t,n,o,r,s,i,l,a,c,u,d,p,m=null!=e[0]&&Oe(e);let f=(ze?Me:Te)(e),g=e[2]&&Ie();return{c(){m&&m.c(),t=z(),n=C("div"),o=C("div"),r=C("h5"),r.textContent="Route Lido",s=z(),i=C("p"),i.textContent="Cette route est optimis√©e par rapport √† celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus r√©active.",l=z(),f.c(),a=z(),c=C("div"),u=F(e[3]),d=z(),g&&g.c(),S(r,"class","card-title"),S(i,"class","card-text"),S(c,"class","text-monospace svelte-12a0ij3"),S(o,"class","card-body"),S(n,"class","card mb-3 svelte-12a0ij3")},m(e,v){m&&m.m(e,v),x(e,t,v),x(e,n,v),$(n,o),$(o,r),$(o,s),$(o,i),$(o,l),f.m(o,null),$(o,a),$(o,c),$(c,u),$(c,d),g&&g.m(c,null),p=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=Oe(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&ge(g,1):(g=Ie(),g.c(),ge(g,1),g.m(c,null)):g&&(me(),ve(g,1,1,()=>{g=null}),fe())},i(e){p||(ge(g),p=!0)},o(e){ve(g),p=!1},d(e){m&&m.d(e),e&&k(t),e&&k(n),f.d(),g&&g.d()}}}let De=!1;try{navigator.permissions.query({name:"clipboard-write"}).then(e=>{"granted"!=e.state&&"prompt"!=e.state||(De=!0)})}catch(e){}function Ee(e,t,n){let o,{ofp:r}=t,s=null;const i=r?r.lidoRoute().join(" "):"";let l=!1;async function a(e){let t=!0;if(De)navigator.clipboard.writeText(e).then(()=>t=!0,()=>t=!1);else{n(0,s=e),await(te(),Q),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}return e.$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,l,i,e=>{e.target.classList.remove("hasactive");const t=a(i);ze||(n(2,l=t),setTimeout((function(){n(2,l=!1)}),3e3),e.preventDefault())},r,e=>{e.target.classList.remove("hasactive"),show=!show},a,function(e){X[e?"unshift":"push"](()=>{n(1,o=e)})}]}class Re extends Pe{constructor(e){super(),Ce(this,e,Ee,Ae,i,{ofp:5})}}function Ne(t){let n,o,i,l,a,c,u,d,p,f,g,v,h,y,b,w,P,L;return{c(){n=C("kmlcolor"),o=C("div"),i=C("label"),l=F("Couleur"),a=z(),c=C("picker"),u=C("label"),d=C("input"),g=z(),v=C("input"),y=z(),b=C("input"),S(i,"for",t[1]),S(i,"class","input-group-text svelte-1hvk4hi"),S(o,"class","input-group-prepend"),S(d,"type","color"),S(d,"class","svelte-1hvk4hi"),S(u,"style",p=He(t[2])),S(u,"class","svelte-1hvk4hi"),S(v,"type","range"),S(v,"min","30"),S(v,"max","255"),S(v,"class","svelte-1hvk4hi"),S(c,"class","form-control svelte-1hvk4hi"),S(c,"style",h=Ue(t[2][0])),S(b,"name",t[1]),S(b,"class","form-control text-monospace svelte-1hvk4hi"),S(b,"style",w=Be(t[0])),S(b,"type","text"),S(b,"maxlength","8"),S(n,"class","input-group svelte-1hvk4hi")},m(e,s,p){x(e,n,s),$(n,o),$(o,i),$(i,l),$(n,a),$(n,c),$(c,u),$(u,d),M(d,t[2][0]),$(c,g),$(c,v),M(v,t[2][1]),$(n,y),$(n,b),M(b,t[0]),p&&r(L),L=[j(d,"input",t[7]),m(f=t[4].call(null,u,t[0])),j(v,"change",t[8]),j(v,"input",t[8]),m(P=t[3].call(null,b,t[2])),j(b,"input",t[9])]},p(e,[t]){2&t&&S(i,"for",e[1]),4&t&&M(d,e[2][0]),4&t&&p!==(p=He(e[2]))&&S(u,"style",p),f&&s(f.update)&&1&t&&f.update.call(null,e[0]),4&t&&M(v,e[2][1]),4&t&&h!==(h=Ue(e[2][0]))&&S(c,"style",h),2&t&&S(b,"name",e[1]),1&t&&w!==(w=Be(e[0]))&&S(b,"style",w),P&&s(P.update)&&4&t&&P.update.call(null,e[2]),1&t&&b.value!==e[0]&&M(b,e[0])},i:e,o:e,d(e){e&&k(n),r(L)}}}const We=/^[A-F0-9]{8}$/i,Ge=e=>{let[t,n]=qe(e);return[t,n/255]},qe=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},Ue=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map(e=>parseInt(e,16));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},He=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Be=e=>e.match(We)?"":"border-color: #F00;";function Ke(e,t,n){const o=K();let r,{kmlColor:s="FF0000FF"}=t,{name:i}=t;try{r=qe(s)}catch(e){r=["#FF0000",255]}const l=function(e,t,n){let o;return function(){const r=this,s=arguments,i=function(){o=null,n||e.apply(r,s)},l=n&&!o;clearTimeout(o),o=setTimeout(i,t),l&&e.apply(r,s)}}(o,500);return e.$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,i=e.name)},[s,i,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),l("change",{name:i,value:s})}}},function(e){return{update(e){if(e.match(We)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),l("change",{name:i,value:e.toUpperCase()})}}}},o,l,function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?void 0:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class Ze extends Pe{constructor(e){super(),Ce(this,e,Ke,Ne,i,{kmlColor:0,name:1})}}const Je={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,etopsDisplay:!0,etopsColor:"FF0324FC"};function Xe(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const Ve=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Xe(window.kmlGen,Je)),window.kmlGen);function Ye(e,t){let n={...Je,...t};const o=Ve();Xe(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,i=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),l=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route D√©gagement"}),a=new editolido.Route([i.points[0],i.points[i.points.length-1]]).split(300,{name:"Ortho "+s});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",a),o.addLine("rmain",i),o.addPoints("rmain",i,{excluded:c}),o.addLine("ralt",l);const u=new editolido.GeoGridIndex;u.data=window.WMO;const d=editolido.ogimetData(e,u),p=d.route;d.proxyImg="https://editolido.alwaysdata.net/proxy_gramet2/"+d.proxy+"/"+d.route.name.replace(/[^a-z0-9\-_]/giu,"_")+".png",e.ogimetData=d,p.description=d.wmo.join(" "),o.addLine("ogimet",p),o.addPoints("ralt",l)}const Qe=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),et=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function tt(t){let n,o,s,i,l,a,c,u,d;return{c(){n=C("div"),o=C("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',s=z(),i=C("input"),l=z(),a=C("div"),c=C("a"),u=F("Lancer"),S(o,"class","input-group-prepend"),S(i,"class","form-control svelte-1ecyaux"),S(i,"placeholder","Nom du raccourci"),S(i,"type","text"),S(c,"class","btn btn-outline-secondary svelte-1ecyaux"),S(c,"href",t[1]),E(c,"disabled",!(t[0].trim()&&ze)),S(a,"class","input-group-append"),S(n,"class","input-group")},m(e,p,m){x(e,n,p),$(n,o),$(n,s),$(n,i),M(i,t[0]),$(n,l),$(n,a),$(a,c),$(c,u),m&&r(d),d=[j(i,"input",t[8]),j(i,"change",t[3]),j(c,"click",t[2])]},p(e,[t]){1&t&&i.value!==e[0]&&M(i,e[0]),2&t&&S(c,"href",e[1]),1&t&&E(c,"disabled",!(e[0].trim()&&ze))},i:e,o:e,d(e){e&&k(n),r(d)}}}function nt(e,t,n){const o=K(),r=Qe.shortcut;let s,i=et.getItem(r)||"OFP2MAP",{ofp:l}=t;const a=l?l.lidoRoute().join(" "):"";return e.$set=e=>{"ofp"in e&&n(4,l=e.ofp)},[i,s,function(e){const t=i.trim();if(t&&ze){const e=Ve(),o={lidoRoute:a,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:l.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=i.trim();"OFP2MAP"===e?et.removeItem(r):et.setItem(r,e),o("save",[r,e])},l,o,r,a,function(){i=this.value,n(0,i)}]}class ot extends Pe{constructor(e){super(),Ce(this,e,nt,tt,i,{ofp:4})}}const rt=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function s(e,t){return e.getElementsByTagName(t)}function i(e,t){return e.getAttribute(t)}function l(e,t){return parseFloat(i(e,t))}function a(e,t){var n=s(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function d(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=a(e,t[o]))&&(r[t[o]]=u(n));return r}function p(e,t){for(var n in t)e[n]=t[n]}function m(e){return c(e.replace(t,"").split(","))}function f(e){for(var t=e.replace(n,"").split(o),r=[],s=0;s<t.length;s++)r.push(m(t[s]));return r}function g(e){var t,n=[l(e,"lon"),l(e,"lat")],o=a(e,"ele"),r=a(e,"gpxtpx:hr")||a(e,"hr"),s=a(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:s?u(s):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function v(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},l={},d=["Polygon","LineString","Point","Track","gx:Track"],p=s(e,"Placemark"),g=s(e,"Style"),h=s(e,"StyleMap"),y=0;y<g.length;y++){var b=r(v(g[y])).toString(16);n["#"+i(g[y],"id")]=b,o[b]=g[y]}for(var $=0;$<h.length;$++){n["#"+i(h[$],"id")]=r(v(h[$])).toString(16);for(var x=s(h[$],"Pair"),k={},w=0;w<x.length;w++)k[u(a(x[w],"key"))]=u(a(x[w],"styleUrl"));l["#"+i(h[$],"id")]=k}for(var C=0;C<p.length;C++)t.features=t.features.concat(z(p[C]));function P(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function F(e){var t=s(e,"coord"),n=[],o=[];0===t.length&&(t=s(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var i=s(e,"when"),l=0;l<i.length;l++)o.push(u(i[l]));return{coords:n,times:o}}function z(e){var t,r=function e(t){var n,o,r,i,l,c=[],p=[];if(a(t,"MultiGeometry"))return e(a(t,"MultiGeometry"));if(a(t,"MultiTrack"))return e(a(t,"MultiTrack"));if(a(t,"gx:MultiTrack"))return e(a(t,"gx:MultiTrack"));for(r=0;r<d.length;r++)if(o=s(t,d[r]))for(i=0;i<o.length;i++)if(n=o[i],"Point"===d[r])c.push({type:"Point",coordinates:m(u(a(n,"coordinates")))});else if("LineString"===d[r])c.push({type:"LineString",coordinates:f(u(a(n,"coordinates")))});else if("Polygon"===d[r]){var g=s(n,"LinearRing"),v=[];for(l=0;l<g.length;l++)v.push(f(u(a(g[l],"coordinates"))));c.push({type:"Polygon",coordinates:v})}else if("Track"===d[r]||"gx:Track"===d[r]){var h=F(n);c.push({type:"LineString",coordinates:h.coords}),h.times.length&&p.push(h.times)}return{geoms:c,coordTimes:p}}(e),c={},p=u(a(e,"name")),g=u(a(e,"address")),v=u(a(e,"styleUrl")),h=u(a(e,"description")),y=a(e,"TimeSpan"),b=a(e,"TimeStamp"),$=a(e,"ExtendedData"),x=a(e,"LineStyle"),k=a(e,"PolyStyle"),w=a(e,"visibility");if(!r.geoms.length)return[];if(p&&(c.name=p),g&&(c.address=g),v){"#"!==v[0]&&(v="#"+v),c.styleUrl=v,n[v]&&(c.styleHash=n[v]),l[v]&&(c.styleMapHash=l[v],c.styleHash=n[l[v].normal]);var C=o[c.styleHash];if(C){x||(x=a(C,"LineStyle")),k||(k=a(C,"PolyStyle"));var z=a(C,"IconStyle");if(z){var L=a(z,"Icon");if(L){var j=u(a(L,"href"));j&&(c.icon=j)}}}}if(h&&(c.description=h),y){var _=u(a(y,"begin")),S=u(a(y,"end"));c.timespan={begin:_,end:S}}if(b&&(c.timestamp=u(a(b,"when"))),x){var O=P(u(a(x,"color"))),T=O[0],M=O[1],I=parseFloat(u(a(x,"width")));T&&(c.stroke=T),isNaN(M)||(c["stroke-opacity"]=M),isNaN(I)||(c["stroke-width"]=I)}if(k){var A=P(u(a(k,"color"))),D=A[0],E=A[1],R=u(a(k,"fill")),N=u(a(k,"outline"));D&&(c.fill=D),isNaN(E)||(c["fill-opacity"]=E),R&&(c["fill-opacity"]="1"===R?c["fill-opacity"]||1:0),N&&(c["stroke-opacity"]="1"===N?c["stroke-opacity"]||1:0)}if($){var W=s($,"Data"),G=s($,"SimpleData");for(t=0;t<W.length;t++)c[W[t].getAttribute("name")]=u(a(W[t],"value"));for(t=0;t<G.length;t++)c[G[t].getAttribute("name")]=u(G[t])}w&&(c.visibility=u(w)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var q={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return i(e,"id")&&(q.id=i(e,"id")),[q]}return t},gpx:function(e){var t,n,o=s(e,"trk"),r=s(e,"rte"),l=s(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=v(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=h(r[t]))&&c.features.push(n);for(t=0;t<l.length;t++)c.features.push(y(l[t]));function m(e,t){for(var n=0;n<t;n++)e.push(null);return e}function f(e,t){var n=s(e,t),o=[],r=[],i=[],l=n.length;if(l<2)return{};for(var a=0;a<l;a++){var c=g(n[a]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||i.length)&&(i.length||m(i,a),i.push(c.heartRate||null))}return{line:o,times:r,heartRates:i}}function v(e){for(var t,n=s(e,"trkseg"),o=[],r=[],i=[],l=0;l<n.length;l++)if((t=f(n[l],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),i.length||t.heartRates&&t.heartRates.length)){if(!i.length)for(var c=0;c<l;c++)i.push(m([],o[c].length));t.heartRates&&t.heartRates.length?i.push(t.heartRates):i.push(m([],t.line.length||0))}if(0!==o.length){var u=$(e);return p(u,b(a(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),i.length&&(u.heartRates=1===o.length?i[0]:i),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function h(e){var t=f(e,"rtept");if(t.line){var n=$(e);return p(n,b(a(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=$(e);return p(t,d(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function b(e){var t={};if(e){var n=a(e,"line");if(n){var o=u(a(n,"color")),r=parseFloat(u(a(n,"opacity"))),s=parseFloat(u(a(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(s)||(t["stroke-width"]=96*s/25.4)}}return t}function $(e){var t=d(e,["name","cmt","desc","type","time","keywords"]),n=s(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)p(o={href:i(n[r],"href")},d(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function st(t){let n,o,s,i,l,a,c,u,d,p,m,f,g,v,h,y,b,w,P,L=at[0]+"",_=at[1]+"",O=at[2]+"";return{c(){n=C("div"),o=C("select"),s=C("option"),i=F(L),c=C("option"),u=F(_),m=C("option"),f=F(O),h=z(),y=C("div"),b=C("a"),w=F(t[0]),s.selected=l=0===t[1],s.__value=a=0,s.value=s.__value,c.selected=d=1===t[1],c.__value=p=1,c.value=c.__value,m.selected=g=2===t[1],m.__value=v=2,m.value=m.__value,S(o,"class","custom-select svelte-19hokx5"),S(o,"aria-label","Example select with button addon"),void 0===t[1]&&ne(()=>t[8].call(o)),S(b,"class","btn btn-success"),S(b,"download",t[3]),S(b,"href",t[2]),S(b,"target",it),S(y,"class","input-group-append"),S(n,"class","input-group")},m(e,l,a){x(e,n,l),$(n,o),$(o,s),$(s,i),$(o,c),$(c,u),$(o,m),$(m,f),A(o,t[1]),$(n,h),$(n,y),$(y,b),$(b,w),a&&r(P),P=[j(o,"change",t[8]),j(o,"change",t[5]),j(b,"click",t[4])]},p(e,[t]){2&t&&l!==(l=0===e[1])&&(s.selected=l),2&t&&d!==(d=1===e[1])&&(c.selected=d),2&t&&g!==(g=2===e[1])&&(m.selected=g),2&t&&A(o,e[1]),1&t&&T(w,e[0]),8&t&&S(b,"download",e[3]),4&t&&S(b,"href",e[2])},i:e,o:e,d(e){e&&k(n),r(P)}}}const it=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,lt=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},at=["KML Mapsme","KML Avenza","GeoJson"];function ct(e,t,n){const o=K();let{label:r}=t;const s=Qe.downloadType;let i=et.getItem(s)||1;"string"==typeof i&&(i=parseInt(i,10));let l="",a="";return e.$set=e=>{"label"in e&&n(0,r=e.label)},[r,i,l,a,function(e){const t=Ve(),o=["_mapsme.kml","_avenza.kml",".geojson"][i];let r=t.name;if(r?(r=r.trim(),n(3,a=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,a="editolido"+o),0===i)n(2,l=lt(t.render()));else if(1===i)n(2,l=lt(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==i)return e.preventDefault(),!1;n(2,l=lt(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return rt.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===i?et.removeItem(s):et.setItem(s,i),o("save",[s,i])},o,s,function(){i=D(this),n(1,i)}]}class ut extends Pe{constructor(e){super(),Ce(this,e,ct,st,i,{label:0})}}function dt(e){let t,n,o,r,s,i,l,a,c,u,d,p,m;const f=new ut({props:{label:"T√©l√©charger"}});f.$on("save",e[1]);const g=new ot({props:{ofp:e[0]}});return g.$on("save",e[2]),{c(){t=C("div"),n=C("div"),o=C("h5"),o.textContent="Export",r=z(),s=C("div"),i=C("div"),xe(f.$$.fragment),l=z(),a=C("small"),a.textContent="Le fichier est g√©n√©r√© en fonction des options choisies sur la carte.",c=z(),u=C("div"),xe(g.$$.fragment),d=z(),p=C("small"),p.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">\n                    Exemple de raccourci √† installer\n                </a>',S(o,"class","card-title"),S(a,"class","text-muted"),S(i,"class","col-12 col-sm-6 col-md-6"),S(p,"class","text-muted"),S(u,"class","col-12 col-sm-6 col-md-6"),S(s,"class","row"),S(n,"class","card-body"),S(t,"class","card mb-3 svelte-17snbjk")},m(e,v){x(e,t,v),$(t,n),$(n,o),$(n,r),$(n,s),$(s,i),ke(f,i,null),$(i,l),$(i,a),$(s,c),$(s,u),ke(g,u,null),$(u,d),$(u,p),m=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),g.$set(n)},i(e){m||(ge(f.$$.fragment,e),ge(g.$$.fragment,e),m=!0)},o(e){ve(f.$$.fragment,e),ve(g.$$.fragment,e),m=!1},d(e){e&&k(t),we(f),we(g)}}}function pt(e,t,n){let{ofp:o}=t;return e.$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){Z(e,t)},function(t){Z(e,t)}]}class mt extends Pe{constructor(e){super(),Ce(this,e,pt,dt,i,{ofp:0})}}function ft(e){let t;return{c(){t=C("div"),t.innerHTML='<span class="sr-only">Loading...</span>',S(t,"class","spinner-border text-warning"),S(t,"role","status")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function gt(e){let t,n,o,r,s,i,l,a,c,u;return{c(){t=C("div"),n=C("p"),o=F("üò±: Erreur de r√©cup√©ration du Gramet, "),r=C("a"),r.textContent="essayez √† nouveau",s=F(" ou allez sur "),i=C("a"),l=F("ogimet"),c=F("."),S(r,"href","."),S(i,"href",a=e[0].ogimetData.url),S(i,"target","_blank"),S(n,"class","svelte-i1m2fr"),S(t,"class","error svelte-i1m2fr")},m(a,d,p){x(a,t,d),$(t,n),$(n,o),$(n,r),$(n,s),$(n,i),$(i,l),$(n,c),p&&u(),u=j(r,"click",_(e[4]))},p(e,t){1&t&&a!==(a=e[0].ogimetData.url)&&S(i,"href",a)},d(e){e&&k(t),u()}}}function vt(e){let t,n,o;return{c(){t=C("img"),S(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n),S(t,"alt","gramet demo"),S(t,"class","img-fluid svelte-i1m2fr")},m(n,s,i){x(n,t,s),i&&r(o),o=[j(t,"error",e[2]),j(t,"load",e[3])]},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n)},d(e){e&&k(t),r(o)}}}function ht(t){let n,o,r,s,i,l,a,c,u,d,p,m,f,g,v,h,y,b,w,P,L,j="loading"===t[1]&&ft();function _(e,t){return"error"!==e[1]?vt:gt}let O=_(t),T=O(t);return{c(){n=C("div"),o=C("h1"),o.innerHTML='Le GRAMET est un m√©t√©ogramme repr√©sentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et √† l&#39;heure de passage estim√©e, une coupe verticale de la m√©t√©o pr√©vue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interpr√©tation</a>',r=z(),s=C("div"),j&&j.c(),i=z(),T.c(),l=z(),a=C("div"),c=C("div"),u=C("div"),d=C("div"),p=C("div"),p.textContent="Route Ogimet",m=z(),f=C("div"),g=C("p"),v=F("Le GRAMET est r√©alis√© par "),h=C("a"),y=F("www.ogimet.com"),w=F(" √† partir\n    d'une route calcul√©e. Il est possible d'afficher la route sur la carte. Cel√† est\n    particuli√®rement utile lors des vols oc√©aniques car il n'y a aucune station en mer."),P=z(),L=C("div"),L.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Apr√®s avoir s√©lectionner les stations m√©t√©o proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectu√© pour r√©duire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',S(o,"class","svelte-i1m2fr"),S(s,"class","text-center svelte-i1m2fr"),S(p,"class","card-header svelte-i1m2fr"),S(h,"class","text-warning"),S(h,"href",b=t[0].ogimetData.url),S(h,"target","_blank"),S(g,"class","card-text"),S(f,"class","card-body"),S(d,"class","card ogimet svelte-i1m2fr"),S(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),S(L,"class","col-12 col-sm-6 col-md-6 col-xl-6"),S(c,"class","card-deck"),S(a,"class","row")},m(e,t){x(e,n,t),$(n,o),$(n,r),$(n,s),j&&j.m(s,null),$(s,i),T.m(s,null),$(n,l),$(n,a),$(a,c),$(c,u),$(u,d),$(d,p),$(d,m),$(d,f),$(f,g),$(g,v),$(g,h),$(h,y),$(g,w),$(c,P),$(c,L)},p(e,[t]){"loading"===e[1]?j||(j=ft(),j.c(),j.m(s,i)):j&&(j.d(1),j=null),O===(O=_(e))&&T?T.p(e,t):(T.d(1),T=O(e),T&&(T.c(),T.m(s,null))),1&t&&b!==(b=e[0].ogimetData.url)&&S(h,"href",b)},i:e,o:e,d(e){e&&k(n),j&&j.d(),T.d()}}}function yt(e,t,n){let o="loading",{ofp:r}=t;return e.$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class bt extends Pe{constructor(e){super(),Ce(this,e,yt,ht,i,{ofp:0})}}function $t(t){let n,o,r;return{c(){n=C("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-k27z50"> en KML/GeoJSON',o=z(),r=C("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3"><div class="card avenza svelte-k27z50"><div class="card-header svelte-k27z50">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les derni√®res technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card mapsme svelte-k27z50"><div class="card-header svelte-k27z50">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le th√®me par d√©faut s&#39;accorde parfaitement avec les fichiers avions, √©galement compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card ogimet svelte-k27z50"><div class="card-header svelte-k27z50">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3"><div class="card shortcuts svelte-k27z50"><div class="card-header svelte-k27z50">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">R√©cup√©rez le KML, le Gramet, et une route Lido optimis√©e dans l&#39;app Raccourcis</p></div></div></div></div>',S(n,"class","text-center svelte-k27z50"),S(r,"class","row svelte-k27z50")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r)}}}class xt extends Pe{constructor(e){super(),Ce(this,e,null,$t,i,{})}}function kt(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function wt(e){let t,n,o,r,s=e[4].label+"";return{c(){t=C("option"),n=F(s),t.__value=o=e[6],t.value=t.__value,t.selected=r=e[6]===e[0]},m(e,o){x(e,t,o),$(t,n)},p(e,n){1&n&&r!==(r=e[6]===e[0])&&(t.selected=r)},d(e){e&&k(t)}}}function Ct(t){let n,o,i,l,a,c,u,d,p,m,f,g=Pt,v=[];for(let e=0;e<g.length;e+=1)v[e]=wt(kt(t,g,e));return{c(){n=C("div"),o=C("div"),i=C("label"),l=F("Rep√®re"),a=z(),c=C("span"),u=P("svg"),d=P("use"),p=z(),m=C("select");for(let e=0;e<v.length;e+=1)v[e].c();S(i,"class","input-group-text svelte-1j0ign2"),S(i,"for",t[1]),O(d,"xlink:href","#marker"),I(d,"stroke",0===t[0]?"#fff":"#000"),I(d,"fill",Pt[t[0]].color),S(u,"class","svelte-1j0ign2"),S(c,"class","input-group-text svelte-1j0ign2"),S(o,"class","input-group-prepend"),S(m,"name",t[1]),S(m,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ne(()=>t[3].call(m)),S(n,"class","input-group svelte-1j0ign2")},m(e,g,h){x(e,n,g),$(n,o),$(o,i),$(i,l),$(o,a),$(o,c),$(c,u),$(u,d),$(n,p),$(n,m);for(let e=0;e<v.length;e+=1)v[e].m(m,null);A(m,t[0]),h&&r(f),f=[j(m,"change",t[3]),j(m,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))]},p(e,[n]){if(t=e,2&n&&S(i,"for",t[1]),1&n&&I(d,"stroke",0===t[0]?"#fff":"#000"),1&n&&I(d,"fill",Pt[t[0]].color),1&n){let e;for(g=Pt,e=0;e<g.length;e+=1){const o=kt(t,g,e);v[e]?v[e].p(o,n):(v[e]=wt(o),v[e].c(),v[e].m(m,null))}for(;e<v.length;e+=1)v[e].d(1);v.length=g.length}2&n&&S(m,"name",t[1]),1&n&&A(m,t[0])},i:e,o:e,d(e){e&&k(n),w(v,e),r(f)}}}const Pt=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Ft(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class zt extends Pe{constructor(e){super(),Ce(this,e,Ft,Ct,i,{selected:0,name:1})}}function Lt(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function jt(e){let t,n,o,r,s=e[4].label+"";return{c(){t=C("option"),n=F(s),t.__value=o=e[6],t.value=t.__value,t.selected=r=e[6]===e[0]},m(e,o){x(e,t,o),$(t,n)},p(e,n){1&n&&r!==(r=e[6]===e[0])&&(t.selected=r)},d(e){e&&k(t)}}}function _t(t){let n,o,i,l,a,c,u,d=St,p=[];for(let e=0;e<d.length;e+=1)p[e]=jt(Lt(t,d,e));return{c(){n=C("div"),o=C("div"),i=C("label"),l=F("Couleur"),a=z(),c=C("select");for(let e=0;e<p.length;e+=1)p[e].c();S(i,"class","input-group-text svelte-90luj4"),S(i,"for",t[1]),S(o,"class","input-group-prepend"),S(c,"name",t[1]),S(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ne(()=>t[3].call(c)),S(n,"class","input-group svelte-90luj4")},m(e,d,m){x(e,n,d),$(n,o),$(o,i),$(i,l),$(n,a),$(n,c);for(let e=0;e<p.length;e+=1)p[e].m(c,null);A(c,t[0]),m&&r(u),u=[j(c,"change",t[3]),j(c,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))]},p(e,[n]){if(t=e,2&n&&S(i,"for",t[1]),1&n){let e;for(d=St,e=0;e<d.length;e+=1){const o=Lt(t,d,e);p[e]?p[e].p(o,n):(p[e]=jt(o),p[e].c(),p[e].m(c,null))}for(;e<p.length;e+=1)p[e].d(1);p.length=d.length}2&n&&S(c,"name",t[1]),1&n&&A(c,t[0])},i:e,o:e,d(e){e&&k(n),w(p,e),r(u)}}}const St=[{label:"statuts"},{label:"vert/rouge"}];function Ot(e,t,n){const o=K();let{selected:r=0}=t,{name:s}=t;return e.$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class Tt extends Pe{constructor(e){super(),Ce(this,e,Ot,_t,i,{selected:0,name:1})}}const Mt=[];function It(t,n=e){let o;const r=[];function s(e){if(i(t,e)&&(t=e,o)){const e=!Mt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Mt.push(n,t)}if(e){for(let e=0;e<Mt.length;e+=2)Mt[e][0](Mt[e+1]);Mt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,l=e){const a=[i,l];return r.push(a),1===r.length&&(o=n(s)||e),i(t),()=>{const e=r.indexOf(a);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const At=It(!1),Dt=It(!1);function Et(t){let n,o;return{c(){n=C("button"),n.textContent="Revenir aux valeurs par d√©faut",S(n,"class","btn btn-link btn-sm float-right"),S(n,"type","button")},m(e,r,s){x(e,n,r),s&&o(),o=j(n,"click",t[7])},p:e,d(e){e&&k(n),o()}}}function Rt(e){let t,n,o,s,i,l,a,c,u,p,m,f,g,v,h,y,b,w,L,T,M,I,A,D,R,N,W,G,q,U,H,B,K,Z,J,X,V,Y,Q,ee,te,ne,oe,re,se,ie,le,ae,ce,ue,de,pe,me,fe,he,ye,be,$e,Ce,Pe,Fe,ze,Le,je,_e,Se,Oe,Te,Me,Ie,Ae,De,Ee,Re,Ne,We,Ge,qe,Ue,He,Be,Ke,Je,Xe,Ve,Ye,Qe,et,tt,nt,ot,rt,st,it,lt,at,ct,ut,dt,pt,mt,ft,gt,vt,ht,yt,bt,$t,xt,kt,wt;const Ct=new Ze({props:{name:"route-color",kmlColor:e[0].routeColor}});Ct.$on("change",e[6]);const Pt=new zt({props:{name:"route-pin",selected:e[0].routePin}});Pt.$on("change",e[6]);const Ft=new Ze({props:{name:"alternate-color",kmlColor:e[0].alternateColor}});Ft.$on("change",e[6]);const Lt=new zt({props:{name:"alternate-pin",selected:e[0].alternatePin}});Lt.$on("change",e[6]);const jt=new Ze({props:{name:"nat-color",kmlColor:e[0].natColor}});jt.$on("change",e[6]);const _t=new zt({props:{name:"nat-pin",selected:e[0].natPin}});_t.$on("change",e[6]);const St=new Ze({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}});St.$on("change",e[6]);const Ot=new Ze({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}});Ot.$on("change",e[6]);const Mt=new Ze({props:{name:"etops-color",kmlColor:e[0].etopsColor}});Mt.$on("change",e[6]);const It=new Tt({props:{name:"airport-pin",selected:e[0].airportPin}});It.$on("change",e[6]);let At=!e[3]&&Et(e);return{c(){t=C("div"),n=C("a"),o=P("svg"),s=P("use"),i=z(),l=C("a"),a=P("svg"),c=P("use"),u=z(),p=C("form"),m=C("fieldset"),f=C("legend"),f.textContent="Route",g=z(),v=C("div"),h=C("div"),xe(Ct.$$.fragment),b=z(),w=C("div"),xe(Pt.$$.fragment),T=z(),M=C("fieldset"),I=C("legend"),A=C("input"),R=F("D√©gagement"),N=z(),W=C("div"),G=C("div"),xe(Ft.$$.fragment),U=z(),H=C("div"),xe(Lt.$$.fragment),K=z(),Z=C("fieldset"),J=C("legend"),X=C("input"),Y=F("Tracks"),Q=z(),ee=C("div"),te=C("div"),xe(jt.$$.fragment),ne=z(),oe=C("small"),oe.textContent="Un track incomplet restera rouge.",se=z(),ie=C("div"),xe(_t.$$.fragment),le=z(),ae=C("small"),ae.textContent="Positionn√© √† l'entr√©e des tracks.",ue=z(),de=C("div"),pe=C("div"),me=C("fieldset"),fe=C("legend"),he=C("input"),be=F("Orthodromie"),$e=z(),Ce=C("div"),Pe=C("div"),xe(St.$$.fragment),ze=z(),Le=C("div"),je=C("fieldset"),_e=C("legend"),Se=C("input"),Te=F("Route du GRAMET"),Me=z(),Ie=C("div"),Ae=C("div"),xe(Ot.$$.fragment),Ee=z(),Re=C("div"),Ne=C("div"),We=C("fieldset"),Ge=C("legend"),qe=C("input"),He=F("Etops"),Be=z(),Ke=C("div"),Je=C("div"),xe(Mt.$$.fragment),Ve=z(),Ye=C("div"),Qe=C("fieldset"),et=C("legend"),tt=C("input"),ot=F("Airports"),rt=z(),st=C("div"),it=C("div"),xe(It.$$.fragment),at=z(),ct=C("div"),ut=C("div"),dt=C("button"),pt=F("M√©moriser"),ft=z(),gt=C("button"),vt=F("Restaurer"),bt=z(),$t=C("div"),At&&At.c(),O(s,"xlink:href","#bars"),S(o,"class","svelte-2tiaz1"),E(o,"blink",e[2]),S(n,"class","hamburger svelte-2tiaz1"),S(n,"role","button"),S(n,"href","."),O(c,"xlink:href","#close"),S(a,"class","svelte-2tiaz1"),E(a,"blink",e[2]),S(l,"class","closeB svelte-2tiaz1"),S(l,"role","button"),S(l,"href","."),S(f,"class","svelte-2tiaz1"),S(h,"class",y=d(e[1])+" svelte-2tiaz1"),S(w,"class",L=d(e[1])+" svelte-2tiaz1"),S(v,"class","row"),S(m,"class","form-group svelte-2tiaz1"),S(A,"name","alternate-display"),A.checked=D=e[0].alternateDisplay,S(A,"type","checkbox"),S(A,"class","svelte-2tiaz1"),S(I,"class","svelte-2tiaz1"),S(G,"class",q=d(e[1])+" svelte-2tiaz1"),S(H,"class",B=d(e[1])+" svelte-2tiaz1"),S(W,"class","row"),S(M,"class","form-group svelte-2tiaz1"),S(X,"name","nat-display"),X.checked=V=e[0].natDisplay,S(X,"type","checkbox"),S(X,"class","svelte-2tiaz1"),S(J,"class","svelte-2tiaz1"),S(oe,"class","form-text text-muted svelte-2tiaz1"),S(te,"class",re=d(e[1])+" svelte-2tiaz1"),S(ae,"class","form-text text-muted svelte-2tiaz1"),S(ie,"class",ce=d(e[1])+" svelte-2tiaz1"),S(ee,"class","row"),S(Z,"class","form-group svelte-2tiaz1"),S(he,"name","great-circle-display"),he.checked=ye=e[0].greatCircleDisplay,S(he,"type","checkbox"),S(he,"class","svelte-2tiaz1"),S(fe,"class","svelte-2tiaz1"),S(Pe,"class","col"),S(Ce,"class","row"),S(me,"class","form-group svelte-2tiaz1"),S(pe,"class",Fe=d(e[1])+" svelte-2tiaz1"),S(Se,"name","ogimet-display"),Se.checked=Oe=e[0].ogimetDisplay,S(Se,"type","checkbox"),S(Se,"class","svelte-2tiaz1"),S(_e,"class","svelte-2tiaz1"),S(Ae,"class","col"),S(Ie,"class","row"),S(je,"class","form-group svelte-2tiaz1"),S(Le,"class",De=d(e[1])+" svelte-2tiaz1"),S(de,"class","row"),S(qe,"name","etops-display"),qe.checked=Ue=e[0].etopsDisplay,S(qe,"type","checkbox"),S(qe,"class","svelte-2tiaz1"),S(Ge,"class","svelte-2tiaz1"),S(Je,"class","col"),S(Ke,"class","row"),S(We,"class","form-group svelte-2tiaz1"),S(Ne,"class",Xe=d(e[1])+" svelte-2tiaz1"),S(tt,"name","airport-display"),tt.checked=nt=e[0].airportDisplay,S(tt,"type","checkbox"),S(tt,"class","svelte-2tiaz1"),S(et,"class","svelte-2tiaz1"),S(it,"class","col"),S(st,"class","row"),S(Qe,"class","form-group svelte-2tiaz1"),S(Ye,"class",lt=d(e[1])+" svelte-2tiaz1"),S(Re,"class","row"),dt.disabled=mt=!e[4],S(dt,"class","btn btn-primary btn-sm mb-2"),S(dt,"type","button"),gt.disabled=ht=!e[4],S(gt,"class","btn btn-secondary btn-sm mb-2"),S(gt,"type","button"),S(ut,"class",yt=d(e[1])+" svelte-2tiaz1"),S($t,"class",xt=d(e[1])+" svelte-2tiaz1"),S(ct,"class","row last svelte-2tiaz1"),S(p,"class","svelte-2tiaz1"),S(t,"class","settings svelte-2tiaz1"),E(t,"sidebar",e[5])},m(d,y,k){x(d,t,y),$(t,n),$(n,o),$(o,s),$(t,i),$(t,l),$(l,a),$(a,c),$(t,u),$(t,p),$(p,m),$(m,f),$(m,g),$(m,v),$(v,h),ke(Ct,h,null),$(v,b),$(v,w),ke(Pt,w,null),$(p,T),$(p,M),$(M,I),$(I,A),$(I,R),$(M,N),$(M,W),$(W,G),ke(Ft,G,null),$(W,U),$(W,H),ke(Lt,H,null),$(p,K),$(p,Z),$(Z,J),$(J,X),$(J,Y),$(Z,Q),$(Z,ee),$(ee,te),ke(jt,te,null),$(te,ne),$(te,oe),$(ee,se),$(ee,ie),ke(_t,ie,null),$(ie,le),$(ie,ae),$(p,ue),$(p,de),$(de,pe),$(pe,me),$(me,fe),$(fe,he),$(fe,be),$(me,$e),$(me,Ce),$(Ce,Pe),ke(St,Pe,null),$(de,ze),$(de,Le),$(Le,je),$(je,_e),$(_e,Se),$(_e,Te),$(je,Me),$(je,Ie),$(Ie,Ae),ke(Ot,Ae,null),$(p,Ee),$(p,Re),$(Re,Ne),$(Ne,We),$(We,Ge),$(Ge,qe),$(Ge,He),$(We,Be),$(We,Ke),$(Ke,Je),ke(Mt,Je,null),$(Re,Ve),$(Re,Ye),$(Ye,Qe),$(Qe,et),$(et,tt),$(et,ot),$(Qe,rt),$(Qe,st),$(st,it),ke(It,it,null),$(p,at),$(p,ct),$(ct,ut),$(ut,dt),$(dt,pt),$(ut,ft),$(ut,gt),$(gt,vt),$(ct,bt),$(ct,$t),At&&At.m($t,null),kt=!0,k&&r(wt),wt=[j(n,"click",_(e[15])),j(l,"click",_(e[16])),j(A,"change",e[6]),j(X,"change",e[6]),j(he,"change",e[6]),j(Se,"change",e[6]),j(qe,"change",e[6]),j(tt,"change",e[6]),j(dt,"click",e[9]),j(gt,"click",e[8]),j(p,"submit",_(e[14]))]},p(e,[n]){4&n&&E(o,"blink",e[2]),4&n&&E(a,"blink",e[2]);const r={};1&n&&(r.kmlColor=e[0].routeColor),Ct.$set(r),(!kt||2&n&&y!==(y=d(e[1])+" svelte-2tiaz1"))&&S(h,"class",y);const s={};1&n&&(s.selected=e[0].routePin),Pt.$set(s),(!kt||2&n&&L!==(L=d(e[1])+" svelte-2tiaz1"))&&S(w,"class",L),(!kt||1&n&&D!==(D=e[0].alternateDisplay))&&(A.checked=D);const i={};1&n&&(i.kmlColor=e[0].alternateColor),Ft.$set(i),(!kt||2&n&&q!==(q=d(e[1])+" svelte-2tiaz1"))&&S(G,"class",q);const l={};1&n&&(l.selected=e[0].alternatePin),Lt.$set(l),(!kt||2&n&&B!==(B=d(e[1])+" svelte-2tiaz1"))&&S(H,"class",B),(!kt||1&n&&V!==(V=e[0].natDisplay))&&(X.checked=V);const c={};1&n&&(c.kmlColor=e[0].natColor),jt.$set(c),(!kt||2&n&&re!==(re=d(e[1])+" svelte-2tiaz1"))&&S(te,"class",re);const u={};1&n&&(u.selected=e[0].natPin),_t.$set(u),(!kt||2&n&&ce!==(ce=d(e[1])+" svelte-2tiaz1"))&&S(ie,"class",ce),(!kt||1&n&&ye!==(ye=e[0].greatCircleDisplay))&&(he.checked=ye);const p={};1&n&&(p.kmlColor=e[0].greatCircleColor),St.$set(p),(!kt||2&n&&Fe!==(Fe=d(e[1])+" svelte-2tiaz1"))&&S(pe,"class",Fe),(!kt||1&n&&Oe!==(Oe=e[0].ogimetDisplay))&&(Se.checked=Oe);const m={};1&n&&(m.kmlColor=e[0].ogimetColor),Ot.$set(m),(!kt||2&n&&De!==(De=d(e[1])+" svelte-2tiaz1"))&&S(Le,"class",De),(!kt||1&n&&Ue!==(Ue=e[0].etopsDisplay))&&(qe.checked=Ue);const f={};1&n&&(f.kmlColor=e[0].etopsColor),Mt.$set(f),(!kt||2&n&&Xe!==(Xe=d(e[1])+" svelte-2tiaz1"))&&S(Ne,"class",Xe),(!kt||1&n&&nt!==(nt=e[0].airportDisplay))&&(tt.checked=nt);const g={};1&n&&(g.selected=e[0].airportPin),It.$set(g),(!kt||2&n&&lt!==(lt=d(e[1])+" svelte-2tiaz1"))&&S(Ye,"class",lt),(!kt||16&n&&mt!==(mt=!e[4]))&&(dt.disabled=mt),(!kt||16&n&&ht!==(ht=!e[4]))&&(gt.disabled=ht),(!kt||2&n&&yt!==(yt=d(e[1])+" svelte-2tiaz1"))&&S(ut,"class",yt),e[3]?At&&(At.d(1),At=null):At?At.p(e,n):(At=Et(e),At.c(),At.m($t,null)),(!kt||2&n&&xt!==(xt=d(e[1])+" svelte-2tiaz1"))&&S($t,"class",xt),32&n&&E(t,"sidebar",e[5])},i(e){kt||(ge(Ct.$$.fragment,e),ge(Pt.$$.fragment,e),ge(Ft.$$.fragment,e),ge(Lt.$$.fragment,e),ge(jt.$$.fragment,e),ge(_t.$$.fragment,e),ge(St.$$.fragment,e),ge(Ot.$$.fragment,e),ge(Mt.$$.fragment,e),ge(It.$$.fragment,e),kt=!0)},o(e){ve(Ct.$$.fragment,e),ve(Pt.$$.fragment,e),ve(Ft.$$.fragment,e),ve(Lt.$$.fragment,e),ve(jt.$$.fragment,e),ve(_t.$$.fragment,e),ve(St.$$.fragment,e),ve(Ot.$$.fragment,e),ve(Mt.$$.fragment,e),ve(It.$$.fragment,e),kt=!1},d(e){e&&k(t),we(Ct),we(Pt),we(Ft),we(Lt),we(jt),we(_t),we(St),we(Ot),we(Mt),we(It),At&&At.d(),r(wt)}}}function Nt(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Wt(e,t,n){let o;l(e,Dt,e=>n(5,o=e));const r=K(),s=Qe.optionsKML;let{kmlOptions:i}=t,{mode:a="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,c={...Je,...et.getItem(s)||{}},u=Nt(Je,i);function d(e){let t=!1;for(const[s,l]of Object.entries(e))i[s]!==l&&(n(0,i[s]=l,i),r("change",{name:(o=s,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:l}),t=!0);var o;t&&n(0,i={...e})}let m,f;return e.$set=e=>{"kmlOptions"in e&&n(0,i=e.kmlOptions),"mode"in e&&n(1,a=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,m=Nt(Je,i)),1025&e.$$.dirty&&n(4,f=!Nt(c,i))},[i,a,u,m,f,o,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,s=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));i[s]!==o&&(n(0,i[s]=o,i),r("change",{name:t,value:o}))},function(){d(Je)},function(){d(c)},function(){if(m)et.removeItem(s);else{const e={};for(const t of Object.keys(i).filter(e=>i[e]!==Je[e]))e[t]=i[t];et.setItem(s,e)}r("save"),n(10,c={...i})},c,r,s,d,function(t){Z(e,t)},()=>{p(Dt,o=!o),n(2,u=!1)},()=>{p(Dt,o=!o),n(2,u=!1)}]}class Gt extends Pe{constructor(e){super(),Ce(this,e,Wt,Rt,i,{kmlOptions:0,mode:1})}}const qt=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",""+e]],"#ea80d8",["==",7,["get",""+e]],"#ea80d8",["==",6,["get",""+e]],"#dddddd",["==",5,["get",""+e]],"#dddddd",["==",4,["get",""+e]],"#fbfe98",["==",3,["get",""+e]],"#fbfe98",["==",2,["get",""+e]],"#00b0f1",["==",1,["get",""+e]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Ut=(e,t=!0)=>t?["in",""+e,["get","type"]]:["!",["in",""+e,["get","type"]]],Ht=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",""+e]],Bt=e=>0===e?3:0,Kt=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function Zt(e,t,n){if(void 0!==e){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}}function Jt(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Xt(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const Vt=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function Yt(e,t,n,o,r,s,i){const l=n.flatMap(e=>{const t=o([e.longitude,e.latitude]);return null!=t?[Zt(t,e.name.replace(/00\.0/g,""))]:[]});e.addSource(t+"-marker-source",Jt(l)),e.addLayer(tn(t,r,i,s))}function Qt(e,t,n,o,r,s){const i=n.reduce((function(e,t){const n=o([t.longitude,t.latitude]);return void 0!==n&&e.push(n),e}),[]);e.addSource(t+"-line-source",{type:"geojson",data:Xt(i)}),e.addLayer(nn(t,r,s))}function en(e,t,n,o,r,s){e.addSource(t+"-line-source",Jt(n.map(e=>Xt(e.reduce((function(e,t){const n=o([t.longitude,t.latitude]);return void 0!==n&&e.push(n),e}),[]))))),e.addLayer(nn(t,r,s))}function tn(e,t,n,o){const[r,s]=Ge(n);return{id:e+"-marker-layer",type:"symbol",source:e+"-marker-source",layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?Vt[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function nn(e,t,n){const[o,r]=Ge(t);let s=2,i=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,i=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:e+"-line-layer",type:"line",source:e+"-line-source",layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":i}}}function on(e,t,n,o,r){const s=t.id.startsWith("jb_");let i={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${s?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR ¬© Olivier Ravet`};const l=new mapboxgl.Map({...t.mapboxOptions,...i});l.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||l.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||l.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||l.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-star-sdf.png",(function(e,t){e||l.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let a=e=>e,c=e=>e,u=e=>e;if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else{const[s,i,l,a]=t.extent,[c,u,d,p]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(d-c)/(l-s),n=c-e*s,o=(p-u)/(a-i),r=u-o*i}const[s,i,l,d]=t.viewport?t.viewport:t.extent;a=([t,s])=>{const[i,l]=window.proj4("CUSTOM",[t,s]);return window.proj4("EPSG:3857","WGS84",[e*i+n,o*l+r])},c=([t,a])=>{let[c,u]=window.proj4("CUSTOM",[t,a]);return c=je(c,s,l),u=je(u,i,d),window.proj4("EPSG:3857","WGS84",[e*c+n,o*u+r])},u=([t,a])=>{let[c,u]=window.proj4("CUSTOM",[t,a]);if(_e(c,s,l)&&_e(u,i,d))return window.proj4("EPSG:3857","WGS84",[e*c+n,o*u+r])}}let d=void 0;let p=[];if(!n.isFake){for(const e of n.tracks)p=p.concat(e.points);p=p.concat(n.route.points,n.wptCoordinatesAlternate()),d=((e,t=[1/0,1/0,-1/0,-1/0])=>{for(const[n,o]of e.map(e=>c([e.longitude,e.latitude])))t[0]>n&&(t[0]=n),t[1]>o&&(t[1]=o),t[2]<n&&(t[2]=n),t[3]<o&&(t[3]=o);return t[0]-=1,t[1]-=1,t[2]+=1,t[3]+=1,t})(p),l.fitBounds(d,{padding:{top:30,bottom:80,left:30,right:30}})}const m=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0}),f=m._onSuccess;return m._onSuccess=function(e){const[t,n]=a([e.coords.longitude,e.coords.latitude]);return f.apply(this,[{coords:{longitude:t,latitude:n,accuracy:e.coords.accuracy}}])},l.addControl(m),l.on("load",(function(){t.tiles&&(l.addSource("jb-raster",{type:"raster",tiles:t.tiles,tileSize:t.tileSize}),l.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),function(e,t,n,o,r,s,i){const l={...Je,...t},a=e.description;if(!e.isFake){const t=`${e.infos.departure}-${e.infos.destination}`,o=new editolido.Route(e.wptCoordinates(),{name:t,description:a}),r=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route D√©gagement"}),i=new editolido.Route([o.points[0],o.points[o.points.length-1]]).split(300,{name:"Ortho "+t});Qt(n,"greatcircle",i.points,s,l.greatCircleColor,l.greatCircleDisplay),Qt(n,"ogimet",e.ogimetData.route.points,s,l.ogimetColor,l.ogimetDisplay),Qt(n,"ralt",r.points,s,l.alternateColor,l.alternateDisplay),Qt(n,"rmain",o.points,s,l.routeColor,!0),Yt(n,"ralt",r.points,s,l.alternatePin,l.alternateDisplay,l.alternateColor),Yt(n,"rmain",o.points,s,l.routePin,!0,l.routeColor)}"jb_pacific"!==i.id&&((e,t)=>{fetch("data/fir-reg.2007h.geojson").then(e=>e.json()).then(n=>{for(let e=0;e<n.features.length;e++){const o=n.features[e].geometry.coordinates[0];n.features[e].geometry.coordinates=[o.map(e=>t(e))]}e.addSource("fir-reg-source",{type:"geojson",data:n}),e.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),e.addLayer({id:"fir-reg-line-layer",type:"line",source:"fir-reg-source",layout:{},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})})})(n,r);let c=[];e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(c=[e.infos.EEP,e.infos.EXP]);((e,t,n,o,r,s,i)=>{const[l]=Ge(s),a=o.map(e=>e.name),c=r.map(e=>e.name),u=a.concat(c);fetch("data/airports.2007h.geojson").then(e=>e.json()).then(o=>{const r=[];for(let e of o.features)e.geometry.coordinates=t(e.geometry.coordinates),void 0!==e.geometry.coordinates&&r.push(e);o.features=r,e.addSource("airports-source",{type:"geojson",data:o}),e.addLayer({id:"airport-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:"visible","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Ut(n,!1)}),e.addLayer({id:"airport-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["in",["get","name"],["literal",u]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",u]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:"visible","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",u]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Ht(n,u)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":Bt(i),"icon-color":qt(i,n,c,l),"text-color":Kt(c,l),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Ut(n)})})})(n,s,e.isFake?e.isFake:e.infos.aircraft,c,e.infos.raltPoints,l.etopsColor,l.airportPin),e.isFake||(function(e,t,n,o,r,s){const i={rnat:[],"rnat-incomplete":[]},l={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete",o=e.points.reduce((function(e,t){const o=n([t.longitude,t.latitude]);return void 0!==o&&e.push(o),e}),[]);i[t].push(Xt(o,n,e.name));const r=e.points[0];let s=Zt(n([r.longitude,r.latitude]),`${e.name}\n${r.name}`,e.description);if(void 0!==s&&l[t].push(s),e.isMine){const o=e.points[e.points.length-1];s=Zt(n([o.longitude,o.latitude]),`${e.name}\n${o.name}`,e.description),void 0!==s&&l[t].push(s)}}e.addSource("rnat-marker-source",Jt(l.rnat)),e.addSource("rnat-incomplete-marker-source",Jt(l["rnat-incomplete"])),e.addSource("rnat-line-source",Jt(i.rnat)),e.addSource("rnat-incomplete-line-source",Jt(i["rnat-incomplete"])),e.addLayer(nn("rnat",o,s)),e.addLayer(nn("rnat-incomplete",Je.natIncompleteColor,s)),e.addLayer(tn("rnat",r,o,s)),e.addLayer(tn("rnat-incomplete",r,o,s));const a=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},c=t=>{const n=t+"-marker-layer";e.on("click",n,a),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};c("rnat"),c("rnat-incomplete")}(n,e,s,l.natColor,l.natPin,l.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,s,i,l){en(e,t+"-ep-circle",[n[0].circle(420,48),n[1].circle(420,48)],o,i,r),en(e,t+"-etops-circle",n.slice(2).map(e=>e.circle(7*s)),o,l,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),r,!0,e.infos.ETOPS,l.routeColor,l.etopsColor))}(n,o,l,0,c,u,t);const s=document.querySelector(`#${e} .mapboxgl-ctrl-attrib-inner`);s&&(s.appendChild(document.createTextNode(" | ")),s.appendChild(r),s.appendChild(document.createTextNode(`${"2007h".substring(0,2)}.${"2007h".substring(2,4)}`))),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2")})),l}function rn(e,t,n){if("etops"===t)return function(e,t){let n="etops-etops-circle-line-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="etops-ep-circle-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("airport"===t)return function(e,t){let n="airport-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="airport-emer-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);const o=t+"-marker-layer",r=t+"-line-layer";e.getLayer(r)&&e.setLayoutProperty(r,"visibility",n?"visible":"none"),e.getLayer(o)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function sn(e,t,n){const[o,r]=Ge(n);if("etops"===t)return function(e,t){const[n,o]=Ge(t),r="etops-etops-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n);const s=t+"-marker-layer",i=t+"-line-layer";e.getLayer(i)&&(e.setPaintProperty(i,"line-color",o),e.setPaintProperty(i,"line-opacity",r)),e.getLayer(s)&&e.setPaintProperty(s,"text-color",o),"rmain"===t&&function(e,t){const[n,o]=Ge(t),r="etops-ep-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n)}function ln(e,t,n,o,r,s){if("airport"===t)return function(e,t,n,o,r){const[s]=Ge(r),i="airport-layer";e.getLayer(i)&&(e.setPaintProperty(i,"icon-color",qt(t,n,o,s)),e.setPaintProperty(i,"text-color",Kt(o,s)),e.setPaintProperty(i,"icon-halo-width",Bt(t)))}(e,n,o,r,s);const i=Vt[n],l=t+"-marker-layer",a=t+"-line-layer";if(e.getLayer(l)){const t=e.getPaintProperty(a,"line-color");e.setPaintProperty(l,"icon-color",0!==n?i:t),e.setPaintProperty(l,"text-color",t),e.setLayoutProperty(l,"icon-size",0!==n?1:.2),e.setLayoutProperty(l,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(l,"icon-anchor",0!==n?"bottom":"center")}}function an(e,t,n,o,r,s){const i=Le(t);if("aircraftType"===t){let t=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(t=[o.infos.EEP.name,o.infos.EXP.name]),function(e,t,n,o,r,s){const[i]=Ge(s),l="airport-layer";e.setFilter(l,Ut(n)),e.setPaintProperty(l,"icon-color",qt(t,n,o,i)),e.setLayoutProperty(l,"symbol-sort-key",Ht(n,r)),e.setFilter("airport-emer-layer",Ut(n,!1))}(e,r.airportPin,s,o.infos.ralts,t.concat(o.infos.ralts),r.etopsColor)}else t.endsWith("-display")?("rnat"===i&&rn(e,"rnat-incomplete",n),rn(e,i,n)):t.endsWith("-pin")?ln(e,i,n,s,o.infos.ralts,r.etopsColor):t.endsWith("-color")&&sn(e,i,n)}const cn={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1};function un(e,t,n){const o=e.slice();return o[22]=t[n],o[24]=n,o}function dn(e,t,n){const o=e.slice();return o[25]=t[n],o[24]=n,o}function pn(e){let t,n,o,r,s=(e[25].proj4&&e[11](e[25])?""+e[25].label.toUpperCase():e[25].label)+"";return{c(){t=C("option"),n=F(s),t.__value=o=e[24],t.value=t.__value,t.selected=r=e[24]===e[3]},m(e,o){x(e,t,o),$(t,n)},p(e,n){8&n&&r!==(r=e[24]===e[3])&&(t.selected=r)},d(e){e&&k(t)}}}function mn(e){let t,n,o,r,s=e[22]+"";return{c(){t=C("option"),n=F(s),t.__value=o=e[24],t.value=t.__value,t.selected=r=e[24]===e[4]},m(e,o){x(e,t,o),$(t,n)},p(e,n){16&n&&r!==(r=e[24]===e[4])&&(t.selected=r)},d(e){e&&k(t)}}}function fn(e){let t,n=("???"!==e[22]||"???"===e[4]&&"???"===e[22])&&mn(e);return{c(){n&&n.c(),t=L()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){"???"!==e[22]||"???"===e[4]&&"???"===e[22]?n?n.p(e,o):(n=mn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function gn(e){let t,n,o,i,l,a,c,u,d,p,f,g=e[7],v=[];for(let t=0;t<g.length;t+=1)v[t]=pn(dn(e,g,t));let h=e[6],y=[];for(let t=0;t<h.length;t+=1)y[t]=fn(un(e,h,t));function b(t){e[20].call(null,t)}let P={};void 0!==e[0]&&(P.kmlOptions=e[0]);const F=new Gt({props:P});return X.push(()=>$e(F,"kmlOptions",b)),F.$on("change",e[12]),F.$on("save",e[21]),{c(){t=C("div"),o=z(),i=C("div"),l=C("select");for(let e=0;e<v.length;e+=1)v[e].c();a=z(),c=C("select");for(let e=0;e<y.length;e+=1)y[e].c();u=z(),xe(F.$$.fragment),S(t,"id",e[2]),S(t,"class","svelte-19kk5zv"),S(l,"name",vn),S(l,"class","form-control form-control-sm svelte-19kk5zv"),void 0===e[3]&&ne(()=>e[17].call(l)),S(i,"class","mapmenu svelte-19kk5zv"),S(c,"name","aircraftType"),S(c,"class","svelte-19kk5zv"),void 0===e[4]&&ne(()=>e[19].call(c))},m(s,d,g){x(s,t,d),x(s,o,d),x(s,i,d),$(i,l);for(let e=0;e<v.length;e+=1)v[e].m(l,null);A(l,e[3]),x(s,a,d),x(s,c,d);for(let e=0;e<y.length;e+=1)y[e].m(c,null);e[18](c),A(c,e[4]),x(s,u,d),ke(F,s,d),p=!0,g&&r(f),f=[m(n=e[10].call(null,t,{route:e[1]})),j(l,"change",e[17]),j(l,"change",e[8]),j(c,"change",e[19]),j(c,"change",e[9])]},p(e,[o]){if((!p||4&o)&&S(t,"id",e[2]),n&&s(n.update)&&2&o&&n.update.call(null,{route:e[1]}),2184&o){let t;for(g=e[7],t=0;t<g.length;t+=1){const n=dn(e,g,t);v[t]?v[t].p(n,o):(v[t]=pn(n),v[t].c(),v[t].m(l,null))}for(;t<v.length;t+=1)v[t].d(1);v.length=g.length}if(8&o&&A(l,e[3]),80&o){let t;for(h=e[6],t=0;t<h.length;t+=1){const n=un(e,h,t);y[t]?y[t].p(n,o):(y[t]=fn(n),y[t].c(),y[t].m(c,null))}for(;t<y.length;t+=1)y[t].d(1);y.length=h.length}16&o&&A(c,e[4]);const r={};!d&&1&o&&(d=!0,r.kmlOptions=e[0],oe(()=>d=!1)),F.$set(r)},i(e){p||(ge(F.$$.fragment,e),p=!0)},o(e){ve(F.$$.fragment,e),p=!1},d(n){n&&k(t),n&&k(o),n&&k(i),w(v,n),n&&k(a),n&&k(c),w(y,n),e[18](null),n&&k(u),we(F,n),r(f)}}}const vn="map-style";function hn(e,t,n){const o=K();let r,{kmlOptions:s}=t,{ofp:i}=t,{route:l}=t,a=void 0,c=-1,u=-1;const d=["???","318","319","320","321","330","340","350","380","787","772","773","77F"],p=[{label:"Mercator",id:"mapbox_streets_v11",mapboxOptions:{style:"mapbox://styles/mapbox/streets-v11",renderWorldCopies:!1}},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:cn,renderWorldCopies:!1,maxZoom:5},tiles:["https://editolido.alwaysdata.net/i/northv3/{z}/{x}/{y}.jpg"],tileSize:512},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:cn,renderWorldCopies:!1,maxZoom:5},tiles:["https://editolido.alwaysdata.net/i/southv3/{z}/{x}/{y}.jpg"],tileSize:512},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:cn,renderWorldCopies:!1,maxZoom:5},tiles:["https://editolido.alwaysdata.net/i/pacificv1/{z}/{x}/{y}.jpg"],tileSize:512}];let{id:m="map"}=t;function f(){a&&a.remove()}var g;return g=()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",a=on(m,p[c],i,s,r)},B().$$.on_mount.push(g),e.$set=e=>{"kmlOptions"in e&&n(0,s=e.kmlOptions),"ofp"in e&&n(13,i=e.ofp),"route"in e&&n(1,l=e.route),"id"in e&&n(2,m=e.id)},[s,l,m,c,u,r,d,p,function(e){e.target.blur(),f(),a=on(m,p[c],i,s,r)},function(e){e.target.blur(),an(a,"aircraftType",d[e.target.value],i,s,d[e.target.value])},function(e,t){if(-1===c&&i&&!i.isFake){const e=i.route.points[0],t=i.route.points[i.route.points.length-1];t.latitude>30&&e.latitude>30?n(3,c=1):t.longitude<-80&&e.longitude<-80?n(3,c=3):n(3,c=2)}return-1===c&&n(3,c=0),-1===u&&i&&n(4,u=i.isFake?d.indexOf(i.isFake):d.indexOf(i.infos.aircraft)),-1===u&&n(4,u=0),{update(e){"/map"===e.route&&a&&a.resize()},destroy(){f()}}},function(e){if(!e.proj4||!i||i.isFake)return!0;const t=i.route.points[0],n=i.route.points[i.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id&&n.latitude>30&&t.latitude>30)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},e=>{an(a,e.detail.name,e.detail.value,i,s,d[u]),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-"))return;const n=Ve(),o=Le(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),o("save")},i,a,o,f,function(){c=D(this),n(3,c)},function(e){X[e?"unshift":"push"](()=>{n(5,r=e)})},function(){u=D(this),n(4,u)},function(e){s=e,n(0,s)},function(t){Z(e,t)}]}class yn extends Pe{constructor(e){super(),Ce(this,e,hn,gn,i,{kmlOptions:0,ofp:13,route:1,id:2})}}function bn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.textContent="CARTE",S(n,"class","nav-link svelte-12ru1us"),S(n,"href","#/map"),E(n,"disabled",!e[1]),S(t,"class","nav-item svelte-12ru1us"),E(t,"active","/map"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&E(n,"disabled",!e[1]),1&o&&E(t,"active","/map"===e[0])},d(e){e&&k(t)}}}function $n(e){let t,n;return{c(){t=C("li"),n=C("a"),n.textContent="GRAMET",S(n,"class","nav-link svelte-12ru1us"),S(n,"href","#/gramet"),E(n,"disabled",!e[1]),S(t,"class","nav-item svelte-12ru1us"),E(t,"active","/gramet"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&E(n,"disabled",!e[1]),1&o&&E(t,"active","/gramet"===e[0])},d(e){e&&k(t)}}}function xn(e){let t,n;return{c(){t=C("li"),n=C("a"),n.textContent="EXPORT",S(n,"class","nav-link svelte-12ru1us"),S(n,"href","#/export"),E(n,"disabled",!e[1]),S(t,"class","nav-item svelte-12ru1us"),E(t,"active","/export"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&E(n,"disabled",!e[1]),1&o&&E(t,"active","/export"===e[0])},d(e){e&&k(t)}}}function kn(e){let t,n,o,r,s,i,l,d,p,m,f=(e[1]||"/map"===e[0])&&bn(e),g=(e[1]&&!e[1].isFakeOfp||"/gramet"===e[0])&&$n(e),v=(e[1]&&!e[1].isFakeOfp||"/export"===e[0])&&xn(e);const h=e[3].default,y=a(h,e,e[2],null);return{c(){t=C("nav"),n=C("ul"),o=C("li"),o.innerHTML='<a class="nav-link" href="#/"><svg class="svelte-12ru1us"><use xlink:href="#home"></use></svg></a>',r=z(),f&&f.c(),s=z(),g&&g.c(),i=z(),v&&v.c(),l=z(),d=C("li"),d.innerHTML='<a class="nav-link" href="#/help">AIDE</a>',p=z(),y&&y.c(),S(o,"class","nav-item svelte-12ru1us"),E(o,"active","/"===e[0]),S(d,"class","nav-item svelte-12ru1us"),E(d,"active","/help"===e[0]),S(n,"class","navbar-nav mr-auto svelte-12ru1us"),S(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-12ru1us")},m(e,a){x(e,t,a),$(t,n),$(n,o),$(n,r),f&&f.m(n,null),$(n,s),g&&g.m(n,null),$(n,i),v&&v.m(n,null),$(n,l),$(n,d),$(t,p),y&&y.m(t,null),m=!0},p(e,[t]){1&t&&E(o,"active","/"===e[0]),e[1]||"/map"===e[0]?f?f.p(e,t):(f=bn(e),f.c(),f.m(n,s)):f&&(f.d(1),f=null),e[1]&&!e[1].isFakeOfp||"/gramet"===e[0]?g?g.p(e,t):(g=$n(e),g.c(),g.m(n,i)):g&&(g.d(1),g=null),e[1]&&!e[1].isFakeOfp||"/export"===e[0]?v?v.p(e,t):(v=xn(e),v.c(),v.m(n,l)):v&&(v.d(1),v=null),1&t&&E(d,"active","/help"===e[0]),y&&y.p&&4&t&&y.p(c(h,e,e[2],null),u(h,e[2],t,null))},i(e){m||(ge(y,e),m=!0)},o(e){ve(y,e),m=!1},d(e){e&&k(t),f&&f.d(),g&&g.d(),v&&v.d(),y&&y.d(e)}}}function wn(e,t,n){let{route:o}=t,{promise:r}=t,{$$slots:s={},$$scope:i}=t;return e.$set=e=>{"route"in e&&n(0,o=e.route),"promise"in e&&n(1,r=e.promise),"$$scope"in e&&n(2,i=e.$$scope)},[o,r,i,s]}class Cn extends Pe{constructor(e){super(),Ce(this,e,wn,kn,i,{route:0,promise:1})}}function Pn(e,t,n){const o=e.slice();return o[11]=t[n],o}function Fn(e){let t,n,o,s,i=Sn,l=[];for(let t=0;t<i.length;t+=1)l[t]=zn(Pn(e,i,t));return{c(){t=C("div"),n=C("select"),o=C("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,S(n,"class","form-control-sm svelte-13dehjt"),n.disabled=e[1],S(t,"class","footer svelte-13dehjt")},m(i,a,c){x(i,t,a),$(t,n),$(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);c&&r(s),s=[j(n,"click",e[4],{once:!0}),j(n,"change",e[6])]},p(e,t){if(0&t){let o;for(i=Sn,o=0;o<i.length;o+=1){const r=Pn(e,i,o);l[o]?l[o].p(r,t):(l[o]=zn(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=i.length}2&t&&(n.disabled=e[1])},d(e){e&&k(t),w(l,e),r(s)}}}function zn(t){let n,o,r,s=t[11]+"";return{c(){n=C("option"),o=F(s),n.__value=r=t[11],n.value=n.__value},m(e,t){x(e,n,t),$(n,o)},p:e,d(e){e&&k(n)}}}function Ln(t){let n,o,s,i,l,a,c,u,d=!t[0]&&Fn(t);return{c(){n=C("div"),o=C("input"),s=z(),i=C("label"),l=F(t[2]),a=z(),d&&d.c(),c=L(),S(o,"id",Tn),S(o,"name",Tn),S(o,"type","file"),S(o,"accept","application/pdf"),o.disabled=t[1],S(o,"class","custom-file-input"),S(i,"class","custom-file-label text-truncate svelte-13dehjt"),S(i,"for",Tn),E(i,"ready",t[3]),S(n,"class","custom-file svelte-13dehjt"),E(n,"blink",!t[0])},m(e,p,m){x(e,n,p),$(n,o),$(n,s),$(n,i),$(i,l),x(e,a,p),d&&d.m(e,p),x(e,c,p),m&&r(u),u=[j(o,"change",t[5]),j(o,"click",t[4],{once:!0})]},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&T(l,e[2]),8&t&&E(i,"ready",e[3]),1&t&&E(n,"blink",!e[0]),e[0]?d&&(d.d(1),d=null):d?d.p(e,t):(d=Fn(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&k(n),e&&k(a),d&&d.d(e),e&&k(c),r(u)}}}const jn="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",_n=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.4.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.4.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"},{type:"link",url:jn,options:{prefetch:!0}}];let Sn=["318","319","320","321","330","340","350","380","787","772","773","77F"];const On=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map(e=>e.str).join("")};let Tn="file";function Mn(e,t,n){let{promise:o}=t,{kmlOptions:r}=t,s=!1,i=new Fe,l="Choisir un OFP",a=!1;const c=K();function u(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach(({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,i=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(i.crossOrigin="anonymous");let l=!0;s?(i.src=t,i.async=n.async,i.defer=n.defer):(i.href=t,"prefetch"in n?(i.rel="prefetch",o-=1,l=!1):"preload"in n?(i.rel="preload",o-=1,l=!1):(i.rel="stylesheet",o-=1,l=!1)),l&&(i.onload=r),document.body.appendChild(i)})}(_n,()=>!!window["pdfjs-dist/build/pdf"],()=>{window["pdfjs-dist/build/pdf"].GlobalWorkerOptions.workerSrc=jn,i.resolve(!0),n(3,a=!0)})}const d=e=>{const t=new FileReader;return new Promise((n,o)=>{t.onload=e=>{(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await On(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result}).then(e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e);try{Ve();Ye(t,r),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))},e=>o(e))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)})};return e.$set=e=>{"promise"in e&&n(0,o=e.promise),"kmlOptions"in e&&n(7,r=e.kmlOptions)},[o,s,l,a,u,async function(e){n(1,s=!0),u(),await i.promise.then(()=>{const t=e.target.files[0];t&&(n(2,l=e.target.value.split(/([\\/])/g).pop()),c("change",l),n(0,o=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))}),n(1,s=!1)},async function(e){n(1,s=!0),u(),await i.promise.then(()=>{n(0,o=new Promise((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{Ve();Ye(o,r),t(o)}catch(e){n(e)}})),n(0,o.isFakeOfp=!0,o),window.location.hash="#/map"}),n(1,s=!1)},r]}class In extends Pe{constructor(e){super(),Ce(this,e,Mn,Ln,i,{promise:0,kmlOptions:7})}}function An(n){let o,r,i;const l=n[3].default,d=a(l,n,n[2],null);return{c(){o=C("page"),d&&d.c(),S(o,"class","svelte-7uc4nn"),E(o,"fadein",!1===n[0]),E(o,"d-none",!0===n[0])},m(e,t){x(e,o,t),d&&d.m(o,null),i=!0},p(e,[t]){d&&d.p&&4&t&&d.p(c(l,e,e[2],null),u(l,e[2],t,null)),1&t&&E(o,"fadein",!1===e[0]),1&t&&E(o,"d-none",!0===e[0])},i(l){i||(ge(d,l),r||ne(()=>{r=function(n,o,r){let i,l,a=o(n,r),c=!1,u=0;function d(){i&&U(n,i)}function p(){const{delay:o=0,duration:r=300,easing:s=t,tick:p=e,css:m}=a||he;m&&(i=q(n,0,1,r,o,s,m,u++)),p(0,1);const f=g()+o,v=f+r;l&&l.abort(),c=!0,ne(()=>ue(n,!0,"start")),l=b(e=>{if(c){if(e>=v)return p(1,0),ue(n,!0,"end"),d(),c=!1;if(e>=f){const t=s((e-f)/r);p(t,1-t)}}return c})}let m=!1;return{start(){m||(U(n),s(a)?(a=a(),ce().then(p)):p())},invalidate(){m=!1},end(){c&&(d(),c=!1)}}}(o,n[1],{}),r.start()}),i=!0)},o(e){ve(d,e),i=!1},d(e){e&&k(o),d&&d.d(e)}}}function Dn(e,t,n){let{hidden:o}=t;let{$$slots:r={},$$scope:s}=t;return e.$set=e=>{"hidden"in e&&n(0,o=e.hidden),"$$scope"in e&&n(2,s=e.$$scope)},[o,(e,t,n)=>{if(void 0===o)return Se(e,t)},s,r]}class En extends Pe{constructor(e){super(),Ce(this,e,Dn,An,i,{hidden:0})}}function Rn(t){let n,o,r,s,i,l,a,c,u,d,p,m,f,g,v,h,y,b,$,w,P,F,L,j,_,O,T,M,I;return{c(){n=C("h2"),n.textContent="Pr√©ambule",o=z(),r=C("p"),r.textContent="Cette app a √©t√© con√ßue pour le PilotPad. Elle n√©cessite des navigateurs r√©cents pour fonctionner. Safari 13 iOS/Mac est compatible, Chrome 83 fonctionne aussi. Firefox derni√®re version devrait fonctionner (non test√©).\nL'OFP ne transite sur aucun serveur, seule une route calcul√©e (bas√©e sur au plus 21 stations m√©t√©o) est transmise √† l'h√©bergeur AlwaysData.com puis √† Ogimet.com pour r√©cup√©rer le Gramet. GitHub (d√©tenu par Microsoft), h√©bergeur du site, utilise des cookies. L'app en elle m√™me ne collecte aucune donn√©es.",s=z(),i=C("h2"),i.textContent="Utilisation",l=z(),a=C("ol"),a.innerHTML="<li><p>Dans Pilot Mission, onglet ¬´Dossier de vol¬ª, affichez le PDF nomm√© &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carr√© avec une fl√®che vers le haut. Choisissez ¬´Enregister dans Fichiers¬ª. Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite s√©lectionner. Le &quot;drag and drop&quot; est √©galement possible dans le champ d&#39;input de l&#39;OFP.</p></li> \n<li><p>Apr√®s avoir ouvert ce site dans Safari sur iPad, il est possible d&#39;afficher le menu de personnalisation en cliquant sur  l&#39;ic√¥ne en haut √† droite (le &quot;hamburger&quot;). Dans les r√©solutions plus faibles, sur iPhone ou en mode &quot;split view&quot;, ces r√©glages sont affich√©s sous la carte. Le type avion pour l&#39;ad√©quation des terrains est d√©tect√© dans l&#39;OFP.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, t√©l√©charger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par d√©faut est une LAMBERT, il est possible sur la carte, en haut √† gauche, de basculer sur une projection Web Mercator.</p> \n<ul><li>LAMBERT NORTH (parall√®les s√©cants N30 et N65) est recommand√©e au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parall√®les s√©cants N30 et S15 ) sont recommand√©es sous N30</li></ul></li>",c=z(),u=C("ol"),u.innerHTML="<li>Navigation dans la carte: on peut avec un doigt d√©placer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</li>",d=z(),p=C("h2"),p.textContent="Mode off-line",m=z(),f=C("p"),f.textContent="Une fois un premier OFP charg√©, il est possible m√™me en mode d√©connect√© de charger un autre OFP pour l'exporter. Il est aussi probable que le cache de l'App (50Mo) vous permettra de naviguer sur les cartes d√©j√† visualis√©es.",g=z(),v=C("h2"),v.textContent="Sauvegarde des param√®tres",h=z(),y=C("p"),y.textContent="L'app permet de sauvegarder vos param√®tres dans le navigateur. Toutefois Apple ne conserve plus les donn√©es au-del√†\nde 7 jours, vos r√©glages risquent donc de dispara√Ætre. La solution: apr√®s avoir param√©tr√© l'app, m√©morisez vos choix dans la \"sidebar\" puis, sauvegardez l'url de la page dans vos favoris.\nL'URL contient l'ensemble des d√©tails n√©cessaires √† la restauration. Si vous utilisez cette m√©thode, pensez √† bien \nsauvegarder l'URL apr√®s vos modifications. Dans un premier temps, contentez-vous de sauvegarder avec le bouton ¬´M√©moriser¬ª,\ntestez sur diff√©rents OFP, puis une fois satisfait, sauvegardez dans vos favoris.",b=z(),$=C("h2"),$.textContent="Installation sur l'√©cran d'accueil",w=z(),P=C("p"),P.textContent="L'app peut √™tre install√©e sur l'√©cran d'accueil ce qui permet d'avoir la carte sur un √©cran plus grand. Il y a toutefois quelques inconv√©nients: dur√©e de sauvegarde des param√©tres ?, des bugs d'affichage apparaissent lorsque l'on retourne sur l'app (l'app est zoom√©e, il faut d√©zoomer en utilisant un pinch de deux doigts sur la barre de menu). Enfin l'app sur l'√©cran d'accueil ne permet pas de recharger la page si on rencontre un probl√®me, il faudra pour cela aller dans le menu d'aide (cet √©cran) ou un bouton sp√©cifique sera affich√© en haut.",F=z(),L=C("h2"),L.textContent="Mise √† jour",j=z(),_=C("p"),_.textContent="L'app d√©tecte les mises √† jour automatiquement, normalement vous n'avez rien √† faire. Eventuellement un prompt peut \napparaitre vous demandant d'autoriser cette mise √† jour. La version AIRAC et le type avion d√©tect√© dans l'OFP sont affich√©s en bas √† droite de la carte dans le champ d'attribution.",O=z(),T=C("h2"),T.textContent="Cr√©dits",M=z(),I=C("ul"),I.innerHTML="<li>Les donn√©es terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est d√©velopp√© en javascript √† l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir r√©cup√©rer l&#39;image du GRAMET) est en python/Django</li> \n<li>L&#39;h√©bergement serveur est fourni par alwaysdata.com (pack gratuit).</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub</li>",S(u,"start","5")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t),x(e,s,t),x(e,i,t),x(e,l,t),x(e,a,t),x(e,c,t),x(e,u,t),x(e,d,t),x(e,p,t),x(e,m,t),x(e,f,t),x(e,g,t),x(e,v,t),x(e,h,t),x(e,y,t),x(e,b,t),x(e,$,t),x(e,w,t),x(e,P,t),x(e,F,t),x(e,L,t),x(e,j,t),x(e,_,t),x(e,O,t),x(e,T,t),x(e,M,t),x(e,I,t)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(o),e&&k(r),e&&k(s),e&&k(i),e&&k(l),e&&k(a),e&&k(c),e&&k(u),e&&k(d),e&&k(p),e&&k(m),e&&k(f),e&&k(g),e&&k(v),e&&k(h),e&&k(y),e&&k(b),e&&k($),e&&k(w),e&&k(P),e&&k(F),e&&k(L),e&&k(j),e&&k(_),e&&k(O),e&&k(T),e&&k(M),e&&k(I)}}}class Nn extends Pe{constructor(e){super(),Ce(this,e,null,Rn,i,{})}}function Wn(e){let t,n,o,r,s,i,l=e[1].msg+"",a=0!==e[1].code&&Un(e);return{c(){t=C("p"),n=F("Service Worker status: "),o=C("span"),r=F(l),i=z(),a&&a.c(),S(o,"data-status",s=e[1].code),S(o,"class","svelte-jp9cw7"),S(t,"class","svelte-jp9cw7")},m(e,s){x(e,t,s),$(t,n),$(t,o),$(o,r),$(t,i),a&&a.m(t,null)},p(e,n){2&n&&l!==(l=e[1].msg+"")&&T(r,l),2&n&&s!==(s=e[1].code)&&S(o,"data-status",s),0!==e[1].code?a?a.p(e,n):(a=Un(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&k(t),a&&a.d()}}}function Gn(e){let t,n,o,r,s,i,l,a=e[1].msg+"";return{c(){t=C("p"),n=F("Service Worker status: "),o=C("span"),r=F(a),i=C("a"),i.textContent="Installer",S(o,"data-status",s=e[1].code),S(o,"class","svelte-jp9cw7"),S(i,"href","."),S(t,"class","svelte-jp9cw7")},m(s,a,c){x(s,t,a),$(t,n),$(t,o),$(o,r),$(t,i),c&&l(),l=j(i,"click",_(e[3]))},p(e,t){2&t&&a!==(a=e[1].msg+"")&&T(r,a),2&t&&s!==(s=e[1].code)&&S(o,"data-status",s)},d(e){e&&k(t),l()}}}function qn(t){let n,o,r,s;return{c(){n=C("p"),o=F("La page n'est pas controll√©e par le service worker. "),r=C("a"),r.textContent="Recharger la page",S(r,"href","./index.html"),S(n,"class","svelte-jp9cw7")},m(e,i,l){x(e,n,i),$(n,o),$(n,r),l&&s(),s=j(r,"click",t[4])},p:e,d(e){e&&k(n),s()}}}function Un(e){let t;function n(e,t){return e[0]===Zn?Bn:Hn}let o=n(e),r=o(e);return{c(){r.c(),t=L()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}function Hn(e){let t;return{c(){t=F(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&T(t,e[0])},d(e){e&&k(t)}}}function Bn(e){let t,n,o;return{c(){t=C("a"),n=F(e[0]),S(t,"href",".")},m(r,s,i){x(r,t,s),$(t,n),i&&o(),o=j(t,"click",_(e[6]))},p(e,t){1&t&&T(n,e[0])},d(e){e&&k(t),o()}}}function Kn(t){let n,o,s,i,l,a,c,u=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[2]?2===e[1].code?Gn:Wn:qn}let o=n(e),r=o(e);return{c(){r.c(),t=L()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&k(t)}}}(t),d=!0===navigator.standalone&&function(t){let n,o,s,i,l,a,c,u,d,p,m,f;return{c(){n=C("p"),n.innerHTML="<b>En cas de probl√®me:</b>",o=z(),s=C("p"),i=C("a"),i.textContent="Recharger l'App",l=F(" c'est l'√©quivalent d'un rechargement de page."),a=z(),c=C("p"),u=C("a"),u.textContent="R√©initialiser l'App",d=F(" va en plus r√©initialiser le service Worker (il faut √™tre connect√©)."),p=z(),m=C("p"),m.textContent="Dans les 2 cas vos r√©glages sont conserv√©s mais l'OFP est remis √† z√©ro.",S(n,"class","svelte-jp9cw7"),S(i,"class","btn btn-primary btn-sm svelte-jp9cw7"),S(i,"href","./index.html"),S(s,"class","svelte-jp9cw7"),S(u,"class","btn btn-danger btn-sm"),S(u,"href","./index.html"),S(c,"class","svelte-jp9cw7"),S(m,"class","svelte-jp9cw7")},m(e,g,v){x(e,n,g),x(e,o,g),x(e,s,g),$(s,i),$(s,l),x(e,a,g),x(e,c,g),$(c,u),$(c,d),x(e,p,g),x(e,m,g),v&&r(f),f=[j(i,"click",t[4]),j(u,"click",t[5])]},p:e,d(e){e&&k(n),e&&k(o),e&&k(s),e&&k(a),e&&k(c),e&&k(p),e&&k(m),r(f)}}}(t);const p=new Nn({});return{c(){n=C("div"),o=C("p"),o.textContent="Application version: 1.2.4",s=z(),u&&u.c(),i=z(),d&&d.c(),l=z(),a=C("div"),xe(p.$$.fragment),S(o,"class","svelte-jp9cw7"),S(n,"class","info svelte-jp9cw7"),S(a,"class","markdown svelte-jp9cw7")},m(e,t){x(e,n,t),$(n,o),$(n,s),u&&u.m(n,null),$(n,i),d&&d.m(n,null),x(e,l,t),x(e,a,t),ke(p,a,null),c=!0},p(e,[t]){navigator.serviceWorker&&u.p(e,t),!0===navigator.standalone&&d.p(e,t)},i(e){c||(ge(p.$$.fragment,e),c=!0)},o(e){ve(p.$$.fragment,e),c=!1},d(e){e&&k(n),u&&u.d(),d&&d.d(),e&&k(l),e&&k(a),we(p)}}}const Zn="V√©rifier Mise √† jour";function Jn(e,t,n){let o;l(e,At,e=>n(10,o=e));let r=window.serviceWorker,s=!0;!r&&navigator.serviceWorker&&navigator.serviceWorker.ready.then(e=>(n(7,r=e),e)).catch(e=>n(8,s=!1));let i=navigator.serviceWorker&&navigator.serviceWorker.controller,a=Zn;const c=e=>e?e.installing?{code:1,msg:"üîπ installing"}:e.waiting?{code:2,msg:"üî∏ waiting"}:e.active?{code:3,msg:"üü¢"}:void 0:{code:0,msg:"üî∫ unknown"},u=()=>{window.location.reload()};let d,m,f;return e.$$.update=()=>{128&e.$$.dirty&&n(1,m=c(r)),256&e.$$.dirty&&n(2,f=i&&s)},d=window.editolido?" / lidojs: v"+window.editolido.version:"",[a,m,f,()=>{r.waiting&&(p(At,o=!0),r.waiting.postMessage("SKIP_WAITING"))},u,e=>{if(!window.confirm("Vous devez √™tre connect√© au r√©seau, ceci ne devrait √™tre utile qu'en cas de bug, R√©initialiser ?"))return e.preventDefault(),!1;r&&r.unregister(),u()},()=>{n(0,a="V√©rification... "),p(At,o=!1),r.update().then(e=>{3!==c(e).code?(n(0,a=""),n(7,r)):n(0,a="√Ä jour")}).catch(e=>n(0,a=e))}]}class Xn extends Pe{constructor(e){super(),Ce(this,e,Jn,Kn,i,{})}}function Vn(t){return{c:e,m:e,p:e,d:e}}function Yn(e){let t,n=e[5]&&!e[1]&&Qn(e);return{c(){n&&n.c(),t=L()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=Qn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&k(t)}}}function Qn(e){let t,n,o,s,i,l,a,c,u,d;function p(e,t){return e[0]?eo:to}let m=p(e),f=m(e);function g(...t){return e[4](e[5],...t)}return{c(){t=C("div"),n=C("div"),o=C("strong"),o.innerHTML='<span class="svelte-5snzlz">üë®üèª‚Äç‚úàÔ∏è</span>Mise √† jour disponible',s=z(),i=C("button"),i.innerHTML='<span aria-hidden="true">√ó</span>',l=z(),a=C("div"),f.c(),c=z(),u=C("button"),u.textContent="Installer",S(o,"class","mr-auto svelte-5snzlz"),S(i,"type","button"),S(i,"class","ml-2 mb-1 close"),S(i,"aria-label","Close"),S(n,"class","toast-header"),S(u,"type","button"),S(u,"class","btn"),E(u,"btn-primary",!e[0]),E(u,"btn-danger",e[0]),S(a,"class","toast-body text-center"),S(t,"class","toast svelte-5snzlz"),I(t,"position","absolute"),I(t,"top","0"),I(t,"right","0")},m(p,m,v){x(p,t,m),$(t,n),$(n,o),$(n,s),$(n,i),$(t,l),$(t,a),f.m(a,null),$(a,c),$(a,u),v&&r(d),d=[j(i,"click",e[3]),j(u,"click",g)]},p(t,n){m!==(m=p(e=t))&&(f.d(1),f=m(e),f&&(f.c(),f.m(a,c))),1&n&&E(u,"btn-primary",!e[0]),1&n&&E(u,"btn-danger",e[0])},d(e){e&&k(t),f.d(),r(d)}}}function eo(e){let t;return{c(){t=C("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function to(e){let t;return{c(){t=C("p"),t.textContent="Cel√† va recharger l'App"},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function no(t){return{c:e,m:e,p:e,d:e}}function oo(t){let n,o,r={ctx:t,current:null,token:null,pending:no,then:Yn,catch:Vn,value:5};return ye(o=window.isSWUpdateAvailable.promise,r),{c(){n=L(),r.block.c()},m(e,t){x(e,n,t),r.block.m(e,r.anchor=t),r.mount=()=>n.parentNode,r.anchor=n},p(e,[n]){{const o=(t=e).slice();o[5]=r.resolved,r.block.p(o,n)}},i:e,o:e,d(e){e&&k(n),r.block.d(e),r.token=null,r=null}}}function ro(e,t,n){let o;l(e,At,e=>n(1,o=e));let{loaded:r=!1}=t;const s=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,s,()=>p(At,o=!0),e=>s(e)]}class so extends Pe{constructor(e){super(),Ce(this,e,ro,oo,i,{loaded:0})}}const{window:io}=be;function lo(e){let t,n,o,r;function s(t){e[10].call(null,t)}let i={kmlOptions:e[2]};void 0!==e[1]&&(i.promise=e[1]);const l=new In({props:i});return X.push(()=>$e(l,"promise",s)),l.$on("change",e[5]),{c(){t=C("form"),xe(l.$$.fragment),S(t,"class","form-inline svelte-bw6wye"),E(t,"invisible","/help"===e[0])},m(n,s,i){x(n,t,s),ke(l,t,null),o=!0,i&&r(),r=j(t,"submit",_(e[9]))},p(e,o){const r={};4&o&&(r.kmlOptions=e[2]),!n&&2&o&&(n=!0,r.promise=e[1],oe(()=>n=!1)),l.$set(r),1&o&&E(t,"invisible","/help"===e[0])},i(e){o||(ge(l.$$.fragment,e),o=!0)},o(e){ve(l.$$.fragment,e),o=!1},d(e){e&&k(t),we(l),r()}}}function ao(e){let t,n,o,r={ctx:e,current:null,token:null,pending:mo,then:uo,catch:co,value:12,error:13,blocks:[,,,]};return ye(n=e[1],r),{c(){t=L(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[12]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function co(t){let n,o,r,s=t[13].message+"";return{c(){n=C("p"),o=F("üò±: "),r=F(s),E(n,"d-none","/map"!==t[0])},m(e,t){x(e,n,t),$(n,o),$(n,r)},p(e,t){2&t&&s!==(s=e[13].message+"")&&T(r,s),1&t&&E(n,"d-none","/map"!==e[0])},i:e,o:e,d(e){e&&k(n)}}}function uo(e){let t;const n=new En({props:{hidden:"/map"!==e[0],$$slots:{default:[po]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};1&t&&(o.hidden="/map"!==e[0]),16391&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function po(e){let t,n;function o(t){e[11].call(null,t)}let r={id:"map",ofp:e[12],route:e[0]};void 0!==e[2]&&(r.kmlOptions=e[2]);const s=new yn({props:r});return X.push(()=>$e(s,"kmlOptions",o)),s.$on("save",e[4]),{c(){xe(s.$$.fragment)},m(e,t){ke(s,e,t),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[12]),1&n&&(o.route=e[0]),!t&&4&n&&(t=!0,o.kmlOptions=e[2],oe(()=>t=!1)),s.$set(o)},i(e){n||(ge(s.$$.fragment,e),n=!0)},o(e){ve(s.$$.fragment,e),n=!1},d(e){we(s,e)}}}function mo(e){let t;const n=new En({props:{hidden:"/map"!==e[0],$$slots:{default:[fo]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};1&t&&(o.hidden="/map"!==e[0]),16384&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function fo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",I(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function go(e){let t;const n=new En({props:{$$slots:{default:[yo]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};16384&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function vo(e){let t;const n=new En({props:{$$slots:{default:[bo]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};16384&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function ho(e){let t,n,o,r={ctx:e,current:null,token:null,pending:Fo,then:xo,catch:$o,value:12,error:13,blocks:[,,,]};return ye(n=e[1],r),{c(){t=L(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[12]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){ve(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function yo(e){let t;const n=new Xn({});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function bo(e){let t;const n=new xt({});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function $o(t){let n,o,r,s=t[13].message+"";return{c(){n=C("p"),o=F("üò±: "),r=F(s)},m(e,t){x(e,n,t),$(n,o),$(n,r)},p(e,t){2&t&&s!==(s=e[13].message+"")&&T(r,s)},i:e,o:e,d(e){e&&k(n)}}}function xo(e){let t,n,o,r;const s=[wo,ko],i=[];function l(e,t){return"/gramet"===e[0]?0:"/export"===e[0]?1:-1}return~(t=l(e))&&(n=i[t]=s[t](e)),{c(){n&&n.c(),o=L()},m(e,n){~t&&i[t].m(e,n),x(e,o,n),r=!0},p(e,r){let a=t;t=l(e),t===a?~t&&i[t].p(e,r):(n&&(me(),ve(i[a],1,1,()=>{i[a]=null}),fe()),~t?(n=i[t],n||(n=i[t]=s[t](e),n.c()),ge(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(ge(n),r=!0)},o(e){ve(n),r=!1},d(e){~t&&i[t].d(e),e&&k(o)}}}function ko(e){let t;const n=new En({props:{$$slots:{default:[Co]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};16386&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function wo(e){let t;const n=new En({props:{$$slots:{default:[Po]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};16386&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function Co(e){let t,n;const o=new mt({props:{ofp:e[12]}});o.$on("save",e[4]);const r=new Re({props:{ofp:e[12]}});return{c(){xe(o.$$.fragment),t=z(),xe(r.$$.fragment)},m(e,s){ke(o,e,s),x(e,t,s),ke(r,e,s),n=!0},p(e,t){const n={};2&t&&(n.ofp=e[12]),o.$set(n);const s={};2&t&&(s.ofp=e[12]),r.$set(s)},i(e){n||(ge(o.$$.fragment,e),ge(r.$$.fragment,e),n=!0)},o(e){ve(o.$$.fragment,e),ve(r.$$.fragment,e),n=!1},d(e){we(o,e),e&&k(t),we(r,e)}}}function Po(e){let t;const n=new bt({props:{ofp:e[12]}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};2&t&&(o.ofp=e[12]),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function Fo(e){let t;const n=new En({props:{$$slots:{default:[zo]},$$scope:{ctx:e}}});return{c(){xe(n.$$.fragment)},m(e,o){ke(n,e,o),t=!0},p(e,t){const o={};16384&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){t||(ge(n.$$.fragment,e),t=!0)},o(e){ve(n.$$.fragment,e),t=!1},d(e){we(n,e)}}}function zo(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",I(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&k(t)}}}function Lo(e){let t,n,o,r,s,i,l,a,c,u;const d=new Cn({props:{promise:e[1],route:e[0],$$slots:{default:[lo]},$$scope:{ctx:e}}}),p=new so({props:{loaded:!!e[1]}});let m=e[1]&&ao(e);const f=[ho,vo,go],g=[];function v(e,t){return"/gramet"===e[0]||"/export"===e[0]?0:"/"===e[0]?1:"/help"===e[0]?2:-1}return~(i=v(e))&&(l=g[i]=f[i](e)),{c(){t=C("main"),n=C("div"),xe(d.$$.fragment),o=z(),xe(p.$$.fragment),r=z(),m&&m.c(),s=z(),l&&l.c(),S(n,"class","content svelte-bw6wye"),S(t,"class",a="container "+(e[0].substr(1)||"home")+" svelte-bw6wye")},m(l,a,f){x(l,t,a),$(t,n),ke(d,n,null),$(n,o),ke(p,n,null),$(n,r),m&&m.m(n,null),$(n,s),~i&&g[i].m(n,null),c=!0,f&&u(),u=j(io,"hashchange",e[3])},p(e,[o]){const r={};2&o&&(r.promise=e[1]),1&o&&(r.route=e[0]),16391&o&&(r.$$scope={dirty:o,ctx:e}),d.$set(r);const u={};2&o&&(u.loaded=!!e[1]),p.$set(u),e[1]?m?(m.p(e,o),2&o&&ge(m,1)):(m=ao(e),m.c(),ge(m,1),m.m(n,s)):m&&(me(),ve(m,1,1,()=>{m=null}),fe());let h=i;i=v(e),i===h?~i&&g[i].p(e,o):(l&&(me(),ve(g[h],1,1,()=>{g[h]=null}),fe()),~i?(l=g[i],l||(l=g[i]=f[i](e),l.c()),ge(l,1),l.m(n,null)):l=null),(!c||1&o&&a!==(a="container "+(e[0].substr(1)||"home")+" svelte-bw6wye"))&&S(t,"class",a)},i(e){c||(ge(d.$$.fragment,e),ge(p.$$.fragment,e),ge(m),ge(l),c=!0)},o(e){ve(d.$$.fragment,e),ve(p.$$.fragment,e),ve(m),ve(l),c=!1},d(e){e&&k(t),we(d),we(p),m&&m.d(),~i&&g[i].d(),u()}}}function jo(e,t,n){let o,r;l(e,Dt,e=>n(7,o=e)),l(e,At,e=>n(8,r=e));let s="/",i=window.location.href,a=void 0;(e=>{const t={},n={};if(e.length>1){(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}))}for(let[e,o]of Object.entries(t))if(e in Je){let t=void 0;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(We)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||et.setItem(Qe.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&et.setItem(Qe.shortcut,o));et.setItem(Qe.optionsKML,n)})(window.location.search);let c=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Je&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(We)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...Je,...t}})(et.getItem(Qe.optionsKML)||{});const u=e=>{const t=document.querySelector("meta[name=viewport]"),r=t?t.getAttribute("content"):"";n(0,s=window.location.hash.substr(1)||"/"),a||"/map"!==s&&"/gramet"!==s&&"/export"!==s||n(0,s="/"),"/map"===s?(o&&p(Dt,o=!1),r&&t.setAttribute("content",r+",maximum-scale=1")):r&&t.setAttribute("content",r.replace(",maximum-scale=1",""))};u();const d=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(Qe)){let r=et.getItem(o);if(n===Qe.optionsKML&&e){const t={};for(const n of Object.keys(e).filter(t=>e[t]!==Je[t]))t[n]=e[n];r=t}if(null!==r)if(n===Qe.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(c);let n=Object.entries(t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");i=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+s,history.replaceState(t,"Mon OFP2MAP",i)};d();return[s,a,c,u,d,()=>{o&&p(Dt,o=!1),r&&p(At,r=!1),window.serviceWorker&&window.serviceWorker.update&&window.serviceWorker.update().catch(e=>{})},i,o,r,function(t){Z(e,t)},function(e){a=e,n(1,a)},function(e){c=e,n(2,c)}]}return new class extends Pe{constructor(e){super(),Ce(this,e,jo,Lo,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
