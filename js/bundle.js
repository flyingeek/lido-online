var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(o)}function a(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(e){let t;return l(e,(e=>t=e))(),t}function u(e,t,n){e.$$.on_destroy.push(l(t,n))}function p(e,t,n,o){if(e){const r=d(e,t,n,o);return e[0](r)}}function d(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function m(e,t,n,o,r,s,a){const i=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(i){const r=d(t,n,o,a);e.p(r,i)}}function f(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function g(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function h(e){return null==e?"":e}function v(e,t,n=t){return e.set(n),t}function $(t){return t&&a(t.destroy)?t.destroy:e}const y="undefined"!=typeof window;let b=y?()=>window.performance.now():()=>Date.now(),x=y?e=>requestAnimationFrame(e):e;const w=new Set;function k(e){w.forEach((t=>{t.c(e)||(w.delete(t),t.f())})),0!==w.size&&x(k)}function P(e){let t;return 0===w.size&&x(k),{promise:new Promise((n=>{w.add(t={c:e,f:n})})),abort(){w.delete(t)}}}function C(e,t){e.appendChild(t)}function L(e,t,n){e.insertBefore(t,n||null)}function O(e){e.parentNode.removeChild(e)}function E(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function M(e){return document.createElement(e)}function S(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function T(e){return document.createTextNode(e)}function j(){return T(" ")}function A(){return T("")}function F(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function I(e){return function(t){return t.preventDefault(),e.call(this,t)}}function z(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function D(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:z(e,o,t[o])}function R(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function W(e){return""===e?null:+e}function N(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function q(e,t){e.value=null==t?"":t}function U(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function H(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function G(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function B(e,t,n){e.classList[n?"add":"remove"](t)}function Z(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const K=new Set;let V,Q=0;function X(e,t,n,o,r,s,a,i=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*s(e);c+=100*e+`%{${a(o,1-o)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,d=e.ownerDocument;K.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(M("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,Q+=1,p}function J(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),Q-=r,Q||x((()=>{Q||(K.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),K.clear())})))}function Y(e){V=e}function ee(){if(!V)throw new Error("Function called outside component initialization");return V}function te(e){ee().$$.on_mount.push(e)}function ne(e){ee().$$.on_destroy.push(e)}function oe(){const e=ee();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=Z(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function re(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const se=[],ae=[],ie=[],le=[],ce=Promise.resolve();let ue=!1;function pe(){ue||(ue=!0,ce.then(ve))}function de(){return pe(),ce}function me(e){ie.push(e)}function fe(e){le.push(e)}let ge=!1;const he=new Set;function ve(){if(!ge){ge=!0;do{for(let e=0;e<se.length;e+=1){const t=se[e];Y(t),$e(t.$$)}for(Y(null),se.length=0;ae.length;)ae.pop()();for(let e=0;e<ie.length;e+=1){const t=ie[e];he.has(t)||(he.add(t),t())}ie.length=0}while(se.length);for(;le.length;)le.pop()();ue=!1,ge=!1,he.clear()}}function $e(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(me)}}let ye;function be(){return ye||(ye=Promise.resolve(),ye.then((()=>{ye=null}))),ye}function xe(e,t,n){e.dispatchEvent(Z(`${t?"intro":"outro"}${n}`))}const we=new Set;let ke;function Pe(){ke={r:0,c:[],p:ke}}function Ce(){ke.r||s(ke.c),ke=ke.p}function Le(e,t){e&&e.i&&(we.delete(e),e.i(t))}function Oe(e,t,n,o){if(e&&e.o){if(we.has(e))return;we.add(e),ke.c.push((()=>{we.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const Ee={duration:0};function Me(n,o,r,i){let l=o(n,r),c=i?0:1,u=null,p=null,d=null;function m(){d&&J(n,d)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(o){const{delay:r=0,duration:a=300,easing:i=t,tick:g=e,css:h}=l||Ee,v={start:b()+r,b:o};o||(v.group=ke,ke.r+=1),u||p?p=v:(h&&(m(),d=X(n,c,o,a,r,i,h)),o&&g(0,1),u=f(v,a),me((()=>xe(n,o,"start"))),P((e=>{if(p&&e>p.start&&(u=f(p,a),p=null,xe(n,u.b,"start"),h&&(m(),d=X(n,c,u.b,u.duration,0,i,l.css))),u)if(e>=u.end)g(c=u.b,1-c),xe(n,u.b,"end"),p||(u.b?m():--u.group.r||s(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*i(t/u.duration),g(c,1-c)}return!(!u&&!p)})))}return{run(e){a(l)?be().then((()=>{l=l(),g(e)})):g(e)},end(){m(),u=p=null}}}const Se="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Te(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function _e(e){e&&e.c()}function je(e,t,n,r){const{fragment:i,on_mount:l,on_destroy:c,after_update:u}=e.$$;i&&i.m(t,n),r||me((()=>{const t=l.map(o).filter(a);c?c.push(...t):s(t),e.$$.on_mount=[]})),u.forEach(me)}function Ae(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Fe(t,n,o,a,i,l,c=[-1]){const u=V;Y(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:r(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(se.push(e),pe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,s(p.before_update),p.fragment=!!a&&a(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(O)}else p.fragment&&p.fragment.c();n.intro&&Le(t.$$.fragment),je(t,n.target,n.anchor,n.customElement),ve()}Y(u)}class Ie{$destroy(){Ae(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class ze{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const De="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,Re=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),We=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),Ne=matchMedia("(hover: hover)").matches;function qe(e,t,n){let o;return function(){const r=this,s=arguments,a=function(){o=null,n||e.apply(r,s)},i=n&&!o;clearTimeout(o),o=setTimeout(a,t),i&&e.apply(r,s)}}function Ue(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function He(e){switch(e){case"rmain":return"route";case"ralt":return"alternate";case"rnat":return"nat";default:return e}}function Ge(e,t,n){return e<=t?t:e>=n?n:e}function Be(e,t,n){return!(e<t)&&!(e>n)}function Ze(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Ke(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ve(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}const Qe=async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1};function Xe(e){const t=e-1;return t*t*t+1}function Je(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function Ye(e,{delay:t=0,duration:n=400,easing:o=Xe,x:r=0,y:s=0,opacity:a=0}={}){const i=getComputedStyle(e),l=+i.opacity,c="none"===i.transform?"":i.transform,u=l*(1-a);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*s}px);\n\t\t\topacity: ${l-u*t}`}}const et=[];function tt(e,t){return{subscribe:nt(e,t).subscribe}}function nt(t,n=e){let o;const r=[];function s(e){if(i(t,e)&&(t=e,o)){const e=!et.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),et.push(n,t)}if(e){for(let e=0;e<et.length;e+=2)et[e][0](et[e+1]);et.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(a,i=e){const l=[a,i];return r.push(l),1===r.length&&(o=n(s)||e),a(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}function ot(t,n,o){const r=!Array.isArray(t),i=r?[t]:t,c=n.length<2;return tt(o,(t=>{let o=!1;const u=[];let p=0,d=e;const m=()=>{if(p)return;d();const o=n(r?u[0]:u,t);c?t(o):d=a(o)?o:e},f=i.map(((e,t)=>l(e,(e=>{u[t]=e,p&=~(1<<t),o&&m()}),(()=>{p|=1<<t}))));return o=!0,m(),function(){s(f),d()}}))}const rt=["318","319","320","321","330","340","350","380","787","772","773","77F"],st=["340","380"];const at=nt(),it=nt(!1),lt=nt(!1),ct=nt(!1),ut=nt(!1),pt=nt(!1),dt=function(e){const{subscribe:t,set:n,update:o}=nt(e);return{subscribe:t,set:n,update:o,reset:()=>n("object"==typeof e?{...e}:Array.isArray(e)?[...e]:e)}}(!1),mt=nt(-1),ft=nt(),gt=nt(),ht=nt(new Date),vt=nt(),$t=ot([ft,vt],(([e,t])=>{let n;if(t?n=t:e&&(n=e.infos.aircraft),n&&-1!==rt.indexOf(n))return n}));let yt=new Date;const bt=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-yt>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting?(lt.set(!0),ct.set(!0)):e.update(),it.set(!1),yt=new Date)}),console.error)}},xt=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&bt()},wt=tt(!0,(e=>{const t=()=>{document&&document.visibilityState?"visible"===document.visibilityState?e(!0):e(!1):e(!0)};return document.addEventListener("visibilitychange",t),t(),()=>{document.removeEventListener("visibilitychange",t)}})),kt=tt({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),Pt=tt("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(ut.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),bt()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}})),Ct=ot([ft,mt,ht,dt,wt],(([e,t,n,o,r],s)=>{let a;const i=o?1e4:6e4;if(e){const o=e=>{e<100?s(e):(s(100),clearInterval(a),a=void 0,mt.set(-1))};if(t>=0){let e=t;a=setInterval((()=>{o(e),e++}),100)}else{const t=n,l=new Date(t),c=e.infos.duration;l.setUTCMinutes(l.getUTCMinutes()+c[1]),l.setUTCHours(l.getUTCHours()+c[0]);const u=()=>{let e=new Date;return e<=t?0:e>=l?100:(e-t)/(3600*c[0]+60*c[1])/10},p=u();p<100?(r&&(a=setInterval((()=>{const e=u();o(e)}),i)),s(p)):s(100)}}else s(0);return()=>{a&&clearInterval(a)}}),0),Lt=ot([ft,Ct],(([e,t])=>{if(!e)return{map:{latitude:0,longitude:0},gramet:t,fl:300};const n=e.timeMatrix,o=e.distanceMatrix,r=o[0][0],s=o[o.length-1][0],a=o[o.length-1][1],i=0!==n.length?n[0][2]:o[0][2],l=0!==n.length?n[n.length-1][2]:o[o.length-1][2];if(t<=0)return{map:r,gramet:0,fl:i};if(t>=100)return{map:s,gramet:100,fl:l};if(0!==n.length){const e=t*n[n.length-1][1]/100;for(const[t,[s,l,c]]of n.entries())if(l>=e){if(e-l==0)return{map:s,gramet:100*o[t][1]/a,fl:c};const u=n[t-1];if(u){const n=o[t][1]-o[t-1][1],r=(l-e)/(l-u[1]);return{map:s.atFraction(u[0],r,n),gramet:100*(o[t][1]-r*n)/a,fl:u[2]}}return{map:r,gramet:0,fl:i}}}else{const e=t*o[o.length-1][1]/100;for(const[n,[s,a,l]]of o.entries())if(a>=e){if(e-a==0)return{map:s,gramet:t,fl:l};const c=o[n-1];if(c){const n=a-c[1];return{map:s.atFraction(c[0],(a-e)/n,n),gramet:t,fl:c[2]}}return{map:r,gramet:0,fl:i}}}return{map:s,gramet:100,fl:l}}),{map:{latitude:0,longitude:0},gramet:0,fl:300});function Ot(e){let t;return{c(){t=M("textarea"),t.value=e[0],z(t,"class","svelte-12a0ij3")},m(n,o){L(n,t,o),e[5](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&O(t),e[5](null)}}}function Et(t){let n,o,r;return{c(){n=M("a"),n.textContent="copier la route",z(n,"role","button"),z(n,"class","btn btn-primary svelte-12a0ij3"),z(n,"href","lhs-mpilot://")},m(e,s){L(e,n,s),o||(r=F(n,"click",t[4]),o=!0)},p:e,d(e){e&&O(n),o=!1,r()}}}function Mt(t){let n,o,r,s,a;return{c(){n=M("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=j(),r=M("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',z(n,"role","button"),z(n,"class","btn btn-primary svelte-12a0ij3"),z(n,"href","lhs-mpilot://"),z(r,"class","card-text")},m(e,i){L(e,n,i),L(e,o,i),L(e,r,i),s||(a=F(n,"click",t[4]),s=!0)},p:e,d(e){e&&O(n),e&&O(o),e&&O(r),s=!1,a()}}}function St(n){let o,r,i;return{c(){o=M("span"),o.textContent="copié!",z(o,"class","svelte-12a0ij3")},m(e,t){L(e,o,t),i=!0},i(e){i||(r&&r.end(1),i=!0)},o(n){r=function(n,o,r){let i,l=o(n,r),c=!0;const u=ke;function p(){const{delay:o=0,duration:r=300,easing:a=t,tick:p=e,css:d}=l||Ee;d&&(i=X(n,1,0,r,o,a,d));const m=b()+o,f=m+r;me((()=>xe(n,!1,"start"))),P((e=>{if(c){if(e>=f)return p(0,1),xe(n,!1,"end"),--u.r||s(u.c),!1;if(e>=m){const t=a((e-m)/r);p(1-t,t)}}return c}))}return u.r+=1,a(l)?be().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(i&&J(n,i),c=!1)}}}(o,Je,{}),i=!1},d(e){e&&O(o),e&&r&&r.end()}}}function Tt(e){let t,n,o,r,s,a,i,l,c,u,p,d,m=null!=e[0]&&Ot(e);let f=(De?Mt:Et)(e),g=e[2]&&St();return{c(){m&&m.c(),t=j(),n=M("div"),o=M("div"),r=M("h5"),r.textContent="Route Lido",s=j(),a=M("p"),a.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",i=j(),f.c(),l=j(),c=M("div"),u=T(e[3]),p=j(),g&&g.c(),z(r,"class","card-title"),z(a,"class","card-text"),z(c,"class","text-monospace svelte-12a0ij3"),z(o,"class","card-body"),z(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),L(e,t,h),L(e,n,h),C(n,o),C(o,r),C(o,s),C(o,a),C(o,i),f.m(o,null),C(o,l),C(o,c),C(c,u),C(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=Ot(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&Le(g,1):(g=St(),g.c(),Le(g,1),g.m(c,null)):g&&(Pe(),Oe(g,1,1,(()=>{g=null})),Ce())},i(e){d||(Le(g),d=!0)},o(e){Oe(g),d=!1},d(e){m&&m.d(e),e&&O(t),e&&O(n),f.d(),g&&g.d()}}}let _t=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(_t=!0)}))}catch(e){}function jt(e,t,n){let o;u(e,ft,(e=>n(6,o=e)));let r,s=null;const a=o?o.lidoRoute().join(" "):"";let i=!1;return[s,r,i,a,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(_t)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await de(),r.focus(),r.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(a);De||(n(2,i=t),setTimeout((function(){n(2,i=!1)}),3e3),e.preventDefault())},function(e){ae[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class At extends Ie{constructor(e){super(),Fe(this,e,jt,Tt,i,{})}}const Ft={routeDisplay:!0,routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC",iconTextChange:"1.0",lineWidthChange:"1.0",iconSizeChange:"1.0"};function It(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const zt=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,It(window.kmlGen,Ft)),window.kmlGen);function Dt(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function Rt(e){let t,n,o,r=e[14].label+"";return{c(){t=M("option"),n=T(r),t.__value=e[16],t.value=t.__value,t.selected=o=e[16]===e[1]},m(e,o){L(e,t,o),C(t,n)},p(e,n){2&n&&o!==(o=e[16]===e[1])&&(t.selected=o)},d(e){e&&O(t)}}}function Wt(t){let n,o,r,i,l,c,u,p,d,m,f,g,h,v,y,b,x,w,k=Zt,P=[];for(let e=0;e<k.length;e+=1)P[e]=Rt(Dt(t,k,e));return{c(){n=M("kmlcolor"),o=M("pin"),r=S("svg"),i=S("use"),l=j(),c=M("select");for(let e=0;e<P.length;e+=1)P[e].c();u=j(),p=M("picker"),d=M("label"),m=M("input"),h=j(),v=M("input"),R(i,"xlink:href","#marker-symbol"),U(i,"stroke",0===t[1]?"#fff":Zt[t[1]].color),U(i,"fill",Zt[t[1]].color),z(o,"class","form-control svelte-1b9oa5t"),z(c,"name",t[4]),z(c,"class","custom-select"),void 0===t[1]&&me((()=>t[8].call(c))),z(m,"type","color"),z(d,"style",f=Bt(t[2])),z(v,"type","range"),z(v,"min","30"),z(v,"max","255"),z(p,"class","form-control"),z(p,"style",y=Gt(t[2][0])),z(n,"class","input-group")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(r,i),C(n,l),C(n,c);for(let e=0;e<P.length;e+=1)P[e].m(c,null);H(c,t[1]),C(n,u),C(n,p),C(p,d),C(d,m),q(m,t[2][0]),C(p,h),C(p,v),q(v,t[2][1]),x||(w=[F(c,"change",t[8]),F(c,"change",t[9]),F(m,"input",t[10]),$(g=t[5].call(null,d,t[2])),F(v,"change",t[11]),F(v,"input",t[11]),$(b=t[6].call(null,n,t[0]))],x=!0)},p(e,[t]){if(2&t&&U(i,"stroke",0===e[1]?"#fff":Zt[e[1]].color),2&t&&U(i,"fill",Zt[e[1]].color),2&t){let n;for(k=Zt,n=0;n<k.length;n+=1){const o=Dt(e,k,n);P[n]?P[n].p(o,t):(P[n]=Rt(o),P[n].c(),P[n].m(c,null))}for(;n<P.length;n+=1)P[n].d(1);P.length=k.length}2&t&&H(c,e[1]),4&t&&q(m,e[2][0]),4&t&&f!==(f=Bt(e[2]))&&z(d,"style",f),g&&a(g.update)&&4&t&&g.update.call(null,e[2]),4&t&&q(v,e[2][1]),4&t&&y!==(y=Gt(e[2][0]))&&z(p,"style",y),b&&a(b.update)&&1&t&&b.update.call(null,e[0])},i:e,o:e,d(e){e&&O(n),E(P,e),x=!1,s(w)}}}const Nt=/^[A-F0-9]{8}$/i,qt=e=>{let[t,n]=Ht(e);return[t,n/255]},Ut=["#FF0000",255],Ht=e=>{try{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]}catch(e){return Ut}},Gt=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Bt=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Zt=[{label:"Aucun repère",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Kt(e,t,n){const o=oe();let{kmlColor:r="FF0000FF"}=t,{selected:s=0}=t,{name:a}=t;const i=a+"-color",l=a+"-pin";let c=Ut;const u=qe(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"selected"in e&&n(1,s=e.selected),"name"in e&&n(7,a=e.name)},[r,s,c,o,l,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),u("change",{name:i,value:r})}}},function(e){return n(2,c=Ht(r)),{update(e){n(2,c=Ht(e)),u("change",{name:i,value:e.toUpperCase()})}}},a,function(){s=G(this),n(1,s)},e=>{e.target.blur(),o("change",{name:l,value:s})},function(){c[0]=this.value,n(2,c)},function(){c[1]=W(this.value),n(2,c)}]}class Vt extends Ie{constructor(e){super(),Fe(this,e,Kt,Wt,i,{kmlColor:0,selected:1,name:7})}}const Qt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),Xt=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){const n=JSON.stringify(t);"{}"!==n&&localStorage.setItem(e,n)}removeItem(e){localStorage.removeItem(e)}},Jt=(e,t,n="Mon OFP2MAP")=>{const o={};for(const[t,n]of Object.entries(Qt)){let r=Xt.getItem(n);if(t===Qt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==Ft[t])))t[n]=e[n];r=t}if(null!==r)if(t===Qt.optionsKML)for(const[e,t]of Object.entries(r))o[e]=t;else o[t]=r}const r=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),s=window.location.origin+window.location.pathname+(r?"?"+r:"")+"#"+t;window.history.replaceState(o,n,s)};function Yt(t){let n,o,r,a,i,l,c,u,p,d;return{c(){n=M("div"),o=M("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',r=j(),a=M("input"),i=j(),l=M("div"),c=M("a"),u=T("Lancer"),z(o,"class","input-group-prepend"),z(a,"class","form-control svelte-1ecyaux"),z(a,"placeholder","Nom du raccourci"),z(a,"type","text"),z(c,"class","btn btn-outline-secondary svelte-1ecyaux"),z(c,"href",t[1]),B(c,"disabled",!(t[0].trim()&&De)),z(l,"class","input-group-append"),z(n,"class","input-group")},m(e,s){L(e,n,s),C(n,o),C(n,r),C(n,a),q(a,t[0]),C(n,i),C(n,l),C(l,c),C(c,u),p||(d=[F(a,"input",t[4]),F(a,"change",t[3]),F(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&a.value!==e[0]&&q(a,e[0]),2&t&&z(c,"href",e[1]),1&t&&B(c,"disabled",!(e[0].trim()&&De))},i:e,o:e,d(e){e&&O(n),p=!1,s(d)}}}const en="OFP2MAP";function tn(e,t,n){let o;u(e,ft,(e=>n(5,o=e)));const r=oe(),s=Qt.shortcut;let a,i=Xt.getItem(s)||en;const l=o?o.lidoRoute().join(" "):"";return[i,a,function(e){const t=i.trim();if(t&&De){const e=zt(),r={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),kmlGoogleEarth:e.render({styleTemplate:editolido.googleEarthStyleTemplate}),grametProxyURL:o.ogimetData.proxyImg};n(1,a="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(r)))}else e.preventDefault()},function(){const e=i.trim();e===en?Xt.removeItem(s):Xt.setItem(s,e),r("save",[s,e])},function(){i=this.value,n(0,i)}]}class nn extends Ie{constructor(e){super(),Fe(this,e,tn,Yt,i,{})}}function on(t){let n,o,r,a,i,l,c,u,p,d,m,f,g,h,v,$,y,b=rn[0]+"",x=rn[1]+"",w=rn[2]+"";return{c(){n=M("div"),o=M("select"),r=M("option"),a=T(b),l=M("option"),c=T(x),p=M("option"),d=T(w),f=j(),g=M("div"),h=M("a"),v=T(t[0]),r.selected=i=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,p.selected=m=2===t[1],p.__value=2,p.value=p.__value,z(o,"class","custom-select svelte-19hokx5"),z(o,"aria-label","Example select with button addon"),void 0===t[1]&&me((()=>t[6].call(o))),z(h,"class","btn btn-success"),z(h,"download",t[3]),z(h,"href",t[2]),z(g,"class","input-group-append"),z(n,"class","input-group")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(r,a),C(o,l),C(l,c),C(o,p),C(p,d),H(o,t[1]),C(n,f),C(n,g),C(g,h),C(h,v),$||(y=[F(o,"change",t[6]),F(o,"change",t[5]),F(h,"click",t[4])],$=!0)},p(e,[t]){2&t&&i!==(i=0===e[1])&&(r.selected=i),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&m!==(m=2===e[1])&&(p.selected=m),2&t&&H(o,e[1]),1&t&&N(v,e[0]),8&t&&z(h,"download",e[3]),4&t&&z(h,"href",e[2])},i:e,o:e,d(e){e&&O(n),$=!1,s(y)}}}const rn=["KML Mapsme","KML Avenza","KML Google Earth"];function sn(e,t,n){const o=oe();let{label:r}=t;const s=Qt.downloadType;let a=Xt.getItem(s)||1;"string"==typeof a&&(a=parseInt(a,10)),(a<0||a>=rn.length)&&(a=0);let i="",l="";const c=(e,t="application/vnd.google-earth.kml+xml")=>{const n=new Blob(e,{type:t});return URL.createObjectURL(n)};return ne((()=>{i&&i.startsWith("blob:")&&URL.revokeObjectURL(i)})),e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,a,i,l,function(e){const t=zt(),o=["_mapsme.kml","_avenza.kml","_googleearth.kml"][a];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),i&&i.startsWith("blob:")&&URL.revokeObjectURL(i),0===a)n(2,i=c([t.render()]));else if(1===a)n(2,i=c([t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})]));else{if(2!==a)return e.preventDefault(),!1;n(2,i=c([t.render({styleTemplate:editolido.googleEarthStyleTemplate})]))}},function(){1===a?Xt.removeItem(s):Xt.setItem(s,a),o("save",[s,a])},function(){a=G(this),n(1,a)}]}class an extends Ie{constructor(e){super(),Fe(this,e,sn,on,i,{label:0})}}function ln(t){let n,o,r,s,a,i,l,c,u,p,d,m,f,g,h;return l=new an({props:{label:"Télécharger"}}),l.$on("save",t[0]),m=new nn({}),m.$on("save",t[1]),{c(){n=M("div"),o=M("div"),r=M("h5"),r.textContent="Export",s=j(),a=M("div"),i=M("div"),_e(l.$$.fragment),c=j(),u=M("small"),u.textContent="Le fichier est généré en fonction des options choisies sur la carte.",p=j(),d=M("div"),_e(m.$$.fragment),f=j(),g=M("small"),g.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/886cc07d24d74d83bb0859643242c2df" target="_blank">Exemple de raccourci à installer</a>',z(r,"class","card-title"),z(u,"class","text-muted"),z(i,"class","col-12 col-sm-6 col-md-6"),z(g,"class","text-muted"),z(d,"class","col-12 col-sm-6 col-md-6"),z(a,"class","row"),z(o,"class","card-body"),z(n,"class","card mb-3 svelte-17snbjk")},m(e,t){L(e,n,t),C(n,o),C(o,r),C(o,s),C(o,a),C(a,i),je(l,i,null),C(i,c),C(i,u),C(a,p),C(a,d),je(m,d,null),C(d,f),C(d,g),h=!0},p:e,i(e){h||(Le(l.$$.fragment,e),Le(m.$$.fragment,e),h=!0)},o(e){Oe(l.$$.fragment,e),Oe(m.$$.fragment,e),h=!1},d(e){e&&O(n),Ae(l),Ae(m)}}}function cn(e){return[function(t){re(e,t)},function(t){re(e,t)}]}class un extends Ie{constructor(e){super(),Fe(this,e,cn,ln,i,{})}}function pn(t){let n;return{c(){n=T(" ")},m(e,t){L(e,n,t)},p:e,d(e){e&&O(n)}}}function dn(t){let n,o,r;return{c(){n=M("button"),n.textContent="Partager l'App",z(n,"class","btn btn-link")},m(e,t){L(e,n,t),o||(r=F(n,"click",Qe),o=!0)},p:e,d(e){e&&O(n),o=!1,r()}}}function mn(t){let n,o,r,s,a,i;let l=(!0===navigator.standalone&&navigator.share?dn:pn)(t);return{c(){n=M("h1"),o=M("strong"),o.textContent="OFP2MAP ",r=T("Cartographie pour l'OFP \n    "),s=M("img"),i=j(),l.c(),z(o,"class","d-none"),s.src!==(a="svg/Air_France_Logo.svg")&&z(s,"src","svg/Air_France_Logo.svg"),z(s,"alt","logo Air France"),z(s,"class","svelte-drdjg7"),z(n,"class","svelte-drdjg7")},m(e,t){L(e,n,t),C(n,o),C(n,r),C(n,s),C(n,i),l.m(n,null)},p(e,[t]){l.p(e,t)},i:e,o:e,d(e){e&&O(n),l.d()}}}class fn extends Ie{constructor(e){super(),Fe(this,e,null,mn,i,{})}}function gn(t){let n,o,r,s;return n=new fn({}),{c(){_e(n.$$.fragment),o=j(),r=M("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card avenza svelte-16k91og"><div class="card-header svelte-16k91og">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card mapsme svelte-16k91og"><div class="card-header svelte-16k91og">Multiples Projections</div> \n      <div class="card-body"><p class="card-text">Des cartes LAMBERT conformes, un ATLAS politique, un ATLAS physique, une carte VFR et une MERCATOR avec 12 niveaux de zoom. Export en format KML vers Mapsme, Avenza ou Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card ogimet svelte-16k91og"><div class="card-header svelte-16k91og">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET qui est un météogramme combinant l&#39;espace et le temps</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card shortcuts svelte-16k91og"><div class="card-header svelte-16k91og">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Avec l&#39;app Raccourcis, automatisez en récupérant le KML, le Gramet, ou une route Lido optimisée</p></div></div></div></div>',z(r,"class","row svelte-16k91og")},m(e,t){je(n,e,t),L(e,o,t),L(e,r,t),s=!0},p:e,i(e){s||(Le(n.$$.fragment,e),s=!0)},o(e){Oe(n.$$.fragment,e),s=!1},d(e){Ae(n,e),e&&O(o),e&&O(r)}}}class hn extends Ie{constructor(e){super(),Fe(this,e,null,gn,i,{})}}function vn(t){let n,o,r,i,l,c,u,p,d,m,f,g,h,v,y,b,x;return{c(){n=M("kmlcolor"),o=M("div"),r=M("label"),i=M("input"),l=T(t[2]),c=j(),u=M("picker"),p=M("label"),d=M("input"),g=j(),h=M("input"),z(i,"name",t[4]),i.checked=t[1],z(i,"type","checkbox"),z(r,"for",t[4]),z(r,"class","input-group-text"),z(o,"class","input-group-prepend"),z(d,"type","color"),z(p,"style",m=Bt(t[3])),z(h,"type","range"),z(h,"min","30"),z(h,"max","255"),z(u,"class","form-control"),z(u,"style",v=Gt(t[3][0])),z(n,"class","input-group checkbox-combo")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(r,i),C(r,l),C(n,c),C(n,u),C(u,p),C(p,d),q(d,t[3][0]),C(u,g),C(u,h),q(h,t[3][1]),b||(x=[F(i,"change",t[8]),F(d,"input",t[9]),$(f=t[5].call(null,p,t[3])),F(h,"change",t[10]),F(h,"input",t[10]),$(y=t[6].call(null,n,t[0]))],b=!0)},p(e,[t]){2&t&&(i.checked=e[1]),4&t&&N(l,e[2]),8&t&&q(d,e[3][0]),8&t&&m!==(m=Bt(e[3]))&&z(p,"style",m),f&&a(f.update)&&8&t&&f.update.call(null,e[3]),8&t&&q(h,e[3][1]),8&t&&v!==(v=Gt(e[3][0]))&&z(u,"style",v),y&&a(y.update)&&1&t&&y.update.call(null,e[0])},i:e,o:e,d(e){e&&O(n),b=!1,s(x)}}}function $n(e,t,n){const o=oe();let{kmlColor:r="FF0000FF"}=t,{checked:s}=t,{name:a}=t,{label:i="Couleur"}=t;const l=a+"-color",c=a+"-display";let u=Ut;const p=qe(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"checked"in e&&n(1,s=e.checked),"name"in e&&n(7,a=e.name),"label"in e&&n(2,i=e.label)},[r,s,i,u,c,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),p("change",{name:l,value:r})}}},function(e){return n(3,u=Ht(r)),{update(e){n(3,u=Ht(e)),p("change",{name:l,value:e.toUpperCase()})}}},a,function(t){re(e,t)},function(){u[0]=this.value,n(3,u)},function(){u[1]=W(this.value),n(3,u)}]}class yn extends Ie{constructor(e){super(),Fe(this,e,$n,vn,i,{kmlColor:0,checked:1,name:7,label:2})}}function bn(e,t,n){const o=e.slice();return o[9]=t[n],o[11]=n,o}function xn(e){let t,n,o,r=e[9].label+"";return{c(){t=M("option"),n=T(r),t.__value=e[11],t.value=t.__value,t.selected=o=e[11]===e[0]},m(e,o){L(e,t,o),C(t,n)},p(e,n){1&n&&o!==(o=e[11]===e[0])&&(t.selected=o)},d(e){e&&O(t)}}}function wn(t){let n,o,r,a,i,l,c,u,p,d=kn,m=[];for(let e=0;e<d.length;e+=1)m[e]=xn(bn(t,d,e));return{c(){n=M("div"),o=M("div"),r=M("label"),a=M("input"),i=T("Airports"),l=j(),c=M("select");for(let e=0;e<m.length;e+=1)m[e].c();z(a,"name",t[3]),a.checked=t[1],z(a,"type","checkbox"),z(r,"for",t[3]),z(r,"class","input-group-text"),z(o,"class","input-group-prepend"),z(c,"name",t[4]),z(c,"class","custom-select svelte-aqi3t3"),void 0===t[0]&&me((()=>t[7].call(c))),z(n,"class","input-group checkbox-combo")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(r,a),C(r,i),C(n,l),C(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);H(c,t[0]),u||(p=[F(a,"change",t[6]),F(c,"change",t[7]),F(c,"change",t[8])],u=!0)},p(e,[t]){if(2&t&&(a.checked=e[1]),1&t){let n;for(d=kn,n=0;n<d.length;n+=1){const o=bn(e,d,n);m[n]?m[n].p(o,t):(m[n]=xn(o),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}1&t&&H(c,e[0])},i:e,o:e,d(e){e&&O(n),E(m,e),u=!1,s(p)}}}const kn=[{label:"statuts"},{label:"vert/rouge"}];function Pn(e,t,n){const o=oe();let{selected:r=0}=t,{name:s="airport"}=t,{checked:a}=t;const i=s+"-display",l=s+"-pin";return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(5,s=e.name),"checked"in e&&n(1,a=e.checked)},[r,a,o,i,l,s,function(t){re(e,t)},function(){r=G(this),n(0,r)},e=>{e.target.blur(),o("change",{name:l,value:r})}]}class Cn extends Ie{constructor(e){super(),Fe(this,e,Pn,wn,i,{selected:0,name:5,checked:1})}}function Ln(t){let n,o,r,a,i,l,c,u,p,d,m,f,g;return{c(){n=M("div"),o=M("div"),r=M("label"),a=T(t[2]),i=j(),l=M("button"),l.textContent="-",c=j(),u=M("div"),p=T(t[0]),d=j(),m=M("button"),m.textContent="+",z(r,"for",t[1]),z(r,"class","input-group-text svelte-si7r19"),z(o,"class","input-group-prepend"),z(l,"class","form-control svelte-si7r19"),z(l,"type","button"),z(u,"class"," form-control svelte-si7r19"),z(m,"class","form-control svelte-si7r19"),z(m,"type","button"),z(n,"class","input-group input-group-sm svelte-si7r19")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(r,a),C(n,i),C(n,l),C(n,c),C(n,u),C(u,p),C(n,d),C(n,m),f||(g=[F(l,"click",t[4]),F(m,"click",t[3])],f=!0)},p(e,[t]){4&t&&N(a,e[2]),2&t&&z(r,"for",e[1]),1&t&&N(p,e[0])},i:e,o:e,d(e){e&&O(n),f=!1,s(g)}}}function On(e,t,n){const o=oe();let{name:r}=t,{label:s}=t,{value:a}=t,{min:i=.9}=t,{max:l=1.4}=t,{step:c=.1}=t;return e.$$set=e=>{"name"in e&&n(1,r=e.name),"label"in e&&n(2,s=e.label),"value"in e&&n(0,a=e.value),"min"in e&&n(5,i=e.min),"max"in e&&n(6,l=e.max),"step"in e&&n(7,c=e.step)},[a,r,s,()=>{const e=a;n(0,a=Math.min(Math.max(parseFloat(a)+c,i),l).toFixed(1)),a!==e&&o("change",{name:r,value:a})},()=>{const e=a;n(0,a=Math.min(Math.max(parseFloat(a)-c,i),l).toFixed(1)),a!==e&&o("change",{name:r,value:a})},i,l,c]}class En extends Ie{constructor(e){super(),Fe(this,e,On,Ln,i,{name:1,label:2,value:0,min:5,max:6,step:7})}}function Mn(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Sn(e){let t,n,o,r,a,i,l,c,u,p,d,m,f,g,h,v,y,b,x,w,k,P,E,S,_,A,D,R,W,N,q,U,H,G,Z,K,V,Q,X,J,Y,ee,te,ne,oe,re,se,ae,ie,le,ce,ue,pe,de,fe,ge,he,ve,$e,ye,be,xe,we,ke,Pe,Ce,Ee,Se,Te,Fe;d=new Vt({props:{name:"route",kmlColor:e[0].routeColor,selected:e[0].routePin}}),d.$on("change",e[4]),x=new Vt({props:{name:"alternate",kmlColor:e[0].alternateColor,selected:e[0].alternatePin}}),x.$on("change",e[4]),D=new Vt({props:{name:"nat",kmlColor:e[0].natColor,selected:e[0].natPin}}),D.$on("change",e[4]),U=new yn({props:{name:"great-circle",label:"Orthodromie",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay}}),U.$on("change",e[4]),Z=new yn({props:{name:"ogimet",label:"Route GRAMET",kmlColor:e[0].ogimetColor,checked:e[0].ogimetDisplay}}),Z.$on("change",e[4]),Q=new yn({props:{name:"etops",label:"ETOPS",kmlColor:e[0].etopsColor,checked:e[0].etopsDisplay}}),Q.$on("change",e[4]),Y=new Cn({props:{name:"airport",selected:e[0].airportPin,checked:e[0].airportDisplay}}),Y.$on("change",e[4]),ue=new En({props:{name:"icon-text-change",label:"Label",value:e[0].iconTextChange}}),ue.$on("change",e[4]),de=new En({props:{name:"line-width-change",label:"Ligne",value:e[0].lineWidthChange,min:.6,max:2,step:.1}}),de.$on("change",e[4]),ge=new En({props:{name:"icon-size-change",label:"Icône",value:e[0].iconSizeChange,min:.6,max:2,step:.1}}),ge.$on("change",e[4]);let Ie=!e[1]&&Tn(e);return{c(){t=M("div"),n=M("a"),n.innerHTML='<svg class="svelte-1tbpz3x"><use xlink:href="#close-symbol"></use></svg>',o=j(),r=M("form"),a=M("fieldset"),i=M("legend"),l=M("input"),u=T("Route"),p=j(),_e(d.$$.fragment),m=j(),f=M("fieldset"),g=M("legend"),h=M("input"),y=T("Dégagement"),b=j(),_e(x.$$.fragment),w=j(),k=M("fieldset"),P=M("legend"),E=M("input"),_=T("Tracks"),A=j(),_e(D.$$.fragment),R=j(),W=M("small"),W.textContent="Positionné à l'entrée des tracks, un track incomplet restera rouge.",N=j(),q=M("fieldset"),_e(U.$$.fragment),H=j(),G=M("fieldset"),_e(Z.$$.fragment),K=j(),V=M("fieldset"),_e(Q.$$.fragment),X=j(),J=M("fieldset"),_e(Y.$$.fragment),ee=j(),te=M("fieldset"),ne=M("legend"),oe=M("input"),se=T("FIR REG"),ae=j(),ie=M("fieldset"),le=M("legend"),le.textContent="Aspect général",ce=j(),_e(ue.$$.fragment),pe=j(),_e(de.$$.fragment),fe=j(),_e(ge.$$.fragment),he=j(),ve=M("div"),$e=M("button"),ye=T("Mémoriser"),xe=j(),we=M("button"),ke=T("Restaurer"),Ce=j(),Ie&&Ie.c(),z(n,"class","closeB svelte-1tbpz3x"),z(n,"role","button"),z(n,"href","."),z(l,"name","route-display"),l.checked=c=e[0].routeDisplay,z(l,"type","checkbox"),z(a,"class","form-group svelte-1tbpz3x"),z(h,"name","alternate-display"),h.checked=v=e[0].alternateDisplay,z(h,"type","checkbox"),z(f,"class","form-group svelte-1tbpz3x"),z(E,"name","nat-display"),E.checked=S=e[0].natDisplay,z(E,"type","checkbox"),z(W,"class","form-text text-muted svelte-1tbpz3x"),z(k,"class","form-group svelte-1tbpz3x"),z(q,"class","form-group svelte-1tbpz3x"),z(G,"class","form-group svelte-1tbpz3x"),z(V,"class","form-group svelte-1tbpz3x"),z(J,"class","form-group svelte-1tbpz3x"),z(oe,"name","fir-display"),oe.checked=re=e[0].firDisplay,z(oe,"type","checkbox"),z(te,"class","form-group svelte-1tbpz3x"),z(ie,"class","form-group svelte-1tbpz3x"),$e.disabled=be=!e[2],z($e,"class","btn btn-primary btn-sm mb-2 svelte-1tbpz3x"),z($e,"type","button"),we.disabled=Pe=!e[2],z(we,"class","btn btn-secondary btn-sm mb-2 svelte-1tbpz3x"),z(we,"type","button"),z(ve,"class","last svelte-1tbpz3x"),z(r,"class","svelte-1tbpz3x"),z(t,"class","settings svelte-1tbpz3x"),B(t,"sidebar",e[3])},m(s,c){L(s,t,c),C(t,n),C(t,o),C(t,r),C(r,a),C(a,i),C(i,l),C(i,u),C(a,p),je(d,a,null),C(r,m),C(r,f),C(f,g),C(g,h),C(g,y),C(f,b),je(x,f,null),C(r,w),C(r,k),C(k,P),C(P,E),C(P,_),C(k,A),je(D,k,null),C(k,R),C(k,W),C(r,N),C(r,q),je(U,q,null),C(r,H),C(r,G),je(Z,G,null),C(r,K),C(r,V),je(Q,V,null),C(r,X),C(r,J),je(Y,J,null),C(r,ee),C(r,te),C(te,ne),C(ne,oe),C(ne,se),C(r,ae),C(r,ie),C(ie,le),C(ie,ce),je(ue,ie,null),C(ie,pe),je(de,ie,null),C(ie,fe),je(ge,ie,null),C(r,he),C(r,ve),C(ve,$e),C($e,ye),C(ve,xe),C(ve,we),C(we,ke),C(ve,Ce),Ie&&Ie.m(ve,null),Se=!0,Te||(Fe=[F(n,"click",I(e[10])),F(l,"change",e[4]),F(h,"change",e[4]),F(E,"change",e[4]),F(oe,"change",e[4]),F($e,"click",e[7]),F(we,"click",e[6]),F(r,"submit",I(e[9])),$(Mn.call(null,t)),F(t,"click_outside",e[11])],Te=!0)},p(e,n){(!Se||1&n&&c!==(c=e[0].routeDisplay))&&(l.checked=c);const o={};1&n&&(o.kmlColor=e[0].routeColor),1&n&&(o.selected=e[0].routePin),d.$set(o),(!Se||1&n&&v!==(v=e[0].alternateDisplay))&&(h.checked=v);const r={};1&n&&(r.kmlColor=e[0].alternateColor),1&n&&(r.selected=e[0].alternatePin),x.$set(r),(!Se||1&n&&S!==(S=e[0].natDisplay))&&(E.checked=S);const s={};1&n&&(s.kmlColor=e[0].natColor),1&n&&(s.selected=e[0].natPin),D.$set(s);const a={};1&n&&(a.kmlColor=e[0].greatCircleColor),1&n&&(a.checked=e[0].greatCircleDisplay),U.$set(a);const i={};1&n&&(i.kmlColor=e[0].ogimetColor),1&n&&(i.checked=e[0].ogimetDisplay),Z.$set(i);const u={};1&n&&(u.kmlColor=e[0].etopsColor),1&n&&(u.checked=e[0].etopsDisplay),Q.$set(u);const p={};1&n&&(p.selected=e[0].airportPin),1&n&&(p.checked=e[0].airportDisplay),Y.$set(p),(!Se||1&n&&re!==(re=e[0].firDisplay))&&(oe.checked=re);const m={};1&n&&(m.value=e[0].iconTextChange),ue.$set(m);const f={};1&n&&(f.value=e[0].lineWidthChange),de.$set(f);const g={};1&n&&(g.value=e[0].iconSizeChange),ge.$set(g),(!Se||4&n&&be!==(be=!e[2]))&&($e.disabled=be),(!Se||4&n&&Pe!==(Pe=!e[2]))&&(we.disabled=Pe),e[1]?Ie&&(Ie.d(1),Ie=null):Ie?Ie.p(e,n):(Ie=Tn(e),Ie.c(),Ie.m(ve,null)),8&n&&B(t,"sidebar",e[3])},i(e){Se||(Le(d.$$.fragment,e),Le(x.$$.fragment,e),Le(D.$$.fragment,e),Le(U.$$.fragment,e),Le(Z.$$.fragment,e),Le(Q.$$.fragment,e),Le(Y.$$.fragment,e),Le(ue.$$.fragment,e),Le(de.$$.fragment,e),Le(ge.$$.fragment,e),me((()=>{Ee||(Ee=Me(t,Ye,{duration:300,x:200,y:0},!0)),Ee.run(1)})),Se=!0)},o(e){Oe(d.$$.fragment,e),Oe(x.$$.fragment,e),Oe(D.$$.fragment,e),Oe(U.$$.fragment,e),Oe(Z.$$.fragment,e),Oe(Q.$$.fragment,e),Oe(Y.$$.fragment,e),Oe(ue.$$.fragment,e),Oe(de.$$.fragment,e),Oe(ge.$$.fragment,e),Ee||(Ee=Me(t,Ye,{duration:300,x:200,y:0},!1)),Ee.run(0),Se=!1},d(e){e&&O(t),Ae(d),Ae(x),Ae(D),Ae(U),Ae(Z),Ae(Q),Ae(Y),Ae(ue),Ae(de),Ae(ge),Ie&&Ie.d(),e&&Ee&&Ee.end(),Te=!1,s(Fe)}}}function Tn(t){let n,o,r;return{c(){n=M("button"),n.textContent="Reset",z(n,"class","btn btn-outline-dark btn-sm reset svelte-1tbpz3x"),z(n,"type","button")},m(e,s){L(e,n,s),o||(r=F(n,"click",t[5]),o=!0)},p:e,d(e){e&&O(n),o=!1,r()}}}function _n(e){let t,n,o=e[3]&&Sn(e);return{c(){o&&o.c(),t=A()},m(e,r){o&&o.m(e,r),L(e,t,r),n=!0},p(e,[n]){e[3]?o?(o.p(e,n),8&n&&Le(o,1)):(o=Sn(e),o.c(),Le(o,1),o.m(t.parentNode,t)):o&&(Pe(),Oe(o,1,1,(()=>{o=null})),Ce())},i(e){n||(Le(o),n=!0)},o(e){Oe(o),n=!1},d(e){o&&o.d(e),e&&O(t)}}}function jn(e,t){return JSON.stringify(e)===JSON.stringify(t)}function An(e,t,n){let o,r,s;u(e,ut,(e=>n(3,s=e)));const a=oe(),i=Qt.optionsKML;let{kmlOptions:l}=t,c={...Ft,...Xt.getItem(i)||{}};function p(e){let t=!1;for(const[r,s]of Object.entries(e))l[r]!==s&&(n(0,l[r]=s,l),a("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:s}),t=!0);var o;t&&n(0,l={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=jn(Ft,l)),257&e.$$.dirty&&n(2,r=!jn(c,l))},[l,o,r,s,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));l[r]!==o&&(n(0,l[r]=o,l),a("change",{name:t,value:o}))},function(){p(Ft)},function(){p(c)},function(){if(o)Xt.removeItem(i);else{const e={};for(const t of Object.keys(l).filter((e=>l[e]!==Ft[e])))e[t]=l[t];Xt.setItem(i,e)}a("save"),n(8,c={...l})},c,function(t){re(e,t)},()=>{v(ut,s=!s,s)},()=>v(ut,s=!1,s)]}class Fn extends Ie{constructor(e){super(),Fe(this,e,An,_n,i,{kmlOptions:0})}}function In(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function zn(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Dn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const Rn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"],Wn=(e,t=10,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?10:o},Nn=(e,t=2)=>{const n=e*t;return isNaN(n)?1:n},qn=(e,t=1,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?1:o};function Un(e,t,n,o,r){const s=He(t),a=r[`${s}Pin`],i=r[`${s}Display`],l=r[`${s}Color`],c=Wn(r.iconTextChange);e.addSource(`${t}-marker-source`,zn(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>In(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(Bn(t,a,l,i,c))}function Hn(e,t,n,o,r,s,a,i){o?e.addSource(`${t}-line-source`,zn(o(n).map((e=>Dn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:Dn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(Zn(t,r,s,a,i))}function Gn(e,t,n,o,r,s,a,i){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(Dn(t[e]))}e.addSource(`${t}-line-source`,zn(s))}else e.addSource(`${t}-line-source`,zn(n.map((e=>Dn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(Zn(t,r,s,a,i))}function Bn(e,t,n,o,r){const[s,a]=qt(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":r,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?Rn[t]:s,"icon-halo-width":1,"icon-halo-color":"#000","text-color":s,"text-opacity":Math.max(a,.7)}}}function Zn(e,t,n,o=2,r=!1){const[s,a]=qt(t);return{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":s,"line-opacity":a,"line-width":o,"line-dasharray":r?[10,10]:[1]}}}function Kn(e,t,n=1){const{map:o,value:r,kmlOptions:s}=t,a=`${e}-marker-layer`,i=s[`${He(e)}Pin`];return o.getLayer(a)&&o.setLayoutProperty(a,"icon-size",i?qn(r,n):.2),!0}function Vn(e,t,n=10){const{map:o,value:r}=t,s=`${e}-marker-layer`;return o.getLayer(s)&&o.setLayoutProperty(s,"text-size",Wn(r,n)),!0}function Qn(e,t,n=2){const{map:o,value:r}=t,s=`${e}-line-layer`;return o.getLayer(s)&&o.setPaintProperty(s,"line-width",Nn(r,n)),!0}function Xn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,s=`${e}-marker-layer`;if(n.getLayer(s)&&n.getLayer(r)){const e=o,t=Rn[e],a=n.getPaintProperty(r,"line-color");n.setPaintProperty(s,"icon-color",0!==e?t:a),n.setPaintProperty(s,"text-color",a),n.setLayoutProperty(s,"icon-size",0!==e?1:.2),n.setLayoutProperty(s,"icon-image",0!==e?"sdf-marker-15":"sdf-triangle"),n.setLayoutProperty(s,"icon-anchor",0!==e?"bottom":"center")}return!0}function Jn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,s=`${e}-marker-layer`,[a,i]=qt(o);return n.getLayer(r)&&(n.setPaintProperty(r,"line-color",a),n.setPaintProperty(r,"line-opacity",i)),n.getLayer(s)&&n.setPaintProperty(s,"text-color",a),!0}function Yn(e,t,n){const{map:o}=n,r=`${e}-line-layer`,s=`${e}-marker-layer`;return o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(s)&&o.setLayoutProperty(s,"visibility",t?"visible":"none"),!0}const eo="airport-layer",to="airport-emer-layer",no="airport-source",oo=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),ro=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],so=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],ao=e=>0===e?3:0,io=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"],lo=(e,t)=>["case",["in",["get","name"],["literal",e]],Wn(t,10),Wn(t,8,1.15)],co=e=>Wn(e,8,1.15),uo=(e,t)=>["case",["in",["get","name"],["literal",e]],qn(t,1),qn(t,.6)],po=e=>["case",["==",2,["get","level"]],qn(e,.5,1.2),qn(e,.4,1.2)];function mo(e,t){const{map:n}=e;n.getLayer(eo)&&n.setLayoutProperty(eo,"visibility",t?"visible":"none"),n.getLayer(to)&&n.setLayoutProperty(to,"visibility",t?"visible":"none")}const fo=e=>{const t=e?e.infos.ralts:[];let n=[];return e&&e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(n=[e.infos.EEP.name,e.infos.EXP.name]),[t,n.concat(t)]};var go={show:e=>mo(e,!0),hide:e=>mo(e,!1),add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r}=e,{affineOrDrop:s}=n,a=s;let i=[];o&&o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(i=[o.infos.EEP,o.infos.EXP]);const l=c($t),u=o?o.infos.raltPoints:[],p=r.etopsColor,d=r.airportPin,m=r.airportDisplay,[f]=qt(p),g=i.map((e=>e.name)),h=u.map((e=>e.name)),v=g.concat(h);fetch("data/airports.2104.geojson").then((e=>e.json())).then((e=>{if(a){const t=[];for(let n of e.features)n.geometry.coordinates=a(n.geometry.coordinates),void 0!==n.geometry.coordinates&&t.push(n);e.features=t}t.addSource(no,{type:"geojson",data:e}),t.addLayer({id:to,type:"symbol",source:no,layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":po(r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:m?"visible":"none","text-field":["get","name"],"text-size":co(r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:ro(l,!1)}),t.addLayer({id:eo,type:"symbol",source:no,layout:{"icon-image":["case",["in",["get","name"],["literal",v]],"sdf-triangle","sdf-airport"],"icon-size":uo(v,r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:m?"visible":"none","text-field":["get","name"],"text-size":lo(v,r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":so(l,v)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":ao(d),"icon-color":oo(d,l,h,f),"text-color":io(h,f),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:ro(l)});const n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!Ne}),s=function(e){const r=e.features[0].geometry.coordinates.slice(),s=e.features[0].properties.title;for(;Math.abs(e.lngLat.lng-r[0])>180;)r[0]+=e.lngLat.lng>r[0]?360:-360;let a=`<div class="airport"><h1>${s}</h1>`;const i=e.features[0].properties.level;let c="",u="0";switch(e.features[0].properties[l]){case 1:case 2:c="Destination & RCF",u="3";break;case 3:case 4:c="Dégagement à destination",u="2";break;case 5:case 6:c="Dégagement en route",u="2 ERA";break;case 7:case 8:c="Appui ou adéquat en route",u="1"}o&&(a+=`<p class="status status-${u.charAt(0)}">STATUT ${u}</p>`,i>0&&(a+=`<p class="security-${i}">${1==i?"ORANGE":"RED"}</p>`),c&&(a+=`<p class="status-text">${c}</p>`)),a+="</div>",n.setLngLat(r).setHTML(a).addTo(t)},i=()=>t.getCanvas().style.cursor="pointer",c=()=>t.getCanvas().style.cursor="",u=function(){c(),n.remove()};Ne?(t.on("mouseenter",eo,(e=>{i(),s(e)})),t.on("mouseenter",to,(e=>{i(),s(e)})),t.on("mouseleave",eo,u),t.on("mouseleave",to,u)):(t.on("mouseenter",eo,i),t.on("mouseenter",to,i),t.on("click",eo,s),t.on("click",to,s),t.on("mouseleave",eo,c),t.on("mouseleave",to,c))}))},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,s=o?o.infos.ralts:[],[a]=qt(n.etopsColor),i=n.airportPin;t.getLayer(eo)&&(t.setPaintProperty(eo,"icon-color",oo(i,r,s,a)),t.setPaintProperty(eo,"text-color",io(s,a)),t.setPaintProperty(eo,"icon-halo-width",ao(i)))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,[s,a]=fo(r),[i]=qt(n.etopsColor),l=n.airportPin;t.setFilter(eo,ro(o)),t.setPaintProperty(eo,"icon-color",oo(l,o,s,i)),t.setLayoutProperty(eo,"symbol-sort-key",so(o,a)),t.setFilter(to,ro(o,!1))},changeIconText:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=fo(o);t.getLayer(eo)&&t.setLayoutProperty(eo,"text-size",lo(r,n.iconTextChange)),t.getLayer(to)&&t.setLayoutProperty(to,"text-size",co(n.iconTextChange))},changeIconSize:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=fo(o);t.getLayer(eo)&&t.setLayoutProperty(eo,"icon-size",uo(r,n.iconSizeChange)),t.getLayer(to)&&t.setLayoutProperty(to,"icon-size",po(n.iconSizeChange))}};const ho="etops-ep-circle-line-layer",vo="etops-etops-circle-line-layer";function $o(e,t){const{map:n}=e;n.getLayer(vo)&&n.setLayoutProperty(vo,"visibility",t?"visible":"none"),n.getLayer(ho)&&n.setLayoutProperty(ho,"visibility",t?"visible":"none")}var yo={show:e=>$o(e,!0),hide:e=>$o(e,!1),add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(!o)return;const s=Nn(r.lineWidthChange,1);if(o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n,a=o.infos.ETOPS,i=r.etopsDisplay;Gn(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,i,s,!0),Gn(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*a))),e,r.etopsColor,i,s,!0)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=qt(e.value);t.getLayer(vo)&&(t.setPaintProperty(vo,"line-color",n),t.setPaintProperty(vo,"line-opacity",o))}(e),changeLineWidth:function(e){const{map:t,value:n}=e,o=Nn(n,1);return t.getLayer(vo)&&t.setPaintProperty(vo,"line-width",o),t.getLayer(ho)&&t.setPaintProperty(ho,"line-width",o),!0}};const bo="fir-reg-line-layer",xo="fir-reg-layer",wo="fir-reg-source";function ko(e,t){const{map:n}=e;n.getLayer(xo)&&n.setLayoutProperty(xo,"visibility",t?"visible":"none"),n.getLayer(bo)&&n.setLayoutProperty(bo,"visibility",t?"visible":"none")}var Po={show:e=>ko(e,!0),hide:e=>ko(e,!1),add:e=>{const{ofp:t,map:n,mapData:o,kmlOptions:r,mapOptions:s}=e;if("jb_pacific"===s.id||s.id.startsWith("vb_"))return;if(!t)return;const{affine:a}=o,i=r.firDisplay;fetch("data/fir-reg.2104.geojson").then((e=>e.json())).then((e=>{if(a)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>a(e)))]}n.addSource(wo,{type:"geojson",data:e}),n.addLayer({id:xo,type:"fill",source:wo,layout:{visibility:i?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),n.addLayer({id:bo,type:"line",source:wo,layout:{visibility:i?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))}};const Co="great-circle";var Lo={show:Yn.bind(null,Co,!0),hide:Yn.bind(null,Co,!1),add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r,mapOptions:s}=e;if(s.id.startsWith("vb_"))return;if(!t)return;const{affineAndClip:a}=o,i=`${t.infos.departure}-${t.infos.destination}`,l=t.route,c=new editolido.Route([l.points[0],l.points[l.points.length-1]]).split(300,{name:`Ortho ${i}`});Hn(r,Co,c.points,a,n.greatCircleColor,n.greatCircleDisplay)},changeLine:Jn.bind(null,Co)};const Oo="ogimet";var Eo={show:Yn.bind(null,Oo,!0),hide:Yn.bind(null,Oo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r,mapOptions:s}=e;if(s.id.startsWith("vb_"))return;if(!n)return;const{affineAndClip:a}=r;Hn(t,Oo,n.ogimetData.route.points,a,o.ogimetColor,o.ogimetDisplay)},changeLine:Jn.bind(null,Oo)};const Mo="ralt";var So={show:Yn.bind(null,Mo,!0),hide:Yn.bind(null,Mo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(!n)return;const{affineAndClip:s,affineOrDrop:a}=r,i=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route Dégagement"});Hn(t,Mo,i.points,s,o.alternateColor,o.alternateDisplay),Un(t,Mo,i.points,a,o)},changeLine:Jn.bind(null,Mo),changeMarker:Xn.bind(null,Mo),changeIconText:Vn.bind(null,Mo),changeLineWidth:Qn.bind(null,Mo),changeIconSize:Kn.bind(null,Mo)};const To="rmain";var _o={show:Yn.bind(null,To,!0),hide:Yn.bind(null,To,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(!n)return;const{affineAndClip:s,affineOrDrop:a}=r,i=n.route;i.name=`${n.infos.departure}-${n.infos.destination}`,i.description=n.description,Hn(t,To,i.points,s,o.routeColor,!0),Un(t,To,i.points,a,o)},changeLine:e=>Jn(To,e)&&function(e){const{map:t,kmlOptions:n}=e,[o,r]=qt(n.routeColor);t.getLayer(ho)&&(t.setPaintProperty(ho,"line-color",o),t.setPaintProperty(ho,"line-opacity",r))}(e),changeMarker:Xn.bind(null,To),changeIconText:Vn.bind(null,To),changeLineWidth:Qn.bind(null,To),changeIconSize:Kn.bind(null,To)};const jo="rnat";const Ao={airport:go,etops:yo,fir:Po,greatcircle:Lo,ogimet:Eo,ralt:So,rmain:_o,rnat:{show:e=>Yn(jo,!0,e)&&Yn("rnat-incomplete",!0,e),hide:e=>Yn(jo,!1,e)&&Yn("rnat-incomplete",!1,e),add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r}=e;if(!n)return;const{affineOrDrop:s,affineAndClip:a}=o,i=s,l=a,c=r.natColor,u=r.natPin,p=r.natDisplay,d={rnat:[],"rnat-incomplete":[]},m={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(l){const n=l(e.points),o=n.length;for(let r=0;r<o;r++)d[t].push(Dn(n[r],e.name))}else d[t].push(Dn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const n=e.points[0];let o=i?i([n.longitude,n.latitude]):[n.longitude,n.latitude];if(o&&m[t].push(In(o,`${e.name}\n${n.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];o=i?i([n.longitude,n.latitude]):[n.longitude,n.latitude],o&&m[t].push(In(o,`${e.name}\n${n.name}`,e.description))}}t.addSource("rnat-marker-source",zn(m.rnat)),t.addSource("rnat-incomplete-marker-source",zn(m["rnat-incomplete"])),t.addSource("rnat-line-source",zn(d.rnat)),t.addSource("rnat-incomplete-line-source",zn(d["rnat-incomplete"]));const f=Wn(r.iconTextChange,10),g=Nn(r.lineWidthChange,1);t.addLayer(Zn("rnat",c,p,g)),t.addLayer(Zn("rnat-incomplete",r.natIncompleteColor,p,g)),t.addLayer(Bn("rnat",u,c,p,f)),t.addLayer(Bn("rnat-incomplete",u,c,p,f));const h=e=>{for(var n=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties.description;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(t)},v=e=>{const n=e+"-marker-layer";t.on("click",n,h),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};v("rnat"),v("rnat-incomplete")},changeLine:Jn.bind(null,jo),changeMarker:Xn.bind(null,jo),changeIconText:function(e){const{map:t,value:n}=e,o=Wn(n,10);return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","text-size",o),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","text-size",o),!0},changeLineWidth:function(e){const{map:t,value:n}=e,o=Nn(n,1);return t.getLayer("rnat-line-layer")&&t.setPaintProperty("rnat-line-layer","line-width",o),t.getLayer("rnat-incomplete-line-layer")&&t.setPaintProperty("rnat-incomplete-line-layer","line-width",o),!0},changeIconSize:function(e){const{map:t,value:n,kmlOptions:o}=e,r=o.natPin?qn(n,1):.2;return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","icon-size",r),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","icon-size",r),!0}}},Fo=2*Math.PI,Io=Math.PI/4,zo=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*Fo};var Do={init:function(){},forward:function(e){var t=e.x,n=e.y,o=zo(t-this.long0),r=Math.tan(n/2),s=Math.sin(Io*r),a=s*s,i=this.x0+this.a*o*(.74482-.34588*a),l=this.y0+1.70711*this.a*r;return e.x=i,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(Io*t),o=n*n,r=zo(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};const Ro=Math.abs,Wo=Math.asin,No=Math.cos,qo=Math.sin,Uo=Math.sqrt,Ho=1.340264,Go=-.081106,Bo=893e-6,Zo=.003796,Ko=Uo(3)/2;var Vo={init:function(){},forward:function(e){const t=e.x,n=e.y,o=Wo(Ko*qo(n)),r=o*o,s=r*r*r;return e.x=this.a*t*No(o)/(Ko*(Ho+3*Go*r+s*(7*Bo+9*Zo*r))),e.y=this.a*o*(Ho+Go*r+s*(Bo+Zo*r)),e},inverse:function(e){const t=e.y/this.a,n=e.x/this.a;let o=t,r=o*o,s=r*r*r;for(var a,i=0;i<12&&(o-=a=(o*(Ho+Go*r+s*(Bo+Zo*r))-t)/(Ho+3*Go*r+s*(7*Bo+9*Zo*r)),r=o*o,s=r*r*r,!(Ro(a)<1e-12));++i);return e.x=Ko*n*(Ho+3*Go*r+s*(7*Bo+9*Zo*r))/No(o),e.y=Wo(qo(o)/Ko),e},names:["Equal Earth","eqearth"]};function Qo(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(Do),window.proj4.Proj.projections.get("eqearth")||window.proj4.Proj.projections.add(Vo);let s={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:(()=>{const e="Airports/FIR © Olivier Ravet";return t.id.startsWith("ed_eqe")?`© equal-earth.com - ${e}`:t.id.startsWith("jb_")||t.id.startsWith("ed_")?`Yammer/QGIS & Avenza maps - ${e}`:t.id.startsWith("vb_")?`© ${window.atob("Q2FydGFCb3NzeQ==")}.com - Airports © Olivier Ravet`:`Yammer/Maps.me - ${e}`})()};const a=new mapboxgl.Map({...t.mapboxOptions,...s});let i,l,c,u;a._setCacheLimits(320,32),a.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||a.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||a.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||a.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-star-sdf.png",(function(e,t){e||a.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+proj=longlat +datum=WGS84"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let p,d=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else{const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],[a,i,l,c]=t.extent;let[u,p,d,m]=s;if(t.ratio){const e=s[3]-s[1],[n,o]=t.ratio,r=o/n*e;[u,p,d,m]=[s[0],s[3]-r,s[2],s[3]]}e=(d-u)/(l-a),n=u-e*a,o=(m-p)/(c-i),r=p-o*i}const[s,a,p,f]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>m(h(e));d=e=>h(g(e)),i=e=>m(d(e)),l=e=>{let[t,n]=g(e);return t=Ge(t,s,p),n=Ge(n,a,f),v([t,n])},c=e=>{let[t,n]=g(e);if(Be(t,s,p)&&Be(n,a,f))return v([t,n])},u=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,a,i,l=e.length,c=Ke(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],a=i=Ke(s=e[o],t);;){if(!(c|a)){u.push(r),a!==i?(u.push(s),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(s);break}if(c&a)break;c?c=Ke(r=Ze(r,s,c,t),t):a=Ke(s=Ze(r,s,a,t),t)}c=i}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let f=[];if(n){for(const e of n.tracks)f=f.concat(e.points);f=f.concat(n.route.points,n.wptCoordinatesAlternate()),p=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(f,l),a.fitBounds(p,{padding:{top:30,bottom:80,left:30,right:30}})}const g=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(i){const e=g._onSuccess;g._onSuccess=function(t){const[n,o]=i([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const h={map:a,affine:i,affineAndClamp:l,affineAndClip:u,affineOrDrop:c,bbox:p,mapOptions:t,geolocate:g};return a.addControl(new class{onAdd(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl  mapboxgl-ctrl-group",this._button=document.createElement("button"),this._button.className="mapboxgl-ctrl-layers",this._button.setAttribute("type","button"),this._button.setAttribute("title","Personnaliser la carte"),this._button.innerHTML='<svg><use xlink:href="#layers-symbol"/></svg>',this._container.appendChild(this._button),this._toggleSidebar=()=>ut.update((e=>!e)),this._button.addEventListener("click",this._toggleSidebar),this._container}onRemove(){this._button.removeEventListener("click",this._toggleSidebar),this._container.parentNode.removeChild(this._container),this._map=void 0}}),a.addControl(g),a.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),Object.values(Ao).forEach((t=>t.add&&t.add(e)))})({ofp:n,kmlOptions:o,mapData:h,map:a,mapOptions:t}),r&&r(a,t)})),a.on("remove",(function(){})),h}class Xo{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const s=indexedDB.open(e,t);s.onsuccess=()=>{o(s)},s.onerror=()=>{r("Error while opening DB")},s.onupgradeneeded=n?n.bind(null,s):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const s=n.result.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{o(s.result)},s.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,s)=>{const a=o.result.transaction(t,"readwrite").objectStore(t),i=a.put(n,e);i.onsuccess=()=>{const t=a.get(e);t.onsuccess=()=>{r(t.result)}},i.onerror=()=>{s("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,s)=>{const a=o.result.transaction(e,"readonly").objectStore(e).getKey(n);a.onsuccess=()=>{r(void 0===a.result?t:null)},a.onerror=()=>{s("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function Jo(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Yo(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const er=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(!n)return[];const s=new Xo("lido-tiles");if(o.cacheAll){const e=await s.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return s.close(),caches[o.id]=!0,[]}const[a,i]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,p;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:Jo(a[0],e),y:Yo(a[1],e)},r={x:Jo(i[0],e),y:Yo(i[1],e)}),o.matrix?[u,p]=o.matrix[e]:[u,p]=[c,c];for(let a=t.x;a<=r.x;a++)for(let i=r.y;i<=t.y;i++)if(a>=0&&i>=0&&a<u&&i<p){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",a).replace("{y}",i)),l.push(s.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.6nts91f3/${e}/${a}/${i}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.1x3i1g8r,denizotjb.bifqeinj,denizotjb.cz0kdfpx,denizotjb.aop85z8z,mapbox.mapbox-terrain-v2/${e}/${a}/${i}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return s.close(),c.filter((e=>null!==e))};function tr(e){let t,n,o,r,s,a;const i=e[4].default,l=p(i,e,e[3],null);return{c(){t=S("svg"),n=S("path"),o=S("path"),s=j(),l&&l.c(),z(n,"d","M50,5A45 45 0 1 1 49.9999 5"),z(n,"class","svelte-1bp2w4i"),z(o,"d",r=e[0]()),z(o,"class","svelte-1bp2w4i"),z(t,"viewBox","0 0 100 100"),z(t,"class","svelte-1bp2w4i")},m(e,r){L(e,t,r),C(t,n),C(t,o),L(e,s,r),l&&l.m(e,r),a=!0},p(e,[t]){(!a||1&t&&r!==(r=e[0]()))&&z(o,"d",r),l&&l.p&&8&t&&m(l,i,e,e[3],t,null,null)},i(e){a||(Le(l,e),a=!0)},o(e){Oe(l,e),a=!1},d(e){e&&O(t),e&&O(s),l&&l.d(e)}}}function nr(e,t,n){let o,{$$slots:r={},$$scope:s}=t,{value:a=0}=t,{max:i=100}=t;return e.$$set=e=>{"value"in e&&n(1,a=e.value),"max"in e&&n(2,i=e.max),"$$scope"in e&&n(3,s=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(a<=0)return"";if(a>=i)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(a/i),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,a,i,s,r]}class or extends Ie{constructor(e){super(),Fe(this,e,nr,tr,i,{value:1,max:2})}}function rr(e){const t=()=>{document&&document.visibilityState&&"visible"!==document.visibilityState&&e&&e.blur&&e.blur()};return document.addEventListener("visibilitychange",t,!1),{destroy(){document.removeEventListener("visibilitychange",t)}}}function sr(e,t,n){const o=e.slice();return o[6]=t[n],o}function ar(t){let n,o;return{c(){n=M("option"),o=T("???"),n.__value=void 0,n.value=n.__value,n.selected=!0},m(e,t){L(e,n,t),C(n,o)},p:e,d(e){e&&O(n)}}}function ir(e){let t,n,o,r=e[6]+"";return{c(){t=M("option"),n=T(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[2]},m(e,o){L(e,t,o),C(t,n)},p(e,n){4&n&&o!==(o=e[6]===e[2])&&(t.selected=o)},d(e){e&&O(t)}}}function lr(e){let t,n=e[6]===e[2]||!st.includes(e[6]),o=n&&ir(e);return{c(){o&&o.c(),t=A()},m(e,n){o&&o.m(e,n),L(e,t,n)},p(e,r){4&r&&(n=e[6]===e[2]||!st.includes(e[6])),n?o?o.p(e,r):(o=ir(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null)},d(e){o&&o.d(e),e&&O(t)}}}function cr(t){let n,o,r,a,i=!t[2]&&ar(),l=rt,c=[];for(let e=0;e<l.length;e+=1)c[e]=lr(sr(t,l,e));return{c(){n=M("select"),i&&i.c(),o=A();for(let e=0;e<c.length;e+=1)c[e].c();z(n,"name","aircraftType"),z(n,"class","svelte-1xpiicm"),void 0===t[1]&&me((()=>t[5].call(n)))},m(e,s){L(e,n,s),i&&i.m(n,null),C(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[4](n),H(n,t[1]),r||(a=[F(n,"change",t[5]),F(n,"change",t[3]),$(rr.call(null,n))],r=!0)},p(e,[t]){if(e[2]?i&&(i.d(1),i=null):i?i.p(e,t):(i=ar(),i.c(),i.m(n,o)),4&t){let o;for(l=rt,o=0;o<l.length;o+=1){const r=sr(e,l,o);c[o]?c[o].p(r,t):(c[o]=lr(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}2&t&&H(n,e[1])},i:e,o:e,d(e){e&&O(n),i&&i.d(),E(c,e),t[4](null),r=!1,s(a)}}}function ur(e,t,n){let o,r;u(e,vt,(e=>n(1,o=e))),u(e,$t,(e=>n(2,r=e)));let{aircraftTypeSelectElement:s=null}=t;return e.$$set=e=>{"aircraftTypeSelectElement"in e&&n(0,s=e.aircraftTypeSelectElement)},[s,o,r,function(t){re(e,t)},function(e){ae[e?"unshift":"push"]((()=>{s=e,n(0,s)}))},function(){o=G(this),vt.set(o)}]}class pr extends Ie{constructor(e){super(),Fe(this,e,ur,cr,i,{aircraftTypeSelectElement:0})}}function dr(e,t,n){let o,r;u(e,Lt,(e=>n(1,o=e)));let{mapData:s}=t;const a=window.document.createElement("div");a.classList.add("mapboxgl-user-location-dot","map-plane");const i=e=>{if(r){const t=s.affine,[n,o]=t?t([e.longitude,e.latitude]):[e.longitude,e.latitude];r.setLngLat([n,o])}};return te((()=>{r=new mapboxgl.Marker(a),i(o.map),r.addTo(s.map)})),ne((()=>{r&&(r.remove(),r=void 0)})),e.$$set=e=>{"mapData"in e&&n(0,s=e.mapData)},e.$$.update=()=>{2&e.$$.dirty&&i(o.map)},[s,o]}class mr extends Ie{constructor(e){super(),Fe(this,e,dr,null,i,{mapData:0})}}const fr={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},gr=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,hr=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cknj4nmwu0t8117ny6rk7dwbg",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv2",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:gr},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:gr},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:gr},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20],[64,40]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:gr},{label:"=Physique=",id:"ed_eqe_physical_fr",affineTransform:[1.104,-855.8520345054567,1.1,931e4],extent:[-18145536.6946,-10300589.33644032,18143985.81684419,9720047.1747],proj4:"+proj=eqearth +datum=WGS84 +wktext",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-eqephysicalfrv1.netlify.app/eqephysicalfrv1/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,9],[32,18],[64,36]],cacheZoom:5,cacheName:"eqephysicalfrv1",cacheAll:!0,tileSize:gr},{label:atob("Q2FydGFCb3NzeQ==")+" 2020",id:"vb_2020",ratio:[19449,18352],extent:[26966.11818123,-430589.86447607,1262485.62823696,735241.49181695],proj4:"+proj=lcc +lat_1=45.89893890000052 +lat_2=47.69601440000037 +lat_0=46.8 +lon_0=2.33722917 +x_0=600000 +y_0=200000 +datum=WGS84 +units=m +no_defs ",mapboxOptions:{style:fr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-cb2020v1.netlify.app/cb2020v1/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,4],[8,8],[16,16],[32,31],[64,61]],cacheName:"cb2020v1",cacheZoom:5,cacheAll:!0,tileSize:gr}];function vr(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function $r(e){let t,n,o,r=(e[7].id===e[2]?`${e[7].label.toUpperCase()}`:e[7].label)+"";return{c(){t=M("option"),n=T(r),t.__value=e[7],t.value=t.__value,t.selected=o=e[7].id===e[0].id},m(e,o){L(e,t,o),C(t,n)},p(e,s){4&s&&r!==(r=(e[7].id===e[2]?`${e[7].label.toUpperCase()}`:e[7].label)+"")&&N(n,r),9&s&&o!==(o=e[7].id===e[0].id)&&(t.selected=o)},d(e){e&&O(t)}}}function yr(t){let n,o,r,a=t[3],i=[];for(let e=0;e<a.length;e+=1)i[e]=$r(vr(t,a,e));return{c(){n=M("select");for(let e=0;e<i.length;e+=1)i[e].c();z(n,"name",t[1]),z(n,"class","form-control form-control-sm svelte-1uc3ace"),void 0===t[0]&&me((()=>t[6].call(n)))},m(e,s){L(e,n,s);for(let e=0;e<i.length;e+=1)i[e].m(n,null);H(n,t[0]),o||(r=[F(n,"change",t[6]),F(n,"change",t[5]),$(rr.call(null,n))],o=!0)},p(e,[t]){if(13&t){let o;for(a=e[3],o=0;o<a.length;o+=1){const r=vr(e,a,o);i[o]?i[o].p(r,t):(i[o]=$r(r),i[o].c(),i[o].m(n,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=a.length}2&t&&z(n,"name",e[1]),9&t&&H(n,e[0])},i:e,o:e,d(e){e&&O(n),E(i,e),o=!1,s(r)}}}function br(e,t,n){if(!e.proj4)return!1;try{const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}}catch(e){return!1}return!0}function xr(e,t,n){let{name:o="map-style"}=t,{ofp:r}=t,{selected:s=hr[0]}=t,a=s.id;const i=r?hr:hr.filter((e=>!e.id.startsWith("vb_")&&"jb_theworld"!==e.id));return te((()=>{if(s.id===hr[0].id&&r){const e=r.route.points[0],t=r.route.points[r.route.points.length-1],o=hr.find((e=>"vb_2020"===e.id)),a=hr.find((e=>"jb_north"===e.id));br(o,e,t)?n(0,s=o):e.distanceTo(t,editolido.rad_to_nm)<=1500||(t.latitude>30&&e.latitude>30?n(0,s=a):t.longitude<-80&&e.longitude<-80?n(0,s=hr.find((e=>"jb_pacific"===e.id))):(t.latitude>30||e.latitude>30)&&br(a,e,t)?n(0,s=a):n(0,s=hr.find((e=>"jb_south"===e.id))))}n(2,a=s.id)})),e.$$set=e=>{"name"in e&&n(1,o=e.name),"ofp"in e&&n(4,r=e.ofp),"selected"in e&&n(0,s=e.selected)},[s,o,a,i,r,function(t){re(e,t)},function(){s=G(this),n(0,s),n(3,i)}]}class wr extends Ie{constructor(e){super(),Fe(this,e,xr,yr,i,{name:1,ofp:4,selected:0})}}function kr(t){let n,o,r,a,i,l,c,u=t[2]>=0?"◼︎":"▶︎";return{c(){n=M("label"),o=T(u),r=j(),a=M("input"),z(a,"name",t[0]),z(a,"type","checkbox"),a.checked=i=t[2]>=0,z(a,"class","svelte-1t9v15q"),z(n,"for",t[0]),z(n,"class","svelte-1t9v15q")},m(e,s){L(e,n,s),C(n,o),C(n,r),C(n,a),t[4](a),l||(c=[F(a,"change",t[3]),F(n,"click",t[3])],l=!0)},p(e,[t]){4&t&&u!==(u=e[2]>=0?"◼︎":"▶︎")&&N(o,u),1&t&&z(a,"name",e[0]),4&t&&i!==(i=e[2]>=0)&&(a.checked=i),1&t&&z(n,"for",e[0])},i:e,o:e,d(e){e&&O(n),t[4](null),l=!1,s(c)}}}function Pr(e,t,n){let o;u(e,mt,(e=>n(2,o=e)));let r,{name:s="simulator"}=t;return e.$$set=e=>{"name"in e&&n(0,s=e.name)},[s,r,o,()=>{n(1,r.checked=!r.checked,r),v(mt,o=r.checked?0:-1,o)},function(e){ae[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class Cr extends Ie{constructor(e){super(),Fe(this,e,Pr,kr,i,{name:0})}}const Lr=nt(),Or=nt({});function Er(e,{ofp:t,pos:n,fl:o}){const r=document.getElementById("gt-plane");let s,a,i,l,c,u=parseFloat(n),p=t,d=o;const m=e.clientHeight,f=e.clientWidth,g=getComputedStyle(document.body),h=parseFloat(g.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),v=e=>65*c+(l-130*c)*e/100,$=e=>{const t=v(e),n=65*c,o=f/3,r=n+o,s=l-n-(f-o);return t>r&&t<s?o-t:t<=r?o-r:o-s},y=(e,t,n,o)=>{e&&(e.style.left=n+(v(t)-e.clientWidth/2)+"px",e.style.top=(h-Math.round(-6e-4*o*o+.8985*o+46.264))*c-e.clientHeight/2+"px")},b=()=>{const t=a.height||700;i=a.cloneNode(),i.id="grametImg",i.style.display="none",i.crossOrigin="anonymous",i.addEventListener("load",x),i.addEventListener("error",w),document.body.appendChild(i),a.style.height=t/h*m+"px",a.style.objectFit="contain",a.style.position="absolute",a.style.opacity=.01,e.appendChild(a),l=a.clientWidth;const n=a.clientHeight/t;c=n;const o=$(u);a.style.top=`-${33*n}px`,a.style.left=`${o}px`},x=()=>{Lr.set("success"),r.style.display="block",a.style.opacity=1;const e=$(u);y(r,u,e,d)},w=()=>{r.style.display="none",Lr.set("error")},k=()=>{a&&a.removeEventListener("load",b),a&&a.removeEventListener("error",w),a&&a.remove(),pt.set(!1),i&&i.removeEventListener("load",x),i&&i.removeEventListener("error",w),i&&i.remove(),i=void 0,a=void 0,s&&URL.revokeObjectURL(s),s=void 0},P=async e=>{a=document.createElement("img"),Lr.set("loading"),r.style.display="none",fetch(e.ogimetData.proxyImg).then((function(e){e.ok?(Or.set({status:e.status,text:e.statusText||"OK"}),e.blob().then((e=>{s=URL.createObjectURL(e),a.addEventListener("load",b),a.addEventListener("error",w),a.src=s}))):(w(),e.headers?Or.set({status:e.status,text:e.statusText||e.headers.get("X-ofp2map-status")}):Or.set({status:e.status,text:e.statusText||""}))})).catch((function(e){w(),Or.set({status:0,text:e.message})}))};return P(t),{update({ofp:e,pos:t,fl:n}){if(u=parseFloat(t),e!==p)p=e,k(),P(e);else{const e=$(u);a.style.left=e+"px",d=n,y(r,u,e,n)}},destroy(){k()}}}const Mr=(e,{pos:t,fl:n})=>{const o=e.parentNode.querySelector("svg"),r=document.getElementById("grametImg"),s=getComputedStyle(document.body),a=parseFloat(s.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),i=parseFloat(e.parentNode.dataset.maxHeight||"370"),l=r.width,c=r.height,u=document.querySelector("nav").clientWidth;let p;p=0!==l?Math.min(u/l*c,i):Math.min(c,i);let d,m,f=parseFloat(t),g=0,h=0,v=n;const $=e=>(65+(l-130)*e/100)*d,y=(e,t,n)=>{e.style.left=g+($(t)-e.clientWidth+2)+"px",e.style.top=(a+33-2-Math.round(-6e-4*n*n+.8985*n+46.264))*d-e.clientHeight/2+h+"px"},b=e=>{const t=$(e),n=u/3,o=0+n,r=l*d-0-(u-n);return t>o&&t<r?n-t:t<=o?n-o:n-r},x=()=>{g=e.x,h=e.y,d=e.scale,m=u<=l*d,y(o,f,v)};return f<=0||f>=100?(d=0===l?i/(a+70):Math.min(u/l,p/(a+70)),h=0):(d=p/a,h=-33*d),u>l*d?(g=(u-l*d)/2,m=!1):(g=b(f),m=!0),y(o,f,v),r.style.display="block",e.style.maxHeight=`${i}px`,e.appendChild(r),e.setTransform({scale:d,x:g,y:h}),e.addEventListener("change",x),{update({pos:t,fl:n}){f=parseFloat(t),v=n,m&&(g=b(f),e.setTransform({x:g})),y(o,f,n)},destroy(){r.style.display="none",document.body.appendChild(r),e.removeEventListener("change",x)}}},Sr=e=>{const t=document.getElementById("grametImg"),n=t.width,o=t.height||700,r=parseFloat(e.dataset.maxHeight||"370"),s=document.querySelector("nav").clientWidth;let a=1;0!==n&&(a=s/n);const i=Math.min(a*o,r);e.style.height=`${i}px`};function Tr(e){let t,n;return t=new Cr({}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function _r(e){let t,n,o,r,i,l,c,u,p,d,m,f=(0===e[0].gramet||100===e[0].gramet||e[1]>=0)&&Tr();return{c(){var e,o,s;t=M("div"),n=M("pinch-zoom"),r=j(),i=S("svg"),l=S("use"),c=j(),f&&f.c(),s="0.3",(o="min-scale")in(e=n)?e[o]=s:z(e,o,s),R(l,"xlink:href","#plane-symbol"),z(i,"class","svelte-dwqlg"),z(t,"class","pinch-zoom-parent svelte-dwqlg"),z(t,"data-max-height",jr)},m(s,a){L(s,t,a),C(t,n),C(t,r),C(t,i),C(i,l),C(t,c),f&&f.m(t,null),p=!0,d||(m=[$(o=Mr.call(null,n,{pos:e[0].gramet,fl:e[0].fl})),$(Sr.call(null,t))],d=!0)},p(n,[r]){e=n,o&&a(o.update)&&1&r&&o.update.call(null,{pos:e[0].gramet,fl:e[0].fl}),0===e[0].gramet||100===e[0].gramet||e[1]>=0?f?3&r&&Le(f,1):(f=Tr(),f.c(),Le(f,1),f.m(t,null)):f&&(Pe(),Oe(f,1,1,(()=>{f=null})),Ce())},i(e){p||(Le(f),me((()=>{u||(u=Me(t,Ye,{y:jr},!0)),u.run(1)})),p=!0)},o(e){Oe(f),u||(u=Me(t,Ye,{y:jr},!1)),u.run(0),p=!1},d(e){e&&O(t),f&&f.d(),e&&u&&u.end(),d=!1,s(m)}}}const jr=370;function Ar(e,t,n){let o,r;return u(e,Lt,(e=>n(0,o=e))),u(e,mt,(e=>n(1,r=e))),[o,r]}class Fr extends Ie{constructor(e){super(),Fe(this,e,Ar,_r,i,{})}}function Ir(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const s=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",s,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",s),n&&n.remove()}}}function zr(e){let t,n,o,r,s;return n=new or({props:{value:e[8],max:e[7],$$slots:{default:[Dr]},$$scope:{ctx:e}}}),{c(){t=M("div"),_e(n.$$.fragment),z(t,"class","cacheButton svelte-voriir"),B(t,"cacheError",e[9]),B(t,"cacheProgress",e[8]>0||e[7]>0)},m(i,l){L(i,t,l),je(n,t,null),o=!0,r||(s=F(t,"click",(function(){a(e[11]?Hr:e[21])&&(e[11]?Hr:e[21]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const s={};256&r[0]&&(s.value=e[8]),128&r[0]&&(s.max=e[7]),268435456&r[0]&&(s.$$scope={dirty:r,ctx:e}),n.$set(s),512&r[0]&&B(t,"cacheError",e[9]),384&r[0]&&B(t,"cacheProgress",e[8]>0||e[7]>0)},i(e){o||(Le(n.$$.fragment,e),o=!0)},o(e){Oe(n.$$.fragment,e),o=!1},d(e){e&&O(t),Ae(n),r=!1,s()}}}function Dr(e){let t;const n=e[23].default,o=p(n,e,e[28],null),r=o||function(e){let t;return{c(){t=M("span"),t.textContent="↓",z(t,"class","svelte-voriir")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}();return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){o&&o.p&&268435456&t[0]&&m(o,n,e,e[28],t,null,null)},i(e){t||(Le(r,e),t=!0)},o(e){Oe(r,e),t=!1},d(e){r&&r.d(e)}}}function Rr(e){let t;return{c(){t=M("div"),t.textContent="Votre navigateur ne supporte pas l'affichage d'images au format .webp",z(t,"class","nowebp svelte-voriir")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Wr(e){let t,n;return t=new mr({props:{mapData:e[4]}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};16&n[0]&&(o.mapData=e[4]),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Nr(e){let t,n;return t=new Fr({}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function qr(e){let t,n,o,r,s,i,l,c,u,p,d,m,f,g,h,v,y,b,x,w,k=!e[12]&&e[4]&&e[4].mapOptions&&e[4].mapOptions.tiles&&e[4].mapOptions.tiles[0].endsWith(".webp");function P(t){e[24](t)}let E={ofp:e[1]};void 0!==e[5]&&(E.selected=e[5]),s=new wr({props:E}),ae.push((()=>Te(s,"selected",P))),s.$on("change",e[18]);let S=e[5]&&e[1]&&window.indexedDB&&e[14]&&!0!==e[10][e[5].id]&&!e[13]&&zr(e),T=k&&Rr(),_=e[4]&&!!e[1]&&(e[15]||e[16]>=0)&&Wr(e);function F(t){e[25](t)}let I={};function D(t){e[26](t)}void 0!==e[6]&&(I.aircraftTypeSelectElement=e[6]),d=new pr({props:I}),ae.push((()=>Te(d,"aircraftTypeSelectElement",F))),d.$on("change",e[19]);let R={};void 0!==e[0]&&(R.kmlOptions=e[0]),g=new Fn({props:R}),ae.push((()=>Te(g,"kmlOptions",D))),g.$on("change",e[20]),g.$on("save",e[27]);let W=e[17]&&Nr();return{c(){t=M("div"),o=j(),r=M("div"),_e(s.$$.fragment),l=j(),S&&S.c(),c=j(),T&&T.c(),u=j(),_&&_.c(),p=j(),_e(d.$$.fragment),f=j(),_e(g.$$.fragment),v=j(),W&&W.c(),y=A(),z(t,"id",e[2]),z(t,"class","svelte-voriir"),z(r,"class","mapmenu svelte-voriir")},m(a,i){L(a,t,i),L(a,o,i),L(a,r,i),je(s,r,null),C(r,l),S&&S.m(r,null),C(r,c),T&&T.m(r,null),L(a,u,i),_&&_.m(a,i),L(a,p,i),je(d,a,i),L(a,f,i),je(g,a,i),L(a,v,i),W&&W.m(a,i),L(a,y,i),b=!0,x||(w=$(n=Ir.call(null,t,e[3])),x=!0)},p(e,o){(!b||4&o[0])&&z(t,"id",e[2]),n&&a(n.update)&&8&o[0]&&n.update.call(null,e[3]);const l={};2&o[0]&&(l.ofp=e[1]),!i&&32&o[0]&&(i=!0,l.selected=e[5],fe((()=>i=!1))),s.$set(l),e[5]&&e[1]&&window.indexedDB&&e[14]&&!0!==e[10][e[5].id]&&!e[13]?S?(S.p(e,o),25634&o[0]&&Le(S,1)):(S=zr(e),S.c(),Le(S,1),S.m(r,c)):S&&(Pe(),Oe(S,1,1,(()=>{S=null})),Ce()),4112&o[0]&&(k=!e[12]&&e[4]&&e[4].mapOptions&&e[4].mapOptions.tiles&&e[4].mapOptions.tiles[0].endsWith(".webp")),k?T||(T=Rr(),T.c(),T.m(r,null)):T&&(T.d(1),T=null),e[4]&&e[1]&&(e[15]||e[16]>=0)?_?(_.p(e,o),98322&o[0]&&Le(_,1)):(_=Wr(e),_.c(),Le(_,1),_.m(p.parentNode,p)):_&&(Pe(),Oe(_,1,1,(()=>{_=null})),Ce());const u={};!m&&64&o[0]&&(m=!0,u.aircraftTypeSelectElement=e[6],fe((()=>m=!1))),d.$set(u);const f={};!h&&1&o[0]&&(h=!0,f.kmlOptions=e[0],fe((()=>h=!1))),g.$set(f),e[17]?W?131072&o[0]&&Le(W,1):(W=Nr(),W.c(),Le(W,1),W.m(y.parentNode,y)):W&&(Pe(),Oe(W,1,1,(()=>{W=null})),Ce())},i(e){b||(Le(s.$$.fragment,e),Le(S),Le(_),Le(d.$$.fragment,e),Le(g.$$.fragment,e),Le(W),b=!0)},o(e){Oe(s.$$.fragment,e),Oe(S),Oe(_),Oe(d.$$.fragment,e),Oe(g.$$.fragment,e),Oe(W),b=!1},d(e){e&&O(t),e&&O(o),e&&O(r),Ae(s),S&&S.d(),T&&T.d(),e&&O(u),_&&_.d(e),e&&O(p),Ae(d,e),e&&O(f),Ae(g,e),e&&O(v),W&&W.d(e),e&&O(y),x=!1,w()}}}const Ur=e=>{dt.set(!1)},Hr=()=>!1;function Gr(e,t,n){let o,r,s,a,i,l;u(e,$t,(e=>n(29,r=e))),u(e,kt,(e=>n(14,s=e))),u(e,dt,(e=>n(15,a=e))),u(e,mt,(e=>n(16,i=e))),u(e,pt,(e=>n(17,l=e)));let{$$slots:p={},$$scope:d}=t;const m=oe();let f,g,h,v,{kmlOptions:$}=t,{ofp:y}=t,b=0,x=0,w=!1,k=[];const P={};let{id:C="map"}=t;async function L(){if(y)try{n(22,k=await er(0,g))}catch(e){n(22,k=[])}else n(22,k=[]);const e=document.querySelector(`#${C} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(v),e.appendChild(document.createTextNode(`${"2104".substring(0,2)}.${"2104".substring(2,4)}`)))}const O=e=>{(e=>{const{name:t,value:n}=e,o=Ue(t);if("icontext"===o)return Object.values(Ao).forEach((t=>t.changeIconText&&t.changeIconText(e)));if("linewidth"===o)return Object.values(Ao).forEach((t=>t.changeLineWidth&&t.changeLineWidth(e)));if("iconsize"===o)return Object.values(Ao).forEach((t=>t.changeIconSize&&t.changeIconSize(e)));const r=Ao[o];r&&(t.endsWith("-display")?n?r.show&&r.show(e):r.hide&&r.hide(e):t.endsWith("-pin")?r.changeMarker&&r.changeMarker(e):t.endsWith("-color")?r.changeLine&&r.changeLine(e):t.endsWith("-change")&&r.change&&r.change(e))})({map:f,mapData:g,name:e.detail.name,value:e.detail.value,ofp:y,kmlOptions:$,aircraftType:r}),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-")||e.endsWith("-change"))return;const n=zt(),o=Ue(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),m("save")};let E=!1;let M=!0;return(async()=>{const e=e=>{n(12,M=!(!e||"load"!==e.type)&&1==t.width)},t=new Image;t.onerror=e,t.onload=e,t.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="})(),te((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",n(4,g=Qo(C,h,y,$,L)),Ur(),dt.reset(),n(3,f=g.map),g.geolocate.on("trackuserlocationstart",Ur)})),ne((()=>{g.geolocate.off("trackuserlocationstart",Ur),n(3,f=void 0),n(4,g=void 0)})),e.$$set=e=>{"kmlOptions"in e&&n(0,$=e.kmlOptions),"ofp"in e&&n(1,y=e.ofp),"id"in e&&n(2,C=e.id),"$$scope"in e&&n(28,d=e.$$scope)},e.$$.update=()=>{4194304&e.$$.dirty[0]&&n(13,o=0===k.length)},[$,y,C,f,g,h,v,b,x,w,P,E,M,o,s,a,i,l,function(e){e.target.blur(),f&&f.remove(),n(8,x=0),n(9,w=!1),n(22,k=[]),n(7,b=0),g&&g.geolocate&&g.geolocate.off("trackuserlocationstart",Ur);const t=c(dt);Ur(),n(4,g=Qo(C,h,y,$,L)),n(3,f=g.map),g.geolocate.on("trackuserlocationstart",Ur),setTimeout((async()=>{await de,dt.set(t)}),0)},function(e){e.target.blur(),O({detail:{value:r,name:"airport-change"}})},O,async e=>{if(E)return!1;n(11,E=!0);try{n(7,b=k.length),n(9,w=!1);try{await Ve(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(11,E=!1),n(9,w=!0),!1}n(8,x=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const s=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(s),e()),o>=5||r>n.length-1)return;const a=r++,i=n[a];o++;try{await fetch(i),t&&t()}catch{}o--,delete n[a]}),100)}))}(k,(()=>n(8,x++,x))),x>=b&&(n(10,P[h.id]=!0,P),n(10,P),n(22,k=[]),n(7,b=0))}finally{n(11,E=!1)}},k,p,function(e){h=e,n(5,h)},function(e){v=e,n(6,v)},function(e){$=e,n(0,$)},function(t){re(e,t)},d]}class Br extends Ie{constructor(e){super(),Fe(this,e,Gr,qr,i,{kmlOptions:0,ofp:1,id:2},[-1,-1])}}var Zr=["bottom-right","bottom-center","bottom-left","top-right","top-center","top-left","right-bottom","right-center","right-top","left-bottom","left-center","left-top"];const Kr="right",Vr="left",Qr="top",Xr="bottom";function Jr(){return"undefined"!=typeof window&&"undefined"!=typeof document}const Yr=(e,{top:t,bottom:n,left:o,right:r,height:s,width:a,clientWidth:i,clientHeight:l})=>{const c=t>s,u=n+s<l,p=o>a,d=r+a<i;return{top:()=>!c&&u?Xr:Qr,bottom:()=>c&&!u?Qr:Xr,left:()=>!p&&d?Kr:Vr,right:()=>!d&&p?Vr:Kr}[e]()},es=(e,{top:t,bottom:n,left:o,right:r,height:s,width:a,clientWidth:i,clientHeight:l})=>{const c=t+(n-t)/2,u=n>s,p=t+s<l,d=c-s/2>0&&c+s/2<l,m=r>a,f=o+a<i,g={top:()=>!u&&p?Xr:Qr,center:()=>d?"center":g.top(),bottom:()=>!p&&u?Qr:Xr,left:()=>!m&&f?Kr:Vr,right:()=>!f&&m?Vr:Kr};return g[e]()},{window:ts}=Se,ns=e=>({isOpen:2048&e[0]}),os=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]}),rs=e=>({isOpen:2048&e[0]}),ss=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]});function as(e){let t,n,o;const r=e[26].content,s=p(r,e,e[25],os);return{c(){t=M("div"),s&&s.c(),z(t,"class",n=h(`content ${e[4]||""}`)+" svelte-d6atc3")},m(n,r){L(n,t,r),s&&s.m(t,null),e[28](t),o=!0},p(e,a){s&&s.p&&33556480&a[0]&&m(s,r,e,e[25],a,ns,os),(!o||16&a[0]&&n!==(n=h(`content ${e[4]||""}`)+" svelte-d6atc3"))&&z(t,"class",n)},i(e){o||(Le(s,e),o=!0)},o(e){Oe(s,e),o=!1},d(n){n&&O(t),s&&s.d(n),e[28](null)}}}function is(e){let t,n,o,r,a,i,l,c,u,d;const f=e[26].parent,g=p(f,e,e[25],ss);let v=e[11]&&as(e);return{c(){t=M("div"),n=M("div"),g&&g.c(),o=j(),r=M("div"),v&&v.c(),z(n,"class","svelte-d6atc3"),z(r,"class","content-wrapper svelte-d6atc3"),z(r,"style",a=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`),z(t,"class",i=h(`overlay ${e[10]}`)+" svelte-d6atc3"),z(t,"style",l=`z-index:${e[0]}; ${e[1]}`)},m(s,a){L(s,t,a),C(t,n),g&&g.m(n,null),e[27](n),C(t,o),C(t,r),v&&v.m(r,null),e[29](t),c=!0,u||(d=[F(ts,"mousedown",e[15]),F(ts,"keydown",e[16])],u=!0)},p(e,n){g&&g.p&&33556480&n[0]&&m(g,f,e,e[25],n,rs,ss),e[11]?v?(v.p(e,n),2048&n[0]&&Le(v,1)):(v=as(e),v.c(),Le(v,1),v.m(r,null)):v&&(Pe(),Oe(v,1,1,(()=>{v=null})),Ce()),(!c||961&n[0]&&a!==(a=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`))&&z(r,"style",a),(!c||1024&n[0]&&i!==(i=h(`overlay ${e[10]}`)+" svelte-d6atc3"))&&z(t,"class",i),(!c||3&n[0]&&l!==(l=`z-index:${e[0]}; ${e[1]}`))&&z(t,"style",l)},i(e){c||(Le(g,e),Le(v),c=!0)},o(e){Oe(g,e),Oe(v),c=!1},d(n){n&&O(t),g&&g.d(n),e[27](null),v&&v.d(),e[29](null),u=!1,s(d)}}}function ls(e,t,o){let r,s,a,i;const l=["isOpen","updateOnScroll","closeOnScroll","position","closeOnClickOutside","zIndex","onWindowKeyDown","style"];let c=g(t,l),{$$slots:u={},$$scope:p}=t;const d=oe(),m=Zr[0];let h,v,$,{isOpen:y=!1}=t,{updateOnScroll:b=!1}=t,{closeOnScroll:x=!1}=t,{position:w=m}=t,{closeOnClickOutside:k=!1}=t,{zIndex:P=1}=t,{onWindowKeyDown:C=(()=>{})}=t,{style:L=""}=t,O=null,E=0,M=0,S=0,T=0;function _(){Jr()&&(window.addEventListener("resize",R),x?window.addEventListener("scroll",z):b&&window.addEventListener("scroll",R))}function j(){Jr()&&(window.removeEventListener("resize",R),window.removeEventListener("scroll",R),window.removeEventListener("scroll",z))}var A;function F(e){const t=y,n=!0===e||!1===e?e:!y;(n&&s&&a||!n)&&o(17,y=n),t!==y&&(d("toggle",y),y?(_(),d("open")):(d("close"),j()))}function I(){i||F(!0)}function z(){i&&F(!1)}function D(e){const t=e.path||e.composedPath();return t.includes(h)||t.includes(v)}async function R(){if(await de(),!i)return;Zr.includes(w)||o(18,w=m);const{top:e,bottom:t,left:n,right:r,width:s,height:a}=h.getBoundingClientRect(),{height:l,width:c}=v.getBoundingClientRect(),u=((e,t)=>{const n=Math.min(document.body.clientHeight,document.documentElement.clientHeight),o=Math.min(document.body.clientWidth,document.documentElement.clientWidth);Object.assign(t,{clientWidth:o,clientHeight:n});const[r,s]=e.split("-");return`${Yr(r,t)}-${es(s,t)}`})(w,{top:e,bottom:t,left:n,right:r,height:l,width:c});O!==u&&o(4,O=u),o(6,E=e),o(7,M=n),o(8,S=s),o(9,T=a)}return te((()=>{i&&_()})),ne((()=>{Jr()&&j()})),A=R,ee().$$.before_update.push(A),e.$$set=e=>{t=n(n({},t),f(e)),o(36,c=g(t,l)),"isOpen"in e&&o(17,y=e.isOpen),"updateOnScroll"in e&&o(19,b=e.updateOnScroll),"closeOnScroll"in e&&o(20,x=e.closeOnScroll),"position"in e&&o(18,w=e.position),"closeOnClickOutside"in e&&o(21,k=e.closeOnClickOutside),"zIndex"in e&&o(0,P=e.zIndex),"onWindowKeyDown"in e&&o(22,C=e.onWindowKeyDown),"style"in e&&o(1,L=e.style),"$$scope"in e&&o(25,p=e.$$scope)},e.$$.update=()=>{if(o(10,r=c.class||""),4&e.$$.dirty[0]&&o(23,s=!h||!!h.childNodes.length),8&e.$$.dirty[0]&&o(24,a=!v||!!v.childNodes.length),8388608&e.$$.dirty[0]&&!s)throw new Error("parent slot is required");if(16777216&e.$$.dirty[0]&&!a)throw new Error("content slot is required");25296896&e.$$.dirty[0]&&o(11,i=y&&s&&a)},[P,L,h,v,O,$,E,M,S,T,r,i,F,I,z,function(e){k&&i&&!D(e)&&z()},function(e){C&&i&&C(e,{isOpen:i,open:I,close:z,toggle:F,contains:D})},y,w,b,x,k,C,s,a,p,u,function(e){ae[e?"unshift":"push"]((()=>{h=e,o(2,h)}))},function(e){ae[e?"unshift":"push"]((()=>{v=e,o(3,v)}))},function(e){ae[e?"unshift":"push"]((()=>{$=e,o(5,$)}))}]}class cs extends Ie{constructor(e){super(),Fe(this,e,ls,is,i,{isOpen:17,updateOnScroll:19,closeOnScroll:20,position:18,closeOnClickOutside:21,zIndex:0,onWindowKeyDown:22,style:1},[-1,-1])}}function us(e){let t,o;const r=e[3].default,s=p(r,e,e[2],null);let a=[{href:e[0]},e[1]],i={};for(let e=0;e<a.length;e+=1)i=n(i,a[e]);return{c(){t=M("a"),s&&s.c(),D(t,i)},m(e,n){L(e,t,n),s&&s.m(t,null),o=!0},p(e,[n]){s&&s.p&&4&n&&m(s,r,e,e[2],n,null,null),D(t,i=function(e,t){const n={},o={},r={$$scope:1};let s=e.length;for(;s--;){const a=e[s],i=t[s];if(i){for(const e in a)e in i||(o[e]=1);for(const e in i)r[e]||(n[e]=i[e],r[e]=1);e[s]=i}else for(const e in a)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(a,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||(Le(s,e),o=!0)},o(e){Oe(s,e),o=!1},d(e){e&&O(t),s&&s.d(e)}}}function ps(e,t,o){const r=["href"];let s=g(t,r),{$$slots:a={},$$scope:i}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},s):s;return e.$$set=e=>{t=n(n({},t),f(e)),o(5,s=g(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,i=e.$$scope)},[l,c,i,a]}class ds extends Ie{constructor(e){super(),Fe(this,e,ps,us,i,{href:0})}}function ms(e){let t,n;return t=new cs({props:{position:"bottom-center",$$slots:{content:[xs,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[gs,({toggle:e})=>({11:e}),({toggle:e})=>e?2048:0]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};7210&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function fs(e){let t,n,o,r,i,l,c,u,p,d,m=e[2]&&ws();return c=new cs({props:{position:"bottom-center",isOpen:e[0],$$slots:{content:[Ps,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[ks]},$$scope:{ctx:e}}}),{c(){t=M("div"),n=S("svg"),o=S("circle"),r=j(),m&&m.c(),l=j(),_e(c.$$.fragment),z(o,"cx","50"),z(o,"cy","50"),z(o,"r","50"),z(n,"id","gt-plane"),z(n,"viewBox","0 0 100 100"),z(n,"xmlns","http://www.w3.org/2000/svg"),z(n,"class","svelte-1wx3a70"),z(t,"class","gramet-thumbnail svelte-1wx3a70"),B(t,"open",e[2])},m(s,a){L(s,t,a),C(t,n),C(n,o),C(t,r),m&&m.m(t,null),L(s,l,a),je(c,s,a),u=!0,p||(d=[$(i=Er.call(null,t,{ofp:e[3],pos:e[4].gramet,fl:e[4].fl})),F(t,"click",e[6])],p=!0)},p(e,n){e[2]?m||(m=ws(),m.c(),m.m(t,null)):m&&(m.d(1),m=null),i&&a(i.update)&&24&n&&i.update.call(null,{ofp:e[3],pos:e[4].gramet,fl:e[4].fl}),4&n&&B(t,"open",e[2]);const o={};1&n&&(o.isOpen=e[0]),5120&n&&(o.$$scope={dirty:n,ctx:e}),c.$set(o)},i(e){u||(Le(c.$$.fragment,e),u=!0)},o(e){Oe(c.$$.fragment,e),u=!1},d(e){e&&O(t),m&&m.d(),e&&O(l),Ae(c,e),p=!1,s(d)}}}function gs(e){let t,n,o;return{c(){t=M("button"),t.innerHTML='<svg class="gramet-error svelte-1wx3a70"><use xlink:href="#info-symbol"></use></svg>',z(t,"slot","parent"),z(t,"class","btn btn-light svelte-1wx3a70")},m(r,s){L(r,t,s),n||(o=F(t,"click",(function(){a(e[11])&&e[11].apply(this,arguments)})),n=!0)},p(t,n){e=t},d(e){e&&O(t),n=!1,o()}}}function hs(e){let t;return{c(){t=T("ogimet")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function vs(e){let t,n,o,r=0!==e[5].status&&bs(e);return{c(){t=M("p"),t.textContent="A certaines heures le site ogimet est saturé, il faut essayer 2 ou 3 fois en temporisant de 30 secondes à chaque essai.",n=j(),r&&r.c(),o=A()},m(e,s){L(e,t,s),L(e,n,s),r&&r.m(e,s),L(e,o,s)},p(e,t){0!==e[5].status?r?r.p(e,t):(r=bs(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(e){e&&O(t),e&&O(n),r&&r.d(e),e&&O(o)}}}function $s(t){let n;return{c(){n=M("p"),n.textContent="Le serveur ogimet indique qu'il est indisponible (no grib data). Sa mise à jour débute normalement à 00:00z et c'est long..."},m(e,t){L(e,n,t)},p:e,d(e){e&&O(n)}}}function ys(e){let t,n,o,r,s,a=e[5].text+"";return{c(){t=M("p"),n=T('Erreur construction route GRAMET: Station "'),o=M("code"),r=T(a),s=T("\" non reconnue par ogimet,\n                    merci de me remonter l'information pour que je corrige l'application. Inutile de réessayer.")},m(e,a){L(e,t,a),C(t,n),C(t,o),C(o,r),C(t,s)},p(e,t){32&t&&a!==(a=e[5].text+"")&&N(r,a)},d(e){e&&O(t)}}}function bs(e){let t,n,o,r,s=(e[5].text||e[5].status)+"";return{c(){t=M("p"),n=T("Pour information, le proxy a retourné: "),o=M("code"),r=T(s)},m(e,s){L(e,t,s),C(t,n),C(t,o),C(o,r)},p(e,t){32&t&&s!==(s=(e[5].text||e[5].status)+"")&&N(r,s)},d(e){e&&O(t)}}}function xs(e){let t,n,o,r,i,l,c,u,p,d,m,f,g,h,v,$;function y(e,t){return 409===e[5].status?ys:"no grib data"===e[5].text?$s:vs}m=new ds({props:{href:e[3].ogimetData.url,target:"_blank",$$slots:{default:[hs]},$$scope:{ctx:e}}});let b=y(e),x=b(e);return{c(){t=M("div"),n=M("div"),o=M("h3"),r=T("😱: Erreur de récupération du Gramet"),i=M("button"),i.innerHTML='<svg class="svelte-1wx3a70"><use xlink:href="#close-symbol"></use></svg>',l=j(),c=M("div"),u=M("p"),p=M("a"),p.textContent="essayez à nouveau",d=T(" ou allez sur "),_e(m.$$.fragment),f=T("."),g=j(),x.c(),z(i,"type","button"),z(i,"class","close svelte-1wx3a70"),z(i,"aria-label","Close"),z(o,"class","popover-header"),z(p,"href","."),z(c,"class","popover-body"),z(n,"class","popover"),z(n,"role","tooltip"),U(n,"max-width","330px"),z(t,"slot","content"),U(t,"width","330px")},m(s,y){L(s,t,y),C(t,n),C(n,o),C(o,r),C(o,i),C(n,l),C(n,c),C(c,u),C(u,p),C(u,d),je(m,u,null),C(u,f),C(c,g),x.m(c,null),h=!0,v||($=[F(i,"click",(function(){a(e[10])&&e[10].apply(this,arguments)})),F(p,"click",I(e[8]))],v=!0)},p(t,n){e=t;const o={};8&n&&(o.href=e[3].ogimetData.url),4096&n&&(o.$$scope={dirty:n,ctx:e}),m.$set(o),b===(b=y(e))&&x?x.p(e,n):(x.d(1),x=b(e),x&&(x.c(),x.m(c,null)))},i(e){h||(Le(m.$$.fragment,e),h=!0)},o(e){Oe(m.$$.fragment,e),h=!1},d(e){e&&O(t),Ae(m),x.d(),v=!1,s($)}}}function ws(e){let t,n;return{c(){t=S("svg"),n=S("use"),R(n,"xlink:href","#close-symbol"),z(t,"class","gramet-close svelte-1wx3a70")},m(e,o){L(e,t,o),C(t,n)},d(e){e&&O(t)}}}function ks(e){let t;return{c(){t=M("div"),z(t,"slot","parent"),z(t,"class","d-none")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Ps(e){let t,n,o,r,i,l,c,u,p,d,m;return{c(){t=M("div"),n=M("div"),o=M("h3"),r=T("Nouveau GRAMET disponible"),i=M("button"),i.innerHTML='<svg class="svelte-1wx3a70"><use xlink:href="#close-symbol"></use></svg>',l=j(),c=M("div"),u=M("p"),p=M("button"),p.textContent="Mettre à jour",z(i,"type","button"),z(i,"class","close svelte-1wx3a70"),z(i,"aria-label","Close"),z(o,"class","popover-header"),z(p,"class","btn btn-primary"),z(u,"class","text-center"),z(c,"class","popover-body"),z(n,"class","popover"),z(n,"role","tooltip"),U(n,"left","calc(-1rem - 35px)"),U(n,"max-width","290px"),U(n,"top","20px"),z(t,"slot","content"),U(t,"width","290px")},m(s,f){L(s,t,f),C(t,n),C(n,o),C(o,r),C(o,i),C(n,l),C(n,c),C(c,u),C(u,p),d||(m=[F(i,"click",(function(){a(e[10])&&e[10].apply(this,arguments)})),F(p,"click",e[7])],d=!0)},p(t,n){e=t},d(e){e&&O(t),d=!1,s(m)}}}function Cs(e){let t,n,o,r;const s=[fs,ms],a=[];function i(e,t){return"error"!==e[1]&&"reload"!==e[1]?0:"reload"!==e[1]?1:-1}return~(t=i(e))&&(n=a[t]=s[t](e)),{c(){n&&n.c(),o=A()},m(e,n){~t&&a[t].m(e,n),L(e,o,n),r=!0},p(e,[r]){let l=t;t=i(e),t===l?~t&&a[t].p(e,r):(n&&(Pe(),Oe(a[l],1,1,(()=>{a[l]=null})),Ce()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=s[t](e),n.c()),Le(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Le(n),r=!0)},o(e){Oe(n),r=!1},d(e){~t&&a[t].d(e),e&&O(o)}}}function Ls(e,t,n){let o,r,s,a,i;u(e,Lr,(e=>n(1,o=e))),u(e,pt,(e=>n(2,r=e))),u(e,ft,(e=>n(3,s=e))),u(e,Lt,(e=>n(4,a=e))),u(e,Or,(e=>n(5,i=e)));let l=!1;const c=async e=>{if("workbox-broadcast-update"===e.data.meta&&"CACHE_UPDATED"===e.data.type){const{updatedURL:t}=e.data.payload;t===s.ogimetData.proxyImg&&n(0,l=!0)}};navigator&&navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",c),ne((()=>{navigator&&navigator.serviceWorker&&navigator.serviceWorker.removeEventListener("message",c)}));return[l,o,r,s,a,i,()=>{"success"===o&&v(pt,r=!r,r)},async()=>{v(Lr,o="reload",o),v(pt,r=!1,r),n(0,l=!1),await de,v(Lr,o="loading",o)},()=>v(Lr,o="loading",o)]}class Os extends Ie{constructor(e){super(),Fe(this,e,Ls,Cs,i,{})}}function Es(e){let t;return{c(){t=M("p"),t.textContent="ETOPS",z(t,"class","etops svelte-cgn8wq")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Ms(t){let n,o,r,s,a,i,l,c,u,p,d,m,f,g,h,v,$,y,b,x=t[1].infos.flight+"",w=t[1].infos.departure+"",k=t[1].infos.destination+"",P=t[1].infos.date+"",E=t[1].infos.ofp.includes("/")?"":"ofp: ",_=t[1].infos.ofp+"",A=t[2]<20&&Es(),I=navigator&&navigator.share&&function(e){let t,n;return{c(){t=S("svg"),n=S("use"),R(n,"xlink:href","#share-symbol"),z(t,"class","svelte-cgn8wq")},m(e,o){L(e,t,o),C(t,n)},d(e){e&&O(t)}}}();return{c(){n=M("div"),A&&A.c(),o=j(),r=M("div"),s=M("p"),a=M("b"),i=T(x),l=j(),c=T(w),u=T("-"),p=T(k),d=j(),m=M("p"),f=T(P),g=j(),h=T(E),v=T(_),$=j(),I&&I.c(),z(s,"class","svelte-cgn8wq"),z(m,"class","svelte-cgn8wq"),z(r,"class","details svelte-cgn8wq"),z(n,"class","infos svelte-cgn8wq")},m(e,x){L(e,n,x),A&&A.m(n,null),C(n,o),C(n,r),C(r,s),C(s,a),C(a,i),C(s,l),C(s,c),C(s,u),C(s,p),C(r,d),C(r,m),C(m,f),C(m,g),C(m,h),C(m,v),C(m,$),I&&I.m(m,null),y||(b=F(n,"click",navigator&&navigator.share?t[0]:null),y=!0)},p(e,[t]){e[2]<20?A||(A=Es(),A.c(),A.m(n,o)):A&&(A.d(1),A=null),2&t&&x!==(x=e[1].infos.flight+"")&&N(i,x),2&t&&w!==(w=e[1].infos.departure+"")&&N(c,w),2&t&&k!==(k=e[1].infos.destination+"")&&N(p,k),2&t&&P!==(P=e[1].infos.date+"")&&N(f,P),2&t&&E!==(E=e[1].infos.ofp.includes("/")?"":"ofp: ")&&N(h,E),2&t&&_!==(_=e[1].infos.ofp+"")&&N(v,_)},i:e,o:e,d(e){e&&O(n),A&&A.d(),I&&I.d(),y=!1,b()}}}function*Ss(e,t){let n="";const o=e.infos.ralts;if(o.length>0)try{n=e.text.extract("ETOPS SUMMARY","SUMMARY-").replace(e.removePageFooterRegex,"")}catch(e){}const r=String.raw`(EEP\(\S{4}\)|ETP\S+|EXP\(\S{4}\))\s.+?EET (\d{2})\.(\d{2}) .+? ([\d.]+)\/EFOB ([\d.]+)(?:.+?(${o.join("|")})\s(\S+).+?\sREQ\s(\d{2})(\d{2})-(\d{2})(\d{2}))?`,s=new RegExp(r,"gm"),a=new Date(t),i=t-e.infos.takeoff;a.setUTCHours(0,0);const l=n.matchAll(s);for(let[,e,n,o,r,s,c,u,p,d,m,f]of l){const l=new Date(t.getTime()+36e5*parseInt(n,10)+6e4*parseInt(o,10)),g=Math.round(10*(parseFloat(s)-parseFloat(r)))/10,h=void 0!==p&&void 0!==d?new Date(a.getTime()+36e5*parseInt(p,10)+6e4*parseInt(d,10)+i):void 0,v=void 0!==m&&void 0!==f?new Date(a.getTime()+36e5*parseInt(m,10)+6e4*parseInt(f,10)+i):void 0;yield[e,l,parseFloat(r),parseFloat(s),g,c,u,h,v]}}function Ts(e,t,n){let o,r,s;u(e,ft,(e=>n(1,r=e))),u(e,ht,(e=>n(3,s=e)));const a=(e,t)=>{let n="";const o=e=>e.getUTCHours().toString().padStart(2,"0"),r=e=>e.getUTCMinutes().toString().padStart(2,"0"),s=[];for(const[a,i,,,l,c,u,p,d]of Ss(e,t)){let e,t;t=a.startsWith("ETP")?`**${a}** ${n}/${c}`:`**${a.substring(0,3)}**${a.substring(3)}`,e=`\n${t} ➔ ETO: **${o(i)}:${r(i)}** | ΔFUEL: **${l.toFixed(1)}**\n`,c&&(n=c,e+=`\n**Appui**: ${c} ${u} - Plage: **${o(p)}${r(p)}-${o(d)}${r(d)}**`),s.push(e)}return s};return e.$$.update=()=>{10&e.$$.dirty&&n(2,o=((e,t)=>{const n=[];for(const[,o,,r,s]of Ss(e,t))n.push([o,r,s]);if(n.length>1){const e=(n[0][1]-n[n.length-1][1])/(n[n.length-1][0]-n[0][0])*6e4;return Math.min(...n.map((t=>t[2]/e)))}return n.length>0?n[0][2]/8*60:180})(r,s))},[async()=>{const e={title:"OFP2MAP",text:JSON.stringify({...r.infos,text:r.text,"ofp2map-takeoff":s,etopsOutput:a(r,s)})};try{await navigator.share(e)}catch(e){}return!1},r,o,s]}class _s extends Ie{constructor(e){super(),Fe(this,e,Ts,Ms,i,{shareOFP:0})}get shareOFP(){return this.$$.ctx[0]}}function js(t){let n,o,r,a,i,l,c,u,p,d,m;return{c(){n=M("div"),o=S("svg"),r=S("use"),a=j(),i=M("label"),l=T("Heure de décollage"),c=j(),u=M("input"),R(r,"xlink:href","#takeoff-symbol"),z(o,"class","svelte-16mu92i"),B(o,"show",t[2]||t[3]>=0),B(o,"hide",!(t[2]||t[3]>=0)),z(i,"for",t[0]),z(i,"class","svelte-16mu92i"),z(u,"id",t[0]),z(u,"name",t[0]),z(u,"type","time"),u.value=p=t[4](t[1].getUTCHours(),t[1].getUTCMinutes()),z(u,"class","svelte-16mu92i"),z(n,"class","svelte-16mu92i")},m(e,s){L(e,n,s),C(n,o),C(o,r),C(n,a),C(n,i),C(i,l),C(n,c),C(n,u),d||(m=[F(o,"click",t[7]),$(rr.call(null,u)),F(u,"change",t[5])],d=!0)},p(e,[t]){12&t&&B(o,"show",e[2]||e[3]>=0),12&t&&B(o,"hide",!(e[2]||e[3]>=0)),1&t&&z(i,"for",e[0]),1&t&&z(u,"id",e[0]),1&t&&z(u,"name",e[0]),2&t&&p!==(p=e[4](e[1].getUTCHours(),e[1].getUTCMinutes()))&&(u.value=p)},i:e,o:e,d(e){e&&O(n),d=!1,s(m)}}}function As(e,t,n){let o,r,s,a,i;u(e,ft,(e=>n(6,r=e))),u(e,ht,(e=>n(8,s=e))),u(e,dt,(e=>n(2,a=e))),u(e,mt,(e=>n(3,i=e)));let{name:l="take-off"}=t;const c=(e,t)=>`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return e.$$set=e=>{"name"in e&&n(0,l=e.name)},e.$$.update=()=>{64&e.$$.dirty&&n(1,o=(e=>{const t=new Date(e.infos.datetime);return t.setUTCMinutes(t.getMinutes()+r.infos.taxitime),v(ht,s=t,s),t})(r))},[l,o,a,i,c,e=>{let t,n;""==e.target.value?(n=o.getUTCHours(),t=o.getUTCMinutes(),e.target.blur(),e.target.value=c(n,t)):(n=parseFloat(e.target.value.slice(0,2)),t=parseFloat(e.target.value.slice(3)));let r=new Date(o);r.setUTCMinutes(t),r.setUTCHours(n);const a=(r.getTime()-o.getTime())/6e4;a<-720?r=new Date(r.getTime()+864e5):a>720&&(r=new Date(r.getTime()-864e5)),v(ht,s=r,s),r.toISOString()!==o.toISOString()?e.target.classList.add("changed"):e.target.classList.remove("changed")},r,()=>v(dt,a=!a,a)]}class Fs extends Ie{constructor(e){super(),Fe(this,e,As,js,i,{name:0})}}function Is(e){let t;return{c(){t=M("li"),t.innerHTML='<a class="nav-link" href="#/map"><span class="svelte-s04fhf">CARTE</span></a>',z(t,"class","nav-item svelte-s04fhf"),B(t,"active","/map"===e[0])},m(e,n){L(e,t,n)},p(e,n){1&n&&B(t,"active","/map"===e[0])},d(e){e&&O(t)}}}function zs(e){let t;return{c(){t=M("li"),t.innerHTML='<a class="nav-link" href="#/export"><span class="svelte-s04fhf">EXPORT</span></a>',z(t,"class","nav-item svelte-s04fhf"),B(t,"active","/export"===e[0])},m(e,n){L(e,t,n)},p(e,n){1&n&&B(t,"active","/export"===e[0])},d(e){e&&O(t)}}}function Ds(e){let t,n,o,r,s,a="/map"===e[0]&&Rs();return n=new Fs({}),r=new _s({}),{c(){a&&a.c(),t=j(),_e(n.$$.fragment),o=j(),_e(r.$$.fragment)},m(e,i){a&&a.m(e,i),L(e,t,i),je(n,e,i),L(e,o,i),je(r,e,i),s=!0},p(e,n){"/map"===e[0]?a?1&n&&Le(a,1):(a=Rs(),a.c(),Le(a,1),a.m(t.parentNode,t)):a&&(Pe(),Oe(a,1,1,(()=>{a=null})),Ce())},i(e){s||(Le(a),Le(n.$$.fragment,e),Le(r.$$.fragment,e),s=!0)},o(e){Oe(a),Oe(n.$$.fragment,e),Oe(r.$$.fragment,e),s=!1},d(e){a&&a.d(e),e&&O(t),Ae(n,e),e&&O(o),Ae(r,e)}}}function Rs(e){let t,n;return t=new Os({}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Ws(e){let t,n,o,r,s,a,i,l,c,u,d,f,g,h,v,$,y,b,x=(e[1]||e[2]||"/map"===e[0])&&Is(e),w=(e[1]||"/export"===e[0])&&zs(e),k=e[1]&&Ds(e);const P=e[4].default,E=p(P,e,e[3],null);return{c(){t=M("nav"),n=M("input"),o=j(),r=M("label"),r.innerHTML='<span class="navbar-toggler-icon"></span>',s=j(),a=M("ul"),i=M("li"),l=M("a"),c=M("strong"),c.textContent="OFP2MAP ",u=S("svg"),d=S("use"),f=j(),x&&x.c(),g=j(),w&&w.c(),h=j(),v=M("li"),v.innerHTML='<a class="nav-link" href="#/help"><span class="svelte-s04fhf">AIDE</span></a>',$=j(),k&&k.c(),y=j(),E&&E.c(),z(n,"type","checkbox"),z(n,"id","menu"),z(n,"class","svelte-s04fhf"),z(r,"class","navbar-toggler"),z(r,"for","menu"),z(c,"class","d-none"),R(d,"xlink:href","#home-symbol"),z(u,"class","svelte-s04fhf"),z(l,"class","nav-link"),z(l,"href","#/"),z(i,"class","nav-item svelte-s04fhf"),B(i,"active","/"===e[0]),z(v,"class","nav-item svelte-s04fhf"),B(v,"active","/help"===e[0]),z(a,"class","navbar-nav collapse navbar-collapse svelte-s04fhf"),z(a,"id","navbarToggler"),z(t,"class","navbar navbar-expand-md navbar-light svelte-s04fhf")},m(e,p){L(e,t,p),C(t,n),C(t,o),C(t,r),C(t,s),C(t,a),C(a,i),C(i,l),C(l,c),C(l,u),C(u,d),C(a,f),x&&x.m(a,null),C(a,g),w&&w.m(a,null),C(a,h),C(a,v),C(t,$),k&&k.m(t,null),C(t,y),E&&E.m(t,null),b=!0},p(e,[n]){1&n&&B(i,"active","/"===e[0]),e[1]||e[2]||"/map"===e[0]?x?x.p(e,n):(x=Is(e),x.c(),x.m(a,g)):x&&(x.d(1),x=null),e[1]||"/export"===e[0]?w?w.p(e,n):(w=zs(e),w.c(),w.m(a,h)):w&&(w.d(1),w=null),1&n&&B(v,"active","/help"===e[0]),e[1]?k?(k.p(e,n),2&n&&Le(k,1)):(k=Ds(e),k.c(),Le(k,1),k.m(t,y)):k&&(Pe(),Oe(k,1,1,(()=>{k=null})),Ce()),E&&E.p&&8&n&&m(E,P,e,e[3],n,null,null)},i(e){b||(Le(k),Le(E,e),b=!0)},o(e){Oe(k),Oe(E,e),b=!1},d(e){e&&O(t),x&&x.d(),w&&w.d(),k&&k.d(),E&&E.d(e)}}}function Ns(e,t,n){let o,r,s;u(e,Pt,(e=>n(0,o=e))),u(e,ft,(e=>n(1,r=e))),u(e,$t,(e=>n(2,s=e)));let{$$slots:a={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(3,i=e.$$scope)},[o,r,s,i,a]}class qs extends Ie{constructor(e){super(),Fe(this,e,Ns,Ws,i,{})}}function Us(t){let n,o,r,s,a;return{c(){n=M("label"),o=T("Changer"),r=M("input"),z(r,"id",Ks),z(r,"name",Ks),z(r,"type","file"),z(r,"accept","application/pdf"),r.hidden=!0,z(n,"class","btn btn-outline-secondary btn-sm svelte-vs1fb2")},m(e,i){L(e,n,i),C(n,o),C(n,r),s||(a=F(r,"change",t[6]),s=!0)},p:e,d(e){e&&O(n),s=!1,a()}}}function Hs(e){let t,n,o,r,a,i,l;return{c(){t=M("div"),n=M("input"),o=j(),r=M("label"),a=T(e[1]),z(n,"id",Ks),z(n,"name",Ks),z(n,"type","file"),z(n,"accept","application/pdf"),n.disabled=e[0],z(n,"class","custom-file-input svelte-vs1fb2"),z(r,"class","custom-file-label text-truncate svelte-vs1fb2"),z(r,"for",Ks),B(r,"ready",e[2]),z(t,"class","custom-file svelte-vs1fb2"),B(t,"blink",!e[3])},m(s,c){L(s,t,c),C(t,n),C(t,o),C(t,r),C(r,a),i||(l=[F(n,"change",e[6]),F(n,"click",e[5],{once:!0})],i=!0)},p(e,o){1&o&&(n.disabled=e[0]),2&o&&N(a,e[1]),4&o&&B(r,"ready",e[2]),8&o&&B(t,"blink",!e[3])},d(e){e&&O(t),i=!1,s(l)}}}function Gs(t){let n,o,r,s;function a(e,t){return e[3]?Us:Hs}let i=a(t),l=i(t);return{c(){n=M("form"),l.c(),o=j(),z(n,"class","form-inline")},m(e,a){L(e,n,a),l.m(n,null),C(n,o),r||(s=F(n,"submit",I(t[9])),r=!0)},p(e,[t]){i===(i=a(e))&&l?l.p(e,t):(l.d(1),l=i(e),l&&(l.c(),l.m(n,o)))},i:e,o:e,d(e){e&&O(n),l.d(),r=!1,s()}}}const Bs=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.19.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.19.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"script",url:"https://unpkg.com/pinch-zoom-element-js@1.1.2/dist/pinch-zoom-min.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],Zs=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let Ks="file";function Vs(e,t,n){let o,r,s,a;u(e,pt,(e=>n(12,o=e))),u(e,gt,(e=>n(13,r=e))),u(e,ft,(e=>n(3,s=e))),u(e,vt,(e=>n(4,a=e)));let i,{kmlOptions:l}=t,c=!1,p=new ze,d="Choisir un OFP",m=!1;const f=oe();function g(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,a=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(a.crossOrigin="anonymous");let i=!0;s?(a.src=t,a.async=n.async,a.defer=n.defer):(a.href=t,"prefetch"in n?(a.rel="prefetch",o-=1,i=!1):"preload"in n?(a.rel="preload",o-=1,i=!1):(a.rel="stylesheet",o-=1,i=!1)),i&&(a.onload=r),document.body.appendChild(a)}))}(Bs,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",i&&!i.destroyed||(i=new e.PDFWorker),p.resolve(!0),n(2,m=!0)}))}const h=e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onload=e=>{if(!i||i.destroyed){const e=window["pdfjs-dist/build/pdf"];i=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Zs(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:i}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const s=editolido.ogimetData(t,r);s.proxyImg=`https://ofp2map-gramet.vercel.app/api/${s.proxy}__${s.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,s.route.description=s.wmo.join(" "),t.ogimetData=s;let a=0,i=t.infos.fl;const c=t.route.segments.map((([e,t])=>(a+=e.distanceTo(t),[t,a,i])));c.unshift([t.route.points[0],0]),t.distanceMatrix=c;let u=[];try{u=t.wptNamesEET(t.route.points)}catch(e){}0===u.length?document.body.style.setProperty("--plane-halo-color","red"):document.body.style.setProperty("--plane-halo-color","var(--plane-color)"),t.timeMatrix=u;try{zt(),function(e,t){let n={...Ft,...t};const o=zt();It(o,n);const r=e.description;if(o.setName(r),!e)return;const s=`${e.infos.departure}-${e.infos.destination}`,a=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),i=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",a),o.addPoints("rmain",a,{excluded:c}),o.addLine("ralt",i),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",i)}(t,l),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error("OFP non reconnu. Attention il y a 2 OFP dans PilotMission, il faut bien choisir celui nommé « Dossier de vol OFP »."))}),(e=>{o(e)}))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(8,l=e.kmlOptions)},[c,d,m,s,a,g,async function(e){n(0,c=!0),v(pt,o=!1,o),g(),await p.promise.then((()=>{const t=e.target.files[0],o=e.target.closest("form");t&&(v(gt,r="loading",r),n(1,d=e.target.value.split(/([\\/])/g).pop()),f("change",d),h(t).then((t=>{v(ft,s=t,s),v(vt,a=void 0,a),v(gt,r="success",r),o.blur(),e.target.blur(),o.reset()}),(e=>{v(gt,r=e,r),v(ft,s=void 0,s),o.reset()})),window.location.hash="#/map")})),n(0,c=!1)},async function(e){n(0,c=!0),v(gt,r="loading",r),g(),await p.promise.then((()=>{v(ft,s=void 0,s);try{zt(),v(vt,a=e.target.value,a),v(gt,r="success",r)}catch(e){v(gt,r=e,r)}window.location.hash="#/map"})),n(0,c=!1)},l,function(t){re(e,t)},e=>!st.includes(e)]}class Qs extends Ie{constructor(e){super(),Fe(this,e,Vs,Gs,i,{kmlOptions:8})}}function Xs(n){let o,r,s;const i=n[3].default,l=p(i,n,n[2],null);return{c(){o=M("page"),l&&l.c(),z(o,"class","svelte-1de5e3b"),B(o,"fadein",!1===n[0]),B(o,"d-none",!0===n[0])},m(e,t){L(e,o,t),l&&l.m(o,null),s=!0},p(e,[t]){l&&l.p&&4&t&&m(l,i,e,e[2],t,null,null),1&t&&B(o,"fadein",!1===e[0]),1&t&&B(o,"d-none",!0===e[0])},i(i){s||(Le(l,i),r||me((()=>{r=function(n,o,r){let s,i,l=o(n,r),c=!1,u=0;function p(){s&&J(n,s)}function d(){const{delay:o=0,duration:r=300,easing:a=t,tick:d=e,css:m}=l||Ee;m&&(s=X(n,0,1,r,o,a,m,u++)),d(0,1);const f=b()+o,g=f+r;i&&i.abort(),c=!0,me((()=>xe(n,!0,"start"))),i=P((e=>{if(c){if(e>=g)return d(1,0),xe(n,!0,"end"),p(),c=!1;if(e>=f){const t=a((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(J(n),a(l)?(l=l(),be().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),s=!0)},o(e){Oe(l,e),s=!1},d(e){e&&O(o),l&&l.d(e)}}}function Js(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return Je(e,t)},r,o]}class Ys extends Ie{constructor(e){super(),Fe(this,e,Js,Xs,i,{hidden:0})}}function ea(t){let n,o;return{c(){n=T(t[1]),o=T(".com")},m(e,t){L(e,n,t),L(e,o,t)},p:e,d(e){e&&O(n),e&&O(o)}}}function ta(e){let t;return{c(){t=T("ogimet.com")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function na(e){let t;return{c(){t=T("Guide d'interprétation")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function oa(e){let t;return{c(){t=T("liste des commits")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function ra(e){let t;return{c(){t=T("Equal Earth")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function sa(t){let n,o;return{c(){n=T(t[1]),o=T(".com")},m(e,t){L(e,n,t),L(e,o,t)},p:e,d(e){e&&O(n),e&&O(o)}}}function aa(e){let t;return{c(){t=T("l'app")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function ia(e){let t;return{c(){t=T("le proxy")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function la(e){let t;return{c(){t=M("span"),t.innerHTML="Fly<span>Tax</span>",z(t,"class","flytax")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function ca(e){let t,n,o,r,s,a,i,l,c,u,p,d,m,f,g,h,v,$,y,b,x,w,k,P,E,S,_,A,F,I,D,R,W,N,q,U,H,G,B,Z,K,V,Q,X,J,Y,ee,te,ne,oe,re,se,ae,ie,le,ce,ue,pe,de,me,fe,ge,he,ve,$e,ye,be,xe,we,ke,Pe,Ce,Ee,Me,Se,Te,Fe,Ie,ze,De,Re,We,Ne,qe,Ue,He,Ge,Be,Ze,Ke,Ve,Qe,Xe,Je,Ye,et,tt,nt,ot,rt,st,at,it,lt,ct,ut,pt,dt,mt,ft,gt,ht,vt,$t,yt,bt,xt,wt,kt,Pt,Ct,Lt,Ot,Et,Mt,St,Tt,_t,jt,At,Ft,It,zt,Dt,Rt,Wt,Nt,qt,Ut,Ht,Gt,Bt=window.atob("VmluY2VudCBCb3NzeQ==")+"";H=new ds({props:{href:`https://www.${e[1].toLowerCase()}.com`,$$slots:{default:[ea]},$$scope:{ctx:e}}});let Zt=!0!==navigator.standalone&&function(e){let t,n,o;return{c(){t=T("Pour mémoire, dans un navigateur, il suffit de partager l'url ou "),n=M("a"),n.textContent="ce lien",o=T("."),z(n,"href","http://flyingeek.github.io/lido-online/index.html")},m(e,r){L(e,t,r),L(e,n,r),L(e,o,r)},d(e){e&&O(t),e&&O(n),e&&O(o)}}}();return fe=new ds({props:{href:e[0],$$slots:{default:[ta]},$$scope:{ctx:e}}}),xe=new ds({props:{href:"http://www.ogimet.com/guia_gramet.phtml.en",$$slots:{default:[na]},$$scope:{ctx:e}}}),ot=new ds({props:{href:"https://github.com/flyingeek/lido-online/commits/master",$$slots:{default:[oa]},$$scope:{ctx:e}}}),mt=new ds({props:{href:"https://equal-earth.com/physical/",$$slots:{default:[ra]},$$scope:{ctx:e}}}),yt=new ds({props:{href:`https://www.${e[1].toLowerCase()}.com`,$$slots:{default:[sa]},$$scope:{ctx:e}}}),Tt=new ds({props:{href:"https://github.com/flyingeek/lido-online",$$slots:{default:[aa]},$$scope:{ctx:e}}}),jt=new ds({props:{href:"https://github.com/flyingeek/ofp2map-gramet",$$slots:{default:[ia]},$$scope:{ctx:e}}}),Ut=new ds({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[la]},$$scope:{ctx:e}}}),{c(){t=M("h2"),t.textContent="Préambule",n=j(),o=M("p"),o.textContent="OFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l'écran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie.",r=j(),s=M("p"),s.textContent="OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.",a=j(),i=M("p"),i.textContent="L'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L'app ne collecte aucune donnée.",l=j(),c=M("h2"),c.textContent="Utilisation",u=j(),p=M("ol"),d=M("li"),d.innerHTML="<p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner.</p>",m=j(),f=M("li"),f.innerHTML='<p><figure><img src="./images/layers-settings.webp" alt="layers settings help"/><figcaption>Réglages des calques</figcaption></figure>La carte dispose d&#39;un bouton pour personnaliser les calques et les couleurs. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP. Pour vous entrainer, je vous recommande de modifier la couleur des terrains en vert/rouge et de sauvegarder votre choix.</p>',g=j(),h=M("li"),h.innerHTML="<p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p>",v=j(),$=M("li"),y=M("p"),y.textContent=`La carte par défaut dépend de la distance: ${e[1]} 2020, puis Mercator jusqu'à 1500nm puis LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur d'autres projections.`,b=j(),x=M("ul"),w=M("li"),w.textContent="LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40",k=j(),P=M("li"),P.textContent="LAMBERT SOUTH & PACIFIC (sécants N30 et S15 ) sont recommandées sous N30",E=j(),S=M("li"),S.textContent="THE WORLD permet de disposer d'un Atlas off-line, c'est une projection Times",_=j(),A=M("li"),A.textContent="MERCATOR est une Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line",F=j(),I=M("li"),I.textContent="=Physique= est un Atlas physique basé sur une projection Equal Earth (qui montre les continents et les pays à leur taille réelle) avec des étiquettes en français (par Tom Patterson).",D=j(),R=M("li"),W=T(e[1]),N=T(" 2020 est une carte VFR, elle couvre France/Belgique/Luxembourg/Suisse et "),q=T(Bt),U=T(" a autorisé son utilisation. Sur cette carte, déjà très dense en informations, la route Gramet, l'orthodromie et les FIR sont désactivées. La dernière version est disponible sur "),_e(H.$$.fragment),G=T("."),B=j(),Z=M("ol"),Z.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. <strong>Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts</strong>. Si vous activez le bouton de géolocalisation, la carte peut se centrer automatiquement.</li>",K=j(),V=M("h2"),V.textContent="Mémo visuel",Q=j(),X=M("p"),X.innerHTML='<img src="./images/map-help.webp" alt="map help" title="Aide Carte"/>',J=j(),Y=M("h2"),Y.textContent="Particularités de l'iPad",ee=j(),te=M("p"),te.textContent="OFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.",ne=j(),oe=M("p"),re=T("Pour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. "),Zt&&Zt.c(),se=j(),ae=M("p"),ae.innerHTML='L&#39;export des fichiers KML affiche une page un peu particulière, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share-symbol"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. Alternativement, vous pouvez utiliser « Options... » pour définir une app qui recevra les fichiers kml par défaut et utiliser Ouvrir dans « nom de l&#39;app ».',ie=j(),le=M("p"),le.textContent="À noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",ce=j(),ue=M("h2"),ue.textContent="GRAMET",pe=j(),de=M("p"),me=T("Le GRAMET est un météogramme représentant le temps et l'espace. Il indique, en tout point de la route, et à l'heure de passage estimée, une coupe verticale de la météo prévue.\nLe GRAMET est réalisé par "),_e(fe.$$.fragment),ge=T(" à partir d'une route calculée. Il est possible d'afficher le GRAMET et sa route sur la carte. La route est particulièrement utile lors des vols océaniques car il n'y a aucune station en mer.\nPour construire la route du GRAMET, on utilise non pas les waypoints, mais au plus 21 stations météo (WMO). Il y a au total 13000 WMO dans le monde. Le GRAMET débute toujours à l'heure hh:00. Pour un decollage à 19h30, il débutera à 19h, pour un décollage à 19h31, il débutera à 20h. Pour les OFP anciens, c'est l'heure actuelle qui est envoyée. En mode déconnecté, OFP2MAP utilise la version du GRAMET qu'il a mis en cache pendant 48h. Après l'heure de décollage initialement prévue, vous pouvez forcer une mise à jour, soit en rechargeant l'ofp, soit en changeant brièvement de page."),he=j(),ve=M("p"),ve.textContent="Pour afficher le Gramet, cliquez sur sa miniature à gauche de l'OFP. Pour afficher la route, direction le réglage des calques de la carte. Par défaut elle est affichée en bleu. En fonction de l'heure de décollage (modifiable), le Gramet et sa miniature affichent la position avion. Avant l'horaire prévu de décollage, un bouton play permet de lancer une animation.",$e=j(),ye=M("p"),be=T("Pour mieux comprendre le GRAMET, je vous conseille son "),_e(xe.$$.fragment),we=T("."),ke=j(),Pe=M("h2"),Pe.textContent="Position avion",Ce=j(),Ee=M("p"),Ee.textContent="Il est possible d'afficher la position avion sur la carte (bouton en forme de mire). Si vous l'autorisez, la position GPS sera prise en compte. Si la localisation GPS semble ne pas fonctionner (au sol ou en vol avec un gps externe), vérifiez que vous n'avez pas désactivé la localisation dans iPad / Réglages / Confidentialité / Service de localisation / Sites Safari. Vous devez choisir «Lorsque l'app est active» ou «Demander la prochaine fois».",Me=j(),Se=M("p"),Se.textContent="En l'absence de GPS, l'avion dans la barre de menu (à gauche de l'heure de décollage) permet d'afficher la position estimée. Si la reconnaissance des waypoints s'est bien effectuée, les estimées de l'OFP seront prises en compte. Sinon, ce sera un simple ratio horaire, merci de me transmettre l'OFP dans ce cas (ce sera signalé par un avion rouge dans la barre de menu). L'heure de décollage est modifiable et permet toujours d'ajuster la position estimée.",Te=j(),Fe=M("h2"),Fe.textContent="Mode off-line",Ie=j(),ze=M("p"),ze.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.",De=j(),Re=M("p"),Re.textContent=`Il existe aussi un bouton de mise en cache : le pictogramme ↓ situé à droite du sélecteur de carte. Sur les cartes LAMBERT, THE WORLD, =Physique= et ${e[1]}, il mettra en cache la totalité de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache.`,We=j(),Ne=M("p"),Ne.textContent=`Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent : 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH, 32Mo pour THE WORLD, 40Mo pour =Physique= et 40Mo pour ${e[1]}.`,qe=j(),Ue=M("h2"),Ue.textContent="ETOPS",He=j(),Ge=M("p"),Ge.textContent="La capacité ETOPS est determinée depuis l'OFP et les cercles sont tracés. Un drapeau ETOPS apparait dans le pavé d'information de l'OFP si le carburant est limitatif (20mn, soit environ 2T de marge sur 777). Pour avoir plus d'informations vous pouvez utiliser un plugin (voir ci-dessous).",Be=j(),Ze=M("h2"),Ze.textContent="Plugins (Raccourcis)",Ke=j(),Ve=M("p"),Ve.innerHTML='Sur iOS, OFP2MAP permet de lancer des raccourcis. Il est possible d&#39;exporter la route au format KML depuis le menu EXPORT mais il est aussi possible de lancer des raccourcis ayant accès au contenu de l&#39;OFP depuis le pavé d&#39;informations du vol dans la barre de menu. Un exemple de plugin est le <a href="https://www.icloud.com/shortcuts/85acce199353490c9f3a3db0618da19e">cartouche ETOPS</a> qu&#39;il faut au préalable installer dans l&#39;app Raccourcis. Si vous souhaitez créer un plugin, <a href="https://www.icloud.com/shortcuts/d484cdf5939b4cb2a54535ae94c371d1">OFP2MAP-PLUGIN</a> permet de visualiser les données (format json) transmises par OFP2MAP.',Qe=j(),Xe=M("h2"),Xe.textContent="Mise à jour",Je=j(),Ye=M("p"),Ye.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",et=j(),tt=M("p"),nt=T("Pour connaître les dernières nouveautés d'OFP2MAP, je poste dans Yammer/Mapsme et Teams/MyConcorde. En attendant une solution plus conviviale, vous pouvez aussi consulter la "),_e(ot.$$.fragment),rt=T(' sur GitHub (ce n\'est pas "user friendly").'),st=j(),at=M("h2"),at.textContent="Crédits",it=j(),lt=M("ul"),ct=M("li"),ct.textContent="Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme",ut=j(),pt=M("li"),dt=T("=Physique= est une carte de Tom Patterson disponible sur "),_e(mt.$$.fragment),ft=j(),gt=M("li"),ht=T("La dernière version de la carte "),vt=T(e[1]),$t=T(" est disponible sur le site "),_e(yt.$$.fragment),bt=j(),xt=M("li"),xt.textContent="Les autres cartes sont de Jean-Baptiste Denizot forum Yammer/QGIS & Avenza Maps",wt=j(),kt=M("li"),kt.textContent="Le GRAMET provient du site ogimet.com",Pt=j(),Ct=M("li"),Ct.textContent="Le site est développé en javascript à l'aide du framework SVELTE",Lt=j(),Ot=M("li"),Ot.textContent="La partie serveur (un proxy pour pouvoir récupérer l'image du GRAMET) est en python.",Et=j(),Mt=M("li"),St=T("Eric Delord CDB 777 est l'auteur. Le code source est disponible sur GitHub pour "),_e(Tt.$$.fragment),_t=T(" et "),_e(jt.$$.fragment),At=j(),Ft=M("h2"),Ft.textContent="Hébergement",It=j(),zt=M("p"),zt.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",Dt=j(),Rt=M("h2"),Rt.textContent="Liens",Wt=j(),Nt=M("ul"),qt=M("li"),_e(Ut.$$.fragment),Ht=T(" une aide aux calculs des frais professionnels (même auteur)."),z(Z,"start","5")},m(e,O){L(e,t,O),L(e,n,O),L(e,o,O),L(e,r,O),L(e,s,O),L(e,a,O),L(e,i,O),L(e,l,O),L(e,c,O),L(e,u,O),L(e,p,O),C(p,d),C(p,m),C(p,f),C(p,g),C(p,h),C(p,v),C(p,$),C($,y),C($,b),C($,x),C(x,w),C(x,k),C(x,P),C(x,E),C(x,S),C(x,_),C(x,A),C(x,F),C(x,I),C(x,D),C(x,R),C(R,W),C(R,N),C(R,q),C(R,U),je(H,R,null),C(R,G),L(e,B,O),L(e,Z,O),L(e,K,O),L(e,V,O),L(e,Q,O),L(e,X,O),L(e,J,O),L(e,Y,O),L(e,ee,O),L(e,te,O),L(e,ne,O),L(e,oe,O),C(oe,re),Zt&&Zt.m(oe,null),L(e,se,O),L(e,ae,O),L(e,ie,O),L(e,le,O),L(e,ce,O),L(e,ue,O),L(e,pe,O),L(e,de,O),C(de,me),je(fe,de,null),C(de,ge),L(e,he,O),L(e,ve,O),L(e,$e,O),L(e,ye,O),C(ye,be),je(xe,ye,null),C(ye,we),L(e,ke,O),L(e,Pe,O),L(e,Ce,O),L(e,Ee,O),L(e,Me,O),L(e,Se,O),L(e,Te,O),L(e,Fe,O),L(e,Ie,O),L(e,ze,O),L(e,De,O),L(e,Re,O),L(e,We,O),L(e,Ne,O),L(e,qe,O),L(e,Ue,O),L(e,He,O),L(e,Ge,O),L(e,Be,O),L(e,Ze,O),L(e,Ke,O),L(e,Ve,O),L(e,Qe,O),L(e,Xe,O),L(e,Je,O),L(e,Ye,O),L(e,et,O),L(e,tt,O),C(tt,nt),je(ot,tt,null),C(tt,rt),L(e,st,O),L(e,at,O),L(e,it,O),L(e,lt,O),C(lt,ct),C(lt,ut),C(lt,pt),C(pt,dt),je(mt,pt,null),C(lt,ft),C(lt,gt),C(gt,ht),C(gt,vt),C(gt,$t),je(yt,gt,null),C(lt,bt),C(lt,xt),C(lt,wt),C(lt,kt),C(lt,Pt),C(lt,Ct),C(lt,Lt),C(lt,Ot),C(lt,Et),C(lt,Mt),C(Mt,St),je(Tt,Mt,null),C(Mt,_t),je(jt,Mt,null),L(e,At,O),L(e,Ft,O),L(e,It,O),L(e,zt,O),L(e,Dt,O),L(e,Rt,O),L(e,Wt,O),L(e,Nt,O),C(Nt,qt),je(Ut,qt,null),C(qt,Ht),Gt=!0},p(e,[t]){const n={};8&t&&(n.$$scope={dirty:t,ctx:e}),H.$set(n);const o={};1&t&&(o.href=e[0]),8&t&&(o.$$scope={dirty:t,ctx:e}),fe.$set(o);const r={};8&t&&(r.$$scope={dirty:t,ctx:e}),xe.$set(r);const s={};8&t&&(s.$$scope={dirty:t,ctx:e}),ot.$set(s);const a={};8&t&&(a.$$scope={dirty:t,ctx:e}),mt.$set(a);const i={};8&t&&(i.$$scope={dirty:t,ctx:e}),yt.$set(i);const l={};8&t&&(l.$$scope={dirty:t,ctx:e}),Tt.$set(l);const c={};8&t&&(c.$$scope={dirty:t,ctx:e}),jt.$set(c);const u={};8&t&&(u.$$scope={dirty:t,ctx:e}),Ut.$set(u)},i(e){Gt||(Le(H.$$.fragment,e),Le(fe.$$.fragment,e),Le(xe.$$.fragment,e),Le(ot.$$.fragment,e),Le(mt.$$.fragment,e),Le(yt.$$.fragment,e),Le(Tt.$$.fragment,e),Le(jt.$$.fragment,e),Le(Ut.$$.fragment,e),Gt=!0)},o(e){Oe(H.$$.fragment,e),Oe(fe.$$.fragment,e),Oe(xe.$$.fragment,e),Oe(ot.$$.fragment,e),Oe(mt.$$.fragment,e),Oe(yt.$$.fragment,e),Oe(Tt.$$.fragment,e),Oe(jt.$$.fragment,e),Oe(Ut.$$.fragment,e),Gt=!1},d(e){e&&O(t),e&&O(n),e&&O(o),e&&O(r),e&&O(s),e&&O(a),e&&O(i),e&&O(l),e&&O(c),e&&O(u),e&&O(p),Ae(H),e&&O(B),e&&O(Z),e&&O(K),e&&O(V),e&&O(Q),e&&O(X),e&&O(J),e&&O(Y),e&&O(ee),e&&O(te),e&&O(ne),e&&O(oe),Zt&&Zt.d(),e&&O(se),e&&O(ae),e&&O(ie),e&&O(le),e&&O(ce),e&&O(ue),e&&O(pe),e&&O(de),Ae(fe),e&&O(he),e&&O(ve),e&&O($e),e&&O(ye),Ae(xe),e&&O(ke),e&&O(Pe),e&&O(Ce),e&&O(Ee),e&&O(Me),e&&O(Se),e&&O(Te),e&&O(Fe),e&&O(Ie),e&&O(ze),e&&O(De),e&&O(Re),e&&O(We),e&&O(Ne),e&&O(qe),e&&O(Ue),e&&O(He),e&&O(Ge),e&&O(Be),e&&O(Ze),e&&O(Ke),e&&O(Ve),e&&O(Qe),e&&O(Xe),e&&O(Je),e&&O(Ye),e&&O(et),e&&O(tt),Ae(ot),e&&O(st),e&&O(at),e&&O(it),e&&O(lt),Ae(mt),Ae(yt),Ae(Tt),Ae(jt),e&&O(At),e&&O(Ft),e&&O(It),e&&O(zt),e&&O(Dt),e&&O(Rt),e&&O(Wt),e&&O(Nt),Ae(Ut)}}}function ua(e,t,n){let o,r;u(e,ft,(e=>n(2,r=e)));const s=window.atob("Q2FydGFCb3NzeQ==");return e.$$.update=()=>{4&e.$$.dirty&&n(0,o=r?r.ogimetData.url:"http://www.ogimet.com")},[o,s,r]}class pa extends Ie{constructor(e){super(),Fe(this,e,ua,ca,i,{})}}function da(t){let n,o,r,s,a=navigator.share&&function(t){let n,o,r;return{c(){n=M("button"),n.textContent="Partager l'App",z(n,"class","btn btn-outline-secondary btn-sm svelte-ubla")},m(e,t){L(e,n,t),o||(r=F(n,"click",Qe),o=!0)},p:e,d(e){e&&O(n),o=!1,r()}}}();return{c(){a&&a.c(),n=j(),o=M("button"),o.textContent="Recharger l'App",z(o,"class","btn btn-outline-secondary btn-sm svelte-ubla")},m(e,i){a&&a.m(e,i),L(e,n,i),L(e,o,i),r||(s=F(o,"click",t[2]),r=!0)},p(e,t){navigator.share&&a.p(e,t)},d(e){a&&a.d(e),e&&O(n),e&&O(o),r=!1,s()}}}function ma(e){let t,n,o,r,s,a,i,l,c,u,p,d,m,f,g,h=!0===navigator.standalone&&da(e);return d=new pa({}),{c(){t=M("div"),n=M("h1"),o=M("div"),o.innerHTML='<img src="images/ofp2map-icons/icon-128x128.png" alt="logo" class="svelte-ubla"/><span class="svelte-ubla">OFP2MAP</span>',r=T(" v"),s=T(fa),a=j(),i=M("small"),l=T("/ ServiceWorker : "),c=T(e[1]),u=j(),h&&h.c(),p=j(),_e(d.$$.fragment),z(o,"class","app svelte-ubla"),z(i,"class","svelte-ubla"),z(n,"class","svelte-ubla"),z(t,"class","markdown svelte-ubla")},m(v,$){L(v,t,$),C(t,n),C(n,o),C(n,r),C(n,s),C(n,a),C(n,i),C(i,l),C(i,c),C(n,u),h&&h.m(n,null),C(t,p),je(d,t,null),m=!0,f||(g=F(i,"click",e[3],{once:!0}),f=!0)},p(e,[t]){(!m||2&t)&&N(c,e[1]),!0===navigator.standalone&&h.p(e,t)},i(e){m||(Le(d.$$.fragment,e),m=!0)},o(e){Oe(d.$$.fragment,e),m=!1},d(e){e&&O(t),h&&h.d(),Ae(d),f=!1,g()}}}const fa="1.11.1";function ga(e,t,n){let o;u(e,at,(e=>n(0,o=e)));let r="";return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=o)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,r=e)))},[o,r,()=>{window.location.hash="#/",window.location.reload()},()=>o&&o.update()&&void 0]}class ha extends Ie{constructor(e){super(),Fe(this,e,ga,ma,i,{})}}function va(e){let t,n,o,r,a,i,l,c,u,p,d,m,f,g,h,v;return{c(){t=M("div"),n=M("div"),o=M("strong"),o.innerHTML='<span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour disponible',r=j(),a=M("button"),a.innerHTML='<span aria-hidden="true">×</span>',i=j(),l=M("div"),c=M("p"),c.textContent="Il faudra recharger l'OFP",u=j(),p=M("button"),d=M("span"),m=T(e[1]),z(o,"class","svelte-395rpc"),z(a,"type","button"),z(a,"class","close svelte-395rpc"),z(a,"aria-label","Close"),z(n,"class","toast-header svelte-395rpc"),z(d,"class","svelte-395rpc"),B(d,"blinking",e[1].endsWith("...")),z(p,"class","btn btn-primary"),z(p,"type","button"),z(l,"class","toast-body text-center"),z(t,"class","toast svelte-395rpc"),U(t,"position","fixed"),U(t,"top","0"),U(t,"right","0")},m(s,f){L(s,t,f),C(t,n),C(n,o),C(n,r),C(n,a),C(t,i),C(t,l),C(l,c),C(l,u),C(l,p),C(p,d),C(d,m),g=!0,h||(v=[F(a,"click",e[6]),F(p,"click",e[7],{once:!0})],h=!0)},p(e,t){(!g||2&t)&&N(m,e[1]),2&t&&B(d,"blinking",e[1].endsWith("..."))},i(e){g||(me((()=>{f||(f=Me(t,Je,{},!0)),f.run(1)})),g=!0)},o(e){f||(f=Me(t,Je,{},!1)),f.run(0),g=!1},d(e){e&&O(t),e&&f&&f.end(),h=!1,s(v)}}}function $a(t){let n,o,r,s,a,i,l,c,u,p,d=(t[4](700)||"")+"";return{c(){n=M("div"),o=M("div"),r=M("div"),r.innerHTML='<strong class="svelte-395rpc"><span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour détectée</strong>',s=j(),a=M("div"),i=M("button"),i.innerHTML="<span>Mise à jour...</span>",l=j(),c=T(d),z(r,"class","toast-header svelte-395rpc"),z(i,"class","btn"),z(i,"type","button"),z(a,"class","toast-body text-center"),z(o,"class","toast svelte-395rpc"),z(n,"class","modal svelte-395rpc")},m(e,d){L(e,n,d),C(n,o),C(o,r),C(o,s),C(o,a),C(a,i),C(n,l),L(e,c,d),u||(p=F(i,"click",I(t[5])),u=!0)},p:e,i:e,o:e,d(e){e&&O(n),e&&O(c),u=!1,p()}}}function ya(e){let t,n,o,r;const s=[$a,va],a=[];function i(e,t){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:-1:0}return~(t=i(e))&&(n=a[t]=s[t](e)),{c(){n&&n.c(),o=A()},m(e,n){~t&&a[t].m(e,n),L(e,o,n),r=!0},p(e,[r]){let l=t;t=i(e),t===l?~t&&a[t].p(e,r):(n&&(Pe(),Oe(a[l],1,1,(()=>{a[l]=null})),Ce()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=s[t](e),n.c()),Le(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Le(n),r=!0)},o(e){Oe(n),r=!1},d(e){~t&&a[t].d(e),e&&O(o)}}}const ba=nt(),xa=e=>{lt.set(!0),it.set(!1),e?ct.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.11.1",e)):ct.set(!0)};function wa(t,n,o){let r,s,a,i,l=e;u(t,it,(e=>o(2,r=e))),u(t,at,(e=>o(8,s=e))),u(t,ba,(e=>o(9,a=e))),u(t,lt,(e=>o(3,i=e))),t.$$.on_destroy.push((()=>l()));let c="Installer";v(it,r=!1,r);let{prompt:p=!1}=n;const d=(e=0)=>{let t;s&&a&&a.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,c="En cours..."),a.waiting.postMessage({type:"SKIP_WAITING"})):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,p=e.prompt)},[p,c,r,i,d,function(e){re(t,e)},()=>v(it,r=!0,r),()=>d()]}class ka extends Ie{constructor(e){super(),Fe(this,e,wa,ya,i,{prompt:0})}}function Pa(e){let t;return{c(){t=M("ol"),t.innerHTML='<li class="svelte-3tetng">Dans la barre de menu, cliquez sur <svg class="svelte-3tetng"><use xlink:href="#share-symbol"></use></svg></li> \n                    <li class="svelte-3tetng">Faites défiler, choisir : <em>Sur l&#39;écran d&#39;accueil</em>  <svg style="width:22px;height:22px;" class="svelte-3tetng"><use xlink:href="#add2home-symbol"></use></svg></li> \n                    <li class="svelte-3tetng">Lancez l&#39;application depuis l&#39;écran d&#39;accueil</li>',z(t,"class","guide svelte-3tetng")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Ca(e){let t;return{c(){t=M("p"),t.textContent="Merci d'ouvrir cette page dans Safari",z(t,"class","guide error svelte-3tetng")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function La(t){let n,o,r,s,a,i,l,c,u,p,d,m,f,g;n=new fn({});let h=function(e,t){return e[0]?Pa:Ca}(t)(t);return f=new ka({}),{c(){_e(n.$$.fragment),o=j(),r=M("div"),s=M("div"),a=M("div"),a.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-3tetng"/>',i=j(),l=M("div"),c=M("h3"),c.textContent="Installez OFP2MAP",u=j(),p=M("p"),p.innerHTML='Si OFP2MAP est déjà sur l&#39;écran d&#39;accueil, ne l&#39;installez pas une deuxième fois. <b>Attention:</b> l&#39;installation ne peut se faire que depuis\n                le navigateur Safari, <b>si présent, cliquez sur <svg class="safari svelte-3tetng"><use xlink:href="#safari-symbol"></use></svg> en haut à droite</b>.',d=j(),h.c(),m=j(),_e(f.$$.fragment),z(a,"class","icon-container svelte-3tetng"),z(c,"class","title svelte-3tetng"),z(p,"class","text svelte-3tetng"),z(l,"class","prompt-content svelte-3tetng"),z(s,"class","prompt svelte-3tetng"),z(r,"class","prompt-container svelte-3tetng")},m(e,t){je(n,e,t),L(e,o,t),L(e,r,t),C(r,s),C(s,a),C(s,i),C(s,l),C(l,c),C(l,u),C(l,p),C(l,d),h.m(l,null),L(e,m,t),je(f,e,t),g=!0},p:e,i(e){g||(Le(n.$$.fragment,e),Le(f.$$.fragment,e),g=!0)},o(e){Oe(n.$$.fragment,e),Oe(f.$$.fragment,e),g=!1},d(e){Ae(n,e),e&&O(o),e&&O(r),h.d(),e&&O(m),Ae(f,e)}}}function Oa(e){return[We&&!Re]}class Ea extends Ie{constructor(e){super(),Fe(this,e,Oa,La,i,{})}}function Ma(e){let t,n,o,r,s,a,i,l,c;t=new qs({props:{$$slots:{default:[Ta]},$$scope:{ctx:e}}}),o=new ka({props:{prompt:!!e[1]}});let u=(e[1]||e[4])&&"success"===e[2]&&_a(e);const p=[Ra,Da,za,Ia,Fa,Aa],d=[];function m(e,t){return"loading"===e[2]?0:e[2]&&"success"!==e[2]&&"/map"===e[3]?1:"/export"===e[3]&&"success"===e[2]?2:"/"===e[3]?3:"/help"===e[3]?4:!e[1]&&!e[4]||"/map"!==e[3]?5:-1}return~(a=m(e))&&(i=d[a]=p[a](e)),{c(){_e(t.$$.fragment),n=j(),_e(o.$$.fragment),r=j(),u&&u.c(),s=j(),i&&i.c(),l=A()},m(e,i){je(t,e,i),L(e,n,i),je(o,e,i),L(e,r,i),u&&u.m(e,i),L(e,s,i),~a&&d[a].m(e,i),L(e,l,i),c=!0},p(e,n){const r={};4097&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};2&n&&(c.prompt=!!e[1]),o.$set(c),(e[1]||e[4])&&"success"===e[2]?u?(u.p(e,n),22&n&&Le(u,1)):(u=_a(e),u.c(),Le(u,1),u.m(s.parentNode,s)):u&&(Pe(),Oe(u,1,1,(()=>{u=null})),Ce());let f=a;a=m(e),a===f?~a&&d[a].p(e,n):(i&&(Pe(),Oe(d[f],1,1,(()=>{d[f]=null})),Ce()),~a?(i=d[a],i?i.p(e,n):(i=d[a]=p[a](e),i.c()),Le(i,1),i.m(l.parentNode,l)):i=null)},i(e){c||(Le(t.$$.fragment,e),Le(o.$$.fragment,e),Le(u),Le(i),c=!0)},o(e){Oe(t.$$.fragment,e),Oe(o.$$.fragment,e),Oe(u),Oe(i),c=!1},d(e){Ae(t,e),e&&O(n),Ae(o,e),e&&O(r),u&&u.d(e),e&&O(s),~a&&d[a].d(e),e&&O(l)}}}function Sa(t){let n,o;return n=new Ea({}),{c(){_e(n.$$.fragment)},m(e,t){je(n,e,t),o=!0},p:e,i(e){o||(Le(n.$$.fragment,e),o=!0)},o(e){Oe(n.$$.fragment,e),o=!1},d(e){Ae(n,e)}}}function Ta(e){let t,n;return t=new Qs({props:{kmlOptions:e[0]}}),t.$on("change",e[6]),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.kmlOptions=e[0]),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function _a(e){let t,n;return t=new Ys({props:{hidden:"/map"!==e[3],$$slots:{default:[ja]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.hidden="/map"!==e[3]),4107&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function ja(e){let t,n,o;function r(t){e[7](t)}let s={id:"map",ofp:e[1]};return void 0!==e[0]&&(s.kmlOptions=e[0]),t=new Br({props:s}),ae.push((()=>Te(t,"kmlOptions",r))),t.$on("save",e[8]),{c(){_e(t.$$.fragment)},m(e,n){je(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[1]),!n&&1&o&&(n=!0,r.kmlOptions=e[0],fe((()=>n=!1))),t.$set(r)},i(e){o||(Le(t.$$.fragment,e),o=!0)},o(e){Oe(t.$$.fragment,e),o=!1},d(e){Ae(t,e)}}}function Aa(t){let n,o=t[5](t[3])+"";return{c(){n=T(o)},m(e,t){L(e,n,t)},p(e,t){8&t&&o!==(o=e[5](e[3])+"")&&N(n,o)},i:e,o:e,d(e){e&&O(n)}}}function Fa(e){let t,n;return t=new Ys({props:{$$slots:{default:[Wa]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Ia(e){let t,n;return t=new Ys({props:{$$slots:{default:[Na]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function za(e){let t,n;return t=new Ys({props:{$$slots:{default:[qa]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};4105&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Da(e){let t,n;return t=new Ys({props:{$$slots:{default:[Ua]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};4100&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Ra(e){let t,n;return t=new Ys({props:{$$slots:{default:[Ha]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Wa(e){let t,n;return t=new ha({}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function Na(e){let t,n;return t=new hn({}),{c(){_e(t.$$.fragment)},m(e,o){je(t,e,o),n=!0},i(e){n||(Le(t.$$.fragment,e),n=!0)},o(e){Oe(t.$$.fragment,e),n=!1},d(e){Ae(t,e)}}}function qa(t){let n,o,r,s;return n=new un({}),n.$on("save",t[9]),r=new At({}),{c(){_e(n.$$.fragment),o=j(),_e(r.$$.fragment)},m(e,t){je(n,e,t),L(e,o,t),je(r,e,t),s=!0},p:e,i(e){s||(Le(n.$$.fragment,e),Le(r.$$.fragment,e),s=!0)},o(e){Oe(n.$$.fragment,e),Oe(r.$$.fragment,e),s=!1},d(e){Ae(n,e),e&&O(o),Ae(r,e)}}}function Ua(e){let t,n,o;return{c(){t=M("p"),n=T("😱: "),o=T(e[2]),z(t,"class","ofpError svelte-nv33jc")},m(e,r){L(e,t,r),C(t,n),C(t,o)},p(e,t){4&t&&N(o,e[2])},d(e){e&&O(t)}}}function Ha(e){let t;return{c(){t=M("div"),t.textContent="traitement en cours...",U(t,"margin","auto")},m(e,n){L(e,t,n)},d(e){e&&O(t)}}}function Ga(e){let t,n,o,r,s,a;const i=[Sa,Ma],l=[];return o=navigator&&!1===navigator.standalone&&De?0:1,r=l[o]=i[o](e),{c(){t=M("main"),n=M("div"),r.c(),z(n,"class","content svelte-nv33jc"),z(t,"class",s="container "+(e[3].substr(1)||"home")+" svelte-nv33jc")},m(e,r){L(e,t,r),C(t,n),l[o].m(n,null),a=!0},p(e,[n]){r.p(e,n),(!a||8&n&&s!==(s="container "+(e[3].substr(1)||"home")+" svelte-nv33jc"))&&z(t,"class",s)},i(e){a||(Le(r),a=!0)},o(e){Oe(r),a=!1},d(e){e&&O(t),l[o].d()}}}function Ba(e,t,n){let o,r,s,a,i,l;u(e,ft,(e=>n(1,o=e))),u(e,gt,(e=>n(2,r=e))),u(e,Pt,(e=>n(3,s=e))),u(e,ut,(e=>n(10,a=e))),u(e,it,(e=>n(11,i=e))),u(e,$t,(e=>n(4,l=e)));(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in Ft){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(Nt)?t=o.toUpperCase():e.endsWith("Display")?t=!!o:e.endsWith("Change")&&(o*=1,isNaN(o)||(t=o.toFixed(1))),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||Xt.setItem(Qt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&Xt.setItem(Qt.shortcut,o));Xt.setItem(Qt.optionsKML,n)})(window.location.search);let c=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Ft&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(Nt)?t[n]=o.toUpperCase():n.endsWith("Display")?t[n]=!!o:n.endsWith("Change")&&(o*=1,isNaN(o)||(t[n]=o.toFixed(1))));return{...Ft,...t}})(Xt.getItem(Qt.optionsKML)||{});Jt(c,s);te((()=>(document.addEventListener("visibilitychange",xt,!1),()=>document.removeEventListener("visibilitychange",xt))));return[c,o,r,s,l,e=>{window.location.hash="#/"},()=>{v(ut,a=!1,a),v(it,i=!1,i)},function(e){c=e,n(0,c)},()=>Jt(c,s),()=>Jt(c,s)]}class Za extends Ie{constructor(e){super(),Fe(this,e,Ba,Ga,i,{})}}try{self["workbox:window:6.1.2"]&&_()}catch(Ka){}function Ka(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function Va(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Qa(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Va(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Va(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.1.2"]&&_()}catch(Ka){}var Xa=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function Ja(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var Ya=function(e,t){this.type=e,Object.assign(this,t)};function ei(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function ti(){}var ni={type:"SKIP_WAITING"};function oi(e,t){if(!t)return e&&e.then?e.then(ti):Promise.resolve()}var ri=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new Xa,o.en=new Xa,o.on=new Xa,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!Ja(t.scriptURL,o.sn)||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,s=n===o.vn,a={sw:n,isExternal:s,originalEvent:e};!s&&o.mn&&(a.isUpdate=!0),o.dispatchEvent(new Ya(r,a)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new Ya("waiting",a))}),200):"activating"===r&&(clearTimeout(o.wn),s||o.en.resolve(n))},o.dn=function(e){var t=o.hn;t===navigator.serviceWorker.controller&&(o.dispatchEvent(new Ya("controlling",{sw:t,originalEvent:e,isUpdate:o.mn})),o.on.resolve(t))},o.gn=(r=function(e){var t=e.data,n=e.source;return ei(o.getSW(),(function(){o.an.has(n)&&o.dispatchEvent(new Ya("message",{data:t,sw:n,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,s=o.prototype;return s.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return oi(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),ei(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&Ja(t.scriptURL,o.sn)&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new Ya("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn,{once:!0}),o.fn}))}))}catch(e){return Promise.reject(e)}},s.update=function(){try{return this.fn?oi(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},s.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},s.messageSW=function(e){try{return ei(this.getSW(),(function(t){return Ka(t,e)}))}catch(e){return Promise.reject(e)}},s.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Ka(this.fn.waiting,ni)},s.pn=function(){var e=navigator.serviceWorker.controller;return e&&Ja(e.scriptURL,this.sn)?e:void 0},s.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return ei(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=Qa(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let si,ai=!1;try{si=new Za({target:document.body})}catch(e){ai=!0;try{var ii=document.createElement("p");ii.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(ii)}catch(Qa){}}finally{if("serviceWorker"in navigator){const e=new ri("./sw.js");at.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{ai?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,Ve(400,Ka(t.sw,{type:"GET_VERSION"})).then((e=>xa(e))).catch((e=>{xa()})))})),e.register().then((e=>{ai&&e&&e.unregister(),ba.set(e)}),console.error)}}return si}();
//# sourceMappingURL=bundle.js.map
