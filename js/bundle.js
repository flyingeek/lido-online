var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function i(e){e.forEach(o)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(e,t,n){e.$$.on_destroy.push(l(t,n))}function u(e,t,n,o){if(e){const r=p(e,t,n,o);return e[0](r)}}function p(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function d(e,t,n,o,r,i,s){const a=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,i);if(a){const r=p(t,n,o,s);e.p(r,a)}}function m(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function f(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function g(e){return null==e?"":e}function h(e,t,n=t){return e.set(n),t}function v(t){return t&&s(t.destroy)?t.destroy:e}const y="undefined"!=typeof window;let $=y?()=>window.performance.now():()=>Date.now(),b=y?e=>requestAnimationFrame(e):e;const x=new Set;function w(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&b(w)}function k(e){let t;return 0===x.size&&b(w),{promise:new Promise((n=>{x.add(t={c:e,f:n})})),abort(){x.delete(t)}}}function P(e,t){e.appendChild(t)}function C(e,t,n){e.insertBefore(t,n||null)}function L(e){e.parentNode.removeChild(e)}function O(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function E(e){return document.createElement(e)}function F(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function M(e){return document.createTextNode(e)}function S(){return M(" ")}function j(){return M("")}function T(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function I(e){return function(t){return t.preventDefault(),e.call(this,t)}}function z(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function A(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:z(e,o,t[o])}function D(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function R(e){return""===e?null:+e}function W(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function N(e,t){e.value=null==t?"":t}function H(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function U(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function G(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function q(e,t,n){e.classList[n?"add":"remove"](t)}function B(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const K=new Set;let Z,V=0;function X(e,t,n,o,r,i,s,a=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*i(e);c+=100*e+`%{${s(o,1-o)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=e.ownerDocument;K.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(E("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,V+=1,p}function J(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),V-=r,V||b((()=>{V||(K.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),K.clear())})))}function Y(e){Z=e}function Q(){if(!Z)throw new Error("Function called outside component initialization");return Z}function ee(e){Q().$$.on_mount.push(e)}function te(){const e=Q();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=B(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function ne(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const oe=[],re=[],ie=[],se=[],ae=Promise.resolve();let le=!1;function ce(){le||(le=!0,ae.then(ge))}function ue(){return ce(),ae}function pe(e){ie.push(e)}function de(e){se.push(e)}let me=!1;const fe=new Set;function ge(){if(!me){me=!0;do{for(let e=0;e<oe.length;e+=1){const t=oe[e];Y(t),he(t.$$)}for(Y(null),oe.length=0;re.length;)re.pop()();for(let e=0;e<ie.length;e+=1){const t=ie[e];fe.has(t)||(fe.add(t),t())}ie.length=0}while(oe.length);for(;se.length;)se.pop()();le=!1,me=!1,fe.clear()}}function he(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(pe)}}let ve;function ye(){return ve||(ve=Promise.resolve(),ve.then((()=>{ve=null}))),ve}function $e(e,t,n){e.dispatchEvent(B(`${t?"intro":"outro"}${n}`))}const be=new Set;let xe;function we(){xe={r:0,c:[],p:xe}}function ke(){xe.r||i(xe.c),xe=xe.p}function Pe(e,t){e&&e.i&&(be.delete(e),e.i(t))}function Ce(e,t,n,o){if(e&&e.o){if(be.has(e))return;be.add(e),xe.c.push((()=>{be.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const Le={duration:0};function Oe(n,o,r,a){let l=o(n,r),c=a?0:1,u=null,p=null,d=null;function m(){d&&J(n,d)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(o){const{delay:r=0,duration:s=300,easing:a=t,tick:g=e,css:h}=l||Le,v={start:$()+r,b:o};o||(v.group=xe,xe.r+=1),u||p?p=v:(h&&(m(),d=X(n,c,o,s,r,a,h)),o&&g(0,1),u=f(v,s),pe((()=>$e(n,o,"start"))),k((e=>{if(p&&e>p.start&&(u=f(p,s),p=null,$e(n,u.b,"start"),h&&(m(),d=X(n,c,u.b,u.duration,0,a,l.css))),u)if(e>=u.end)g(c=u.b,1-c),$e(n,u.b,"end"),p||(u.b?m():--u.group.r||i(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*a(t/u.duration),g(c,1-c)}return!(!u&&!p)})))}return{run(e){s(l)?ye().then((()=>{l=l(),g(e)})):g(e)},end(){m(),u=p=null}}}const _e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function Ee(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Fe(e){e&&e.c()}function Me(e,t,n){const{fragment:r,on_mount:a,on_destroy:l,after_update:c}=e.$$;r&&r.m(t,n),pe((()=>{const t=a.map(o).filter(s);l?l.push(...t):i(t),e.$$.on_mount=[]})),c.forEach(pe)}function Se(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function je(t,n,o,s,a,l,c=[-1]){const u=Z;Y(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:r(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(oe.push(e),ce(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(L)}else p.fragment&&p.fragment.c();n.intro&&Pe(t.$$.fragment),Me(t,n.target,n.anchor),ge()}Y(u)}class Te{$destroy(){Se(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Ie{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const ze="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,Ae=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),De=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),Re=matchMedia("(hover: hover)").matches;function We(e,t,n){let o;return function(){const r=this,i=arguments,s=function(){o=null,n||e.apply(r,i)},a=n&&!o;clearTimeout(o),o=setTimeout(s,t),a&&e.apply(r,i)}}function Ne(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function He(e){switch(e){case"rmain":return"route";case"ralt":return"alternate";case"rnat":return"nat";default:return e}}function Ue(e,t,n){return e<=t?t:e>=n?n:e}function Ge(e,t,n){return!(e<t)&&!(e>n)}function qe(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Be(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ke(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}const Ze=async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1};function Ve(e){const t=e-1;return t*t*t+1}function Xe(e,{delay:n=0,duration:o=400,easing:r=t}={}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*i}}function Je(e,{delay:t=0,duration:n=400,easing:o=Ve,x:r=0,y:i=0,opacity:s=0}={}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-s);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*i}px);\n\t\t\topacity: ${l-u*t}`}}const Ye=[];function Qe(e,t){return{subscribe:et(e,t).subscribe}}function et(t,n=e){let o;const r=[];function i(e){if(a(t,e)&&(t=e,o)){const e=!Ye.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Ye.push(n,t)}if(e){for(let e=0;e<Ye.length;e+=2)Ye[e][0](Ye[e+1]);Ye.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(s,a=e){const l=[s,a];return r.push(l),1===r.length&&(o=n(i)||e),s(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const tt=et(),nt=et(!1),ot=et(!1),rt=et(!1),it=et(!1),st=et(!1),at=et(-1),lt=et(),ct=et(),ut=et(new Date),pt=et(!1);let dt=new Date;const mt=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-dt>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting?(ot.set(!0),rt.set(!0)):e.update(),nt.set(!1),dt=new Date)}),console.error)}},ft=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&mt()},gt=Qe({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),ht=Qe("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(it.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),mt()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}})),vt=function(t,n,o){const r=!Array.isArray(t),a=r?[t]:t,c=n.length<2;return Qe(o,(t=>{let o=!1;const u=[];let p=0,d=e;const m=()=>{if(p)return;d();const o=n(r?u[0]:u,t);c?t(o):d=s(o)?o:e},f=a.map(((e,t)=>l(e,(e=>{u[t]=e,p&=~(1<<t),o&&m()}),(()=>{p|=1<<t}))));return o=!0,m(),function(){i(f),d()}}))}([lt,at,ut],(([e,t,n],o)=>{let r;if(e&&!e.isFake){const i=e=>{e<100?o(e):(o(100),clearInterval(r),r=void 0,at.set(-1))};if(t>=0){let e=t;r=setInterval((()=>{i(e),e++}),100)}else{const t=n,s=new Date(t),a=e.infos.duration;s.setUTCMinutes(s.getUTCMinutes()+a[1]),s.setUTCHours(s.getUTCHours()+a[0]);const l=()=>{let e=new Date;return e<=t?0:e>=s?100:(e-t)/(3600*a[0]+60*a[1])/10},c=l();c<100?(r=setInterval((()=>{const e=l();i(e)}),6e4),o(c)):o(100)}}else o(0);return()=>{r&&clearInterval(r)}}),0);function yt(e){let t;return{c(){t=E("textarea"),t.value=e[0],z(t,"class","svelte-12a0ij3")},m(n,o){C(n,t,o),e[5](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&L(t),e[5](null)}}}function $t(t){let n,o,r;return{c(){n=E("a"),n.textContent="copier la route",z(n,"role","button"),z(n,"class","btn btn-primary svelte-12a0ij3"),z(n,"href","lhs-mpilot://")},m(e,i){C(e,n,i),o||(r=T(n,"click",t[4]),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function bt(t){let n,o,r,i,s;return{c(){n=E("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=S(),r=E("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',z(n,"role","button"),z(n,"class","btn btn-primary svelte-12a0ij3"),z(n,"href","lhs-mpilot://"),z(r,"class","card-text")},m(e,a){C(e,n,a),C(e,o,a),C(e,r,a),i||(s=T(n,"click",t[4]),i=!0)},p:e,d(e){e&&L(n),e&&L(o),e&&L(r),i=!1,s()}}}function xt(n){let o,r,a;return{c(){o=E("span"),o.textContent="copié!",z(o,"class","svelte-12a0ij3")},m(e,t){C(e,o,t),a=!0},i(e){a||(r&&r.end(1),a=!0)},o(n){r=function(n,o,r){let a,l=o(n,r),c=!0;const u=xe;function p(){const{delay:o=0,duration:r=300,easing:s=t,tick:p=e,css:d}=l||Le;d&&(a=X(n,1,0,r,o,s,d));const m=$()+o,f=m+r;pe((()=>$e(n,!1,"start"))),k((e=>{if(c){if(e>=f)return p(0,1),$e(n,!1,"end"),--u.r||i(u.c),!1;if(e>=m){const t=s((e-m)/r);p(1-t,t)}}return c}))}return u.r+=1,s(l)?ye().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(a&&J(n,a),c=!1)}}}(o,Xe,{}),a=!1},d(e){e&&L(o),e&&r&&r.end()}}}function wt(e){let t,n,o,r,i,s,a,l,c,u,p,d,m=null!=e[0]&&yt(e);let f=(ze?bt:$t)(e),g=e[2]&&xt();return{c(){m&&m.c(),t=S(),n=E("div"),o=E("div"),r=E("h5"),r.textContent="Route Lido",i=S(),s=E("p"),s.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",a=S(),f.c(),l=S(),c=E("div"),u=M(e[3]),p=S(),g&&g.c(),z(r,"class","card-title"),z(s,"class","card-text"),z(c,"class","text-monospace svelte-12a0ij3"),z(o,"class","card-body"),z(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),C(e,t,h),C(e,n,h),P(n,o),P(o,r),P(o,i),P(o,s),P(o,a),f.m(o,null),P(o,l),P(o,c),P(c,u),P(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=yt(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&Pe(g,1):(g=xt(),g.c(),Pe(g,1),g.m(c,null)):g&&(we(),Ce(g,1,1,(()=>{g=null})),ke())},i(e){d||(Pe(g),d=!0)},o(e){Ce(g),d=!1},d(e){m&&m.d(e),e&&L(t),e&&L(n),f.d(),g&&g.d()}}}let kt=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(kt=!0)}))}catch(e){}function Pt(e,t,n){let o;c(e,lt,(e=>n(6,o=e)));let r,i=null;const s=o?o.lidoRoute().join(" "):"";let a=!1;return[i,r,a,s,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(kt)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,i=e),await ue(),r.focus(),r.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,i=null)}return t}(s);ze||(n(2,a=t),setTimeout((function(){n(2,a=!1)}),3e3),e.preventDefault())},function(e){re[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class Ct extends Te{constructor(e){super(),je(this,e,Pt,wt,a,{})}}const Lt={routeDisplay:!0,routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC",iconTextChange:"1.0",lineWidthChange:"1.0",iconSizeChange:"1.0"};function Ot(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const _t=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Ot(window.kmlGen,Lt)),window.kmlGen);function Et(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function Ft(e){let t,n,o,r=e[14].label+"";return{c(){t=E("option"),n=M(r),t.__value=e[16],t.value=t.__value,t.selected=o=e[16]===e[1]},m(e,o){C(e,t,o),P(t,n)},p(e,n){2&n&&o!==(o=e[16]===e[1])&&(t.selected=o)},d(e){e&&L(t)}}}function Mt(t){let n,o,r,a,l,c,u,p,d,m,f,g,h,y,$,b,x,w,k=Dt,_=[];for(let e=0;e<k.length;e+=1)_[e]=Ft(Et(t,k,e));return{c(){n=E("kmlcolor"),o=E("pin"),r=F("svg"),a=F("use"),l=S(),c=E("select");for(let e=0;e<_.length;e+=1)_[e].c();u=S(),p=E("picker"),d=E("label"),m=E("input"),h=S(),y=E("input"),D(a,"xlink:href","#marker-symbol"),H(a,"stroke",0===t[1]?"#fff":Dt[t[1]].color),H(a,"fill",Dt[t[1]].color),z(o,"class","form-control svelte-1b9oa5t"),z(c,"name",t[4]),z(c,"class","custom-select"),void 0===t[1]&&pe((()=>t[8].call(c))),z(m,"type","color"),z(d,"style",f=At(t[2])),z(y,"type","range"),z(y,"min","30"),z(y,"max","255"),z(p,"class","form-control"),z(p,"style",$=zt(t[2][0])),z(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,a),P(n,l),P(n,c);for(let e=0;e<_.length;e+=1)_[e].m(c,null);U(c,t[1]),P(n,u),P(n,p),P(p,d),P(d,m),N(m,t[2][0]),P(p,h),P(p,y),N(y,t[2][1]),x||(w=[T(c,"change",t[8]),T(c,"change",t[9]),T(m,"input",t[10]),v(g=t[5].call(null,d,t[2])),T(y,"change",t[11]),T(y,"input",t[11]),v(b=t[6].call(null,n,t[0]))],x=!0)},p(e,[t]){if(2&t&&H(a,"stroke",0===e[1]?"#fff":Dt[e[1]].color),2&t&&H(a,"fill",Dt[e[1]].color),2&t){let n;for(k=Dt,n=0;n<k.length;n+=1){const o=Et(e,k,n);_[n]?_[n].p(o,t):(_[n]=Ft(o),_[n].c(),_[n].m(c,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=k.length}2&t&&U(c,e[1]),4&t&&N(m,e[2][0]),4&t&&f!==(f=At(e[2]))&&z(d,"style",f),g&&s(g.update)&&4&t&&g.update.call(null,e[2]),4&t&&N(y,e[2][1]),4&t&&$!==($=zt(e[2][0]))&&z(p,"style",$),b&&s(b.update)&&1&t&&b.update.call(null,e[0])},i:e,o:e,d(e){e&&L(n),O(_,e),x=!1,i(w)}}}const St=/^[A-F0-9]{8}$/i,jt=e=>{let[t,n]=It(e);return[t,n/255]},Tt=["#FF0000",255],It=e=>{try{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]}catch(e){return Tt}},zt=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},At=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Dt=[{label:"Aucun repère",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Rt(e,t,n){const o=te();let{kmlColor:r="FF0000FF"}=t,{selected:i=0}=t,{name:s}=t;const a=s+"-color",l=s+"-pin";let c=Tt;const u=We(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"selected"in e&&n(1,i=e.selected),"name"in e&&n(7,s=e.name)},[r,i,c,o,l,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),u("change",{name:a,value:r})}}},function(e){return n(2,c=It(r)),{update(e){n(2,c=It(e)),u("change",{name:a,value:e.toUpperCase()})}}},s,function(){i=G(this),n(1,i)},e=>{e.target.blur(),o("change",{name:l,value:i})},function(){c[0]=this.value,n(2,c)},function(){c[1]=R(this.value),n(2,c)}]}class Wt extends Te{constructor(e){super(),je(this,e,Rt,Mt,a,{kmlColor:0,selected:1,name:7})}}const Nt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),Ht=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){const n=JSON.stringify(t);"{}"!==n&&localStorage.setItem(e,n)}removeItem(e){localStorage.removeItem(e)}},Ut=(e,t,n="Mon OFP2MAP")=>{const o={};for(const[t,n]of Object.entries(Nt)){let r=Ht.getItem(n);if(t===Nt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==Lt[t])))t[n]=e[n];r=t}if(null!==r)if(t===Nt.optionsKML)for(const[e,t]of Object.entries(r))o[e]=t;else o[t]=r}const r=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),i=window.location.origin+window.location.pathname+(r?"?"+r:"")+"#"+t;window.history.replaceState(o,n,i)};function Gt(t){let n,o,r,s,a,l,c,u,p,d;return{c(){n=E("div"),o=E("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',r=S(),s=E("input"),a=S(),l=E("div"),c=E("a"),u=M("Lancer"),z(o,"class","input-group-prepend"),z(s,"class","form-control svelte-1ecyaux"),z(s,"placeholder","Nom du raccourci"),z(s,"type","text"),z(c,"class","btn btn-outline-secondary svelte-1ecyaux"),z(c,"href",t[1]),q(c,"disabled",!(t[0].trim()&&ze)),z(l,"class","input-group-append"),z(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(n,r),P(n,s),N(s,t[0]),P(n,a),P(n,l),P(l,c),P(c,u),p||(d=[T(s,"input",t[4]),T(s,"change",t[3]),T(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&s.value!==e[0]&&N(s,e[0]),2&t&&z(c,"href",e[1]),1&t&&q(c,"disabled",!(e[0].trim()&&ze))},i:e,o:e,d(e){e&&L(n),p=!1,i(d)}}}const qt="OFP2MAP";function Bt(e,t,n){let o;c(e,lt,(e=>n(5,o=e)));const r=te(),i=Nt.shortcut;let s,a=Ht.getItem(i)||qt;const l=o?o.lidoRoute().join(" "):"";return[a,s,function(e){const t=a.trim();if(t&&ze){const e=_t(),r={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:o.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(r)))}else e.preventDefault()},function(){const e=a.trim();e===qt?Ht.removeItem(i):Ht.setItem(i,e),r("save",[i,e])},function(){a=this.value,n(0,a)}]}class Kt extends Te{constructor(e){super(),je(this,e,Bt,Gt,a,{})}}function Zt(t){let n,o,r,s,a,l,c,u,p,d,m,f,g,h,v,y=Jt[0]+"",$=Jt[1]+"";return{c(){n=E("div"),o=E("select"),r=E("option"),s=M(y),l=E("option"),c=M($),p=S(),d=E("div"),m=E("a"),f=M(t[0]),r.selected=a=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,z(o,"class","custom-select svelte-19hokx5"),z(o,"aria-label","Example select with button addon"),void 0===t[1]&&pe((()=>t[6].call(o))),z(m,"class","btn btn-success"),z(m,"download",g=navigator.standalone?null:t[3]),z(m,"href",t[2]),z(m,"target",Vt),z(d,"class","input-group-append"),z(n,"class","input-group")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(o,l),P(l,c),U(o,t[1]),P(n,p),P(n,d),P(d,m),P(m,f),h||(v=[T(o,"change",t[6]),T(o,"change",t[5]),T(m,"click",t[4])],h=!0)},p(e,[t]){2&t&&a!==(a=0===e[1])&&(r.selected=a),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&U(o,e[1]),1&t&&W(f,e[0]),8&t&&g!==(g=navigator.standalone?null:e[3])&&z(m,"download",g),4&t&&z(m,"href",e[2])},i:e,o:e,d(e){e&&L(n),h=!1,i(v)}}}const Vt=navigator.standalone||navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,Xt=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},Jt=["KML Mapsme","KML Avenza"];function Yt(e,t,n){const o=te();let{label:r}=t;const i=Nt.downloadType;let s=Ht.getItem(i)||1;"string"==typeof s&&(s=parseInt(s,10)),(s<0||s>=Jt.length)&&(s=0);let a="",l="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,s,a,l,function(e){const t=_t(),o=["_mapsme.kml","_avenza.kml",".geojson"][s];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),0===s)n(2,a=Xt(t.render()));else{if(1!==s)return e.preventDefault(),!1;n(2,a=Xt(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})))}},function(){1===s?Ht.removeItem(i):Ht.setItem(i,s),o("save",[i,s])},function(){s=G(this),n(1,s)}]}class Qt extends Te{constructor(e){super(),je(this,e,Yt,Zt,a,{label:0})}}function en(t){let n,o,r,i,s,a,l,c,u,p,d,m,f,g,h;return l=new Qt({props:{label:"Télécharger"}}),l.$on("save",t[0]),m=new Kt({}),m.$on("save",t[1]),{c(){n=E("div"),o=E("div"),r=E("h5"),r.textContent="Export",i=S(),s=E("div"),a=E("div"),Fe(l.$$.fragment),c=S(),u=E("small"),u.textContent="Le fichier est généré en fonction des options choisies sur la carte.",p=S(),d=E("div"),Fe(m.$$.fragment),f=S(),g=E("small"),g.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',z(r,"class","card-title"),z(u,"class","text-muted"),z(a,"class","col-12 col-sm-6 col-md-6"),z(g,"class","text-muted"),z(d,"class","col-12 col-sm-6 col-md-6"),z(s,"class","row"),z(o,"class","card-body"),z(n,"class","card mb-3 svelte-17snbjk")},m(e,t){C(e,n,t),P(n,o),P(o,r),P(o,i),P(o,s),P(s,a),Me(l,a,null),P(a,c),P(a,u),P(s,p),P(s,d),Me(m,d,null),P(d,f),P(d,g),h=!0},p:e,i(e){h||(Pe(l.$$.fragment,e),Pe(m.$$.fragment,e),h=!0)},o(e){Ce(l.$$.fragment,e),Ce(m.$$.fragment,e),h=!1},d(e){e&&L(n),Se(l),Se(m)}}}function tn(e){return[function(t){ne(e,t)},function(t){ne(e,t)}]}class nn extends Te{constructor(e){super(),je(this,e,tn,en,a,{})}}function on(t){let n;return{c(){n=M(" ")},m(e,t){C(e,n,t)},p:e,d(e){e&&L(n)}}}function rn(t){let n,o,r;return{c(){n=E("button"),n.textContent="Partager l'App",z(n,"class","btn btn-link")},m(e,t){C(e,n,t),o||(r=T(n,"click",Ze),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function sn(t){let n,o,r,i,s;let a=(!0===navigator.standalone&&navigator.share?rn:on)(t);return{c(){n=E("h1"),o=M("Cartographie pour l'OFP \n    "),r=E("img"),s=S(),a.c(),r.src!==(i="svg/Air_France_Logo.svg")&&z(r,"src","svg/Air_France_Logo.svg"),z(r,"alt","logo Air France"),z(r,"class","svelte-drdjg7"),z(n,"class","svelte-drdjg7")},m(e,t){C(e,n,t),P(n,o),P(n,r),P(n,s),a.m(n,null)},p(e,[t]){a.p(e,t)},i:e,o:e,d(e){e&&L(n),a.d()}}}class an extends Te{constructor(e){super(),je(this,e,null,sn,a,{})}}function ln(t){let n,o,r,i;return n=new an({}),{c(){Fe(n.$$.fragment),o=S(),r=E("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card avenza svelte-16k91og"><div class="card-header svelte-16k91og">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card mapsme svelte-16k91og"><div class="card-header svelte-16k91og">Multiples Projections</div> \n      <div class="card-body"><p class="card-text">Des cartes LAMBERT conformes, un ATLAS, et une MERCATOR avec 12 niveaux de zoom. Export en format KML vers Mapsme ou Avenza</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card ogimet svelte-16k91og"><div class="card-header svelte-16k91og">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET qui est un météogramme combinant l&#39;espace et le temps</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-16k91og"><div class="card shortcuts svelte-16k91og"><div class="card-header svelte-16k91og">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Avec l&#39;app Raccourcis, automatisez en récupérant le KML, le Gramet, ou une route Lido optimisée</p></div></div></div></div>',z(r,"class","row svelte-16k91og")},m(e,t){Me(n,e,t),C(e,o,t),C(e,r,t),i=!0},p:e,i(e){i||(Pe(n.$$.fragment,e),i=!0)},o(e){Ce(n.$$.fragment,e),i=!1},d(e){Se(n,e),e&&L(o),e&&L(r)}}}class cn extends Te{constructor(e){super(),je(this,e,null,ln,a,{})}}function un(t){let n,o,r,a,l,c,u,p,d,m,f,g,h,y,$,b,x;return{c(){n=E("kmlcolor"),o=E("div"),r=E("label"),a=E("input"),l=M(t[2]),c=S(),u=E("picker"),p=E("label"),d=E("input"),g=S(),h=E("input"),z(a,"name",t[4]),a.checked=t[1],z(a,"type","checkbox"),z(r,"for",t[4]),z(r,"class","input-group-text"),z(o,"class","input-group-prepend"),z(d,"type","color"),z(p,"style",m=At(t[3])),z(h,"type","range"),z(h,"min","30"),z(h,"max","255"),z(u,"class","form-control"),z(u,"style",y=zt(t[3][0])),z(n,"class","input-group checkbox-combo")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,a),P(r,l),P(n,c),P(n,u),P(u,p),P(p,d),N(d,t[3][0]),P(u,g),P(u,h),N(h,t[3][1]),b||(x=[T(a,"change",t[8]),T(d,"input",t[9]),v(f=t[5].call(null,p,t[3])),T(h,"change",t[10]),T(h,"input",t[10]),v($=t[6].call(null,n,t[0]))],b=!0)},p(e,[t]){2&t&&(a.checked=e[1]),4&t&&W(l,e[2]),8&t&&N(d,e[3][0]),8&t&&m!==(m=At(e[3]))&&z(p,"style",m),f&&s(f.update)&&8&t&&f.update.call(null,e[3]),8&t&&N(h,e[3][1]),8&t&&y!==(y=zt(e[3][0]))&&z(u,"style",y),$&&s($.update)&&1&t&&$.update.call(null,e[0])},i:e,o:e,d(e){e&&L(n),b=!1,i(x)}}}function pn(e,t,n){const o=te();let{kmlColor:r="FF0000FF"}=t,{checked:i}=t,{name:s}=t,{label:a="Couleur"}=t;const l=s+"-color",c=s+"-display";let u=Tt;const p=We(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"checked"in e&&n(1,i=e.checked),"name"in e&&n(7,s=e.name),"label"in e&&n(2,a=e.label)},[r,i,a,u,c,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),p("change",{name:l,value:r})}}},function(e){return n(3,u=It(r)),{update(e){n(3,u=It(e)),p("change",{name:l,value:e.toUpperCase()})}}},s,function(t){ne(e,t)},function(){u[0]=this.value,n(3,u)},function(){u[1]=R(this.value),n(3,u)}]}class dn extends Te{constructor(e){super(),je(this,e,pn,un,a,{kmlColor:0,checked:1,name:7,label:2})}}function mn(e,t,n){const o=e.slice();return o[9]=t[n],o[11]=n,o}function fn(e){let t,n,o,r=e[9].label+"";return{c(){t=E("option"),n=M(r),t.__value=e[11],t.value=t.__value,t.selected=o=e[11]===e[0]},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[11]===e[0])&&(t.selected=o)},d(e){e&&L(t)}}}function gn(t){let n,o,r,s,a,l,c,u,p,d=hn,m=[];for(let e=0;e<d.length;e+=1)m[e]=fn(mn(t,d,e));return{c(){n=E("div"),o=E("div"),r=E("label"),s=E("input"),a=M("Airports"),l=S(),c=E("select");for(let e=0;e<m.length;e+=1)m[e].c();z(s,"name",t[3]),s.checked=t[1],z(s,"type","checkbox"),z(r,"for",t[3]),z(r,"class","input-group-text"),z(o,"class","input-group-prepend"),z(c,"name",t[4]),z(c,"class","custom-select svelte-aqi3t3"),void 0===t[0]&&pe((()=>t[7].call(c))),z(n,"class","input-group checkbox-combo")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(r,a),P(n,l),P(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);U(c,t[0]),u||(p=[T(s,"change",t[6]),T(c,"change",t[7]),T(c,"change",t[8])],u=!0)},p(e,[t]){if(2&t&&(s.checked=e[1]),1&t){let n;for(d=hn,n=0;n<d.length;n+=1){const o=mn(e,d,n);m[n]?m[n].p(o,t):(m[n]=fn(o),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}1&t&&U(c,e[0])},i:e,o:e,d(e){e&&L(n),O(m,e),u=!1,i(p)}}}const hn=[{label:"statuts"},{label:"vert/rouge"}];function vn(e,t,n){const o=te();let{selected:r=0}=t,{name:i="airport"}=t,{checked:s}=t;const a=i+"-display",l=i+"-pin";return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(5,i=e.name),"checked"in e&&n(1,s=e.checked)},[r,s,o,a,l,i,function(t){ne(e,t)},function(){r=G(this),n(0,r)},e=>{e.target.blur(),o("change",{name:l,value:r})}]}class yn extends Te{constructor(e){super(),je(this,e,vn,gn,a,{selected:0,name:5,checked:1})}}function $n(t){let n,o,r,s,a,l,c,u,p,d,m,f,g;return{c(){n=E("div"),o=E("div"),r=E("label"),s=M(t[2]),a=S(),l=E("button"),l.textContent="-",c=S(),u=E("div"),p=M(t[0]),d=S(),m=E("button"),m.textContent="+",z(r,"for",t[1]),z(r,"class","input-group-text svelte-si7r19"),z(o,"class","input-group-prepend"),z(l,"class","form-control svelte-si7r19"),z(l,"type","button"),z(u,"class"," form-control svelte-si7r19"),z(m,"class","form-control svelte-si7r19"),z(m,"type","button"),z(n,"class","input-group input-group-sm svelte-si7r19")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(r,s),P(n,a),P(n,l),P(n,c),P(n,u),P(u,p),P(n,d),P(n,m),f||(g=[T(l,"click",t[4]),T(m,"click",t[3])],f=!0)},p(e,[t]){4&t&&W(s,e[2]),2&t&&z(r,"for",e[1]),1&t&&W(p,e[0])},i:e,o:e,d(e){e&&L(n),f=!1,i(g)}}}function bn(e,t,n){const o=te();let{name:r}=t,{label:i}=t,{value:s}=t,{min:a=.9}=t,{max:l=1.4}=t,{step:c=.1}=t;return e.$$set=e=>{"name"in e&&n(1,r=e.name),"label"in e&&n(2,i=e.label),"value"in e&&n(0,s=e.value),"min"in e&&n(5,a=e.min),"max"in e&&n(6,l=e.max),"step"in e&&n(7,c=e.step)},[s,r,i,()=>{const e=s;n(0,s=Math.min(Math.max(parseFloat(s)+c,a),l).toFixed(1)),s!==e&&o("change",{name:r,value:s})},()=>{const e=s;n(0,s=Math.min(Math.max(parseFloat(s)-c,a),l).toFixed(1)),s!==e&&o("change",{name:r,value:s})},a,l,c]}class xn extends Te{constructor(e){super(),je(this,e,bn,$n,a,{name:1,label:2,value:0,min:5,max:6,step:7})}}function wn(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function kn(e){let t,n,o,r,s,a,l,c,u,p,d,m,f,g,h,y,$,b,x,w,k,O,_,F,j,A,D,R,W,N,H,U,G,B,K,Z,V,X,J,Y,Q,ee,te,ne,oe,re,ie,se,ae,le,ce,ue,de,me,fe,ge,he,ve,ye,$e,be,xe,we,ke,Le;c=new Wt({props:{name:"route",kmlColor:e[0].routeColor,selected:e[0].routePin}}),c.$on("change",e[4]),y=new Wt({props:{name:"alternate",kmlColor:e[0].alternateColor,selected:e[0].alternatePin}}),y.$on("change",e[4]),F=new Wt({props:{name:"nat",kmlColor:e[0].natColor,selected:e[0].natPin}}),F.$on("change",e[4]),W=new dn({props:{name:"great-circle",label:"Orthodromie",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay}}),W.$on("change",e[4]),U=new dn({props:{name:"ogimet",label:"Route GRAMET",kmlColor:e[0].ogimetColor,checked:e[0].ogimetDisplay}}),U.$on("change",e[4]),K=new dn({props:{name:"etops",label:"ETOPS",kmlColor:e[0].etopsColor,checked:e[0].etopsDisplay}}),K.$on("change",e[4]),X=new yn({props:{name:"airport",selected:e[0].airportPin,checked:e[0].airportDisplay}}),X.$on("change",e[4]),ie=new xn({props:{name:"icon-text-change",label:"Label",value:e[0].iconTextChange}}),ie.$on("change",e[4]),ae=new xn({props:{name:"line-width-change",label:"Ligne",value:e[0].lineWidthChange,min:.6,max:2,step:.1}}),ae.$on("change",e[4]),ce=new xn({props:{name:"icon-size-change",label:"Icône",value:e[0].iconSizeChange,min:.6,max:2,step:.1}}),ce.$on("change",e[4]);let _e=!e[1]&&Pn(e);return{c(){t=E("div"),n=E("a"),n.innerHTML='<svg class="svelte-1tbpz3x"><use xlink:href="#close-symbol"></use></svg>',o=S(),r=E("form"),s=E("fieldset"),a=E("legend"),a.textContent="Route",l=S(),Fe(c.$$.fragment),u=S(),p=E("fieldset"),d=E("legend"),m=E("input"),g=M("Dégagement"),h=S(),Fe(y.$$.fragment),$=S(),b=E("fieldset"),x=E("legend"),w=E("input"),O=M("Tracks"),_=S(),Fe(F.$$.fragment),j=S(),A=E("small"),A.textContent="Positionné à l'entrée des tracks, un track incomplet restera rouge.",D=S(),R=E("fieldset"),Fe(W.$$.fragment),N=S(),H=E("fieldset"),Fe(U.$$.fragment),G=S(),B=E("fieldset"),Fe(K.$$.fragment),Z=S(),V=E("fieldset"),Fe(X.$$.fragment),J=S(),Y=E("fieldset"),Q=E("legend"),ee=E("input"),ne=M("FIR SÛRETÉ"),oe=S(),re=E("fieldset"),Fe(ie.$$.fragment),se=S(),Fe(ae.$$.fragment),le=S(),Fe(ce.$$.fragment),ue=S(),de=E("div"),me=E("button"),fe=M("Mémoriser"),he=S(),ve=E("button"),ye=M("Restaurer"),be=S(),_e&&_e.c(),z(n,"class","closeB svelte-1tbpz3x"),z(n,"role","button"),z(n,"href","."),z(s,"class","form-group svelte-1tbpz3x"),z(m,"name","alternate-display"),m.checked=f=e[0].alternateDisplay,z(m,"type","checkbox"),z(p,"class","form-group svelte-1tbpz3x"),z(w,"name","nat-display"),w.checked=k=e[0].natDisplay,z(w,"type","checkbox"),z(A,"class","form-text text-muted svelte-1tbpz3x"),z(b,"class","form-group svelte-1tbpz3x"),z(R,"class","form-group svelte-1tbpz3x"),z(H,"class","form-group svelte-1tbpz3x"),z(B,"class","form-group svelte-1tbpz3x"),z(V,"class","form-group svelte-1tbpz3x"),z(ee,"name","fir-display"),ee.checked=te=e[0].firDisplay,z(ee,"type","checkbox"),z(Y,"class","form-group svelte-1tbpz3x"),z(re,"class","form-group svelte-1tbpz3x"),me.disabled=ge=!e[2],z(me,"class","btn btn-primary btn-sm mb-2 svelte-1tbpz3x"),z(me,"type","button"),ve.disabled=$e=!e[2],z(ve,"class","btn btn-secondary btn-sm mb-2 svelte-1tbpz3x"),z(ve,"type","button"),z(de,"class","last svelte-1tbpz3x"),z(r,"class","svelte-1tbpz3x"),z(t,"class","settings svelte-1tbpz3x"),q(t,"sidebar",e[3])},m(i,f){C(i,t,f),P(t,n),P(t,o),P(t,r),P(r,s),P(s,a),P(s,l),Me(c,s,null),P(r,u),P(r,p),P(p,d),P(d,m),P(d,g),P(p,h),Me(y,p,null),P(r,$),P(r,b),P(b,x),P(x,w),P(x,O),P(b,_),Me(F,b,null),P(b,j),P(b,A),P(r,D),P(r,R),Me(W,R,null),P(r,N),P(r,H),Me(U,H,null),P(r,G),P(r,B),Me(K,B,null),P(r,Z),P(r,V),Me(X,V,null),P(r,J),P(r,Y),P(Y,Q),P(Q,ee),P(Q,ne),P(r,oe),P(r,re),Me(ie,re,null),P(re,se),Me(ae,re,null),P(re,le),Me(ce,re,null),P(r,ue),P(r,de),P(de,me),P(me,fe),P(de,he),P(de,ve),P(ve,ye),P(de,be),_e&&_e.m(de,null),we=!0,ke||(Le=[T(n,"click",I(e[10])),T(m,"change",e[4]),T(w,"change",e[4]),T(ee,"change",e[4]),T(me,"click",e[7]),T(ve,"click",e[6]),T(r,"submit",I(e[9])),v(wn.call(null,t)),T(t,"click_outside",e[11])],ke=!0)},p(e,n){const o={};1&n&&(o.kmlColor=e[0].routeColor),1&n&&(o.selected=e[0].routePin),c.$set(o),(!we||1&n&&f!==(f=e[0].alternateDisplay))&&(m.checked=f);const r={};1&n&&(r.kmlColor=e[0].alternateColor),1&n&&(r.selected=e[0].alternatePin),y.$set(r),(!we||1&n&&k!==(k=e[0].natDisplay))&&(w.checked=k);const i={};1&n&&(i.kmlColor=e[0].natColor),1&n&&(i.selected=e[0].natPin),F.$set(i);const s={};1&n&&(s.kmlColor=e[0].greatCircleColor),1&n&&(s.checked=e[0].greatCircleDisplay),W.$set(s);const a={};1&n&&(a.kmlColor=e[0].ogimetColor),1&n&&(a.checked=e[0].ogimetDisplay),U.$set(a);const l={};1&n&&(l.kmlColor=e[0].etopsColor),1&n&&(l.checked=e[0].etopsDisplay),K.$set(l);const u={};1&n&&(u.selected=e[0].airportPin),1&n&&(u.checked=e[0].airportDisplay),X.$set(u),(!we||1&n&&te!==(te=e[0].firDisplay))&&(ee.checked=te);const p={};1&n&&(p.value=e[0].iconTextChange),ie.$set(p);const d={};1&n&&(d.value=e[0].lineWidthChange),ae.$set(d);const g={};1&n&&(g.value=e[0].iconSizeChange),ce.$set(g),(!we||4&n&&ge!==(ge=!e[2]))&&(me.disabled=ge),(!we||4&n&&$e!==($e=!e[2]))&&(ve.disabled=$e),e[1]?_e&&(_e.d(1),_e=null):_e?_e.p(e,n):(_e=Pn(e),_e.c(),_e.m(de,null)),8&n&&q(t,"sidebar",e[3])},i(e){we||(Pe(c.$$.fragment,e),Pe(y.$$.fragment,e),Pe(F.$$.fragment,e),Pe(W.$$.fragment,e),Pe(U.$$.fragment,e),Pe(K.$$.fragment,e),Pe(X.$$.fragment,e),Pe(ie.$$.fragment,e),Pe(ae.$$.fragment,e),Pe(ce.$$.fragment,e),pe((()=>{xe||(xe=Oe(t,Je,{duration:300,x:200,y:0},!0)),xe.run(1)})),we=!0)},o(e){Ce(c.$$.fragment,e),Ce(y.$$.fragment,e),Ce(F.$$.fragment,e),Ce(W.$$.fragment,e),Ce(U.$$.fragment,e),Ce(K.$$.fragment,e),Ce(X.$$.fragment,e),Ce(ie.$$.fragment,e),Ce(ae.$$.fragment,e),Ce(ce.$$.fragment,e),xe||(xe=Oe(t,Je,{duration:300,x:200,y:0},!1)),xe.run(0),we=!1},d(e){e&&L(t),Se(c),Se(y),Se(F),Se(W),Se(U),Se(K),Se(X),Se(ie),Se(ae),Se(ce),_e&&_e.d(),e&&xe&&xe.end(),ke=!1,i(Le)}}}function Pn(t){let n,o,r;return{c(){n=E("button"),n.textContent="Reset",z(n,"class","btn btn-outline-dark btn-sm reset svelte-1tbpz3x"),z(n,"type","button")},m(e,i){C(e,n,i),o||(r=T(n,"click",t[5]),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}function Cn(e){let t,n,o=e[3]&&kn(e);return{c(){o&&o.c(),t=j()},m(e,r){o&&o.m(e,r),C(e,t,r),n=!0},p(e,[n]){e[3]?o?(o.p(e,n),8&n&&Pe(o,1)):(o=kn(e),o.c(),Pe(o,1),o.m(t.parentNode,t)):o&&(we(),Ce(o,1,1,(()=>{o=null})),ke())},i(e){n||(Pe(o),n=!0)},o(e){Ce(o),n=!1},d(e){o&&o.d(e),e&&L(t)}}}function Ln(e,t){return JSON.stringify(e)===JSON.stringify(t)}function On(e,t,n){let o,r,i;c(e,it,(e=>n(3,i=e)));const s=te(),a=Nt.optionsKML;let{kmlOptions:l}=t,u={...Lt,...Ht.getItem(a)||{}};function p(e){let t=!1;for(const[r,i]of Object.entries(e))l[r]!==i&&(n(0,l[r]=i,l),s("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:i}),t=!0);var o;t&&n(0,l={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,l=e.kmlOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=Ln(Lt,l)),257&e.$$.dirty&&n(2,r=!Ln(u,l))},[l,o,r,i,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));l[r]!==o&&(n(0,l[r]=o,l),s("change",{name:t,value:o}))},function(){p(Lt)},function(){p(u)},function(){if(o)Ht.removeItem(a);else{const e={};for(const t of Object.keys(l).filter((e=>l[e]!==Lt[e])))e[t]=l[t];Ht.setItem(a,e)}s("save"),n(8,u={...l})},u,function(t){ne(e,t)},()=>{h(it,i=!i,i)},()=>h(it,i=!1,i)]}class _n extends Te{constructor(e){super(),je(this,e,On,Cn,a,{kmlOptions:0})}}function En(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function Fn(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Mn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const Sn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"],jn=(e,t=10,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?10:o},Tn=(e,t=2)=>{const n=e*t;return isNaN(n)?1:n},In=(e,t=1,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?1:o};function zn(e,t,n,o,r){const i=He(t),s=r[`${i}Pin`],a=r[`${i}Display`],l=r[`${i}Color`],c=jn(r.iconTextChange);e.addSource(`${t}-marker-source`,Fn(((e,t,n)=>{let o=[];const r=e.length;for(let i=0;i<r;i++){const r=t?t([e[i].longitude,e[i].latitude]):[e[i].longitude,e[i].latitude];r&&o.push(n?n(r,e[i]):r)}return o})(n,o,((e,t)=>En(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(Rn(t,s,l,a,c))}function An(e,t,n,o,r,i,s,a){o?e.addSource(`${t}-line-source`,Fn(o(n).map((e=>Mn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:Mn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(Wn(t,r,i,s,a))}function Dn(e,t,n,o,r,i,s,a){if(o){const r=n.length,i=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)i.push(Mn(t[e]))}e.addSource(`${t}-line-source`,Fn(i))}else e.addSource(`${t}-line-source`,Fn(n.map((e=>Mn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(Wn(t,r,i,s,a))}function Rn(e,t,n,o,r){const[i,s]=jt(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":r,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?Sn[t]:i,"icon-halo-width":1,"icon-halo-color":"#000","text-color":i,"text-opacity":Math.max(s,.7)}}}function Wn(e,t,n,o=2,r=!1){const[i,s]=jt(t);return{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":i,"line-opacity":s,"line-width":o,"line-dasharray":r?[10,10]:[1]}}}function Nn(e,t,n=1){const{map:o,value:r,kmlOptions:i}=t,s=`${e}-marker-layer`,a=i[`${He(e)}Pin`];return o.getLayer(s)&&o.setLayoutProperty(s,"icon-size",a?In(r,n):.2),!0}function Hn(e,t,n=10){const{map:o,value:r}=t,i=`${e}-marker-layer`;return o.getLayer(i)&&o.setLayoutProperty(i,"text-size",jn(r,n)),!0}function Un(e,t,n=2){const{map:o,value:r}=t,i=`${e}-line-layer`;return o.getLayer(i)&&o.setPaintProperty(i,"line-width",Tn(r,n)),!0}function Gn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`;if(n.getLayer(i)&&n.getLayer(r)){const e=o,t=Sn[e],s=n.getPaintProperty(r,"line-color");n.setPaintProperty(i,"icon-color",0!==e?t:s),n.setPaintProperty(i,"text-color",s),n.setLayoutProperty(i,"icon-size",0!==e?1:.2),n.setLayoutProperty(i,"icon-image",0!==e?"sdf-marker-15":"sdf-triangle"),n.setLayoutProperty(i,"icon-anchor",0!==e?"bottom":"center")}return!0}function qn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`,[s,a]=jt(o);return n.getLayer(r)&&(n.setPaintProperty(r,"line-color",s),n.setPaintProperty(r,"line-opacity",a)),n.getLayer(i)&&n.setPaintProperty(i,"text-color",s),!0}function Bn(e,t,n){const{map:o}=n,r=`${e}-line-layer`,i=`${e}-marker-layer`;return o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(i)&&o.setLayoutProperty(i,"visibility",t?"visible":"none"),!0}const Kn="airport-layer",Zn="airport-emer-layer",Vn="airport-source",Xn=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Jn=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],Yn=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],Qn=e=>0===e?3:0,eo=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"],to=(e,t)=>["case",["in",["get","name"],["literal",e]],jn(t,10),jn(t,8,1.15)],no=e=>jn(e,8,1.15),oo=(e,t)=>["case",["in",["get","name"],["literal",e]],In(t,1),In(t,.6)],ro=e=>["case",["==",2,["get","level"]],In(e,.5,1.2),In(e,.4,1.2)];function io(e,t){const{map:n}=e;n.getLayer(Kn)&&n.setLayoutProperty(Kn,"visibility",t?"visible":"none"),n.getLayer(Zn)&&n.setLayoutProperty(Zn,"visibility",t?"visible":"none")}const so=e=>{const t=e.isFake?[]:e.infos.ralts;let n=[];return e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(n=[e.infos.EEP.name,e.infos.EXP.name]),[t,n.concat(t)]};var ao={show:e=>io(e,!0),hide:e=>io(e,!1),add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r}=e,{affineOrDrop:i}=n,s=i;let a=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(a=[o.infos.EEP,o.infos.EXP]);const l=o.isFake?o.isFake:o.infos.aircraft,c=o.infos.raltPoints,u=r.etopsColor,p=r.airportPin,d=r.airportDisplay,[m]=jt(u),f=a.map((e=>e.name)),g=c.map((e=>e.name)),h=f.concat(g);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((e=>{if(s){const t=[];for(let n of e.features)n.geometry.coordinates=s(n.geometry.coordinates),void 0!==n.geometry.coordinates&&t.push(n);e.features=t}t.addSource(Vn,{type:"geojson",data:e}),t.addLayer({id:Zn,type:"symbol",source:Vn,layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":ro(r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":no(r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Jn(l,!1)}),t.addLayer({id:Kn,type:"symbol",source:Vn,layout:{"icon-image":["case",["in",["get","name"],["literal",h]],"sdf-triangle","sdf-airport"],"icon-size":oo(h,r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":to(h,r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Yn(l,h)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":Qn(p),"icon-color":Xn(p,l,g,m),"text-color":eo(g,m),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Jn(l)});const n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!Re}),o=function(e){const o=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.title;for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;n.setLngLat(o).setHTML(r).addTo(t)},i=()=>t.getCanvas().style.cursor="pointer",a=()=>t.getCanvas().style.cursor="",c=function(){a(),n.remove()};Re?(t.on("mouseenter",Kn,(e=>{i(),o(e)})),t.on("mouseenter",Zn,(e=>{i(),o(e)})),t.on("mouseleave",Kn,c),t.on("mouseleave",Zn,c)):(t.on("mouseenter",Kn,i),t.on("mouseenter",Zn,i),t.on("click",Kn,o),t.on("click",Zn,o),t.on("mouseleave",Kn,a),t.on("mouseleave",Zn,a))}))},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,i=o.isFake?[]:o.infos.ralts,[s]=jt(n.etopsColor),a=n.airportPin;t.getLayer(Kn)&&(t.setPaintProperty(Kn,"icon-color",Xn(a,r,i,s)),t.setPaintProperty(Kn,"text-color",eo(i,s)),t.setPaintProperty(Kn,"icon-halo-width",Qn(a)))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,[i,s]=so(r),[a]=jt(n.etopsColor),l=n.airportPin;t.setFilter(Kn,Jn(o)),t.setPaintProperty(Kn,"icon-color",Xn(l,o,i,a)),t.setLayoutProperty(Kn,"symbol-sort-key",Yn(o,s)),t.setFilter(Zn,Jn(o,!1))},changeIconText:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=so(o);t.getLayer(Kn)&&t.setLayoutProperty(Kn,"text-size",to(r,n.iconTextChange)),t.getLayer(Zn)&&t.setLayoutProperty(Zn,"text-size",no(n.iconTextChange))},changeIconSize:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=so(o);t.getLayer(Kn)&&t.setLayoutProperty(Kn,"icon-size",oo(r,n.iconSizeChange)),t.getLayer(Zn)&&t.setLayoutProperty(Zn,"icon-size",ro(n.iconSizeChange))}};const lo="etops-ep-circle-line-layer",co="etops-etops-circle-line-layer";function uo(e,t){const{map:n}=e;n.getLayer(co)&&n.setLayoutProperty(co,"visibility",t?"visible":"none"),n.getLayer(lo)&&n.setLayoutProperty(lo,"visibility",t?"visible":"none")}var po={show:e=>uo(e,!0),hide:e=>uo(e,!1),add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(o.isFake)return;const i=Tn(r.lineWidthChange,1);if(o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n;o.infos.EEP,o.infos.EXP;const s=o.infos.ETOPS,a=r.etopsDisplay;Dn(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,a,i,!0),Dn(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*s))),e,r.etopsColor,a,i,!0)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=jt(e.value);t.getLayer(co)&&(t.setPaintProperty(co,"line-color",n),t.setPaintProperty(co,"line-opacity",o))}(e),changeLineWidth:function(e){const{map:t,value:n}=e,o=Tn(n,1);return t.getLayer(co)&&t.setPaintProperty(co,"line-width",o),t.getLayer(lo)&&t.setPaintProperty(lo,"line-width",o),!0}};const mo="fir-reg-line-layer",fo="fir-reg-layer",go="fir-reg-source";function ho(e,t){const{map:n}=e;n.getLayer(fo)&&n.setLayoutProperty(fo,"visibility",t?"visible":"none"),n.getLayer(mo)&&n.setLayoutProperty(mo,"visibility",t?"visible":"none")}var vo={show:e=>ho(e,!0),hide:e=>ho(e,!1),add:e=>{const{map:t,mapData:n,kmlOptions:o,mapOptions:r}=e;if("jb_pacific"===r.id)return;const{affine:i}=n,s=o.firDisplay;fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((e=>{if(i)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>i(e)))]}t.addSource(go,{type:"geojson",data:e}),t.addLayer({id:fo,type:"fill",source:go,layout:{visibility:s?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),t.addLayer({id:mo,type:"line",source:go,layout:{visibility:s?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))}};const yo="great-circle";var $o={show:Bn.bind(null,yo,!0),hide:Bn.bind(null,yo,!1),add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r}=e;if(t.isFake)return;const{affineAndClip:i}=o,s=`${t.infos.departure}-${t.infos.destination}`,a=t.route,l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${s}`});An(r,yo,l.points,i,n.greatCircleColor,n.greatCircleDisplay)},changeLine:qn.bind(null,yo)};const bo="ogimet";var xo={show:Bn.bind(null,bo,!0),hide:Bn.bind(null,bo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i}=r;An(t,bo,n.ogimetData.route.points,i,o.ogimetColor,o.ogimetDisplay)},changeLine:qn.bind(null,bo)};const wo="ralt";var ko={show:Bn.bind(null,wo,!0),hide:Bn.bind(null,wo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:s}=r,a=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route Dégagement"});An(t,wo,a.points,i,o.alternateColor,o.alternateDisplay),zn(t,wo,a.points,s,o)},changeLine:qn.bind(null,wo),changeMarker:Gn.bind(null,wo),changeIconText:Hn.bind(null,wo),changeLineWidth:Un.bind(null,wo),changeIconSize:Nn.bind(null,wo)};const Po="rmain";var Co={show:Bn.bind(null,Po,!0),hide:Bn.bind(null,Po,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:s}=r,a=n.route;a.name=`${n.infos.departure}-${n.infos.destination}`,a.description=n.description,An(t,Po,a.points,i,o.routeColor,!0),zn(t,Po,a.points,s,o)},changeLine:e=>qn(Po,e)&&function(e){const{map:t,kmlOptions:n}=e,[o,r]=jt(n.routeColor);t.getLayer(lo)&&(t.setPaintProperty(lo,"line-color",o),t.setPaintProperty(lo,"line-opacity",r))}(e),changeMarker:Gn.bind(null,Po),changeIconText:Hn.bind(null,Po),changeLineWidth:Un.bind(null,Po),changeIconSize:Nn.bind(null,Po)};const Lo="rnat";const Oo={airport:ao,etops:po,fir:vo,greatcircle:$o,ogimet:xo,ralt:ko,rmain:Co,rnat:{show:e=>Bn(Lo,!0,e)&&Bn("rnat-incomplete",!0,e),hide:e=>Bn(Lo,!1,e)&&Bn("rnat-incomplete",!1,e),add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r}=e;if(n.isFake)return;const{affineOrDrop:i,affineAndClip:s}=o,a=i,l=s,c=r.natColor,u=r.natPin,p=r.natDisplay,d={rnat:[],"rnat-incomplete":[]},m={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(l){const n=l(e.points),o=n.length;for(let r=0;r<o;r++)d[t].push(Mn(n[r],e.name))}else d[t].push(Mn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const n=e.points[0];let o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude];if(o&&m[t].push(En(o,`${e.name}\n${n.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude],o&&m[t].push(En(o,`${e.name}\n${n.name}`,e.description))}}t.addSource("rnat-marker-source",Fn(m.rnat)),t.addSource("rnat-incomplete-marker-source",Fn(m["rnat-incomplete"])),t.addSource("rnat-line-source",Fn(d.rnat)),t.addSource("rnat-incomplete-line-source",Fn(d["rnat-incomplete"]));const f=jn(r.iconTextChange,10),g=Tn(r.lineWidthChange,1);t.addLayer(Wn("rnat",c,p,g)),t.addLayer(Wn("rnat-incomplete",r.natIncompleteColor,p,g)),t.addLayer(Rn("rnat",u,c,p,f)),t.addLayer(Rn("rnat-incomplete",u,c,p,f));const h=e=>{for(var n=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties.description;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(t)},v=e=>{const n=e+"-marker-layer";t.on("click",n,h),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};v("rnat"),v("rnat-incomplete")},changeLine:qn.bind(null,Lo),changeMarker:Gn.bind(null,Lo),changeIconText:function(e){const{map:t,value:n}=e,o=jn(n,10);return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","text-size",o),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","text-size",o),!0},changeLineWidth:function(e){const{map:t,value:n}=e,o=Tn(n,1);return t.getLayer("rnat-line-layer")&&t.setPaintProperty("rnat-line-layer","line-width",o),t.getLayer("rnat-incomplete-line-layer")&&t.setPaintProperty("rnat-incomplete-line-layer","line-width",o),!0},changeIconSize:function(e){const{map:t,value:n,kmlOptions:o}=e,r=o.natPin?In(n,1):.2;return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","icon-size",r),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","icon-size",r),!0}}},_o=2*Math.PI,Eo=Math.PI/4,Fo=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*_o};var Mo={init:function(){},forward:function(e){var t=e.x,n=e.y,o=Fo(t-this.long0),r=Math.tan(n/2),i=Math.sin(Eo*r),s=i*i,a=this.x0+this.a*o*(.74482-.34588*s),l=this.y0+1.70711*this.a*r;return e.x=a,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(Eo*t),o=n*n,r=Fo(this.long0+e.x/this.a/(.74482-.34588*o)),i=2*Math.atan(t);return e.x=r,e.y=i,e},names:["The Times","times"]};function So(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(Mo);let i={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${t.id.startsWith("jb_")?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const s=new mapboxgl.Map({...t.mapboxOptions,...i});let a,l,c,u;s._setCacheLimits(320,32),s.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||s.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||s.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||s.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),s.loadImage("sdf/map-star-sdf.png",(function(e,t){e||s.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let p,d=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const i=[-20026376.39,-20048966.1,20026376.39,20048966.1],s=i[2]-i[0],a=i[3]-i[1],[l,c,u,p]=t.extent,[d,m]=t.ratio,f=s/d*m*(a/s),[g,h,v,y]=[i[0],i[3]-f,i[2],i[3]];e=(v-g)/(u-l),n=g-e*l,o=(y-h)/(p-c),r=h-o*c}else{const[i,s,a,l]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(a-i),n=c-e*i,o=(d-u)/(l-s),r=u-o*s}const[i,s,p,f]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>m(h(e));d=e=>h(g(e)),a=e=>m(d(e)),l=e=>{let[t,n]=g(e);return t=Ue(t,i,p),n=Ue(n,s,f),v([t,n])},c=e=>{let[t,n]=g(e);if(Ge(t,i,p)&&Ge(n,s,f))return v([t,n])},u=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,i,s,a,l=e.length,c=Be(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],s=a=Be(i=e[o],t);;){if(!(c|s)){u.push(r),s!==a?(u.push(i),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(i);break}if(c&s)break;c?c=Be(r=qe(r,i,c,t),t):s=Be(i=qe(r,i,s,t),t)}c=a}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let f=[];if(!n.isFake){for(const e of n.tracks)f=f.concat(e.points);f=f.concat(n.route.points,n.wptCoordinatesAlternate()),p=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(f,l),s.fitBounds(p,{padding:{top:30,bottom:80,left:30,right:30}})}const g=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(a){const e=g._onSuccess;g._onSuccess=function(t){const[n,o]=a([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const h={map:s,affine:a,affineAndClamp:l,affineAndClip:u,affineOrDrop:c,bbox:p,mapOptions:t};return s.addControl(new class{onAdd(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl  mapboxgl-ctrl-group",this._button=document.createElement("button"),this._button.className="mapboxgl-ctrl-layers",this._button.setAttribute("type","button"),this._button.setAttribute("title","Personnaliser la carte"),this._button.innerHTML='<svg><use xlink:href="#layers-symbol"/></svg>',this._container.appendChild(this._button),this._toggleSidebar=()=>it.update((e=>!e)),this._button.addEventListener("click",this._toggleSidebar),this._container}onRemove(){this._button.removeEventListener("click",this._toggleSidebar),this._container.parentNode.removeChild(this._container),this._map=void 0}}),s.addControl(g),s.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),Object.values(Oo).forEach((t=>t.add&&t.add(e)))})({ofp:n,kmlOptions:o,mapData:h,map:s,mapOptions:t}),r&&r(s,t)})),h}class jo{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const i=indexedDB.open(e,t);i.onsuccess=()=>{o(i)},i.onerror=()=>{r("Error while opening DB")},i.onupgradeneeded=n?n.bind(null,i):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const i=n.result.transaction(t,"readonly").objectStore(t).get(e);i.onsuccess=()=>{o(i.result)},i.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,i)=>{const s=o.result.transaction(t,"readwrite").objectStore(t),a=s.put(n,e);a.onsuccess=()=>{const t=s.get(e);t.onsuccess=()=>{r(t.result)}},a.onerror=()=>{i("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,i)=>{const s=o.result.transaction(e,"readonly").objectStore(e).getKey(n);s.onsuccess=()=>{r(void 0===s.result?t:null)},s.onerror=()=>{i("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function To(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Io(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const zo=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(!n)return[];const i=new jo("lido-tiles");if(o.cacheAll){const e=await i.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return i.close(),caches[o.id]=!0,[]}const[s,a]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,p;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:To(s[0],e),y:Io(s[1],e)},r={x:To(a[0],e),y:Io(a[1],e)}),o.matrix?[u,p]=o.matrix[e]:[u,p]=[c,c];for(let s=t.x;s<=r.x;s++)for(let a=r.y;a<=t.y;a++)if(s>=0&&a>=0&&s<u&&a<p){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",s).replace("{y}",a)),l.push(i.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.63g5ah66/${e}/${s}/${a}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${e}/${s}/${a}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return i.close(),c.filter((e=>null!==e))};function Ao(e){let t,n,o,r,i,s;const a=e[4].default,l=u(a,e,e[3],null);return{c(){t=F("svg"),n=F("path"),o=F("path"),i=S(),l&&l.c(),z(n,"d","M50,5A45 45 0 1 1 49.9999 5"),z(n,"class","svelte-1bp2w4i"),z(o,"d",r=e[0]()),z(o,"class","svelte-1bp2w4i"),z(t,"viewBox","0 0 100 100"),z(t,"class","svelte-1bp2w4i")},m(e,r){C(e,t,r),P(t,n),P(t,o),C(e,i,r),l&&l.m(e,r),s=!0},p(e,[t]){(!s||1&t&&r!==(r=e[0]()))&&z(o,"d",r),l&&l.p&&8&t&&d(l,a,e,e[3],t,null,null)},i(e){s||(Pe(l,e),s=!0)},o(e){Ce(l,e),s=!1},d(e){e&&L(t),e&&L(i),l&&l.d(e)}}}function Do(e,t,n){let o,{$$slots:r={},$$scope:i}=t,{value:s=0}=t,{max:a=100}=t;return e.$$set=e=>{"value"in e&&n(1,s=e.value),"max"in e&&n(2,a=e.max),"$$scope"in e&&n(3,i=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(s<=0)return"";if(s>=a)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(s/a),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,s,a,i,r]}class Ro extends Te{constructor(e){super(),je(this,e,Do,Ao,a,{value:1,max:2})}}function Wo(e,t,n){const o=e.slice();return o[15]=t[n],o}function No(e){let t,n,o,r,s,a=qo,l=[];for(let t=0;t<a.length;t+=1)l[t]=Ho(Wo(e,a,t));return{c(){t=E("div"),n=E("select"),o=E("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,z(n,"class","form-control-sm svelte-1oiejem"),n.disabled=e[0],z(t,"class","footer svelte-1oiejem")},m(i,a){C(i,t,a),P(t,n),P(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);r||(s=[T(n,"click",e[4],{once:!0}),T(n,"change",e[6])],r=!0)},p(e,t){if(0&t){let o;for(a=qo,o=0;o<a.length;o+=1){const r=Wo(e,a,o);l[o]?l[o].p(r,t):(l[o]=Ho(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}1&t&&(n.disabled=e[0])},d(e){e&&L(t),O(l,e),r=!1,i(s)}}}function Ho(t){let n,o,r=t[15]+"";return{c(){n=E("option"),o=M(r),n.__value=t[15],n.value=n.__value},m(e,t){C(e,n,t),P(n,o)},p:e,d(e){e&&L(n)}}}function Uo(t){let n,o,r,s,a,l,c,u,p,d=!t[3]&&No(t);return{c(){n=E("div"),o=E("input"),r=S(),s=E("label"),a=M(t[1]),l=S(),d&&d.c(),c=j(),z(o,"id",Ko),z(o,"name",Ko),z(o,"type","file"),z(o,"accept","application/pdf"),o.disabled=t[0],z(o,"class","custom-file-input svelte-1oiejem"),z(s,"class","custom-file-label text-truncate svelte-1oiejem"),z(s,"for",Ko),q(s,"ready",t[2]),z(n,"class","custom-file svelte-1oiejem"),q(n,"blink",!t[3])},m(e,i){C(e,n,i),P(n,o),P(n,r),P(n,s),P(s,a),C(e,l,i),d&&d.m(e,i),C(e,c,i),u||(p=[T(o,"change",t[5]),T(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){1&t&&(o.disabled=e[0]),2&t&&W(a,e[1]),4&t&&q(s,"ready",e[2]),8&t&&q(n,"blink",!e[3]),e[3]?d&&(d.d(1),d=null):d?d.p(e,t):(d=No(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&L(n),e&&L(l),d&&d.d(e),e&&L(c),u=!1,i(p)}}}const Go=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.7.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.7.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"script",url:"https://unpkg.com/pinch-zoom-element-js@1.1.2/dist/pinch-zoom-min.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],qo=["318","319","320","321","330","340","350","380","787","772","773","77F"],Bo=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let Ko="file";function Zo(e,t,n){let o,r,i,s;c(e,st,(e=>n(9,o=e))),c(e,ct,(e=>n(10,r=e))),c(e,lt,(e=>n(3,i=e))),c(e,pt,(e=>n(11,s=e)));let a,{kmlOptions:l}=t,u=!1,p=new Ie,d="Choisir un OFP",m=!1;const f=te();function g(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const i="script"===e,s=document.createElement(i?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(s.crossOrigin="anonymous");let a=!0;i?(s.src=t,s.async=n.async,s.defer=n.defer):(s.href=t,"prefetch"in n?(s.rel="prefetch",o-=1,a=!1):"preload"in n?(s.rel="preload",o-=1,a=!1):(s.rel="stylesheet",o-=1,a=!1)),a&&(s.onload=r),document.body.appendChild(s)}))}(Go,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",a&&!a.destroyed||(a=new e.PDFWorker),p.resolve(!0),n(2,m=!0)}))}const v=e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onload=e=>{if(!a||a.destroyed){const e=window["pdfjs-dist/build/pdf"];a=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,i=r.numPages;for(let e=1;e<=i;e+=1){const t=await Bo(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:a}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const i=editolido.ogimetData(t,r);i.proxyImg=`https://ofp2map-gramet.vercel.app/api/${i.proxy}__${i.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,i.route.description=i.wmo.join(" "),t.ogimetData=i;try{_t(),function(e,t){let n={...Lt,...t};const o=_t();Ot(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const i=`${e.infos.departure}-${e.infos.destination}`,s=new editolido.Route(e.wptCoordinates(),{name:i,description:r}),a=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),l=new editolido.Route([s.points[0],s.points[s.points.length-1]]).split(300,{name:`Ortho ${i}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",s),o.addPoints("rmain",s,{excluded:c}),o.addLine("ralt",a),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",a)}(t,l),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>{o(e)}))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(7,l=e.kmlOptions)},[u,d,m,i,g,async function(e){n(0,u=!0),h(st,o=!1,o),g(),await p.promise.then((()=>{const t=e.target.files[0];t&&(h(ct,r="loading",r),n(1,d=e.target.value.split(/([\\/])/g).pop()),f("change",d),v(t).then((e=>{h(lt,i=e,i),h(pt,s=!1,s),h(ct,r="success",r)}),(e=>h(ct,r=e,r))),window.location.hash="#/map")})),n(0,u=!1)},async function(e){n(0,u=!0),h(ct,r="loading",r),g(),await p.promise.then((()=>{let t=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");try{_t(),h(pt,s=e.target.value,s),t.isFake=e.target.value,h(lt,i=t,i),h(ct,r="success",r)}catch(e){h(ct,r=e,r)}window.location.hash="#/map"})),n(0,u=!1)},l]}class Vo extends Te{constructor(e){super(),je(this,e,Zo,Uo,a,{kmlOptions:7})}}function Xo(e,t,n){const o=e.slice();return o[6]=t[n],o}function Jo(e){let t;return{c(){t=E("option"),t.textContent="???",t.__value="???",t.value=t.__value,t.selected=!0},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Yo(e){let t,n,o,r=e[6]+"";return{c(){t=E("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&L(t)}}}function Qo(t){let n,o,r,s,a="???"===t[0]&&Jo(),l=qo,c=[];for(let e=0;e<l.length;e+=1)c[e]=Yo(Xo(t,l,e));return{c(){n=E("select"),a&&a.c(),o=j();for(let e=0;e<c.length;e+=1)c[e].c();z(n,"name","aircraftType"),z(n,"class","svelte-1xpiicm"),void 0===t[0]&&pe((()=>t[5].call(n)))},m(e,i){C(e,n,i),a&&a.m(n,null),P(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[4](n),U(n,t[0]),r||(s=[T(n,"change",t[5]),T(n,"change",t[3])],r=!0)},p(e,[t]){if("???"===e[0]?a||(a=Jo(),a.c(),a.m(n,o)):a&&(a.d(1),a=null),1&t){let o;for(l=qo,o=0;o<l.length;o+=1){const r=Xo(e,l,o);c[o]?c[o].p(r,t):(c[o]=Yo(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}1&t&&U(n,e[0])},i:e,o:e,d(e){e&&L(n),a&&a.d(),O(c,e),t[4](null),r=!1,i(s)}}}function er(e,t,n){let{selectedAircraft:o="???"}=t,{aircraftTypeSelectElement:r=null}=t,{ofp:i}=t;return ee((()=>{"???"===o&&i&&n(0,o=i.isFake?i.isFake:i.infos.aircraft),-1===qo.indexOf(o)&&n(0,o="???")})),e.$$set=e=>{"selectedAircraft"in e&&n(0,o=e.selectedAircraft),"aircraftTypeSelectElement"in e&&n(1,r=e.aircraftTypeSelectElement),"ofp"in e&&n(2,i=e.ofp)},[o,r,i,function(t){ne(e,t)},function(e){re[e?"unshift":"push"]((()=>{r=e,n(1,r)}))},function(){o=G(this),n(0,o)}]}class tr extends Te{constructor(e){super(),je(this,e,er,Qo,a,{selectedAircraft:0,aircraftTypeSelectElement:1,ofp:2})}}const nr={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},or=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,rr=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv1",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:nr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:or},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:nr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:or},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:nr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:or},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:nr,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:or}];function ir(e,t,n){const o=e.slice();return o[6]=t[n],o[8]=n,o}function sr(e){let t,n,o,r=(e[6].proj4&&e[2](e[6])?`${e[6].label.toUpperCase()}`:e[6].label)+"";return{c(){t=E("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6].id===e[0].id},m(e,o){C(e,t,o),P(t,n)},p(e,n){1&n&&o!==(o=e[6].id===e[0].id)&&(t.selected=o)},d(e){e&&L(t)}}}function ar(t){let n,o,r,s=rr,a=[];for(let e=0;e<s.length;e+=1)a[e]=sr(ir(t,s,e));return{c(){n=E("select");for(let e=0;e<a.length;e+=1)a[e].c();z(n,"name",t[1]),z(n,"class","form-control form-control-sm svelte-1uc3ace"),void 0===t[0]&&pe((()=>t[5].call(n)))},m(e,i){C(e,n,i);for(let e=0;e<a.length;e+=1)a[e].m(n,null);U(n,t[0]),o||(r=[T(n,"change",t[5]),T(n,"change",t[4])],o=!0)},p(e,[t]){if(5&t){let o;for(s=rr,o=0;o<s.length;o+=1){const r=ir(e,s,o);a[o]?a[o].p(r,t):(a[o]=sr(r),a[o].c(),a[o].m(n,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=s.length}2&t&&z(n,"name",e[1]),1&t&&U(n,e[0])},i:e,o:e,d(e){e&&L(n),O(a,e),o=!1,i(r)}}}function lr(e,t,n){let{name:o="map-style"}=t,{ofp:r}=t,{selected:i=rr[0]}=t;return ee((()=>{if(i.id===rr[0].id&&r&&!r.isFake){const e=r.route.points[0],t=r.route.points[r.route.points.length-1];t.latitude>30&&e.latitude>30?n(0,i=rr[1]):t.longitude<-80&&e.longitude<-80?n(0,i=rr[3]):n(0,i=rr[2])}})),e.$$set=e=>{"name"in e&&n(1,o=e.name),"ofp"in e&&n(3,r=e.ofp),"selected"in e&&n(0,i=e.selected)},[i,o,function(e){if(!e.proj4||!r||r.isFake)return!0;const t=r.route.points[0],n=r.route.points[r.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},r,function(t){ne(e,t)},function(){i=G(this),n(0,i)}]}class cr extends Te{constructor(e){super(),je(this,e,lr,ar,a,{name:1,ofp:3,selected:0})}}const ur=et();function pr(e,{ofp:t,pos:n}){const o=document.getElementById("gt-plane");let r,i,s,a,l=parseFloat(n),c=t.description;const u=e.clientHeight,p=e.clientWidth,d=getComputedStyle(document.body),m=parseFloat(d.getPropertyValue("--gramet-inner-height",395).slice(0,-2)),f=e=>65*a+(s-130*a)*e/100,g=(e,t,n)=>{e&&(e.style.left=n+(f(t)-e.clientWidth/2)+"px",e.style.top=120*a-e.clientHeight/2+"px")},h=e=>{const t=f(e),n=65*a,o=p/3,r=n+o,i=s-n-(p-o);return t>r&&t<i?o-t:t<=r?o-r:o-i},v=()=>{const t=r.height;i=r.cloneNode(),i.id="grametImg",i.style.display="none",i.crossOrigin="anonymous",i.addEventListener("load",y),i.addEventListener("error",$),document.body.appendChild(i),r.style.height=t/m*u+"px",r.style.objectFit="contain",r.style.position="absolute",r.style.opacity=.01,e.appendChild(r),s=r.clientWidth;const n=r.clientHeight/t;a=n;const o=h(l);r.style.top=`-${31*n}px`,r.style.left=`${o}px`},y=()=>{ur.set("success"),o.style.display="block",r.style.opacity=1;const e=h(l);g(o,l,e)},$=()=>{o.style.display="none",ur.set("error")},b=()=>{r&&r.removeEventListener("load",v),r&&r.removeEventListener("error",$),r&&r.remove(),i&&i.removeEventListener("load",y),i&&i.removeEventListener("error",$),i&&i.remove(),i=void 0,r=void 0},x=async e=>{r=document.createElement("img"),r.addEventListener("load",v),r.addEventListener("error",$),ur.set("loading"),o.style.display="none",r.src=e.ogimetData.proxyImg,r.crossOrigin="anonymous"};return x(t),{update({ofp:e,pos:t}){if(l=parseFloat(t),e.description!==c)c=e.description,b(),x(e);else{const e=h(l);r.style.left=e+"px",g(o,l,e)}},destroy(){b()}}}const dr=(e,{pos:t,fl:n})=>{const o=e.parentNode.querySelector("svg"),r=document.getElementById("grametImg"),i=getComputedStyle(document.body),s=parseFloat(i.getPropertyValue("--gramet-inner-height",395).slice(0,-2)),a=parseFloat(e.parentNode.dataset.maxHeight||"370"),l=r.width,c=document.querySelector("nav").clientWidth;let u,p,d=parseFloat(t),m=0,f=0,g=parseFloat(n);const h=e=>(65+(l-130)*e/100)*u,v=(e,t,n)=>{e.style.left=m+(h(t)-e.clientWidth/2)+"px",e.style.top=(-.57*n+292+31)*u-e.clientHeight/2+f+"px"},y=e=>{const t=h(e),n=c/3,o=0+n,r=l*u-0-(c-n);return t>o&&t<r?n-t:t<=o?n-o:n-r},$=()=>{m=e.x,f=e.y,u=e.scale,p=c<=l*u,v(o,d,g)};return d<=0||d>=100?(u=Math.min(c/l,a/(s+50)),f=0):(u=a/s,f=-31*u),c>l*u?(m=(c-l*u)/2,p=!1):(m=y(d),p=!0),v(o,d,g),r.style.display="block",e.style.maxHeight=`${a}px`,e.appendChild(r),e.setTransform({scale:u,x:m,y:f}),e.addEventListener("change",$),{update({pos:t,fl:n}){d=parseFloat(t),g=parseFloat(n),p&&(m=y(d),e.setTransform({x:m})),v(o,d,g)},destroy(){r.style.display="none",document.body.appendChild(r),e.removeEventListener("change",$)}}},mr=e=>{const t=document.getElementById("grametImg"),n=t.width,o=t.height,r=parseFloat(e.dataset.maxHeight||"370"),i=document.querySelector("nav").clientWidth/n,s=Math.min(i*o,r);e.style.height=`${s}px`};function fr(e){let t,n,o,r,a,l,c,u,p,d;return{c(){var e,o,i;t=E("div"),n=E("pinch-zoom"),r=S(),a=F("svg"),l=F("use"),i="0.3",(o="min-scale")in(e=n)?e[o]=i:z(e,o,i),D(l,"xlink:href","#plane-symbol"),z(a,"class","svelte-2odmw2"),z(t,"class","pinch-zoom-parent svelte-2odmw2"),z(t,"data-max-height",gr)},m(i,s){C(i,t,s),P(t,n),P(t,r),P(t,a),P(a,l),u=!0,p||(d=[v(o=dr.call(null,n,{pos:e[0],fl:e[1].get("fl")})),v(mr.call(null,t))],p=!0)},p(t,[n]){e=t,o&&s(o.update)&&1&n&&o.update.call(null,{pos:e[0],fl:e[1].get("fl")})},i(e){u||(pe((()=>{c||(c=Oe(t,Je,{y:gr},!0)),c.run(1)})),u=!0)},o(e){c||(c=Oe(t,Je,{y:gr},!1)),c.run(0),u=!1},d(e){e&&L(t),e&&c&&c.end(),p=!1,i(d)}}}const gr=370;function hr(e,t,n){let o,r;c(e,lt,(e=>n(2,o=e))),c(e,vt,(e=>n(0,r=e)));const i=new URL(o.ogimetData.url).searchParams;return[r,i]}class vr extends Te{constructor(e){super(),je(this,e,hr,fr,a,{})}}function yr(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const i=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",i,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",i),n&&n.remove()}}}function $r(e){let t,n,o,r,i;return n=new Ro({props:{value:e[8],max:e[7],$$slots:{default:[br]},$$scope:{ctx:e}}}),{c(){t=E("div"),Fe(n.$$.fragment),z(t,"class","cacheButton svelte-1nye16d"),q(t,"cacheError",e[9]),q(t,"cacheProgress",e[8]>0||e[7]>0)},m(a,l){C(a,t,l),Me(n,t,null),o=!0,r||(i=T(t,"click",(function(){s(e[11]?kr:e[18])&&(e[11]?kr:e[18]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const i={};256&r&&(i.value=e[8]),128&r&&(i.max=e[7]),67108864&r&&(i.$$scope={dirty:r,ctx:e}),n.$set(i),512&r&&q(t,"cacheError",e[9]),384&r&&q(t,"cacheProgress",e[8]>0||e[7]>0)},i(e){o||(Pe(n.$$.fragment,e),o=!0)},o(e){Ce(n.$$.fragment,e),o=!1},d(e){e&&L(t),Se(n),r=!1,i()}}}function br(e){let t;const n=e[20].default,o=u(n,e,e[26],null),r=o||function(e){let t;return{c(){t=E("span"),t.textContent="↓",z(t,"class","svelte-1nye16d")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}();return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){o&&o.p&&67108864&t&&d(o,n,e,e[26],t,null,null)},i(e){t||(Pe(r,e),t=!0)},o(e){Ce(r,e),t=!1},d(e){r&&r.d(e)}}}function xr(e){let t,n;return t=new vr({}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function wr(e){let t,n,o,r,i,a,l,c,u,p,d,m,f,g,h,y,$,b,x;function w(t){e[21](t)}let k={ofp:e[1]};void 0!==e[4]&&(k.selected=e[4]),i=new cr({props:k}),re.push((()=>Ee(i,"selected",w))),i.$on("change",e[15]);let O=e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]&&$r(e);function _(t){e[22](t)}function F(t){e[23](t)}let M={ofp:e[1]};function T(t){e[24](t)}void 0!==e[5]&&(M.selectedAircraft=e[5]),void 0!==e[6]&&(M.aircraftTypeSelectElement=e[6]),u=new tr({props:M}),re.push((()=>Ee(u,"selectedAircraft",_))),re.push((()=>Ee(u,"aircraftTypeSelectElement",F))),u.$on("change",e[16]);let I={};void 0!==e[0]&&(I.kmlOptions=e[0]),f=new _n({props:I}),re.push((()=>Ee(f,"kmlOptions",T))),f.$on("change",e[17]),f.$on("save",e[25]);let A=e[14]&&xr();return{c(){t=E("div"),o=S(),r=E("div"),Fe(i.$$.fragment),l=S(),O&&O.c(),c=S(),Fe(u.$$.fragment),m=S(),Fe(f.$$.fragment),h=S(),A&&A.c(),y=j(),z(t,"id",e[2]),z(t,"class","svelte-1nye16d"),z(r,"class","mapmenu svelte-1nye16d")},m(s,a){C(s,t,a),C(s,o,a),C(s,r,a),Me(i,r,null),P(r,l),O&&O.m(r,null),C(s,c,a),Me(u,s,a),C(s,m,a),Me(f,s,a),C(s,h,a),A&&A.m(s,a),C(s,y,a),$=!0,b||(x=v(n=yr.call(null,t,e[3])),b=!0)},p(e,[o]){(!$||4&o)&&z(t,"id",e[2]),n&&s(n.update)&&8&o&&n.update.call(null,e[3]);const l={};2&o&&(l.ofp=e[1]),!a&&16&o&&(a=!0,l.selected=e[4],de((()=>a=!1))),i.$set(l),e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]?O?(O.p(e,o),13330&o&&Pe(O,1)):(O=$r(e),O.c(),Pe(O,1),O.m(r,null)):O&&(we(),Ce(O,1,1,(()=>{O=null})),ke());const c={};2&o&&(c.ofp=e[1]),!p&&32&o&&(p=!0,c.selectedAircraft=e[5],de((()=>p=!1))),!d&&64&o&&(d=!0,c.aircraftTypeSelectElement=e[6],de((()=>d=!1))),u.$set(c);const m={};!g&&1&o&&(g=!0,m.kmlOptions=e[0],de((()=>g=!1))),f.$set(m),e[14]?A?16384&o&&Pe(A,1):(A=xr(),A.c(),Pe(A,1),A.m(y.parentNode,y)):A&&(we(),Ce(A,1,1,(()=>{A=null})),ke())},i(e){$||(Pe(i.$$.fragment,e),Pe(O),Pe(u.$$.fragment,e),Pe(f.$$.fragment,e),Pe(A),$=!0)},o(e){Ce(i.$$.fragment,e),Ce(O),Ce(u.$$.fragment,e),Ce(f.$$.fragment,e),Ce(A),$=!1},d(e){e&&L(t),e&&L(o),e&&L(r),Se(i),O&&O.d(),e&&L(c),Se(u,e),e&&L(m),Se(f,e),e&&L(h),A&&A.d(e),e&&L(y),b=!1,x()}}}const kr=()=>!1;function Pr(e,t,n){let o,r,i,s;c(e,pt,(e=>n(28,r=e))),c(e,gt,(e=>n(13,i=e))),c(e,st,(e=>n(14,s=e)));let{$$slots:a={},$$scope:l}=t;const u=te();let p,d,m,f,g,{kmlOptions:h}=t,{ofp:v}=t,y=0,$=0,b=!1,x=[];const w={};let{id:k="map"}=t;async function P(){n(19,x=r?[]:await zo(0,d));const e=document.querySelector(`#${k} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(g),e.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`)))}const C=e=>{(e=>{const{name:t,value:n}=e,o=Ne(t);if("icontext"===o)return Object.values(Oo).forEach((t=>t.changeIconText&&t.changeIconText(e)));if("linewidth"===o)return Object.values(Oo).forEach((t=>t.changeLineWidth&&t.changeLineWidth(e)));if("iconsize"===o)return Object.values(Oo).forEach((t=>t.changeIconSize&&t.changeIconSize(e)));const r=Oo[o];r&&(t.endsWith("-display")?n?r.show&&r.show(e):r.hide&&r.hide(e):t.endsWith("-pin")?r.changeMarker&&r.changeMarker(e):t.endsWith("-color")?r.changeLine&&r.changeLine(e):t.endsWith("-change")&&r.change&&r.change(e))})({map:p,mapData:d,name:e.detail.name,value:e.detail.value,ofp:v,kmlOptions:h,aircraftType:f}),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-")||e.endsWith("-change"))return;const n=_t(),o=Ne(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),u("save")};let L=!1;return ee((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",d=So(k,m,v,h,P),n(3,p=d.map)})),e.$$set=e=>{"kmlOptions"in e&&n(0,h=e.kmlOptions),"ofp"in e&&n(1,v=e.ofp),"id"in e&&n(2,k=e.id),"$$scope"in e&&n(26,l=e.$$scope)},e.$$.update=()=>{524288&e.$$.dirty&&n(12,o=0===x.length)},[h,v,k,p,m,f,g,y,$,b,w,L,o,i,s,function(e){e.target.blur(),p&&p.remove(),n(8,$=0),n(9,b=!1),n(19,x=[]),n(7,y=0),d=So(k,m,v,h,P),n(3,p=d.map)},function(e){e.target.blur(),C({detail:{value:f,name:"airport-change"}})},C,async e=>{if(L)return!1;n(11,L=!0);try{n(7,y=x.length),n(9,b=!1);try{await Ke(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(11,L=!1),n(9,b=!0),!1}n(8,$=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const i=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(i),e()),o>=5||r>n.length-1)return;const s=r++,a=n[s];o++;try{await fetch(a),t&&t()}catch{}o--,delete n[s]}),100)}))}(x,(()=>n(8,$++,$))),$>=y&&(n(10,w[m.id]=!0,w),n(10,w),n(19,x=[]),n(7,y=0))}finally{n(11,L=!1)}},x,a,function(e){m=e,n(4,m)},function(e){f=e,n(5,f)},function(e){g=e,n(6,g)},function(e){h=e,n(0,h)},function(t){ne(e,t)},l]}class Cr extends Te{constructor(e){super(),je(this,e,Pr,wr,a,{kmlOptions:0,ofp:1,id:2})}}function Lr(e){let t;return{c(){t=E("li"),t.innerHTML='<a class="nav-link" href="#/map"><span class="svelte-1i9c5er">CARTE</span></a>',z(t,"class","nav-item svelte-1i9c5er"),q(t,"active","/map"===e[0])},m(e,n){C(e,t,n)},p(e,n){1&n&&q(t,"active","/map"===e[0])},d(e){e&&L(t)}}}function Or(e){let t;return{c(){t=E("li"),t.innerHTML='<a class="nav-link" href="#/export"><span class="svelte-1i9c5er">EXPORT</span></a>',z(t,"class","nav-item svelte-1i9c5er"),q(t,"active","/export"===e[0])},m(e,n){C(e,t,n)},p(e,n){1&n&&q(t,"active","/export"===e[0])},d(e){e&&L(t)}}}function _r(e){let t,n,o,r,i,s,a,l,c,p,m,f,g,h,v,y,$=(e[1]||"/map"===e[0])&&Lr(e),b=(e[1]&&!e[1].isFake||"/export"===e[0])&&Or(e);const x=e[3].default,w=u(x,e,e[2],null);return{c(){t=E("nav"),n=E("input"),o=S(),r=E("label"),r.innerHTML='<span class="navbar-toggler-icon"></span>',i=S(),s=E("ul"),a=E("li"),l=E("a"),c=F("svg"),p=F("use"),m=S(),$&&$.c(),f=S(),b&&b.c(),g=S(),h=E("li"),h.innerHTML='<a class="nav-link" href="#/help"><span class="svelte-1i9c5er">AIDE</span></a>',v=S(),w&&w.c(),z(n,"type","checkbox"),z(n,"id","menu"),z(n,"class","svelte-1i9c5er"),z(r,"class","navbar-toggler"),z(r,"for","menu"),D(p,"xlink:href","#home-symbol"),z(c,"class","svelte-1i9c5er"),z(l,"class","nav-link"),z(l,"href","#/"),z(a,"class","nav-item svelte-1i9c5er"),q(a,"active","/"===e[0]),z(h,"class","nav-item svelte-1i9c5er"),q(h,"active","/help"===e[0]),z(s,"class","navbar-nav collapse navbar-collapse svelte-1i9c5er"),z(s,"id","navbarToggler"),z(t,"class","navbar navbar-expand-sm navbar-light svelte-1i9c5er")},m(e,u){C(e,t,u),P(t,n),P(t,o),P(t,r),P(t,i),P(t,s),P(s,a),P(a,l),P(l,c),P(c,p),P(s,m),$&&$.m(s,null),P(s,f),b&&b.m(s,null),P(s,g),P(s,h),P(t,v),w&&w.m(t,null),y=!0},p(e,[t]){1&t&&q(a,"active","/"===e[0]),e[1]||"/map"===e[0]?$?$.p(e,t):($=Lr(e),$.c(),$.m(s,f)):$&&($.d(1),$=null),e[1]&&!e[1].isFake||"/export"===e[0]?b?b.p(e,t):(b=Or(e),b.c(),b.m(s,g)):b&&(b.d(1),b=null),1&t&&q(h,"active","/help"===e[0]),w&&w.p&&4&t&&d(w,x,e,e[2],t,null,null)},i(e){y||(Pe(w,e),y=!0)},o(e){Ce(w,e),y=!1},d(e){e&&L(t),$&&$.d(),b&&b.d(),w&&w.d(e)}}}function Er(e,t,n){let o,r;c(e,ht,(e=>n(0,o=e))),c(e,lt,(e=>n(1,r=e)));let{$$slots:i={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(2,s=e.$$scope)},[o,r,s,i]}class Fr extends Te{constructor(e){super(),je(this,e,Er,_r,a,{})}}var Mr=["bottom-right","bottom-center","bottom-left","top-right","top-center","top-left","right-bottom","right-center","right-top","left-bottom","left-center","left-top"];const Sr="right",jr="left",Tr="top",Ir="bottom";function zr(){return"undefined"!=typeof window&&"undefined"!=typeof document}const Ar=(e,{top:t,bottom:n,left:o,right:r,height:i,width:s,clientWidth:a,clientHeight:l})=>{const c=t>i,u=n+i<l,p=o>s,d=r+s<a;return{top:()=>!c&&u?Ir:Tr,bottom:()=>c&&!u?Tr:Ir,left:()=>!p&&d?Sr:jr,right:()=>!d&&p?jr:Sr}[e]()},Dr=(e,{top:t,bottom:n,left:o,right:r,height:i,width:s,clientWidth:a,clientHeight:l})=>{const c=t+(n-t)/2,u=n>i,p=t+i<l,d=c-i/2>0&&c+i/2<l,m=r>s,f=o+s<a,g={top:()=>!u&&p?Ir:Tr,center:()=>d?"center":g.top(),bottom:()=>!p&&u?Tr:Ir,left:()=>!m&&f?Sr:jr,right:()=>!f&&m?jr:Sr};return g[e]()},{window:Rr}=_e,Wr=e=>({isOpen:2048&e[0]}),Nr=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]}),Hr=e=>({isOpen:2048&e[0]}),Ur=e=>({toggle:e[12],isOpen:e[11],open:e[13],close:e[14]});function Gr(e){let t,n,o;const r=e[26].content,i=u(r,e,e[25],Nr);return{c(){t=E("div"),i&&i.c(),z(t,"class",n=g(`content ${e[4]||""}`)+" svelte-d6atc3")},m(n,r){C(n,t,r),i&&i.m(t,null),e[28](t),o=!0},p(e,s){i&&i.p&&33556480&s[0]&&d(i,r,e,e[25],s,Wr,Nr),(!o||16&s[0]&&n!==(n=g(`content ${e[4]||""}`)+" svelte-d6atc3"))&&z(t,"class",n)},i(e){o||(Pe(i,e),o=!0)},o(e){Ce(i,e),o=!1},d(n){n&&L(t),i&&i.d(n),e[28](null)}}}function qr(e){let t,n,o,r,s,a,l,c,p,m;const f=e[26].parent,h=u(f,e,e[25],Ur);let v=e[11]&&Gr(e);return{c(){t=E("div"),n=E("div"),h&&h.c(),o=S(),r=E("div"),v&&v.c(),z(n,"class","svelte-d6atc3"),z(r,"class","content-wrapper svelte-d6atc3"),z(r,"style",s=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`),z(t,"class",a=g(`overlay ${e[10]}`)+" svelte-d6atc3"),z(t,"style",l=`z-index:${e[0]}; ${e[1]}`)},m(i,s){C(i,t,s),P(t,n),h&&h.m(n,null),e[27](n),P(t,o),P(t,r),v&&v.m(r,null),e[29](t),c=!0,p||(m=[T(Rr,"mousedown",e[15]),T(Rr,"keydown",e[16])],p=!0)},p(e,n){h&&h.p&&33556480&n[0]&&d(h,f,e,e[25],n,Hr,Ur),e[11]?v?(v.p(e,n),2048&n[0]&&Pe(v,1)):(v=Gr(e),v.c(),Pe(v,1),v.m(r,null)):v&&(we(),Ce(v,1,1,(()=>{v=null})),ke()),(!c||961&n[0]&&s!==(s=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`))&&z(r,"style",s),(!c||1024&n[0]&&a!==(a=g(`overlay ${e[10]}`)+" svelte-d6atc3"))&&z(t,"class",a),(!c||3&n[0]&&l!==(l=`z-index:${e[0]}; ${e[1]}`))&&z(t,"style",l)},i(e){c||(Pe(h,e),Pe(v),c=!0)},o(e){Ce(h,e),Ce(v),c=!1},d(n){n&&L(t),h&&h.d(n),e[27](null),v&&v.d(),e[29](null),p=!1,i(m)}}}function Br(e,t,o){let r,i,s,a;const l=["isOpen","updateOnScroll","closeOnScroll","position","closeOnClickOutside","zIndex","onWindowKeyDown","style"];let c=f(t,l),{$$slots:u={},$$scope:p}=t;const d=te(),g=Mr[0];let h,v,y,{isOpen:$=!1}=t,{updateOnScroll:b=!1}=t,{closeOnScroll:x=!1}=t,{position:w=g}=t,{closeOnClickOutside:k=!1}=t,{zIndex:P=1}=t,{onWindowKeyDown:C=(()=>{})}=t,{style:L=""}=t,O=null,_=0,E=0,F=0,M=0;function S(){zr()&&(window.addEventListener("resize",R),x?window.addEventListener("scroll",A):b&&window.addEventListener("scroll",R))}function j(){zr()&&(window.removeEventListener("resize",R),window.removeEventListener("scroll",R),window.removeEventListener("scroll",A))}var T;function I(e){const t=$,n=!0===e||!1===e?e:!$;(n&&i&&s||!n)&&o(17,$=n),t!==$&&(d("toggle",$),$?(S(),d("open")):(d("close"),j()))}function z(){a||I(!0)}function A(){a&&I(!1)}function D(e){const t=e.path||e.composedPath();return t.includes(h)||t.includes(v)}async function R(){if(await ue(),!a)return;Mr.includes(w)||o(18,w=g);const{top:e,bottom:t,left:n,right:r,width:i,height:s}=h.getBoundingClientRect(),{height:l,width:c}=v.getBoundingClientRect(),u=((e,t)=>{const n=Math.min(document.body.clientHeight,document.documentElement.clientHeight),o=Math.min(document.body.clientWidth,document.documentElement.clientWidth);Object.assign(t,{clientWidth:o,clientHeight:n});const[r,i]=e.split("-");return`${Ar(r,t)}-${Dr(i,t)}`})(w,{top:e,bottom:t,left:n,right:r,height:l,width:c});O!==u&&o(4,O=u),o(6,_=e),o(7,E=n),o(8,F=i),o(9,M=s)}return ee((()=>{a&&S()})),T=()=>{zr()&&j()},Q().$$.on_destroy.push(T),function(e){Q().$$.before_update.push(e)}(R),e.$$set=e=>{t=n(n({},t),m(e)),o(36,c=f(t,l)),"isOpen"in e&&o(17,$=e.isOpen),"updateOnScroll"in e&&o(19,b=e.updateOnScroll),"closeOnScroll"in e&&o(20,x=e.closeOnScroll),"position"in e&&o(18,w=e.position),"closeOnClickOutside"in e&&o(21,k=e.closeOnClickOutside),"zIndex"in e&&o(0,P=e.zIndex),"onWindowKeyDown"in e&&o(22,C=e.onWindowKeyDown),"style"in e&&o(1,L=e.style),"$$scope"in e&&o(25,p=e.$$scope)},e.$$.update=()=>{if(o(10,r=c.class||""),4&e.$$.dirty[0]&&o(23,i=!h||!!h.childNodes.length),8&e.$$.dirty[0]&&o(24,s=!v||!!v.childNodes.length),8388608&e.$$.dirty[0]&&!i)throw new Error("parent slot is required");if(16777216&e.$$.dirty[0]&&!s)throw new Error("content slot is required");25296896&e.$$.dirty[0]&&o(11,a=$&&i&&s)},[P,L,h,v,O,y,_,E,F,M,r,a,I,z,A,function(e){k&&a&&!D(e)&&A()},function(e){C&&a&&C(e,{isOpen:a,open:z,close:A,toggle:I,contains:D})},$,w,b,x,k,C,i,s,p,u,function(e){re[e?"unshift":"push"]((()=>{h=e,o(2,h)}))},function(e){re[e?"unshift":"push"]((()=>{v=e,o(3,v)}))},function(e){re[e?"unshift":"push"]((()=>{y=e,o(5,y)}))}]}class Kr extends Te{constructor(e){super(),je(this,e,Br,qr,a,{isOpen:17,updateOnScroll:19,closeOnScroll:20,position:18,closeOnClickOutside:21,zIndex:0,onWindowKeyDown:22,style:1},[-1,-1])}}function Zr(e){let t,o;const r=e[3].default,i=u(r,e,e[2],null);let s=[{href:e[0]},e[1]],a={};for(let e=0;e<s.length;e+=1)a=n(a,s[e]);return{c(){t=E("a"),i&&i.c(),A(t,a)},m(e,n){C(e,t,n),i&&i.m(t,null),o=!0},p(e,[n]){i&&i.p&&4&n&&d(i,r,e,e[2],n,null,null),A(t,a=function(e,t){const n={},o={},r={$$scope:1};let i=e.length;for(;i--;){const s=e[i],a=t[i];if(a){for(const e in s)e in a||(o[e]=1);for(const e in a)r[e]||(n[e]=a[e],r[e]=1);e[i]=a}else for(const e in s)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(s,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||(Pe(i,e),o=!0)},o(e){Ce(i,e),o=!1},d(e){e&&L(t),i&&i.d(e)}}}function Vr(e,t,o){const r=["href"];let i=f(t,r),{$$slots:s={},$$scope:a}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},i):i;return e.$$set=e=>{t=n(n({},t),m(e)),o(5,i=f(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,a=e.$$scope)},[l,c,a,s]}class Xr extends Te{constructor(e){super(),je(this,e,Vr,Zr,a,{href:0})}}function Jr(e){let t,n;return t=new Kr({props:{position:"bottom-center",$$slots:{default:[ni],content:[ti,({close:e})=>({6:e}),({close:e})=>e?64:0],parent:[Qr,({toggle:e})=>({7:e}),({toggle:e})=>e?128:0]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};453&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Yr(t){let n,o,r,a,l,c,u,p=t[1]&&oi();return{c(){n=E("div"),o=F("svg"),r=F("circle"),a=S(),p&&p.c(),z(r,"cx","50"),z(r,"cy","50"),z(r,"r","50"),z(o,"id","gt-plane"),z(o,"viewBox","0 0 100 100"),z(o,"xmlns","http://www.w3.org/2000/svg"),z(o,"class","svelte-vh5ig2"),z(n,"class","gramet-thumbnail svelte-vh5ig2"),q(n,"open",t[1])},m(e,i){C(e,n,i),P(n,o),P(o,r),P(n,a),p&&p.m(n,null),c||(u=[v(l=pr.call(null,n,{ofp:t[2],pos:t[3]})),T(n,"click",t[4])],c=!0)},p(e,t){e[1]?p||(p=oi(),p.c(),p.m(n,null)):p&&(p.d(1),p=null),l&&s(l.update)&&12&t&&l.update.call(null,{ofp:e[2],pos:e[3]}),2&t&&q(n,"open",e[1])},i:e,o:e,d(e){e&&L(n),p&&p.d(),c=!1,i(u)}}}function Qr(e){let t,n,o;return{c(){t=E("button"),t.innerHTML='<svg class="gramet-error svelte-vh5ig2"><use xlink:href="#info-symbol"></use></svg>',z(t,"slot","parent"),z(t,"class","btn btn-light svelte-vh5ig2")},m(r,i){C(r,t,i),n||(o=T(t,"click",(function(){s(e[7])&&e[7].apply(this,arguments)})),n=!0)},p(t,n){e=t},d(e){e&&L(t),n=!1,o()}}}function ei(e){let t;return{c(){t=M("ogimet")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function ti(e){let t,n,o,r,a,l,c,u,p,d,m,f,g,h,v,y,$;return m=new Xr({props:{href:e[2].ogimetData.url,target:"_blank",$$slots:{default:[ei]},$$scope:{ctx:e}}}),{c(){t=E("div"),n=E("div"),o=E("h3"),r=M("😱: Erreur de récupération du Gramet"),a=E("button"),a.innerHTML='<svg class="svelte-vh5ig2"><use xlink:href="#close-symbol"></use></svg>',l=S(),c=E("div"),u=E("p"),p=E("a"),p.textContent="essayez à nouveau",d=M(" ou allez sur "),Fe(m.$$.fragment),f=M("."),g=S(),h=E("p"),h.textContent='A certaines heures le site ogimet est saturé, il faut essayer 2 ou 3 fois.\n                    Parfois le site est indisponible, avec la mention "no grib data" sur leur page web, dans ce cas il est inutile de faire une nouvelle tentative.',z(a,"type","button"),z(a,"class","close svelte-vh5ig2"),z(a,"aria-label","Close"),z(o,"class","popover-header"),z(p,"href","."),z(c,"class","popover-body"),z(n,"class","popover"),z(n,"role","tooltip"),H(n,"width","330px"),H(n,"max-width","330px"),z(t,"slot","content")},m(i,b){C(i,t,b),P(t,n),P(n,o),P(o,r),P(o,a),P(n,l),P(n,c),P(c,u),P(u,p),P(u,d),Me(m,u,null),P(u,f),P(c,g),P(c,h),v=!0,y||($=[T(a,"click",(function(){s(e[6])&&e[6].apply(this,arguments)})),T(p,"click",I(e[5]))],y=!0)},p(t,n){e=t;const o={};4&n&&(o.href=e[2].ogimetData.url),256&n&&(o.$$scope={dirty:n,ctx:e}),m.$set(o)},i(e){v||(Pe(m.$$.fragment,e),v=!0)},o(e){Ce(m.$$.fragment,e),v=!1},d(e){e&&L(t),Se(m),y=!1,i($)}}}function ni(t){let n;return{c(){n=S()},m(e,t){C(e,n,t)},p:e,i:e,o:e,d(e){e&&L(n)}}}function oi(e){let t,n;return{c(){t=F("svg"),n=F("use"),D(n,"xlink:href","#close-symbol"),z(t,"class","gramet-close svelte-vh5ig2")},m(e,o){C(e,t,o),P(t,n)},d(e){e&&L(t)}}}function ri(e){let t,n,o,r;const i=[Yr,Jr],s=[];function a(e,t){return"error"!==e[0]?0:1}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),o=j()},m(e,n){s[t].m(e,n),C(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?s[t].p(e,r):(we(),Ce(s[l],1,1,(()=>{s[l]=null})),ke(),n=s[t],n?n.p(e,r):(n=s[t]=i[t](e),n.c()),Pe(n,1),n.m(o.parentNode,o))},i(e){r||(Pe(n),r=!0)},o(e){Ce(n),r=!1},d(e){s[t].d(e),e&&L(o)}}}function ii(e,t,n){let o,r,i,s;c(e,ur,(e=>n(0,o=e))),c(e,st,(e=>n(1,r=e))),c(e,lt,(e=>n(2,i=e))),c(e,vt,(e=>n(3,s=e)));return[o,r,i,s,()=>{"success"===o&&h(st,r=!r,r)},()=>h(ur,o="loading",o)]}class si extends Te{constructor(e){super(),je(this,e,ii,ri,a,{})}}function ai(e){const t=new IntersectionObserver((t=>{t.forEach((t=>{1!==t.intersectionRatio&&e.blur()}))}),{threshold:1});t.observe(e);const n=()=>{document&&document.visibilityState&&"visible"!==document.visibilityState&&e.blur()};return document.addEventListener("visibilitychange",n,!1),{destroy(){t.unobserve(e),t.disconnect(),document.removeEventListener("visibilitychange",n)}}}function li(t){let n,o,r,s,a,l,c,u,p,d;return{c(){n=E("div"),o=F("svg"),r=F("use"),s=S(),a=E("label"),l=M("Heure de décollage"),c=S(),u=E("input"),D(r,"xlink:href","#takeoff-symbol"),z(o,"class","svelte-1k7xqw7"),z(a,"for",t[0]),z(a,"class","svelte-1k7xqw7"),z(u,"id",t[0]),z(u,"name",t[0]),z(u,"type","time"),u.value=t[2](t[1].getUTCHours(),t[1].getUTCMinutes()),z(u,"class","svelte-1k7xqw7"),z(n,"class","svelte-1k7xqw7")},m(e,i){C(e,n,i),P(n,o),P(o,r),P(n,s),P(n,a),P(a,l),P(n,c),P(n,u),p||(d=[v(ai.call(null,u)),T(u,"change",t[3])],p=!0)},p(e,[t]){1&t&&z(a,"for",e[0]),1&t&&z(u,"id",e[0]),1&t&&z(u,"name",e[0])},i:e,o:e,d(e){e&&L(n),p=!1,i(d)}}}function ci(e,t,n){let o,r;c(e,lt,(e=>n(4,o=e))),c(e,ut,(e=>n(5,r=e)));let{name:i="take-off"}=t;const s=new Date(o.infos.datetime);s.setUTCMinutes(s.getMinutes()+o.infos.taxitime),h(ut,r=s,r);const a=(e,t)=>`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return e.$$set=e=>{"name"in e&&n(0,i=e.name)},[i,s,a,e=>{let t,n;""==e.target.value?(n=s.getUTCHours(),t=s.getUTCMinutes(),e.target.blur(),e.target.value=a(n,t)):(n=parseFloat(e.target.value.slice(0,2)),t=parseFloat(e.target.value.slice(3)));let o=new Date(s);o.setUTCMinutes(t),o.setUTCHours(n);const i=(o.getTime()-s.getTime())/6e4;i<-720?o=new Date(o.getTime()+864e5):i>720&&(o=new Date(o.getTime()-864e5)),h(ut,r=o,r),o.toISOString()!==s.toISOString()?e.target.classList.add("changed"):e.target.classList.remove("changed")}]}class ui extends Te{constructor(e){super(),je(this,e,ci,li,a,{name:0})}}function pi(n){let o,r,i;const a=n[3].default,l=u(a,n,n[2],null);return{c(){o=E("page"),l&&l.c(),z(o,"class","svelte-1de5e3b"),q(o,"fadein",!1===n[0]),q(o,"d-none",!0===n[0])},m(e,t){C(e,o,t),l&&l.m(o,null),i=!0},p(e,[t]){l&&l.p&&4&t&&d(l,a,e,e[2],t,null,null),1&t&&q(o,"fadein",!1===e[0]),1&t&&q(o,"d-none",!0===e[0])},i(a){i||(Pe(l,a),r||pe((()=>{r=function(n,o,r){let i,a,l=o(n,r),c=!1,u=0;function p(){i&&J(n,i)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:m}=l||Le;m&&(i=X(n,0,1,r,o,s,m,u++)),d(0,1);const f=$()+o,g=f+r;a&&a.abort(),c=!0,pe((()=>$e(n,!0,"start"))),a=k((e=>{if(c){if(e>=g)return d(1,0),$e(n,!0,"end"),p(),c=!1;if(e>=f){const t=s((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(J(n),s(l)?(l=l(),ye().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),i=!0)},o(e){Ce(l,e),i=!1},d(e){e&&L(o),l&&l.d(e)}}}function di(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:i}=t;return e.$$set=e=>{"hidden"in e&&n(0,i=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[i,(e,t,n)=>{if(void 0===i)return Xe(e,t)},r,o]}class mi extends Te{constructor(e){super(),je(this,e,di,pi,a,{hidden:0})}}function fi(e){let t;return{c(){t=E("a"),t.textContent="www.ogimet.com",z(t,"href","http://www.ogimet.com")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function gi(e){let t;return{c(){t=M("Guide d'interprétation")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function hi(e){let t;return{c(){t=E("span"),t.innerHTML="Fly<span>Tax</span>",z(t,"class","flytax")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function vi(e){let t,n,o,r,i,s,a,l,c,u,p,d,m,f,g,h,v,y,$,b,x,w,k,O,_,F,j,T,I,A,D,R,W,N,H,U,G,q,B,K,Z,V,X,J,Y,Q,ee,te,ne,oe,re,ie,se,ae,le,ce,ue,pe,de,me,fe,ge,he,ve,ye,$e,be=!0!==navigator.standalone&&function(e){let t,n,o;return{c(){t=M("Pour mémoire, dans un navigateur, il suffit de partager l'url ou "),n=E("a"),n.textContent="ce lien",o=M("."),z(n,"href","http://flyingeek.github.io/lido-online/index.html")},m(e,r){C(e,t,r),C(e,n,r),C(e,o,r)},d(e){e&&L(t),e&&L(n),e&&L(o)}}}();return A=new Xr({props:{href:"http://www.ogimet.com",$$slots:{default:[fi]},$$scope:{ctx:e}}}),G=new Xr({props:{href:"http://www.ogimet.com/guia_gramet.phtml.en",$$slots:{default:[gi]},$$scope:{ctx:e}}}),ve=new Xr({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[hi]},$$scope:{ctx:e}}}),{c(){t=E("h2"),t.textContent="Préambule",n=S(),o=E("p"),o.textContent="OFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l'écran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie.",r=S(),i=E("p"),i.textContent="OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.",s=S(),a=E("p"),a.textContent="L'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L'app ne collecte aucune données.",l=S(),c=E("h2"),c.textContent="Utilisation",u=S(),p=E("ol"),p.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner.</p></li> \n<li><p>La carte dispose d&#39;un bouton pour personnaliser les calques et les couleurs. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP. Pour vous entrainer, je vous recommande de modifier la couleur des terrains en vert/rouge et de sauvegarder votre choix.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur d&#39;autres projections.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li> \n<li>THE WORLD permet de disposer d&#39;un Atlas off-line, c&#39;est une projection Times</li> \n<li>MERCATOR est une Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line</li></ul></li>",d=S(),m=E("ol"),m.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts. Si vous activez le bouton de géolocalisation, la carte peut se centrer automatiquement.</li>",f=S(),g=E("h2"),g.textContent="Particularités de l'iPad",h=S(),v=E("p"),v.textContent="OFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.",y=S(),$=E("p"),b=M("Pour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. "),be&&be.c(),x=S(),w=E("p"),w.innerHTML='L&#39;export des fichiers KML affiche une page nommée &quot;data:&quot;, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share-symbol"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. En raison d&#39;un bug d&#39;iOS, il est impossible de nommer le fichier pour le moment.',k=S(),O=E("p"),O.textContent="À noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",_=S(),F=E("h2"),F.textContent="GRAMET",j=S(),T=E("p"),I=M("Le GRAMET est un météogramme représentant le temps et l'espace. Il indique, en tout point de la route, et à l'heure de passage estimée, une coupe verticale de la météo prévue.\nLe GRAMET est réalisé par "),Fe(A.$$.fragment),D=M(" à partir d'une route calculée. Il est possible d'afficher le GRAMET et sa route sur la carte. La route est particulièrement utile lors des vols océaniques car il n'y a aucune station en mer.\nPour construire la route du GRAMET, on ne peut se baser sur des waypoints, il faut utiliser au plus 21 stations météo (WMO). Il y a au total 13000 WMO dans le monde."),R=S(),W=E("p"),W.textContent="Pour afficher le Gramet, cliquez sur sa miniature à gauche de l'OFP. Pour afficher la route, direction le réglages des calques de la carte. Par défaut elle est affichée en bleu. En fonction de l'heure de décollage (modifiable), le Gramet et sa miniature affiche la position avion.",N=S(),H=E("p"),U=M("Pour mieux comprendre le GRAMET, je vous conseille son "),Fe(G.$$.fragment),q=M("."),B=S(),K=E("h2"),K.textContent="Mode off-line",Z=S(),V=E("p"),V.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.",X=S(),J=E("p"),J.textContent="Il existe aussi un bouton de mise en cache : le pictogramme ↓ situé à droite du sélecteur de carte. Sur les cartes LAMBERT ou THE WORLD, il mettra en cache la totalité de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache.",Y=S(),Q=E("p"),Q.textContent="Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent : 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH et 32Mo pour THE WORLD.",ee=S(),te=E("h2"),te.textContent="Mise à jour",ne=S(),oe=E("p"),oe.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",re=S(),ie=E("h2"),ie.textContent="Crédits",se=S(),ae=E("ul"),ae.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',le=S(),ce=E("h2"),ce.textContent="Hébergement",ue=S(),pe=E("p"),pe.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",de=S(),me=E("h2"),me.textContent="Liens",fe=S(),ge=E("ul"),he=E("li"),Fe(ve.$$.fragment),ye=M(" une aide aux calculs des frais professionnels (même auteur)."),z(m,"start","5")},m(e,L){C(e,t,L),C(e,n,L),C(e,o,L),C(e,r,L),C(e,i,L),C(e,s,L),C(e,a,L),C(e,l,L),C(e,c,L),C(e,u,L),C(e,p,L),C(e,d,L),C(e,m,L),C(e,f,L),C(e,g,L),C(e,h,L),C(e,v,L),C(e,y,L),C(e,$,L),P($,b),be&&be.m($,null),C(e,x,L),C(e,w,L),C(e,k,L),C(e,O,L),C(e,_,L),C(e,F,L),C(e,j,L),C(e,T,L),P(T,I),Me(A,T,null),P(T,D),C(e,R,L),C(e,W,L),C(e,N,L),C(e,H,L),P(H,U),Me(G,H,null),P(H,q),C(e,B,L),C(e,K,L),C(e,Z,L),C(e,V,L),C(e,X,L),C(e,J,L),C(e,Y,L),C(e,Q,L),C(e,ee,L),C(e,te,L),C(e,ne,L),C(e,oe,L),C(e,re,L),C(e,ie,L),C(e,se,L),C(e,ae,L),C(e,le,L),C(e,ce,L),C(e,ue,L),C(e,pe,L),C(e,de,L),C(e,me,L),C(e,fe,L),C(e,ge,L),P(ge,he),Me(ve,he,null),P(he,ye),$e=!0},p(e,[t]){const n={};1&t&&(n.$$scope={dirty:t,ctx:e}),A.$set(n);const o={};1&t&&(o.$$scope={dirty:t,ctx:e}),G.$set(o);const r={};1&t&&(r.$$scope={dirty:t,ctx:e}),ve.$set(r)},i(e){$e||(Pe(A.$$.fragment,e),Pe(G.$$.fragment,e),Pe(ve.$$.fragment,e),$e=!0)},o(e){Ce(A.$$.fragment,e),Ce(G.$$.fragment,e),Ce(ve.$$.fragment,e),$e=!1},d(e){e&&L(t),e&&L(n),e&&L(o),e&&L(r),e&&L(i),e&&L(s),e&&L(a),e&&L(l),e&&L(c),e&&L(u),e&&L(p),e&&L(d),e&&L(m),e&&L(f),e&&L(g),e&&L(h),e&&L(v),e&&L(y),e&&L($),be&&be.d(),e&&L(x),e&&L(w),e&&L(k),e&&L(O),e&&L(_),e&&L(F),e&&L(j),e&&L(T),Se(A),e&&L(R),e&&L(W),e&&L(N),e&&L(H),Se(G),e&&L(B),e&&L(K),e&&L(Z),e&&L(V),e&&L(X),e&&L(J),e&&L(Y),e&&L(Q),e&&L(ee),e&&L(te),e&&L(ne),e&&L(oe),e&&L(re),e&&L(ie),e&&L(se),e&&L(ae),e&&L(le),e&&L(ce),e&&L(ue),e&&L(pe),e&&L(de),e&&L(me),e&&L(fe),e&&L(ge),Se(ve)}}}class yi extends Te{constructor(e){super(),je(this,e,null,vi,a,{})}}function $i(t){let n,o,r,i,s=navigator.share&&function(t){let n,o,r;return{c(){n=E("button"),n.textContent="Partager l'App",z(n,"class","btn btn-outline-secondary btn-sm svelte-b61ja7")},m(e,t){C(e,n,t),o||(r=T(n,"click",Ze),o=!0)},p:e,d(e){e&&L(n),o=!1,r()}}}();return{c(){s&&s.c(),n=S(),o=E("button"),o.textContent="Recharger l'App",z(o,"class","btn btn-outline-secondary btn-sm svelte-b61ja7")},m(e,a){s&&s.m(e,a),C(e,n,a),C(e,o,a),r||(i=T(o,"click",t[2]),r=!0)},p(e,t){navigator.share&&s.p(e,t)},d(e){s&&s.d(e),e&&L(n),e&&L(o),r=!1,i()}}}function bi(e){let t,n,o,r,i,s,a,l,c,u,p,d,m,f,g,h=!0===navigator.standalone&&$i(e);return d=new yi({}),{c(){t=E("div"),n=E("h1"),o=E("div"),o.innerHTML='<img src="images/ofp2map-icons/icon-128x128.png" alt="logo" class="svelte-b61ja7"/><span class="svelte-b61ja7">OFP2MAP</span>',r=M(" v"),i=M(xi),s=S(),a=E("small"),l=M("/ ServiceWorker : "),c=M(e[1]),u=S(),h&&h.c(),p=S(),Fe(d.$$.fragment),z(o,"class","app svelte-b61ja7"),z(a,"class","svelte-b61ja7"),z(n,"class","svelte-b61ja7"),z(t,"class","markdown svelte-b61ja7")},m(v,y){C(v,t,y),P(t,n),P(n,o),P(n,r),P(n,i),P(n,s),P(n,a),P(a,l),P(a,c),P(n,u),h&&h.m(n,null),P(t,p),Me(d,t,null),m=!0,f||(g=T(a,"click",e[3],{once:!0}),f=!0)},p(e,[t]){(!m||2&t)&&W(c,e[1]),!0===navigator.standalone&&h.p(e,t)},i(e){m||(Pe(d.$$.fragment,e),m=!0)},o(e){Ce(d.$$.fragment,e),m=!1},d(e){e&&L(t),h&&h.d(),Se(d),f=!1,g()}}}const xi="1.6.3";function wi(e,t,n){let o;c(e,tt,(e=>n(0,o=e)));let r="";return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=o)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,r=e)))},[o,r,()=>{window.location.hash="#/",window.location.reload()},()=>o&&o.update()&&void 0]}class ki extends Te{constructor(e){super(),je(this,e,wi,bi,a,{})}}function Pi(e){let t,n,o,r,s,a,l,c,u,p,d,m,f,g,h,v;return{c(){t=E("div"),n=E("div"),o=E("strong"),o.innerHTML='<span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour disponible',r=S(),s=E("button"),s.innerHTML='<span aria-hidden="true">×</span>',a=S(),l=E("div"),c=E("p"),c.textContent="Il faudra recharger l'OFP",u=S(),p=E("button"),d=E("span"),m=M(e[1]),z(o,"class","svelte-395rpc"),z(s,"type","button"),z(s,"class","close svelte-395rpc"),z(s,"aria-label","Close"),z(n,"class","toast-header svelte-395rpc"),z(d,"class","svelte-395rpc"),q(d,"blinking",e[1].endsWith("...")),z(p,"class","btn btn-primary"),z(p,"type","button"),z(l,"class","toast-body text-center"),z(t,"class","toast svelte-395rpc"),H(t,"position","fixed"),H(t,"top","0"),H(t,"right","0")},m(i,f){C(i,t,f),P(t,n),P(n,o),P(n,r),P(n,s),P(t,a),P(t,l),P(l,c),P(l,u),P(l,p),P(p,d),P(d,m),g=!0,h||(v=[T(s,"click",e[6]),T(p,"click",e[7],{once:!0})],h=!0)},p(e,t){(!g||2&t)&&W(m,e[1]),2&t&&q(d,"blinking",e[1].endsWith("..."))},i(e){g||(pe((()=>{f||(f=Oe(t,Xe,{},!0)),f.run(1)})),g=!0)},o(e){f||(f=Oe(t,Xe,{},!1)),f.run(0),g=!1},d(e){e&&L(t),e&&f&&f.end(),h=!1,i(v)}}}function Ci(t){let n,o,r,i,s,a,l,c,u,p,d=(t[4](700)||"")+"";return{c(){n=E("div"),o=E("div"),r=E("div"),r.innerHTML='<strong class="svelte-395rpc"><span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour détectée</strong>',i=S(),s=E("div"),a=E("button"),a.innerHTML="<span>Mise à jour...</span>",l=S(),c=M(d),z(r,"class","toast-header svelte-395rpc"),z(a,"class","btn"),z(a,"type","button"),z(s,"class","toast-body text-center"),z(o,"class","toast svelte-395rpc"),z(n,"class","modal svelte-395rpc")},m(e,d){C(e,n,d),P(n,o),P(o,r),P(o,i),P(o,s),P(s,a),P(n,l),C(e,c,d),u||(p=T(a,"click",I(t[5])),u=!0)},p:e,i:e,o:e,d(e){e&&L(n),e&&L(c),u=!1,p()}}}function Li(e){let t,n,o,r;const i=[Ci,Pi],s=[];function a(e,t){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:-1:0}return~(t=a(e))&&(n=s[t]=i[t](e)),{c(){n&&n.c(),o=j()},m(e,n){~t&&s[t].m(e,n),C(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?~t&&s[t].p(e,r):(n&&(we(),Ce(s[l],1,1,(()=>{s[l]=null})),ke()),~t?(n=s[t],n?n.p(e,r):(n=s[t]=i[t](e),n.c()),Pe(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Pe(n),r=!0)},o(e){Ce(n),r=!1},d(e){~t&&s[t].d(e),e&&L(o)}}}const Oi=et(),_i=e=>{ot.set(!0),nt.set(!1),e?rt.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.6.3",e)):rt.set(!0)};function Ei(t,n,o){let r,i,s,a,l=e;c(t,nt,(e=>o(2,r=e))),c(t,tt,(e=>o(8,i=e))),c(t,Oi,(e=>o(9,s=e))),c(t,ot,(e=>o(3,a=e))),t.$$.on_destroy.push((()=>l()));let u="Installer";h(nt,r=!1,r);let{prompt:p=!1}=n;const d=(e=0)=>{let t;i&&s&&s.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,u="En cours..."),s.waiting.postMessage({type:"SKIP_WAITING"})):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,p=e.prompt)},[p,u,r,a,d,function(e){ne(t,e)},()=>h(nt,r=!0,r),()=>d()]}class Fi extends Te{constructor(e){super(),je(this,e,Ei,Li,a,{prompt:0})}}function Mi(e){let t;return{c(){t=E("ol"),t.innerHTML='<li class="svelte-4xox7z">Dans la barre de menu, cliquez sur <svg class="svelte-4xox7z"><use xlink:href="#share-symbol"></use></svg></li> \n                    <li class="svelte-4xox7z">Faites défiler, choisir : <em>Sur l&#39;écran d&#39;accueil</em>  <svg style="width:22px;height:22px;" class="svelte-4xox7z"><use xlink:href="#add2home-symbol"></use></svg></li> \n                    <li class="svelte-4xox7z">Lancez l&#39;application depuis l&#39;écran d&#39;accueil</li>',z(t,"class","guide svelte-4xox7z")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function Si(e){let t;return{c(){t=E("p"),t.textContent="Merci d'ouvrir cette page dans Safari",z(t,"class","guide error svelte-4xox7z")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function ji(t){let n,o,r,i,s,a,l,c,u,p,d,m,f,g;n=new an({});let h=function(e,t){return e[0]?Mi:Si}(t)(t);return f=new Fi({}),{c(){Fe(n.$$.fragment),o=S(),r=E("div"),i=E("div"),s=E("div"),s.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-4xox7z"/>',a=S(),l=E("div"),c=E("h3"),c.textContent="Installez OFP2MAP",u=S(),p=E("p"),p.textContent="Si OFP2MAP est déjà sur l'écran d'accueil, ne l'installez pas une deuxième fois. Attention: l'installation ne peut se faire que depuis\n                le navigateur Safari, ce n'est pas possible depuis une WebView (à l'intérieur d'une app).",d=S(),h.c(),m=S(),Fe(f.$$.fragment),z(s,"class","icon-container svelte-4xox7z"),z(c,"class","title svelte-4xox7z"),z(p,"class","text svelte-4xox7z"),z(l,"class","prompt-content svelte-4xox7z"),z(i,"class","prompt svelte-4xox7z"),z(r,"class","prompt-container svelte-4xox7z")},m(e,t){Me(n,e,t),C(e,o,t),C(e,r,t),P(r,i),P(i,s),P(i,a),P(i,l),P(l,c),P(l,u),P(l,p),P(l,d),h.m(l,null),C(e,m,t),Me(f,e,t),g=!0},p:e,i(e){g||(Pe(n.$$.fragment,e),Pe(f.$$.fragment,e),g=!0)},o(e){Ce(n.$$.fragment,e),Ce(f.$$.fragment,e),g=!1},d(e){Se(n,e),e&&L(o),e&&L(r),h.d(),e&&L(m),Se(f,e)}}}function Ti(e){return[De&&!Ae]}class Ii extends Te{constructor(e){super(),je(this,e,Ti,ji,a,{})}}function zi(e){let t,n,o,r,i,s,a,l,c;t=new Fr({props:{$$slots:{default:[Wi]},$$scope:{ctx:e}}}),o=new Fi({props:{prompt:!!e[1]}});let u=e[1]&&"success"===e[2]&&Ni(e);const p=[Zi,Ki,Bi,qi,Gi,Ui],d=[];function m(e,t){return"loading"===e[2]?0:e[2]&&"success"!==e[2]&&"/map"===e[3]?1:"/export"===e[3]&&"success"===e[2]?2:"/"===e[3]?3:"/help"===e[3]?4:e[1]&&"/map"===e[3]?-1:5}return~(s=m(e))&&(a=d[s]=p[s](e)),{c(){Fe(t.$$.fragment),n=S(),Fe(o.$$.fragment),r=S(),u&&u.c(),i=S(),a&&a.c(),l=j()},m(e,a){Me(t,e,a),C(e,n,a),Me(o,e,a),C(e,r,a),u&&u.m(e,a),C(e,i,a),~s&&d[s].m(e,a),C(e,l,a),c=!0},p(e,n){const r={};4107&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};2&n&&(c.prompt=!!e[1]),o.$set(c),e[1]&&"success"===e[2]?u?(u.p(e,n),6&n&&Pe(u,1)):(u=Ni(e),u.c(),Pe(u,1),u.m(i.parentNode,i)):u&&(we(),Ce(u,1,1,(()=>{u=null})),ke());let f=s;s=m(e),s===f?~s&&d[s].p(e,n):(a&&(we(),Ce(d[f],1,1,(()=>{d[f]=null})),ke()),~s?(a=d[s],a?a.p(e,n):(a=d[s]=p[s](e),a.c()),Pe(a,1),a.m(l.parentNode,l)):a=null)},i(e){c||(Pe(t.$$.fragment,e),Pe(o.$$.fragment,e),Pe(u),Pe(a),c=!0)},o(e){Ce(t.$$.fragment,e),Ce(o.$$.fragment,e),Ce(u),Ce(a),c=!1},d(e){Se(t,e),e&&L(n),Se(o,e),e&&L(r),u&&u.d(e),e&&L(i),~s&&d[s].d(e),e&&L(l)}}}function Ai(t){let n,o;return n=new Ii({}),{c(){Fe(n.$$.fragment)},m(e,t){Me(n,e,t),o=!0},p:e,i(e){o||(Pe(n.$$.fragment,e),o=!0)},o(e){Ce(n.$$.fragment,e),o=!1},d(e){Se(n,e)}}}function Di(e){let t,n,o,r;t=new si({});return{c(){Fe(t.$$.fragment),n=S(),o=j()},m(e,i){Me(t,e,i),C(e,n,i),C(e,o,i),r=!0},i(e){r||(Pe(t.$$.fragment,e),Pe(false),r=!0)},o(e){Ce(t.$$.fragment,e),Ce(false),r=!1},d(e){Se(t,e),e&&L(n),e&&L(o)}}}function Ri(e){let t,n;return t=new ui({}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Wi(e){let t,n,o,r,i,s,a,l=e[1]&&!e[1].isFake&&"/map"===e[3]&&Di(),c=e[1]&&!e[1].isFake&&Ri();return r=new Vo({props:{kmlOptions:e[0]}}),r.$on("change",e[5]),{c(){l&&l.c(),t=S(),c&&c.c(),n=S(),o=E("form"),Fe(r.$$.fragment),z(o,"class","form-inline svelte-gt8tj4")},m(u,p){l&&l.m(u,p),C(u,t,p),c&&c.m(u,p),C(u,n,p),C(u,o,p),Me(r,o,null),i=!0,s||(a=T(o,"submit",I(e[6])),s=!0)},p(e,o){e[1]&&!e[1].isFake&&"/map"===e[3]?l?10&o&&Pe(l,1):(l=Di(),l.c(),Pe(l,1),l.m(t.parentNode,t)):l&&(we(),Ce(l,1,1,(()=>{l=null})),ke()),e[1]&&!e[1].isFake?c?2&o&&Pe(c,1):(c=Ri(),c.c(),Pe(c,1),c.m(n.parentNode,n)):c&&(we(),Ce(c,1,1,(()=>{c=null})),ke());const i={};1&o&&(i.kmlOptions=e[0]),r.$set(i)},i(e){i||(Pe(l),Pe(c),Pe(r.$$.fragment,e),i=!0)},o(e){Ce(l),Ce(c),Ce(r.$$.fragment,e),i=!1},d(e){l&&l.d(e),e&&L(t),c&&c.d(e),e&&L(n),e&&L(o),Se(r),s=!1,a()}}}function Ni(e){let t,n;return t=new mi({props:{hidden:"/map"!==e[3],$$slots:{default:[Hi]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.hidden="/map"!==e[3]),4107&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Hi(e){let t,n,o;function r(t){e[7](t)}let i={id:"map",ofp:e[1]};return void 0!==e[0]&&(i.kmlOptions=e[0]),t=new Cr({props:i}),re.push((()=>Ee(t,"kmlOptions",r))),t.$on("save",e[8]),{c(){Fe(t.$$.fragment)},m(e,n){Me(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[1]),!n&&1&o&&(n=!0,r.kmlOptions=e[0],de((()=>n=!1))),t.$set(r)},i(e){o||(Pe(t.$$.fragment,e),o=!0)},o(e){Ce(t.$$.fragment,e),o=!1},d(e){Se(t,e)}}}function Ui(t){let n,o=t[4](t[3])+"";return{c(){n=M(o)},m(e,t){C(e,n,t)},p(e,t){8&t&&o!==(o=e[4](e[3])+"")&&W(n,o)},i:e,o:e,d(e){e&&L(n)}}}function Gi(e){let t,n;return t=new mi({props:{$$slots:{default:[Vi]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function qi(e){let t,n;return t=new mi({props:{$$slots:{default:[Xi]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Bi(e){let t,n;return t=new mi({props:{$$slots:{default:[Ji]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};4105&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Ki(e){let t,n;return t=new mi({props:{$$slots:{default:[Yi]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};4100&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Zi(e){let t,n;return t=new mi({props:{$$slots:{default:[Qi]},$$scope:{ctx:e}}}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},p(e,n){const o={};4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Vi(e){let t,n;return t=new ki({}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Xi(e){let t,n;return t=new cn({}),{c(){Fe(t.$$.fragment)},m(e,o){Me(t,e,o),n=!0},i(e){n||(Pe(t.$$.fragment,e),n=!0)},o(e){Ce(t.$$.fragment,e),n=!1},d(e){Se(t,e)}}}function Ji(t){let n,o,r,i;return n=new nn({}),n.$on("save",t[9]),r=new Ct({}),{c(){Fe(n.$$.fragment),o=S(),Fe(r.$$.fragment)},m(e,t){Me(n,e,t),C(e,o,t),Me(r,e,t),i=!0},p:e,i(e){i||(Pe(n.$$.fragment,e),Pe(r.$$.fragment,e),i=!0)},o(e){Ce(n.$$.fragment,e),Ce(r.$$.fragment,e),i=!1},d(e){Se(n,e),e&&L(o),Se(r,e)}}}function Yi(e){let t,n,o;return{c(){t=E("p"),n=M("😱: "),o=M(e[2]),z(t,"class","ofpError svelte-gt8tj4")},m(e,r){C(e,t,r),P(t,n),P(t,o)},p(e,t){4&t&&W(o,e[2])},d(e){e&&L(t)}}}function Qi(e){let t;return{c(){t=E("div"),t.textContent="traitement en cours...",H(t,"margin","auto")},m(e,n){C(e,t,n)},d(e){e&&L(t)}}}function es(e){let t,n,o,r,i,s;const a=[Ai,zi],l=[];return o=navigator&&!1===navigator.standalone&&ze?0:1,r=l[o]=a[o](e),{c(){t=E("main"),n=E("div"),r.c(),z(n,"class","content svelte-gt8tj4"),z(t,"class",i="container "+(e[3].substr(1)||"home")+" svelte-gt8tj4")},m(e,r){C(e,t,r),P(t,n),l[o].m(n,null),s=!0},p(e,[n]){r.p(e,n),(!s||8&n&&i!==(i="container "+(e[3].substr(1)||"home")+" svelte-gt8tj4"))&&z(t,"class",i)},i(e){s||(Pe(r),s=!0)},o(e){Ce(r),s=!1},d(e){e&&L(t),l[o].d()}}}function ts(e,t,n){let o,r,i,s,a;c(e,lt,(e=>n(1,o=e))),c(e,ct,(e=>n(2,r=e))),c(e,ht,(e=>n(3,i=e))),c(e,it,(e=>n(10,s=e))),c(e,nt,(e=>n(11,a=e)));(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in Lt){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(St)?t=o.toUpperCase():e.endsWith("Display")?t=!!o:e.endsWith("Change")&&(o*=1,isNaN(o)||(t=o.toFixed(1))),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||Ht.setItem(Nt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&Ht.setItem(Nt.shortcut,o));Ht.setItem(Nt.optionsKML,n)})(window.location.search);let l=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Lt&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(St)?t[n]=o.toUpperCase():n.endsWith("Display")?t[n]=!!o:n.endsWith("Change")&&(o*=1,isNaN(o)||(t[n]=o.toFixed(1))));return{...Lt,...t}})(Ht.getItem(Nt.optionsKML)||{});Ut(l,i);ee((()=>(document.addEventListener("visibilitychange",ft,!1),()=>document.removeEventListener("visibilitychange",ft))));return[l,o,r,i,e=>{window.location.hash="#/"},()=>{h(it,s=!1,s),h(nt,a=!1,a)},function(t){ne(e,t)},function(e){l=e,n(0,l)},()=>Ut(l,i),()=>Ut(l,i)]}class ns extends Te{constructor(e){super(),je(this,e,ts,es,a,{})}}try{self["workbox:window:6.1.1"]&&_()}catch(os){}function os(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function rs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function is(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return rs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rs(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.1.1"]&&_()}catch(os){}var ss=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function as(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var ls=function(e,t){this.type=e,Object.assign(this,t)};function cs(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function us(){}var ps={type:"SKIP_WAITING"};function ds(e,t){if(!t)return e&&e.then?e.then(us):Promise.resolve()}var ms=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new ss,o.en=new ss,o.on=new ss,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!as(t.scriptURL,o.sn)||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,i=n===o.vn,s={sw:n,isExternal:i,originalEvent:e};!i&&o.mn&&(s.isUpdate=!0),o.dispatchEvent(new ls(r,s)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new ls("waiting",s))}),200):"activating"===r&&(clearTimeout(o.wn),i||o.en.resolve(n))},o.dn=function(e){var t=o.hn;t===navigator.serviceWorker.controller&&(o.dispatchEvent(new ls("controlling",{sw:t,originalEvent:e,isUpdate:o.mn})),o.on.resolve(t))},o.gn=(r=function(e){var t=e.data,n=e.source;return cs(o.getSW(),(function(){o.an.has(n)&&o.dispatchEvent(new ls("message",{data:t,sw:n,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,i=o.prototype;return i.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return ds(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),cs(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&as(t.scriptURL,o.sn)&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new ls("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn,{once:!0}),o.fn}))}))}catch(e){return Promise.reject(e)}},i.update=function(){try{return this.fn?ds(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},i.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(e){try{return cs(this.getSW(),(function(t){return os(t,e)}))}catch(e){return Promise.reject(e)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&os(this.fn.waiting,ps)},i.pn=function(){var e=navigator.serviceWorker.controller;return e&&as(e.scriptURL,this.sn)?e:void 0},i.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return cs(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=is(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let fs,gs=!1;try{fs=new ns({target:document.body})}catch(e){gs=!0;try{var hs=document.createElement("p");hs.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(hs)}catch(is){}}finally{if("serviceWorker"in navigator){const e=new ms("./sw.js");tt.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{gs?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,Ke(400,os(t.sw,{type:"GET_VERSION"})).then((e=>_i(e))).catch((e=>{_i()})))})),e.register().then((e=>{gs&&e&&e.unregister(),Oi.set(e)}),console.error)}}return fs}();
//# sourceMappingURL=bundle.js.map
