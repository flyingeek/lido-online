var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(o)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let l;function c(e,t){return l||(l=document.createElement("a")),l.href=t,e===l.href}function u(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function d(e){let t;return u(e,(e=>t=e))(),t}function p(e,t,n){e.$$.on_destroy.push(u(t,n))}function m(e,t,n,o){if(e){const r=f(e,t,n,o);return e[0](r)}}function f(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function h(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}function g(e,t,n,o,r,s){if(r){const i=f(t,n,o,s);e.p(i,r)}}function v(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function y(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function $(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function b(e){return null==e?"":e}function x(e,t,n){return e.set(n),t}function w(t){return t&&i(t.destroy)?t.destroy:e}const k="undefined"!=typeof window;let C=k?()=>window.performance.now():()=>Date.now(),P=k?e=>requestAnimationFrame(e):e;const L=new Set;function M(e){L.forEach((t=>{t.c(e)||(L.delete(t),t.f())})),0!==L.size&&P(M)}function S(e){let t;return 0===L.size&&P(M),{promise:new Promise((n=>{L.add(t={c:e,f:n})})),abort(){L.delete(t)}}}function T(e,t){e.appendChild(t)}function E(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t.host?t:document}function O(e){const t=D("style");return function(e,t){T(e.head||e,t)}(E(e),t),t}function A(e,t,n){e.insertBefore(t,n||null)}function F(e){e.parentNode.removeChild(e)}function I(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function D(e){return document.createElement(e)}function j(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function R(e){return document.createTextNode(e)}function z(){return R(" ")}function N(){return R("")}function W(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function q(e){return function(t){return t.preventDefault(),e.call(this,t)}}function U(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function G(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:U(e,o,t[o])}function H(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function B(e){return""===e?null:+e}function Z(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function K(e,t){e.value=null==t?"":t}function V(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function J(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function Y(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let Q;function X(){if(void 0===Q){Q=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(e){Q=!0}}return Q}function ee(e,t,n){e.classList[n?"add":"remove"](t)}function te(e,t,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,!1,t),o}const ne=new Set;let oe,re=0;function se(e,t,n,o,r,s,i,a=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*s(e);c+=100*e+`%{${i(o,1-o)}}\n`}const u=c+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,p=E(e);ne.add(p);const m=p.__svelte_stylesheet||(p.__svelte_stylesheet=O(e).sheet),f=p.__svelte_rules||(p.__svelte_rules={});f[d]||(f[d]=!0,m.insertRule(`@keyframes ${d} ${u}`,m.cssRules.length));const h=e.style.animation||"";return e.style.animation=`${h?`${h}, `:""}${d} ${o}ms linear ${r}ms 1 both`,re+=1,d}function ie(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),re-=r,re||P((()=>{re||(ne.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),ne.clear())})))}function ae(e){oe=e}function le(){if(!oe)throw new Error("Function called outside component initialization");return oe}function ce(e){le().$$.on_mount.push(e)}function ue(e){le().$$.on_destroy.push(e)}function de(){const e=le();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=te(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function pe(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const me=[],fe=[],he=[],ge=[],ve=Promise.resolve();let ye=!1;function $e(){ye||(ye=!0,ve.then(Pe))}function be(){return $e(),ve}function xe(e){he.push(e)}function we(e){ge.push(e)}let ke=!1;const Ce=new Set;function Pe(){if(!ke){ke=!0;do{for(let e=0;e<me.length;e+=1){const t=me[e];ae(t),Le(t.$$)}for(ae(null),me.length=0;fe.length;)fe.pop()();for(let e=0;e<he.length;e+=1){const t=he[e];Ce.has(t)||(Ce.add(t),t())}he.length=0}while(me.length);for(;ge.length;)ge.pop()();ye=!1,ke=!1,Ce.clear()}}function Le(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(xe)}}let Me;function Se(){return Me||(Me=Promise.resolve(),Me.then((()=>{Me=null}))),Me}function Te(e,t,n){e.dispatchEvent(te(`${t?"intro":"outro"}${n}`))}const Ee=new Set;let Oe;function Ae(){Oe={r:0,c:[],p:Oe}}function Fe(){Oe.r||s(Oe.c),Oe=Oe.p}function Ie(e,t){e&&e.i&&(Ee.delete(e),e.i(t))}function _e(e,t,n,o){if(e&&e.o){if(Ee.has(e))return;Ee.add(e),Oe.c.push((()=>{Ee.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const De={duration:0};function je(n,o,r){let s,a,l=o(n,r),c=!1,u=0;function d(){s&&ie(n,s)}function p(){const{delay:o=0,duration:r=300,easing:i=t,tick:p=e,css:m}=l||De;m&&(s=se(n,0,1,r,o,i,m,u++)),p(0,1);const f=C()+o,h=f+r;a&&a.abort(),c=!0,xe((()=>Te(n,!0,"start"))),a=S((e=>{if(c){if(e>=h)return p(1,0),Te(n,!0,"end"),d(),c=!1;if(e>=f){const t=i((e-f)/r);p(t,1-t)}}return c}))}let m=!1;return{start(){m||(m=!0,ie(n),i(l)?(l=l(),Se().then(p)):p())},invalidate(){m=!1},end(){c&&(d(),c=!1)}}}function Re(n,o,r,a){let l=o(n,r),c=a?0:1,u=null,d=null,p=null;function m(){p&&ie(n,p)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function h(o){const{delay:r=0,duration:i=300,easing:a=t,tick:h=e,css:g}=l||De,v={start:C()+r,b:o};o||(v.group=Oe,Oe.r+=1),u||d?d=v:(g&&(m(),p=se(n,c,o,i,r,a,g)),o&&h(0,1),u=f(v,i),xe((()=>Te(n,o,"start"))),S((e=>{if(d&&e>d.start&&(u=f(d,i),d=null,Te(n,u.b,"start"),g&&(m(),p=se(n,c,u.b,u.duration,0,a,l.css))),u)if(e>=u.end)h(c=u.b,1-c),Te(n,u.b,"end"),d||(u.b?m():--u.group.r||s(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*a(t/u.duration),h(c,1-c)}return!(!u&&!d)})))}return{run(e){i(l)?Se().then((()=>{l=l(),h(e)})):h(e)},end(){m(),u=d=null}}}function ze(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let i=t.ctx;void 0!==r&&(i=i.slice(),i[r]=s);const a=e&&(t.current=e)(i);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(Ae(),_e(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),Fe())})):t.block.d(1),a.c(),Ie(a,1),a.m(t.mount(),t.anchor),l=!0),t.block=a,t.blocks&&(t.blocks[o]=a),l&&Pe()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=le();if(e.then((e=>{ae(n),o(t.then,1,t.value,e),ae(null)}),(e=>{if(ae(n),o(t.catch,2,t.error,e),ae(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const Ne="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function We(e,t){e.d(1),t.delete(e.key)}function qe(e,t,n,o,r,s,i,a,l,c,u,d){let p=e.length,m=s.length,f=p;const h={};for(;f--;)h[e[f].key]=f;const g=[],v=new Map,y=new Map;for(f=m;f--;){const e=d(r,s,f),a=n(e);let l=i.get(a);l?o&&l.p(e,t):(l=c(a,e),l.c()),v.set(a,g[f]=l),a in h&&y.set(a,Math.abs(f-h[a]))}const $=new Set,b=new Set;function x(e){Ie(e,1),e.m(a,u),i.set(e.key,e),u=e.first,m--}for(;p&&m;){const t=g[m-1],n=e[p-1],o=t.key,r=n.key;t===n?(u=t.first,p--,m--):v.has(r)?!i.has(o)||$.has(o)?x(t):b.has(r)?p--:y.get(o)>y.get(r)?(b.add(o),x(t)):($.add(r),p--):(l(n,i),p--)}for(;p--;){const t=e[p];v.has(t.key)||l(t,i)}for(;m;)x(g[m-1]);return g}function Ue(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Ge(e){e&&e.c()}function He(e,t,n,r){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(t,n),r||xe((()=>{const t=l.map(o).filter(i);c?c.push(...t):s(t),e.$$.on_mount=[]})),u.forEach(xe)}function Be(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ze(t,n,o,i,a,l,c,u=[-1]){const d=oe;ae(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:n.context||[]),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};c&&c(p.root);let m=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),m&&function(e,t){-1===e.$$.dirty[0]&&(me.push(e),$e(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),m=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(F)}else p.fragment&&p.fragment.c();n.intro&&Ie(t.$$.fragment),He(t,n.target,n.anchor,n.customElement),Pe()}ae(d)}class Ke{$destroy(){Be(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Ve{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Je="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,Ye=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),Qe=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),Xe=matchMedia("(hover: hover)").matches;function et(e,t,n){let o;return function(){const r=this,s=arguments,i=function(){o=null,n||e.apply(r,s)},a=n&&!o;clearTimeout(o),o=setTimeout(i,t),a&&e.apply(r,s)}}function tt(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function nt(e,t,n){return e<=t?t:e>=n?n:e}function ot(e,t,n){return!(e<t)&&!(e>n)}function rt(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function st(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function it(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}const at=(e,t)=>{let n=e.split("."),o=t.split(".");for(var r=0;r<3;r++){let e=Number(n[r]),t=Number(o[r]);if(e>t)return 1;if(t>e)return-1;if(!isNaN(e)&&isNaN(t))return 1;if(isNaN(e)&&!isNaN(t))return-1}return 0},lt=async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},ct=(e,t)=>{let n=0,o=e.length-1,r=-1;for(;n<=o;){let s=Math.trunc((n+o)/2);t(e[s])?(r=s,o=s-1):n=s+1}return-1!==r&&t(e[r])?r:-1};function ut(e){const t=e-1;return t*t*t+1}function dt(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function pt(e,{delay:t=0,duration:n=400,easing:o=ut,x:r=0,y:s=0,opacity:i=0}={}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-i);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*s}px);\n\t\t\topacity: ${l-u*t}`}}function mt(e,{delay:t=0,duration:n=400,easing:o=ut}={}){const r=getComputedStyle(e),s=+r.opacity,i=parseFloat(r.height),a=parseFloat(r.paddingTop),l=parseFloat(r.paddingBottom),c=parseFloat(r.marginTop),u=parseFloat(r.marginBottom),d=parseFloat(r.borderTopWidth),p=parseFloat(r.borderBottomWidth);return{delay:t,duration:n,easing:o,css:e=>`overflow: hidden;opacity: ${Math.min(20*e,1)*s};height: ${e*i}px;padding-top: ${e*a}px;padding-bottom: ${e*l}px;margin-top: ${e*c}px;margin-bottom: ${e*u}px;border-top-width: ${e*d}px;border-bottom-width: ${e*p}px;`}}const ft=[];function ht(e,t){return{subscribe:gt(e,t).subscribe}}function gt(t,n=e){let o;const r=new Set;function s(e){if(a(t,e)&&(t=e,o)){const e=!ft.length;for(const e of r)e[1](),ft.push(e,t);if(e){for(let e=0;e<ft.length;e+=2)ft[e][0](ft[e+1]);ft.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,a=e){const l=[i,a];return r.add(l),1===r.size&&(o=n(s)||e),i(t),()=>{r.delete(l),0===r.size&&(o(),o=null)}}}}function vt(t,n,o){const r=!Array.isArray(t),a=r?[t]:t,l=n.length<2;return ht(o,(t=>{let o=!1;const c=[];let d=0,p=e;const m=()=>{if(d)return;p();const o=n(r?c[0]:c,t);l?t(o):p=i(o)?o:e},f=a.map(((e,t)=>u(e,(e=>{c[t]=e,d&=~(1<<t),o&&m()}),(()=>{d|=1<<t}))));return o=!0,m(),function(){s(f),p()}}))}const yt=["220","318","319","320","321","330","340","350","380","787","772","773","77F"],$t=["340","380"];const bt=gt(),xt=gt(!1),wt=gt(!1),kt=gt(!1),Ct=gt(!1),Pt=gt(!1),Lt=gt(!1),Mt=function(e){const{subscribe:t,set:n,update:o}=gt(e);return{subscribe:t,set:n,update:o,reset:()=>n("object"==typeof e?{...e}:Array.isArray(e)?[...e]:e)}}(!1),St=gt(0),Tt=gt(-1),Et=gt(),Ot=gt(),At=gt(),Ft=vt([Et,At],(([e,t])=>{if(e&&t){if(e.timeMatrix.length>0)return new Date(t.getTime()+6e4*e.timeMatrix[e.timeMatrix.length-1][1]);return new Date(t.getTime()+6e4*e.infos.flightTime)}})),It=gt(),_t=vt([Et,It],(([e,t])=>{let n;if(t?n=t:e&&(n=e.infos.aircraftType),n&&-1!==yt.indexOf(n))return n}));let Dt=new Date;const jt=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-Dt>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting?(wt.set(!0),kt.set(!0)):e.update(),xt.set(!1),Dt=new Date)}),console.error)}},Rt=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&jt()},zt=ht(!0,(e=>{const t=()=>{document&&document.visibilityState?"visible"===document.visibilityState?e(!0):e(!1):e(!0)};return document.addEventListener("visibilitychange",t),t(),()=>{document.removeEventListener("visibilitychange",t)}})),Nt=ht({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),Wt=ht("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(Ct.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),jt()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}}));vt(Wt,(e=>"/help"===e||e&&e.startsWith("/help")));const qt=vt([Et,Tt,At,Mt,zt],(([e,t,n,o,r],s)=>{let i;const a=o?1e4:6e4;if(e&&n){const o=e=>{e<100?s(e):(s(100),clearInterval(i),i=void 0,Tt.set(-1))};if(t>=0){let e=t;i=setInterval((()=>{o(e),e++}),100)}else{const t=n,l=new Date(t.getTime()+6e4*e.infos.flightTime),c=()=>{let n=new Date;return n<=t?0:n>=l?100:(n-t)/(60*e.infos.flightTime)/10},u=c();u<100?(r&&(i=setInterval((()=>{const e=c();o(e)}),a)),s(u)):s(100)}}else s(0);return()=>{i&&clearInterval(i)}}),0),Ut=vt([Et,qt],(([e,t])=>{if(!e)return{map:{latitude:0,longitude:0},gramet:t,fl:300,reltime:0};const n=e.timeMatrix,o=e.distanceMatrix,r=o[0][0],s=o[o.length-1][0],i=o[o.length-1][1],a=0!==n.length?n[0][2]:o[0][2],l=0!==n.length?n[n.length-1][2]:o[o.length-1][2],c=t*(0!==n.length?n[n.length-1][1]:e.infos.flightTime)/100;if(t<=0)return{map:r,gramet:0,fl:a,reltime:c};if(t>=100)return{map:s,gramet:100,fl:l,reltime:c};if(0!==n.length){const e=ct(n,(e=>e[1]>=c)),[t,s,l]=n[e];if(c-s==0)return{reltime:c,map:t,gramet:100*o[e][1]/i,fl:l};const u=n[e-1];if(u){const n=o[e][1]-o[e-1][1],r=(s-c)/(s-u[1]);return{reltime:c,map:t.atFraction(u[0],r,n),gramet:100*(o[e][1]-r*n)/i,fl:u[2]}}return{reltime:c,map:r,gramet:0,fl:a}}if(0!==o.length){const e=t*o[o.length-1][1]/100,n=ct(o,(t=>t[1]>=e)),[s,i,l]=o[n];if(e-i==0)return{map:s,gramet:t,fl:l,reltime:c};const u=o[n-1];if(u){const n=i-u[1];return{map:s.atFraction(u[0],(i-e)/n,n),gramet:t,fl:u[2],reltime:c}}return{map:r,gramet:0,fl:a,reltime:c}}return{map:s,gramet:100,fl:l,reltime:c}}),{map:{latitude:0,longitude:0},gramet:0,fl:300,reltime:0});function Gt(e){let t;return{c(){t=D("textarea"),t.value=e[0],U(t,"class","svelte-1c0wrid")},m(n,o){A(n,t,o),e[5](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&F(t),e[5](null)}}}function Ht(t){let n,o,r;return{c(){n=D("a"),n.textContent="copier la route",U(n,"role","button"),U(n,"class","btn btn-primary"),U(n,"href","lhs-mpilot://")},m(e,s){A(e,n,s),o||(r=W(n,"click",t[4]),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}function Bt(t){let n,o,r;return{c(){n=D("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",U(n,"role","button"),U(n,"class","btn btn-primary"),U(n,"href","lhs-mpilot://")},m(e,s){A(e,n,s),o||(r=W(n,"click",t[4]),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}function Zt(n){let o,r,a;return{c(){o=D("span"),o.textContent="copié!",U(o,"class","svelte-1c0wrid")},m(e,t){A(e,o,t),a=!0},i(e){a||(r&&r.end(1),a=!0)},o(n){r=function(n,o,r){let a,l=o(n,r),c=!0;const u=Oe;function d(){const{delay:o=0,duration:r=300,easing:i=t,tick:d=e,css:p}=l||De;p&&(a=se(n,1,0,r,o,i,p));const m=C()+o,f=m+r;xe((()=>Te(n,!1,"start"))),S((e=>{if(c){if(e>=f)return d(0,1),Te(n,!1,"end"),--u.r||s(u.c),!1;if(e>=m){const t=i((e-m)/r);d(1-t,t)}}return c}))}return u.r+=1,i(l)?Se().then((()=>{l=l(),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),c&&(a&&ie(n,a),c=!1)}}}(o,dt,{}),a=!1},d(e){e&&F(o),e&&r&&r.end()}}}function Kt(e){let t,n,o,r,s,i,a,l,c,u,d,p,m,f,h,g=null!=e[0]&&Gt(e);let v=(Je?Bt:Ht)(e),y=Je&&function(e){let t;return{c(){t=D("div"),t.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n                il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',U(t,"class","card-text")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}(),$=e[2]&&Zt();return{c(){g&&g.c(),t=z(),n=D("div"),o=D("div"),r=D("h5"),r.textContent="Route Lido",s=z(),i=D("div"),a=D("div"),a.innerHTML='<p class="card-text">Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\n                    d&#39;avoir une application Lido plus réactive.</p>',l=z(),c=D("div"),v.c(),u=z(),y&&y.c(),d=z(),p=D("div"),m=R(e[3]),f=z(),$&&$.c(),U(r,"class","card-title"),U(a,"class","col-12 col-md-9"),U(c,"class","text-md-end col align-self-center col-12 col-md-3 py-3 py-md-0"),U(i,"class","row mb-3"),U(p,"class","text-monospace svelte-1c0wrid"),U(o,"class","card-body"),U(n,"class","card mb-3 svelte-1c0wrid")},m(e,b){g&&g.m(e,b),A(e,t,b),A(e,n,b),T(n,o),T(o,r),T(o,s),T(o,i),T(i,a),T(i,l),T(i,c),v.m(c,null),T(o,u),y&&y.m(o,null),T(o,d),T(o,p),T(p,m),T(p,f),$&&$.m(p,null),h=!0},p(e,[n]){null!=e[0]?g?g.p(e,n):(g=Gt(e),g.c(),g.m(t.parentNode,t)):g&&(g.d(1),g=null),v.p(e,n),e[2]?$?4&n&&Ie($,1):($=Zt(),$.c(),Ie($,1),$.m(p,null)):$&&(Ae(),_e($,1,1,(()=>{$=null})),Fe())},i(e){h||(Ie($),h=!0)},o(e){_e($),h=!1},d(e){g&&g.d(e),e&&F(t),e&&F(n),v.d(),y&&y.d(),$&&$.d()}}}let Vt=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Vt=!0)}))}catch(e){}function Jt(e,t,n){let o;p(e,Et,(e=>n(7,o=e)));let r,s=null;const i=o?o.lidoRoute(!1).join(" "):"";let a,l=!1;return ue((()=>{a&&clearTimeout(a)})),[s,r,l,i,e=>{const t=async function(e){let t=!0;if(Vt)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await be(),r.focus(),r.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(i);Je||(n(2,l=t),a=setTimeout((function(){n(2,l=!1),a&&clearTimeout(a)}),3e3),e.preventDefault())},function(e){fe[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class Yt extends Ke{constructor(e){super(),Ze(this,e,Jt,Kt,a,{})}}const Qt={routeDisplay:!0,routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natColor:"80DA25A8",greatCircleDisplay:!0,greatCircleColor:"5F1478FF"};function Xt(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const en=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,Xt(window.kmlGen,Qt)),window.kmlGen);function tn(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-")||e.endsWith("-change")||"nat-incomplete-color"===e||"nat-pin-position"===e||e.startsWith("ogimet-"))return;const n=en(),o=tt(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}function nn(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function on(e){let t,n,o,r,s=e[14].label+"";return{c(){t=D("option"),n=R(s),t.__value=o=e[16],t.value=t.__value,t.selected=r=e[16]===e[1]},m(e,o){A(e,t,o),T(t,n)},p(e,n){2&n&&r!==(r=e[16]===e[1])&&(t.selected=r)},d(e){e&&F(t)}}}function rn(t){let n,o,r,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,k=pn,C=[];for(let e=0;e<k.length;e+=1)C[e]=on(nn(t,k,e));return{c(){n=D("kmlcolor"),o=D("pin"),r=j("svg"),a=j("use"),l=z(),c=D("select");for(let e=0;e<C.length;e+=1)C[e].c();u=z(),d=D("picker"),p=D("label"),m=D("input"),g=z(),v=D("input"),H(a,"xlink:href","#marker-symbol"),V(a,"stroke",0===t[1]?"#fff":pn[t[1]].color),V(a,"fill",pn[t[1]].color),U(o,"class","form-control svelte-5u5yzj"),U(c,"name",t[4]),U(c,"class","form-select"),void 0===t[1]&&xe((()=>t[8].call(c))),U(m,"type","color"),U(p,"style",f=dn(t[2])),U(v,"type","range"),U(v,"min","30"),U(v,"max","255"),U(d,"class","form-control"),U(d,"style",y=un(t[2][0])),U(n,"class","input-group")},m(e,s){A(e,n,s),T(n,o),T(o,r),T(r,a),T(n,l),T(n,c);for(let e=0;e<C.length;e+=1)C[e].m(c,null);J(c,t[1]),T(n,u),T(n,d),T(d,p),T(p,m),K(m,t[2][0]),T(d,g),T(d,v),K(v,t[2][1]),b||(x=[W(c,"change",t[8]),W(c,"change",t[9]),W(m,"input",t[10]),w(h=t[5].call(null,p,t[2])),W(v,"change",t[11]),W(v,"input",t[11]),w($=t[6].call(null,n,t[0]))],b=!0)},p(e,[t]){if(2&t&&V(a,"stroke",0===e[1]?"#fff":pn[e[1]].color),2&t&&V(a,"fill",pn[e[1]].color),2&t){let n;for(k=pn,n=0;n<k.length;n+=1){const o=nn(e,k,n);C[n]?C[n].p(o,t):(C[n]=on(o),C[n].c(),C[n].m(c,null))}for(;n<C.length;n+=1)C[n].d(1);C.length=k.length}2&t&&J(c,e[1]),4&t&&K(m,e[2][0]),4&t&&f!==(f=dn(e[2]))&&U(p,"style",f),h&&i(h.update)&&4&t&&h.update.call(null,e[2]),4&t&&K(v,e[2][1]),4&t&&y!==(y=un(e[2][0]))&&U(d,"style",y),$&&i($.update)&&1&t&&$.update.call(null,e[0])},i:e,o:e,d(e){e&&F(n),I(C,e),b=!1,s(x)}}}const sn=/^[A-F0-9]{8}$/i,an=e=>{let[t,n]=cn(e);return[t,n/255]},ln=["#FF0000",255],cn=e=>{try{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]}catch(e){return ln}},un=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},dn=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,pn=[{label:"Aucun repère",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza/Earth)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function mn(e,t,n){const o=de();let{kmlColor:r="FF0000FF"}=t,{selected:s=0}=t,{name:i}=t;const a=i+"-color",l=i+"-pin";let c=ln;const u=et(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"selected"in e&&n(1,s=e.selected),"name"in e&&n(7,i=e.name)},[r,s,c,o,l,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),u("change",{name:a,value:r})}}},function(e){return n(2,c=cn(r)),{update(e){n(2,c=cn(e)),u("change",{name:a,value:e.toUpperCase()})}}},i,function(){s=Y(this),n(1,s)},e=>{e.target.blur(),o("change",{name:l,value:s})},function(){c[0]=this.value,n(2,c)},function(){c[1]=B(this.value),n(2,c)}]}class fn extends Ke{constructor(e){super(),Ze(this,e,mn,rn,a,{kmlColor:0,selected:1,name:7})}}const hn={routeDisplay:!0,routeColor:"FFDA25A8",alternateDisplay:!0,alternateColor:"FFFF00FF",natDisplay:!0,natPinPosition:0,natColor:"80858585",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,airportLabel:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC",iconTextChange:"1.0",lineWidthChange:"1.0",iconSizeChange:"1.0"};const gn=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType",exportKML:"exportKML",focusKML:"focusKML",changelogOnUpdate:"changelogOnUpdate"}),vn=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){const n=JSON.stringify(t);"{}"!==n&&localStorage.setItem(e,n)}removeItem(e){localStorage.removeItem(e)}hasItem(e){return null!==localStorage.getItem(e)}},yn=(e,t=hn)=>{const n={};for(let[o,r]of Object.entries(e))o in t&&(o.endsWith("Pin")?(r*=1,isNaN(r)||(n[o]=r)):o.endsWith("Color")&&r.match(sn)?n[o]=r.toUpperCase():o.endsWith("Display")?n[o]=!!r:o.endsWith("Change")&&(r*=1,isNaN(r)||(n[o]=r.toFixed(1))));return{...t,...n}},$n=(e,t,n="Mon OFP2MAP")=>{const o={},r=["optionsKML","shortcut","downloadType"];for(const[t,n]of Object.entries(gn)){if(!r.includes(n))continue;let s=vn.getItem(n);if(t===gn.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==hn[t])))t[n]=e[n];s=t}if(null!==s)if(t===gn.optionsKML)for(const[e,t]of Object.entries(s))o[e]=t;else o[t]=s}const s=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),i=window.location.origin+window.location.pathname+(s?"?"+s:"")+"#"+t;window.history.replaceState(o,n,i)};function bn(t){let n,o,r,i,a,l,c,u,d,p;return{c(){n=D("div"),o=D("span"),r=z(),i=D("input"),a=z(),l=D("div"),c=D("a"),u=R("Lancer"),U(o,"class","input-group-text svelte-1yaj23v"),U(i,"class","form-control svelte-1yaj23v"),U(i,"placeholder","Nom du raccourci"),U(i,"type","text"),U(c,"href",t[1]),U(c,"class","svelte-1yaj23v"),ee(c,"disabled",t[2]),U(l,"class","input-group-text svelte-1yaj23v"),ee(l,"disabled",t[2]),U(n,"class","input-group")},m(e,s){A(e,n,s),T(n,o),T(n,r),T(n,i),K(i,t[0]),T(n,a),T(n,l),T(l,c),T(c,u),d||(p=[W(i,"input",t[5]),W(i,"change",t[4]),W(c,"click",t[3])],d=!0)},p(e,[t]){1&t&&i.value!==e[0]&&K(i,e[0]),2&t&&U(c,"href",e[1]),4&t&&ee(c,"disabled",e[2]),4&t&&ee(l,"disabled",e[2])},i:e,o:e,d(e){e&&F(n),d=!1,s(p)}}}const xn="OFP2MAP";function wn(e,t,n){let o,r;p(e,Et,(e=>n(6,r=e)));const s=de(),i=gn.shortcut;let a,l=vn.getItem(i)||xn;const c=r?r.lidoRoute(!1).join(" "):"";return e.$$.update=()=>{1&e.$$.dirty&&n(2,o=!(l.trim()&&Je))},[l,a,o,function(e){const t=l.trim();if(t&&Je){const e=en(),o={lidoRoute:c,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),kmlGoogleEarth:e.render({styleTemplate:editolido.googleEarthStyleTemplate}),grametProxyURL:r.ogimetData.proxyImg};n(1,a="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=l.trim();e===xn?vn.removeItem(i):vn.setItem(i,e),s("save",[i,e])},function(){l=this.value,n(0,l)}]}class kn extends Ke{constructor(e){super(),Ze(this,e,wn,bn,a,{})}}function Cn(e){const t=()=>{document&&document.visibilityState&&"visible"!==document.visibilityState&&e&&e.blur&&e.blur()};return document.addEventListener("visibilitychange",t,!1),{destroy(){document.removeEventListener("visibilitychange",t)}}}function Pn(t){let n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x=Ln[0]+"",k=Ln[1]+"",C=Ln[2]+"";return{c(){n=D("div"),o=D("select"),r=D("option"),i=R(x),l=D("option"),c=R(k),d=D("option"),p=R(C),h=z(),g=D("div"),v=D("a"),y=R(t[0]),r.selected=a=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,d.selected=m=2===t[1],d.__value=2,d.value=d.__value,U(o,"class",f="form-select choice"+t[1]+" svelte-c2m79k"),U(o,"aria-label","Example select with button addon"),void 0===t[1]&&xe((()=>t[7].call(o))),U(v,"class"," svelte-c2m79k"),U(v,"download",t[3]),U(v,"href",t[2]),U(g,"class","input-group-text svelte-c2m79k"),U(n,"class","input-group svelte-c2m79k")},m(e,s){A(e,n,s),T(n,o),T(o,r),T(r,i),T(o,l),T(l,c),T(o,d),T(d,p),J(o,t[1]),T(n,h),T(n,g),T(g,v),T(v,y),t[8](n),$||(b=[W(o,"change",t[7]),W(o,"change",t[6]),w(Cn.call(null,o)),W(v,"click",t[5])],$=!0)},p(e,[t]){2&t&&a!==(a=0===e[1])&&(r.selected=a),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&m!==(m=2===e[1])&&(d.selected=m),2&t&&f!==(f="form-select choice"+e[1]+" svelte-c2m79k")&&U(o,"class",f),2&t&&J(o,e[1]),1&t&&Z(y,e[0]),8&t&&U(v,"download",e[3]),4&t&&U(v,"href",e[2])},i:e,o:e,d(e){e&&F(n),t[8](null),$=!1,s(b)}}}const Ln=["KML Mapsme","KML Avenza","KML Google Earth"],Mn=["bs-green","bs-purple","bs4-cyan"];function Sn(e,t,n){const o=de();let{label:r}=t;const s=gn.downloadType;let i=vn.getItem(s)||1;"string"==typeof i&&(i=parseInt(i,10)),(i<0||i>=Ln.length)&&(i=0);let a,l="",c="";const u=e=>{a.style.setProperty("--color",`var(--${Mn[i]})`)},d=(e,t="application/vnd.google-earth.kml+xml")=>{const n=new Blob(e,{type:t});return URL.createObjectURL(n)};return ce((()=>(u(),()=>{l&&l.startsWith("blob:")&&URL.revokeObjectURL(l)}))),e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,i,l,c,a,function(e){const t=en(),o=["_mapsme.kml","_avenza.kml","_googleearth.kml"][i];let r=t.name;if(r?(r=r.trim(),n(3,c=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,c="editolido"+o),l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),0===i)n(2,l=d([t.render()]));else if(1===i)n(2,l=d([t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})]));else{if(2!==i)return e.preventDefault(),!1;n(2,l=d([t.render({styleTemplate:editolido.googleEarthStyleTemplate})]))}},function(e){e.target.blur(),1===i?vn.removeItem(s):vn.setItem(s,i),o("save",[s,i]),u()},function(){i=Y(this),n(1,i)},function(e){fe[e?"unshift":"push"]((()=>{a=e,n(4,a)}))}]}class Tn extends Ke{constructor(e){super(),Ze(this,e,Sn,Pn,a,{label:0})}}function En(e){let t,n,o,r,a,l,c,u,d,p,f,y,$,b,x,k;const C=e[8].default,P=m(C,e,e[7],null),L=P||function(e){let t;return{c(){t=R("Couleur")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}();return{c(){t=D("kmlcolor"),n=D("label"),o=D("input"),L&&L.c(),r=z(),a=D("picker"),l=D("label"),c=D("input"),p=z(),f=D("input"),U(o,"name",e[3]),o.checked=e[1],U(o,"type","checkbox"),U(n,"for",e[3]),U(n,"class","form-control"),U(c,"type","color"),U(l,"style",u=dn(e[2])),U(f,"type","range"),U(f,"min","30"),U(f,"max","255"),U(a,"class","form-control"),U(a,"style",y=un(e[2][0])),U(t,"class","input-group checkbox-combo")},m(s,i){A(s,t,i),T(t,n),T(n,o),L&&L.m(n,null),T(t,r),T(t,a),T(a,l),T(l,c),K(c,e[2][0]),T(a,p),T(a,f),K(f,e[2][1]),b=!0,x||(k=[W(o,"change",e[9]),W(c,"input",e[10]),w(d=e[4].call(null,l,e[2])),W(f,"change",e[11]),W(f,"input",e[11]),w($=e[5].call(null,t,e[0]))],x=!0)},p(e,[t]){(!b||2&t)&&(o.checked=e[1]),P&&P.p&&(!b||128&t)&&g(P,C,e,e[7],b?h(C,e[7],t,null):v(e[7]),null),4&t&&K(c,e[2][0]),(!b||4&t&&u!==(u=dn(e[2])))&&U(l,"style",u),d&&i(d.update)&&4&t&&d.update.call(null,e[2]),4&t&&K(f,e[2][1]),(!b||4&t&&y!==(y=un(e[2][0])))&&U(a,"style",y),$&&i($.update)&&1&t&&$.update.call(null,e[0])},i(e){b||(Ie(L,e),b=!0)},o(e){_e(L,e),b=!1},d(e){e&&F(t),L&&L.d(e),x=!1,s(k)}}}function On(e,t,n){let{$$slots:o={},$$scope:r}=t;const s=de();let{kmlColor:i="FF0000FF"}=t,{checked:a}=t,{name:l}=t;const c=l+"-color",u=l+"-display";let d=ln;const p=et(s,500);return e.$$set=e=>{"kmlColor"in e&&n(0,i=e.kmlColor),"checked"in e&&n(1,a=e.checked),"name"in e&&n(6,l=e.name),"$$scope"in e&&n(7,r=e.$$scope)},[i,a,d,u,function(e){return{update(e){const[t,o]=e;n(0,i=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),p("change",{name:c,value:i})}}},function(e){return n(2,d=cn(i)),{update(e){n(2,d=cn(e)),p("change",{name:c,value:e.toUpperCase()})}}},l,r,o,function(t){pe.call(this,e,t)},function(){d[0]=this.value,n(2,d)},function(){d[1]=B(this.value),n(2,d)}]}class An extends Ke{constructor(e){super(),Ze(this,e,On,En,a,{kmlColor:0,checked:1,name:6})}}function Fn(e,t,n){const o=e.slice();return o[7]=t[n],o[9]=n,o}function In(e,t,n){const o=e.slice();return o[7]=t[n],o}function _n(e,t){let n,o,r,s,i=t[7].label+"";return{key:e,first:null,c(){n=D("option"),o=R(i),n.__value=r=t[7].id,n.value=n.__value,n.selected=s=t[7].id===t[0],this.first=n},m(e,t){A(e,n,t),T(n,o)},p(e,o){t=e,1&o&&s!==(s=t[7].id===t[0])&&(n.selected=s)},d(e){e&&F(n)}}}function Dn(e){let t,n,o,r,s=e[7].label+"";return{c(){t=D("option"),n=R(s),t.__value=o=e[9],t.value=t.__value,t.selected=r=e[9]===e[1]},m(e,o){A(e,t,o),T(t,n)},p(e,n){2&n&&r!==(r=e[9]===e[1])&&(t.selected=r)},d(e){e&&F(t)}}}function jn(t){let n,o,r,i,a,l,c,u,d,p,m,f,h,g,v=[],y=new Map,$=Rn;const b=e=>e[7].id;for(let e=0;e<$.length;e+=1){let n=In(t,$,e),o=b(n);y.set(o,v[e]=_n(o,n))}let x=zn,k=[];for(let e=0;e<x.length;e+=1)k[e]=Dn(Fn(t,x,e));return{c(){n=D("div"),o=D("div"),r=D("div"),i=D("select");for(let e=0;e<v.length;e+=1)v[e].c();a=z(),l=D("label"),l.textContent="Style",c=z(),u=D("div"),d=D("div"),p=D("select");for(let e=0;e<k.length;e+=1)k[e].c();m=z(),f=D("label"),f.textContent="Noms",U(i,"name","airport-pin"),U(i,"class","form-select"),void 0===t[0]&&xe((()=>t[3].call(i))),U(l,"for","airport-pin"),U(l,"class","svelte-f39dqa"),U(r,"class","form-floating"),U(o,"class","col svelte-f39dqa"),U(p,"name","airport-label"),U(p,"class","form-select"),void 0===t[1]&&xe((()=>t[5].call(p))),U(f,"for","airport-label"),U(f,"class","svelte-f39dqa"),U(d,"class","form-floating"),U(u,"class","col svelte-f39dqa"),U(n,"class","row g-2 svelte-f39dqa")},m(e,s){A(e,n,s),T(n,o),T(o,r),T(r,i);for(let e=0;e<v.length;e+=1)v[e].m(i,null);J(i,t[0]),T(r,a),T(r,l),T(n,c),T(n,u),T(u,d),T(d,p);for(let e=0;e<k.length;e+=1)k[e].m(p,null);J(p,t[1]),T(d,m),T(d,f),h||(g=[w(Cn.call(null,i)),W(i,"change",t[3]),W(i,"change",t[4]),w(Cn.call(null,p)),W(p,"change",t[5]),W(p,"change",t[6])],h=!0)},p(e,[t]){if(1&t&&($=Rn,v=qe(v,t,b,1,e,$,y,i,We,_n,null,In)),1&t&&J(i,e[0]),2&t){let n;for(x=zn,n=0;n<x.length;n+=1){const o=Fn(e,x,n);k[n]?k[n].p(o,t):(k[n]=Dn(o),k[n].c(),k[n].m(p,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=x.length}2&t&&J(p,e[1])},i:e,o:e,d(e){e&&F(n);for(let e=0;e<v.length;e+=1)v[e].d();I(k,e),h=!1,s(g)}}}const Rn=[{label:"statuts",id:0},{label:"vert/rouge",id:1},{label:"bleu/vert/rouge",id:3},{label:"médical",id:2}],zn=[{label:"ICAO"},{label:"IATA"}],Nn=e=>2===e,Wn=e=>3===e;function qn(e,t,n){const o=de();let{selectedPin:r=0}=t,{selectedLabel:s=0}=t;return e.$$set=e=>{"selectedPin"in e&&n(0,r=e.selectedPin),"selectedLabel"in e&&n(1,s=e.selectedLabel)},[r,s,o,function(){r=Y(this),n(0,r)},e=>{e.target.blur(),o("change",{name:"airport-pin",value:r})},function(){s=Y(this),n(1,s)},e=>{e.target.blur(),o("change",{name:"airport-label",value:s})}]}class Un extends Ke{constructor(e){super(),Ze(this,e,qn,jn,a,{selectedPin:0,selectedLabel:1})}}function Gn(t){let n,o,r,i,a,l,c,u,d,p,m,f;return{c(){n=D("div"),o=D("label"),r=R(t[2]),i=z(),a=D("button"),a.innerHTML="<small>➖</small>",l=z(),c=D("div"),u=R(t[0]),d=z(),p=D("button"),p.textContent="➕",U(o,"for",t[1]),U(o,"class","input-group-text svelte-p16o3m"),U(a,"class","form-control svelte-p16o3m"),U(a,"type","button"),U(c,"class","form-control svelte-p16o3m"),U(p,"class","form-control svelte-p16o3m"),U(p,"type","button"),U(n,"class","input-group input-group-sm mb-2")},m(e,s){A(e,n,s),T(n,o),T(o,r),T(n,i),T(n,a),T(n,l),T(n,c),T(c,u),T(n,d),T(n,p),m||(f=[W(a,"click",t[4]),W(p,"click",t[3])],m=!0)},p(e,[t]){4&t&&Z(r,e[2]),2&t&&U(o,"for",e[1]),1&t&&Z(u,e[0])},i:e,o:e,d(e){e&&F(n),m=!1,s(f)}}}function Hn(e,t,n){const o=de();let{name:r}=t,{label:s}=t,{value:i}=t,{min:a=.6}=t,{max:l=2}=t,{step:c=.1}=t,{decimals:u=1}=t;const d=et(o,100);return e.$$set=e=>{"name"in e&&n(1,r=e.name),"label"in e&&n(2,s=e.label),"value"in e&&n(0,i=e.value),"min"in e&&n(5,a=e.min),"max"in e&&n(6,l=e.max),"step"in e&&n(7,c=e.step),"decimals"in e&&n(8,u=e.decimals)},[i,r,s,()=>{const e=i;n(0,i=Math.min(Math.max(parseFloat(i)+c,a),l).toFixed(u)),i!==e&&d("change",{name:r,value:i})},()=>{const e=i;n(0,i=Math.min(Math.max(parseFloat(i)-c,a),l).toFixed(u)),i!==e&&d("change",{name:r,value:i})},a,l,c,u]}class Bn extends Ke{constructor(e){super(),Ze(this,e,Hn,Gn,a,{name:1,label:2,value:0,min:5,max:6,step:7,decimals:8})}}function Zn(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Kn(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x=e[6]&&Vn(e);u=new Bn({props:{name:"icon-text-change",label:"Labels",value:e[0].iconTextChange,min:.9,max:2}}),u.$on("change",e[7]);let k=e[6]&&ro(e);function C(e,t){return e[4]?so:io}m=new Bn({props:{name:"icon-size-change",label:"Icônes",value:e[0].iconSizeChange}}),m.$on("change",e[7]);let P=C(e),L=P(e);return{c(){t=D("div"),n=D("a"),o=z(),r=D("form"),x&&x.c(),i=z(),a=D("fieldset"),l=D("legend"),l.textContent="Aspect général",c=z(),Ge(u.$$.fragment),d=z(),k&&k.c(),p=z(),Ge(m.$$.fragment),f=z(),h=D("div"),L.c(),U(n,"class","btn-close float-end"),U(n,"role","button"),U(n,"href","."),U(a,"class","form-group svelte-1uvbvs2"),U(h,"class","svelte-1uvbvs2"),U(r,"class","svelte-1uvbvs2"),ee(r,"mt-5",!e[6]),U(t,"class","settings svelte-1uvbvs2"),ee(t,"sidebar",e[5]),ee(t,"focusmode",e[4])},m(s,v){A(s,t,v),T(t,n),T(t,o),T(t,r),x&&x.m(r,null),T(r,i),T(r,a),T(a,l),T(a,c),He(u,a,null),T(a,d),k&&k.m(a,null),T(a,p),He(m,a,null),T(r,f),T(r,h),L.m(h,null),y=!0,$||(b=[W(n,"click",q(e[17])),W(r,"submit",q(e[16])),w(g=Zn.call(null,t)),W(t,"click_outside",e[18])],$=!0)},p(e,n){e[6]?x?(x.p(e,n),64&n&&Ie(x,1)):(x=Vn(e),x.c(),Ie(x,1),x.m(r,i)):x&&(Ae(),_e(x,1,1,(()=>{x=null})),Fe());const o={};1&n&&(o.value=e[0].iconTextChange),u.$set(o),e[6]?k?(k.p(e,n),64&n&&Ie(k,1)):(k=ro(e),k.c(),Ie(k,1),k.m(a,p)):k&&(Ae(),_e(k,1,1,(()=>{k=null})),Fe());const s={};1&n&&(s.value=e[0].iconSizeChange),m.$set(s),P===(P=C(e))&&L?L.p(e,n):(L.d(1),L=P(e),L&&(L.c(),L.m(h,null))),64&n&&ee(r,"mt-5",!e[6]),32&n&&ee(t,"sidebar",e[5]),16&n&&ee(t,"focusmode",e[4])},i(e){y||(Ie(x),Ie(u.$$.fragment,e),Ie(k),Ie(m.$$.fragment,e),xe((()=>{v||(v=Re(t,pt,{duration:300,x:200,y:0},!0)),v.run(1)})),y=!0)},o(e){_e(x),_e(u.$$.fragment,e),_e(k),_e(m.$$.fragment,e),v||(v=Re(t,pt,{duration:300,x:200,y:0},!1)),v.run(0),y=!1},d(e){e&&F(t),x&&x.d(),Be(u),k&&k.d(),Be(m),L.d(),e&&v&&v.end(),$=!1,s(b)}}}function Vn(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,w,k,C,P,L,M,S,E,O,I,_,j,N,q,G,H,B;c=new An({props:{name:"route",kmlColor:e[0].routeColor,checked:e[0].routeDisplay,$$slots:{default:[Yn]},$$scope:{ctx:e}}}),c.$on("change",e[7]);let Z=e[4]&&Qn();return m=new An({props:{name:"alternate",kmlColor:e[0].alternateColor,checked:e[0].alternateDisplay,$$slots:{default:[Xn]},$$scope:{ctx:e}}}),m.$on("change",e[7]),g=new An({props:{name:"nat",kmlColor:e[0].natColor,checked:e[0].natDisplay,$$slots:{default:[eo]},$$scope:{ctx:e}}}),g.$on("change",e[7]),x=new An({props:{name:"great-circle",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay,$$slots:{default:[to]},$$scope:{ctx:e}}}),x.$on("change",e[7]),C=new An({props:{name:"ogimet",kmlColor:e[0].ogimetColor,checked:e[0].ogimetDisplay,$$slots:{default:[no]},$$scope:{ctx:e}}}),C.$on("change",e[7]),M=new An({props:{name:"etops",kmlColor:e[0].etopsColor,checked:e[0].etopsDisplay,$$slots:{default:[oo]},$$scope:{ctx:e}}}),M.$on("change",e[7]),q=new Un({props:{selectedPin:e[0].airportPin,selectedLabel:e[0].airportLabel}}),q.$on("change",e[7]),{c(){t=D("fieldset"),n=D("legend"),o=D("input"),i=R("FIR REG"),a=z(),l=D("fieldset"),Ge(c.$$.fragment),u=z(),Z&&Z.c(),d=z(),p=D("fieldset"),Ge(m.$$.fragment),f=z(),h=D("fieldset"),Ge(g.$$.fragment),v=z(),y=D("small"),y.textContent="Un track incomplet sera rouge",$=z(),b=D("fieldset"),Ge(x.$$.fragment),w=z(),k=D("fieldset"),Ge(C.$$.fragment),P=z(),L=D("fieldset"),Ge(M.$$.fragment),S=z(),E=D("fieldset"),O=D("legend"),I=D("input"),j=R("Aéroports"),N=z(),Ge(q.$$.fragment),U(o,"name","fir-display"),o.checked=r=e[0].firDisplay,U(o,"type","checkbox"),U(n,"class","d-flex align-items-center"),U(t,"class","form-group mb-4 svelte-1uvbvs2"),U(l,"class","form-group svelte-1uvbvs2"),U(p,"class","form-group svelte-1uvbvs2"),U(y,"class","form-text text-muted svelte-1uvbvs2"),U(h,"class","form-group svelte-1uvbvs2"),U(b,"class","form-group svelte-1uvbvs2"),U(k,"class","form-group svelte-1uvbvs2"),U(L,"class","form-group svelte-1uvbvs2"),U(I,"name","airport-display"),I.checked=_=e[0].airportDisplay,U(I,"type","checkbox"),U(O,"class","d-flex align-items-center"),U(E,"class","form-group svelte-1uvbvs2")},m(r,s){A(r,t,s),T(t,n),T(n,o),T(n,i),A(r,a,s),A(r,l,s),He(c,l,null),T(l,u),Z&&Z.m(l,null),A(r,d,s),A(r,p,s),He(m,p,null),A(r,f,s),A(r,h,s),He(g,h,null),T(h,v),T(h,y),A(r,$,s),A(r,b,s),He(x,b,null),A(r,w,s),A(r,k,s),He(C,k,null),A(r,P,s),A(r,L,s),He(M,L,null),A(r,S,s),A(r,E,s),T(E,O),T(O,I),T(O,j),T(E,N),He(q,E,null),G=!0,H||(B=[W(o,"change",e[7]),W(I,"change",e[7])],H=!0)},p(e,t){(!G||1&t&&r!==(r=e[0].firDisplay))&&(o.checked=r);const n={};1&t&&(n.kmlColor=e[0].routeColor),1&t&&(n.checked=e[0].routeDisplay),33554448&t&&(n.$$scope={dirty:t,ctx:e}),c.$set(n),e[4]?Z||(Z=Qn(),Z.c(),Z.m(l,null)):Z&&(Z.d(1),Z=null);const s={};1&t&&(s.kmlColor=e[0].alternateColor),1&t&&(s.checked=e[0].alternateDisplay),33554432&t&&(s.$$scope={dirty:t,ctx:e}),m.$set(s);const i={};1&t&&(i.kmlColor=e[0].natColor),1&t&&(i.checked=e[0].natDisplay),33554432&t&&(i.$$scope={dirty:t,ctx:e}),g.$set(i);const a={};1&t&&(a.kmlColor=e[0].greatCircleColor),1&t&&(a.checked=e[0].greatCircleDisplay),33554432&t&&(a.$$scope={dirty:t,ctx:e}),x.$set(a);const u={};1&t&&(u.kmlColor=e[0].ogimetColor),1&t&&(u.checked=e[0].ogimetDisplay),33554432&t&&(u.$$scope={dirty:t,ctx:e}),C.$set(u);const d={};1&t&&(d.kmlColor=e[0].etopsColor),1&t&&(d.checked=e[0].etopsDisplay),33554432&t&&(d.$$scope={dirty:t,ctx:e}),M.$set(d),(!G||1&t&&_!==(_=e[0].airportDisplay))&&(I.checked=_);const p={};1&t&&(p.selectedPin=e[0].airportPin),1&t&&(p.selectedLabel=e[0].airportLabel),q.$set(p)},i(e){G||(Ie(c.$$.fragment,e),Ie(m.$$.fragment,e),Ie(g.$$.fragment,e),Ie(x.$$.fragment,e),Ie(C.$$.fragment,e),Ie(M.$$.fragment,e),Ie(q.$$.fragment,e),G=!0)},o(e){_e(c.$$.fragment,e),_e(m.$$.fragment,e),_e(g.$$.fragment,e),_e(x.$$.fragment,e),_e(C.$$.fragment,e),_e(M.$$.fragment,e),_e(q.$$.fragment,e),G=!1},d(e){e&&F(t),e&&F(a),e&&F(l),Be(c),Z&&Z.d(),e&&F(d),e&&F(p),Be(m),e&&F(f),e&&F(h),Be(g),e&&F($),e&&F(b),Be(x),e&&F(w),e&&F(k),Be(C),e&&F(P),e&&F(L),Be(M),e&&F(S),e&&F(E),Be(q),H=!1,s(B)}}}function Jn(e){let t,n;return{c(){t=j("svg"),n=j("use"),H(n,"xlink:href","#checkmark-symbol"),U(t,"class","svelte-1uvbvs2")},m(e,o){A(e,t,o),T(t,n)},d(e){e&&F(t)}}}function Yn(e){let t,n,o,r,s,i=e[4]&&Jn();return{c(){t=R("Route\n                "),n=D("button"),i&&i.c(),o=R("FOCUS"),U(n,"class","getfocus btn btn-sm btn-outline-info svelte-1uvbvs2"),ee(n,"active",e[4])},m(a,l){A(a,t,l),A(a,n,l),i&&i.m(n,null),T(n,o),r||(s=W(n,"click",q(e[11])),r=!0)},p(e,t){e[4]?i||(i=Jn(),i.c(),i.m(n,o)):i&&(i.d(1),i=null),16&t&&ee(n,"active",e[4])},d(e){e&&F(t),e&&F(n),i&&i.d(),r=!1,s()}}}function Qn(e){let t;return{c(){t=D("small"),t.textContent="Cliquez sur FOCUS pour sortir du mode",U(t,"class","text-center mt-0 svelte-1uvbvs2")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Xn(e){let t;return{c(){t=R("Dégagement")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function eo(e){let t;return{c(){t=R("Tracks")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function to(e){let t;return{c(){t=R("Orthodromie")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function no(e){let t;return{c(){t=R("Route GRAMET")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function oo(e){let t;return{c(){t=R("ETOPS")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function ro(e){let t,n;return t=new Bn({props:{name:"line-width-change",label:"Lignes",value:e[0].lineWidthChange,max:3}}),t.$on("change",e[7]),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.value=e[0].lineWidthChange),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function so(e){let t,n,o,r;return{c(){t=D("button"),n=R("RESET Réglages mode FOCUS"),t.disabled=e[2],U(t,"class","resetfocus btn btn-danger btn-sm svelte-1uvbvs2"),U(t,"type","button")},m(s,i){A(s,t,i),T(t,n),o||(r=W(t,"click",e[12]),o=!0)},p(e,n){4&n&&(t.disabled=e[2])},d(e){e&&F(t),o=!1,r()}}}function io(e){let t,n,o,r,i,a,l,c,u,d,p,m=!e[1]&&ao(e);return{c(){t=D("button"),n=R("Mémoriser"),r=z(),i=D("button"),a=R("Restaurer"),c=z(),m&&m.c(),u=N(),t.disabled=o=!e[3],U(t,"class","btn btn-primary btn-sm svelte-1uvbvs2"),U(t,"type","button"),i.disabled=l=!e[3],U(i,"class","btn btn-secondary btn-sm svelte-1uvbvs2"),U(i,"type","button")},m(o,s){A(o,t,s),T(t,n),A(o,r,s),A(o,i,s),T(i,a),A(o,c,s),m&&m.m(o,s),A(o,u,s),d||(p=[W(t,"click",e[10]),W(i,"click",e[9])],d=!0)},p(e,n){8&n&&o!==(o=!e[3])&&(t.disabled=o),8&n&&l!==(l=!e[3])&&(i.disabled=l),e[1]?m&&(m.d(1),m=null):m?m.p(e,n):(m=ao(e),m.c(),m.m(u.parentNode,u))},d(e){e&&F(t),e&&F(r),e&&F(i),e&&F(c),m&&m.d(e),e&&F(u),d=!1,s(p)}}}function ao(t){let n,o,r;return{c(){n=D("button"),n.textContent="Reset",U(n,"class","btn btn-outline-dark btn-sm ms-auto svelte-1uvbvs2"),U(n,"type","button")},m(e,s){A(e,n,s),o||(r=W(n,"click",t[8]),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}function lo(e){let t,n,o=e[5]&&Kn(e);return{c(){o&&o.c(),t=N()},m(e,r){o&&o.m(e,r),A(e,t,r),n=!0},p(e,[n]){e[5]?o?(o.p(e,n),32&n&&Ie(o,1)):(o=Kn(e),o.c(),Ie(o,1),o.m(t.parentNode,t)):o&&(Ae(),_e(o,1,1,(()=>{o=null})),Fe())},i(e){n||(Ie(o),n=!0)},o(e){_e(o),n=!1},d(e){o&&o.d(e),e&&F(t)}}}function co(e){return e.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}))}function uo(e){return e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}function po(e,t){return JSON.stringify(e)===JSON.stringify(t)}function mo(e,t,n){let o,r,s,i,a,l;p(e,Pt,(e=>n(4,i=e))),p(e,Ct,(e=>n(5,a=e))),p(e,Et,(e=>n(6,l=e)));const c=de(),u=gn.optionsKML;let d,m,{kmlOptions:f}=t;const h=gn.focusKML;let g=yn({...vn.getItem(u)||{}});const v=e=>Object.keys(e).reduce(((t,n)=>(t[n]=("routeDisplay"===n||!n.endsWith("Display"))&&e[n],t)),{});function y(e){let t=!1;for(const[o,r]of Object.entries(e))f[o]!==r&&(n(0,f[o]=r,f),c("change",{name:uo(o),value:r}),t=!0);t&&n(0,f={...e})}function $(){i&&(vn.setItem(h,f),m&&y(m),d=void 0,x(Pt,i=!1,i))}return e.$$set=e=>{"kmlOptions"in e&&n(0,f=e.kmlOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=po(f,hn)),32769&e.$$.dirty&&n(3,r=!po(g,f)),16385&e.$$.dirty&&n(2,s=!!m&&po(v(m),f))},[f,o,s,r,i,a,l,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=co(t);f[r]!==o&&(n(0,f[r]=o,f),c("change",{name:t,value:o}))},function(){y(hn)},function(){y(g)},function(){if(o)vn.removeItem(u);else{const e={};for(const t of Object.keys(f).filter((e=>f[e]!==hn[e])))e[t]=f[t];vn.setItem(u,e)}c("save"),n(15,g={...f})},function(e){e.target.blur(),i?$():(n(14,m={...f}),d=yn({...vn.getItem(h)||v(f)}),x(Pt,i=!0,i),y(d)),x(Ct,a=!1,a)},function(){vn.removeItem(h),m&&(d=v(m),y(d))},$,m,g,function(t){pe.call(this,e,t)},()=>{x(Ct,a=!a,a)},()=>x(Ct,a=!1,a)]}class fo extends Ke{constructor(e){super(),Ze(this,e,mo,lo,a,{kmlOptions:0,endFocusMode:13})}get endFocusMode(){return this.$$.ctx[13]}}function ho(e){let t;return{c(){t=R("Orthodromie")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function go(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,w,k,C,P,L,M,S,E,O,I,_,j,N,q,G,H,B,Z,K,V,J,Y,Q,X;return i=new fn({props:{name:"route",kmlColor:e[0].routeColor,selected:e[0].routePin}}),i.$on("change",e[4]),f=new fn({props:{name:"alternate",kmlColor:e[0].alternateColor,selected:e[0].alternatePin}}),f.$on("change",e[4]),w=new fn({props:{name:"nat",kmlColor:e[0].natColor,selected:e[0].natPin}}),w.$on("change",e[4]),M=new An({props:{name:"great-circle",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay,$$slots:{default:[ho]},$$scope:{ctx:e}}}),M.$on("change",e[4]),{c(){t=D("div"),n=D("fieldset"),o=D("legend"),o.textContent="Route",r=z(),Ge(i.$$.fragment),a=z(),l=D("fieldset"),c=D("legend"),u=D("input"),p=R("Dégagement"),m=z(),Ge(f.$$.fragment),h=z(),g=D("fieldset"),v=D("legend"),y=D("input"),b=R("Tracks"),x=z(),Ge(w.$$.fragment),k=z(),C=D("small"),C.textContent="Positionné à l'entrée des tracks, un track incomplet restera rouge.",P=z(),L=D("fieldset"),Ge(M.$$.fragment),S=z(),E=D("div"),O=D("button"),I=R("Mémoriser"),j=z(),N=D("button"),q=R("Restaurer"),H=z(),B=D("button"),Z=R("Comme Carte"),K=z(),V=D("button"),J=R("Reset"),U(n,"class","form-group svelte-1ib2evr"),U(u,"name","alternate-display"),u.checked=d=e[0].alternateDisplay,U(u,"type","checkbox"),U(l,"class","form-group svelte-1ib2evr"),U(y,"name","nat-display"),y.checked=$=e[0].natDisplay,U(y,"type","checkbox"),U(C,"class","form-text text-muted"),U(g,"class","form-group svelte-1ib2evr"),U(L,"class","form-group svelte-1ib2evr"),O.disabled=_=!e[3],U(O,"class","btn btn-primary btn-sm svelte-1ib2evr"),U(O,"type","button"),N.disabled=G=!e[3],U(N,"class","btn btn-secondary btn-sm ms-3 svelte-1ib2evr"),U(N,"type","button"),B.disabled=e[2],U(B,"class","btn btn-outline-secondary btn-sm ms-auto svelte-1ib2evr"),U(B,"type","button"),V.disabled=e[1],U(V,"class","btn btn-outline-secondary btn-sm ms-auto svelte-1ib2evr"),U(V,"type","button"),U(E,"class","mt-4 mb-2 d-flex svelte-1ib2evr")},m(s,d){A(s,t,d),T(t,n),T(n,o),T(n,r),He(i,n,null),T(t,a),T(t,l),T(l,c),T(c,u),T(c,p),T(l,m),He(f,l,null),T(t,h),T(t,g),T(g,v),T(v,y),T(v,b),T(g,x),He(w,g,null),T(g,k),T(g,C),T(t,P),T(t,L),He(M,L,null),T(t,S),T(t,E),T(E,O),T(O,I),T(E,j),T(E,N),T(N,q),T(E,H),T(E,B),T(B,Z),T(E,K),T(E,V),T(V,J),Y=!0,Q||(X=[W(u,"change",e[4]),W(y,"change",e[4]),W(O,"click",e[8]),W(N,"click",e[5]),W(B,"click",e[7]),W(V,"click",e[6])],Q=!0)},p(e,[t]){const n={};1&t&&(n.kmlColor=e[0].routeColor),1&t&&(n.selected=e[0].routePin),i.$set(n),(!Y||1&t&&d!==(d=e[0].alternateDisplay))&&(u.checked=d);const o={};1&t&&(o.kmlColor=e[0].alternateColor),1&t&&(o.selected=e[0].alternatePin),f.$set(o),(!Y||1&t&&$!==($=e[0].natDisplay))&&(y.checked=$);const r={};1&t&&(r.kmlColor=e[0].natColor),1&t&&(r.selected=e[0].natPin),w.$set(r);const s={};1&t&&(s.kmlColor=e[0].greatCircleColor),1&t&&(s.checked=e[0].greatCircleDisplay),32768&t&&(s.$$scope={dirty:t,ctx:e}),M.$set(s),(!Y||8&t&&_!==(_=!e[3]))&&(O.disabled=_),(!Y||8&t&&G!==(G=!e[3]))&&(N.disabled=G),(!Y||4&t)&&(B.disabled=e[2]),(!Y||2&t)&&(V.disabled=e[1])},i(e){Y||(Ie(i.$$.fragment,e),Ie(f.$$.fragment,e),Ie(w.$$.fragment,e),Ie(M.$$.fragment,e),Y=!0)},o(e){_e(i.$$.fragment,e),_e(f.$$.fragment,e),_e(w.$$.fragment,e),_e(M.$$.fragment,e),Y=!1},d(e){e&&F(t),Be(i),Be(f),Be(w),Be(M),Q=!1,s(X)}}}function vo(e,t){return JSON.stringify(e)===JSON.stringify(t)}function yo(e,t,n){let o,r,s;const i=gn.exportKML;let a=yn({...vn.getItem(i)||{}},Qt),l={...Qt,...a};const c=["routeDisplay","routeColor","alternateDisplay","alternateColor","natDisplay","natColor","greatCircleDisplay","greatCircleColor"];let{mapOptions:u}=t;const d=Object.keys(u).filter((e=>c.includes(e))).reduce(((e,t)=>(e[t]="routeDisplay"===t||u[t],e)),{});function p(e){let t=!1;for(const[o,r]of Object.entries(e))if(l[o]!==r){n(0,l[o]=r,l);tn(uo(o),r),t=!0}t&&n(0,l={...l})}for(const[e,t]of Object.entries(l))if(Qt[e]!==t){tn(uo(e),t)}return e.$$set=e=>{"mapOptions"in e&&n(9,u=e.mapOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=vo(Qt,l)),1025&e.$$.dirty&&n(3,r=!vo(a,l)),1&e.$$.dirty&&n(2,s=vo({...l,...d},l))},[l,o,s,r,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=co(t);l[r]!==o&&(n(0,l[r]=o,l),tn(t,o))},()=>p(a),()=>p(Qt),()=>p({...l,...d}),function(){if(o)vn.removeItem(i);else{const e={};for(const t of Object.keys(l).filter((e=>l[e]!==Qt[e])))e[t]=l[t];vn.setItem(i,e)}n(10,a={...l})},u,a]}class $o extends Ke{constructor(e){super(),Ze(this,e,yo,go,a,{mapOptions:9})}}function bo(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,w,k,C,P,L,M,S,E,O,I,_;return u=new $o({props:{mapOptions:e[0]}}),w=new Tn({props:{label:"Télécharger"}}),w.$on("save",e[3]),E=new kn({}),E.$on("save",e[4]),{c(){t=D("div"),n=D("div"),o=D("div"),r=D("div"),i=D("form"),a=D("fieldset"),l=D("legend"),l.textContent="Réglages pour l'export",c=z(),Ge(u.$$.fragment),d=z(),p=D("div"),m=D("form"),f=D("fieldset"),h=D("legend"),h.textContent="Export",g=z(),v=D("fieldset"),y=D("legend"),y.textContent="KML",$=z(),b=D("p"),b.textContent="Choisissez un format (MapsMe, Avenza Maps ou Google Earth) et téléchargez le fichier KML.",x=z(),Ge(w.$$.fragment),k=z(),C=D("fieldset"),P=D("legend"),P.textContent="Raccourcis",L=z(),M=D("p"),M.innerHTML='Sur iOS on peut lancer un raccourci.\n                            <a href="https://www.icloud.com/shortcuts/886cc07d24d74d83bb0859643242c2df" target="_blank">Exemple de raccourci à installer\n                            </a>. Le raccourci reçoit le KML, la route Lido et le GRAMET.',S=z(),Ge(E.$$.fragment),U(l,"class","svelte-166dwdr"),U(a,"class","form svelte-166dwdr"),U(i,"class","settings svelte-166dwdr"),U(r,"class","col-12 col-md-6 d-flex pt-2 pt-md-0 svelte-166dwdr"),U(h,"class","svelte-166dwdr"),U(v,"class","form-group"),U(C,"class","form-group mt-4"),U(f,"class","form svelte-166dwdr"),U(m,"class","settings svelte-166dwdr"),U(p,"class","col-12 col-md-6 d-flex export svelte-166dwdr"),U(o,"class","row"),U(n,"class","card-body"),U(t,"class","card mb-3 svelte-166dwdr")},m(s,F){A(s,t,F),T(t,n),T(n,o),T(o,r),T(r,i),T(i,a),T(a,l),T(a,c),He(u,a,null),T(o,d),T(o,p),T(p,m),T(m,f),T(f,h),T(f,g),T(f,v),T(v,y),T(v,$),T(v,b),T(v,x),He(w,v,null),T(f,k),T(f,C),T(C,P),T(C,L),T(C,M),T(C,S),He(E,C,null),O=!0,I||(_=[W(i,"submit",q(e[2])),W(m,"submit",q(e[1]))],I=!0)},p(e,[t]){const n={};1&t&&(n.mapOptions=e[0]),u.$set(n)},i(e){O||(Ie(u.$$.fragment,e),Ie(w.$$.fragment,e),Ie(E.$$.fragment,e),O=!0)},o(e){_e(u.$$.fragment,e),_e(w.$$.fragment,e),_e(E.$$.fragment,e),O=!1},d(e){e&&F(t),Be(u),Be(w),Be(E),I=!1,s(_)}}}function xo(e,t,n){let{kmlOptions:o}=t;return e.$$set=e=>{"kmlOptions"in e&&n(0,o=e.kmlOptions)},[o,function(t){pe.call(this,e,t)},function(t){pe.call(this,e,t)},function(t){pe.call(this,e,t)},function(t){pe.call(this,e,t)}]}class wo extends Ke{constructor(e){super(),Ze(this,e,xo,bo,a,{kmlOptions:0})}}function ko(t){let n;return{c(){n=R(" ")},m(e,t){A(e,n,t)},p:e,d(e){e&&F(n)}}}function Co(t){let n,o,r;return{c(){n=D("button"),n.textContent="Partager l'App",U(n,"class","btn btn-link")},m(e,t){A(e,n,t),o||(r=W(n,"click",lt),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}function Po(t){let n,o,r,s,i,a,l;let u=(!0===navigator.standalone&&navigator.share?Co:ko)(t);return{c(){n=D("div"),o=D("div"),r=D("h1"),r.innerHTML='<strong class="d-none">OFP2MAP </strong>Cartographie pour l&#39;OFP',s=z(),i=D("img"),l=z(),u.c(),c(i.src,a="svg/Air_France_Logo.svg")||U(i,"src","svg/Air_France_Logo.svg"),U(i,"alt","logo Air France"),U(i,"class","svelte-nhr328"),U(o,"class","col-12 col-lg-8 svelte-nhr328"),U(n,"class","row svelte-nhr328")},m(e,t){A(e,n,t),T(n,o),T(o,r),T(o,s),T(o,i),T(o,l),u.m(o,null)},p(e,[t]){u.p(e,t)},i:e,o:e,d(e){e&&F(n),u.d()}}}class Lo extends Ke{constructor(e){super(),Ze(this,e,null,Po,a,{})}}function Mo(t){let n,o,r,s;return n=new Lo({}),{c(){Ge(n.$$.fragment),o=z(),r=D("div"),r.innerHTML='<div class="col-12 col-lg-4"><div class="card feature usage svelte-166fvxn"><div class="card-header svelte-166fvxn">Facile à utiliser</div> \n      <div class="card-body"><p class="card-text">Dans <b class="svelte-166fvxn">Pilot Mission</b>, onglet <b class="svelte-166fvxn">Dossier de vol</b>, affichez le PDF nommé <b class="svelte-166fvxn">Dossier de vol OFP</b>. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez <b class="svelte-166fvxn">Enregistrer dans Fichiers</b>. Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut sélectionner.</p></div></div></div> \n  <div class="col-12 col-lg-4"><div class="card feature offline svelte-166fvxn"><div class="card-header svelte-166fvxn">RAPIDE ET OFFLINE</div> \n    <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Conçu pour le PilotPad, peut s&#39;utiliser en vol sans réseau et fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n  <div class="col-12 col-lg-4"><div class="card feature maps svelte-166fvxn"><div class="card-header svelte-166fvxn">Multiples Projections</div> \n    <div class="card-body"><ul class="card-text svelte-166fvxn"><li class="svelte-166fvxn">trois LAMBERT conformes</li> \n        <li class="svelte-166fvxn">un ATLAS POLITIQUE</li> \n        <li class="svelte-166fvxn">un ATLAS PHYSIQUE</li> \n        <li class="svelte-166fvxn">une carte VFR</li> \n        <li class="svelte-166fvxn">une MERCATOR (zoom x 12)</li></ul> \n      <p class="card-text">Export KML compatible Mapsme, Avenza et Google Earth.</p></div></div></div>',U(r,"class","row svelte-166fvxn")},m(e,t){He(n,e,t),A(e,o,t),A(e,r,t),s=!0},p:e,i(e){s||(Ie(n.$$.fragment,e),s=!0)},o(e){_e(n.$$.fragment,e),s=!1},d(e){Be(n,e),e&&F(o),e&&F(r)}}}class So extends Ke{constructor(e){super(),Ze(this,e,null,Mo,a,{})}}function To(e,t={}){return{type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:t}}function Eo(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Oo(e,t={}){return{type:"Feature",geometry:{type:"LineString",coordinates:e},properties:t}}const Ao="#f8f9fa",Fo=e=>e>=10?e/2:0,Io=e=>e/4,_o=(e,t=1,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?1:o},Do=(e,t=10,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?10:o},jo=(e,t=2)=>{const n=e*t;return isNaN(n)?1:n},Ro=e=>["case",["==",1,["get","overrideTextColor"]],_o(e/1,.2*3),.2],zo=(e,t)=>t?["case",["==",1,["get","overrideIconColor"]],t,e]:e,No=(e,t)=>t?["case",["==",1,["get","overrideTextColor"]],t,e]:e,Wo=(e,t,n=.8)=>t?["case",["==",1,["get","overrideTextColor"]],Math.max(t,n),Math.max(e,n)]:Math.max(e,n),qo=(e,t)=>{const[n]=an(e),[o]=t?an(t):[null,null];return No(n,o)},Uo=(e,t,n=.8)=>{const[,o]=an(e),[,r]=t?an(t):[null,null];return Wo(o,r,n)};function Go(e,t,n,o,r,s,i){const a=function(e){switch(e){case"rmain":return"route";case"ralt":return"alternate";case"rnat":return"nat";default:return e}}(t),l=r[`${a}Display`],c=r[`${a}Color`],u=Do(r.iconTextChange),d=_o(r.iconSizeChange);e.addSource(`${t}-marker-source`,Eo(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>To(e,{title:t.name.replace(/00\.0/g,"")}))))),e.addLayer(Ko(t,c,l,u,d,s,i))}function Ho(e,t,n,o,r,s,i,a){o?e.addSource(`${t}-line-source`,Eo(o(n).map((e=>Oo(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:Oo(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(Vo(t,r,s,i,a))}function Bo(e,t,n,o,r,s,i,a){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(Oo(t[e]))}e.addSource(`${t}-line-source`,Eo(s))}else e.addSource(`${t}-line-source`,Eo(n.map((e=>Oo(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(Vo(t,r,s,i,a))}const Zo=(e,t=0,n=10,o=2)=>["interpolate",["linear"],["zoom"],t,e,n,e*o];function Ko(e,t,n,o,r,s,i){const[a,l]=an(t);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":"sdf-triangle","icon-size":Ro(r),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:n?"visible":"none","text-field":["get","title"],"text-size":Zo(o,s,i),"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":zo(a),"icon-halo-width":1,"icon-halo-color":"#000","text-halo-color":Ao,"text-color":No(a),"text-opacity":Wo(l)}}}function Vo(e,t,n,o=2,r=!1){const[s,i]=an(t);return{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":s,"line-opacity":i,"line-width":o,"line-dasharray":r?[10,10]:[1]}}}function Jo(e,t,n=1){const{map:o,value:r}=t,s=`${e}-marker-layer`;return o.getLayer(s)&&o.setLayoutProperty(s,"icon-size",Ro(_o(r,n))),!0}function Yo(e,t,n=10){const{map:o,value:r,mapOptions:s}=t,i=s.interpolateMinZoom||s.mapboxOptions.minZoom||0,a=s.interpolateMaxZoom||s.mapboxOptions.maxZoom||10,l=`${e}-marker-layer`;return o.getLayer(l)&&o.setLayoutProperty(l,"text-size",Zo(Do(r,n),i,a)),!0}function Qo(e,t,n=2){const{map:o,value:r}=t,s=`${e}-line-layer`;return o.getLayer(s)&&o.setPaintProperty(s,"line-width",jo(r,n)),!0}function Xo(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,s=`${e}-marker-layer`,[i,a]=an(o);if(n.getLayer(r)&&(n.setPaintProperty(r,"line-color",i),n.setPaintProperty(r,"line-opacity",a)),n.getLayer(s)){const e=n.getLayoutProperty(s,"icon-image"),t=Array.isArray(e)?e.slice(-1).pop():e;n.setPaintProperty(s,"text-color",No(i)),n.setPaintProperty(s,"text-opacity",Wo(a)),"sdf-triangle"===t&&n.setPaintProperty(s,"icon-color",zo(i))}return!0}function er(e,t,n){const{map:o}=n,r=`${e}-line-layer`,s=`${e}-marker-layer`;return o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(s)&&o.setLayoutProperty(s,"visibility",t?"visible":"none"),!0}const tr={NY:"United States",TY:"Japan",AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua & Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BQ:"British Antarctic Territory",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia & Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",CW:"Curaçao",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States Of",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts & Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre & Miquelon",VC:"Saint Vincent & Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome & Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",SX:"Sint Maarten",ZA:"South Africa",GS:"South Georgia & Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard & Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad & Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks & Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis & Futuna",EH:"Western Sahara",XK:"Kosovo",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},nr="airport-layer",or="airport-emer-layer",rr="airport-etops-layer",sr="airport-source",ir="#062DF8",ar=["==",1,["get","h"]],lr=(e,t,n,o,r)=>r?(e=>0===e)(e)?(e=>["case",["==",9,["get",`${e}`]],"#ea80d8",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#dddddd",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#fbfe98",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#00b0f1",["==",2,["get",`${e}`]],"#00b0f1","#000"])(t):Nn(e)?((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],ir,"#C71"])(n,o):Wn(e)?((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],["case",["==",1,["get","h"]],"#0525cc","#095"],"#C71"])(n,o):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o):"#095",cr=(e,t=!0,n=!1)=>{const o=["<",["coalesce",["get",`${e}`],11],10];return n?t?["all",ar,o]:["to-boolean",!1]:t?o:["!",o]},ur=(e,t,n,o)=>["all",cr(e,t,n),["!",["in",["get","name"],["literal",o]]]],dr=(e,t,n,o)=>["all",cr(e,t,n),["in",["get","name"],["literal",o]]],pr=(e,t,n)=>cr(e,t,n),mr=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["case",ar,1,["get",`${e}`]]],fr=(e,t)=>0===e&&t?3:0,hr=(e,t,n,o)=>{const r="#000";return o?["case",["in",["get","name"],["literal",t]],n,["==",0,["get","level"]],r,"#8d4600"]:r},gr=(e,t)=>{const n=0===t?["get","name"]:["get","iata"];if(Wn(e))return["case",["==",0,["get","level"]],n,["case",["==",1,["get","h"]],["format",n,{}," ✚",{"text-color":"#0525cc","font-scale":1.1}],n]];if(!Nn(e)){return["case",["==",1,["get","h"]],["format",n,{}," ✚",{"text-color":ir,"font-scale":1.1}],n]}return n},vr=(e,t)=>{const n=0===t?["get","name"]:["get","iata"];return Nn(e)?n:["case",["==",1,["get","h"]],["format",n,{}," ✚",{"text-color":ir,"font-scale":1.1}],n]},yr=e=>0===e?["get","name"]:["get","iata"],$r=(e,t=0,n=10,o=2)=>["interpolate",["linear"],["zoom"],t,e,n,e*o],br=(e,t,n)=>$r(Do(e,10),t,n),xr=(e,t,n)=>$r(Do(e,8,1.15),t,n),wr=xr,kr=(e,t,n,o=1.8)=>["interpolate",["linear"],["zoom"],t,e,n,e*o],Cr=(e,t,n)=>kr(_o(e,.6),t,n),Pr=(e,t,n)=>kr(_o(e,1),t,n),Lr=(e,t,n,o)=>kr(_o(e,.5,1.2),t,n);function Mr(e,t){const{map:n}=e;n.getLayer(nr)&&n.setLayoutProperty(nr,"visibility",t?"visible":"none"),n.getLayer(or)&&n.setLayoutProperty(or,"visibility",t?"visible":"none"),n.getLayer(rr)&&n.setLayoutProperty(rr,"visibility",t?"visible":"none")}const Sr=e=>{const t=e?e.infos.ralts:[];let n=[];return e&&e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(n=[e.infos.EEP.name,e.infos.EXP.name]),[t,n.concat(t)]};const Tr=e=>{const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,s=n.airportPin,[i]=an(n.etopsColor),[a]=Sr(o);t.getLayer(nr)&&(t.setPaintProperty(nr,"icon-color",lr(s,r,a,i,!!o)),t.setPaintProperty(nr,"text-color",hr(0,a,i,!!o)))},Er=e=>{const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,s=n.airportPin,[i]=an(n.etopsColor),[a]=Sr(o);t.getLayer(rr)&&(t.setPaintProperty(rr,"icon-color",lr(s,r,a,i,!!o)),t.setPaintProperty(rr,"text-color",hr(0,a,i,!!o)))};function Or(e){const{map:t,kmlOptions:n}=e,o=n.iconTextChange;return o&&t.getLayer(nr)&&t.getLayer(or)&&t.getLayer(rr)&&(t.setPaintProperty(nr,"text-halo-width",Io(Do(o,8,1.15))),t.setPaintProperty(rr,"text-halo-width",(e=>Io(Do(e,10)))(o)),t.setPaintProperty(or,"text-halo-width",(e=>Io(Do(e,8,1.15)))(o)),t.setPaintProperty(nr,"text-halo-blur",(e=>Fo(Do(e,8,1.15)))(o)),t.setPaintProperty(rr,"text-halo-blur",(e=>Fo(Do(e,10)))(o)),t.setPaintProperty(or,"text-halo-blur",(e=>Fo(Do(e,8,1.15)))(o))),!0}var Ar={show:e=>Mr(e,!0),hide:e=>Mr(e,!1),add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r,aircraftType:s,mapOptions:i}=e,{affineOrDrop:a}=n,l=a,c=i.interpolateMinZoom||i.mapboxOptions.minZoom||0,u=i.interpolateMaxZoom||i.mapboxOptions.maxZoom||10;let p=[];o&&o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(p=[o.infos.EEP,o.infos.EXP]);const m=o?o.infos.raltPoints:[],f=r.etopsColor,h=r.airportPin,g=r.airportDisplay,[v]=an(f),y=p.map((e=>e.name)),$=m.map((e=>e.name)),b=y.concat($),x=o?[o.departure.name,o.arrival.name].concat(b):b;fetch("data/airports.2108k.geojson").then((e=>e.json())).then((n=>{if(l){const e=[];for(let t of n.features)t.geometry.coordinates=l(t.geometry.coordinates),void 0!==t.geometry.coordinates&&e.push(t);n.features=e}t.addSource(sr,{type:"geojson",data:n}),t.addLayer({id:or,type:"symbol",source:sr,layout:{"icon-image":o?["case",["==",2,["get","level"]],"sdf-star","sdf-airport"]:"sdf-airport","icon-size":Lr(r.iconSizeChange,c,u),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:g?"visible":"none","text-field":yr(r.airportLabel),"text-size":xr(r.iconTextChange,c,u),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":o?["case",["==",1,["get","level"]],"#D70","#B02"]:"#B02","icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-halo-color":Ao,"text-opacity":.8},filter:pr(s,!1,2===h)}),t.addLayer({id:nr,type:"symbol",source:sr,layout:{"icon-image":"sdf-airport","icon-size":Cr(r.iconSizeChange,c,u),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:g?"visible":"none","text-field":gr(h,r.airportLabel),"text-size":wr(r.iconTextChange,c,u),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":mr(s,x)},paint:{"icon-halo-color":o?["case",["==",0,["get","level"]],"#095","#D70"]:"#444","icon-halo-width":fr(h,!!o),"icon-color":lr(h,s,$,v,!!o),"text-color":hr(0,$,v,!!o),"text-halo-color":Ao,"text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:ur(s,!0,2===h,b)}),t.addLayer({id:rr,type:"symbol",source:sr,layout:{"icon-image":"sdf-triangle","icon-size":Pr(r.iconSizeChange,c,u),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:g?"visible":"none","text-field":vr(h,r.airportLabel),"text-size":br(r.iconTextChange,c,u),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":mr(s,x)},paint:{"icon-halo-color":o?["case",["==",0,["get","level"]],"#095","#D70"]:"#444","icon-halo-width":fr(h,!!o),"icon-color":lr(h,s,$,v,!!o),"text-color":hr(0,$,v,!!o),"text-halo-color":Ao,"text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:dr(s,!0,2===h,b)}),Or(e);const i=new mapboxgl.Popup({closeButton:!0,closeOnClick:!1,closeOnMove:!Xe}),a=function(e){const n=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.title,s=e.features[0].properties.name,a=editolido.icao2iata(s),l=d(_t);for(;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;const c=e.features[0].properties.level;let u="",p="0";switch(e.features[0].properties[l]){case 2:case 3:u="Destination & RCF",p="3";break;case 4:case 5:u="Dégagement à destination",p="2";break;case 6:case 7:u="Dégagement en route",p="2 ERA";break;case 8:case 9:u="Appui ou adéquat en route",p="1"}const m=1===e.features[0].properties.h&&"0"!==p,f=e.features[0].properties.cc;let h=`<div class="airport"><h1><span class="title">${s}/${a}</span><span class="flag">${function(e){const t=[...e.toUpperCase()].map((e=>e.codePointAt()+127397));return String.fromCodePoint(...t)}(f)}</span><span class="cc">${(e=>tr[e]||"")(f)}</span></h1>`;h+=`<h2>${r}${m?" <b>🄷</b>":""}</h2>`,o&&(h+=`<p class="status status-${p.charAt(0)}">STATUT ${p}</p>`,c>0&&(h+=`<p class="security-${c}">${1==c?"ORANGE":"RED"}</p>`),u&&(h+=`<p class="status-text">${u}</p>`)),h+="</div>",i.setLngLat(n).setHTML(h).addTo(t)},p=()=>t.getCanvas().style.cursor="pointer",m=()=>t.getCanvas().style.cursor="",f=function(){m(),i.remove()};Xe?(t.on("mouseenter",nr,(e=>{p(),a(e)})),t.on("mouseenter",or,(e=>{p(),a(e)})),t.on("mouseenter",rr,(e=>{p(),a(e)})),t.on("mouseleave",nr,f),t.on("mouseleave",or,f),t.on("mouseleave",rr,f)):(t.on("mouseenter",nr,p),t.on("mouseenter",or,p),t.on("mouseenter",rr,p),t.on("click",nr,a),t.on("click",or,a),t.on("click",rr,a),t.on("mouseleave",nr,m),t.on("mouseleave",or,m),t.on("mouseleave",rr,m))}))},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,s=n.airportPin,[,i]=Sr(o);t.getLayer(nr)&&(Tr(e),t.setPaintProperty(nr,"icon-halo-width",fr(s,!!o)),t.setLayoutProperty(nr,"text-field",gr(s,n.airportLabel)),t.setFilter(nr,ur(r,!0,2===s,i))),t.getLayer(rr)&&(Er(e),t.setPaintProperty(rr,"icon-halo-width",fr(s,!!o)),t.setLayoutProperty(rr,"text-field",vr(s,n.airportLabel)),t.setFilter(rr,dr(r,!0,2===s,i))),t.getLayer(or)&&t.setFilter(or,pr(r,!1,2===s))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,[,s]=Sr(r),i=n.airportPin,a=r?[r.departure.name,r.arrival.name].concat(s):s;t.setFilter(nr,ur(o,!0,2===i,s)),t.setFilter(rr,dr(o,!0,2===i,s)),Tr(e),Er(e),t.setLayoutProperty(nr,"symbol-sort-key",mr(o,a)),t.setLayoutProperty(rr,"symbol-sort-key",mr(o,a)),t.setFilter(or,pr(o,!1,2===i))},changeIconText:e=>{const{map:t,kmlOptions:n,mapOptions:o}=e,r=o.interpolateMinZoom||o.mapboxOptions.minZoom||0,s=o.interpolateMaxZoom||o.mapboxOptions.maxZoom||10;t.getLayer(nr)&&t.setLayoutProperty(nr,"text-size",wr(n.iconTextChange,r,s)),t.getLayer(rr)&&t.setLayoutProperty(rr,"text-size",br(n.iconTextChange,r,s)),t.getLayer(or)&&t.setLayoutProperty(or,"text-size",xr(n.iconTextChange,r,s)),Or(e)},changeIconSize:e=>{const{map:t,kmlOptions:n,mapOptions:o}=e,r=o.interpolateMinZoom||o.mapboxOptions.minZoom||0,s=o.interpolateMaxZoom||o.mapboxOptions.maxZoom||10;t.getLayer(nr)&&t.setLayoutProperty(nr,"icon-size",Cr(n.iconSizeChange,r,s)),t.getLayer(rr)&&t.setLayoutProperty(rr,"icon-size",Pr(n.iconSizeChange,r,s)),t.getLayer(or)&&t.setLayoutProperty(or,"icon-size",Lr(n.iconSizeChange,r,s))},changeLabel:e=>{const{map:t,kmlOptions:n,value:o}=e;t.getLayer(nr)&&t.setLayoutProperty(nr,"text-field",gr(n.airportPin,o)),t.getLayer(rr)&&t.setLayoutProperty(rr,"text-field",vr(n.airportPin,o)),t.getLayer(or)&&t.setLayoutProperty(or,"text-field",yr(o))}};const Fr="etops-ep-circle-line-layer",Ir="etops-etops-circle-line-layer";function _r(e,t){const{map:n}=e;n.getLayer(Ir)&&n.setLayoutProperty(Ir,"visibility",t?"visible":"none"),n.getLayer(Fr)&&n.setLayoutProperty(Fr,"visibility",t?"visible":"none")}var Dr={show:e=>_r(e,!0),hide:e=>_r(e,!1),add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(!o)return;const s=jo(r.lineWidthChange,1);if(o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n,i=o.infos.maxETOPS,a=r.etopsDisplay;Bo(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,a,s,!0),Bo(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*i))),e,r.etopsColor,a,s,!0)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=an(e.value);t.getLayer(Ir)&&(t.setPaintProperty(Ir,"line-color",n),t.setPaintProperty(Ir,"line-opacity",o)),Tr(e)}(e),changeLineWidth:function(e){const{map:t,value:n}=e,o=jo(n,1);return t.getLayer(Ir)&&t.setPaintProperty(Ir,"line-width",o),t.getLayer(Fr)&&t.setPaintProperty(Fr,"line-width",o),!0}};const jr="fir-reg-line-layer",Rr="fir-reg-orange-stripe-layer",zr="fir-reg-red-stripe-layer",Nr="fir-reg-source";function Wr(e,t){const{map:n}=e;n.getLayer(zr)&&n.setLayoutProperty(zr,"visibility",t?"visible":"none"),n.getLayer(Rr)&&n.setLayoutProperty(Rr,"visibility",t?"visible":"none"),n.getLayer(jr)&&n.setLayoutProperty(jr,"visibility",t?"visible":"none")}var qr={show:e=>Wr(e,!0),hide:e=>Wr(e,!1),add:e=>{const{ofp:t,map:n,mapData:o,kmlOptions:r,mapOptions:s}=e;if(!t)return;const{affine:i}=o,a="jb_pacific"!==s.id&&!s.id.startsWith("vb_")&&r.firDisplay;fetch("data/fir-reg.2108k.geojson").then((e=>e.json())).then((e=>{if(i)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>i(e)))]}n.addSource(Nr,{type:"geojson",data:e}),n.addLayer({id:Rr,type:"fill",source:Nr,layout:{visibility:a?"visible":"none"},paint:{"fill-pattern":"stripe-orange","fill-opacity":.4},filter:["!",["==","FIR-RED",["get","type"]]]}),n.addLayer({id:zr,type:"fill",source:Nr,layout:{visibility:a?"visible":"none"},paint:{"fill-pattern":"stripe-red","fill-opacity":.35},filter:["==","FIR-RED",["get","type"]]}),n.addLayer({id:jr,type:"line",source:Nr,layout:{visibility:a?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.35,.4]}})}))}};const Ur="great-circle";var Gr={show:er.bind(null,Ur,!0),hide:er.bind(null,Ur,!1),add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r,mapOptions:s}=e;if(!t)return;const i=!s.id.startsWith("vb_")&&n.greatCircleDisplay,{affineAndClip:a}=o,l=`${t.infos.depICAO}-${t.infos.destICAO}`,c=t.route,u=new editolido.Route([c.points[0],c.points[c.points.length-1]]).split(300,{name:`Ortho ${l}`}),d=jo(n.lineWidthChange,1.5);Ho(r,Ur,u.points,a,n.greatCircleColor,i,d)},changeLine:Xo.bind(null,Ur),changeLineWidth:e=>Qo(Ur,e,1.5)};const Hr="ogimet";var Br={show:er.bind(null,Hr,!0),hide:er.bind(null,Hr,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r,mapOptions:s}=e;if(!n)return;const i=!s.id.startsWith("vb_")&&o.ogimetDisplay,{affineAndClip:a}=r,l=jo(o.lineWidthChange,1.5);Ho(t,Hr,n.ogimetData.route.points,a,o.ogimetColor,i,l)},changeLine:Xo.bind(null,Hr),changeLineWidth:e=>Qo(Hr,e,1.5)};const Zr="ralt";var Kr={show:er.bind(null,Zr,!0),hide:er.bind(null,Zr,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r,mapOptions:s}=e;if(!n)return;const{affineAndClip:i,affineOrDrop:a}=r,l=s.interpolateMinZoom||s.mapboxOptions.minZoom||0,c=s.interpolateMaxZoom||s.mapboxOptions.maxZoom||10,u=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route Dégagement"}),d=jo(o.lineWidthChange);Ho(t,Zr,u.points,i,o.alternateColor,o.alternateDisplay,d),Go(t,Zr,u.points,a,o,l,c)},changeLine:Xo.bind(null,Zr),changeIconText:Yo.bind(null,Zr),changeLineWidth:Qo.bind(null,Zr),changeIconSize:Jo.bind(null,Zr)};const Vr="rnat",Jr=(e,t,n,o,r,s)=>({id:`${e}-marker-layer`,type:"symbol",source:`${e.replace("-labels","")}-line-source`,layout:{visibility:n?"visible":"none","text-field":["get","title"],"text-size":Zo(o,r,s),"text-offset":[0,-.1],"text-anchor":"bottom","text-ignore-placement":!0,"text-allow-overlap":!0,"symbol-placement":"line-center"},paint:{"text-halo-color":"#000","text-color":qo(t),"text-opacity":Uo(t,null,.9)}});function Yr(e){const{map:t,kmlOptions:n}=e,o="rnat-marker-layer";return t.getLayer(o)&&(t.setPaintProperty(o,"text-color",qo(n.natColor,n.routeColor)),t.setPaintProperty(o,"text-opacity",Uo(n.natColor,n.routeColor,.9))),!0}var Qr={show:e=>[Vr,"rnat-incomplete","rnat-labels","rnat-incomplete-labels"].forEach((t=>er(t,!0,e))),hide:e=>[Vr,"rnat-incomplete","rnat-labels","rnat-incomplete-labels"].forEach((t=>er(t,!1,e))),add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r,mapOptions:s}=e;if(!n)return;const{affineOrDrop:i,affineAndClip:a}=o,l=i,c=a,u=r.natColor,d=r.natDisplay,p=s.interpolateMinZoom||s.mapboxOptions.minZoom||0,m=s.interpolateMaxZoom||s.mapboxOptions.maxZoom||10,f={rnat:[],"rnat-incomplete":[]},h={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete",n=e.name.slice(-1),o=e.infos.direction,r="WEST"===o?`< ${n}`:"EAST"===o?`${n} >`:n;if(c){const n=c(e.points),o=n.length;for(let e=0;e<o;e++)f[t].push(Oo(n[e],{title:r}))}else f[t].push(Oo(e.points.map((e=>[e.longitude,e.latitude])),{title:e.name.slice(-1)}));const s=e.points[0];let i=l?l([s.longitude,s.latitude]):[s.longitude,s.latitude];i&&h[t].push(To(i,{title:`${e.isMine?e.name+"\n":""}${s.name}`,description:e.description,track:e.name,point:s.name,isMine:e.isMine,direction:o,overrideTextColor:e.isMine?1:0}));const a=e.points[e.points.length-1];i=l?l([a.longitude,a.latitude]):[a.longitude,a.latitude],i&&h[t].push(To(i,{title:`${e.isMine?e.name+"\n":""}${a.name}`,description:e.description,track:e.name,point:a.name,isMine:e.isMine,direction:o,noPin:1,overrideTextColor:e.isMine?1:0}))}t.addSource("rnat-marker-source",Eo(h.rnat)),t.addSource("rnat-incomplete-marker-source",Eo(h["rnat-incomplete"])),t.addSource("rnat-line-source",Eo(f.rnat)),t.addSource("rnat-incomplete-line-source",Eo(f["rnat-incomplete"]));const g=Do(r.iconTextChange),v=jo(r.lineWidthChange,1),y=_o(r.iconSizeChange);t.addLayer(Vo("rnat",u,d,v)),t.addLayer(Vo("rnat-incomplete",r.natIncompleteColor,d,v)),t.addLayer(Ko("rnat",u,d,g,y,p,m)),Yr(e),t.setLayoutProperty("rnat-marker-layer","symbol-sort-key",["case",["==",1,["get","overrideTextColor"]],0,1]),t.addLayer(Ko("rnat-incomplete",u,d,g,y,p,m)),t.addLayer(Jr("rnat-labels",u,d,g,p,m)),t.addLayer(Jr("rnat-incomplete-labels",r.natIncompleteColor,d,g,p,m));const $=e=>{const o=e.features[0].geometry.coordinates.slice();for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;const r=e.features[0].properties,s=(new mapboxgl.Popup).setLngLat(o).addTo(t),i=At.subscribe((e=>{let t=r.description.replace(r.point,`<b>${r.point}</b>`),o=[void 0,void 0,void 0];r.isMine&&(o=n.timeMatrix.filter((([e])=>editolido.isARINC(r.point)?editolido.arinc_normalizer(r.point).asDM===e.name:r.point===e.name)).pop()||o);const[,i,a]=o;let l=a?` - FL${a}`:"";const c="WEST"===r.direction?"WB":"EAST"===r.direction?"EB":"";if(a&&c){const e=new RegExp(String.raw`(LVLS ${c})([\d\s]*)( ${a} )`,"u"),n=t.replace(e,"<strong>$1</strong>$2<strong><b>$3</b></strong>");t=t!=n?n:t.replace(`LVLS ${c}`,`<strong class="error">LVLS ${c}</strong>`)}const u=i&&e?" - ETO: "+new Date(e.getTime()+6e4*i).toISOString().substring(11,16)+"z":"";let d=`<div class="track"><h1>${r.track}${u}${l}</h1><p>${t}</p>`;s.setHTML(d)}));s.on("close",(()=>{i()}))},b=e=>{const n=e+"-marker-layer";t.on("click",n,$),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};b("rnat"),b("rnat-incomplete"),o.initialLoad&&(()=>{const e=n.tracks.filter((e=>e.isMine)).pop();if(e&&e.points.length>0){const t=e.points[0],n=o.affineOrDrop,r=n?n([t.longitude,t.latitude]):[t.longitude,t.latitude];if(r){const[n,o]=r,s={lngLat:{lng:n,lat:o},features:[{properties:{track:e.name,point:t.name,isMine:!0,description:e.description,direction:e.infos.direction},geometry:{coordinates:[n,o]}}]};$(s)}}})()},changeLine:function(e){return Xo(Vr,e)&&Xo("rnat-labels",e),Yr(e),!0},changeIconText:e=>[Vr,"rnat-incomplete","rnat-labels","rnat-incomplete-labels"].forEach((t=>Yo(t,e))),changeLineWidth:e=>[Vr,"rnat-incomplete"].forEach((t=>Qo(t,e,1))),changeIconSize:e=>[Vr,"rnat-incomplete"].forEach((t=>Jo(t,e)))};const Xr="rmain";function es(e){const{map:t,kmlOptions:n}=e,o=n.iconTextChange,r="rmain-marker-layer";if(t.getLayer(r)){const e=Do(o),s=t.getPaintProperty(r,"text-opacity"),i=((e,t)=>{const[n,o,r]=(e=>[e.slice(6,8),e.slice(4,6),e.slice(2,4),e.slice(0,2)])(e).map((e=>parseInt(e,16)));return.299*n+.587*o+.114*r+255*(1-t)>186?"#212529":Ao})(n.routeColor,s);t.setPaintProperty(r,"text-halo-color",i),t.setPaintProperty(r,"text-halo-width",Io(e)),t.setPaintProperty(r,"text-halo-blur",Fo(e))}return!0}const ts=[["fir",qr],["airport",Ar],["etops",Dr],["greatcircle",Gr],["ogimet",Br],["ralt",Kr],["rmain",{show:er.bind(null,Xr,!0),hide:er.bind(null,Xr,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r,mapOptions:s}=e;if(!n)return;const{affineAndClip:i,affineOrDrop:a}=r,l=s.interpolateMinZoom||s.mapboxOptions.minZoom||0,c=s.interpolateMaxZoom||s.mapboxOptions.maxZoom||10,u=n.route;u.name=`${n.infos.depICAO}-${n.infos.destICAO}`,u.description=n.description;const d=jo(o.lineWidthChange);Ho(t,Xr,u.points,i,o.routeColor,!0,d),Go(t,Xr,u.points,a,o,l,c),es(e)},changeLine:e=>(Xo(Xr,e),function(e){const{map:t,kmlOptions:n}=e,[o,r]=an(n.routeColor);t.getLayer(Fr)&&(t.setPaintProperty(Fr,"line-color",o),t.setPaintProperty(Fr,"line-opacity",r))}(e),Yr(e),es(e),!0),changeIconText:e=>Yo(Xr,e)&&es(e),changeLineWidth:Qo.bind(null,Xr),changeIconSize:Jo.bind(null,Xr)}],["rnat",Qr]],ns=2*Math.PI,os=Math.PI/4,rs=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*ns};var ss={init:function(){},forward:function(e){var t=e.x,n=e.y,o=rs(t-this.long0),r=Math.tan(n/2),s=Math.sin(os*r),i=s*s,a=this.x0+this.a*o*(.74482-.34588*i),l=this.y0+1.70711*this.a*r;return e.x=a,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(os*t),o=n*n,r=rs(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};const is=Math.abs,as=Math.asin,ls=Math.cos,cs=Math.sin,us=Math.sqrt,ds=1.340264,ps=-.081106,ms=893e-6,fs=.003796,hs=us(3)/2;var gs={init:function(){},forward:function(e){const t=e.x,n=e.y,o=as(hs*cs(n)),r=o*o,s=r*r*r;return e.x=this.a*t*ls(o)/(hs*(ds+3*ps*r+s*(7*ms+9*fs*r))),e.y=this.a*o*(ds+ps*r+s*(ms+fs*r)),e},inverse:function(e){const t=e.y/this.a,n=e.x/this.a;let o=t,r=o*o,s=r*r*r;for(var i,a=0;a<12&&(o-=i=(o*(ds+ps*r+s*(ms+fs*r))-t)/(ds+3*ps*r+s*(7*ms+9*fs*r)),r=o*o,s=r*r*r,!(is(i)<1e-12));++a);return e.x=hs*n*(ds+3*ps*r+s*(7*ms+9*fs*r))/ls(o),e.y=as(cs(o)/hs),e},names:["Equal Earth","eqearth"]};function vs(e,t,n,o,r,s,i=!1){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(ss),window.proj4.Proj.projections.get("eqearth")||window.proj4.Proj.projections.add(gs);let a={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:(()=>{const e="Airports/FIR © Olivier Ravet";return t.id.startsWith("ed_eqe")?`© equal-earth.com - ${e}`:t.id.startsWith("jb_")||t.id.startsWith("ed_")?`Yammer/QGIS & Avenza maps - ${e}`:t.id.startsWith("vb_")?`© ${window.atob("Q2FydGFCb3NzeQ==")}.com - Airports © Olivier Ravet`:`Yammer/Maps.me - ${e}`})()};const l=new mapboxgl.Map({...t.mapboxOptions,...a});let c,u,d,p;l._setCacheLimits(320,32),l.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||l.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||l.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||l.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-star-sdf.png",(function(e,t){e||l.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),l.loadImage("images/stripe-orange.png",(function(e,t){e||l.addImage("stripe-orange",t,{pixelRatio:2,sdf:!0})})),l.loadImage("images/stripe-red.png",(function(e,t){e||l.addImage("stripe-red",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+proj=longlat +datum=WGS84"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let m,f=e=>window.proj4("WGS84","EPSG:3857",e),h=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else{const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],[i,a,l,c]=t.extent;let[u,d,p,m]=s;if(t.ratio){const e=s[3]-s[1],[n,o]=t.ratio,r=o/n*e;[u,d,p,m]=[s[0],s[3]-r,s[2],s[3]]}e=(p-u)/(l-i),n=u-e*i,o=(m-d)/(c-a),r=d-o*a}const[s,i,a,l]=t.viewport?t.viewport:t.extent,m=e=>window.proj4("WGS84","CUSTOM",e),g=t=>[e*t[0]+n,o*t[1]+r],v=e=>h(g(e));f=e=>g(m(e)),c=e=>h(f(e)),u=e=>{let[t,n]=m(e);return t=nt(t,s,a),n=nt(n,i,l),v([t,n])},d=e=>{let[t,n]=m(e);if(ot(t,s,a)&&ot(n,i,l))return v([t,n])},p=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,i,a,l=e.length,c=st(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],i=a=st(s=e[o],t);;){if(!(c|i)){u.push(r),i!==a?(u.push(s),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(s);break}if(c&i)break;c?c=st(r=rt(r,s,c,t),t):i=st(s=rt(r,s,i,t),t)}c=a}return u.length&&n.push(u),n}(e.map((e=>m([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let g=[];if(n){for(const e of n.tracks)g=g.concat(e.points);g=g.concat(n.route.points,n.wptCoordinatesAlternate()),m=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(g,u),l.fitBounds(m,{padding:{top:30,bottom:80,left:30,right:30}})}const v=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(c){const e=v._onSuccess;v._onSuccess=function(t){const[n,o]=c([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const y={map:l,affine:c,affineAndClamp:u,affineAndClip:p,affineOrDrop:d,bbox:m,mapOptions:t,geolocate:v,initialLoad:i};l.addControl(new class{onAdd(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl  mapboxgl-ctrl-group",this._button=document.createElement("button"),this._button.className="mapboxgl-ctrl-layers",this._button.setAttribute("type","button"),this._button.setAttribute("title","Personnaliser la carte"),this._focusModeUnsubscribe=Pt.subscribe((e=>this._button.innerHTML=(e=>e?'<svg><use xlink:href="#single-layer-symbol"/></svg>':'<svg><use xlink:href="#layers-symbol"/></svg>')(e))),this._container.appendChild(this._button),this._toggleSidebar=()=>Ct.update((e=>!e)),this._button.addEventListener("click",this._toggleSidebar),this._container}onRemove(){this._button.removeEventListener("click",this._toggleSidebar),this._focusModeUnsubscribe(),this._container.parentNode.removeChild(this._container),this._map=void 0}}),l.addControl(v);const $=()=>Mt.set(!1),b=function(e,t,n,o,r){let s,i,a,l=null,c=0;const u=function(){c=new Date,l=null,a=e.apply(s,i)};return function(){var d=new Date;c||n||(c=d);var p=t-(d-c);return s=r||this,i=arguments,p<=0?(clearTimeout(l),l=null,c=d,a=e.apply(s,i)):!l&&o&&(l=setTimeout(u,p)),a}}((e=>St.set(Math.floor(10*(e.target.getZoom()+Number.EPSILON))/10)),100);return l.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),ts.forEach((([,t])=>t.add&&t.add(e)))})({ofp:n,kmlOptions:o,mapData:y,map:l,mapOptions:t,aircraftType:r}),v.on("trackuserlocationstart",$),s&&s(l,t),l.on("zoom",b),St.set(l.getZoom())})),l.on("remove",(function(){v.off("trackuserlocationstart",$),l.off("zoom",b)})),y}class ys{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const s=indexedDB.open(e,t);s.onsuccess=()=>{o(s)},s.onerror=()=>{r("Error while opening DB")},s.onupgradeneeded=n?n.bind(null,s):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const s=n.result.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{o(s.result)},s.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,s)=>{const i=o.result.transaction(t,"readwrite").objectStore(t),a=i.put(n,e);a.onsuccess=()=>{const t=i.get(e);t.onsuccess=()=>{r(t.result)}},a.onerror=()=>{s("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,s)=>{const i=o.result.transaction(e,"readonly").objectStore(e).getKey(n);i.onsuccess=()=>{r(void 0===i.result?t:null)},i.onerror=()=>{s("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function $s(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function bs(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const xs=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(!n)return[];const s=new ys("lido-tiles");if(o.cacheAll){const e=await s.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return s.close(),caches[o.id]=!0,[]}const[i,a]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,d;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:$s(i[0],e),y:bs(i[1],e)},r={x:$s(a[0],e),y:bs(a[1],e)}),o.matrix?[u,d]=o.matrix[e]:[u,d]=[c,c];for(let i=t.x;i<=r.x;i++)for(let a=r.y;a<=t.y;a++)if(i>=0&&a>=0&&i<u&&a<d){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",i).replace("{y}",a)),l.push(s.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.6nts91f3/${e}/${i}/${a}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.1x3i1g8r,denizotjb.bifqeinj,denizotjb.cz0kdfpx,denizotjb.aop85z8z,mapbox.mapbox-terrain-v2/${e}/${i}/${a}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return s.close(),c.filter((e=>null!==e))};function ws(e){let t,n,o,r,s,i,a,l,c,u,d;const p=e[4].default,f=m(p,e,e[3],null);return{c(){t=j("svg"),n=j("circle"),o=j("path"),r=j("path"),i=j("line"),a=j("polyline"),l=j("line"),c=j("polyline"),u=z(),f&&f.c(),U(n,"cx","54"),U(n,"cy","54"),U(n,"r","50"),U(n,"class","svelte-8sl68l"),U(o,"d","M50,5A45 45 0 1 1 49.9999 5"),U(o,"transform","translate(4,4)"),U(o,"class","svelte-8sl68l"),U(r,"d",s=e[0]()),U(r,"transform","translate(4,4)"),U(r,"class","svelte-8sl68l"),U(i,"x1","54"),U(i,"y1","36"),U(i,"x2","54"),U(i,"y2","72"),U(i,"class","svelte-8sl68l"),U(a,"points","36 54, 54 72, 72 54"),U(a,"class","svelte-8sl68l"),U(l,"x1","54"),U(l,"y1","36"),U(l,"x2","54"),U(l,"y2","72"),U(l,"class","svelte-8sl68l"),U(c,"points","36 54, 54 72, 72 54"),U(c,"class","svelte-8sl68l"),U(t,"viewBox","0 0 108 108"),U(t,"class","svelte-8sl68l")},m(e,s){A(e,t,s),T(t,n),T(t,o),T(t,r),T(t,i),T(t,a),T(t,l),T(t,c),A(e,u,s),f&&f.m(e,s),d=!0},p(e,[t]){(!d||1&t&&s!==(s=e[0]()))&&U(r,"d",s),f&&f.p&&(!d||8&t)&&g(f,p,e,e[3],d?h(p,e[3],t,null):v(e[3]),null)},i(e){d||(Ie(f,e),d=!0)},o(e){_e(f,e),d=!1},d(e){e&&F(t),e&&F(u),f&&f.d(e)}}}function ks(e,t,n){let o,{$$slots:r={},$$scope:s}=t,{value:i=0}=t,{max:a=100}=t;return e.$$set=e=>{"value"in e&&n(1,i=e.value),"max"in e&&n(2,a=e.max),"$$scope"in e&&n(3,s=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(i<=0)return"";if(i>=a)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(i/a),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,i,a,s,r]}class Cs extends Ke{constructor(e){super(),Ze(this,e,ks,ws,a,{value:1,max:2})}}function Ps(e,t,n){const o=e.slice();return o[8]=t[n],o}function Ls(t){let n,o,r;return{c(){n=D("option"),o=R("???"),n.__value=void 0,n.value=n.__value,n.selected=r=!0},m(e,t){A(e,n,t),T(n,o)},p:e,d(e){e&&F(n)}}}function Ms(e){let t,n,o,r,s=e[8]+"";return{c(){t=D("option"),n=R(s),t.__value=o=e[8],t.value=t.__value,t.selected=r=e[8]===e[3]},m(e,o){A(e,t,o),T(t,n)},p(e,n){8&n&&r!==(r=e[8]===e[3])&&(t.selected=r)},d(e){e&&F(t)}}}function Ss(e){let t,n=e[8]===e[3]||e[1]&&e[8]===e[1]||!$t.includes(e[8]),o=n&&Ms(e);return{c(){o&&o.c(),t=N()},m(e,n){o&&o.m(e,n),A(e,t,n)},p(e,r){10&r&&(n=e[8]===e[3]||e[1]&&e[8]===e[1]||!$t.includes(e[8])),n?o?o.p(e,r):(o=Ms(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null)},d(e){o&&o.d(e),e&&F(t)}}}function Ts(t){let n,o,r,i,a=!t[3]&&Ls(),l=yt,c=[];for(let e=0;e<l.length;e+=1)c[e]=Ss(Ps(t,l,e));return{c(){n=D("select"),a&&a.c(),o=N();for(let e=0;e<c.length;e+=1)c[e].c();U(n,"name","aircraftType"),U(n,"class","svelte-1xpiicm"),void 0===t[2]&&xe((()=>t[7].call(n)))},m(e,s){A(e,n,s),a&&a.m(n,null),T(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[6](n),J(n,t[2]),r||(i=[W(n,"change",t[7]),W(n,"change",t[5]),w(Cn.call(null,n))],r=!0)},p(e,[t]){if(e[3]?a&&(a.d(1),a=null):a?a.p(e,t):(a=Ls(),a.c(),a.m(n,o)),10&t){let o;for(l=yt,o=0;o<l.length;o+=1){const r=Ps(e,l,o);c[o]?c[o].p(r,t):(c[o]=Ss(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}4&t&&J(n,e[2])},i:e,o:e,d(e){e&&F(n),a&&a.d(),I(c,e),t[6](null),r=!1,s(i)}}}function Es(e,t,n){let o,r,s,i;p(e,Et,(e=>n(4,r=e))),p(e,It,(e=>n(2,s=e))),p(e,_t,(e=>n(3,i=e)));let{aircraftTypeSelectElement:a=null}=t;return e.$$set=e=>{"aircraftTypeSelectElement"in e&&n(0,a=e.aircraftTypeSelectElement)},e.$$.update=()=>{16&e.$$.dirty&&n(1,o=r?r.infos.aircraftType:void 0)},[a,o,s,i,r,function(t){pe.call(this,e,t)},function(e){fe[e?"unshift":"push"]((()=>{a=e,n(0,a)}))},function(){s=Y(this),It.set(s)}]}class Os extends Ke{constructor(e){super(),Ze(this,e,Es,Ts,a,{aircraftTypeSelectElement:0})}}function As(e,t,n){let o,r;p(e,Ut,(e=>n(1,o=e)));let{mapData:s}=t;const i=window.document.createElement("div");i.classList.add("mapboxgl-user-location-dot","map-plane");const a=e=>{if(r){const t=s.affine,[n,o]=t?t([e.longitude,e.latitude]):[e.longitude,e.latitude];r.setLngLat([n,o])}};return ce((()=>{r=new mapboxgl.Marker(i),a(o.map),r.addTo(s.map)})),ue((()=>{r&&(r.remove(),r=void 0)})),e.$$set=e=>{"mapData"in e&&n(0,s=e.mapData)},e.$$.update=()=>{2&e.$$.dirty&&a(o.map)},[s,o]}class Fs extends Ke{constructor(e){super(),Ze(this,e,As,null,a,{mapData:0})}}const Is={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},_s=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,Ds=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cknj4nmwu0t8117ny6rk7dwbg",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv2",interpolateMinZoom:2,interpolateMaxZoom:7,cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:_s,interpolateMinZoom:2,subLabel:"recommandée au nord du 30N"},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:_s,interpolateMinZoom:2,subLabel:"recommandée au sud du 30N"},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:_s,interpolateMinZoom:3,subLabel:"recommandée au sud du 30N"},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20],[64,40]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,interpolateMinZoom:3,tileSize:_s},{label:"=Physique=",id:"ed_eqe_physical_fr",affineTransform:[1.104,-855.8520345054567,1.1,931e4],extent:[-18145536.6946,-10300589.33644032,18143985.81684419,9720047.1747],proj4:"+proj=eqearth +datum=WGS84 +wktext",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-eqephysicalfrv1.netlify.app/eqephysicalfrv1/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,9],[32,18],[64,36]],cacheZoom:5,cacheName:"eqephysicalfrv1",cacheAll:!0,interpolateMinZoom:3,tileSize:_s},{label:atob("Q2FydGFCb3NzeQ==")+" 2020",id:"vb_2020",ratio:[19449,18352],extent:[26966.11818123,-430589.86447607,1262485.62823696,735241.49181695],proj4:"+proj=lcc +lat_1=45.89893890000052 +lat_2=47.69601440000037 +lat_0=46.8 +lon_0=2.33722917 +x_0=600000 +y_0=200000 +datum=WGS84 +units=m +no_defs ",mapboxOptions:{style:Is,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-cb2020v1.netlify.app/cb2020v1/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,4],[8,8],[16,16],[32,31],[64,61]],cacheName:"cb2020v1",cacheZoom:5,cacheAll:!0,interpolateMinZoom:.5,tileSize:_s}];function js(e,t,n){const o=e.slice();return o[8]=t[n],o}function Rs(e,t){let n,o,r,s,i,a=(t[8].id===t[2]?`${t[8].label.toUpperCase()}`:t[8].label)+"";return{key:e,first:null,c(){n=D("option"),o=R(a),r=z(),n.__value=s=t[8],n.value=n.__value,n.selected=i=t[8].id===t[0].id,this.first=n},m(e,t){A(e,n,t),T(n,o),T(n,r)},p(e,r){t=e,4&r&&a!==(a=(t[8].id===t[2]?`${t[8].label.toUpperCase()}`:t[8].label)+"")&&Z(o,a),17&r&&i!==(i=t[8].id===t[0].id)&&(n.selected=i)},d(e){e&&F(n)}}}function zs(e){let t,n,o,r=e[3].toFixed(1)+"";return{c(){t=D("label"),n=R("🔎 "),o=R(r),U(t,"for",e[1]),U(t,"class","mapzoom svelte-q04tua")},m(e,r){A(e,t,r),T(t,n),T(t,o)},p(e,n){8&n&&r!==(r=e[3].toFixed(1)+"")&&Z(o,r),2&n&&U(t,"for",e[1])},d(e){e&&F(t)}}}function Ns(t){let n,o,r,i,a,l=[],c=new Map,u=t[4];const d=e=>e[8].id;for(let e=0;e<u.length;e+=1){let n=js(t,u,e),o=d(n);c.set(o,l[e]=Rs(o,n))}let p="mercator"===t[0].id&&zs(t);return{c(){n=D("div"),o=D("select");for(let e=0;e<l.length;e+=1)l[e].c();r=z(),p&&p.c(),U(o,"id",t[1]),U(o,"name",t[1]),U(o,"class","form-select form-select-sm svelte-q04tua"),void 0===t[0]&&xe((()=>t[7].call(o))),U(n,"class","input-group")},m(e,s){A(e,n,s),T(n,o);for(let e=0;e<l.length;e+=1)l[e].m(o,null);J(o,t[0]),T(n,r),p&&p.m(n,null),i||(a=[W(o,"change",t[7]),W(o,"change",t[6]),w(Cn.call(null,o))],i=!0)},p(e,[t]){21&t&&(u=e[4],l=qe(l,t,d,1,e,u,c,o,We,Rs,null,js)),2&t&&U(o,"id",e[1]),2&t&&U(o,"name",e[1]),17&t&&J(o,e[0]),"mercator"===e[0].id?p?p.p(e,t):(p=zs(e),p.c(),p.m(n,null)):p&&(p.d(1),p=null)},i:e,o:e,d(e){e&&F(n);for(let e=0;e<l.length;e+=1)l[e].d();p&&p.d(),i=!1,s(a)}}}function Ws(e,t,n){if(!e.proj4)return!1;try{const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}}catch(e){return!1}return!0}function qs(e,t,n){let o;p(e,St,(e=>n(3,o=e)));let{name:r="map-style"}=t,{ofp:s}=t,{selected:i=Ds[0]}=t,a=i.id;const l=s?Ds:Ds.filter((e=>!e.id.startsWith("vb_")&&"jb_theworld"!==e.id));return ce((()=>{if(i.id===Ds[0].id&&s){const e=s.route.points[0],t=s.route.points[s.route.points.length-1],o=Ds.find((e=>"vb_2020"===e.id)),r=Ds.find((e=>"jb_north"===e.id));Ws(o,e,t)?n(0,i=o):e.distanceTo(t,editolido.rad_to_nm)<=1500||(t.latitude>30&&e.latitude>30?n(0,i=r):t.longitude<-80&&e.longitude<-80?n(0,i=Ds.find((e=>"jb_pacific"===e.id))):(t.latitude>30||e.latitude>30)&&e.atFraction(t,.5).latitude>=30&&Ws(r,e,t)?n(0,i=r):n(0,i=Ds.find((e=>"jb_south"===e.id))))}n(2,a=i.id)})),e.$$set=e=>{"name"in e&&n(1,r=e.name),"ofp"in e&&n(5,s=e.ofp),"selected"in e&&n(0,i=e.selected)},[i,r,a,o,l,s,function(t){pe.call(this,e,t)},function(){i=Y(this),n(0,i),n(4,l)}]}class Us extends Ke{constructor(e){super(),Ze(this,e,qs,Ns,a,{name:1,ofp:5,selected:0})}}function Gs(t){let n,o,r,i,a;return{c(){n=D("label"),o=D("input"),U(o,"name",t[0]),U(o,"type","checkbox"),o.checked=r=t[2]>=0,U(o,"class","svelte-ockvdx"),U(n,"for",t[0]),U(n,"class","svelte-ockvdx"),ee(n,"btn-simulator-play",t[2]<0),ee(n,"btn-simulator-stop",t[2]>=0)},m(e,r){A(e,n,r),T(n,o),t[4](o),i||(a=[W(o,"change",t[3]),W(n,"click",t[3])],i=!0)},p(e,[t]){1&t&&U(o,"name",e[0]),4&t&&r!==(r=e[2]>=0)&&(o.checked=r),1&t&&U(n,"for",e[0]),4&t&&ee(n,"btn-simulator-play",e[2]<0),4&t&&ee(n,"btn-simulator-stop",e[2]>=0)},i:e,o:e,d(e){e&&F(n),t[4](null),i=!1,s(a)}}}function Hs(e,t,n){let o;p(e,Tt,(e=>n(2,o=e)));let r,{name:s="simulator"}=t;return e.$$set=e=>{"name"in e&&n(0,s=e.name)},[s,r,o,()=>{n(1,r.checked=!r.checked,r),x(Tt,o=r.checked?0:-1,o)},function(e){fe[e?"unshift":"push"]((()=>{r=e,n(1,r)}))}]}class Bs extends Ke{constructor(e){super(),Ze(this,e,Hs,Gs,a,{name:0})}}const Zs=gt(),Ks=gt({});function Vs(e,{ofp:t,pos:n,fl:o}){const r=document.getElementById("gt-plane");let s,i,a,l,c,u=parseFloat(n),d=t,p=o;const m=e.clientHeight,f=e.clientWidth,h=getComputedStyle(document.body),g=parseFloat(h.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),v=e=>65*c+(l-130*c)*e/100,y=e=>{const t=v(e),n=65*c,o=f/3,r=n+o,s=l-n-(f-o);return t>r&&t<s?o-t:t<=r?o-r:o-s},$=(e,t,n,o)=>{e&&(e.style.left=n+(v(t)-e.clientWidth/2)+"px",e.style.top=(g-Math.round(-6e-4*o*o+.8985*o+46.264))*c-e.clientHeight/2+"px")},b=()=>{const t=i.height||700;a=i.cloneNode(),a.id="grametImg",a.style.display="none",a.crossOrigin="anonymous",a.addEventListener("load",x),a.addEventListener("error",w),document.body.appendChild(a),i.style.height=t/g*m+"px",i.style.objectFit="contain",i.style.position="absolute",i.style.opacity=.01,e.appendChild(i),l=i.clientWidth;const n=i.clientHeight/t;c=n;const o=y(u);i.style.top=`-${33*n}px`,i.style.left=`${o}px`},x=()=>{Zs.set("success"),r.style.display="block",i.style.opacity=1;const e=y(u);$(r,u,e,p)},w=()=>{r.style.display="none",Zs.set("error")},k=()=>{i&&i.removeEventListener("load",b),i&&i.removeEventListener("error",w),i&&i.remove(),Lt.set(!1),a&&a.removeEventListener("load",x),a&&a.removeEventListener("error",w),a&&a.remove(),a=void 0,i=void 0,s&&URL.revokeObjectURL(s),s=void 0},C=async e=>{i=document.createElement("img"),Zs.set("loading"),r.style.display="none",fetch(e.ogimetData.proxyImg).then((function(e){e.ok?(Ks.set({status:e.status,text:e.statusText||"OK"}),e.blob().then((e=>{i&&(s=URL.createObjectURL(e),i.addEventListener("load",b),i.addEventListener("error",w),i.src=s)}))):(w(),e.headers?Ks.set({status:e.status,text:e.statusText||e.headers.get("X-ofp2map-status")}):Ks.set({status:e.status,text:e.statusText||""}))})).catch((function(e){w(),Ks.set({status:0,text:e.message})}))};return C(t),{update({ofp:e,pos:t,fl:n}){if(u=parseFloat(t),e!==d)d=e,k(),C(e);else{const e=y(u);i.style.left=e+"px",p=n,$(r,u,e,n)}},destroy(){k()}}}const Js=(e,{pos:t,fl:n})=>{const o=e.parentNode.querySelector("svg"),r=document.getElementById("grametImg"),s=getComputedStyle(document.body),i=parseFloat(s.getPropertyValue("--gramet-inner-height","384px").slice(0,-2)),a=parseFloat(e.parentNode.dataset.maxHeight||"370"),l=r.width,c=r.height,u=document.querySelector("nav").clientWidth;let d;d=0!==l?Math.min(u/l*c,a):Math.min(c,a);let p,m,f=parseFloat(t),h=0,g=0,v=n;const y=e=>(65+(l-130)*e/100)*p,$=(e,t,n)=>{e.style.left=h+(y(t)-e.clientWidth/2+2)+"px",e.style.top=(i+33-2-Math.round(-6e-4*n*n+.8985*n+46.264))*p-e.clientHeight/2+g+"px"},b=e=>{const t=y(e),n=u/3,o=0+n,r=l*p-0-(u-n);return t>o&&t<r?n-t:t<=o?n-o:n-r},x=()=>{h=e.x,g=e.y,p=e.scale,m=u<=l*p,$(o,f,v)};return f<=0||f>=100?(p=0===l?a/(i+70):Math.min(u/l,d/(i+70)),g=0):(p=d/i,g=-33*p),u>l*p?(h=(u-l*p)/2,m=!1):(h=b(f),m=!0),$(o,f,v),r.style.display="block",e.style.maxHeight=`${a}px`,e.appendChild(r),e.setTransform({scale:p,x:h,y:g}),e.addEventListener("change",x),{update({pos:t,fl:n}){f=parseFloat(t),v=n,m&&(h=b(f),e.setTransform({x:h})),$(o,f,n)},destroy(){r.style.display="none",document.body.appendChild(r),e.removeEventListener("change",x)}}},Ys=e=>{const t=document.getElementById("grametImg"),n=t.width,o=t.height||700,r=parseFloat(e.dataset.maxHeight||"370"),s=document.querySelector("nav").clientWidth;let i=1;0!==n&&(i=s/n);const a=Math.min(i*o,r);e.style.height=`${a}px`};function Qs(e){let t,n;return t=new Bs({}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function Xs(e){let t,n,o,r,a,l,c,u,d,p,m,f=(0===e[0].gramet||100===e[0].gramet||e[1]>=0)&&Qs();return{c(){var e,o,s;t=D("div"),n=D("pinch-zoom"),r=z(),a=j("svg"),l=j("use"),c=z(),f&&f.c(),s="0.3",(o="min-scale")in(e=n)?e[o]="boolean"==typeof e[o]&&""===s||s:U(e,o,s),H(l,"xlink:href","#plane-symbol"),U(a,"class","svelte-16kt3wh"),U(t,"class","pinch-zoom-parent svelte-16kt3wh"),U(t,"data-max-height",ei)},m(s,i){A(s,t,i),T(t,n),T(t,r),T(t,a),T(a,l),T(t,c),f&&f.m(t,null),d=!0,p||(m=[w(o=Js.call(null,n,{pos:e[0].gramet,fl:e[0].fl})),w(Ys.call(null,t))],p=!0)},p(n,[r]){e=n,o&&i(o.update)&&1&r&&o.update.call(null,{pos:e[0].gramet,fl:e[0].fl}),0===e[0].gramet||100===e[0].gramet||e[1]>=0?f?3&r&&Ie(f,1):(f=Qs(),f.c(),Ie(f,1),f.m(t,null)):f&&(Ae(),_e(f,1,1,(()=>{f=null})),Fe())},i(e){d||(Ie(f),xe((()=>{u||(u=Re(t,pt,{y:ei},!0)),u.run(1)})),d=!0)},o(e){_e(f),u||(u=Re(t,pt,{y:ei},!1)),u.run(0),d=!1},d(e){e&&F(t),f&&f.d(),e&&u&&u.end(),p=!1,s(m)}}}const ei=370;function ti(e,t,n){let o,r;return p(e,Ut,(e=>n(0,o=e))),p(e,Tt,(e=>n(1,r=e))),[o,r]}class ni extends Ke{constructor(e){super(),Ze(this,e,ti,Xs,a,{})}}function oi(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const s=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",s,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",s),n&&n.remove()}}}function ri(e){let t,n,o,r,s;return n=new Cs({props:{value:e[8]>=0?e[8]:0,max:e[7]}}),{c(){t=D("div"),Ge(n.$$.fragment),U(t,"class","cacheButton svelte-revhzu"),ee(t,"cacheError",e[9]),ee(t,"cacheProgress",e[8]>=0||e[7]>0),ee(t,"hidden",!e[1]||e[14]||!e[15]||!0===e[11][e[5].id])},m(a,l){A(a,t,l),He(n,t,null),o=!0,r||(s=W(t,"click",(function(){i(e[12]?ui:e[22])&&(e[12]?ui:e[22]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const s={};256&r[0]&&(s.value=e[8]>=0?e[8]:0),128&r[0]&&(s.max=e[7]),n.$set(s),512&r[0]&&ee(t,"cacheError",e[9]),384&r[0]&&ee(t,"cacheProgress",e[8]>=0||e[7]>0),51234&r[0]&&ee(t,"hidden",!e[1]||e[14]||!e[15]||!0===e[11][e[5].id])},i(e){o||(Ie(n.$$.fragment,e),o=!0)},o(e){_e(n.$$.fragment,e),o=!1},d(e){e&&F(t),Be(n),r=!1,s()}}}function si(e){let t,n,o,r=e[5].subLabel+"";return{c(){t=D("div"),n=D("small"),o=R(r),U(t,"class","projection-info svelte-revhzu")},m(e,r){A(e,t,r),T(t,n),T(n,o)},p(e,t){32&t[0]&&r!==(r=e[5].subLabel+"")&&Z(o,r)},d(e){e&&F(t)}}}function ii(e){let t;return{c(){t=D("div"),t.textContent="Votre navigateur ne supporte pas l'affichage d'images au format .webp",U(t,"class","nowebp svelte-revhzu")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function ai(e){let t,n;return t=new Fs({props:{mapData:e[4]}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};16&n[0]&&(o.mapData=e[4]),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function li(e){let t,n;return t=new ni({}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function ci(e){let t,n,o,r,s,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,k,C,P=!e[13]&&e[4]&&e[4].mapOptions&&e[4].mapOptions.tiles&&e[4].mapOptions.tiles[0].endsWith(".webp");function L(t){e[24](t)}let M={ofp:e[1]};void 0!==e[5]&&(M.selected=e[5]),a=new Us({props:M}),fe.push((()=>Ue(a,"selected",L))),a.$on("change",e[19]);let S=e[5]&&window.indexedDB&&ri(e),E=e[5]&&e[5].subLabel&&si(e),O=P&&ii(),I=e[4]&&!!e[1]&&(e[16]||e[17]>=0)&&ai(e);function _(t){e[25](t)}let j={};function R(t){e[27](t)}void 0!==e[6]&&(j.aircraftTypeSelectElement=e[6]),f=new Os({props:j}),fe.push((()=>Ue(f,"aircraftTypeSelectElement",_))),f.$on("change",e[20]);let W={};void 0!==e[0]&&(W.kmlOptions=e[0]),v=new fo({props:W}),e[26](v),fe.push((()=>Ue(v,"kmlOptions",R))),v.$on("change",e[21]),v.$on("save",e[28]);let q=e[18]&&li();return{c(){t=D("div"),o=z(),r=D("div"),s=D("div"),Ge(a.$$.fragment),c=z(),S&&S.c(),u=z(),E&&E.c(),d=z(),O&&O.c(),p=z(),I&&I.c(),m=z(),Ge(f.$$.fragment),g=z(),Ge(v.$$.fragment),$=z(),q&&q.c(),b=N(),U(t,"id",e[2]),U(t,"class","svelte-revhzu"),U(s,"class","projection svelte-revhzu"),U(r,"class","mapmenu svelte-revhzu")},m(i,l){A(i,t,l),A(i,o,l),A(i,r,l),T(r,s),He(a,s,null),T(s,c),S&&S.m(s,null),T(r,u),E&&E.m(r,null),T(r,d),O&&O.m(r,null),A(i,p,l),I&&I.m(i,l),A(i,m,l),He(f,i,l),A(i,g,l),He(v,i,l),A(i,$,l),q&&q.m(i,l),A(i,b,l),x=!0,k||(C=w(n=oi.call(null,t,e[3])),k=!0)},p(e,o){(!x||4&o[0])&&U(t,"id",e[2]),n&&i(n.update)&&8&o[0]&&n.update.call(null,e[3]);const c={};2&o[0]&&(c.ofp=e[1]),!l&&32&o[0]&&(l=!0,c.selected=e[5],we((()=>l=!1))),a.$set(c),e[5]&&window.indexedDB?S?(S.p(e,o),32&o[0]&&Ie(S,1)):(S=ri(e),S.c(),Ie(S,1),S.m(s,null)):S&&(Ae(),_e(S,1,1,(()=>{S=null})),Fe()),e[5]&&e[5].subLabel?E?E.p(e,o):(E=si(e),E.c(),E.m(r,d)):E&&(E.d(1),E=null),8208&o[0]&&(P=!e[13]&&e[4]&&e[4].mapOptions&&e[4].mapOptions.tiles&&e[4].mapOptions.tiles[0].endsWith(".webp")),P?O||(O=ii(),O.c(),O.m(r,null)):O&&(O.d(1),O=null),e[4]&&e[1]&&(e[16]||e[17]>=0)?I?(I.p(e,o),196626&o[0]&&Ie(I,1)):(I=ai(e),I.c(),Ie(I,1),I.m(m.parentNode,m)):I&&(Ae(),_e(I,1,1,(()=>{I=null})),Fe());const u={};!h&&64&o[0]&&(h=!0,u.aircraftTypeSelectElement=e[6],we((()=>h=!1))),f.$set(u);const p={};!y&&1&o[0]&&(y=!0,p.kmlOptions=e[0],we((()=>y=!1))),v.$set(p),e[18]?q?262144&o[0]&&Ie(q,1):(q=li(),q.c(),Ie(q,1),q.m(b.parentNode,b)):q&&(Ae(),_e(q,1,1,(()=>{q=null})),Fe())},i(e){x||(Ie(a.$$.fragment,e),Ie(S),Ie(I),Ie(f.$$.fragment,e),Ie(v.$$.fragment,e),Ie(q),x=!0)},o(e){_e(a.$$.fragment,e),_e(S),_e(I),_e(f.$$.fragment,e),_e(v.$$.fragment,e),_e(q),x=!1},d(n){n&&F(t),n&&F(o),n&&F(r),Be(a),S&&S.d(),E&&E.d(),O&&O.d(),n&&F(p),I&&I.d(n),n&&F(m),Be(f,n),n&&F(g),e[26](null),Be(v,n),n&&F($),q&&q.d(n),n&&F(b),k=!1,C()}}}const ui=()=>!1;function di(e,t,n){let o,r,s,i,a,l;p(e,_t,(e=>n(29,r=e))),p(e,Nt,(e=>n(15,s=e))),p(e,Mt,(e=>n(16,i=e))),p(e,Tt,(e=>n(17,a=e))),p(e,Lt,(e=>n(18,l=e)));const c=de();let u,m,f,h,g,v,y,$,{kmlOptions:b}=t,{ofp:x}=t;let w;const k={};let{id:C="map"}=t;async function P(){if(n(7,g=0),n(8,v=-1),n(9,y=!1),n(23,$=[]),x)try{n(23,$=await xs(0,m))}catch(e){}const e=document.querySelector(`#${C} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(h),e.appendChild(document.createTextNode(`${"2108k".substring(0,2)}.${"2108k".substring(2,4)}`)))}const L=e=>{(e=>{const{name:t,value:n}=e,o=tt(t);if("icontext"===o)return ts.forEach((([,t])=>t.changeIconText&&t.changeIconText(e)));if("linewidth"===o)return ts.forEach((([,t])=>t.changeLineWidth&&t.changeLineWidth(e)));if("iconsize"===o)return ts.forEach((([,t])=>t.changeIconSize&&t.changeIconSize(e)));const r=Object.fromEntries(ts)[o];r&&(t.endsWith("-display")?n?r.show&&r.show(e):r.hide&&r.hide(e):t.endsWith("-label")?r.changeLabel&&r.changeLabel(e):t.endsWith("-pin")?r.changeMarker&&r.changeMarker(e):t.endsWith("-color")?r.changeLine&&r.changeLine(e):t.endsWith("-change")&&r.change&&r.change(e))})({map:u,mapData:m,name:e.detail.name,value:e.detail.value,ofp:x,kmlOptions:b,mapOptions:f,aircraftType:r}),c("save")};let M=!1;let S=!0;return(async()=>{const e=e=>{n(13,S=!(!e||"load"!==e.type)&&1==t.width)},t=new Image;t.onerror=e,t.onload=e,t.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="})(),ce((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",n(4,m=vs(C,f,x,b,r,P,!0)),Mt.reset(),n(3,u=m.map)})),ue((()=>{w.endFocusMode(),n(3,u=void 0),n(4,m=void 0)})),e.$$set=e=>{"kmlOptions"in e&&n(0,b=e.kmlOptions),"ofp"in e&&n(1,x=e.ofp),"id"in e&&n(2,C=e.id)},e.$$.update=()=>{8388608&e.$$.dirty[0]&&n(14,o=void 0!==$&&0===$.length)},[b,x,C,u,m,f,h,g,v,y,w,k,M,S,o,s,i,a,l,function(e){e.target.blur();const t=d(Mt);u&&u.remove(),Mt.set(!1),n(4,m=vs(C,f,x,b,r,P)),n(3,u=m.map),setTimeout((async()=>{await be,Mt.set(t)}),0)},function(e){e.target.blur(),L({detail:{value:r,name:"airport-change"}})},L,async e=>{if(M)return!1;n(12,M=!0),n(8,v=0);try{n(7,g=$.length),n(9,y=!1);try{await it(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(12,M=!1),n(9,y=!0),n(8,v=-1),!1}await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const s=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(s),e()),o>=5||r>n.length-1)return;const i=r++,a=n[i];o++;try{await fetch(a),t&&t()}catch(e){}o--,delete n[i]}),100)}))}($,(()=>n(8,v++,v))),v>=g&&(n(11,k[f.id]=!0,k),n(11,k),n(23,$=[]),n(7,g=0),n(8,v=-1))}finally{n(12,M=!1),n(8,v=-1)}},$,function(e){f=e,n(5,f)},function(e){h=e,n(6,h)},function(e){fe[e?"unshift":"push"]((()=>{w=e,n(10,w)}))},function(e){b=e,n(0,b)},function(t){pe.call(this,e,t)}]}class pi extends Ke{constructor(e){super(),Ze(this,e,di,ci,a,{kmlOptions:0,ofp:1,id:2},null,[-1,-1])}}var mi=["bottom-right","bottom-center","bottom-left","top-right","top-center","top-left","right-bottom","right-center","right-top","left-bottom","left-center","left-top"];const fi="right",hi="left",gi="top",vi="bottom";function yi(){return"undefined"!=typeof window&&"undefined"!=typeof document}const $i=(e,{top:t,bottom:n,left:o,right:r,height:s,width:i,clientWidth:a,clientHeight:l})=>{const c=t>s,u=n+s<l,d=o>i,p=r+i<a;return{top:()=>!c&&u?vi:gi,bottom:()=>c&&!u?gi:vi,left:()=>!d&&p?fi:hi,right:()=>!p&&d?hi:fi}[e]()},bi=(e,{top:t,bottom:n,left:o,right:r,height:s,width:i,clientWidth:a,clientHeight:l})=>{const c=t+(n-t)/2,u=n>s,d=t+s<l,p=c-s/2>0&&c+s/2<l,m=r>i,f=o+i<a,h={top:()=>!u&&d?vi:gi,center:()=>p?"center":h.top(),bottom:()=>!d&&u?gi:vi,left:()=>!m&&f?fi:hi,right:()=>!f&&m?hi:fi};return h[e]()},{window:xi}=Ne,wi=e=>({isOpen:1024&e[0]}),ki=e=>({toggle:e[12],isOpen:e[10],open:e[13],close:e[14]}),Ci=e=>({isOpen:1024&e[0]}),Pi=e=>({toggle:e[12],isOpen:e[10],open:e[13],close:e[14]});function Li(e){let t,n,o;const r=e[26].content,s=m(r,e,e[25],ki);return{c(){t=D("div"),s&&s.c(),U(t,"class",n=b(`content ${e[4]||""}`)+" svelte-d6atc3")},m(n,r){A(n,t,r),s&&s.m(t,null),e[28](t),o=!0},p(e,i){s&&s.p&&(!o||33555456&i[0])&&g(s,r,e,e[25],o?h(r,e[25],i,wi):v(e[25]),ki),(!o||16&i[0]&&n!==(n=b(`content ${e[4]||""}`)+" svelte-d6atc3"))&&U(t,"class",n)},i(e){o||(Ie(s,e),o=!0)},o(e){_e(s,e),o=!1},d(n){n&&F(t),s&&s.d(n),e[28](null)}}}function Mi(e){let t,n,o,r,i,a,l,c,u,d;const p=e[26].parent,f=m(p,e,e[25],Pi);let y=e[10]&&Li(e);return{c(){t=D("div"),n=D("div"),f&&f.c(),o=z(),r=D("div"),y&&y.c(),U(n,"class","svelte-d6atc3"),U(r,"class","content-wrapper svelte-d6atc3"),U(r,"style",i=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`),U(t,"class",a=b(`overlay ${e[11]}`)+" svelte-d6atc3"),U(t,"style",l=`z-index:${e[0]}; ${e[1]}`)},m(s,i){A(s,t,i),T(t,n),f&&f.m(n,null),e[27](n),T(t,o),T(t,r),y&&y.m(r,null),e[29](t),c=!0,u||(d=[W(xi,"mousedown",e[15]),W(xi,"keydown",e[16])],u=!0)},p(e,n){f&&f.p&&(!c||33555456&n[0])&&g(f,p,e,e[25],c?h(p,e[25],n,Ci):v(e[25]),Pi),e[10]?y?(y.p(e,n),1024&n[0]&&Ie(y,1)):(y=Li(e),y.c(),Ie(y,1),y.m(r,null)):y&&(Ae(),_e(y,1,1,(()=>{y=null})),Fe()),(!c||961&n[0]&&i!==(i=`top: ${e[6]}px; left: ${e[7]}px; width: ${e[8]}px; height: ${e[9]}px; z-index:${e[0]};`))&&U(r,"style",i),(!c||2048&n[0]&&a!==(a=b(`overlay ${e[11]}`)+" svelte-d6atc3"))&&U(t,"class",a),(!c||3&n[0]&&l!==(l=`z-index:${e[0]}; ${e[1]}`))&&U(t,"style",l)},i(e){c||(Ie(f,e),Ie(y),c=!0)},o(e){_e(f,e),_e(y),c=!1},d(n){n&&F(t),f&&f.d(n),e[27](null),y&&y.d(),e[29](null),u=!1,s(d)}}}function Si(e,t,o){let r,s,i,a;const l=["isOpen","updateOnScroll","closeOnScroll","position","closeOnClickOutside","zIndex","onWindowKeyDown","style"];let c=$(t,l),{$$slots:u={},$$scope:d}=t;const p=de(),m=mi[0];let f,h,g,{isOpen:v=!1}=t,{updateOnScroll:b=!1}=t,{closeOnScroll:x=!1}=t,{position:w=m}=t,{closeOnClickOutside:k=!1}=t,{zIndex:C=1}=t,{onWindowKeyDown:P=(()=>{})}=t,{style:L=""}=t,M=null,S=0,T=0,E=0,O=0;function A(){yi()&&(window.addEventListener("resize",z),x?window.addEventListener("scroll",j):b&&window.addEventListener("scroll",z))}function F(){yi()&&(window.removeEventListener("resize",z),window.removeEventListener("scroll",z),window.removeEventListener("scroll",j))}var I;function _(e){const t=v,n=!0===e||!1===e?e:!v;(n&&s&&i||!n)&&o(17,v=n),t!==v&&(p("toggle",v),v?(A(),p("open")):(p("close"),F()))}function D(){a||_(!0)}function j(){a&&_(!1)}function R(e){const t=e.path||e.composedPath();return t.includes(f)||t.includes(h)}async function z(){if(await be(),!a)return;mi.includes(w)||o(18,w=m);const{top:e,bottom:t,left:n,right:r,width:s,height:i}=f.getBoundingClientRect(),{height:l,width:c}=h.getBoundingClientRect(),u=((e,t)=>{const n=Math.min(document.body.clientHeight,document.documentElement.clientHeight),o=Math.min(document.body.clientWidth,document.documentElement.clientWidth);Object.assign(t,{clientWidth:o,clientHeight:n});const[r,s]=e.split("-");return`${$i(r,t)}-${bi(s,t)}`})(w,{top:e,bottom:t,left:n,right:r,height:l,width:c});M!==u&&o(4,M=u),o(6,S=e),o(7,T=n),o(8,E=s),o(9,O=i)}return ce((()=>{a&&A()})),ue((()=>{yi()&&F()})),I=z,le().$$.before_update.push(I),e.$$set=e=>{t=n(n({},t),y(e)),o(36,c=$(t,l)),"isOpen"in e&&o(17,v=e.isOpen),"updateOnScroll"in e&&o(19,b=e.updateOnScroll),"closeOnScroll"in e&&o(20,x=e.closeOnScroll),"position"in e&&o(18,w=e.position),"closeOnClickOutside"in e&&o(21,k=e.closeOnClickOutside),"zIndex"in e&&o(0,C=e.zIndex),"onWindowKeyDown"in e&&o(22,P=e.onWindowKeyDown),"style"in e&&o(1,L=e.style),"$$scope"in e&&o(25,d=e.$$scope)},e.$$.update=()=>{if(o(11,r=c.class||""),4&e.$$.dirty[0]&&o(24,s=!f||!!f.childNodes.length),8&e.$$.dirty[0]&&o(23,i=!h||!!h.childNodes.length),16777216&e.$$.dirty[0]&&!s)throw new Error("parent slot is required");if(8388608&e.$$.dirty[0]&&!i)throw new Error("content slot is required");25296896&e.$$.dirty[0]&&o(10,a=v&&s&&i)},[C,L,f,h,M,g,S,T,E,O,a,r,_,D,j,function(e){k&&a&&!R(e)&&j()},function(e){P&&a&&P(e,{isOpen:a,open:D,close:j,toggle:_,contains:R})},v,w,b,x,k,P,i,s,d,u,function(e){fe[e?"unshift":"push"]((()=>{f=e,o(2,f)}))},function(e){fe[e?"unshift":"push"]((()=>{h=e,o(3,h)}))},function(e){fe[e?"unshift":"push"]((()=>{g=e,o(5,g)}))}]}class Ti extends Ke{constructor(e){super(),Ze(this,e,Si,Mi,a,{isOpen:17,updateOnScroll:19,closeOnScroll:20,position:18,closeOnClickOutside:21,zIndex:0,onWindowKeyDown:22,style:1},null,[-1,-1])}}function Ei(e){let t,o;const r=e[3].default,s=m(r,e,e[2],null);let i=[{href:e[0]},e[1]],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=D("a"),s&&s.c(),G(t,a)},m(e,n){A(e,t,n),s&&s.m(t,null),o=!0},p(e,[n]){s&&s.p&&(!o||4&n)&&g(s,r,e,e[2],o?h(r,e[2],n,null):v(e[2]),null),G(t,a=function(e,t){const n={},o={},r={$$scope:1};let s=e.length;for(;s--;){const i=e[s],a=t[s];if(a){for(const e in i)e in a||(o[e]=1);for(const e in a)r[e]||(n[e]=a[e],r[e]=1);e[s]=a}else for(const e in i)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(i,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||(Ie(s,e),o=!0)},o(e){_e(s,e),o=!1},d(e){e&&F(t),s&&s.d(e)}}}function Oi(e,t,o){const r=["href"];let s=$(t,r),{$$slots:i={},$$scope:a}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},s):s;return e.$$set=e=>{t=n(n({},t),y(e)),o(5,s=$(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,a=e.$$scope)},[l,c,a,i]}class Ai extends Ke{constructor(e){super(),Ze(this,e,Oi,Ei,a,{href:0})}}function Fi(t){let n;return{c(){n=D("div"),n.innerHTML='<p class="svelte-hcnibf">↻</p><p class="svelte-hcnibf">Mise à jour</p>',U(n,"class","gramet-thumbnail updating svelte-hcnibf")},m(e,t){A(e,n,t)},p:e,i:e,o:e,d(e){e&&F(n)}}}function Ii(e){let t,n;return t=new Ti({props:{position:"bottom-center",$$slots:{content:[qi,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[Di,({toggle:e})=>({11:e}),({toggle:e})=>e?2048:0]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};7212&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function _i(e){let t,n,o,r,a,l,c,u,d,p,m=e[1]&&Ui();return c=new Ti({props:{position:"bottom-center",style:"margin-right: 0 !important;",isOpen:e[0],$$slots:{content:[Hi,({close:e})=>({10:e}),({close:e})=>e?1024:0],parent:[Gi]},$$scope:{ctx:e}}}),{c(){t=D("div"),n=j("svg"),o=j("circle"),r=z(),m&&m.c(),l=z(),Ge(c.$$.fragment),U(o,"cx","50"),U(o,"cy","50"),U(o,"r","50"),U(n,"id","gt-plane"),U(n,"viewBox","0 0 100 100"),U(n,"xmlns","http://www.w3.org/2000/svg"),U(n,"class","svelte-hcnibf"),U(t,"class","gramet-thumbnail svelte-hcnibf"),ee(t,"open",e[1])},m(s,i){A(s,t,i),T(t,n),T(n,o),T(t,r),m&&m.m(t,null),A(s,l,i),He(c,s,i),u=!0,d||(p=[w(a=Vs.call(null,t,{ofp:e[2],pos:e[4].gramet,fl:e[4].fl})),W(t,"click",e[6])],d=!0)},p(e,n){e[1]?m||(m=Ui(),m.c(),m.m(t,null)):m&&(m.d(1),m=null),a&&i(a.update)&&20&n&&a.update.call(null,{ofp:e[2],pos:e[4].gramet,fl:e[4].fl}),2&n&&ee(t,"open",e[1]);const o={};1&n&&(o.isOpen=e[0]),5120&n&&(o.$$scope={dirty:n,ctx:e}),c.$set(o)},i(e){u||(Ie(c.$$.fragment,e),u=!0)},o(e){_e(c.$$.fragment,e),u=!1},d(e){e&&F(t),m&&m.d(),e&&F(l),Be(c,e),d=!1,s(p)}}}function Di(e){let t,n,o;return{c(){t=D("button"),t.innerHTML='<svg class="gramet-error svelte-hcnibf"><use xlink:href="#info-symbol"></use></svg>',U(t,"slot","parent"),U(t,"class","btn btn-light svelte-hcnibf")},m(r,s){A(r,t,s),n||(o=W(t,"click",(function(){i(e[11])&&e[11].apply(this,arguments)})),n=!0)},p(t,n){e=t},d(e){e&&F(t),n=!1,o()}}}function ji(e){let t;return{c(){t=R("ogimet")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Ri(e){let t,n,o,r=0!==e[5].status&&Wi(e);return{c(){t=D("p"),t.textContent="A certaines heures le site ogimet est saturé, il faut essayer 2 ou 3 fois en temporisant de 30 secondes à chaque essai.",n=z(),r&&r.c(),o=N()},m(e,s){A(e,t,s),A(e,n,s),r&&r.m(e,s),A(e,o,s)},p(e,t){0!==e[5].status?r?r.p(e,t):(r=Wi(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(e){e&&F(t),e&&F(n),r&&r.d(e),e&&F(o)}}}function zi(t){let n;return{c(){n=D("p"),n.textContent="Le serveur ogimet indique qu'il est indisponible (no grib data). Sa mise à jour débute normalement à 00:00z et c'est long..."},m(e,t){A(e,n,t)},p:e,d(e){e&&F(n)}}}function Ni(e){let t,n,o,r,s,i=e[5].text+"";return{c(){t=D("p"),n=R('Erreur construction route GRAMET: Station "'),o=D("code"),r=R(i),s=R("\" non reconnue par ogimet,\n                    merci de me remonter l'information pour que je corrige l'application. Inutile de réessayer.")},m(e,i){A(e,t,i),T(t,n),T(t,o),T(o,r),T(t,s)},p(e,t){32&t&&i!==(i=e[5].text+"")&&Z(r,i)},d(e){e&&F(t)}}}function Wi(e){let t,n,o,r,s=(e[5].text||e[5].status)+"";return{c(){t=D("p"),n=R("Pour information, le proxy a retourné: "),o=D("code"),r=R(s)},m(e,s){A(e,t,s),T(t,n),T(t,o),T(o,r)},p(e,t){32&t&&s!==(s=(e[5].text||e[5].status)+"")&&Z(r,s)},d(e){e&&F(t)}}}function qi(e){let t,n,o,r,a,l,c,u,d,p,m,f,h,g,v,y,$;function b(e,t){return 409===e[5].status?Ni:"no grib data"===e[5].text?zi:Ri}f=new Ai({props:{href:e[2].ogimetData.url,target:"_blank",$$slots:{default:[ji]},$$scope:{ctx:e}}});let x=b(e),w=x(e);return{c(){t=D("div"),n=D("div"),o=D("div"),r=D("span"),r.textContent="😱: Erreur de récupération du Gramet",a=z(),l=D("button"),c=z(),u=D("div"),d=D("p"),p=D("a"),p.textContent="essayez à nouveau",m=R(" ou allez sur "),Ge(f.$$.fragment),h=R("."),g=z(),w.c(),U(l,"type","button"),U(l,"class","btn-close ms-auto"),U(l,"aria-label","Close"),U(o,"class","card-header"),U(p,"href","."),U(u,"class","card-body"),U(n,"class","overlay card"),V(n,"position","absolute"),U(t,"slot","content"),V(t,"width","350px")},m(s,b){A(s,t,b),T(t,n),T(n,o),T(o,r),T(o,a),T(o,l),T(n,c),T(n,u),T(u,d),T(d,p),T(d,m),He(f,d,null),T(d,h),T(u,g),w.m(u,null),v=!0,y||($=[W(l,"click",(function(){i(e[10])&&e[10].apply(this,arguments)})),W(p,"click",q(e[8]))],y=!0)},p(t,n){e=t;const o={};4&n&&(o.href=e[2].ogimetData.url),4096&n&&(o.$$scope={dirty:n,ctx:e}),f.$set(o),x===(x=b(e))&&w?w.p(e,n):(w.d(1),w=x(e),w&&(w.c(),w.m(u,null)))},i(e){v||(Ie(f.$$.fragment,e),v=!0)},o(e){_e(f.$$.fragment,e),v=!1},d(e){e&&F(t),Be(f),w.d(),y=!1,s($)}}}function Ui(e){let t,n;return{c(){t=j("svg"),n=j("use"),H(n,"xlink:href","#close-symbol"),U(t,"class","gramet-close svelte-hcnibf")},m(e,o){A(e,t,o),T(t,n)},d(e){e&&F(t)}}}function Gi(e){let t;return{c(){t=D("div"),U(t,"slot","parent"),U(t,"class","d-none")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Hi(e){let t,n,o,r,a,l,c,u,d,p,m,f;return{c(){t=D("div"),n=D("div"),o=D("div"),r=D("span"),r.textContent="Nouveau GRAMET disponible",a=z(),l=D("button"),c=z(),u=D("div"),d=D("p"),p=D("button"),p.textContent="Mettre à jour",U(l,"type","button"),U(l,"class","btn-close ms-auto"),U(l,"aria-label","Close"),U(o,"class","card-header"),U(p,"class","btn btn-primary"),U(d,"class","text-center mt-3"),U(u,"class","card-body"),U(n,"class","overlay card"),V(n,"left","calc(-1rem - 35px)"),V(n,"max-width","290px"),V(n,"top","20px"),U(t,"slot","content"),V(t,"width","290px")},m(s,h){A(s,t,h),T(t,n),T(n,o),T(o,r),T(o,a),T(o,l),T(n,c),T(n,u),T(u,d),T(d,p),m||(f=[W(l,"click",(function(){i(e[10])&&e[10].apply(this,arguments)})),W(p,"click",e[7])],m=!0)},p(t,n){e=t},d(e){e&&F(t),m=!1,s(f)}}}function Bi(e){let t,n,o,r;const s=[_i,Ii,Fi],i=[];function a(e,t){return"error"!==e[3]&&"reload"!==e[3]?0:"reload"!==e[3]?1:"reload"===e[3]?2:-1}return~(t=a(e))&&(n=i[t]=s[t](e)),{c(){n&&n.c(),o=N()},m(e,n){~t&&i[t].m(e,n),A(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?~t&&i[t].p(e,r):(n&&(Ae(),_e(i[l],1,1,(()=>{i[l]=null})),Fe()),~t?(n=i[t],n?n.p(e,r):(n=i[t]=s[t](e),n.c()),Ie(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(Ie(n),r=!0)},o(e){_e(n),r=!1},d(e){~t&&i[t].d(e),e&&F(o)}}}function Zi(e,t,n){let o,r,s,i,a;p(e,Lt,(e=>n(1,o=e))),p(e,Et,(e=>n(2,r=e))),p(e,Zs,(e=>n(3,s=e))),p(e,Ut,(e=>n(4,i=e))),p(e,Ks,(e=>n(5,a=e)));let l=!1;const c=async()=>{x(Zs,s="reload",s),x(Lt,o=!1,o),n(0,l=!1),await be,x(Zs,s="loading",s)},u=async e=>{if("workbox-broadcast-update"===e.data.meta&&"CACHE_UPDATED"===e.data.type){const{updatedURL:t}=e.data.payload;t===r.ogimetData.proxyImg&&(o?n(0,l=!0):c())}};navigator&&navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",u),ue((()=>{navigator&&navigator.serviceWorker&&navigator.serviceWorker.removeEventListener("message",u)}));return[l,o,r,s,i,a,()=>{"success"===s&&x(Lt,o=!o,o)},c,()=>x(Zs,s="loading",s)]}class Ki extends Ke{constructor(e){super(),Ze(this,e,Zi,Bi,a,{})}}var Vi={"OFP2MAP-AURORA":{version:3,url:"https://www.icloud.com/shortcuts/0da61ab87f40469db1842622b4d951ff",description:"NOAA Aurora Forecast 30-90mn et prévisions à 3 jours."},"OFP2MAP-ETOPS":{version:4,url:"https://www.icloud.com/shortcuts/271499bbcfea414eaa7d2d6ec96ae235",description:"Affiche un cartouche ETOPS actualisé."},"OFP2MAP-FAA WIPs":{version:2,url:"https://www.icloud.com/shortcuts/17bd4ab2ebec430596137173b131ce38",description:"Affiche la carte des travaux sol sur les terrains US"},"OFP2MAP-MENU":{version:2,url:"https://www.icloud.com/shortcuts/2db576c98d8d48d095bf751f56b54f56",description:"Menu affichant l'ensemble des plugins installés, utile pour un accès rapide."},"OFP2MAP-PLANE FINDER":{version:2,url:"https://www.icloud.com/shortcuts/3f67e5d6f47d42d0b16fd620a4170407",description:"Recherche l'avion avec flightaware.com."},"OFP2MAP-PLUGIN":{version:2,url:"https://www.icloud.com/shortcuts/28d507b414fb45979be635cc87b2d70d",description:"Modèle à dupliquer pour coder un plugin, permet de visualiser les données disponibles."}};const Ji=["CDG","ORY"],Yi=(e,t)=>e.longitude>=-30&&e.longitude<=40&&e.latitude>=25&&t.longitude>=-30&&t.longitude<=40&&t.latitude>=25?"MC":"LC",Qi=(e,t)=>"PAR"===e?Ji.includes(t):e===t,Xi=(e,{base:t})=>{const n=e.legs[e.legs.length-1];return n&&(e.OUT=e.legs[0].OUT,e.IN=n.IN,e.TVSV=e.legs.reduce(((e,t)=>t.blockTime+e),0),Qi(t,n.destIATA)||(e.layover=n.destIATA,e.layoverTZ=n.destTZ)),e},ea=e=>{const t={};if(!e)return t;let n,o,r,s={},i=[];try{const l=editolido.extract(e.text,"CREW PAIRING","Generated");let c,u;if(o=/TSV\s+-\s+(\d{2}):(\d{2})/u,r=o.exec(l),n=r?parseInt(r[2],10)+60*parseInt(r[1],10):0,o=/DATE\s:\s(\d+)\.(\S{3})\.(\d{4})/u,r=o.exec(l),!r)throw new Error("could not extract pairing month/year");if(u=parseInt(r[3],10),c=editolido.months3.indexOf(r[2])+1,c<=0)throw new Error("could not extract pairing month");o=new RegExp(String.raw`>\s${e.infos.depIATA}\s\(([-+.0-9]+)\)`,"u"),r=o.exec(l),t.depTZ=r?r[1]:"",o=new RegExp(String.raw`>\s${e.infos.destIATA}\s\(([-+.0-9]+)\)`,"u"),r=o.exec(l),t.destTZ=r?r[1]:"",o=/OPERATION VERSION\s(.+?)\s\d+\sNB PAX/u,r=o.exec(l),t.aircraftOpsVersion=r?r[1]:"",o=/(\d{2})\/(\d{2})\s\S+\s(\S{3})\s>\s(\S{3})\s\(([-+\d.]+)\)\s(\d{2}):(\d{2})\s(?:\d{2}:\d{2})\s(\d{2}):(\d{2})/gu;let d,p=0,m={legs:[]},f="MC",h="MC1";for(r of l.matchAll(o)){const t=parseInt(r[2],10),n=parseInt(r[1],10),o=t<c?u+1:u,s=new Date(Date.UTC(o,t-1,n,parseInt(r[6],10),parseInt(r[7],10))),l=parseInt(r[9],10)+60*parseInt(r[8],10),g=new Date(s.getTime()+6e4*l),v=r[3],y=editolido.iata2GeoPoint(v);d||(d=Ji.includes(v)?"PAR":v);const $=editolido.iata2GeoPoint(r[4]),b=Math.round(y.distanceTo($,editolido.rad_to_nm));if("LC"!==f&&"LC"===Yi(y,$)&&(f="LC"),"LC"!==h){const e=(a=b)<=2100?"MC1":a<=3e3?"MC2":"LC";("LC"===e||"MC2"===e&&"MC1"===h)&&(h=e)}0!==m.legs.length&&s-m.legs[m.legs.length-1].IN>36e6&&(i.push(Xi(m,{base:d})),m={legs:[]}),m.legs.push({depICAO:y.name,depIATA:v,destIATA:r[4],destICAO:$.name,destTZ:r[5],depTZ:p,OUT:s,IN:g,blockTime:l,isOFP:s.toISOString()===e.infos.ofpOUT.toISOString()}),p=r[5]}m.legs.length>0&&i.push(Xi(m,{base:d})),s.baseTZ=p,s.base=d,i.length>0&&(i[0].legs[0].depTZ=p),s.flightTypePNT="MC2"===h&&((e,t,n)=>{const o=[];for(const r of n){const n=r.legs[r.legs.length-1];Qi(e,n.destIATA)||o.push(Math.abs(parseFloat(n.destTZ)-t))}return Math.max(o)})(d,parseFloat(s.baseTZ),i)>=4?"LC":h,s.flightTypePNC=f}catch(e){editolido.StringExtractException,i=[]}var a;t.pairing=s,t.pairing.duties=i;const l=i.filter((e=>e.legs.reduce(((e,t)=>t.isOFP||e),!1))).pop();if(t.scheduledTSV=n,l&&(l.TSV=n,l.legs.length>0)){const e=l.legs[l.legs.length-1];Qi(s.base,e.destIATA)||(l.layover=e.destIATA,l.layoverTZ=e.destTZ)}return t.duty=l,t};function ta(e){let t;return{c(){t=D("p"),t.textContent="ETOPS",U(t,"class","etops svelte-4dsjkr")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function na(t){let n,o,r,s,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x=t[1].infos.flightNo+"",w=t[1].infos.depICAO+"",k=t[1].infos.destICAO+"",C=t[1].infos.ofpTextDate+"",P=t[1].infos.ofp.includes("/")?"":"ofp: ",L=t[1].infos.ofp+"",M=t[3]<20&&ta(),S=navigator&&navigator.share&&function(e){let t;return{c(){t=D("span"),t.textContent="🧩",U(t,"class","plugin svelte-4dsjkr")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}();return{c(){n=D("div"),M&&M.c(),o=z(),r=D("a"),s=D("p"),i=D("b"),a=R(x),l=z(),c=R(w),u=R("-"),d=R(k),p=z(),m=D("p"),f=R(C),h=z(),g=R(P),v=R(L),y=z(),S&&S.c(),U(s,"class","svelte-4dsjkr"),U(m,"class","svelte-4dsjkr"),U(r,"href",t[2]),U(r,"class","details svelte-4dsjkr"),ee(r,"cursor-pointer",navigator&&navigator.share),U(n,"class","infos svelte-4dsjkr")},m(e,x){A(e,n,x),M&&M.m(n,null),T(n,o),T(n,r),T(r,s),T(s,i),T(i,a),T(s,l),T(s,c),T(s,u),T(s,d),T(r,p),T(r,m),T(m,f),T(m,h),T(m,g),T(m,v),T(m,y),S&&S.m(m,null),$||(b=W(r,"click",t[0]),$=!0)},p(e,[t]){e[3]<20?M||(M=ta(),M.c(),M.m(n,o)):M&&(M.d(1),M=null),2&t&&x!==(x=e[1].infos.flightNo+"")&&Z(a,x),2&t&&w!==(w=e[1].infos.depICAO+"")&&Z(c,w),2&t&&k!==(k=e[1].infos.destICAO+"")&&Z(d,k),2&t&&C!==(C=e[1].infos.ofpTextDate+"")&&Z(f,C),2&t&&P!==(P=e[1].infos.ofp.includes("/")?"":"ofp: ")&&Z(g,P),2&t&&L!==(L=e[1].infos.ofp+"")&&Z(v,L),4&t&&U(r,"href",e[2])},i:e,o:e,d(e){e&&F(n),M&&M.d(),S&&S.d(),$=!1,b()}}}function oa(e,t,n){let o,r,s,i;p(e,At,(e=>n(5,r=e))),p(e,Et,(e=>n(1,s=e)));let a;(async()=>{const e=await caches.open("share_cache"),t=await e.match("/share-shortcut");if(!t)return null;return(await t.json()).shortcutName})().then((e=>a=e)).catch((e=>{}));const l=e=>{const t=[],n=e=>e.getUTCHours().toString().padStart(2,"0"),o=e=>e.getUTCMinutes().toString().padStart(2,"0");for(const r of e)if("ETOPS"===r.description)t.push(`\n**Appui**: ${r.name} ${r.runway} - Plage: **${n(r.startWindow)}${o(r.startWindow)}-${n(r.endWindow)}${o(r.endWindow)}**`);else{let e;e=r.description.startsWith("ETP")?`**${r.description}** ${r.name}`:`**${r.description.substring(0,3)}**${r.description.substring(3)}`,t.push(`\n${e} ➔ ETO: **${n(r.ETO)}:${o(r.ETO)}** | ΔFUEL: **${r.fuelMargin}**\n`)}return t},c=(e,t)=>{let n="";const o=[];for(const[r,s,,,i,a,l,c,u,d,p]of function*(e,t){if(!e||!t)return[];let n="";const o=e.infos.ralts;if(o.length>0)try{n=e.text.extract("ETOPS SUMMARY","SUMMARY-").replace(e.removePageFooterRegex,"")}catch(e){}const r=String.raw`(EEP\(\S{4}\)|ETP\S+|EXP\(\S{4}\))\s+\d{2}\.\d{2}\s+(\S+)\s+(\S+)\s+EET (\d{2})\.(\d{2}) .+? ([\d.]+)\/EFOB ([\d.]+)(?:.+?(${o.join("|")})\s(\S+).+?\sREQ\s(\d{2})(\d{2})-(\d{2})(\d{2}))?`,s=new RegExp(r,"gm"),i=new Date(t),a=t-e.infos.ofpOFF;i.setUTCHours(0,0);const l=n.matchAll(s);for(let[,e,n,o,r,s,c,u,d,p,m,f,h,g]of l){const l=editolido.dm_normalizer([n,o]),v=60*parseInt(r,10)+parseInt(s,10),y=new Date(t.getTime()+6e4*v),$=Math.round(10*(parseFloat(u)-parseFloat(c)))/10,b=void 0!==m&&void 0!==f?new Date(i.getTime()+36e5*parseInt(m,10)+6e4*parseInt(f,10)+a):void 0,x=void 0!==h&&void 0!==g?new Date(i.getTime()+36e5*parseInt(h,10)+6e4*parseInt(g,10)+a):void 0;yield[e,y,parseFloat(c),parseFloat(u),$,d,p,b,x,l,v]}}(e,t)){const t={latitude:d.latitude,longitude:d.longitude,EET:p,ETO:s,fuelMargin:i.toFixed(1)};if(r.startsWith("ETP")?(t.name=`${n}/${a}`,t.description=r):(t.name=r.substring(4,8),t.description=r.substring(0,3)),o.push(t),a){const t=e.infos.raltPoints.filter((e=>e.name===a)).pop();let r,s;t&&(r=t.latitude,s=t.longitude),o.push({name:a,description:"ETOPS",latitude:r,longitude:s,runway:l,startWindow:c,endWindow:u}),n=a}}return o},u=e=>e.timeMatrix.length>0?e.timeMatrix.map((([e,t,n])=>({name:e.name,tte:t,fl:n,latitude:e.latitude.toFixed(6),longitude:e.longitude.toFixed(6)}))):e.route.points.map((e=>({name:e.name,latitude:e.latitude.toFixed(6),longitude:e.longitude.toFixed(6)})));return e.$$.update=()=>{2&e.$$.dirty&&n(3,o=s.infos.minFuelMarginETOPS/(s.infos.tripFuel/s.infos.flightTime))},[async e=>{if(a||e.preventDefault(),!navigator||!navigator.share)return e.preventDefault(),!1;const t=s,o=r,d=["EEP","EXP","raltPoints","rawFPL","inFlightStart","inFlightReleased"],p=Object.fromEntries(Object.entries(t.infos).filter((([e,t])=>!d.includes(e)))),m={title:"OFP2MAP",text:JSON.stringify({...p,lidoFPL:t.lidoRoute(!1).join(" "),realOFF:o,altnETOPS:t.infos.ralts,route:u(t),...ea(t),registration:t.infos.aircraftRegistration,ralts:t.infos.ralts,etopsOutput:l(c(t,o)),"ofp2map-takeoff":o,plugins:Vi,rawText:t.text})};if(a)return n(2,i="shortcuts://run-shortcut?name="+encodeURIComponent(a)+"&input=text&text="+encodeURIComponent(JSON.stringify(m))),!0;try{await navigator.share(m)}catch(e){}return!1},s,i,o]}class ra extends Ke{constructor(e){super(),Ze(this,e,oa,na,a,{shareOFP:0})}get shareOFP(){return this.$$.ctx[0]}}function sa(e){let t,n,o,r,i,a,l,c,u,d,p,m;return{c(){t=D("div"),n=j("svg"),o=j("use"),r=z(),i=D("label"),a=R("Heure de décollage"),l=z(),c=D("input"),H(o,"xlink:href","#takeoff-symbol"),U(n,"class","svelte-12zw33h"),ee(n,"show",e[2]||e[3]>=0),ee(n,"hide",!(e[2]||e[3]>=0)),U(i,"for",e[0]),U(i,"class","svelte-12zw33h"),U(c,"id",e[0]),U(c,"name",e[0]),U(c,"type","time"),c.value=u=e[4](e[1].getUTCHours(),e[1].getUTCMinutes()),U(c,"class","svelte-12zw33h"),U(t,"class","svelte-12zw33h")},m(s,u){A(s,t,u),T(t,n),T(n,o),T(t,r),T(t,i),T(i,a),T(t,l),T(t,c),p||(m=[W(n,"click",e[6]),w(d=Cn.call(null,c)),W(c,"change",e[5])],p=!0)},p(e,t){12&t&&ee(n,"show",e[2]||e[3]>=0),12&t&&ee(n,"hide",!(e[2]||e[3]>=0)),1&t&&U(i,"for",e[0]),1&t&&U(c,"id",e[0]),1&t&&U(c,"name",e[0]),2&t&&u!==(u=e[4](e[1].getUTCHours(),e[1].getUTCMinutes()))&&(c.value=u)},d(e){e&&F(t),p=!1,s(m)}}}function ia(t){let n,o=t[1]&&sa(t);return{c(){o&&o.c(),n=N()},m(e,t){o&&o.m(e,t),A(e,n,t)},p(e,[t]){e[1]?o?o.p(e,t):(o=sa(e),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:e,o:e,d(e){o&&o.d(e),e&&F(n)}}}function aa(e,t,n){let o,r,s,i;p(e,At,(e=>n(1,o=e))),p(e,Et,(e=>n(7,r=e))),p(e,Mt,(e=>n(2,s=e))),p(e,Tt,(e=>n(3,i=e)));let{name:a="take-off"}=t;const l=new Date(r.infos.ofpOFF.getTime()),c=(e,t)=>`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return e.$$set=e=>{"name"in e&&n(0,a=e.name)},[a,o,s,i,c,e=>{let t,n;""==e.target.value?(n=l.getUTCHours(),t=l.getUTCMinutes(),e.target.blur(),e.target.value=c(n,t)):(n=parseFloat(e.target.value.slice(0,2)),t=parseFloat(e.target.value.slice(3)));let r=new Date(l);r.setUTCMinutes(t),r.setUTCHours(n);const s=(r.getTime()-l.getTime())/6e4;s<-720?r=new Date(r.getTime()+864e5):s>720&&(r=new Date(r.getTime()-864e5)),x(At,o=r,o),r.toISOString()!==l.toISOString()?e.target.classList.add("changed"):e.target.classList.remove("changed")},()=>x(Mt,s=!s,s)]}class la extends Ke{constructor(e){super(),Ze(this,e,aa,ia,a,{name:0})}}const ca=Math.PI,ua=Math.sin,da=Math.cos,pa=Math.tan,ma=Math.asin,fa=Math.acos,ha=Math.atan2,ga=180/ca,va=ca/180,ya=2451545,$a=e=>e.valueOf()/864e5-.5+2440588,ba=e=>($a(e)-ya)/36525,xa=e=>((e,t)=>(e%t+t)%t)(280.46646+e*(36000.76983+3032e-7*e),360),wa=e=>357.52911+e*(35999.05029-1537e-7*e),ka=e=>xa(e)+(e=>{const t=va*wa(e);return ua(t)*(1.914602-e*(.004817+14e-6*e))+ua(2*t)*(.019993-101e-6*e)+289e-6*ua(3*t)})(e),Ca=e=>ka(e)-.00569-.00478*ua(va*(125.04-1934.136*e)),Pa=e=>(e=>23+(26+(21.448-e*(46.815+e*(59e-5-.001813*e)))/60)/60)(e)+.00256*da(va*(125.04-1934.136*e)),La=e=>{const t=va*Pa(e),n=va*Ca(e),o=ua(t)*ua(n);return ma(o)},Ma=e=>{var t=va*Pa(e),n=va*Ca(e),o=da(t)*ua(n),r=da(n);return ha(o,r)},Sa=(e,t)=>{const{longitude:n}=t,o=e.getUTCHours(),r=e.getUTCMinutes(),s=e.getUTCSeconds(),i=ba(e),a=(e=>{const t=(e=>.016708634-e*(42037e-9+1.267e-7*e))(e),n=va*Pa(e),o=va*xa(e),r=va*wa(e),s=Math.pow(pa(n/2),2),i=s*ua(2*o)-2*t*ua(r)+4*t*s*ua(r)*da(2*o)-.5*s*s*ua(4*o)-1.25*t*t*ua(2*r);return ga*i*4})(i)+4*n,l=La(i);let c=(60*o+r+s/60+a)%1440/4-180;c<-180&&(c+=360);const u=t.latitude*va;let d=ua(u)*ua(l)+da(u)*da(l)*da(va*c);d>1?d=1:d<-1&&(d=-1);const p=fa(d);return{elevation:90-ga*p}},Ta=[[-15,"night"],[-12,"astronomical twilight"],[-6,"nautical twilight"],[-.833,"civil twilight"]],Ea=new Map([["night",([e,t])=>Aa(e,t)?"astronomicalDawn":"nightStart"],["astronomical twilight",([e,t])=>Aa(e,t)?"nauticalDawn":"astronomicalDusk"],["nautical twilight",([e,t])=>Aa(e,t)?"civilDawn":"nauticalDusk"],["civil twilight",([e,t])=>Aa(e,t)?"sunrise":"civilDusk"],["day",([e,t])=>Aa(e,t)?"dayStart":"sunset"]]),Oa=Array.from(Ea.keys()),Aa=(e,t)=>Oa.indexOf(t)>=Oa.indexOf(e),Fa=(e,t,n=0)=>{const o=Sa(e,t).elevation,r=1.15*Math.sqrt(100*n)/60;for(const[e,t]of Ta)if(o<=e-r)return{state:t,elevation:o};return{state:"day",elevation:o}},Ia=e=>$a(e)-ya,_a=23.4397*va,Da=(e,t)=>ha(ua(e)*da(_a)-pa(t)*ua(_a),da(e)),ja=(e,t)=>ma(ua(t)*da(_a)+da(t)*ua(_a)*ua(e)),Ra=e=>{const t=va*(134.963+13.064993*e),n=va*(93.272+13.22935*e),o=va*(218.316+13.176396*e)+6.289*va*ua(t),r=5.128*va*ua(n),s=385001-20905*da(t);return{ra:Da(o,r),dec:ja(o,r),dist:s}},za=e=>{const t=ba(e),n={dec:La(t),ra:Ma(t)},o=Ra(Ia(e)),r=149598e3,s=fa(ua(n.dec)*ua(o.dec)+da(n.dec)*da(o.dec)*da(n.ra-o.ra)),i=ha(r*ua(s),o.dist-r*da(s)),a=ha(da(n.dec)*ua(n.ra-o.ra),ua(n.dec)*da(o.dec)-da(n.dec)*ua(o.dec)*da(n.ra-o.ra));return{fraction:(1+da(i))/2,phase:.5+.5*i*(a<0?-1:1)/Math.PI,angle:a}},Na=function(e,t){var n=-t.longitude*va,o=t.latitude*va,r=Ia(e),s=Ra(r),i=((e,t)=>va*(280.16+360.9856235*e)-t)(r,n)-s.ra;return{altitude:((e,t,n)=>ma(ua(t)*ua(n)+da(t)*da(n)*da(e)))(i,o,s.dec),parallacticAngle:ha(ua(i),pa(o)*da(s.dec)-ua(s.dec)*da(i))}},Wa=(e,t,n=0)=>{const o=1.15*va*Math.sqrt(100*n)/60,r=Na(e,t).altitude;return{state:r>-.005794821282742547-o,elevation:ga*r}},qa=new Map([[!1,()=>"moonrise"],[!0,()=>"moonset"]]),Ua={name:"sun",getState:Fa,stateMap:Ea},Ga={name:"moon",getState:Wa,stateMap:qa};function*Ha({prev:e,next:t,takeOffTime:n,flightTime:o,segmentLength:r,getState:s,stateMap:i,increment:a=3e4}){let l=e.state;const c=6e4*e.sum,u=6e4*t.sum;for(let d=c+a;d<=u;d+=a){let a=e.fl;d>=u&&(a=t.fl);const p=new Date(n+d);let m;const f=u-c;if(0===f)m=t.p;else{const n=(d-c)/f;m=e.p.atFraction(t.p,n,r)}const{state:h}=s(p,m,a);if(h!==l){const e=Math.round(1e3*d/o)/10,n=i.get(l)([l,h]);if(yield{position:m,type:n,date:p,fl:a,relpos:e},h===t.state)break}l=h}}const Ba=()=>({[Ga.name]:[],[Ua.name]:[],route:[]}),Za=vt([Et,At],(([e,t])=>{if(!t||!e||0===e.timeMatrix.length)return Ba();const n=t.getTime(),o=Ba(),r=e.timeMatrix,s=e.distanceMatrix;let i=r.length-1;const a=6e4*r[i][1],l=[];for(const e of[Ua,Ga]){const t=[];let c=null;for(const[o,[u,d,p]]of r.entries()){let r=p;0!==o&&o!==i||(r=0);const m=new Date(n+6e4*d),f=e.getState(m,u,r).state,h={p:u,sum:d,fl:r,state:f};if(c&&f!==c.state){const r={prev:c,next:h,takeOffTime:n,flightTime:a,segmentLength:s[o][1]-s[o-1][1],getState:e.getState,stateMap:e.stateMap,increment:"sun"===e.name?3e4:6e4};for(const n of Ha(r))t.push(n),e===Ua&&l.push(n)}c=h,e===Ua&&l.push({position:u,type:f,date:m,relpos:Math.round(1e3*d*6e4/a)/10})}o[e.name]=t}return o.route=l,o}),Ba()),Ka=e=>{switch(e){case 0:case 1:case 2:return"#69B34C";case 3:return"#ACB334";case 4:return"#FAB733";case 5:return"#FF8E15";case 6:return"#FF4E11";case 7:case 8:case 9:return"#FF0D0D";default:return"lightgray"}},Va=gt(),Ja=async()=>fetch("https://services.swpc.noaa.gov/products/noaa-planetary-k-index-forecast.json").then((e=>e.json())).then((e=>{try{const t=[];for(let n=e.length-1;n>=1;n--){const[o,r]=e[n],s=Date.parse(o.replace(" ","T")+"Z");t.push([s,parseFloat(r)])}Va.set(t)}catch(e){}})).catch((function(e){})),Ya=vt([Ft,At,Va],(([e,t,n])=>{if(!e||!t||!n)return;let o=[];const r=t.getTime(),s=e-t;const i=e.getTime()+0,a=ct(n,(e=>e[0]<=i)),l=r+0,c=ct(n,(e=>e[0]<=l));c>=0&&a>=0&&(o=n.slice(a,c+1));const u=o.map((e=>({date:new Date(e[0]-0),kp:e[1],relpos:Math.round(1e4*(e[0]-0-r)/s)/100})));return{timetable:u,get:e=>{if(e)for(let t=0;t<u.length;t++)if(e>=u[t].date)return u[t].kp;return-1}}})),Qa=vt([Za,Ya],(([e,t])=>{if(0===e.route.length||!t)return[];const n=[];let o=[];for(const{position:r,date:s,type:i,relpos:a}of e.route){const e=t.get(s);["night","astronomicalDusk","astronomicalDawn"].includes(i)&&Math.round(el(r))<=e?o.push({position:r,date:s,relpos:a,predictedKp:e}):o.length>0&&(n.push(o),o=[])}o.length>0&&n.push(o);const r=[],s=3e5;for(const e of n){const t=e.length-1,n=e[0].date.getTime(),o=e[t].date.getTime(),i=1===e.length?3e5:0,a=Math.floor((n-i)/s)*s,l=Math.ceil((o+i)/s)*s,c=a/n*e[0].relpos,u=l/o*e[t].relpos;r.push({period:[new Date(a),new Date(l)],relpos:[c,u]})}return r})),Xa=[80.7,-72.7],el=e=>{if(e.latitude<=40)return[-90,99];const t=90-e.distanceTo(new editolido.GeoPoint(Xa),editolido.rad_to_deg);return t>66.5?0:(66.5-t)/2};function tl(t,n,o){let r,s=e;p(t,Ya,(e=>o(0,r=e))),t.$$.on_destroy.push((()=>s()));const i=async e=>{if("workbox-broadcast-update"===e.data.meta&&"CACHE_UPDATED"===e.data.type){const{updatedURL:t}=e.data.payload;"https://services.swpc.noaa.gov/products/noaa-planetary-k-index-forecast.json"===t&&Ja()}};return ce((()=>{navigator&&navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",i);const e=Et.subscribe((async()=>{await(async()=>{let e=!1;if(window.caches){const t=await window.caches.open("lido-noaa").then((e=>e.keys()));for(const n of t)if("https://services.swpc.noaa.gov/products/noaa-planetary-k-index-forecast.json"===n.url){e=!0;break}}return e})()&&void 0!==r?fetch("https://services.swpc.noaa.gov/products/noaa-planetary-k-index-forecast.json").catch((()=>{})):Ja()}));return()=>{e(),navigator&&navigator.serviceWorker&&navigator.serviceWorker.removeEventListener("message",i)}})),[]}class nl extends Ke{constructor(e){super(),Ze(this,e,tl,null,a,{})}}function ol(e,t,n){const o=e.slice();return o[11]=t[n].period,o[12]=t[n].relpos,o}function rl(e,t,n){const o=e.slice();return o[15]=t[n].type,o[12]=t[n].relpos,o[16]=t[n].date,o[17]=t[n].position,o}function sl(e,t,n){const o=e.slice();return o[20]=t[n],o[22]=n,o}function il(e){let t;return{c(){t=D("p"),t.textContent="Les prédictions de Kp sont indisponibles."},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function al(e){let t,n,o,r,s=("civilDawn"===e[20].type||"civilDusk"===e[20].type)&&ll(e);return{c(){t=j("line"),s&&s.c(),r=N(),U(t,"stroke","gray"),U(t,"stroke-width","1"),U(t,"x1",n=yl(e[20].relpos)),U(t,"y1","30"),U(t,"x2",o=yl(e[20].relpos)),U(t,"y2","32")},m(e,n){A(e,t,n),s&&s.m(e,n),A(e,r,n)},p(e,i){16&i&&n!==(n=yl(e[20].relpos))&&U(t,"x1",n),16&i&&o!==(o=yl(e[20].relpos))&&U(t,"x2",o),"civilDawn"===e[20].type||"civilDusk"===e[20].type?s?s.p(e,i):(s=ll(e),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(e){e&&F(t),s&&s.d(e),e&&F(r)}}}function ll(e){let t,n,o,r;return{c(){t=j("text"),n=R($l),U(t,"fill",o="civilDawn"===e[20].type?"#FCBF49":"#000B18"),U(t,"text-anchor","middle"),U(t,"x",r=yl(e[20].relpos)),U(t,"y","44")},m(e,o){A(e,t,o),T(t,n)},p(e,n){16&n&&o!==(o="civilDawn"===e[20].type?"#FCBF49":"#000B18")&&U(t,"fill",o),16&n&&r!==(r=yl(e[20].relpos))&&U(t,"x",r)},d(e){e&&F(t)}}}function cl(e){let t,n,o,r;return{c(){t=j("rect"),U(t,"x",n=yl(e[4].sun[e[22]-1].relpos)),U(t,"width",o=vl*(e[20].relpos-e[4].sun[e[22]-1].relpos)+"%"),U(t,"fill",r=bl(e[4].sun[e[22]-1].type)),U(t,"y","20"),U(t,"height","10px")},m(e,n){A(e,t,n)},p(e,s){16&s&&n!==(n=yl(e[4].sun[e[22]-1].relpos))&&U(t,"x",n),16&s&&o!==(o=vl*(e[20].relpos-e[4].sun[e[22]-1].relpos)+"%")&&U(t,"width",o),16&s&&r!==(r=bl(e[4].sun[e[22]-1].type))&&U(t,"fill",r)},d(e){e&&F(t)}}}function ul(e){let t,n,o;return{c(){t=j("rect"),U(t,"x",yl(0)),U(t,"width",n=vl*e[20].relpos+"%"),U(t,"fill",o=bl(e[0].state)),U(t,"y","20"),U(t,"height","10px")},m(e,n){A(e,t,n)},p(e,r){16&r&&n!==(n=vl*e[20].relpos+"%")&&U(t,"width",n),1&r&&o!==(o=bl(e[0].state))&&U(t,"fill",o)},d(e){e&&F(t)}}}function dl(e){let t,n,o=["sunrise","sunset","civilDawn","civilDusk","nauticalDawn","nauticalDusk"].includes(e[20].type),r=o&&al(e);let s=function(e,t){return 0===e[22]?ul:cl}(e)(e);return{c(){r&&r.c(),t=N(),s.c(),n=N()},m(e,o){r&&r.m(e,o),A(e,t,o),s.m(e,o),A(e,n,o)},p(e,n){16&n&&(o=["sunrise","sunset","civilDawn","civilDusk","nauticalDawn","nauticalDusk"].includes(e[20].type)),o?r?r.p(e,n):(r=al(e),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),s.p(e,n)},d(e){r&&r.d(e),e&&F(t),s.d(e),e&&F(n)}}}function pl(e){let t,n,o,r,s,i,a,l;return{c(){t=j("line"),r=j("text"),s=R("☾"),U(t,"stroke","gray"),U(t,"stroke-width","1"),U(t,"x1",n=yl(e[12])),U(t,"y1","18"),U(t,"x2",o=yl(e[12])),U(t,"y2","20"),U(r,"fill",i="moonrise"===e[15]?"#FCBF49":"gray"),U(r,"text-anchor","middle"),U(r,"x",a=yl(e[12])),U(r,"y","16"),U(r,"transform",l=e[9](e[16],e[17],yl(e[12],e[2]),9))},m(e,n){A(e,t,n),A(e,r,n),T(r,s)},p(e,s){16&s&&n!==(n=yl(e[12]))&&U(t,"x1",n),16&s&&o!==(o=yl(e[12]))&&U(t,"x2",o),16&s&&i!==(i="moonrise"===e[15]?"#FCBF49":"gray")&&U(r,"fill",i),16&s&&a!==(a=yl(e[12]))&&U(r,"x",a),20&s&&l!==(l=e[9](e[16],e[17],yl(e[12],e[2]),9))&&U(r,"transform",l)},d(e){e&&F(t),e&&F(r)}}}function ml(e){let t,n,o,r,s,i,a,l,c,u=gl(e[11][0])+"",d=gl(e[11][1])+"";return{c(){t=j("rect"),r=j("text"),s=R(u),a=j("text"),l=R(d),U(t,"stroke","lime"),U(t,"stroke-opacity","60%"),U(t,"fill","transparent"),U(t,"stroke-width","2"),U(t,"x",n=yl(e[12][0])),U(t,"y","18"),U(t,"width",o=vl*(e[12][1]-e[12][0])+"%"),U(t,"height","14"),U(r,"fill","green"),U(r,"text-anchor","middle"),U(r,"font-size","0.7em"),U(r,"x",i=yl(e[12][0]+(e[12][1]-e[12][0])/2)),U(r,"y","15"),U(a,"fill","green"),U(a,"text-anchor","middle"),U(a,"font-size","0.7em"),U(a,"x",c=yl(e[12][0]+(e[12][1]-e[12][0])/2)),U(a,"y","42")},m(e,n){A(e,t,n),A(e,r,n),T(r,s),A(e,a,n),T(a,l)},p(e,p){32&p&&n!==(n=yl(e[12][0]))&&U(t,"x",n),32&p&&o!==(o=vl*(e[12][1]-e[12][0])+"%")&&U(t,"width",o),32&p&&u!==(u=gl(e[11][0])+"")&&Z(s,u),32&p&&i!==(i=yl(e[12][0]+(e[12][1]-e[12][0])/2))&&U(r,"x",i),32&p&&d!==(d=gl(e[11][1])+"")&&Z(l,d),32&p&&c!==(c=yl(e[12][0]+(e[12][1]-e[12][0])/2))&&U(a,"x",c)},d(e){e&&F(t),e&&F(r),e&&F(a)}}}function fl(e){let t;return{c(){t=D("div"),t.innerHTML='<span class="svelte-1x2hvh5">zone favorable aux aurores boréales</span>',U(t,"class","aurora-legend svelte-1x2hvh5")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function hl(t){let n,o,r,s,i,a,l,c,u,d,p,m,f,h,g,v,y=gl(t[7])+"",$=gl(t[8])+"",b=!t[3]&&il(),x=t[4].sun,w=[];for(let e=0;e<x.length;e+=1)w[e]=dl(sl(t,x,e));let k=t[4].moon,C=[];for(let e=0;e<k.length;e+=1)C[e]=pl(rl(t,k,e));let P=t[5],L=[];for(let e=0;e<P.length;e+=1)L[e]=ml(ol(t,P,e));let M=t[5].length>0&&fl();return{c(){n=D("div"),b&&b.c(),o=z(),r=D("div"),s=j("svg"),i=j("rect");for(let e=0;e<w.length;e+=1)w[e].c();l=N();for(let e=0;e<C.length;e+=1)C[e].c();c=N();for(let e=0;e<L.length;e+=1)L[e].c();u=j("circle"),p=j("text"),m=R(y),f=j("text"),h=R($),v=z(),M&&M.c(),U(i,"x",yl(0)),U(i,"width",100*vl+"%"),U(i,"fill",a=bl(t[1].state)),U(i,"y","20"),U(i,"height","10px"),U(u,"fill","#FCBF49"),U(u,"stroke","black"),U(u,"stroke-width","0.5"),U(u,"cx",d=yl(t[6])),U(u,"cy","25"),U(u,"r","2.5"),U(p,"fill","black"),U(p,"text-anchor","middle"),U(p,"x","5%"),U(p,"y","56"),U(f,"fill","black"),U(f,"text-anchor","middle"),U(f,"x","95%"),U(f,"y","56"),U(s,"width","100%"),U(s,"height","60px"),U(s,"xmlns","http://www.w3.org/2000/svg"),xe((()=>t[10].call(r)))},m(e,a){A(e,n,a),b&&b.m(n,null),T(n,o),T(n,r),T(r,s),T(s,i);for(let e=0;e<w.length;e+=1)w[e].m(s,null);T(s,l);for(let e=0;e<C.length;e+=1)C[e].m(s,null);T(s,c);for(let e=0;e<L.length;e+=1)L[e].m(s,null);T(s,u),T(s,p),T(p,m),T(s,f),T(f,h),g=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=D("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=X();let r;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=W(window,"message",(e=>{e.source===n.contentWindow&&t()}))):(n.src="about:blank",n.onload=()=>{r=W(n.contentWindow,"resize",t)}),T(e,n),()=>{(o||r&&n.contentWindow)&&r(),F(n)}}(r,t[10].bind(r)),T(n,v),M&&M.m(n,null)},p(e,[t]){if(e[3]?b&&(b.d(1),b=null):b||(b=il(),b.c(),b.m(n,o)),2&t&&a!==(a=bl(e[1].state))&&U(i,"fill",a),17&t){let n;for(x=e[4].sun,n=0;n<x.length;n+=1){const o=sl(e,x,n);w[n]?w[n].p(o,t):(w[n]=dl(o),w[n].c(),w[n].m(s,l))}for(;n<w.length;n+=1)w[n].d(1);w.length=x.length}if(532&t){let n;for(k=e[4].moon,n=0;n<k.length;n+=1){const o=rl(e,k,n);C[n]?C[n].p(o,t):(C[n]=pl(o),C[n].c(),C[n].m(s,c))}for(;n<C.length;n+=1)C[n].d(1);C.length=k.length}if(32&t){let n;for(P=e[5],n=0;n<P.length;n+=1){const o=ol(e,P,n);L[n]?L[n].p(o,t):(L[n]=ml(o),L[n].c(),L[n].m(s,u))}for(;n<L.length;n+=1)L[n].d(1);L.length=P.length}64&t&&d!==(d=yl(e[6]))&&U(u,"cx",d),128&t&&y!==(y=gl(e[7])+"")&&Z(m,y),256&t&&$!==($=gl(e[8])+"")&&Z(h,$),e[5].length>0?M||(M=fl(),M.c(),M.m(n,null)):M&&(M.d(1),M=null)},i:e,o:e,d(e){e&&F(n),b&&b.d(),I(w,e),I(C,e),I(L,e),g(),M&&M.d()}}}const gl=(e,t=!1)=>e?t?e.toJSON().slice(11,19):e.getUTCSeconds(e)<30?e.toJSON().slice(11,16):new Date(e.getTime()+6e4).toJSON().slice(11,16):t?"--:--:--":"--:--",vl=.9,yl=(e,t)=>t?""+t*(5+vl*e)/100:5+vl*e+"%",$l="✽",bl=e=>{switch(e){case"dayStart":case"day":case"sunrise":return"#89d4ff";case"sunset":case"civil twilight":case"civilDawn":return"#2383C2";case"civilDusk":case"nautical twilight":case"nauticalDawn":return"#0052A2";case"nauticalDusk":case"astronomical twilight":case"astronomicalDawn":case"astronomicalDusk":case"night":case"nighStart":return"#000B18";default:return"red"}};function xl(e,t,n){let o,r,s,i,a,l;p(e,Ya,(e=>n(3,o=e))),p(e,Za,(e=>n(4,r=e))),p(e,Qa,(e=>n(5,s=e))),p(e,qt,(e=>n(6,i=e))),p(e,At,(e=>n(7,a=e))),p(e,Ft,(e=>n(8,l=e)));let c=364;let{departureSun:u}=t,{arrivalSun:d}=t;return e.$$set=e=>{"departureSun"in e&&n(0,u=e.departureSun),"arrivalSun"in e&&n(1,d=e.arrivalSun)},[u,d,c,o,r,s,i,a,l,(e,t,n,o)=>`rotate(${180*-(za(e).angle-Na(e,t).parallacticAngle)/Math.PI+132}, ${n}, ${o})`,function(){c=this.clientWidth,n(2,c)}]}class wl extends Ke{constructor(e){super(),Ze(this,e,xl,hl,a,{departureSun:0,arrivalSun:1})}}function kl(e,t,n){const o=e.slice();return o[7]=t[n].date,o[8]=t[n].kp,o[9]=t[n].relpos,o[11]=n,o}function Cl(t){let n;return{c(){n=D("p"),n.textContent="Les prévisions sont disponibles de J-7 à J+2",U(n,"class","svelte-1t8wt3o")},m(e,t){A(e,n,t)},p:e,d(e){e&&F(n)}}}function Pl(t){let n;return{c(){n=D("p"),n.textContent="Les prévisions de Kp sont indisponibles.",U(n,"class","svelte-1t8wt3o")},m(e,t){A(e,n,t)},p:e,d(e){e&&F(n)}}}function Ll(e){let t,n,o,r,s,i,a,l=gl(e[3])+"",c=gl(e[4])+"",u=e[1],d=[];for(let t=0;t<u.length;t+=1)d[t]=Sl(kl(e,u,t));let p=0===e[5].length&&!!e[0]&&Tl();return{c(){t=j("svg");for(let e=0;e<d.length;e+=1)d[e].c();n=j("circle"),r=j("text"),s=R(l),i=j("text"),a=R(c),p&&p.c(),U(n,"fill","#FCBF49"),U(n,"stroke","black"),U(n,"stroke-width","0.5"),U(n,"cx",o=yl(e[2])),U(n,"cy","20"),U(n,"r","2.5"),U(r,"fill","black"),U(r,"text-anchor","middle"),U(r,"x","5%"),U(r,"y","49"),U(i,"fill","black"),U(i,"text-anchor","middle"),U(i,"x","95%"),U(i,"y","49"),U(t,"width","100%"),U(t,"height","53px"),U(t,"xmlns","http://www.w3.org/2000/svg")},m(e,o){A(e,t,o);for(let e=0;e<d.length;e+=1)d[e].m(t,null);T(t,n),T(t,r),T(r,s),T(t,i),T(i,a),p&&p.m(t,null)},p(e,r){if(66&r){let o;for(u=e[1],o=0;o<u.length;o+=1){const s=kl(e,u,o);d[o]?d[o].p(s,r):(d[o]=Sl(s),d[o].c(),d[o].m(t,n))}for(;o<d.length;o+=1)d[o].d(1);d.length=u.length}4&r&&o!==(o=yl(e[2]))&&U(n,"cx",o),8&r&&l!==(l=gl(e[3])+"")&&Z(s,l),16&r&&c!==(c=gl(e[4])+"")&&Z(a,c),0===e[5].length&&e[0]?p||(p=Tl(),p.c(),p.m(t,null)):p&&(p.d(1),p=null)},d(e){e&&F(t),I(d,e),p&&p.d()}}}function Ml(e){let t,n,o,r=gl(e[7])+"";return{c(){t=j("text"),n=R(r),U(t,"fill","gray"),U(t,"text-anchor","middle"),U(t,"font-size","0.7em"),U(t,"x",o=yl(e[9])),U(t,"y","31")},m(e,o){A(e,t,o),T(t,n)},p(e,s){2&s&&r!==(r=gl(e[7])+"")&&Z(n,r),2&s&&o!==(o=yl(e[9]))&&U(t,"x",o)},d(e){e&&F(t)}}}function Sl(e){let t,n,o,r,s,i,a,l,c=e[8]+"",u=e[9]>5&&e[9]<95&&Ml(e);return{c(){t=j("rect"),s=j("text"),i=R(c),u&&u.c(),l=N(),U(t,"fill",n=Ka(e[8])),U(t,"x",o=yl(e[6](e[9]))),U(t,"y","7"),U(t,"width",r=vl*(e[6](0===e[11]?100:e[1][e[11]-1].relpos-.2)-e[6](e[9]))+"%"),U(t,"height","14px"),U(s,"fill","white"),U(s,"stroke","white"),U(s,"text-anchor","middle"),U(s,"font-size","0.7em"),U(s,"x",a=yl((e[6](e[9])+e[6](0===e[11]?100:e[1][e[11]-1].relpos))/2)),U(s,"y","17")},m(e,n){A(e,t,n),A(e,s,n),T(s,i),u&&u.m(e,n),A(e,l,n)},p(e,d){2&d&&n!==(n=Ka(e[8]))&&U(t,"fill",n),2&d&&o!==(o=yl(e[6](e[9])))&&U(t,"x",o),2&d&&r!==(r=vl*(e[6](0===e[11]?100:e[1][e[11]-1].relpos-.2)-e[6](e[9]))+"%")&&U(t,"width",r),2&d&&c!==(c=e[8]+"")&&Z(i,c),2&d&&a!==(a=yl((e[6](e[9])+e[6](0===e[11]?100:e[1][e[11]-1].relpos))/2))&&U(s,"x",a),e[9]>5&&e[9]<95?u?u.p(e,d):(u=Ml(e),u.c(),u.m(l.parentNode,l)):u&&(u.d(1),u=null)},d(e){e&&F(t),e&&F(s),u&&u.d(e),e&&F(l)}}}function Tl(e){let t,n;return{c(){t=j("text"),n=R("aucune aurore boréale prévue sur la route"),U(t,"fill","gray"),U(t,"text-anchor","middle"),U(t,"font-size","0.8em"),U(t,"x","50%"),U(t,"y","49")},m(e,o){A(e,t,o),T(t,n)},d(e){e&&F(t)}}}function El(t){let n;function o(e,t){return e[1].length>0?Ll:e[0]?Cl:Pl}let r=o(t),s=r(t);return{c(){n=D("div"),s.c()},m(e,t){A(e,n,t),s.m(n,null)},p(e,[t]){r===(r=o(e))&&s?s.p(e,t):(s.d(1),s=r(e),s&&(s.c(),s.m(n,null)))},i:e,o:e,d(e){e&&F(n),s.d()}}}function Ol(e,t,n){let o,r,s,i,a,l;p(e,Ya,(e=>n(0,r=e))),p(e,qt,(e=>n(2,s=e))),p(e,At,(e=>n(3,i=e))),p(e,Ft,(e=>n(4,a=e))),p(e,Qa,(e=>n(5,l=e)));return e.$$.update=()=>{1&e.$$.dirty&&n(1,o=r?r.timetable:[])},[r,o,s,i,a,l,e=>Math.min(100,Math.max(0,e))]}class Al extends Ke{constructor(e){super(),Ze(this,e,Ol,El,a,{})}}function Fl(e){let t,n,o;const r=e[5].default,s=m(r,e,e[4],null);return{c(){t=D("div"),s&&s.c(),U(t,"class","moon svelte-1ae9xab"),U(t,"style",n=e[1]()),ee(t,"rise","moonrise"===e[0])},m(e,n){A(e,t,n),s&&s.m(t,null),o=!0},p(e,[i]){s&&s.p&&(!o||16&i)&&g(s,r,e,e[4],o?h(r,e[4],i,null):v(e[4]),null),(!o||2&i&&n!==(n=e[1]()))&&U(t,"style",n),1&i&&ee(t,"rise","moonrise"===e[0])},i(e){o||(Ie(s,e),o=!0)},o(e){_e(s,e),o=!1},d(e){e&&F(t),s&&s.d(e)}}}const Il=e=>Math.round(100*e.fraction),_l=e=>{const t=e.phase,n=Il(e);return n<=0?"Nouvelle lune":t<.5&&n<50?"Premier croissant":t<.5&&50===n?"Premier quartier":t<.5&&n<100?"Gibbeuse croissante":100===n?"Pleine Lune":t>=.5&&n>50?"Gibbeuse décroissante":t>=.5&&50===n?"Dernier quartier":"Dernier croissant"};function Dl(e,t,n){let o,{$$slots:r={},$$scope:s}=t,{date:i}=t,{position:a}=t,{type:l=null}=t;return e.$$set=e=>{"date"in e&&n(2,i=e.date),"position"in e&&n(3,a=e.position),"type"in e&&n(0,l=e.type),"$$scope"in e&&n(4,s=e.$$scope)},e.$$.update=()=>{12&e.$$.dirty&&n(1,o=()=>{if(!i||!a)return 0;const e=za(i),t=e.phase>=.5?Math.PI/2:-Math.PI/2;return`transform: rotate(${-(e.angle-Na(i,a).parallacticAngle)+t}rad);`})},[l,o,i,a,s,r]}class jl extends Ke{constructor(e){super(),Ze(this,e,Dl,Fl,a,{date:2,position:3,type:0})}}function Rl(e,t,n){const o=e.slice();return o[14]=t[n],o}function zl(e,t,n){const o=e.slice();return o[17]=t[n],o[19]=n,o}function Nl(e,t,n){const o=e.slice();return o[17]=t[n],o[19]=n,o}function Wl(e,t,n){const o=e.slice();return o[17]=t[n],o[19]=n,o}function ql(t){let n,o,r,s,i,a;return{c(){n=j("rect"),s=j("rect"),U(n,"fill",o=bl(t[17])),U(n,"y",r=0+6*t[19]),U(n,"x","0"),U(n,"width","45%"),U(n,"height","5"),U(s,"fill",i=bl(t[12][t[12].length-1-t[19]])),U(s,"y",a=0+6*t[19]),U(s,"x","55%"),U(s,"width","45%"),U(s,"height","5")},m(e,t){A(e,n,t),A(e,s,t)},p:e,d(e){e&&F(n),e&&F(s)}}}function Ul(e){let t;return{c(){t=D("tr"),t.innerHTML='<td colspan="4" class="svelte-fe56h4">Aucun événement</td>',U(t,"class","svelte-fe56h4")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Gl(e){let t,n,o,r=e[10](e[5].arrival,e[6],e[8])+"";return{c(){t=D("td"),n=R("Atterrissage "),o=R(r),U(t,"colspan","4"),U(t,"class","svelte-fe56h4")},m(e,r){A(e,t,r),T(t,n),T(t,o)},p(e,t){352&t&&r!==(r=e[10](e[5].arrival,e[6],e[8])+"")&&Z(o,r)},d(e){e&&F(t)}}}function Hl(e){let t,n,o,r=e[11](e[17].type)+"",s=e[17].type.startsWith("civil"),i=s&&Zl(e);return{c(){t=D("td"),n=R(r),o=R(" en montée\n                        "),i&&i.c(),U(t,"colspan","4"),U(t,"class","svelte-fe56h4")},m(e,r){A(e,t,r),T(t,n),T(t,o),i&&i.m(t,null)},p(e,o){512&o&&r!==(r=e[11](e[17].type)+"")&&Z(n,r),512&o&&(s=e[17].type.startsWith("civil")),s?i?i.p(e,o):(i=Zl(e),i.c(),i.m(t,null)):i&&(i.d(1),i=null)},d(e){e&&F(t),i&&i.d()}}}function Bl(e){let t,n,o,r,s,i,a,l,c,u,d,p,m,f=e[11](e[17].type)+"",h=e[17].type.startsWith("civil"),g=gl(e[17].date)+"",v=e[17].fl+"",y=h&&Kl(e);return{c(){t=D("td"),n=R(f),o=z(),y&&y.c(),r=z(),s=D("td"),a=z(),l=D("td"),c=R(g),u=z(),d=D("td"),p=R("FL"),m=R(v),U(t,"class","svelte-fe56h4"),U(s,"class",i="color "+e[17].type+"-color svelte-fe56h4"),U(l,"class","svelte-fe56h4"),U(d,"class","svelte-fe56h4")},m(e,i){A(e,t,i),T(t,n),T(t,o),y&&y.m(t,null),A(e,r,i),A(e,s,i),A(e,a,i),A(e,l,i),T(l,c),A(e,u,i),A(e,d,i),T(d,p),T(d,m)},p(e,o){512&o&&f!==(f=e[11](e[17].type)+"")&&Z(n,f),512&o&&(h=e[17].type.startsWith("civil")),h?y?y.p(e,o):(y=Kl(e),y.c(),y.m(t,null)):y&&(y.d(1),y=null),512&o&&i!==(i="color "+e[17].type+"-color svelte-fe56h4")&&U(s,"class",i),512&o&&g!==(g=gl(e[17].date)+"")&&Z(c,g),512&o&&v!==(v=e[17].fl+"")&&Z(m,v)},d(e){e&&F(t),y&&y.d(),e&&F(r),e&&F(s),e&&F(a),e&&F(l),e&&F(u),e&&F(d)}}}function Zl(e){let t;return{c(){t=D("span"),t.textContent=`${$l}`,U(t,"class","svelte-fe56h4"),ee(t,"rise","civilDawn"===e[17].type)},m(e,n){A(e,t,n)},p(e,n){512&n&&ee(t,"rise","civilDawn"===e[17].type)},d(e){e&&F(t)}}}function Kl(e){let t;return{c(){t=D("span"),t.textContent=`${$l}`,U(t,"class","svelte-fe56h4"),ee(t,"rise","civilDawn"===e[17].type)},m(e,n){A(e,t,n)},p(e,n){512&n&&ee(t,"rise","civilDawn"===e[17].type)},d(e){e&&F(t)}}}function Vl(e){let t,n;function o(e,t){return 0!==e[17].fl?Bl:0===e[19]?Hl:Gl}let r=o(e),s=r(e);return{c(){t=D("tr"),s.c(),n=z(),U(t,"class","svelte-fe56h4")},m(e,o){A(e,t,o),s.m(t,null),T(t,n)},p(e,i){r===(r=o(e))&&s?s.p(e,i):(s.d(1),s=r(e),s&&(s.c(),s.m(t,n)))},d(e){e&&F(t),s.d()}}}function Jl(e){let t;return{c(){t=R(e[1])},m(e,n){A(e,t,n)},p(e,n){2&n&&Z(t,e[1])},d(e){e&&F(t)}}}function Yl(e){let t;return{c(){t=D("tr"),t.innerHTML='<td colspan="4" class="svelte-fe56h4">Aucun événement</td>',U(t,"class","svelte-fe56h4")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Ql(e){let t,n,o,r,s,i,a,l=e[11](e[17].type)+"",c=0===e[19]?"montée":"descente";return i=new jl({props:{position:e[17].position,type:e[17].type,date:e[17].date,$$slots:{default:[ec]},$$scope:{ctx:e}}}),{c(){t=D("td"),n=R(l),o=R(" en "),r=R(c),s=z(),Ge(i.$$.fragment),U(t,"colspan","4"),U(t,"class","svelte-fe56h4")},m(e,l){A(e,t,l),T(t,n),T(t,o),T(t,r),T(t,s),He(i,t,null),a=!0},p(e,t){(!a||512&t)&&l!==(l=e[11](e[17].type)+"")&&Z(n,l);const o={};512&t&&(o.position=e[17].position),512&t&&(o.type=e[17].type),512&t&&(o.date=e[17].date),4194306&t&&(o.$$scope={dirty:t,ctx:e}),i.$set(o)},i(e){a||(Ie(i.$$.fragment,e),a=!0)},o(e){_e(i.$$.fragment,e),a=!1},d(e){e&&F(t),Be(i)}}}function Xl(e){let t,n,o,r,s,i,a,l,c,u,d,p,m,f,h=e[11](e[17].type)+"",g=gl(e[17].date)+"",v=e[17].fl+"";return r=new jl({props:{position:e[17].position,type:e[17].type,date:e[17].date,$$slots:{default:[tc]},$$scope:{ctx:e}}}),{c(){t=D("td"),n=R(h),o=z(),Ge(r.$$.fragment),s=z(),i=D("td"),a=z(),l=D("td"),c=R(g),u=z(),d=D("td"),p=R("FL"),m=R(v),U(t,"class","svelte-fe56h4"),U(i,"class","color svelte-fe56h4"),U(l,"class","svelte-fe56h4"),U(d,"class","svelte-fe56h4")},m(e,h){A(e,t,h),T(t,n),T(t,o),He(r,t,null),A(e,s,h),A(e,i,h),A(e,a,h),A(e,l,h),T(l,c),A(e,u,h),A(e,d,h),T(d,p),T(d,m),f=!0},p(e,t){(!f||512&t)&&h!==(h=e[11](e[17].type)+"")&&Z(n,h);const o={};512&t&&(o.position=e[17].position),512&t&&(o.type=e[17].type),512&t&&(o.date=e[17].date),4194306&t&&(o.$$scope={dirty:t,ctx:e}),r.$set(o),(!f||512&t)&&g!==(g=gl(e[17].date)+"")&&Z(c,g),(!f||512&t)&&v!==(v=e[17].fl+"")&&Z(m,v)},i(e){f||(Ie(r.$$.fragment,e),f=!0)},o(e){_e(r.$$.fragment,e),f=!1},d(e){e&&F(t),Be(r),e&&F(s),e&&F(i),e&&F(a),e&&F(l),e&&F(u),e&&F(d)}}}function ec(e){let t;return{c(){t=R(e[1])},m(e,n){A(e,t,n)},p(e,n){2&n&&Z(t,e[1])},d(e){e&&F(t)}}}function tc(e){let t;return{c(){t=R(e[1])},m(e,n){A(e,t,n)},p(e,n){2&n&&Z(t,e[1])},d(e){e&&F(t)}}}function nc(e){let t,n,o,r,s;const i=[Xl,Ql],a=[];function l(e,t){return 0!==e[17].fl?0:1}return n=l(e),o=a[n]=i[n](e),{c(){t=D("tr"),o.c(),r=z(),U(t,"class","svelte-fe56h4")},m(e,o){A(e,t,o),a[n].m(t,null),T(t,r),s=!0},p(e,s){let c=n;n=l(e),n===c?a[n].p(e,s):(Ae(),_e(a[c],1,1,(()=>{a[c]=null})),Fe(),o=a[n],o?o.p(e,s):(o=a[n]=i[n](e),o.c()),Ie(o,1),o.m(t,r))},i(e){s||(Ie(o),s=!0)},o(e){_e(o),s=!1},d(e){e&&F(t),a[n].d()}}}function oc(t){let n,o,r,s,i,a;return{c(){n=j("rect"),s=j("text"),i=R(t[14]),U(n,"stroke",o=Ka(t[14])),U(n,"stroke-width","1"),U(n,"fill","transparent"),U(n,"x",r=2+15*t[14]),U(n,"y","2"),U(n,"width","12"),U(n,"height","12"),U(s,"fill","gray"),U(s,"text-anchor","middle"),U(s,"font-size","0.7em"),U(s,"x",a=8+15*t[14]),U(s,"y","11.5")},m(e,t){A(e,n,t),A(e,s,t),T(s,i)},p:e,d(e){e&&F(n),e&&F(s)}}}function rc(e){let t,n,o,r,s,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,w,k,C,P,L,M,S,E,O,_,N,W,q,G,H,B,K,V,J=_l(e[2])+"",Y=Il(e[2])+"",Q=e[7]?"":"non visible";n=new wl({props:{arrivalSun:e[8],departureSun:e[0]}});let X=e[12],ee=[];for(let t=0;t<X.length;t+=1)ee[t]=ql(Wl(e,X,t));let te=e[9].sun.filter(sc),ne=[];for(let t=0;t<te.length;t+=1)ne[t]=Vl(Nl(e,te,t));let oe=null;te.length||(oe=Ul()),w=new jl({props:{date:e[3],position:e[4].map,$$slots:{default:[Jl]},$$scope:{ctx:e}}});let re=e[9].moon,se=[];for(let t=0;t<re.length;t+=1)se[t]=nc(zl(e,re,t));const ie=e=>_e(se[e],1,1,(()=>{se[e]=null}));let ae=null;re.length||(ae=Yl());let le=[0,1,2,3,4,5,6,7,8,9],ce=[];for(let t=0;t<10;t+=1)ce[t]=oc(Rl(e,le,t));return K=new Al({}),{c(){t=D("div"),Ge(n.$$.fragment),o=z(),r=D("table"),s=D("thead"),i=D("tr"),a=D("th"),a.textContent="Soleil",l=z(),c=D("th"),u=j("svg");for(let e=0;e<ee.length;e+=1)ee[e].c();d=z(),p=D("th"),p.textContent="Heure",m=z(),f=D("th"),f.textContent="FL",h=z(),g=D("tbody");for(let e=0;e<ne.length;e+=1)ne[e].c();oe&&oe.c(),v=z(),y=D("thead"),$=D("tr"),b=D("th"),x=R("Lune "),Ge(w.$$.fragment),k=z(),C=R(J),P=z(),L=R(Y),M=R("% "),S=R(Q),E=z(),O=D("tbody");for(let e=0;e<se.length;e+=1)se[e].c();ae&&ae.c(),_=z(),N=D("thead"),W=D("tr"),q=D("th"),G=R("Prévisions de Kp\n                    "),H=j("svg");for(let e=0;e<10;e+=1)ce[e].c();B=z(),Ge(K.$$.fragment),U(a,"scope","col"),U(a,"class","svelte-fe56h4"),U(u,"width","100%"),U(u,"height","27px"),U(u,"xmlns","http://www.w3.org/2000/svg"),U(c,"scope","col"),U(c,"class","color svelte-fe56h4"),U(p,"scope","col"),U(p,"class","svelte-fe56h4"),U(f,"scope","col"),U(f,"class","svelte-fe56h4"),U(i,"class","svelte-fe56h4"),U(s,"class","svelte-fe56h4"),U(g,"class","svelte-fe56h4"),U(b,"scope","col"),U(b,"colspan","4"),U(b,"class","svelte-fe56h4"),U($,"class","svelte-fe56h4"),U(y,"class","svelte-fe56h4"),U(O,"class","svelte-fe56h4"),U(H,"width","150px"),U(H,"height","13px"),U(H,"xmlns","http://www.w3.org/2000/svg"),U(H,"class","svelte-fe56h4"),U(q,"scope","col"),U(q,"colspan","4"),U(q,"class","kp svelte-fe56h4"),U(W,"class","svelte-fe56h4"),U(N,"class","svelte-fe56h4"),U(r,"class","table svelte-fe56h4"),U(t,"class","card-body")},m(e,F){A(e,t,F),He(n,t,null),T(t,o),T(t,r),T(r,s),T(s,i),T(i,a),T(i,l),T(i,c),T(c,u);for(let e=0;e<ee.length;e+=1)ee[e].m(u,null);T(i,d),T(i,p),T(i,m),T(i,f),T(r,h),T(r,g);for(let e=0;e<ne.length;e+=1)ne[e].m(g,null);oe&&oe.m(g,null),T(r,v),T(r,y),T(y,$),T($,b),T(b,x),He(w,b,null),T(b,k),T(b,C),T(b,P),T(b,L),T(b,M),T(b,S),T(r,E),T(r,O);for(let e=0;e<se.length;e+=1)se[e].m(O,null);ae&&ae.m(O,null),T(r,_),T(r,N),T(N,W),T(W,q),T(q,G),T(q,H);for(let e=0;e<10;e+=1)ce[e].m(H,null);T(t,B),He(K,t,null),V=!0},p(e,[t]){const o={};if(256&t&&(o.arrivalSun=e[8]),1&t&&(o.departureSun=e[0]),n.$set(o),4096&t){let n;for(X=e[12],n=0;n<X.length;n+=1){const o=Wl(e,X,n);ee[n]?ee[n].p(o,t):(ee[n]=ql(o),ee[n].c(),ee[n].m(u,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=X.length}if(3936&t){let n;for(te=e[9].sun.filter(sc),n=0;n<te.length;n+=1){const o=Nl(e,te,n);ne[n]?ne[n].p(o,t):(ne[n]=Vl(o),ne[n].c(),ne[n].m(g,null))}for(;n<ne.length;n+=1)ne[n].d(1);ne.length=te.length,te.length?oe&&(oe.d(1),oe=null):oe||(oe=Ul(),oe.c(),oe.m(g,null))}const r={};if(8&t&&(r.date=e[3]),16&t&&(r.position=e[4].map),4194306&t&&(r.$$scope={dirty:t,ctx:e}),w.$set(r),(!V||4&t)&&J!==(J=_l(e[2])+"")&&Z(C,J),(!V||4&t)&&Y!==(Y=Il(e[2])+"")&&Z(L,Y),(!V||128&t)&&Q!==(Q=e[7]?"":"non visible")&&Z(S,Q),2562&t){let n;for(re=e[9].moon,n=0;n<re.length;n+=1){const o=zl(e,re,n);se[n]?(se[n].p(o,t),Ie(se[n],1)):(se[n]=nc(o),se[n].c(),Ie(se[n],1),se[n].m(O,null))}for(Ae(),n=re.length;n<se.length;n+=1)ie(n);Fe(),re.length?ae&&(ae.d(1),ae=null):ae||(ae=Yl(),ae.c(),ae.m(O,null))}if(0&t){let n;for(le=[0,1,2,3,4,5,6,7,8,9],n=0;n<10;n+=1){const o=Rl(e,le,n);ce[n]?ce[n].p(o,t):(ce[n]=oc(o),ce[n].c(),ce[n].m(H,null))}for(;n<10;n+=1)ce[n].d(1)}},i(e){if(!V){Ie(n.$$.fragment,e),Ie(w.$$.fragment,e);for(let e=0;e<re.length;e+=1)Ie(se[e]);Ie(K.$$.fragment,e),V=!0}},o(e){_e(n.$$.fragment,e),_e(w.$$.fragment,e),se=se.filter(Boolean);for(let e=0;e<se.length;e+=1)_e(se[e]);_e(K.$$.fragment,e),V=!1},d(e){e&&F(t),Be(n),I(ee,e),I(ne,e),oe&&oe.d(),Be(w),I(se,e),ae&&ae.d(),I(ce,e),Be(K)}}}const sc=e=>["sunrise","sunset","civilDawn","civilDusk","nauticalDawn","nauticalDusk"].includes(e.type);function ic(e,t,n){let o,r,s,i,a,l;p(e,Ut,(e=>n(4,s=e))),p(e,Et,(e=>n(5,i=e))),p(e,Ft,(e=>n(6,a=e))),p(e,Za,(e=>n(9,l=e)));let{departureSun:c}=t,{moonEmoji:u}=t,{moonIllumination:d}=t,{estimatedDate:m}=t;const f={astronomicalDawn:"Aube astronomique",astronomicalDusk:"Nuit astronomique",nauticalDawn:"Aube nautique",nauticalDusk:"Nuit nautique",civilDawn:"Aube civile",civilDusk:"Nuit civile",sunrise:"Lever du soleil",sunset:"Coucher du soleil",day:"Jour",night:"Nuit",moonrise:"Lever de lune",moonset:"Coucher de lune"},h=Oa.slice(1);return e.$$set=e=>{"departureSun"in e&&n(0,c=e.departureSun),"moonEmoji"in e&&n(1,u=e.moonEmoji),"moonIllumination"in e&&n(2,d=e.moonIllumination),"estimatedDate"in e&&n(3,m=e.estimatedDate)},e.$$.update=()=>{96&e.$$.dirty&&n(8,o=i&&a?((e,t,n)=>{const{state:o,elevation:r}=Fa(e,t,n);return{state:o,isRising:r<Sa(new Date(e.getTime()+6e5),t).elevation}})(a,i.arrival,0):""),24&e.$$.dirty&&n(7,r=s&&m?Wa(m,s.map,s.fl).state:"")},[c,u,d,m,s,i,a,r,o,l,(e,t,{state:n,isRising:o})=>e&&t?"day"===n?"de jour":"night"===n||"astronomical twilight"===n?"de nuit":"nautical twilight"===n?o?"durant l'aube nautique":"durant le crépuscule nautique":"civil twilight"===n?o?"durant l'aube civile":"durant le crépuscule civil":`#ERREUR ${n}#`:"",e=>f[e]||e,h]}class ac extends Ke{constructor(e){super(),Ze(this,e,ic,rc,a,{departureSun:0,moonEmoji:1,moonIllumination:2,estimatedDate:3})}}function lc(e,t,n){const o=e.slice();return o[17]=t[n],o}function cc(e){let t,n;return t=new Ti({props:{position:"bottom-center",isOpen:!1,$$slots:{content:[hc,({close:e})=>({15:e}),({close:e})=>e?32768:0],parent:[fc,({toggle:e})=>({16:e}),({toggle:e})=>e?65536:0]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};1147375&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function uc(t){let n;return{c(){n=R(t[2])},m(e,t){A(e,n,t)},p(e,t){4&t&&Z(n,e[2])},i:e,o:e,d(e){e&&F(n)}}}function dc(e){let t,n;return t=new jl({props:{position:e[5].map,date:e[1],$$slots:{default:[pc]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};32&n&&(o.position=e[5].map),2&n&&(o.date=e[1]),1048640&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function pc(e){let t;return{c(){t=R(e[6])},m(e,n){A(e,t,n)},p(e,n){64&n&&Z(t,e[6])},d(e){e&&F(t)}}}function mc(e){let t,n,o,r,s=e[17].type.includes("rise")?"↥":"↧",i=gl(e[17].date)+"";return{c(){t=D("p"),n=R(s),o=z(),r=R(i),U(t,"class","svelte-1udpnbx")},m(e,s){A(e,t,s),T(t,n),T(t,o),T(t,r)},p(e,t){128&t&&s!==(s=e[17].type.includes("rise")?"↥":"↧")&&Z(n,s),128&t&&i!==(i=gl(e[17].date)+"")&&Z(r,i)},d(e){e&&F(t)}}}function fc(e){let t,n,o,r,s,a,l,c,u;const d=[dc,uc],p=[];function m(e,t){return"moon"===e[2]?0:1}o=m(e),r=p[o]=d[o](e);let f=e[7].slice(0,3),h=[];for(let t=0;t<f.length;t+=1)h[t]=mc(lc(e,f,t));return{c(){t=D("div"),n=D("p"),r.c(),s=z(),a=D("div");for(let e=0;e<h.length;e+=1)h[e].c();U(n,"class","icon svelte-1udpnbx"),U(a,"class","details svelte-1udpnbx"),ee(a,"two",2===e[7].length),ee(a,"three",e[7].length>=3),U(t,"slot","parent"),U(t,"class","sun svelte-1udpnbx"),ee(t,"aurora",e[8].length>0)},m(r,d){A(r,t,d),T(t,n),p[o].m(n,null),T(t,s),T(t,a);for(let e=0;e<h.length;e+=1)h[e].m(a,null);l=!0,c||(u=W(t,"click",(function(){i(e[16])&&e[16].apply(this,arguments)})),c=!0)},p(s,i){let l=o;if(o=m(e=s),o===l?p[o].p(e,i):(Ae(),_e(p[l],1,1,(()=>{p[l]=null})),Fe(),r=p[o],r?r.p(e,i):(r=p[o]=d[o](e),r.c()),Ie(r,1),r.m(n,null)),128&i){let t;for(f=e[7].slice(0,3),t=0;t<f.length;t+=1){const n=lc(e,f,t);h[t]?h[t].p(n,i):(h[t]=mc(n),h[t].c(),h[t].m(a,null))}for(;t<h.length;t+=1)h[t].d(1);h.length=f.length}128&i&&ee(a,"two",2===e[7].length),128&i&&ee(a,"three",e[7].length>=3),256&i&&ee(t,"aurora",e[8].length>0)},i(e){l||(Ie(r),l=!0)},o(e){_e(r),l=!1},d(e){e&&F(t),p[o].d(),I(h,e),c=!1,u()}}}function hc(e){let t,n,o,r,s,a,l,c,u,d,p;return l=new ac({props:{departureSun:e[3],moonEmoji:e[6],estimatedDate:e[1],moonIllumination:e[0]}}),{c(){t=D("div"),n=D("h6"),o=D("span"),o.textContent="Éphémérides du vol",r=z(),s=D("button"),a=z(),Ge(l.$$.fragment),U(s,"type","button"),U(s,"class","btn-close ms-auto"),U(s,"aria-label","Close"),U(n,"class","card-header"),U(t,"slot","content"),V(t,"width","390px"),U(t,"class","overlay card")},m(c,m){A(c,t,m),T(t,n),T(n,o),T(n,r),T(n,s),T(t,a),He(l,t,null),u=!0,d||(p=W(s,"click",(function(){i(e[15])&&e[15].apply(this,arguments)})),d=!0)},p(t,n){e=t;const o={};8&n&&(o.departureSun=e[3]),64&n&&(o.moonEmoji=e[6]),2&n&&(o.estimatedDate=e[1]),1&n&&(o.moonIllumination=e[0]),l.$set(o)},i(e){u||(Ie(l.$$.fragment,e),c||xe((()=>{c=je(t,mt,{duration:200}),c.start()})),u=!0)},o(e){_e(l.$$.fragment,e),u=!1},d(e){e&&F(t),Be(l),d=!1,p()}}}function gc(e){let t,n,o,r;t=new nl({});let s=e[4]&&e[4].timeMatrix.length>0&&cc(e);return{c(){Ge(t.$$.fragment),n=z(),s&&s.c(),o=N()},m(e,i){He(t,e,i),A(e,n,i),s&&s.m(e,i),A(e,o,i),r=!0},p(e,[t]){e[4]&&e[4].timeMatrix.length>0?s?(s.p(e,t),16&t&&Ie(s,1)):(s=cc(e),s.c(),Ie(s,1),s.m(o.parentNode,o)):s&&(Ae(),_e(s,1,1,(()=>{s=null})),Fe())},i(e){r||(Ie(t.$$.fragment,e),Ie(s),r=!0)},o(e){_e(t.$$.fragment,e),_e(s),r=!1},d(e){Be(t,e),e&&F(n),s&&s.d(e),e&&F(o)}}}function vc(e,t,n){let o,r,s,i,a,l,c,u,d,m,f,h,g,v;p(e,Za,(e=>n(12,m=e))),p(e,Et,(e=>n(4,f=e))),p(e,At,(e=>n(13,h=e))),p(e,Ut,(e=>n(5,g=e))),p(e,Qa,(e=>n(8,v=e)));return e.$$.update=()=>{8208&e.$$.dirty&&n(3,o=f&&h?Ua.getState(h,f.departure,0):""),8208&e.$$.dirty&&n(11,r=f&&h?Ga.getState(h,f.departure,0):""),8240&e.$$.dirty&&n(1,s=h&&g?new Date(h.getTime()+6e4*g.reltime):h||f.infos.ofpOFF),4096&e.$$.dirty&&n(9,i=m.sun.filter((e=>["sunrise","sunset"].includes(e.type)))),6144&e.$$.dirty&&n(10,a=m.moon.length>0||r.state),1544&e.$$.dirty&&n(2,l=i.length>0?"☀️":((e,t)=>"day"===e.state?"☀️":t?"moon":"🔭")(o,a)),4612&e.$$.dirty&&n(7,c="☀️"===l?i:"moon"===l?m.moon:[]),2&e.$$.dirty&&n(0,u=s?za(s):{}),1&e.$$.dirty&&n(6,d=(e=>{const t=e.phase,n=e.fraction;return t&&n?n<=.02?"🌑":t<.5&&n<=.34?"🌒":t<.5&&n<=.65?"🌓":t<.5&&n<.97?"🌔":n>=.97?"🌕":t>=.5&&n>.65?"🌖":t>=.5&&n>.34?"🌗":"🌘":"☽"})(u))},[u,s,l,o,f,g,d,c,v,i,a,r,m,h]}class yc extends Ke{constructor(e){super(),Ze(this,e,vc,gc,a,{})}}function $c(e){let t,n,o,r;return{c(){t=D("video"),n=D("source"),c(n.src,o=e[1])||U(n,"src",o),U(n,"type","video/mp4"),t.controls=!0,U(t,"height","400"),U(t,"width","575"),U(t,"style",r=e[3](...e[0].split("\\n"))),U(t,"class","svelte-ie64bt")},m(e,o){A(e,t,o),T(t,n)},p(e,s){2&s&&!c(n.src,o=e[1])&&U(n,"src",o),1&s&&r!==(r=e[3](...e[0].split("\\n")))&&U(t,"style",r)},d(e){e&&F(t)}}}function bc(t){let n,o=t[2]&&$c(t);return{c(){o&&o.c(),n=N()},m(e,t){o&&o.m(e,t),A(e,n,t)},p(e,[t]){e[2]?o?o.p(e,t):(o=$c(e),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:e,o:e,d(e){o&&o.d(e),e&&F(n)}}}const xc=/[\r\n%#()<>?[\\\]^`{|}]/g;function wc(e,t,n){let o;p(e,Nt,(e=>n(2,o=e)));let{src:r}=t,{title:s}=t,{forcePreview:i=!0}=t;const a=new URL(r);return i&&(a.hash="t=0.001"),a.searchParams.set("dnd",1),e.$$set=e=>{"src"in e&&n(4,r=e.src),"title"in e&&n(0,s=e.title),"forcePreview"in e&&n(5,i=e.forcePreview)},[s,a,o,(e,t)=>`background-image: url("data:image/svg+xml,${`\n            <svg xmlns="http://www.w3.org/2000/svg" width="250" height="100" dominant-baseline="middle" text-anchor="middle" font-size="2rem">\n                <text x="0" y="0" style="currentColor">\n                    <tspan x="125" y="45">${e}</tspan>\n                    <tspan x="125" y="85">${t}</tspan>\n                </text>\n            </svg>\n        `.replace(/(?:(^\s+)|(\s+)$)/gmu," ").replace(/>\s+</gmu,"><").replace(/"/g,"'").trim().replace(xc,encodeURIComponent)}");`,r,i]}class kc extends Ke{constructor(e){super(),Ze(this,e,wc,bc,a,{src:4,title:0,forcePreview:5})}}function Cc(e,t,n){const o=e.slice();return o[3]=t[n][0],o[4]=t[n][1].url,o[5]=t[n][1].description,o[6]=t[n][1].version,o}function Pc(t){let n,o;return{c(){n=R(t[1]),o=R(".com")},m(e,t){A(e,n,t),A(e,o,t)},p:e,d(e){e&&F(n),e&&F(o)}}}function Lc(e){let t;return{c(){t=R("ce lien")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Mc(e){let t;return{c(){t=R("ogimet.com")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Sc(e){let t;return{c(){t=R("Guide d'interprétation")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Tc(t){let n,o,r,s=t[3]+"",i=t[6]+"";return{c(){n=R(s),o=R(" v"),r=R(i)},m(e,t){A(e,n,t),A(e,o,t),A(e,r,t)},p:e,d(e){e&&F(n),e&&F(o),e&&F(r)}}}function Ec(e){let t,n,o,r,s,i,a=e[5]+"";return n=new Ai({props:{href:e[4],$$slots:{default:[Tc]},$$scope:{ctx:e}}}),{c(){t=D("li"),Ge(n.$$.fragment),o=z(),r=R(a),s=z()},m(e,a){A(e,t,a),He(n,t,null),T(t,o),T(t,r),T(t,s),i=!0},p(e,t){const o={};512&t&&(o.$$scope={dirty:t,ctx:e}),n.$set(o)},i(e){i||(Ie(n.$$.fragment,e),i=!0)},o(e){_e(n.$$.fragment,e),i=!1},d(e){e&&F(t),Be(n)}}}function Oc(e){let t;return{c(){t=R("liste des commits")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Ac(e){let t;return{c(){t=R("Equal Earth")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Fc(t){let n,o;return{c(){n=R(t[1]),o=R(".com")},m(e,t){A(e,n,t),A(e,o,t)},p:e,d(e){e&&F(n),e&&F(o)}}}function Ic(e){let t;return{c(){t=R("l'app")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function _c(e){let t;return{c(){t=R("le proxy")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Dc(e){let t;return{c(){t=D("span"),t.innerHTML="Fly<span>Tax</span>",U(t,"class","flytax")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function jc(e){let t,n,o,r,s,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,w,k,C,P,L,M,S,E,O,_,j,N,W,q,G,H,B,Z,K,V,J,Y,Q,X,ee,te,ne,oe,re,se,ie,ae,le,ce,ue,de,pe,me,fe,he,ge,ve,ye,$e,be,xe,we,ke,Ce,Pe,Le,Me,Se,Te,Ee,Oe,De,je,Re,ze,Ne,We,qe,Ue,Ze,Ke,Ve,Je,Ye,Qe,Xe,et,tt,nt,ot,rt,st,it,at,lt,ct,ut,dt,pt,mt,ft,ht,gt,vt,yt,$t,bt,xt,wt,kt,Ct,Pt,Lt,Mt,St,Tt,Et,Ot,At,Ft,It,_t,Dt,jt,Rt,zt,Nt,Wt,qt,Ut,Gt,Ht,Bt,Zt,Kt,Vt,Jt,Yt,Qt,Xt,en,tn,nn,on,rn,sn,an,ln,cn,un,dn,pn,mn,fn,hn,gn,vn=window.atob("VmluY2VudCBCb3NzeQ==")+"";O=new Ai({props:{href:`https://www.${e[1].toLowerCase()}.com`,$$slots:{default:[Pc]},$$scope:{ctx:e}}});let yn=!0!==navigator.standalone&&function(e){let t,n,o,r;return n=new Ai({props:{href:"http://flyingeek.github.io/lido-online/index.html",$$slots:{default:[Lc]},$$scope:{ctx:e}}}),{c(){t=R("Pour mémoire, dans un navigateur, il suffit de partager l'url ou "),Ge(n.$$.fragment),o=R(".")},m(e,s){A(e,t,s),He(n,e,s),A(e,o,s),r=!0},i(e){r||(Ie(n.$$.fragment,e),r=!0)},o(e){_e(n.$$.fragment,e),r=!1},d(e){e&&F(t),Be(n,e),e&&F(o)}}}(e);oe=new Cs({props:{value:"0"}}),ue=new Cs({props:{value:"0"}}),ye=new Cs({props:{value:"33"}}),xe=new Cs({props:{value:"0"}}),je=new Ai({props:{href:e[0],$$slots:{default:[Mc]},$$scope:{ctx:e}}}),Ze=new Ai({props:{href:"http://www.ogimet.com/guia_gramet.phtml.en",$$slots:{default:[Sc]},$$scope:{ctx:e}}});let $n=Object.entries(Vi),bn=[];for(let t=0;t<$n.length;t+=1)bn[t]=Ec(Cc(e,$n,t));const xn=e=>_e(bn[e],1,1,(()=>{bn[e]=null}));return $t=new kc({props:{src:"https://p169.p3.n0.cdn.getcloudapp.com/items/KouJeA4l/42ec3a9e-a573-41cb-bd34-763da10c514c.mp4?source=client",title:"Utilisation\\nOFP2MAP-MENU"}}),St=new Ai({props:{href:"https://github.com/flyingeek/lido-online/commits/master",$$slots:{default:[Oc]},$$scope:{ctx:e}}}),zt=new Ai({props:{href:"https://equal-earth.com/physical/",$$slots:{default:[Ac]},$$scope:{ctx:e}}}),Ht=new Ai({props:{href:`https://www.${e[1].toLowerCase()}.com`,$$slots:{default:[Fc]},$$scope:{ctx:e}}}),on=new Ai({props:{href:"https://github.com/flyingeek/lido-online",$$slots:{default:[Ic]},$$scope:{ctx:e}}}),sn=new Ai({props:{href:"https://github.com/flyingeek/ofp2map-gramet",$$slots:{default:[_c]},$$scope:{ctx:e}}}),fn=new Ai({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[Dc]},$$scope:{ctx:e}}}),{c(){t=D("section"),t.innerHTML='<h2 id="md_préambule">Préambule</h2> \n<p>OFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l&#39;écran d&#39;accueil de l&#39;iPad. Initialement, simple convertisseur de l&#39;OFP en KML, OFP2MAP est devenu une vraie application de cartographie. OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.</p> \n<p>L&#39;OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l&#39;hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L&#39;app ne collecte aucune donnée.</p> \n<p>Avant d&#39;utiliser OFP2MAP en vol, il est préférable de lire la rubrique <a href="#_offline">Mode hors ligne</a>. Ensuite le mémo visuel devrait vous permettre de vous débrouiller. Vos retours seront appréciés pour faire évoluer l&#39;app.</p>',n=z(),o=D("section"),o.innerHTML='<h2 id="md_mémo-visuel">Mémo visuel</h2> \n<img style="display: block;" src="./images/map-help.webp" alt="mémo visuel" id="memovisuel" usemap="#memo-map"/> \n\n<map name="memo-map"><area alt="Choix projection" title="Choix projection" href="#_utilisation" coords="7,64,154,201" shape="rect"/> \n    <area alt="Mode hors ligne" title="Mode hors ligne" href="#_offline" coords="313,236,162,74" shape="rect"/> \n    <area alt="Éphémérides du vol" title="Éphémérides du vol" href="#_ephemerides" coords="369,108,368,180,545,175,547,109,639,69,692,69,693,26,632,27,621,59,529,105" shape="poly"/> \n    <area alt="GRAMET" title="GRAMET" href="#_gramet" coords="576,142,575,252,753,250,753,142,702,142,739,64,791,64,792,26,720,25,725,62,685,142" shape="poly"/> \n    <area alt="Position Estimée" title="Position Estimée" href="#_position" coords="820,25,821,137,790,136,791,240,874,247,879,146,938,142,926,90,898,88,903,26" shape="poly"/> \n    <area alt="GRAMET" title="GRAMET" href="#_gramet" coords="737,391,738,430,852,425,850,388" shape="poly"/> \n    <area alt="ETOPS" title="ETOPS" href="#_etops" coords="916,201,922,334,1021,310,1009,205,962,197,951,20,932,18,937,67,946,79,949,201" shape="poly"/> \n    <area alt="ETOPS" title="ETOPS" href="#_etops" coords="559,568,774,672" shape="rect"/> \n    <area alt="Export" title="Export" href="#_export" coords="163,35,227,60" shape="rect"/> \n    <area alt="Plugins" title="Plugins" href="#_plugins" coords="1023,26,1076,26,1076,66,1089,94,1084,127,967,125,964,95,1017,95" shape="poly"/> \n    <area alt="Réglages des calques" title="Réglages des calques" href="#_reglages_des_calques" coords="1152,76,1191,109" shape="rect"/> \n    <area alt="Réglages des calques" title="Réglages des calques" href="#_reglages_des_calques" coords="1048,245,1138,200" shape="rect"/> \n    <area alt="Position GPS" title="Position GPS" href="#_position" coords="1068,293,1180,382" shape="rect"/> \n    <area alt="Position GPS" title="Position GPS" href="#_position" coords="1155,117,1186,147" shape="rect"/> \n    <area alt="Réglages des calques" title="Réglages des calques" href="#_reglages_des_calques" coords="" shape="rect"/> \n    <area alt="Style terrains" title="Style terrains" href="#_reglages_des_calques" coords="88,541,232,638" shape="rect"/> \n    <area alt="Cycle AIRAC" title="Cycle AIRAC" href="#_updates" coords="1108,721,1190,779" shape="rect"/></map>',r=z(),s=D("section"),i=D("h2"),i.textContent="Utilisation",a=z(),l=D("ol"),c=D("li"),c.innerHTML="<p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner.</p>",u=z(),d=D("li"),p=D("p"),p.textContent=`La carte par défaut dépend de la distance: ${e[1]} 2020, puis Mercator jusqu'à 1500nm puis LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur d'autres projections :`,m=z(),f=D("ul"),h=D("li"),h.textContent="LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du 30N",g=z(),v=D("li"),v.textContent="LAMBERT SOUTH & PACIFIC (sécants N30 et S15 ) sont recommandées sous 30N",y=z(),$=D("li"),$.textContent="THE WORLD permet de disposer d'un Atlas off-line, c'est une projection Times",b=z(),x=D("li"),x.textContent="MERCATOR est une Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line",w=z(),k=D("li"),k.textContent="=Physique= est un Atlas physique basé sur une projection Equal Earth (qui montre les continents et les pays à leur taille réelle) avec des étiquettes en français (par Tom Patterson).",C=z(),P=D("li"),L=R(e[1]),M=R(" 2020 est une carte VFR, elle couvre France/Belgique/Luxembourg/Suisse et "),S=R(vn),E=R(" a autorisé son utilisation. Sur cette carte, déjà très dense en informations, la route Gramet, l'orthodromie et les FIR sont désactivées. La dernière version est disponible sur "),Ge(O.$$.fragment),_=R("."),j=z(),N=D("ol"),N.innerHTML='<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts.<br/><strong><span class="big">☞</span> Il est aussi possible de modifier l&#39;angle de vue en balayant de bas en haut avec deux doigts</strong>.</li>',W=z(),q=D("section"),G=D("h2"),G.textContent="Particularités de l'iPad",H=z(),B=D("p"),B.textContent="OFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut en mode portrait et en bas à gauche en mode paysage.",Z=z(),K=D("p"),V=R("Pour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. "),yn&&yn.c(),J=z(),Y=D("p"),Y.textContent="À noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",Q=z(),X=D("section"),ee=D("h2"),te=R("Mode hors ligne "),ne=D("span"),Ge(oe.$$.fragment),re=z(),se=D("p"),se.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.",ie=z(),ae=D("p"),le=R("Pour mettre rapidement en cache un vol, il existe à droite du sélecteur de carte, un bouton de mise en cache de la projection : "),ce=D("span"),Ge(ue.$$.fragment),de=R(". Ce bouton ne s'affiche que si la projection n'est pas encore dans le cache. Sur les cartes LAMBERT, THE WORLD, =Physique= et "),pe=R(e[1]),me=R(", il mettra en cache la totalité de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache et le niveau de détails sera limité à un zoom < 7."),fe=z(),he=D("p"),ge=R("Le bouton affiche la progression du téléchargement : "),ve=D("span"),Ge(ye.$$.fragment),$e=R(", puis il disparait une fois la projection en cache. En cas d'erreur, il affiche: "),be=D("span"),Ge(xe.$$.fragment),we=R(", et vous pouvez faire une nouvelle tentative."),ke=z(),Ce=D("p"),Ce.textContent=`Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent : 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH, 32Mo pour THE WORLD, 40Mo pour =Physique= et 40Mo pour ${e[1]}.`,Pe=z(),Le=D("section"),Le.innerHTML='<h2 id="md_réglages-des-calques-svelte-md-block-tag-91">Réglages des calques <svg><use xlink:href="#layers-symbol"></use></svg></h2> \n<p><figure><img src="./images/layers-settings.webp" alt="layers settings help"/><figcaption>Réglages des calques</figcaption></figure>La carte, en haut à droite, dispose d&#39;un bouton pour personnaliser les calques et les couleurs. Un calque contient un type d&#39;information, par exemple les cercles ETOPS, les FIR réglementées, les tracks, la route...\nIl est possible d&#39;afficher ou de masquer chaque calque en utilisant la coche qui précède son nom. La plupart des calques permettent de choisir la couleur et l&#39;opacité.</p> \n<p>Pour les aéroports (le type avion est déterminé dans l&#39;OFP), il est possible de choisir entre 4 styles:</p> \n<ul><li><strong>statuts</strong> reprend les couleurs du statut telles que définies dans le Manex C.</li> \n<li><strong>vert/rouge</strong> reprend le code couleur des Regional Planning Chart, il y ajoute le symbole <span style="color: #062DF8;">✚</span> pour les terrains de support médical.</li> \n<li><strong>bleu/vert/rouge</strong> permet de distinguer les adéquats de support médical par la couleur de l&#39;icône.</li> \n<li><strong>médical</strong> n&#39;affiche que les terrains de support médical</li></ul> \n<p>Pour information, le statut est aussi disponible en cliquant sur un terrain (popup).</p> \n<p>Trois boutons permettent la sauvegarde, la restauration ou un retour aux valeurs par défaut. Le bouton RESTAURER permet, après avoir fait des modifications temporaires (non sauvegardées), de revenir rapidement aux réglages précédents.</p> \n<blockquote><p>Pour vous entraîner, je vous recommande de modifier la couleur des terrains en vert/rouge sur LC ou bleu/vert/rouge sur MC, et de sauvegarder votre choix.</p></blockquote> \n<h3 id="md_mode-focus">Mode FOCUS </h3> \n<p>C&#39;est un mode pensé pour basculer rapidement sur d&#39;autres réglages pour un usage ponctuel. Par défaut le mode FOCUS n&#39;affiche que la route. Il s&#39;active en cliquant sur FOCUS dans le champ ROUTE. Pour quitter ce mode, réaffichez les réglages et cliquez à nouveau sur le bouton.</p> \n<p>Le mode FOCUS est personnalisable : Après avoir activé le mode MODE FOCUS, réaffichez les réglages et modifiez les à votre convenance. Lorsque vous quitterez le mode FOCUS, ce jeu de réglages sera sauvegardé séparément et il sera rechargé à la prochaine activation.</p> \n<p>Si nécessaire, un bouton permet de revenir aux valeurs par défaut.</p> \n<blockquote><p>Idées pour utiliser ce mode : changer la couleur de la route pour The World; avoir un jeu de réglages pour la présentation aux pax;...</p></blockquote>',Me=z(),Se=D("section"),Te=D("h2"),Te.textContent="GRAMET",Ee=z(),Oe=D("p"),De=R("Le GRAMET est un météogramme représentant le temps et l'espace. Il indique, en tout point de la route, et à l'heure de passage estimée, une coupe verticale de la météo prévue.\nLe GRAMET est réalisé par "),Ge(je.$$.fragment),Re=R(" à partir d'une route calculée. Il est possible d'afficher le GRAMET et sa route sur la carte. La route est particulièrement utile lors des vols océaniques car il n'y a aucune station en mer.\nPour construire la route du GRAMET, on utilise non pas les waypoints, mais au plus 21 stations météo (WMO). Il y a au total 13000 WMO dans le monde. Le GRAMET débute toujours à l'heure hh:00. Pour un decollage à 19h30, il débutera à 19h, pour un décollage à 19h31, il débutera à 20h. Pour les OFP anciens, c'est l'heure actuelle qui est envoyée. En mode déconnecté, OFP2MAP utilise la version du GRAMET qu'il a mis en cache pendant 48h. Après l'heure de décollage initialement prévue, vous pouvez forcer une mise à jour, soit en rechargeant l'ofp, soit en changeant brièvement de page."),ze=z(),Ne=D("p"),Ne.innerHTML='Pour afficher le Gramet, cliquez sur sa miniature dans la barre de menu. Pour afficher la route, direction le réglage des calques de la carte. Par défaut elle est affichée en bleu. En fonction de l&#39;heure de décollage (modifiable), le Gramet et sa miniature affichent la position avion. Avant l&#39;horaire prévu de décollage, un bouton play <span class="btn-simulator-play" style="font-size: 24px; line-height:24px; --stroke-width: 2px"></span> permet de lancer une animation.',We=z(),qe=D("p"),Ue=R("Pour mieux comprendre le GRAMET, je vous conseille son "),Ge(Ze.$$.fragment),Ke=R("."),Ve=z(),Je=D("blockquote"),Je.innerHTML='<p>Le site ogimet est indisponible lorsqu&#39;il met à jour ses données, cela intervient entre minuit et 3h (heure française). Par ailleurs, je suis limité à 10 secondes pour la durée d&#39;exécution du proxy, ce délai est un peu faible lorsqu&#39;ogimet est saturé (tranche 18h30-20h00) et cela peut entrainer des erreurs, cliquer sur <svg style="stroke: red; transform: rotate(180deg); height: 20px; width: 20px;"><use xlink:href="#info-symbol"></use></svg> vous affichera des consignes.</p>',Ye=z(),Qe=D("section"),Qe.innerHTML='<h2 id="md_position-estimée--gps">Position estimée / GPS</h2> \n<p>L&#39;avion dans la barre de menu <svg><use xlink:href="#takeoff-symbol"></use></svg> permet d&#39;afficher la position estimée <svg style="color: var(--plane-color)"><use xlink:href="#location-symbol"></use></svg> sur la route en prenant en compte les estimées de l&#39;OFP. En cas d&#39;erreur lors de reconnaissance des waypoints, la position sera basée sur un simple ratio horaire, merci de me transmettre l&#39;OFP dans ce cas (ce sera signalé par un avion rouge dans la barre de menu et par l&#39;absence des éphémérides). L&#39;heure de décollage est modifiable et permet d&#39;ajuster la position estimée à la minute près.</p> \n<p>La position estimée est affichée en permanence sur le GRAMET, la miniature du GRAMET et les timelines des éphémérides. Pour un OFP ancien, la position estimée sera toujours la destination.</p> \n<p>OFP2MAP peut aussi utiliser un GPS. En cliquant sur <svg><use xlink:href="#geolocate-symbol"></use></svg>, la position GPS <svg style="color: #1da1f2"><use xlink:href="#location-symbol"></use></svg> sera affichée sur la carte. Si la localisation GPS semble ne pas fonctionner (au sol ou en vol avec un gps externe), vérifiez que vous n&#39;avez pas désactivé la localisation dans iPad / Réglages / Confidentialité / Service de localisation / Sites Safari. Vous devez choisir «Lorsque l&#39;app est active» ou «Demander la prochaine fois». Le Bouton <svg><use xlink:href="#geolocate-symbol"></use></svg> a trois positions: OFF, ON centré, ON non centré. Si, dans la position ON centré, vous déplacez la carte, il passe en ON non centré. L&#39;appui suivant le repassera en ON centré. Un dernier appui le mettra sur OFF.</p> \n<blockquote><p>C&#39;est toujours la position estimée qui est utilisée pour les éphémérides</p></blockquote>',Xe=z(),et=D("section"),et.innerHTML='<h2 id="md_etops">ETOPS</h2> \n<p>La capacité ETOPS est determinée depuis l&#39;OFP et les cercles sont tracés. Un drapeau <span style="background-color: var(--bs-warning); padding: 0 3px; font-size: 9px;">ETOPS</span> apparait dans le pavé d&#39;information de l&#39;OFP si le carburant est limitatif (20mn, soit environ 2T de marge sur 777). Pour avoir plus d&#39;informations vous pouvez utiliser un <a href="#_plugins">plugin</a>.</p> \n<p>Les appuis ETOPS sont affichés avec l&#39;icône <span class="big" style="color: #FC2403FF;">▲</span> (dans la couleur des cercles ETOPS). Les adéquats d&#39;entrée et de sortie ETOPS avec le symbole <span class="big" style="color: #095;">▲</span> (dans la couleur des adéquats du style utilisé). La couleur des cercles des points d&#39;entrée et de sortie est celle de la route.</p>',tt=z(),nt=D("section"),nt.innerHTML='<h2 id="md_éphémérides-☀️🌘🔭">Éphémérides ☀️🌘🔭</h2> \n<figure><img src="./images/ephemerides.webp" alt="éphémerides exemple"/><figcaption>Exemple avec aurore boréale prévue</figcaption></figure> \n<p>Un clic sur le widget révèle les éphémérides avec 2 timelines. La première synthétise le jour et la nuit le long du vol ainsi que les zones favorables à l&#39;observation des aurores boréales. La seconde montre les prévisions de Kp. Le Kp permet de prédire les aurores boréales. Entre ces deux timelines, la Lune est un objet dynamique: l&#39;angle des cornes va se modifier en fonction de la position estimée et cet angle est indiqué pour les levers et les couchers. Pour le soleil, l&#39;aube nautique est indiquée, car ce n&#39;est pas tout à fait la nuit: en vol l&#39;horizon est partiellement discernable, et au sol on distingue encore le relief.</p> \n<p>Le symbole du widget est dynamique:</p> \n<ul><li>☀️ si le soleil est visible pendant le vol</li> \n<li>🌕🌖🌗🌘🌑🌒🌓🌔 si la lune est visible pendant le vol</li> \n<li>🔭 si vous restez dans le noir</li> \n<li>un <span class="aurora">halo vert</span> se superpose si les conditions sont favorables à l&#39;observation d&#39;aurores boréales</li></ul> \n<p><strong>Précision des calculs :</strong> si vous avez bien recalé la position estimée d&#39;OFP2MAP sur la carte (en modifiant l&#39;heure de décollage), la précision attendue est de ±2 min sous 72° de latitude et de 10 min au-delà. Pour la lune, on est plutôt sur une précision de ±5 min. Le calcul n&#39;est valable que pour la croisière, reportez vous à EWAS pour un calcul précis au départ ou à destination.</p> \n<p><strong>Correction d&#39;altitude :</strong> Si votre niveau de vol est différent de l&#39;OFP, appliquez une correction de 15s/1000ft pour le soleil. Exemple: FL OFP 400, FL réel 360, il faut ajouter 1min pour le lever, et soustraire 1min pour le coucher.</p> \n<p><details><summary>Cliquez ici pour afficher un rappel sur la chronologie des événements astronomiques</summary> \n<p>Pour le soleil:</p> \n<table class="table"><thead><tr><th>Angle</th><th>▲ Soleil levant</th><th>▼ Soleil couchant</th></tr></thead> \n<tbody><tr><td>-0.83°</td><td>↑ Lever du soleil (fin aube civile)</td><td>↓ Coucher du soleil (début crépuscule civil)</td></tr> \n<tr><td>-6°</td><td>↑ début aube civile (jour civil)</td><td>↓ fin du crépuscule civil (début nuit civile)</td></tr> \n<tr><td>-12°</td><td>↑ début aube nautique (jour nautique)</td><td>↓ fin du crépuscule nautique (début nuit nautique)</td></tr></tbody></table> \n<p>Et pour la lune:</p> \n<table class="table moon"><thead><tr><th>Jour</th><th>Nom</th><th>Hémisphère nord</th><th>Hémisphère sud</th></tr></thead> \n<tbody><tr><td>1</td><td>Nouvelle lune</td><td>🌑</td><td>🌑</td></tr> \n<tr><td></td><td>Premier croissant</td><td>🌒</td><td>🌘</td></tr> \n<tr><td>7</td><td>Premier quartier</td><td>🌓</td><td>🌗</td></tr> \n<tr><td></td><td>Lune gibbeuse croissante</td><td>🌔</td><td>🌖</td></tr> \n<tr><td>14</td><td>Pleine lune</td><td>🌕</td><td>🌕</td></tr> \n<tr><td></td><td>Lune gibbeuse décroissante</td><td>🌖</td><td>🌔</td></tr> \n<tr><td>21</td><td>Dernier quartier</td><td>🌗</td><td>🌓</td></tr> \n<tr><td></td><td>Dernier croissant</td><td>🌘</td><td>🌒</td></tr></tbody></table></details></p>',ot=z(),rt=D("section"),rt.innerHTML='<h2 id="md_export-kml">Export KML</h2> \n<p>La Page Export permet d&#39;exporter la route et les tracks au format KML, elle dispose de ses propres réglages pour générer le KML. Pour l&#39;export il est possible d&#39;ajouter des repères. Les repères sont utiles pour afficher des informations textuelles dans MapsMe ou Avenza. Le bouton «COMME CARTE» permet de récupérer les couleurs choisies pour la carte.</p> \n<p>Sur iPad, lors du téléchargement, l&#39;export des fichiers KML affiche une page un peu particulière, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share-symbol"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. Alternativement, vous pouvez utiliser , sur cette même page, « Options... » pour définir une app qui recevra les fichiers kml par défaut, puis utiliser Ouvrir dans « nom de l&#39;app ».</p> \n<p>Un raccourci peut être lancé depuis la page Export, il recevra les fichiers KML, la route Lido et le Gramet. Le nom du raccourci est modifiable, il faut que le raccourci soit installé avant de le lancer.</p>',st=z(),it=D("section"),at=D("h2"),at.textContent="Plugins 🧩",lt=z(),ct=D("p"),ct.textContent="Depuis le pavé d'informations du vol dans la barre de menu, il est possible de lancer un plugin. Les plugins sont des raccourcis qui doivent être installés au préalable.",ut=z(),dt=D("p"),dt.textContent='Installer le premier plugin est un peu compliqué : Il faut au préalable autoriser les raccourcis non fiables dans Réglages/Raccourcis (et ce après avoir lancé au moins un raccourci "fiable" depuis la Galerie).',pt=z(),mt=D("p"),mt.innerHTML="<strong>Liste des plugins :</strong>",ft=z(),ht=D("ul");for(let e=0;e<bn.length;e+=1)bn[e].c();gt=z(),vt=D("blockquote"),vt.innerHTML="<p>Je recommande d&#39;installer le plugin OFP2MAP-MENU, cliquez ensuite sur 🧩 pour afficher le menu contextuel. Faites défiler tout en bas, cliquez sur «Modifier les actions...», puis cherchez OFP2MAP-MENU dans la liste, cliquez sur le +, faites défiler jusqu&#39;en haut, vous pouvez ajuster la position puis cliquer sur OK. Une fois la liste fermée, vous pouvez faire défiler le menu contextuel précédent vers le haut et lancer OFP2MAP-MENU. Comme le rôle de ce plugin est d&#39;afficher les plugins installés dans un menu, vous venez de simplifier l&#39;accès à l&#39;ensemble des plugins.\nLa vidéo ci-dessous montre la manip si vous êtes online.</p>",yt=z(),Ge($t.$$.fragment),bt=z(),xt=D("section"),wt=D("h2"),wt.textContent="Mise à jour",kt=z(),Ct=D("p"),Ct.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",Pt=z(),Lt=D("p"),Mt=R("Après une mise à jour, les dernières nouveautés d'OFP2MAP s'affichent. Le bouton CHANGELOG en haut de cette page permet de consulter l'historique, et vous pouvez aussi consulter la "),Ge(St.$$.fragment),Tt=R(" sur GitHub. Je poste les nouveautés importantes dans Yammer/Mapsme et Teams/MyConcorde."),Et=z(),Ot=D("section"),At=D("h2"),At.textContent="Crédits 🙏",Ft=z(),It=D("ul"),_t=D("li"),_t.textContent="Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme",Dt=z(),jt=D("li"),Rt=R("=Physique= est une carte de Tom Patterson disponible sur "),Ge(zt.$$.fragment),Nt=z(),Wt=D("li"),qt=R("La dernière version de la carte "),Ut=R(e[1]),Gt=R(" est disponible sur le site "),Ge(Ht.$$.fragment),Bt=z(),Zt=D("li"),Zt.textContent="Les autres cartes sont de Jean-Baptiste Denizot forum Yammer/QGIS & Avenza Maps",Kt=z(),Vt=D("li"),Vt.textContent="Le GRAMET provient du site ogimet.com",Jt=z(),Yt=D("li"),Yt.textContent="Le site est développé en javascript à l'aide du framework SVELTE",Qt=z(),Xt=D("li"),Xt.textContent="La partie serveur (un proxy pour pouvoir récupérer l'image du GRAMET) est en python.",en=z(),tn=D("li"),nn=R("Eric Delord CDB 777 est l'auteur. Le code source est disponible sur GitHub pour "),Ge(on.$$.fragment),rn=R(" et "),Ge(sn.$$.fragment),an=z(),ln=D("p"),ln.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel. Le site est hébergé sur GitHub.",cn=z(),un=D("h3"),un.textContent="Liens",dn=z(),pn=D("ul"),mn=D("li"),Ge(fn.$$.fragment),hn=R(" une aide aux calculs des frais professionnels (même auteur)."),U(t,"id","_intro"),U(o,"id","_memovisuel"),U(i,"id","md_utilisation"),U(N,"start","3"),U(s,"id","_utilisation"),U(G,"id","md_particularités-de-lipad"),U(q,"id","_ipad"),U(ne,"class","cacheButton"),U(ee,"id","md_mode-hors-ligne-svelte-md-block-tag-11"),U(ce,"class","cacheButton"),U(ve,"class","cacheButton cacheProgress"),U(be,"class","cacheButton cacheError"),U(X,"id","_offline"),U(Le,"id","_reglages_des_calques"),U(Te,"id","md_gramet"),U(Se,"id","_gramet"),U(Qe,"id","_position"),U(et,"id","_etops"),U(nt,"id","_ephemerides"),U(rt,"id","_export"),U(at,"id","md_plugins-🧩"),U(it,"id","_plugins"),U(wt,"id","md_mise-à-jour"),U(xt,"id","_updates"),U(At,"id","md_crédits-🙏"),U(un,"id","md_liens"),U(Ot,"id","_credits")},m(e,F){A(e,t,F),A(e,n,F),A(e,o,F),A(e,r,F),A(e,s,F),T(s,i),T(s,a),T(s,l),T(l,c),T(l,u),T(l,d),T(d,p),T(d,m),T(d,f),T(f,h),T(f,g),T(f,v),T(f,y),T(f,$),T(f,b),T(f,x),T(f,w),T(f,k),T(f,C),T(f,P),T(P,L),T(P,M),T(P,S),T(P,E),He(O,P,null),T(P,_),T(s,j),T(s,N),A(e,W,F),A(e,q,F),T(q,G),T(q,H),T(q,B),T(q,Z),T(q,K),T(K,V),yn&&yn.m(K,null),T(q,J),T(q,Y),A(e,Q,F),A(e,X,F),T(X,ee),T(ee,te),T(ee,ne),He(oe,ne,null),T(X,re),T(X,se),T(X,ie),T(X,ae),T(ae,le),T(ae,ce),He(ue,ce,null),T(ae,de),T(ae,pe),T(ae,me),T(X,fe),T(X,he),T(he,ge),T(he,ve),He(ye,ve,null),T(he,$e),T(he,be),He(xe,be,null),T(he,we),T(X,ke),T(X,Ce),A(e,Pe,F),A(e,Le,F),A(e,Me,F),A(e,Se,F),T(Se,Te),T(Se,Ee),T(Se,Oe),T(Oe,De),He(je,Oe,null),T(Oe,Re),T(Se,ze),T(Se,Ne),T(Se,We),T(Se,qe),T(qe,Ue),He(Ze,qe,null),T(qe,Ke),T(Se,Ve),T(Se,Je),A(e,Ye,F),A(e,Qe,F),A(e,Xe,F),A(e,et,F),A(e,tt,F),A(e,nt,F),A(e,ot,F),A(e,rt,F),A(e,st,F),A(e,it,F),T(it,at),T(it,lt),T(it,ct),T(it,ut),T(it,dt),T(it,pt),T(it,mt),T(it,ft),T(it,ht);for(let e=0;e<bn.length;e+=1)bn[e].m(ht,null);T(it,gt),T(it,vt),T(it,yt),He($t,it,null),A(e,bt,F),A(e,xt,F),T(xt,wt),T(xt,kt),T(xt,Ct),T(xt,Pt),T(xt,Lt),T(Lt,Mt),He(St,Lt,null),T(Lt,Tt),A(e,Et,F),A(e,Ot,F),T(Ot,At),T(Ot,Ft),T(Ot,It),T(It,_t),T(It,Dt),T(It,jt),T(jt,Rt),He(zt,jt,null),T(It,Nt),T(It,Wt),T(Wt,qt),T(Wt,Ut),T(Wt,Gt),He(Ht,Wt,null),T(It,Bt),T(It,Zt),T(It,Kt),T(It,Vt),T(It,Jt),T(It,Yt),T(It,Qt),T(It,Xt),T(It,en),T(It,tn),T(tn,nn),He(on,tn,null),T(tn,rn),He(sn,tn,null),T(Ot,an),T(Ot,ln),T(Ot,cn),T(Ot,un),T(Ot,dn),T(Ot,pn),T(pn,mn),He(fn,mn,null),T(mn,hn),gn=!0},p(e,[t]){const n={};512&t&&(n.$$scope={dirty:t,ctx:e}),O.$set(n);const o={};1&t&&(o.href=e[0]),512&t&&(o.$$scope={dirty:t,ctx:e}),je.$set(o);const r={};if(512&t&&(r.$$scope={dirty:t,ctx:e}),Ze.$set(r),0&t){let n;for($n=Object.entries(Vi),n=0;n<$n.length;n+=1){const o=Cc(e,$n,n);bn[n]?(bn[n].p(o,t),Ie(bn[n],1)):(bn[n]=Ec(o),bn[n].c(),Ie(bn[n],1),bn[n].m(ht,null))}for(Ae(),n=$n.length;n<bn.length;n+=1)xn(n);Fe()}const s={};512&t&&(s.$$scope={dirty:t,ctx:e}),St.$set(s);const i={};512&t&&(i.$$scope={dirty:t,ctx:e}),zt.$set(i);const a={};512&t&&(a.$$scope={dirty:t,ctx:e}),Ht.$set(a);const l={};512&t&&(l.$$scope={dirty:t,ctx:e}),on.$set(l);const c={};512&t&&(c.$$scope={dirty:t,ctx:e}),sn.$set(c);const u={};512&t&&(u.$$scope={dirty:t,ctx:e}),fn.$set(u)},i(e){if(!gn){Ie(O.$$.fragment,e),Ie(yn),Ie(oe.$$.fragment,e),Ie(ue.$$.fragment,e),Ie(ye.$$.fragment,e),Ie(xe.$$.fragment,e),Ie(je.$$.fragment,e),Ie(Ze.$$.fragment,e);for(let e=0;e<$n.length;e+=1)Ie(bn[e]);Ie($t.$$.fragment,e),Ie(St.$$.fragment,e),Ie(zt.$$.fragment,e),Ie(Ht.$$.fragment,e),Ie(on.$$.fragment,e),Ie(sn.$$.fragment,e),Ie(fn.$$.fragment,e),gn=!0}},o(e){_e(O.$$.fragment,e),_e(yn),_e(oe.$$.fragment,e),_e(ue.$$.fragment,e),_e(ye.$$.fragment,e),_e(xe.$$.fragment,e),_e(je.$$.fragment,e),_e(Ze.$$.fragment,e),bn=bn.filter(Boolean);for(let e=0;e<bn.length;e+=1)_e(bn[e]);_e($t.$$.fragment,e),_e(St.$$.fragment,e),_e(zt.$$.fragment,e),_e(Ht.$$.fragment,e),_e(on.$$.fragment,e),_e(sn.$$.fragment,e),_e(fn.$$.fragment,e),gn=!1},d(e){e&&F(t),e&&F(n),e&&F(o),e&&F(r),e&&F(s),Be(O),e&&F(W),e&&F(q),yn&&yn.d(),e&&F(Q),e&&F(X),Be(oe),Be(ue),Be(ye),Be(xe),e&&F(Pe),e&&F(Le),e&&F(Me),e&&F(Se),Be(je),Be(Ze),e&&F(Ye),e&&F(Qe),e&&F(Xe),e&&F(et),e&&F(tt),e&&F(nt),e&&F(ot),e&&F(rt),e&&F(st),e&&F(it),I(bn,e),Be($t),e&&F(bt),e&&F(xt),Be(St),e&&F(Et),e&&F(Ot),Be(zt),Be(Ht),Be(on),Be(sn),Be(fn)}}}function Rc(e,t,n){let o,r;p(e,Et,(e=>n(2,r=e)));const s=window.atob("Q2FydGFCb3NzeQ==");return e.$$.update=()=>{4&e.$$.dirty&&n(0,o=r?r.ogimetData.url:"http://www.ogimet.com")},[o,s,r]}class zc extends Ke{constructor(e){super(),Ze(this,e,Rc,jc,a,{})}}function Nc(e,t,n){const o=e.slice();return o[3]=t[n][0],o[4]=t[n][1],o}function Wc(e,t,n){const o=e.slice();return o[7]=t[n][0],o[8]=t[n][1],o}function qc(e,t,n){const o=e.slice();return o[11]=t[n],o}function Uc(e){let t,n,o,r;function s(e,t){return(null==n||7&t)&&(n=!!e[3].match(nu)),n?Hc:Gc}let i=s(e,-1),a=i(e),l=Object.entries(e[4]),c=[];for(let t=0;t<l.length;t+=1)c[t]=Vc(Wc(e,l,t));return{c(){t=D("li"),a.c(),o=z();for(let e=0;e<c.length;e+=1)c[e].c();r=z(),U(t,"class","svelte-1komgcv")},m(e,n){A(e,t,n),a.m(t,null),T(t,o);for(let e=0;e<c.length;e+=1)c[e].m(t,null);T(t,r)},p(e,n){if(i===(i=s(e,n))&&a?a.p(e,n):(a.d(1),a=i(e),a&&(a.c(),a.m(t,o))),7&n){let o;for(l=Object.entries(e[4]),o=0;o<l.length;o+=1){const s=Wc(e,l,o);c[o]?c[o].p(s,n):(c[o]=Vc(s),c[o].c(),c[o].m(t,r))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}},d(e){e&&F(t),a.d(),I(c,e)}}}function Gc(e){let t,n,o=e[3]+"";return{c(){t=D("h2"),n=R(o),U(t,"class","svelte-1komgcv")},m(e,o){A(e,t,o),T(t,n)},p(e,t){7&t&&o!==(o=e[3]+"")&&Z(n,o)},d(e){e&&F(t)}}}function Hc(e){let t,n=ou(e[3])+"";return{c(){t=D("h2"),U(t,"class","svelte-1komgcv")},m(e,o){A(e,t,o),t.innerHTML=n},p(e,o){7&o&&n!==(n=ou(e[3])+"")&&(t.innerHTML=n)},d(e){e&&F(t)}}}function Bc(e){let t,n=Xc(e[8])+"";return{c(){t=D("div"),U(t,"class","item svelte-1komgcv")},m(e,o){A(e,t,o),t.innerHTML=n},p(e,o){7&o&&n!==(n=Xc(e[8])+"")&&(t.innerHTML=n)},d(e){e&&F(t)}}}function Zc(e){let t,n=e[8].raw.replace(/^\n\n|\n\n$/,"").split("\n"),o=[];for(let t=0;t<n.length;t+=1)o[t]=Kc(qc(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=N()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);A(e,t,n)},p(e,r){if(7&r){let s;for(n=e[8].raw.replace(/^\n\n|\n\n$/,"").split("\n"),s=0;s<n.length;s+=1){const i=qc(e,n,s);o[s]?o[s].p(i,r):(o[s]=Kc(i),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(e){I(o,e),e&&F(t)}}}function Kc(e){let t,n=Xc(e[11]).replace("- ",`- <span class="badge bg-${iu(e[7])} ${au(e[7])}">${tu(e[7])}</span>`)+"";return{c(){t=D("div"),U(t,"class","item svelte-1komgcv")},m(e,o){A(e,t,o),t.innerHTML=n},p(e,o){7&o&&n!==(n=Xc(e[11]).replace("- ",`- <span class="badge bg-${iu(e[7])} ${au(e[7])}">${tu(e[7])}</span>`)+"")&&(t.innerHTML=n)},d(e){e&&F(t)}}}function Vc(e){let t;function n(e,t){return"raw"!==e[7]?Zc:Bc}let o=n(e),r=o(e);return{c(){r.c(),t=N()},m(e,n){r.m(e,n),A(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&F(t)}}}function Jc(e){let t,n="raw"!==e[3]&&Uc(e);return{c(){n&&n.c(),t=N()},m(e,o){n&&n.m(e,o),A(e,t,o)},p(e,o){"raw"!==e[3]?n?n.p(e,o):(n=Uc(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&F(t)}}}function Yc(t){let n,o=Qc(t[0],{version:t[2],limit:t[1]}),r=[];for(let e=0;e<o.length;e+=1)r[e]=Jc(Nc(t,o,e));return{c(){n=D("ul");for(let e=0;e<r.length;e+=1)r[e].c();U(n,"class","markdown svelte-1komgcv")},m(e,t){A(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,[t]){if(7&t){let s;for(o=Qc(e[0],{version:e[2],limit:e[1]}),s=0;s<o.length;s+=1){const i=Nc(e,o,s);r[s]?r[s].p(i,t):(r[s]=Jc(i),r[s].c(),r[s].m(n,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=o.length}},i:e,o:e,d(e){e&&F(n),I(r,e)}}}const Qc=(e,{version:t,limit:n}={})=>{if(!e)return[];let o=Object.entries(e.CHANGELOG);return t&&(o=o.filter((([e])=>{const n=e.match(/\[([^\]]+)\]/);return!!n&&at(n[1],t)>0}))),n?o.slice(0,n+1):o};function Xc(e){return e.replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/\[(.*?)\]\((#.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2' rel='noreferrer' target='_blank'>$1</a>").replace(/^$/g,"<br />").trim()}const eu={ADDED:"Ajouté",FIXED:"Corrigé",DEPRECATED:"Obsolète",CHANGED:"Modifié",REMOVED:"Supprimé",SECURITY:"Sécurité"},tu=e=>eu[e.toUpperCase()]||e,nu=/\[([^\]]+)\].+(\d{4})-(\d{2})-(\d{2})/,ou=e=>e.replace(/\[([^\]]+)\].+(\d{4})-(\d{2})-(\d{2})/,"<span class='version'>$1</span> <span class='date'>$4/$3/$2</span>"),ru={ADDED:"primary",FIXED:"success",DEPRECATED:"warning",CHANGED:"info",REMOVED:"danger",SECURITY:"secondary"},su={ADDED:"text-white",FIXED:"text-white",DEPRECATED:"text-dark",CHANGED:"text-dark",REMOVED:"text-white",SECURITY:"text-white"},iu=e=>ru[e.toUpperCase()]||"light",au=e=>su[e.toUpperCase()]||"text-dark";function lu(e,t,n){let{data:o}=t,{limit:r}=t,{version:s}=t;return e.$$set=e=>{"data"in e&&n(0,o=e.data),"limit"in e&&n(1,r=e.limit),"version"in e&&n(2,s=e.version)},[o,r,s]}class cu extends Ke{constructor(e){super(),Ze(this,e,lu,Yc,a,{data:0,limit:1,version:2})}}function uu(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,k,C,P,L,M={ctx:e,current:null,token:null,hasCatch:!1,pending:mu,then:pu,catch:du,value:10,blocks:[,,,]};return ze(v=e[4],M),{c(){t=D("div"),n=D("div"),o=D("div"),r=D("div"),i=D("h5"),a=R(e[1]),l=z(),c=D("small"),u=D("input"),d=z(),p=D("label"),p.textContent="Afficher lors des mises à jour",m=z(),f=D("button"),h=z(),g=D("div"),M.block.c(),b=z(),x=D("div"),U(u,"id","display-on-update"),U(u,"class","form-check-input"),U(u,"type","checkbox"),U(p,"for","display-on-update"),U(p,"class","form-check-label"),U(c,"class","d-inline-block ms-4 form-check form-switch"),U(i,"class","modal-title"),U(f,"type","button"),U(f,"class","btn-close"),U(f,"data-dismiss","modal"),U(f,"aria-label","Close"),U(r,"class","modal-header"),U(g,"class","modal-body svelte-40kcd8"),ee(g,"expanded",!e[2]),U(o,"class","modal-content"),U(n,"class","modal-dialog modal-xl modal-dialog-centered"),U(n,"role","document"),U(t,"class","modal svelte-40kcd8"),U(t,"tabindex","-1"),U(t,"role","dialog"),U(x,"class","modal-backdrop show")},m(s,v){A(s,t,v),T(t,n),T(n,o),T(o,r),T(r,i),T(i,a),T(i,l),T(i,c),T(c,u),u.checked=e[5],T(c,d),T(c,p),T(r,m),T(r,f),T(o,h),T(o,g),M.block.m(g,M.anchor=null),M.mount=()=>g,M.anchor=null,A(s,b,v),A(s,x,v),C=!0,P||(L=[W(u,"change",e[7]),W(u,"change",e[8]),W(f,"click",e[3]),w(y=Zn.call(null,n)),W(n,"click_outside",e[3])],P=!0)},p(t,n){e=t,(!C||2&n)&&Z(a,e[1]),32&n&&(u.checked=e[5]),M.ctx=e,16&n&&v!==(v=e[4])&&ze(v,M)||function(e,t,n){const o=t.slice(),{resolved:r}=e;e.current===e.then&&(o[e.value]=r),e.current===e.catch&&(o[e.error]=r),e.block.p(o,n)}(M,e,n),4&n&&ee(g,"expanded",!e[2])},i(e){C||(Ie(M.block),$||xe((()=>{$=je(t,dt,{}),$.start()})),k||xe((()=>{k=je(x,dt,{}),k.start()})),C=!0)},o(e){for(let e=0;e<3;e+=1){_e(M.blocks[e])}C=!1},d(e){e&&F(t),M.block.d(),M.token=null,M=null,e&&F(b),e&&F(x),P=!1,s(L)}}}function du(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function pu(e){let t,n;return t=new cu({props:{data:e[10],version:e[2]}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};16&n&&(o.data=e[10]),4&n&&(o.version=e[2]),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function mu(t){let n;return{c(){n=D("p"),n.textContent="chargement..."},m(e,t){A(e,n,t)},p:e,i:e,o:e,d(e){e&&F(n)}}}function fu(e){let t,n,o=e[0]&&uu(e);return{c(){o&&o.c(),t=N()},m(e,r){o&&o.m(e,r),A(e,t,r),n=!0},p(e,[n]){e[0]?o?(o.p(e,n),1&n&&Ie(o,1)):(o=uu(e),o.c(),Ie(o,1),o.m(t.parentNode,t)):o&&(Ae(),_e(o,1,1,(()=>{o=null})),Fe())},i(e){n||(Ie(o),n=!0)},o(e){_e(o),n=!1},d(e){o&&o.d(e),e&&F(t)}}}const hu=gn.changelogOnUpdate,gu=()=>null===vn.getItem(hu)||!!vn.getItem(hu);function vu(e,t,n){const o=de();let r,{visible:s=!1}=t,{title:i="CHANGELOG"}=t,{version:a}=t,l=gu();const c=async()=>{n(0,s=!0),n(4,r=fetch("./CHANGELOG.json").then((e=>{if(e.ok)return e.json();throw new Error("CHANGELOG.json not available")})))};a&&l&&c();return e.$$set=e=>{"visible"in e&&n(0,s=e.visible),"title"in e&&n(1,i=e.title),"version"in e&&n(2,a=e.version)},[s,i,a,()=>{n(0,s=!1),o("close")},r,l,c,function(){l=this.checked,n(5,l)},()=>vn.setItem(hu,l)]}class yu extends Ke{constructor(e){super(),Ze(this,e,vu,fu,a,{visible:0,title:1,version:2,show:6,close:3})}get show(){return this.$$.ctx[6]}get close(){return this.$$.ctx[3]}}const{Map:$u,window:bu}=Ne;function xu(e,t,n){const o=e.slice();return o[24]=t[n].id,o[25]=t[n].html,o}function wu(e,t,n){const o=e.slice();return o[24]=t[n].id,o[28]=t[n].label,o}function ku(e,t){let n,o,r,s,i=t[28]+"";return{key:e,first:null,c(){n=D("option"),o=R(i),n.__value=r=t[24],n.value=n.__value,n.selected=s=t[24]===t[4],this.first=n},m(e,t){A(e,n,t),T(n,o)},p(e,o){t=e,144&o&&s!==(s=t[24]===t[4])&&(n.selected=s)},d(e){e&&F(n)}}}function Cu(e,t){let n,o,r,s,i=t[25]+"";return{key:e,first:null,c(){n=D("h2"),U(n,"data-id",o=t[24]),U(n,"class","svelte-uke1op"),ee(n,"selected",t[4]===t[24]),this.first=n},m(e,o){A(e,n,o),n.innerHTML=i,r||(s=W(n,"click",t[9]),r=!0)},p(e,o){t=e,144&o&&ee(n,"selected",t[4]===t[24])},d(e){e&&F(n),r=!1,s()}}}function Pu(t){let n,o,r,a,l,c,u,d,p,m,f,h,g,v,y,$,b,x,k,C,P,L,M,S,E,O,I,_,j,N=[],q=new $u,G=[],H=new $u;n=new yu({props:{}}),t[12](n);let B=!(!0!==navigator.standalone||!navigator.share)&&function(t){let n,o,r;return{c(){n=D("button"),n.innerHTML='<svg class="svelte-uke1op"><use xlink:href="#share-symbol"></use></svg>',U(n,"class","share btn btn-outline-secondary btn-sm svelte-uke1op")},m(e,t){A(e,n,t),o||(r=W(n,"click",lt),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}(),K=!0===navigator.standalone&&function(t){let n,o,r;return{c(){n=D("button"),U(n,"class","reload btn btn-outline-secondary btn-sm svelte-uke1op")},m(e,s){A(e,n,s),o||(r=W(n,"click",t[6]),o=!0)},p:e,d(e){e&&F(n),o=!1,r()}}}(t),V=t[7];const Y=e=>e[24];for(let e=0;e<V.length;e+=1){let n=wu(t,V,e),o=Y(n);q.set(o,N[e]=ku(o,n))}let Q=t[7];const X=e=>e[24];for(let e=0;e<Q.length;e+=1){let n=xu(t,Q,e),o=X(n);H.set(o,G[e]=Cu(o,n))}return O=new zc({}),{c(){Ge(n.$$.fragment),o=z(),r=D("div"),a=D("aside"),l=D("h1"),c=D("div"),u=D("div"),u.innerHTML='<img src="images/ofp2map-icons/icon-128x128.png" alt="logo" class="svelte-uke1op"/>',d=z(),p=D("div"),m=D("div"),m.textContent=`OFP2MAP v${Mu}`,f=D("small"),h=R("ServiceWorker : "),g=R(t[1]),v=z(),y=D("div"),B&&B.c(),$=z(),K&&K.c(),b=z(),x=D("button"),k=z(),C=D("select");for(let e=0;e<N.length;e+=1)N[e].c();P=z(),L=D("div");for(let e=0;e<G.length;e+=1)G[e].c();M=z(),S=D("div"),E=D("div"),Ge(O.$$.fragment),U(u,"class","app svelte-uke1op"),U(f,"class","svelte-uke1op"),U(p,"class","infos svelte-uke1op"),U(c,"class","appInfos svelte-uke1op"),U(x,"class","changelog btn btn-outline-secondary btn-sm svelte-uke1op"),U(y,"class","actions svelte-uke1op"),U(C,"class","toc form-select form-select-sm svelte-uke1op"),void 0===t[4]&&xe((()=>t[15].call(C))),U(l,"class","svelte-uke1op"),U(L,"class","toc svelte-uke1op"),U(a,"class","svelte-uke1op"),U(E,"class","markdown"),U(S,"class","scrollContainer svelte-uke1op"),U(r,"class","help svelte-uke1op")},m(e,s){He(n,e,s),A(e,o,s),A(e,r,s),T(r,a),T(a,l),T(l,c),T(c,u),T(c,d),T(c,p),T(p,m),T(p,f),T(f,h),T(f,g),T(l,v),T(l,y),B&&B.m(y,null),T(y,$),K&&K.m(y,null),T(y,b),T(y,x),T(l,k),T(l,C);for(let e=0;e<N.length;e+=1)N[e].m(C,null);t[14](C),J(C,t[4]),T(a,P),T(a,L);for(let e=0;e<G.length;e+=1)G[e].m(L,null);T(r,M),T(r,S),T(S,E),He(O,E,null),t[16](S),I=!0,_||(j=[W(bu,"resize",et(t[10],500)),W(f,"click",t[13],{once:!0}),W(x,"click",(function(){i(t[5].show)&&t[5].show.apply(this,arguments)})),W(C,"change",t[15]),W(C,"change",t[8]),w(Cn.call(null,C))],_=!0)},p(e,[o]){t=e;n.$set({}),(!I||2&o)&&Z(g,t[1]),!0===navigator.standalone&&navigator.share&&B.p(t,o),!0===navigator.standalone&&K.p(t,o),144&o&&(V=t[7],N=qe(N,o,Y,1,t,V,q,C,We,ku,null,wu)),144&o&&J(C,t[4]),656&o&&(Q=t[7],G=qe(G,o,X,1,t,Q,H,L,We,Cu,null,xu))},i(e){I||(Ie(n.$$.fragment,e),Ie(O.$$.fragment,e),I=!0)},o(e){_e(n.$$.fragment,e),_e(O.$$.fragment,e),I=!1},d(e){t[12](null),Be(n,e),e&&F(o),e&&F(r),B&&B.d(),K&&K.d();for(let e=0;e<N.length;e+=1)N[e].d();t[14](null);for(let e=0;e<G.length;e+=1)G[e].d();Be(O),t[16](null),_=!1,s(j)}}}const Lu=/^\/help_?/u,Mu="1.15.3";let Su="#memovisuel";function Tu(e,t,n){let o,r;p(e,Wt,(e=>n(11,o=e))),p(e,bt,(e=>n(0,r=e)));let s="";let i,a,l;const c=[];let u,d,m,f;const h=e=>{const t=e.offsetTop-i.offsetTop,n=Math.floor(i.scrollHeight-i.clientHeight);return i.scrollTop.toFixed()===t.toFixed()||i.scrollTop>=n&&t>=n};const g=e=>{if(!d||!u)return;e&&e.target.blur();const t=document.getElementById(d);t&&(h(t)?l&&l.reset():(m.disconnect(),l=function(e,t){const n=function(){h(e)&&t()};if(!h(e))return l&&l.reset(),i.addEventListener("scroll",n),i.scrollTo({top:e.offsetTop-i.offsetTop,behavior:"smooth"}),{reset:()=>{i.removeEventListener("scroll",n),l=void 0}}}(t,(()=>{u&&u.forEach((e=>{m.observe(e)})),l.reset()}))))},v=e=>{if(e)if(e.target)n(4,d=e.target.dataset.id);else{const t=decodeURI(e);if(t.startsWith("/help")){const e=t.replace("/help_","_");c&&c.map((e=>e.id)).includes(e)&&(n(4,d=e),f.close())}}!d&&c&&c.length>0&&n(4,d=c[0].id),d&&g()},y=()=>{document.querySelectorAll(Su).forEach((e=>{const t=e.clientWidth/e.naturalWidth,n=e.clientHeight/e.naturalHeight,o=parseFloat(window.getComputedStyle(e).getPropertyValue("padding-left")),r=parseFloat(window.getComputedStyle(e).getPropertyValue("padding-top"));document.querySelectorAll(`map[name="${e.useMap.substring(1)}"] area`).forEach((e=>{e.dataset.coords||(e.dataset.coords=e.coords);const s=e.dataset.coords.split(",").map(((e,s)=>(s%2==0?t*Number(e)+o:n*Number(e)+r).toFixed(0))).join(",");e.coords=s}))}))};ce((()=>{u=i.querySelectorAll(".markdown section[id]");const e=new Map;m=new IntersectionObserver((t=>{let o;t.forEach((t=>e.set(t.target.id,t.isIntersecting)));for(const[t,n]of e.entries())if(n){o=t;break}o&&n(4,d=o)}),{root:i,rootMargin:"0px",threshold:0}),u.forEach((e=>{const t=e.querySelector("h2:first-of-type");c.push({id:e.id,label:t.innerText,html:t.innerHTML}),m.observe(e)}));const t=e=>{e.preventDefault();const t=new URL(e.target.href);v(t.hash.replace("#_","/help_"))},r='a[href^="#_"], area[href^="#_"]';document.querySelectorAll(r).forEach((e=>e.addEventListener("click",t)));const s='.navbar-nav, .nav-link[href="#/help"]';return document.querySelectorAll(s).forEach((e=>e.addEventListener("click",v))),(e=>{const t=[];return document.querySelectorAll(e).forEach((e=>{if(!e.complete){const n=new Ve;e.onload=()=>n.resolve(e),e.onerror=()=>n.resolve(e),e.complete||t.push(n.promise)}})),Promise.all(t)})(Su).then((()=>{y()})).catch((e=>{})),be().then((()=>v(o))),()=>{m.disconnect(),document.querySelectorAll(s).forEach((e=>e.removeEventListener("click",v))),document.querySelectorAll(r).forEach((e=>e.removeEventListener("click",t))),l&&l.reset(),u=void 0,m=void 0}}));return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=r)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,s=e))),2048&e.$$.dirty&&v(o)},[r,s,i,a,d,f,()=>{window.location.hash="#/",window.location.reload()},c,g,v,y,o,function(e){fe[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},()=>r&&r.update()&&void 0,function(e){fe[e?"unshift":"push"]((()=>{a=e,n(3,a)}))},function(){d=Y(this),n(4,d),n(7,c)},function(e){fe[e?"unshift":"push"]((()=>{i=e,n(2,i)}))}]}class Eu extends Ke{constructor(e){super(),Ze(this,e,Tu,Pu,a,{})}}function Ou(e){let t,n,o,r;t=new ra({});let s="/map"===e[0]&&Au();return{c(){Ge(t.$$.fragment),n=z(),s&&s.c(),o=N()},m(e,i){He(t,e,i),A(e,n,i),s&&s.m(e,i),A(e,o,i),r=!0},p(e,t){"/map"===e[0]?s?1&t&&Ie(s,1):(s=Au(),s.c(),Ie(s,1),s.m(o.parentNode,o)):s&&(Ae(),_e(s,1,1,(()=>{s=null})),Fe())},i(e){r||(Ie(t.$$.fragment,e),Ie(s),r=!0)},o(e){_e(t.$$.fragment,e),_e(s),r=!1},d(e){Be(t,e),e&&F(n),s&&s.d(e),e&&F(o)}}}function Au(e){let t,n,o,r;return t=new la({}),n=new Ki({}),o=new yc({}),{c(){Ge(t.$$.fragment),Ge(n.$$.fragment),Ge(o.$$.fragment)},m(e,s){He(t,e,s),He(n,e,s),He(o,e,s),r=!0},i(e){r||(Ie(t.$$.fragment,e),Ie(n.$$.fragment,e),Ie(o.$$.fragment,e),r=!0)},o(e){_e(t.$$.fragment,e),_e(n.$$.fragment,e),_e(o.$$.fragment,e),r=!1},d(e){Be(t,e),Be(n,e),Be(o,e)}}}function Fu(e){let t,n,o,r;return{c(){t=D("li"),n=D("a"),n.innerHTML='<span class="svelte-ffp7di">CARTE</span>',U(n,"class","nav-link"),U(n,"href","#/map"),U(t,"class","nav-item svelte-ffp7di"),ee(t,"active","/map"===e[0])},m(s,i){A(s,t,i),T(t,n),o||(r=W(n,"click",e[5]),o=!0)},p(e,n){1&n&&ee(t,"active","/map"===e[0])},d(e){e&&F(t),o=!1,r()}}}function Iu(e){let t,n,o,r;return{c(){t=D("li"),n=D("a"),n.innerHTML='<span class="svelte-ffp7di">EXPORT</span>',U(n,"class","nav-link"),U(n,"href","#/export"),U(t,"class","nav-item svelte-ffp7di"),ee(t,"active","/export"===e[0])},m(s,i){A(s,t,i),T(t,n),o||(r=W(n,"click",e[5]),o=!0)},p(e,n){1&n&&ee(t,"active","/export"===e[0])},d(e){e&&F(t),o=!1,r()}}}function _u(e){let t,n,o,r=e[2].name+"";return{c(){t=D("small"),n=R("/"),o=R(r),U(t,"class","d-none d-lg-inline-block text-small-caps svelte-ffp7di")},m(e,r){A(e,t,r),T(t,n),T(t,o)},p(e,t){4&t&&r!==(r=e[2].name+"")&&Z(o,r)},d(e){e&&F(t)}}}function Du(e){let t,n,o,r,i,a,l,c,u,d,p,f,y,$,b,x,w,k,C,P,L,M,S,E,O;const I=e[7].default,_=m(I,e,e[6],null);let N=e[3]&&Ou(e),q=(e[3]||e[4]||"/map"===e[0])&&Fu(e),G=(e[3]||"/export"===e[0])&&Iu(e),B=e[2].name&&_u(e);return{c(){t=D("nav"),n=D("div"),o=D("input"),r=z(),_&&_.c(),i=z(),N&&N.c(),a=z(),l=D("label"),l.innerHTML='<span class="navbar-toggler-icon"></span>',c=z(),u=D("ul"),d=D("li"),p=D("a"),f=D("strong"),f.textContent="OFP2MAP ",y=j("svg"),$=j("use"),b=z(),q&&q.c(),x=z(),G&&G.c(),w=z(),k=D("li"),C=D("a"),P=D("span"),L=R("AIDE"),B&&B.c(),U(o,"type","checkbox"),U(o,"id","menu"),U(o,"class","svelte-ffp7di"),U(l,"class","navbar-toggler"),U(l,"for","menu"),U(f,"class","d-none"),H($,"xlink:href","#home-symbol"),U(y,"class","svelte-ffp7di"),U(p,"class","nav-link"),U(p,"href","#/"),U(d,"class","nav-item svelte-ffp7di"),ee(d,"active","/"===e[0]),U(P,"class","svelte-ffp7di"),U(C,"class","nav-link svelte-ffp7di"),U(C,"href",M=e[2].href),U(k,"class","nav-item svelte-ffp7di"),ee(k,"active",e[0].match(Lu)),U(u,"class","navbar-nav collapse navbar-collapse svelte-ffp7di"),U(u,"id","navbarToggler"),U(n,"class","container-fluid svelte-ffp7di"),U(t,"class","navbar navbar-expand-md navbar-light svelte-ffp7di")},m(s,m){A(s,t,m),T(t,n),T(n,o),e[8](o),T(n,r),_&&_.m(n,null),T(n,i),N&&N.m(n,null),T(n,a),T(n,l),T(n,c),T(n,u),T(u,d),T(d,p),T(p,f),T(p,y),T(y,$),T(u,b),q&&q.m(u,null),T(u,x),G&&G.m(u,null),T(u,w),T(u,k),T(k,C),T(C,P),T(P,L),B&&B.m(P,null),S=!0,E||(O=[W(p,"click",e[5]),W(C,"click",e[5])],E=!0)},p(e,[t]){_&&_.p&&(!S||64&t)&&g(_,I,e,e[6],S?h(I,e[6],t,null):v(e[6]),null),e[3]?N?(N.p(e,t),8&t&&Ie(N,1)):(N=Ou(e),N.c(),Ie(N,1),N.m(n,a)):N&&(Ae(),_e(N,1,1,(()=>{N=null})),Fe()),1&t&&ee(d,"active","/"===e[0]),e[3]||e[4]||"/map"===e[0]?q?q.p(e,t):(q=Fu(e),q.c(),q.m(u,x)):q&&(q.d(1),q=null),e[3]||"/export"===e[0]?G?G.p(e,t):(G=Iu(e),G.c(),G.m(u,w)):G&&(G.d(1),G=null),e[2].name?B?B.p(e,t):(B=_u(e),B.c(),B.m(P,null)):B&&(B.d(1),B=null),(!S||4&t&&M!==(M=e[2].href))&&U(C,"href",M),1&t&&ee(k,"active",e[0].match(Lu))},i(e){S||(Ie(_,e),Ie(N),S=!0)},o(e){_e(_,e),_e(N),S=!1},d(n){n&&F(t),e[8](null),_&&_.d(n),N&&N.d(),q&&q.d(),G&&G.d(),B&&B.d(),E=!1,s(O)}}}function ju(e,t,n){let o,r,s,i;p(e,Wt,(e=>n(0,r=e))),p(e,Et,(e=>n(3,s=e))),p(e,_t,(e=>n(4,i=e)));let a,{$$slots:l={},$$scope:c}=t;return e.$$set=e=>{"$$scope"in e&&n(6,c=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&n(2,o=(e=>{let t;switch(e){case"/map":t="#/help_memovisuel";break;case"/export":t="#/help_export";break;default:t="#/help"}return{name:"",href:encodeURI(t)}})(r))},[r,a,o,s,i,()=>n(1,a.checked=!1,a),c,l,function(e){fe[e?"unshift":"push"]((()=>{a=e,n(1,a)}))}]}class Ru extends Ke{constructor(e){super(),Ze(this,e,ju,Du,a,{})}}function zu(e,t,n){const o=e.slice();return o[17]=t[n],o}function Nu(t){let n,o,r,s,i;return{c(){n=D("label"),o=R("Changer"),r=D("input"),U(r,"id",Zu),U(r,"name",Zu),U(r,"type","file"),U(r,"accept","application/pdf"),r.hidden=!0,U(n,"class","btn btn-outline-secondary btn-sm svelte-zaok55")},m(e,a){A(e,n,a),T(n,o),T(n,r),s||(i=W(r,"change",t[4]),s=!0)},p:e,d(e){e&&F(n),s=!1,i()}}}function Wu(e){let t,n,o,r,i,a,l,c,u,d,p;return{c(){t=D("div"),n=D("span"),n.innerHTML='<span class="d-block d-sm-none">Choisir</span> \n            <span class="d-none d-sm-block">Choisir un OFP</span>',o=z(),r=D("label"),i=D("span"),i.textContent="OFP…",a=z(),l=D("span"),l.textContent="Sélectionner",c=z(),u=D("input"),U(n,"class","input-group-text svelte-zaok55"),U(i,"class","d-block d-sm-none"),U(l,"class","d-none d-sm-block"),U(u,"id",Zu),U(u,"name",Zu),U(u,"type","file"),U(u,"accept","application/pdf"),u.disabled=e[0],u.hidden=!0,U(r,"class","input-group-text btn btn-primary svelte-zaok55"),U(r,"for",Zu),U(t,"class","input-group svelte-zaok55"),ee(t,"blink",!e[2])},m(s,m){A(s,t,m),T(t,n),T(t,o),T(t,r),T(r,i),T(r,a),T(r,l),T(r,c),T(r,u),d||(p=[W(u,"change",e[4]),W(u,"click",e[3],{once:!0})],d=!0)},p(e,n){1&n&&(u.disabled=e[0]),4&n&&ee(t,"blink",!e[2])},d(e){e&&F(t),d=!1,s(p)}}}function qu(e){let t,n,o,r,i,a,l=yt.filter(e[8]),c=[];for(let t=0;t<l.length;t+=1)c[t]=Uu(zu(e,l,t));return{c(){t=D("div"),n=D("select"),o=D("option"),r=R("pas d'ofp ?");for(let e=0;e<c.length;e+=1)c[e].c();o.__value=void 0,o.value=o.__value,U(n,"class","form-control-sm svelte-zaok55"),n.disabled=e[0],U(t,"class","footer svelte-zaok55")},m(s,l){A(s,t,l),T(t,n),T(n,o),T(o,r);for(let e=0;e<c.length;e+=1)c[e].m(n,null);i||(a=[W(n,"click",e[3],{once:!0}),W(n,"change",e[5])],i=!0)},p(e,t){if(0&t){let o;for(l=yt.filter(e[8]),o=0;o<l.length;o+=1){const r=zu(e,l,o);c[o]?c[o].p(r,t):(c[o]=Uu(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}1&t&&(n.disabled=e[0])},d(e){e&&F(t),I(c,e),i=!1,s(a)}}}function Uu(t){let n,o,r,s=t[17]+"";return{c(){n=D("option"),o=R(s),n.__value=r=t[17],n.value=n.__value},m(e,t){A(e,n,t),T(n,o)},p:e,d(e){e&&F(n)}}}function Gu(t){let n,o,r,s;function i(e,t){return e[2]?Nu:Wu}let a=i(t),l=a(t),c=!t[2]&&!t[1]&&qu(t);return{c(){n=D("form"),l.c(),o=z(),c&&c.c(),U(n,"class","form-inline")},m(e,i){A(e,n,i),l.m(n,null),T(n,o),c&&c.m(n,null),r||(s=W(n,"submit",q(t[7])),r=!0)},p(e,[t]){a===(a=i(e))&&l?l.p(e,t):(l.d(1),l=a(e),l&&(l.c(),l.m(n,o))),e[2]||e[1]?c&&(c.d(1),c=null):c?c.p(e,t):(c=qu(e),c.c(),c.m(n,null))},i:e,o:e,d(e){e&&F(n),l.d(),c&&c.d(),r=!1,s()}}}const Hu=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.6.12.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.6.12.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"script",url:"https://unpkg.com/pinch-zoom-element-js@1.1.2/dist/pinch-zoom-min.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],Bu=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join(1===t?" ":"")};let Zu="file";function Ku(e,t,n){let o,r,s,i,a;p(e,Ot,(e=>n(11,o=e))),p(e,It,(e=>n(1,r=e))),p(e,Et,(e=>n(2,s=e))),p(e,At,(e=>n(12,i=e))),p(e,Lt,(e=>n(13,a=e)));let l,{kmlOptions:c}=t,u=!1,d=new Ve;const m=de();function f(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,i=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(i.crossOrigin="anonymous");let a=!0;s?(i.src=t,i.async=n.async,i.defer=n.defer):(i.href=t,"prefetch"in n?(i.rel="prefetch",o-=1,a=!1):"preload"in n?(i.rel="preload",o-=1,a=!1):(i.rel="stylesheet",o-=1,a=!1)),a&&(i.onload=r),document.body.appendChild(i)}))}(Hu,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",l&&!l.destroyed||(l=new e.PDFWorker),d.resolve(!0)}))}const h=e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onload=e=>{if(!l||l.destroyed){const e=window["pdfjs-dist/build/pdf"];l=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Bu(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;(t.includes("FPL SUMMARY")||t.includes("CREW PAIRING"))&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:l}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const s=editolido.ogimetData(t,r);s.proxyImg=`https://ofp2map-gramet.vercel.app/api/${s.proxy}__${s.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,s.route.description=s.wmo.join(" "),t.ogimetData=s;let i=0,a=t.infos.averageFL;const l=t.route.segments.map((([e,t])=>(i+=e.distanceTo(t),[t,i,a])));l.unshift([t.route.points[0],0]),t.distanceMatrix=l;let u=[];try{u=t.wptNamesEET(t.route.points)}catch(e){}0===u.length?document.body.style.setProperty("--plane-halo-color","red"):document.body.style.setProperty("--plane-halo-color","var(--plane-color)"),t.timeMatrix=u,t.departure=t.route.points[0],t.arrival=t.route.points[t.route.points.length-1];try{en(),function(e,t){let n={...Qt,...t};const o=en();Xt(o,n);const r=e.description;if(o.setName(r),!e)return;const s=`${e.infos.depICAO}-${e.infos.destICAO}`,i=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),a=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),l=new editolido.Route([i.points[0],i.points[i.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",i),o.addPoints("rmain",i,{excluded:c}),o.addLine("ralt",a),o.addPoints("ralt",a)}(t,c),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error("OFP non reconnu. Attention il y a 2 OFP dans PilotMission, il faut bien choisir celui nommé « Dossier de vol OFP »."))}),(e=>{o(e)}))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(6,c=e.kmlOptions)},[u,r,s,f,async function(e){n(0,u=!0),x(Lt,a=!1,a),f(),await d.promise.then((()=>{const t=e.target.files[0],n=e.target.closest("form");t&&(x(Ot,o="loading",o),m("change","Choisir un OFP"),window.location.hash="#/map",h(t).then((t=>{x(Et,s=t,s),x(It,r=void 0,r),x(Ot,o="success",o),x(At,i=new Date(t.infos.ofpOFF.getTime()),i),n.blur(),e.target.blur()})).catch((e=>{x(Ot,o=e,o),x(Et,s=void 0,s)})).finally((()=>{n.reset()})))})),n(0,u=!1)},async function(e){n(0,u=!0),x(Ot,o="loading",o),f(),await d.promise.then((()=>{x(Et,s=void 0,s);try{en(),x(It,r=e.target.value,r),x(Ot,o="success",o)}catch(e){x(Ot,o=e,o)}window.location.hash="#/map"})),n(0,u=!1)},c,function(t){pe.call(this,e,t)},e=>!$t.includes(e)]}class Vu extends Ke{constructor(e){super(),Ze(this,e,Ku,Gu,a,{kmlOptions:6})}}function Ju(e){let t,n,o,r;const s=e[4].default,i=m(s,e,e[3],null);return{c(){t=D("page"),i&&i.c(),U(t,"style",n=e[1]?`max-width: ${e[1]}; align-self: center;`:""),U(t,"class","svelte-1de5e3b"),ee(t,"fadein",!1===e[0]),ee(t,"d-none",!0===e[0])},m(e,n){A(e,t,n),i&&i.m(t,null),r=!0},p(e,[o]){i&&i.p&&(!r||8&o)&&g(i,s,e,e[3],r?h(s,e[3],o,null):v(e[3]),null),(!r||2&o&&n!==(n=e[1]?`max-width: ${e[1]}; align-self: center;`:""))&&U(t,"style",n),1&o&&ee(t,"fadein",!1===e[0]),1&o&&ee(t,"d-none",!0===e[0])},i(n){r||(Ie(i,n),o||xe((()=>{o=je(t,e[2],{}),o.start()})),r=!0)},o(e){_e(i,e),r=!1},d(e){e&&F(t),i&&i.d(e)}}}function Yu(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t,{maxWidth:i}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"maxWidth"in e&&n(1,i=e.maxWidth),"$$scope"in e&&n(3,r=e.$$scope)},[s,i,(e,t,n)=>{if(void 0===s)return dt(e,t)},r,o]}class Qu extends Ke{constructor(e){super(),Ze(this,e,Yu,Ju,a,{hidden:0,maxWidth:1})}}function Xu(t){let n,o;return n=new yu({props:{version:t[5](),title:"NOUVEAUTÉS"}}),n.$on("close",t[6]),{c(){Ge(n.$$.fragment)},m(e,t){He(n,e,t),o=!0},p:e,i(e){o||(Ie(n.$$.fragment,e),o=!0)},o(e){_e(n.$$.fragment,e),o=!1},d(e){Be(n,e)}}}function ed(e){let t,n,o,r,i,a,l,c,u,d,p,m,f,h,g,v,y,$,b;return{c(){t=D("div"),n=D("div"),o=D("div"),r=D("h6"),i=D("span"),i.innerHTML="<span>👨🏻‍✈️</span> Mise à jour disponible",a=z(),l=D("button"),c=z(),u=D("div"),d=D("p"),d.textContent="Il faudra recharger l'OFP",p=z(),m=D("button"),f=D("span"),h=R(e[1]),U(i,"class","modal-title text-center"),U(l,"type","button"),U(l,"class","btn-close"),U(l,"data-bs-dismiss","modal"),U(l,"aria-label","Close"),U(r,"class","modal-header pt-2 pb-2 svelte-8a5ine"),U(f,"class","svelte-8a5ine"),ee(f,"blinking",e[1].endsWith("...")),U(m,"class","btn btn-primary"),U(m,"type","button"),U(u,"class","modal-body text-center"),U(o,"class","modal-content"),U(n,"class","modal-dialog"),V(n,"position","absolute"),V(n,"top","0"),V(n,"right","1rem"),V(n,"max-width","350px"),U(t,"class","modal svelte-8a5ine"),U(t,"tabindex","-1")},m(s,g){A(s,t,g),T(t,n),T(n,o),T(o,r),T(r,i),T(r,a),T(r,l),T(o,c),T(o,u),T(u,d),T(u,p),T(u,m),T(m,f),T(f,h),y=!0,$||(b=[W(l,"click",e[11]),W(m,"click",e[12],{once:!0})],$=!0)},p(e,t){(!y||2&t)&&Z(h,e[1]),2&t&&ee(f,"blinking",e[1].endsWith("..."))},i(e){y||(xe((()=>{g||(g=Re(n,dt,{},!0)),g.run(1)})),xe((()=>{v||(v=Re(t,dt,{},!0)),v.run(1)})),y=!0)},o(e){g||(g=Re(n,dt,{},!1)),g.run(0),v||(v=Re(t,dt,{},!1)),v.run(0),y=!1},d(e){e&&F(t),e&&g&&g.end(),e&&v&&v.end(),$=!1,s(b)}}}function td(t){let n,o,r,i,a,l,c,u,d,p,m,f,h,g,v=(t[8](700)||"")+"";return{c(){n=D("div"),o=D("div"),r=D("div"),i=D("h6"),a=D("span"),a.innerHTML="<span>👨🏻‍✈️</span> Mise à jour détectée",l=z(),c=D("button"),u=z(),d=D("div"),p=D("button"),p.innerHTML="<span>Mise à jour...</span>",m=z(),f=R(v),U(a,"class","modal-title"),U(c,"type","button"),U(c,"class","btn-close"),U(c,"data-bs-dismiss","modal"),U(c,"aria-label","Close"),U(i,"class","modal-header text-center svelte-8a5ine"),U(p,"class","btn"),U(p,"type","button"),U(d,"class","modal-body text-center"),U(r,"class","modal-content"),U(o,"class","modal-dialog"),V(o,"margin-top","15%"),V(o,"max-width","270px"),U(n,"class","modal svelte-8a5ine"),U(n,"tabindex","-1")},m(e,s){A(e,n,s),T(n,o),T(o,r),T(r,i),T(i,a),T(i,l),T(i,c),T(r,u),T(r,d),T(d,p),T(n,m),A(e,f,s),h||(g=[W(c,"click",t[10]),W(p,"click",q(t[9]))],h=!0)},p:e,i:e,o:e,d(e){e&&F(n),e&&F(f),h=!1,s(g)}}}function nd(e){let t,n,o,r,s;const i=[td,ed,Xu],a=[];function l(e,n){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:(24&n&&(t=!(e[3]||!e[7]()||"/install"===e[4]||!gu())),t?2:-1):0}return~(n=l(e,-1))&&(o=a[n]=i[n](e)),{c(){o&&o.c(),r=N()},m(e,t){~n&&a[n].m(e,t),A(e,r,t),s=!0},p(e,[t]){let s=n;n=l(e,t),n===s?~n&&a[n].p(e,t):(o&&(Ae(),_e(a[s],1,1,(()=>{a[s]=null})),Fe()),~n?(o=a[n],o?o.p(e,t):(o=a[n]=i[n](e),o.c()),Ie(o,1),o.m(r.parentNode,r)):o=null)},i(e){s||(Ie(o),s=!0)},o(e){_e(o),s=!1},d(e){~n&&a[n].d(e),e&&F(r)}}}const od=gt(),rd=e=>{wt.set(!0),xt.set(!1),e?kt.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.15.3",e)):kt.set(!0)},sd="previousAppVersion";function id(t,n,o){let r,s,i,a,l,c=e;p(t,od,(e=>o(13,r=e))),p(t,bt,(e=>o(14,s=e))),p(t,xt,(e=>o(2,i=e))),p(t,wt,(e=>o(3,a=e))),p(t,Wt,(e=>o(4,l=e))),t.$$.on_destroy.push((()=>c()));let u="Installer";const d=()=>sessionStorage?sessionStorage.getItem(sd):void 0;x(xt,i=!1,i);let{prompt:m=!1}=n;const f=(e=0)=>{let t;s&&r&&r.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,u="En cours..."),d()&&gu()||sessionStorage&&sessionStorage.setItem(sd,"1.15.3"),r.waiting.postMessage({type:"SKIP_WAITING"}),setTimeout((()=>{window.location.reload()}),5e3)):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,m=e.prompt)},[m,u,i,a,l,d,()=>sessionStorage?sessionStorage.removeItem(sd):void 0,()=>{const e=d();return!!e&&at("1.15.3",e)>0},f,function(e){pe.call(this,t,e)},()=>x(xt,i=!0,i),()=>x(xt,i=!0,i),()=>f()]}class ad extends Ke{constructor(e){super(),Ze(this,e,id,nd,a,{prompt:0})}}function ld(e){let t;return{c(){t=D("ol"),t.innerHTML='<li class="svelte-1u14k7c">Dans la barre de menu, cliquez sur <svg class="svelte-1u14k7c"><use xlink:href="#share-symbol"></use></svg></li> \n                    <li class="svelte-1u14k7c">Faites défiler, choisir : <em>Sur l&#39;écran d&#39;accueil</em>  <svg style="width:22px;height:22px;" class="svelte-1u14k7c"><use xlink:href="#add2home-symbol"></use></svg></li> \n                    <li class="svelte-1u14k7c">Lancez l&#39;application depuis l&#39;écran d&#39;accueil</li>',U(t,"class","guide svelte-1u14k7c")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function cd(e){let t;return{c(){t=D("p"),t.textContent="Merci d'ouvrir cette page dans Safari",U(t,"class","guide error svelte-1u14k7c")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function ud(t){let n,o,r,s,i,a,l,c,u,d,p,m,f,h;n=new Lo({});let g=function(e,t){return e[0]?ld:cd}(t)(t);return f=new ad({}),{c(){Ge(n.$$.fragment),o=z(),r=D("div"),s=D("div"),i=D("div"),i.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-1u14k7c"/>',a=z(),l=D("div"),c=D("h3"),c.textContent="Installez OFP2MAP",u=z(),d=D("p"),d.innerHTML='Si OFP2MAP est déjà sur l&#39;écran d&#39;accueil, ne l&#39;installez pas une deuxième fois. <b>Attention:</b> l&#39;installation ne peut se faire que depuis\n                le navigateur Safari, <b>si présent, cliquez sur <svg class="safari svelte-1u14k7c"><use xlink:href="#safari-symbol"></use></svg> en haut à droite</b>.',p=z(),g.c(),m=z(),Ge(f.$$.fragment),U(i,"class","icon-container svelte-1u14k7c"),U(c,"class","title svelte-1u14k7c"),U(d,"class","text svelte-1u14k7c"),U(l,"class","prompt-content svelte-1u14k7c"),U(s,"class","prompt svelte-1u14k7c"),U(r,"class","prompt-container svelte-1u14k7c")},m(e,t){He(n,e,t),A(e,o,t),A(e,r,t),T(r,s),T(s,i),T(s,a),T(s,l),T(l,c),T(l,u),T(l,d),T(l,p),g.m(l,null),A(e,m,t),He(f,e,t),h=!0},p:e,i(e){h||(Ie(n.$$.fragment,e),Ie(f.$$.fragment,e),h=!0)},o(e){_e(n.$$.fragment,e),_e(f.$$.fragment,e),h=!1},d(e){Be(n,e),e&&F(o),e&&F(r),g.d(),e&&F(m),Be(f,e)}}}function dd(e){return[Qe&&!Ye]}class pd extends Ke{constructor(e){super(),Ze(this,e,dd,ud,a,{})}}function md(e){let t,n,o,r,s,i,a,l,c;t=new Ru({props:{$$slots:{default:[hd]},$$scope:{ctx:e}}}),o=new ad({props:{prompt:!!e[4]}});let u=(e[4]||e[5])&&"success"===e[3]&&gd(e);const d=[kd,wd,xd,bd,$d,yd],p=[];function m(e,t){return"loading"===e[3]?0:e[3]&&"success"!==e[3]&&"/map"===e[0]?1:"/export"===e[0]&&"success"===e[3]?2:"/"===e[0]?3:e[2]?4:!e[4]&&!e[5]||"/map"!==e[0]?5:-1}return~(i=m(e))&&(a=p[i]=d[i](e)),{c(){Ge(t.$$.fragment),n=z(),Ge(o.$$.fragment),r=z(),u&&u.c(),s=z(),a&&a.c(),l=N()},m(e,a){He(t,e,a),A(e,n,a),He(o,e,a),A(e,r,a),u&&u.m(e,a),A(e,s,a),~i&&p[i].m(e,a),A(e,l,a),c=!0},p(e,n){const r={};8194&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};16&n&&(c.prompt=!!e[4]),o.$set(c),(e[4]||e[5])&&"success"===e[3]?u?(u.p(e,n),56&n&&Ie(u,1)):(u=gd(e),u.c(),Ie(u,1),u.m(s.parentNode,s)):u&&(Ae(),_e(u,1,1,(()=>{u=null})),Fe());let f=i;i=m(e),i===f?~i&&p[i].p(e,n):(a&&(Ae(),_e(p[f],1,1,(()=>{p[f]=null})),Fe()),~i?(a=p[i],a?a.p(e,n):(a=p[i]=d[i](e),a.c()),Ie(a,1),a.m(l.parentNode,l)):a=null)},i(e){c||(Ie(t.$$.fragment,e),Ie(o.$$.fragment,e),Ie(u),Ie(a),c=!0)},o(e){_e(t.$$.fragment,e),_e(o.$$.fragment,e),_e(u),_e(a),c=!1},d(e){Be(t,e),e&&F(n),Be(o,e),e&&F(r),u&&u.d(e),e&&F(s),~i&&p[i].d(e),e&&F(l)}}}function fd(t){let n,o;return n=new pd({}),{c(){Ge(n.$$.fragment)},m(e,t){He(n,e,t),o=!0},p:e,i(e){o||(Ie(n.$$.fragment,e),o=!0)},o(e){_e(n.$$.fragment,e),o=!1},d(e){Be(n,e)}}}function hd(e){let t,n;return t=new Vu({props:{kmlOptions:e[1]}}),t.$on("change",e[7]),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.kmlOptions=e[1]),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function gd(e){let t,n;return t=new Qu({props:{hidden:"/map"!==e[0],$$slots:{default:[vd]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),8211&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function vd(e){let t,n,o;function r(t){e[8](t)}let s={id:"map",ofp:e[4]};return void 0!==e[1]&&(s.kmlOptions=e[1]),t=new pi({props:s}),fe.push((()=>Ue(t,"kmlOptions",r))),t.$on("save",e[9]),{c(){Ge(t.$$.fragment)},m(e,n){He(t,e,n),o=!0},p(e,o){const r={};16&o&&(r.ofp=e[4]),!n&&2&o&&(n=!0,r.kmlOptions=e[1],we((()=>n=!1))),t.$set(r)},i(e){o||(Ie(t.$$.fragment,e),o=!0)},o(e){_e(t.$$.fragment,e),o=!1},d(e){Be(t,e)}}}function yd(t){let n,o=(t[6](t[0])||"")+"";return{c(){n=R(o)},m(e,t){A(e,n,t)},p(e,t){1&t&&o!==(o=(e[6](e[0])||"")+"")&&Z(n,o)},i:e,o:e,d(e){e&&F(n)}}}function $d(e){let t,n;return t=new Qu({props:{maxWidth:"1400px",$$slots:{default:[Cd]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function bd(e){let t,n;return t=new Qu({props:{maxWidth:"1400px",$$slots:{default:[Pd]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function xd(e){let t,n;return t=new Qu({props:{maxWidth:"1400px",$$slots:{default:[Ld]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};8195&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function wd(e){let t,n;return t=new Qu({props:{$$slots:{default:[Md]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};8200&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function kd(e){let t,n;return t=new Qu({props:{$$slots:{default:[Sd]},$$scope:{ctx:e}}}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function Cd(e){let t,n;return t=new Eu({}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function Pd(e){let t,n;return t=new So({}),{c(){Ge(t.$$.fragment)},m(e,o){He(t,e,o),n=!0},i(e){n||(Ie(t.$$.fragment,e),n=!0)},o(e){_e(t.$$.fragment,e),n=!1},d(e){Be(t,e)}}}function Ld(e){let t,n,o,r;return t=new wo({props:{kmlOptions:e[1]}}),t.$on("save",e[10]),o=new Yt({}),{c(){Ge(t.$$.fragment),n=z(),Ge(o.$$.fragment)},m(e,s){He(t,e,s),A(e,n,s),He(o,e,s),r=!0},p(e,n){const o={};2&n&&(o.kmlOptions=e[1]),t.$set(o)},i(e){r||(Ie(t.$$.fragment,e),Ie(o.$$.fragment,e),r=!0)},o(e){_e(t.$$.fragment,e),_e(o.$$.fragment,e),r=!1},d(e){Be(t,e),e&&F(n),Be(o,e)}}}function Md(e){let t,n,o;return{c(){t=D("p"),n=R("😱: "),o=R(e[3]),U(t,"class","ofpError svelte-18bfvfs")},m(e,r){A(e,t,r),T(t,n),T(t,o)},p(e,t){8&t&&Z(o,e[3])},d(e){e&&F(t)}}}function Sd(e){let t;return{c(){t=D("div"),t.textContent="traitement en cours...",V(t,"margin","auto")},m(e,n){A(e,t,n)},d(e){e&&F(t)}}}function Td(e){let t,n,o,r,s,i;const a=[fd,md],l=[];function c(e,t){return"/install"===e[0]||navigator&&!1===navigator.standalone&&Je?0:1}return o=c(e),r=l[o]=a[o](e),{c(){t=D("main"),n=D("div"),r.c(),U(n,"class","content svelte-18bfvfs"),U(t,"class",s="container "+(e[0].substr(1)||"home")+" svelte-18bfvfs")},m(e,r){A(e,t,r),T(t,n),l[o].m(n,null),i=!0},p(e,[u]){let d=o;o=c(e),o===d?l[o].p(e,u):(Ae(),_e(l[d],1,1,(()=>{l[d]=null})),Fe(),r=l[o],r?r.p(e,u):(r=l[o]=a[o](e),r.c()),Ie(r,1),r.m(n,null)),(!i||1&u&&s!==(s="container "+(e[0].substr(1)||"home")+" svelte-18bfvfs"))&&U(t,"class",s)},i(e){i||(Ie(r),i=!0)},o(e){_e(r),i=!1},d(e){e&&F(t),l[o].d()}}}function Ed(e,t,n){let o,r,s,i,a,l,c;p(e,Wt,(e=>n(0,r=e))),p(e,xt,(e=>n(11,s=e))),p(e,Ct,(e=>n(12,i=e))),p(e,Ot,(e=>n(3,a=e))),p(e,Et,(e=>n(4,l=e))),p(e,_t,(e=>n(5,c=e)));null===vn.getItem(gn.optionsKML)&&(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in hn){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(sn)?t=o.toUpperCase():e.endsWith("Display")?t=!!o:e.endsWith("Change")&&(o*=1,isNaN(o)||(t=o.toFixed(1))),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||vn.setItem(gn.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&vn.setItem(gn.shortcut,o));vn.setItem(gn.optionsKML,n)})(window.location.search);let u=yn(vn.getItem(gn.optionsKML)||{});$n(u,r);ce((()=>(document.addEventListener("visibilitychange",Rt,!1),()=>document.removeEventListener("visibilitychange",Rt))));return e.$$.update=()=>{1&e.$$.dirty&&n(2,o=Lu.test(r))},[r,u,o,a,l,c,e=>{window.location.hash="#/"},()=>{x(Ct,i=!1,i),x(xt,s=!1,s)},function(e){u=e,n(1,u)},()=>$n(u,r),()=>$n(u,r)]}class Od extends Ke{constructor(e){super(),Ze(this,e,Ed,Td,a,{})}}try{self["workbox:window:6.2.4"]&&_()}catch(Ad){}function Ad(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function Fd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Id(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Fd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fd(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.2.4"]&&_()}catch(Ad){}var _d=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function Dd(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var jd=function(e,t){this.type=e,Object.assign(this,t)};function Rd(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function zd(){}var Nd={type:"SKIP_WAITING"};function Wd(e,t){if(!t)return e&&e.then?e.then(zd):Promise.resolve()}var qd=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new _d,o.en=new _d,o.on=new _d,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!Dd(t.scriptURL,o.sn.toString())||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,s=n===o.vn,i={sw:n,isExternal:s,originalEvent:e};!s&&o.mn&&(i.isUpdate=!0),o.dispatchEvent(new jd(r,i)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new jd("waiting",i))}),200):"activating"===r&&(clearTimeout(o.wn),s||o.en.resolve(n))},o.dn=function(e){var t=o.hn,n=t!==navigator.serviceWorker.controller;o.dispatchEvent(new jd("controlling",{isExternal:n,originalEvent:e,sw:t,isUpdate:o.mn})),n||o.on.resolve(t)},o.gn=(r=function(e){var t=e.data,n=e.ports,r=e.source;return Rd(o.getSW(),(function(){o.an.has(r)&&o.dispatchEvent(new jd("message",{data:t,originalEvent:e,ports:n,sw:r}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,s=o.prototype;return s.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return Wd(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),Rd(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&Dd(t.scriptURL,o.sn.toString())&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new jd("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn),o.fn}))}))}catch(e){return Promise.reject(e)}},s.update=function(){try{return this.fn?Wd(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},s.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},s.messageSW=function(e){try{return Rd(this.getSW(),(function(t){return Ad(t,e)}))}catch(e){return Promise.reject(e)}},s.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Ad(this.fn.waiting,Nd)},s.pn=function(){var e=navigator.serviceWorker.controller;return e&&Dd(e.scriptURL,this.sn.toString())?e:void 0},s.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return Rd(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=Id(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let Ud,Gd=!1;try{Ud=new Od({target:document.body})}catch(e){Gd=!0;try{var Hd=document.createElement("p");Hd.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(Hd)}catch(Id){}}finally{if("serviceWorker"in navigator){const e=new qd("./sw.js");bt.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{Gd?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,it(400,Ad(t.sw,{type:"GET_VERSION"})).then((e=>rd(e))).catch((e=>{rd()})))})),e.register().then((e=>{Gd&&e&&e.unregister(),od.set(e)}),console.error)}}return Ud}();
//# sourceMappingURL=bundle.js.map
