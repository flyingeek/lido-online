var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(o)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function c(e,t,n,o){if(e){const r=u(e,t,n,o);return e[0](r)}}function u(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function p(e,t,n,o,r,s,i){const a=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(a){const r=u(t,n,o,i);e.p(r,a)}}function d(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function m(e){return null==e?"":e}function f(e,t,n=t){return e.set(n),t}function g(t){return t&&i(t.destroy)?t.destroy:e}const h="undefined"!=typeof window;let v=h?()=>window.performance.now():()=>Date.now(),y=h?e=>requestAnimationFrame(e):e;const $=new Set;function b(e){$.forEach((t=>{t.c(e)||($.delete(t),t.f())})),0!==$.size&&y(b)}function x(e){let t;return 0===$.size&&y(b),{promise:new Promise((n=>{$.add(t={c:e,f:n})})),abort(){$.delete(t)}}}function w(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function P(e){e.parentNode.removeChild(e)}function C(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function L(e){return document.createElement(e)}function j(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function M(e){return document.createTextNode(e)}function F(){return M(" ")}function E(){return M("")}function O(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function A(e){return function(t){return t.preventDefault(),e.call(this,t)}}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:S(e,o,t[o])}function I(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function D(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function z(e,t){e.value=null==t?"":t}function q(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function R(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function W(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function N(e,t,n){e.classList[n?"add":"remove"](t)}function G(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const U=new Set;let H,B=0;function Z(e,t,n,o,r,s,i,a=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*s(e);c+=100*e+`%{${i(o,1-o)}}\n`}const u=c+`100% {${i(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=e.ownerDocument;U.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(L("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,B+=1,p}function K(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),B-=r,B||y((()=>{B||(U.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),U.clear())})))}function X(e){H=e}function J(){if(!H)throw new Error("Function called outside component initialization");return H}function V(e){J().$$.on_mount.push(e)}function Y(){const e=J();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=G(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function Q(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const ee=[],te=[],ne=[],oe=[],re=Promise.resolve();let se=!1;function ie(){se||(se=!0,re.then(pe))}function ae(e){ne.push(e)}function le(e){oe.push(e)}let ce=!1;const ue=new Set;function pe(){if(!ce){ce=!0;do{for(let e=0;e<ee.length;e+=1){const t=ee[e];X(t),de(t.$$)}for(X(null),ee.length=0;te.length;)te.pop()();for(let e=0;e<ne.length;e+=1){const t=ne[e];ue.has(t)||(ue.add(t),t())}ne.length=0}while(ee.length);for(;oe.length;)oe.pop()();se=!1,ce=!1,ue.clear()}}function de(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ae)}}let me;function fe(){return me||(me=Promise.resolve(),me.then((()=>{me=null}))),me}function ge(e,t,n){e.dispatchEvent(G(`${t?"intro":"outro"}${n}`))}const he=new Set;let ve;function ye(){ve={r:0,c:[],p:ve}}function $e(){ve.r||s(ve.c),ve=ve.p}function be(e,t){e&&e.i&&(he.delete(e),e.i(t))}function xe(e,t,n,o){if(e&&e.o){if(he.has(e))return;he.add(e),ve.c.push((()=>{he.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const we={duration:0};function ke(n,o,r,a){let l=o(n,r),c=a?0:1,u=null,p=null,d=null;function m(){d&&K(n,d)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(o){const{delay:r=0,duration:i=300,easing:a=t,tick:g=e,css:h}=l||we,y={start:v()+r,b:o};o||(y.group=ve,ve.r+=1),u||p?p=y:(h&&(m(),d=Z(n,c,o,i,r,a,h)),o&&g(0,1),u=f(y,i),ae((()=>ge(n,o,"start"))),x((e=>{if(p&&e>p.start&&(u=f(p,i),p=null,ge(n,u.b,"start"),h&&(m(),d=Z(n,c,u.b,u.duration,0,a,l.css))),u)if(e>=u.end)g(c=u.b,1-c),ge(n,u.b,"end"),p||(u.b?m():--u.group.r||s(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*a(t/u.duration),g(c,1-c)}return!(!u&&!p)})))}return{run(e){i(l)?fe().then((()=>{l=l(),g(e)})):g(e)},end(){m(),u=p=null}}}function Pe(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let i=t.ctx;void 0!==r&&(i=i.slice(),i[r]=s);const a=e&&(t.current=e)(i);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(ye(),xe(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),$e())})):t.block.d(1),a.c(),be(a,1),a.m(t.mount(),t.anchor),l=!0),t.block=a,t.blocks&&(t.blocks[o]=a),l&&pe()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=J();if(e.then((e=>{X(n),o(t.then,1,t.value,e),X(null)}),(e=>{if(X(n),o(t.catch,2,t.error,e),X(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}function Ce(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Le(e){e&&e.c()}function _e(e,t,n){const{fragment:r,on_mount:a,on_destroy:l,after_update:c}=e.$$;r&&r.m(t,n),ae((()=>{const t=a.map(o).filter(i);l?l.push(...t):s(t),e.$$.on_mount=[]})),c.forEach(ae)}function je(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Me(t,n,o,i,a,l,c=[-1]){const u=H;X(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:r(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(ee.push(e),ie(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,s(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(P)}else p.fragment&&p.fragment.c();n.intro&&be(t.$$.fragment),_e(t,n.target,n.anchor),pe()}X(u)}class Fe{$destroy(){je(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Ee{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Oe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,Ae=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),Se=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),Te=matchMedia("(hover: hover)").matches;function Ie(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function De(e,t,n){return e<=t?t:e>=n?n:e}function ze(e,t,n){return!(e<t)&&!(e>n)}function qe(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function Re(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function We(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}function Ne(e){const t=e-1;return t*t*t+1}function Ge(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function Ue(e,{delay:t=0,duration:n=400,easing:o=Ne,x:r=0,y:s=0,opacity:i=0}={}){const a=getComputedStyle(e),l=+a.opacity,c="none"===a.transform?"":a.transform,u=l*(1-i);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*s}px);\n\t\t\topacity: ${l-u*t}`}}function He(e){let t;return{c(){t=L("textarea"),t.value=e[0],S(t,"class","svelte-12a0ij3")},m(n,o){k(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&P(t),e[6](null)}}}function Be(t){let n,o,r;return{c(){n=L("a"),n.textContent="copier la route",S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://")},m(e,s){k(e,n,s),o||(r=O(n,"click",t[4]),o=!0)},p:e,d(e){e&&P(n),o=!1,r()}}}function Ze(t){let n,o,r,s,i;return{c(){n=L("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=L("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura √©t√© copi√©e automatiquement).</small>',S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://"),S(r,"class","card-text")},m(e,a){k(e,n,a),k(e,o,a),k(e,r,a),s||(i=O(n,"click",t[4]),s=!0)},p:e,d(e){e&&P(n),e&&P(o),e&&P(r),s=!1,i()}}}function Ke(n){let o,r,a;return{c(){o=L("span"),o.textContent="copi√©!",S(o,"class","svelte-12a0ij3")},m(e,t){k(e,o,t),a=!0},i(e){a||(r&&r.end(1),a=!0)},o(n){r=function(n,o,r){let a,l=o(n,r),c=!0;const u=ve;function p(){const{delay:o=0,duration:r=300,easing:i=t,tick:p=e,css:d}=l||we;d&&(a=Z(n,1,0,r,o,i,d));const m=v()+o,f=m+r;ae((()=>ge(n,!1,"start"))),x((e=>{if(c){if(e>=f)return p(0,1),ge(n,!1,"end"),--u.r||s(u.c),!1;if(e>=m){const t=i((e-m)/r);p(1-t,t)}}return c}))}return u.r+=1,i(l)?fe().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(a&&K(n,a),c=!1)}}}(o,Ge,{}),a=!1},d(e){e&&P(o),e&&r&&r.end()}}}function Xe(e){let t,n,o,r,s,i,a,l,c,u,p,d,m=null!=e[0]&&He(e);let f=(Oe?Ze:Be)(e),g=e[2]&&Ke();return{c(){m&&m.c(),t=F(),n=L("div"),o=L("div"),r=L("h5"),r.textContent="Route Lido",s=F(),i=L("p"),i.textContent="Cette route est optimis√©e par rapport √† celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus r√©active.",a=F(),f.c(),l=F(),c=L("div"),u=M(e[3]),p=F(),g&&g.c(),S(r,"class","card-title"),S(i,"class","card-text"),S(c,"class","text-monospace svelte-12a0ij3"),S(o,"class","card-body"),S(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),k(e,t,h),k(e,n,h),w(n,o),w(o,r),w(o,s),w(o,i),w(o,a),f.m(o,null),w(o,l),w(o,c),w(c,u),w(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=He(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&be(g,1):(g=Ke(),g.c(),be(g,1),g.m(c,null)):g&&(ye(),xe(g,1,1,(()=>{g=null})),$e())},i(e){d||(be(g),d=!0)},o(e){xe(g),d=!1},d(e){m&&m.d(e),e&&P(t),e&&P(n),f.d(),g&&g.d()}}}let Je=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Je=!0)}))}catch(e){}function Ve(e,t,n){let o,{ofp:r}=t,s=null;const i=r?r.lidoRoute().join(" "):"";let a=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,a,i,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Je)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await(ie(),re),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(i);Oe||(n(2,a=t),setTimeout((function(){n(2,a=!1)}),3e3),e.preventDefault())},r,function(e){te[e?"unshift":"push"]((()=>{o=e,n(1,o)}))}]}class Ye extends Fe{constructor(e){super(),Me(this,e,Ve,Xe,a,{ofp:5})}}const Qe={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC"};function et(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const tt=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,et(window.kmlGen,Qe)),window.kmlGen);function nt(e,t){let n={...Qe,...t};const o=tt();et(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,i=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),a=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route D√©gagement"}),l=new editolido.Route([i.points[0],i.points[i.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",i),o.addPoints("rmain",i,{excluded:c}),o.addLine("ralt",a),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",a)}function ot(t){let n,o,r,a,l,c,u,p,d,m,f,h,v,y,$,b,x,C,_;return{c(){n=L("kmlcolor"),o=L("div"),r=L("label"),a=M("Couleur"),l=F(),c=L("picker"),u=L("label"),p=L("input"),f=F(),h=L("input"),y=F(),$=L("input"),S(r,"for",t[1]),S(r,"class","input-group-text svelte-1hvk4hi"),S(o,"class","input-group-prepend"),S(p,"type","color"),S(p,"class","svelte-1hvk4hi"),S(u,"style",d=lt(t[2])),S(u,"class","svelte-1hvk4hi"),S(h,"type","range"),S(h,"min","30"),S(h,"max","255"),S(h,"class","svelte-1hvk4hi"),S(c,"class","form-control svelte-1hvk4hi"),S(c,"style",v=at(t[2][0])),S($,"name",t[1]),S($,"class","form-control text-monospace svelte-1hvk4hi"),S($,"style",b=ct(t[0])),S($,"type","text"),S($,"maxlength","8"),S(n,"class","input-group svelte-1hvk4hi")},m(e,s){k(e,n,s),w(n,o),w(o,r),w(r,a),w(n,l),w(n,c),w(c,u),w(u,p),z(p,t[2][0]),w(c,f),w(c,h),z(h,t[2][1]),w(n,y),w(n,$),z($,t[0]),C||(_=[O(p,"input",t[5]),g(m=t[4].call(null,u,t[0])),O(h,"change",t[6]),O(h,"input",t[6]),g(x=t[3].call(null,$,t[2])),O($,"input",t[7])],C=!0)},p(e,[t]){2&t&&S(r,"for",e[1]),4&t&&z(p,e[2][0]),4&t&&d!==(d=lt(e[2]))&&S(u,"style",d),m&&i(m.update)&&1&t&&m.update.call(null,e[0]),4&t&&z(h,e[2][1]),4&t&&v!==(v=at(e[2][0]))&&S(c,"style",v),2&t&&S($,"name",e[1]),1&t&&b!==(b=ct(e[0]))&&S($,"style",b),x&&i(x.update)&&4&t&&x.update.call(null,e[2]),1&t&&$.value!==e[0]&&z($,e[0])},i:e,o:e,d(e){e&&P(n),C=!1,s(_)}}}const rt=/^[A-F0-9]{8}$/i,st=e=>{let[t,n]=it(e);return[t,n/255]},it=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},at=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},lt=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,ct=e=>e.match(rt)?"":"border-color: #F00;";function ut(e,t,n){const o=Y();let r,{kmlColor:s="FF0000FF"}=t,{name:i}=t;try{r=it(s)}catch(e){r=["#FF0000",255]}const a=function(e,t,n){let o;return function(){const r=this,s=arguments,i=function(){o=null,n||e.apply(r,s)},a=n&&!o;clearTimeout(o),o=setTimeout(i,t),a&&e.apply(r,s)}}(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,i=e.name)},[s,i,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),a("change",{name:i,value:s})}}},function(e){return{update(e){if(e.match(rt)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),a("change",{name:i,value:e.toUpperCase()})}}}},function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?null:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class pt extends Fe{constructor(e){super(),Me(this,e,ut,ot,a,{kmlColor:0,name:1})}}const dt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),mt=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}},ft=(e,t,n="Mon OFP2MAP")=>{const o={};for(const[t,n]of Object.entries(dt)){let r=mt.getItem(n);if(t===dt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==Qe[t])))t[n]=e[n];r=t}if(null!==r)if(t===dt.optionsKML)for(const[e,t]of Object.entries(r))o[e]=t;else o[t]=r}const r=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),s=window.location.origin+window.location.pathname+(r?"?"+r:"")+"#"+t;window.history.replaceState(o,n,s)};function gt(t){let n,o,r,i,a,l,c,u,p,d;return{c(){n=L("div"),o=L("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',r=F(),i=L("input"),a=F(),l=L("div"),c=L("a"),u=M("Lancer"),S(o,"class","input-group-prepend"),S(i,"class","form-control svelte-1ecyaux"),S(i,"placeholder","Nom du raccourci"),S(i,"type","text"),S(c,"class","btn btn-outline-secondary svelte-1ecyaux"),S(c,"href",t[1]),N(c,"disabled",!(t[0].trim()&&Oe)),S(l,"class","input-group-append"),S(n,"class","input-group")},m(e,s){k(e,n,s),w(n,o),w(n,r),w(n,i),z(i,t[0]),w(n,a),w(n,l),w(l,c),w(c,u),p||(d=[O(i,"input",t[5]),O(i,"change",t[3]),O(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&i.value!==e[0]&&z(i,e[0]),2&t&&S(c,"href",e[1]),1&t&&N(c,"disabled",!(e[0].trim()&&Oe))},i:e,o:e,d(e){e&&P(n),p=!1,s(d)}}}const ht="OFP2MAP";function vt(e,t,n){const o=Y(),r=dt.shortcut;let s,i=mt.getItem(r)||ht,{ofp:a}=t;const l=a?a.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,a=e.ofp)},[i,s,function(e){const t=i.trim();if(t&&Oe){const e=tt(),o={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:a.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=i.trim();e===ht?mt.removeItem(r):mt.setItem(r,e),o("save",[r,e])},a,function(){i=this.value,n(0,i)}]}class yt extends Fe{constructor(e){super(),Me(this,e,vt,gt,a,{ofp:4})}}function $t(t){let n,o,r,i,a,l,c,u,p,d,m,f,g,h,v,y=wt[0]+"",$=wt[1]+"";return{c(){n=L("div"),o=L("select"),r=L("option"),i=M(y),l=L("option"),c=M($),p=F(),d=L("div"),m=L("a"),f=M(t[0]),r.selected=a=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,S(o,"class","custom-select svelte-19hokx5"),S(o,"aria-label","Example select with button addon"),void 0===t[1]&&ae((()=>t[6].call(o))),S(m,"class","btn btn-success"),S(m,"download",g=navigator.standalone?null:t[3]),S(m,"href",t[2]),S(m,"target",bt),S(d,"class","input-group-append"),S(n,"class","input-group")},m(e,s){k(e,n,s),w(n,o),w(o,r),w(r,i),w(o,l),w(l,c),R(o,t[1]),w(n,p),w(n,d),w(d,m),w(m,f),h||(v=[O(o,"change",t[6]),O(o,"change",t[5]),O(m,"click",t[4])],h=!0)},p(e,[t]){2&t&&a!==(a=0===e[1])&&(r.selected=a),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&R(o,e[1]),1&t&&D(f,e[0]),8&t&&g!==(g=navigator.standalone?null:e[3])&&S(m,"download",g),4&t&&S(m,"href",e[2])},i:e,o:e,d(e){e&&P(n),h=!1,s(v)}}}const bt=navigator.standalone||navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,xt=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},wt=["KML Mapsme","KML Avenza"];function kt(e,t,n){const o=Y();let{label:r}=t;const s=dt.downloadType;let i=mt.getItem(s)||1;"string"==typeof i&&(i=parseInt(i,10)),(i<0||i>=wt.length)&&(i=0);let a="",l="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,i,a,l,function(e){const t=tt(),o=["_mapsme.kml","_avenza.kml",".geojson"][i];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),0===i)n(2,a=xt(t.render()));else{if(1!==i)return e.preventDefault(),!1;n(2,a=xt(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})))}},function(){1===i?mt.removeItem(s):mt.setItem(s,i),o("save",[s,i])},function(){i=W(this),n(1,i)}]}class Pt extends Fe{constructor(e){super(),Me(this,e,kt,$t,a,{label:0})}}function Ct(e){let t,n,o,r,s,i,a,l,c,u,p,d,m,f,g;return a=new Pt({props:{label:"T√©l√©charger"}}),a.$on("save",e[1]),d=new yt({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=L("div"),n=L("div"),o=L("h5"),o.textContent="Export",r=F(),s=L("div"),i=L("div"),Le(a.$$.fragment),l=F(),c=L("small"),c.textContent="Le fichier est g√©n√©r√© en fonction des options choisies sur la carte.",u=F(),p=L("div"),Le(d.$$.fragment),m=F(),f=L("small"),f.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci √† installer</a>',S(o,"class","card-title"),S(c,"class","text-muted"),S(i,"class","col-12 col-sm-6 col-md-6"),S(f,"class","text-muted"),S(p,"class","col-12 col-sm-6 col-md-6"),S(s,"class","row"),S(n,"class","card-body"),S(t,"class","card mb-3 svelte-17snbjk")},m(e,h){k(e,t,h),w(t,n),w(n,o),w(n,r),w(n,s),w(s,i),_e(a,i,null),w(i,l),w(i,c),w(s,u),w(s,p),_e(d,p,null),w(p,m),w(p,f),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||(be(a.$$.fragment,e),be(d.$$.fragment,e),g=!0)},o(e){xe(a.$$.fragment,e),xe(d.$$.fragment,e),g=!1},d(e){e&&P(t),je(a),je(d)}}}function Lt(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){Q(e,t)},function(t){Q(e,t)}]}class _t extends Fe{constructor(e){super(),Me(this,e,Lt,Ct,a,{ofp:0})}}function jt(e){let t;return{c(){t=L("div"),t.innerHTML='<span class="sr-only">Loading...</span>',S(t,"class","spinner-border text-warning"),S(t,"role","status")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function Mt(e){let t,n,o,r,s,i,a,l,c,u,p;return{c(){t=L("div"),n=L("p"),o=M("üò±: Erreur de r√©cup√©ration du Gramet, "),r=L("a"),r.textContent="essayez √† nouveau",s=M(" ou allez sur "),i=L("a"),a=M("ogimet"),c=M("."),S(r,"href","."),S(i,"href",l=e[0].ogimetData.url),S(i,"target","_blank"),S(n,"class","svelte-i1m2fr"),S(t,"class","error svelte-i1m2fr")},m(l,d){k(l,t,d),w(t,n),w(n,o),w(n,r),w(n,s),w(n,i),w(i,a),w(n,c),u||(p=O(r,"click",A(e[4])),u=!0)},p(e,t){1&t&&l!==(l=e[0].ogimetData.url)&&S(i,"href",l)},d(e){e&&P(t),u=!1,p()}}}function Ft(e){let t,n,o,r;return{c(){t=L("img"),S(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n),S(t,"alt","gramet demo"),S(t,"class","img-fluid svelte-i1m2fr")},m(n,s){k(n,t,s),o||(r=[O(t,"error",e[2]),O(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n)},d(e){e&&P(t),o=!1,s(r)}}}function Et(t){let n,o,r,s,i,a,l,c,u,p,d,m,f,g,h,v,y,$,b,x,C,_="loading"===t[1]&&jt();function j(e,t){return"error"!==e[1]?Ft:Mt}let E=j(t),O=E(t);return{c(){n=L("div"),o=L("h1"),o.innerHTML='Le GRAMET est un m√©t√©ogramme repr√©sentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et √† l&#39;heure de passage estim√©e, une coupe verticale de la m√©t√©o pr√©vue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interpr√©tation</a>',r=F(),s=L("div"),_&&_.c(),i=F(),O.c(),a=F(),l=L("div"),c=L("div"),u=L("div"),p=L("div"),d=L("div"),d.textContent="Route Ogimet",m=F(),f=L("div"),g=L("p"),h=M("Le GRAMET est r√©alis√© par "),v=L("a"),y=M("www.ogimet.com"),b=M(" √† partir\n    d'une route calcul√©e. Il est possible d'afficher la route sur la carte. Cel√† est\n    particuli√®rement utile lors des vols oc√©aniques car il n'y a aucune station en mer."),x=F(),C=L("div"),C.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Apr√®s avoir s√©lectionner les stations m√©t√©o proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectu√© pour r√©duire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',S(o,"class","svelte-i1m2fr"),S(s,"class","text-center svelte-i1m2fr"),S(d,"class","card-header svelte-i1m2fr"),S(v,"class","text-warning"),S(v,"href",$=t[0].ogimetData.url),S(v,"target","_blank"),S(g,"class","card-text"),S(f,"class","card-body"),S(p,"class","card ogimet svelte-i1m2fr"),S(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),S(C,"class","col-12 col-sm-6 col-md-6 col-xl-6"),S(c,"class","card-deck"),S(l,"class","row")},m(e,t){k(e,n,t),w(n,o),w(n,r),w(n,s),_&&_.m(s,null),w(s,i),O.m(s,null),w(n,a),w(n,l),w(l,c),w(c,u),w(u,p),w(p,d),w(p,m),w(p,f),w(f,g),w(g,h),w(g,v),w(v,y),w(g,b),w(c,x),w(c,C)},p(e,[t]){"loading"===e[1]?_||(_=jt(),_.c(),_.m(s,i)):_&&(_.d(1),_=null),E===(E=j(e))&&O?O.p(e,t):(O.d(1),O=E(e),O&&(O.c(),O.m(s,null))),1&t&&$!==($=e[0].ogimetData.url)&&S(v,"href",$)},i:e,o:e,d(e){e&&P(n),_&&_.d(),O.d()}}}function Ot(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class At extends Fe{constructor(e){super(),Me(this,e,Ot,Et,a,{ofp:0})}}function St(t){let n;return{c(){n=L("h1"),n.innerHTML='Cartographie pour l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-drdjg7"/>¬†',S(n,"class","svelte-drdjg7")},m(e,t){k(e,n,t)},p:e,i:e,o:e,d(e){e&&P(n)}}}class Tt extends Fe{constructor(e){super(),Me(this,e,null,St,a,{})}}function It(t){let n,o,r,s;return n=new Tt({}),{c(){Le(n.$$.fragment),o=F(),r=L("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card avenza svelte-z58ee3"><div class="card-header svelte-z58ee3">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les derni√®res technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card mapsme svelte-z58ee3"><div class="card-header svelte-z58ee3">Multiples Projections</div> \n      <div class="card-body"><p class="card-text">Des cartes LAMBERT conformes, un ATLAS, et une MERCATOR avec 12 niveaux de zoom. Export en format KML vers Mapsme ou Avenza</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card ogimet svelte-z58ee3"><div class="card-header svelte-z58ee3">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET qui est un m√©t√©ogramme combinant l&#39;espace et le temps</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card shortcuts svelte-z58ee3"><div class="card-header svelte-z58ee3">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Avec l&#39;app Raccourcis, automatisez en r√©cup√©rant le KML, le Gramet, ou une route Lido optimis√©e</p></div></div></div></div>',S(r,"class","row svelte-z58ee3")},m(e,t){_e(n,e,t),k(e,o,t),k(e,r,t),s=!0},p:e,i(e){s||(be(n.$$.fragment,e),s=!0)},o(e){xe(n.$$.fragment,e),s=!1},d(e){je(n,e),e&&P(o),e&&P(r)}}}class Dt extends Fe{constructor(e){super(),Me(this,e,null,It,a,{})}}function zt(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function qt(e){let t,n,o,r=e[4].label+"";return{c(){t=L("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){k(e,t,o),w(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&P(t)}}}function Rt(t){let n,o,r,a,l,c,u,p,d,m,f,g,h=Wt,v=[];for(let e=0;e<h.length;e+=1)v[e]=qt(zt(t,h,e));return{c(){n=L("div"),o=L("div"),r=L("label"),a=M("Rep√®re"),l=F(),c=L("span"),u=j("svg"),p=j("use"),d=F(),m=L("select");for(let e=0;e<v.length;e+=1)v[e].c();S(r,"class","input-group-text svelte-1j0ign2"),S(r,"for",t[1]),I(p,"xlink:href","#marker"),q(p,"stroke",0===t[0]?"#fff":"#000"),q(p,"fill",Wt[t[0]].color),S(u,"class","svelte-1j0ign2"),S(c,"class","input-group-text svelte-1j0ign2"),S(o,"class","input-group-prepend"),S(m,"name",t[1]),S(m,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ae((()=>t[3].call(m))),S(n,"class","input-group svelte-1j0ign2")},m(e,s){k(e,n,s),w(n,o),w(o,r),w(r,a),w(o,l),w(o,c),w(c,u),w(u,p),w(n,d),w(n,m);for(let e=0;e<v.length;e+=1)v[e].m(m,null);R(m,t[0]),f||(g=[O(m,"change",t[3]),O(m,"change",(function(){i(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],f=!0)},p(e,[n]){if(t=e,2&n&&S(r,"for",t[1]),1&n&&q(p,"stroke",0===t[0]?"#fff":"#000"),1&n&&q(p,"fill",Wt[t[0]].color),1&n){let e;for(h=Wt,e=0;e<h.length;e+=1){const o=zt(t,h,e);v[e]?v[e].p(o,n):(v[e]=qt(o),v[e].c(),v[e].m(m,null))}for(;e<v.length;e+=1)v[e].d(1);v.length=h.length}2&n&&S(m,"name",t[1]),1&n&&R(m,t[0])},i:e,o:e,d(e){e&&P(n),C(v,e),f=!1,s(g)}}}const Wt=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function Nt(e,t,n){const o=Y();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=W(this),n(0,r)}]}class Gt extends Fe{constructor(e){super(),Me(this,e,Nt,Rt,a,{selected:0,name:1})}}function Ut(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Ht(e){let t,n,o,r=e[4].label+"";return{c(){t=L("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){k(e,t,o),w(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&P(t)}}}function Bt(t){let n,o,r,a,l,c,u,p,d=Zt,m=[];for(let e=0;e<d.length;e+=1)m[e]=Ht(Ut(t,d,e));return{c(){n=L("div"),o=L("div"),r=L("label"),a=M("Couleur"),l=F(),c=L("select");for(let e=0;e<m.length;e+=1)m[e].c();S(r,"class","input-group-text svelte-90luj4"),S(r,"for",t[1]),S(o,"class","input-group-prepend"),S(c,"name",t[1]),S(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ae((()=>t[3].call(c))),S(n,"class","input-group svelte-90luj4")},m(e,s){k(e,n,s),w(n,o),w(o,r),w(r,a),w(n,l),w(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);R(c,t[0]),u||(p=[O(c,"change",t[3]),O(c,"change",(function(){i(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],u=!0)},p(e,[n]){if(t=e,2&n&&S(r,"for",t[1]),1&n){let e;for(d=Zt,e=0;e<d.length;e+=1){const o=Ut(t,d,e);m[e]?m[e].p(o,n):(m[e]=Ht(o),m[e].c(),m[e].m(c,null))}for(;e<m.length;e+=1)m[e].d(1);m.length=d.length}2&n&&S(c,"name",t[1]),1&n&&R(c,t[0])},i:e,o:e,d(e){e&&P(n),C(m,e),u=!1,s(p)}}}const Zt=[{label:"statuts"},{label:"vert/rouge"}];function Kt(e,t,n){const o=Y();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=W(this),n(0,r)}]}class Xt extends Fe{constructor(e){super(),Me(this,e,Kt,Bt,a,{selected:0,name:1})}}const Jt=[];function Vt(e,t){return{subscribe:Yt(e,t).subscribe}}function Yt(t,n=e){let o;const r=[];function s(e){if(a(t,e)&&(t=e,o)){const e=!Jt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Jt.push(n,t)}if(e){for(let e=0;e<Jt.length;e+=2)Jt[e][0](Jt[e+1]);Jt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,a=e){const l=[i,a];return r.push(l),1===r.length&&(o=n(s)||e),i(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const Qt=Yt(),en=Yt(!1),tn=Yt(!1),nn=Yt(),on=Yt(!1);let rn=new Date;const sn=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-rn>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting||e.update(),en.set(!1),rn=new Date)}),console.error)}},an=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&sn()},ln=Vt({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),cn=Vt("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(tn.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),sn()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}}));function un(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function pn(e){let t,n,o,r,i,a,l,c,u,p,d,f,h,v,y,$,b,x,C,_,E,T,D,z,q,R,W,G,U,H,B,Z,K,X,J,V,Y,Q,ee,te,ne,oe,re,se,ie,le,ce,ue,pe,de,me,fe,ge,he,ve,ye,$e,we,Pe,Ce,Me,Fe,Ee,Oe,Ae,Se,Te,Ie,De,ze,qe,Re,We,Ne,Ge,He,Be,Ze,Ke,Xe,Je,Ve,Ye,Qe,et,tt,nt,ot,rt,st,it,at,lt,ct,ut,dt,mt,ft,gt,ht,vt,yt,$t,bt,xt,wt,kt,Pt,Ct,Lt,_t,jt,Mt,Ft,Et,Ot,At,St,Tt,It,Dt,zt,qt,Rt,Wt,Nt,Ut,Ht=!e[3]&&dn(e);return v=new pt({props:{name:"route-color",kmlColor:e[0].routeColor}}),v.$on("change",e[6]),x=new Gt({props:{name:"route-pin",selected:e[0].routePin}}),x.$on("change",e[6]),U=new pt({props:{name:"alternate-color",kmlColor:e[0].alternateColor}}),U.$on("change",e[6]),K=new Gt({props:{name:"alternate-pin",selected:e[0].alternatePin}}),K.$on("change",e[6]),se=new pt({props:{name:"nat-color",kmlColor:e[0].natColor}}),se.$on("change",e[6]),de=new Gt({props:{name:"nat-pin",selected:e[0].natPin}}),de.$on("change",e[6]),Ae=new pt({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}}),Ae.$on("change",e[6]),Be=new pt({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}}),Be.$on("change",e[6]),st=new pt({props:{name:"etops-color",kmlColor:e[0].etopsColor}}),st.$on("change",e[6]),yt=new Xt({props:{name:"airport-pin",selected:e[0].airportPin}}),yt.$on("change",e[6]),{c(){t=L("div"),n=L("a"),o=j("svg"),r=j("use"),i=F(),a=L("form"),l=L("div"),Ht&&Ht.c(),c=F(),u=L("fieldset"),p=L("legend"),p.textContent="Route",d=F(),f=L("div"),h=L("div"),Le(v.$$.fragment),$=F(),b=L("div"),Le(x.$$.fragment),_=F(),E=L("fieldset"),T=L("legend"),D=L("input"),q=M("D√©gagement"),R=F(),W=L("div"),G=L("div"),Le(U.$$.fragment),B=F(),Z=L("div"),Le(K.$$.fragment),J=F(),V=L("fieldset"),Y=L("legend"),Q=L("input"),te=M("Tracks"),ne=F(),oe=L("div"),re=L("div"),Le(se.$$.fragment),ie=F(),le=L("small"),le.textContent="Un track incomplet restera rouge.",ue=F(),pe=L("div"),Le(de.$$.fragment),me=F(),fe=L("small"),fe.textContent="Positionn√© √† l'entr√©e des tracks.",he=F(),ve=L("div"),ye=L("div"),$e=L("fieldset"),we=L("legend"),Pe=L("input"),Me=M("Orthodromie"),Fe=F(),Ee=L("div"),Oe=L("div"),Le(Ae.$$.fragment),Te=F(),Ie=L("div"),De=L("fieldset"),ze=L("legend"),qe=L("input"),We=M("Route du GRAMET"),Ne=F(),Ge=L("div"),He=L("div"),Le(Be.$$.fragment),Ke=F(),Xe=L("div"),Je=L("div"),Ve=L("fieldset"),Ye=L("legend"),Qe=L("input"),tt=M("Etops"),nt=F(),ot=L("div"),rt=L("div"),Le(st.$$.fragment),at=F(),lt=L("div"),ct=L("fieldset"),ut=L("legend"),dt=L("input"),ft=M("Airports"),gt=F(),ht=L("div"),vt=L("div"),Le(yt.$$.fragment),bt=F(),xt=L("div"),wt=L("div"),kt=L("fieldset"),Pt=L("legend"),Ct=L("input"),_t=M("FIR S√õRET√â"),Mt=F(),Ft=L("div"),Et=L("div"),Ot=L("button"),At=M("M√©moriser"),Tt=F(),It=L("button"),Dt=M("Restaurer"),I(r,"xlink:href","#close"),S(o,"class","svelte-5yl5q3"),N(o,"blink",e[2]),S(n,"class","closeB svelte-5yl5q3"),S(n,"role","button"),S(n,"href","."),S(l,"class","reset svelte-5yl5q3"),S(p,"class","svelte-5yl5q3"),S(h,"class",y=m(e[1])+" svelte-5yl5q3"),S(b,"class",C=m(e[1])+" svelte-5yl5q3"),S(f,"class","row"),S(u,"class","form-group svelte-5yl5q3"),S(D,"name","alternate-display"),D.checked=z=e[0].alternateDisplay,S(D,"type","checkbox"),S(D,"class","svelte-5yl5q3"),S(T,"class","svelte-5yl5q3"),S(G,"class",H=m(e[1])+" svelte-5yl5q3"),S(Z,"class",X=m(e[1])+" svelte-5yl5q3"),S(W,"class","row"),S(E,"class","form-group svelte-5yl5q3"),S(Q,"name","nat-display"),Q.checked=ee=e[0].natDisplay,S(Q,"type","checkbox"),S(Q,"class","svelte-5yl5q3"),S(Y,"class","svelte-5yl5q3"),S(le,"class","form-text text-muted svelte-5yl5q3"),S(re,"class",ce=m(e[1])+" svelte-5yl5q3"),S(fe,"class","form-text text-muted svelte-5yl5q3"),S(pe,"class",ge=m(e[1])+" svelte-5yl5q3"),S(oe,"class","row"),S(V,"class","form-group svelte-5yl5q3"),S(Pe,"name","great-circle-display"),Pe.checked=Ce=e[0].greatCircleDisplay,S(Pe,"type","checkbox"),S(Pe,"class","svelte-5yl5q3"),S(we,"class","svelte-5yl5q3"),S(Oe,"class","col"),S(Ee,"class","row"),S($e,"class","form-group svelte-5yl5q3"),S(ye,"class",Se=m(e[1])+" svelte-5yl5q3"),S(qe,"name","ogimet-display"),qe.checked=Re=e[0].ogimetDisplay,S(qe,"type","checkbox"),S(qe,"class","svelte-5yl5q3"),S(ze,"class","svelte-5yl5q3"),S(He,"class","col"),S(Ge,"class","row"),S(De,"class","form-group svelte-5yl5q3"),S(Ie,"class",Ze=m(e[1])+" svelte-5yl5q3"),S(ve,"class","row"),S(Qe,"name","etops-display"),Qe.checked=et=e[0].etopsDisplay,S(Qe,"type","checkbox"),S(Qe,"class","svelte-5yl5q3"),S(Ye,"class","svelte-5yl5q3"),S(rt,"class","col"),S(ot,"class","row"),S(Ve,"class","form-group svelte-5yl5q3"),S(Je,"class",it=m(e[1])+" svelte-5yl5q3"),S(dt,"name","airport-display"),dt.checked=mt=e[0].airportDisplay,S(dt,"type","checkbox"),S(dt,"class","svelte-5yl5q3"),S(ut,"class","svelte-5yl5q3"),S(vt,"class","col"),S(ht,"class","row"),S(ct,"class","form-group svelte-5yl5q3"),S(lt,"class",$t=m(e[1])+" svelte-5yl5q3"),S(Xe,"class","row"),S(Ct,"name","fir-display"),Ct.checked=Lt=e[0].firDisplay,S(Ct,"type","checkbox"),S(Ct,"class","svelte-5yl5q3"),S(Pt,"class","svelte-5yl5q3"),S(kt,"class","form-group svelte-5yl5q3"),S(wt,"class",jt=m(e[1])+" svelte-5yl5q3"),S(xt,"class","row"),Ot.disabled=St=!e[4],S(Ot,"class","btn btn-primary btn-sm mb-2 svelte-5yl5q3"),S(Ot,"type","button"),It.disabled=zt=!e[4],S(It,"class","btn btn-secondary btn-sm mb-2 svelte-5yl5q3"),S(It,"type","button"),S(Et,"class",qt=m(e[1])+" svelte-5yl5q3"),S(Ft,"class","row last svelte-5yl5q3"),S(a,"class","svelte-5yl5q3"),S(t,"class","settings svelte-5yl5q3"),N(t,"sidebar",e[5])},m(s,m){k(s,t,m),w(t,n),w(n,o),w(o,r),w(t,i),w(t,a),w(a,l),Ht&&Ht.m(l,null),w(a,c),w(a,u),w(u,p),w(u,d),w(u,f),w(f,h),_e(v,h,null),w(f,$),w(f,b),_e(x,b,null),w(a,_),w(a,E),w(E,T),w(T,D),w(T,q),w(E,R),w(E,W),w(W,G),_e(U,G,null),w(W,B),w(W,Z),_e(K,Z,null),w(a,J),w(a,V),w(V,Y),w(Y,Q),w(Y,te),w(V,ne),w(V,oe),w(oe,re),_e(se,re,null),w(re,ie),w(re,le),w(oe,ue),w(oe,pe),_e(de,pe,null),w(pe,me),w(pe,fe),w(a,he),w(a,ve),w(ve,ye),w(ye,$e),w($e,we),w(we,Pe),w(we,Me),w($e,Fe),w($e,Ee),w(Ee,Oe),_e(Ae,Oe,null),w(ve,Te),w(ve,Ie),w(Ie,De),w(De,ze),w(ze,qe),w(ze,We),w(De,Ne),w(De,Ge),w(Ge,He),_e(Be,He,null),w(a,Ke),w(a,Xe),w(Xe,Je),w(Je,Ve),w(Ve,Ye),w(Ye,Qe),w(Ye,tt),w(Ve,nt),w(Ve,ot),w(ot,rt),_e(st,rt,null),w(Xe,at),w(Xe,lt),w(lt,ct),w(ct,ut),w(ut,dt),w(ut,ft),w(ct,gt),w(ct,ht),w(ht,vt),_e(yt,vt,null),w(a,bt),w(a,xt),w(xt,wt),w(wt,kt),w(kt,Pt),w(Pt,Ct),w(Pt,_t),w(a,Mt),w(a,Ft),w(Ft,Et),w(Et,Ot),w(Ot,At),w(Et,Tt),w(Et,It),w(It,Dt),Wt=!0,Nt||(Ut=[O(n,"click",A(e[13])),O(D,"change",e[6]),O(Q,"change",e[6]),O(Pe,"change",e[6]),O(qe,"change",e[6]),O(Qe,"change",e[6]),O(dt,"change",e[6]),O(Ct,"change",e[6]),O(Ot,"click",e[9]),O(It,"click",e[8]),O(a,"submit",A(e[11])),g(un.call(null,t)),O(t,"click_outside",e[14])],Nt=!0)},p(e,n){4&n&&N(o,"blink",e[2]),e[3]?Ht&&(Ht.d(1),Ht=null):Ht?Ht.p(e,n):(Ht=dn(e),Ht.c(),Ht.m(l,null));const r={};1&n&&(r.kmlColor=e[0].routeColor),v.$set(r),(!Wt||2&n&&y!==(y=m(e[1])+" svelte-5yl5q3"))&&S(h,"class",y);const s={};1&n&&(s.selected=e[0].routePin),x.$set(s),(!Wt||2&n&&C!==(C=m(e[1])+" svelte-5yl5q3"))&&S(b,"class",C),(!Wt||1&n&&z!==(z=e[0].alternateDisplay))&&(D.checked=z);const i={};1&n&&(i.kmlColor=e[0].alternateColor),U.$set(i),(!Wt||2&n&&H!==(H=m(e[1])+" svelte-5yl5q3"))&&S(G,"class",H);const a={};1&n&&(a.selected=e[0].alternatePin),K.$set(a),(!Wt||2&n&&X!==(X=m(e[1])+" svelte-5yl5q3"))&&S(Z,"class",X),(!Wt||1&n&&ee!==(ee=e[0].natDisplay))&&(Q.checked=ee);const c={};1&n&&(c.kmlColor=e[0].natColor),se.$set(c),(!Wt||2&n&&ce!==(ce=m(e[1])+" svelte-5yl5q3"))&&S(re,"class",ce);const u={};1&n&&(u.selected=e[0].natPin),de.$set(u),(!Wt||2&n&&ge!==(ge=m(e[1])+" svelte-5yl5q3"))&&S(pe,"class",ge),(!Wt||1&n&&Ce!==(Ce=e[0].greatCircleDisplay))&&(Pe.checked=Ce);const p={};1&n&&(p.kmlColor=e[0].greatCircleColor),Ae.$set(p),(!Wt||2&n&&Se!==(Se=m(e[1])+" svelte-5yl5q3"))&&S(ye,"class",Se),(!Wt||1&n&&Re!==(Re=e[0].ogimetDisplay))&&(qe.checked=Re);const d={};1&n&&(d.kmlColor=e[0].ogimetColor),Be.$set(d),(!Wt||2&n&&Ze!==(Ze=m(e[1])+" svelte-5yl5q3"))&&S(Ie,"class",Ze),(!Wt||1&n&&et!==(et=e[0].etopsDisplay))&&(Qe.checked=et);const f={};1&n&&(f.kmlColor=e[0].etopsColor),st.$set(f),(!Wt||2&n&&it!==(it=m(e[1])+" svelte-5yl5q3"))&&S(Je,"class",it),(!Wt||1&n&&mt!==(mt=e[0].airportDisplay))&&(dt.checked=mt);const g={};1&n&&(g.selected=e[0].airportPin),yt.$set(g),(!Wt||2&n&&$t!==($t=m(e[1])+" svelte-5yl5q3"))&&S(lt,"class",$t),(!Wt||1&n&&Lt!==(Lt=e[0].firDisplay))&&(Ct.checked=Lt),(!Wt||2&n&&jt!==(jt=m(e[1])+" svelte-5yl5q3"))&&S(wt,"class",jt),(!Wt||16&n&&St!==(St=!e[4]))&&(Ot.disabled=St),(!Wt||16&n&&zt!==(zt=!e[4]))&&(It.disabled=zt),(!Wt||2&n&&qt!==(qt=m(e[1])+" svelte-5yl5q3"))&&S(Et,"class",qt),32&n&&N(t,"sidebar",e[5])},i(e){Wt||(be(v.$$.fragment,e),be(x.$$.fragment,e),be(U.$$.fragment,e),be(K.$$.fragment,e),be(se.$$.fragment,e),be(de.$$.fragment,e),be(Ae.$$.fragment,e),be(Be.$$.fragment,e),be(st.$$.fragment,e),be(yt.$$.fragment,e),ae((()=>{Rt||(Rt=ke(t,Ue,{duration:300,x:200,y:0},!0)),Rt.run(1)})),Wt=!0)},o(e){xe(v.$$.fragment,e),xe(x.$$.fragment,e),xe(U.$$.fragment,e),xe(K.$$.fragment,e),xe(se.$$.fragment,e),xe(de.$$.fragment,e),xe(Ae.$$.fragment,e),xe(Be.$$.fragment,e),xe(st.$$.fragment,e),xe(yt.$$.fragment,e),Rt||(Rt=ke(t,Ue,{duration:300,x:200,y:0},!1)),Rt.run(0),Wt=!1},d(e){e&&P(t),Ht&&Ht.d(),je(v),je(x),je(U),je(K),je(se),je(de),je(Ae),je(Be),je(st),je(yt),e&&Rt&&Rt.end(),Nt=!1,s(Ut)}}}function dn(t){let n,o,r;return{c(){n=L("button"),n.textContent="Revenir aux valeurs par d√©faut",S(n,"class","btn btn-link btn-sm reset svelte-5yl5q3"),S(n,"type","button")},m(e,s){k(e,n,s),o||(r=O(n,"click",t[7]),o=!0)},p:e,d(e){e&&P(n),o=!1,r()}}}function mn(e){let t,n,o,r,s,i,a,l,c=e[5]&&pn(e);return{c(){t=L("a"),n=j("svg"),o=j("use"),r=F(),c&&c.c(),s=E(),I(o,"xlink:href","#bars"),S(n,"class","svelte-5yl5q3"),N(n,"blink",e[3]),S(t,"class","hamburger svelte-5yl5q3"),S(t,"role","button"),S(t,"href",".")},m(u,p){k(u,t,p),w(t,n),w(n,o),k(u,r,p),c&&c.m(u,p),k(u,s,p),i=!0,a||(l=O(t,"click",A(e[12])),a=!0)},p(e,[t]){8&t&&N(n,"blink",e[3]),e[5]?c?(c.p(e,t),32&t&&be(c,1)):(c=pn(e),c.c(),be(c,1),c.m(s.parentNode,s)):c&&(ye(),xe(c,1,1,(()=>{c=null})),$e())},i(e){i||(be(c),i=!0)},o(e){xe(c),i=!1},d(e){e&&P(t),e&&P(r),c&&c.d(e),e&&P(s),a=!1,l()}}}function fn(e,t){return JSON.stringify(e)===JSON.stringify(t)}function gn(e,t,n){let o,r,s;l(e,tn,(e=>n(5,s=e)));const i=Y(),a=dt.optionsKML;let{kmlOptions:c}=t,{mode:u="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,p={...Qe,...mt.getItem(a)||{}},d=fn(Qe,c);function m(e){let t=!1;for(const[r,s]of Object.entries(e))c[r]!==s&&(n(0,c[r]=s,c),i("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:s}),t=!0);var o;t&&n(0,c={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,c=e.kmlOptions),"mode"in e&&n(1,u=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,o=fn(Qe,c)),1025&e.$$.dirty&&n(4,r=!fn(p,c))},[c,u,d,o,r,s,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));c[r]!==o&&(n(0,c[r]=o,c),i("change",{name:t,value:o}))},function(){m(Qe)},function(){m(p)},function(){if(o)mt.removeItem(a);else{const e={};for(const t of Object.keys(c).filter((e=>c[e]!==Qe[e])))e[t]=c[t];mt.setItem(a,e)}i("save"),n(10,p={...c})},p,function(t){Q(e,t)},()=>{f(tn,s=!s,s),n(2,d=!1)},()=>{f(tn,s=!s,s),n(2,d=!1)},()=>f(tn,s=!1,s)]}class hn extends Fe{constructor(e){super(),Me(this,e,gn,mn,a,{kmlOptions:0,mode:1})}}const vn="airport-layer",yn="airport-emer-layer",$n="airport-source",bn=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),xn=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],wn=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],kn=e=>0===e?3:0,Pn=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function Cn(e,t){const{map:n}=e;n.getLayer(vn)&&n.setLayoutProperty(vn,"visibility",t?"visible":"none"),n.getLayer(yn)&&n.setLayoutProperty(yn,"visibility",t?"visible":"none")}var Ln={show:e=>Cn(e,!0),hide:e=>Cn(e,!1),remove:()=>{},add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r}=e,{affineOrDrop:s}=n,i=s;let a=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(a=[o.infos.EEP,o.infos.EXP]);const l=o.isFake?o.isFake:o.infos.aircraft,c=o.infos.raltPoints,u=r.etopsColor,p=r.airportPin,d=r.airportDisplay,[m]=st(u),f=a.map((e=>e.name)),g=c.map((e=>e.name)),h=f.concat(g);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((e=>{if(i){const t=[];for(let n of e.features)n.geometry.coordinates=i(n.geometry.coordinates),void 0!==n.geometry.coordinates&&t.push(n);e.features=t}t.addSource($n,{type:"geojson",data:e}),t.addLayer({id:yn,type:"symbol",source:$n,layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:xn(l,!1)}),t.addLayer({id:vn,type:"symbol",source:$n,layout:{"icon-image":["case",["in",["get","name"],["literal",h]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",h]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",h]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":wn(l,h)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":kn(p),"icon-color":bn(p,l,g,m),"text-color":Pn(g,m),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:xn(l)});const n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!Te}),o=function(e){const o=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.title;for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;n.setLngLat(o).setHTML(r).addTo(t)},r=()=>t.getCanvas().style.cursor="pointer",s=()=>t.getCanvas().style.cursor="",a=function(){s(),n.remove()};Te?(t.on("mouseenter",vn,(e=>{r(),o(e)})),t.on("mouseenter",yn,(e=>{r(),o(e)})),t.on("mouseleave",vn,a),t.on("mouseleave",yn,a)):(t.on("mouseenter",vn,r),t.on("mouseenter",yn,r),t.on("click",vn,o),t.on("click",yn,o),t.on("mouseleave",vn,s),t.on("mouseleave",yn,s))}))},changeLine:()=>{},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,s=o.isFake?[]:o.infos.ralts,[i]=st(n.etopsColor),a=n.airportPin;t.getLayer(vn)&&(t.setPaintProperty(vn,"icon-color",bn(a,r,s,i)),t.setPaintProperty(vn,"text-color",Pn(s,i)),t.setPaintProperty(vn,"icon-halo-width",kn(a)))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,s=r.isFake?[]:r.infos.ralts,[i]=st(n.etopsColor),a=n.airportPin;let l=[];r.infos.EEP&&r.infos.EXP&&r.infos.raltPoints.length>0&&(l=[r.infos.EEP.name,r.infos.EXP.name]);const c=l.concat(s);t.setFilter(vn,xn(o)),t.setPaintProperty(vn,"icon-color",bn(a,o,s,i)),t.setLayoutProperty(vn,"symbol-sort-key",wn(o,c)),t.setFilter(yn,xn(o,!1))}};function _n(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function jn(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Mn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const Fn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function En(e,t,n,o,r,s,i){e.addSource(`${t}-marker-source`,jn(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>_n(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(Sn(t,r,i,s))}function On(e,t,n,o,r,s){o?e.addSource(`${t}-line-source`,jn(o(n).map((e=>Mn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:Mn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(Tn(t,r,s))}function An(e,t,n,o,r,s){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(Mn(t[e]))}e.addSource(`${t}-line-source`,jn(s))}else e.addSource(`${t}-line-source`,jn(n.map((e=>Mn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(Tn(t,r,s))}function Sn(e,t,n,o){const[r,s]=st(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?Fn[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function Tn(e,t,n){const[o,r]=st(t);let s=2,i=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,i=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":i}}}function In(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,s=`${e}-marker-layer`;if(n.getLayer(s)&&n.getLayer(r)){const e=o,t=Fn[e],i=n.getPaintProperty(r,"line-color");n.setPaintProperty(s,"icon-color",0!==e?t:i),n.setPaintProperty(s,"text-color",i),n.setLayoutProperty(s,"icon-size",0!==e?1:.2),n.setLayoutProperty(s,"icon-image",0!==e?"sdf-marker-15":"sdf-triangle"),n.setLayoutProperty(s,"icon-anchor",0!==e?"bottom":"center")}}function Dn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,s=`${e}-marker-layer`,[i,a]=st(o);n.getLayer(r)&&(n.setPaintProperty(r,"line-color",i),n.setPaintProperty(r,"line-opacity",a)),n.getLayer(s)&&n.setPaintProperty(s,"text-color",i)}function zn(e,t,n){const{map:o}=n,r=`${e}-line-layer`,s=`${e}-marker-layer`;o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(s)&&o.setLayoutProperty(s,"visibility",t?"visible":"none")}const qn="etops-ep-circle-line-layer",Rn="etops-etops-circle-line-layer";function Wn(e,t){const{map:n}=e;n.getLayer(Rn)&&n.setLayoutProperty(Rn,"visibility",t?"visible":"none"),n.getLayer(qn)&&n.setLayoutProperty(qn,"visibility",t?"visible":"none")}var Nn={show:e=>Wn(e,!0),hide:e=>Wn(e,!1),remove:()=>{},add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(!o.isFake&&o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n;o.infos.EEP,o.infos.EXP;const s=o.infos.ETOPS,i=r.etopsDisplay;An(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,i),An(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*s))),e,r.etopsColor,i)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=st(e.value);t.getLayer(Rn)&&(t.setPaintProperty(Rn,"line-color",n),t.setPaintProperty(Rn,"line-opacity",o))}(e),changeMarker:()=>{},change:()=>{}};const Gn="fir-reg-line-layer",Un="fir-reg-layer",Hn="fir-reg-source";function Bn(e,t){const{map:n}=e;n.getLayer(Un)&&n.setLayoutProperty(Un,"visibility",t?"visible":"none"),n.getLayer(Gn)&&n.setLayoutProperty(Gn,"visibility",t?"visible":"none")}var Zn={show:e=>Bn(e,!0),hide:e=>Bn(e,!1),remove:()=>{},add:e=>{const{map:t,mapData:n,kmlOptions:o,mapOptions:r}=e;if("jb_pacific"===r.id)return;const{affine:s}=n,i=o.firDisplay;fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((e=>{if(s)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>s(e)))]}t.addSource(Hn,{type:"geojson",data:e}),t.addLayer({id:Un,type:"fill",source:Hn,layout:{visibility:i?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),t.addLayer({id:Gn,type:"line",source:Hn,layout:{visibility:i?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))},changeLine:()=>{},changeMarker:()=>{},change:()=>{}};const Kn="great-circle";var Xn={show:zn.bind(null,Kn,!0),hide:zn.bind(null,Kn,!1),remove:()=>{},add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r}=e;if(t.isFake)return;const{affineAndClip:s}=o,i=`${t.infos.departure}-${t.infos.destination}`,a=t.route,l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${i}`});On(r,Kn,l.points,s,n.greatCircleColor,n.greatCircleDisplay)},changeLine:Dn.bind(null,Kn),changeMarker:In.bind(null,Kn)};const Jn="ogimet";var Vn={show:zn.bind(null,Jn,!0),hide:zn.bind(null,Jn,!1),remove:()=>{},add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:s}=r;On(t,Jn,n.ogimetData.route.points,s,o.ogimetColor,o.ogimetDisplay)},changeLine:Dn.bind(null,Jn),changeMarker:In.bind(null,Jn)};const Yn="ralt";var Qn={show:zn.bind(null,Yn,!0),hide:zn.bind(null,Yn,!1),remove:()=>{},add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:s,affineOrDrop:i}=r,a=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route D√©gagement"});On(t,Yn,a.points,s,o.alternateColor,o.alternateDisplay),En(t,Yn,a.points,i,o.alternatePin,o.alternateDisplay,o.alternateColor)},changeLine:Dn.bind(null,Yn),changeMarker:In.bind(null,Yn),change:()=>{}};const eo="rmain";var to={show:zn.bind(null,eo,!0),hide:zn.bind(null,eo,!1),remove:()=>{},add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:s,affineOrDrop:i}=r,a=n.route;a.name=`${n.infos.departure}-${n.infos.destination}`,a.description=n.description,On(t,eo,a.points,s,o.routeColor,!0),En(t,eo,a.points,i,o.routePin,!0,o.routeColor)},changeLine:e=>Dn(eo,e)&&function(e){const{map:t,kmlOptions:n}=e,[o,r]=st(n.routeColor);t.getLayer(qn)&&(t.setPaintProperty(qn,"line-color",o),t.setPaintProperty(qn,"line-opacity",r))}(e),changeMarker:In.bind(null,eo),change:()=>{}};const no="rnat";const oo={airport:Ln,etops:Nn,fir:Zn,greatcircle:Xn,ogimet:Vn,ralt:Qn,rmain:to,rnat:{show:e=>zn(no,!0,e)&&zn("rnat-incomplete",!0,e),hide:e=>zn(no,!1,e)&&zn("rnat-incomplete",!1,e),remove:()=>{},add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r}=e;if(n.isFake)return;const{affineOrDrop:s,affineAndClip:i}=o,a=s,l=i,c=r.natColor,u=r.natPin,p=r.natDisplay,d={rnat:[],"rnat-incomplete":[]},m={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(l){const n=l(e.points),o=n.length;for(let r=0;r<o;r++)d[t].push(Mn(n[r],e.name))}else d[t].push(Mn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const n=e.points[0];let o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude];if(o&&m[t].push(_n(o,`${e.name}\n${n.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];o=a?a([n.longitude,n.latitude]):[n.longitude,n.latitude],o&&m[t].push(_n(o,`${e.name}\n${n.name}`,e.description))}}t.addSource("rnat-marker-source",jn(m.rnat)),t.addSource("rnat-incomplete-marker-source",jn(m["rnat-incomplete"])),t.addSource("rnat-line-source",jn(d.rnat)),t.addSource("rnat-incomplete-line-source",jn(d["rnat-incomplete"])),t.addLayer(Tn("rnat",c,p)),t.addLayer(Tn("rnat-incomplete",r.natIncompleteColor,p)),t.addLayer(Sn("rnat",u,c,p)),t.addLayer(Sn("rnat-incomplete",u,c,p));const f=e=>{for(var n=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties.description;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(t)},g=e=>{const n=e+"-marker-layer";t.on("click",n,f),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};g("rnat"),g("rnat-incomplete")},changeLine:Dn.bind(null,no),changeMarker:In.bind(null,no),change:()=>{}}},ro=2*Math.PI,so=Math.PI/4,io=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*ro};var ao={init:function(){},forward:function(e){var t=e.x,n=e.y,o=io(t-this.long0),r=Math.tan(n/2),s=Math.sin(so*r),i=s*s,a=this.x0+this.a*o*(.74482-.34588*i),l=this.y0+1.70711*this.a*r;return e.x=a,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(so*t),o=n*n,r=io(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};function lo(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(ao);let s={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${t.id.startsWith("jb_")?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR ¬© Olivier Ravet`};const i=new mapboxgl.Map({...t.mapboxOptions,...s});let a,l,c,u;i._setCacheLimits(320,32),i.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||i.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||i.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||i.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),i.loadImage("sdf/map-star-sdf.png",(function(e,t){e||i.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let p,d=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],i=s[2]-s[0],a=s[3]-s[1],[l,c,u,p]=t.extent,[d,m]=t.ratio,f=i/d*m*(a/i),[g,h,v,y]=[s[0],s[3]-f,s[2],s[3]];e=(v-g)/(u-l),n=g-e*l,o=(y-h)/(p-c),r=h-o*c}else{const[s,i,a,l]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(a-s),n=c-e*s,o=(d-u)/(l-i),r=u-o*i}const[s,i,p,f]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>m(h(e));d=e=>h(g(e)),a=e=>m(d(e)),l=e=>{let[t,n]=g(e);return t=De(t,s,p),n=De(n,i,f),v([t,n])},c=e=>{let[t,n]=g(e);if(ze(t,s,p)&&ze(n,i,f))return v([t,n])},u=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,i,a,l=e.length,c=Re(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],i=a=Re(s=e[o],t);;){if(!(c|i)){u.push(r),i!==a?(u.push(s),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(s);break}if(c&i)break;c?c=Re(r=qe(r,s,c,t),t):i=Re(s=qe(r,s,i,t),t)}c=a}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let f=[];if(!n.isFake){for(const e of n.tracks)f=f.concat(e.points);f=f.concat(n.route.points,n.wptCoordinatesAlternate()),p=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(f,l),i.fitBounds(p,{padding:{top:30,bottom:80,left:30,right:30}})}const g=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(a){const e=g._onSuccess;g._onSuccess=function(t){const[n,o]=a([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const h={map:i,affine:a,affineAndClamp:l,affineAndClip:u,affineOrDrop:c,bbox:p,mapOptions:t};return i.addControl(g),i.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),Object.values(oo).forEach((t=>t.add(e)))})({ofp:n,kmlOptions:o,mapData:h,map:i,mapOptions:t}),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2"),r&&r(i,t)})),h}class co{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const s=indexedDB.open(e,t);s.onsuccess=()=>{o(s)},s.onerror=()=>{r("Error while opening DB")},s.onupgradeneeded=n?n.bind(null,s):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const s=n.result.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{o(s.result)},s.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,s)=>{const i=o.result.transaction(t,"readwrite").objectStore(t),a=i.put(n,e);a.onsuccess=()=>{const t=i.get(e);t.onsuccess=()=>{r(t.result)}},a.onerror=()=>{s("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,s)=>{const i=o.result.transaction(e,"readonly").objectStore(e).getKey(n);i.onsuccess=()=>{r(void 0===i.result?t:null)},i.onerror=()=>{s("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function uo(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function po(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const mo=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(e.isFake||void 0===n)return[];const s=new co("lido-tiles");if(o.cacheAll){const e=await s.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return s.close(),caches[o.id]=!0,[]}const[i,a]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,p;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:uo(i[0],e),y:po(i[1],e)},r={x:uo(a[0],e),y:po(a[1],e)}),o.matrix?[u,p]=o.matrix[e]:[u,p]=[c,c];for(let i=t.x;i<=r.x;i++)for(let a=r.y;a<=t.y;a++)if(i>=0&&a>=0&&i<u&&a<p){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",i).replace("{y}",a)),l.push(s.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.63g5ah66/${e}/${i}/${a}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${e}/${i}/${a}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(s.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return s.close(),c.filter((e=>null!==e))};function fo(e){let t,n,o,r,s,i;const a=e[4].default,l=c(a,e,e[3],null);return{c(){t=j("svg"),n=j("path"),o=j("path"),s=F(),l&&l.c(),S(n,"d","M50,5A45 45 0 1 1 49.9999 5"),S(n,"class","svelte-1bp2w4i"),S(o,"d",r=e[0]()),S(o,"class","svelte-1bp2w4i"),S(t,"viewBox","0 0 100 100"),S(t,"class","svelte-1bp2w4i")},m(e,r){k(e,t,r),w(t,n),w(t,o),k(e,s,r),l&&l.m(e,r),i=!0},p(e,[t]){(!i||1&t&&r!==(r=e[0]()))&&S(o,"d",r),l&&l.p&&8&t&&p(l,a,e,e[3],t,null,null)},i(e){i||(be(l,e),i=!0)},o(e){xe(l,e),i=!1},d(e){e&&P(t),e&&P(s),l&&l.d(e)}}}function go(e,t,n){let o,{$$slots:r={},$$scope:s}=t,{value:i=0}=t,{max:a=100}=t;return e.$$set=e=>{"value"in e&&n(1,i=e.value),"max"in e&&n(2,a=e.max),"$$scope"in e&&n(3,s=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(i<=0)return"";if(i>=a)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(i/a),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,i,a,s,r]}class ho extends Fe{constructor(e){super(),Me(this,e,go,fo,a,{value:1,max:2})}}function vo(e,t,n){const o=e.slice();return o[13]=t[n],o}function yo(e){let t,n,o,r,i,a=wo,l=[];for(let t=0;t<a.length;t+=1)l[t]=$o(vo(e,a,t));return{c(){t=L("div"),n=L("select"),o=L("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,S(n,"class","form-control-sm svelte-14yxy04"),n.disabled=e[0],S(t,"class","footer svelte-14yxy04")},m(s,a){k(s,t,a),w(t,n),w(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);r||(i=[O(n,"click",e[4],{once:!0}),O(n,"change",e[6])],r=!0)},p(e,t){if(0&t){let o;for(a=wo,o=0;o<a.length;o+=1){const r=vo(e,a,o);l[o]?l[o].p(r,t):(l[o]=$o(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}1&t&&(n.disabled=e[0])},d(e){e&&P(t),C(l,e),r=!1,s(i)}}}function $o(t){let n,o,r=t[13]+"";return{c(){n=L("option"),o=M(r),n.__value=t[13],n.value=n.__value},m(e,t){k(e,n,t),w(n,o)},p:e,d(e){e&&P(n)}}}function bo(t){let n,o,r,i,a,l,c,u,p,d=!t[3]&&yo(t);return{c(){n=L("div"),o=L("input"),r=F(),i=L("label"),a=M(t[1]),l=F(),d&&d.c(),c=E(),S(o,"id",Po),S(o,"name",Po),S(o,"type","file"),S(o,"accept","application/pdf"),o.disabled=t[0],S(o,"class","custom-file-input svelte-14yxy04"),S(i,"class","custom-file-label text-truncate svelte-14yxy04"),S(i,"for",Po),N(i,"ready",t[2]),S(n,"class","custom-file svelte-14yxy04"),N(n,"blink",!t[3])},m(e,s){k(e,n,s),w(n,o),w(n,r),w(n,i),w(i,a),k(e,l,s),d&&d.m(e,s),k(e,c,s),u||(p=[O(o,"change",t[5]),O(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){1&t&&(o.disabled=e[0]),2&t&&D(a,e[1]),4&t&&N(i,"ready",e[2]),8&t&&N(n,"blink",!e[3]),e[3]?d&&(d.d(1),d=null):d?d.p(e,t):(d=yo(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&P(n),e&&P(l),d&&d.d(e),e&&P(c),u=!1,s(p)}}}const xo=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.6.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.6.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],wo=["318","319","320","321","330","340","350","380","787","772","773","77F"],ko=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let Po="file";function Co(e,t,n){let o,r;l(e,on,(e=>n(9,o=e))),l(e,nn,(e=>n(3,r=e)));let s,{kmlOptions:i}=t,a=!1,c=new Ee,u="Choisir un OFP",p=!1;const d=Y();function m(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,i=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(i.crossOrigin="anonymous");let a=!0;s?(i.src=t,i.async=n.async,i.defer=n.defer):(i.href=t,"prefetch"in n?(i.rel="prefetch",o-=1,a=!1):"preload"in n?(i.rel="preload",o-=1,a=!1):(i.rel="stylesheet",o-=1,a=!1)),a&&(i.onload=r),document.body.appendChild(i)}))}(xo,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",s&&!s.destroyed||(s=new e.PDFWorker),c.resolve(!0),n(2,p=!0)}))}const g=e=>{const t=new FileReader;return f(on,o=!1,o),new Promise(((n,o)=>{t.onload=e=>{if(!s||s.destroyed){const e=window["pdfjs-dist/build/pdf"];s=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await ko(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:s}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const s=editolido.ogimetData(t,r);s.proxyImg=`https://ofp2map-gramet.vercel.app/api/${s.proxy}__${s.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,s.route.description=s.wmo.join(" "),t.ogimetData=s;try{tt();nt(t,i),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>o(e)))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(7,i=e.kmlOptions)},[a,u,p,r,m,async function(e){n(0,a=!0),m(),await c.promise.then((()=>{const t=e.target.files[0];t&&(n(1,u=e.target.value.split(/([\\/])/g).pop()),d("change",u),f(nn,r=g(t),r),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))})),n(0,a=!1)},async function(e){n(0,a=!0),m(),await c.promise.then((()=>{f(on,o=!0,o),f(nn,r=new Promise(((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{tt();nt(o,i),t(o)}catch(e){n(e)}})),r),window.location.hash="#/map"})),n(0,a=!1)},i]}class Lo extends Fe{constructor(e){super(),Me(this,e,Co,bo,a,{kmlOptions:7})}}function _o(e,t,n){const o=e.slice();return o[6]=t[n],o}function jo(e){let t;return{c(){t=L("option"),t.textContent="???",t.__value="???",t.value=t.__value,t.selected=!0},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function Mo(e){let t,n,o,r=e[6]+"";return{c(){t=L("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){k(e,t,o),w(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&P(t)}}}function Fo(t){let n,o,r,i,a="???"===t[0]&&jo(),l=wo,c=[];for(let e=0;e<l.length;e+=1)c[e]=Mo(_o(t,l,e));return{c(){n=L("select"),a&&a.c(),o=E();for(let e=0;e<c.length;e+=1)c[e].c();S(n,"name","aircraftType"),S(n,"class","svelte-1xpiicm"),void 0===t[0]&&ae((()=>t[5].call(n)))},m(e,s){k(e,n,s),a&&a.m(n,null),w(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[4](n),R(n,t[0]),r||(i=[O(n,"change",t[5]),O(n,"change",t[3])],r=!0)},p(e,[t]){if("???"===e[0]?a||(a=jo(),a.c(),a.m(n,o)):a&&(a.d(1),a=null),1&t){let o;for(l=wo,o=0;o<l.length;o+=1){const r=_o(e,l,o);c[o]?c[o].p(r,t):(c[o]=Mo(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}1&t&&R(n,e[0])},i:e,o:e,d(e){e&&P(n),a&&a.d(),C(c,e),t[4](null),r=!1,s(i)}}}function Eo(e,t,n){let{selectedAircraft:o="???"}=t,{aircraftTypeSelectElement:r=null}=t,{ofp:s}=t;return V((()=>{"???"===o&&s&&n(0,o=s.isFake?s.isFake:s.infos.aircraft),-1===wo.indexOf(o)&&n(0,o="???")})),e.$$set=e=>{"selectedAircraft"in e&&n(0,o=e.selectedAircraft),"aircraftTypeSelectElement"in e&&n(1,r=e.aircraftTypeSelectElement),"ofp"in e&&n(2,s=e.ofp)},[o,r,s,function(t){Q(e,t)},function(e){te[e?"unshift":"push"]((()=>{r=e,n(1,r)}))},function(){o=W(this),n(0,o)}]}class Oo extends Fe{constructor(e){super(),Me(this,e,Eo,Fo,a,{selectedAircraft:0,aircraftTypeSelectElement:1,ofp:2})}}const Ao={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},So=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,To=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv1",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Ao,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:So},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Ao,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:So},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Ao,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:So},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:Ao,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:So}];function Io(e,t,n){const o=e.slice();return o[6]=t[n],o[8]=n,o}function Do(e){let t,n,o,r=(e[6].proj4&&e[2](e[6])?`${e[6].label.toUpperCase()}`:e[6].label)+"";return{c(){t=L("option"),n=M(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6].id===e[0].id},m(e,o){k(e,t,o),w(t,n)},p(e,n){1&n&&o!==(o=e[6].id===e[0].id)&&(t.selected=o)},d(e){e&&P(t)}}}function zo(t){let n,o,r,i=To,a=[];for(let e=0;e<i.length;e+=1)a[e]=Do(Io(t,i,e));return{c(){n=L("select");for(let e=0;e<a.length;e+=1)a[e].c();S(n,"name",t[1]),S(n,"class","form-control form-control-sm svelte-1uc3ace"),void 0===t[0]&&ae((()=>t[5].call(n)))},m(e,s){k(e,n,s);for(let e=0;e<a.length;e+=1)a[e].m(n,null);R(n,t[0]),o||(r=[O(n,"change",t[5]),O(n,"change",t[4])],o=!0)},p(e,[t]){if(5&t){let o;for(i=To,o=0;o<i.length;o+=1){const r=Io(e,i,o);a[o]?a[o].p(r,t):(a[o]=Do(r),a[o].c(),a[o].m(n,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=i.length}2&t&&S(n,"name",e[1]),1&t&&R(n,e[0])},i:e,o:e,d(e){e&&P(n),C(a,e),o=!1,s(r)}}}function qo(e,t,n){let{name:o="map-style"}=t,{ofp:r}=t,{selected:s=To[0]}=t;return V((()=>{if(s.id===To[0].id&&r&&!r.isFake){const e=r.route.points[0],t=r.route.points[r.route.points.length-1];t.latitude>30&&e.latitude>30?n(0,s=To[1]):t.longitude<-80&&e.longitude<-80?n(0,s=To[3]):n(0,s=To[2])}})),e.$$set=e=>{"name"in e&&n(1,o=e.name),"ofp"in e&&n(3,r=e.ofp),"selected"in e&&n(0,s=e.selected)},[s,o,function(e){if(!e.proj4||!r||r.isFake)return!0;const t=r.route.points[0],n=r.route.points[r.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},r,function(t){Q(e,t)},function(){s=W(this),n(0,s)}]}class Ro extends Fe{constructor(e){super(),Me(this,e,qo,zo,a,{name:1,ofp:3,selected:0})}}function Wo(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const s=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",s,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",s),n&&n.remove()}}}function No(e){let t,n,o,r,s;return n=new ho({props:{value:e[8],max:e[7],$$slots:{default:[Go]},$$scope:{ctx:e}}}),{c(){t=L("div"),Le(n.$$.fragment),S(t,"class","cacheButton svelte-13482y7"),N(t,"cacheError",e[9]),N(t,"cacheProgress",e[8]>0||e[7]>0)},m(a,l){k(a,t,l),_e(n,t,null),o=!0,r||(s=O(t,"click",(function(){i(e[11]?Ho:e[17])&&(e[11]?Ho:e[17]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const s={};256&r&&(s.value=e[8]),128&r&&(s.max=e[7]),33554432&r&&(s.$$scope={dirty:r,ctx:e}),n.$set(s),512&r&&N(t,"cacheError",e[9]),384&r&&N(t,"cacheProgress",e[8]>0||e[7]>0)},i(e){o||(be(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){e&&P(t),je(n),r=!1,s()}}}function Go(e){let t;const n=e[19].default,o=c(n,e,e[25],null),r=o||function(e){let t;return{c(){t=L("span"),t.textContent="‚Üì",S(t,"class","svelte-13482y7")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}();return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){o&&o.p&&33554432&t&&p(o,n,e,e[25],t,null,null)},i(e){t||(be(r,e),t=!0)},o(e){xe(r,e),t=!1},d(e){r&&r.d(e)}}}function Uo(e){let t,n,o,r,s,a,l,c,u,p,d,m,f,h,v,y,$;function b(t){e[20](t)}let x={ofp:e[1]};void 0!==e[4]&&(x.selected=e[4]),s=new Ro({props:x}),te.push((()=>Ce(s,"selected",b))),s.$on("change",e[14]);let C=e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]&&No(e);function _(t){e[21](t)}function j(t){e[22](t)}let M={ofp:e[1]};function E(t){e[23](t)}void 0!==e[5]&&(M.selectedAircraft=e[5]),void 0!==e[6]&&(M.aircraftTypeSelectElement=e[6]),u=new Oo({props:M}),te.push((()=>Ce(u,"selectedAircraft",_))),te.push((()=>Ce(u,"aircraftTypeSelectElement",j))),u.$on("change",e[15]);let O={};return void 0!==e[0]&&(O.kmlOptions=e[0]),f=new hn({props:O}),te.push((()=>Ce(f,"kmlOptions",E))),f.$on("change",e[16]),f.$on("save",e[24]),{c(){t=L("div"),o=F(),r=L("div"),Le(s.$$.fragment),l=F(),C&&C.c(),c=F(),Le(u.$$.fragment),m=F(),Le(f.$$.fragment),S(t,"id",e[2]),S(t,"class","svelte-13482y7"),S(r,"class","mapmenu svelte-13482y7")},m(i,a){k(i,t,a),k(i,o,a),k(i,r,a),_e(s,r,null),w(r,l),C&&C.m(r,null),k(i,c,a),_e(u,i,a),k(i,m,a),_e(f,i,a),v=!0,y||($=g(n=Wo.call(null,t,e[3])),y=!0)},p(e,[o]){(!v||4&o)&&S(t,"id",e[2]),n&&i(n.update)&&8&o&&n.update.call(null,e[3]);const l={};2&o&&(l.ofp=e[1]),!a&&16&o&&(a=!0,l.selected=e[4],le((()=>a=!1))),s.$set(l),e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]?C?(C.p(e,o),13330&o&&be(C,1)):(C=No(e),C.c(),be(C,1),C.m(r,null)):C&&(ye(),xe(C,1,1,(()=>{C=null})),$e());const c={};2&o&&(c.ofp=e[1]),!p&&32&o&&(p=!0,c.selectedAircraft=e[5],le((()=>p=!1))),!d&&64&o&&(d=!0,c.aircraftTypeSelectElement=e[6],le((()=>d=!1))),u.$set(c);const m={};!h&&1&o&&(h=!0,m.kmlOptions=e[0],le((()=>h=!1))),f.$set(m)},i(e){v||(be(s.$$.fragment,e),be(C),be(u.$$.fragment,e),be(f.$$.fragment,e),v=!0)},o(e){xe(s.$$.fragment,e),xe(C),xe(u.$$.fragment,e),xe(f.$$.fragment,e),v=!1},d(e){e&&P(t),e&&P(o),e&&P(r),je(s),C&&C.d(),e&&P(c),je(u,e),e&&P(m),je(f,e),y=!1,$()}}}const Ho=()=>!1;function Bo(e,t,n){let o,r;l(e,ln,(e=>n(13,r=e)));let{$$slots:s={},$$scope:i}=t;const a=Y();let c,u,p,d,m,{kmlOptions:f}=t,{ofp:g}=t,h=0,v=0,y=!1,$=[];const b={};let{id:x="map"}=t;async function w(){n(18,$=await mo(g,u));const e=document.querySelector(`#${x} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(m),e.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`)))}const k=e=>{(e=>{const{name:t,value:n}=e,o=Ie(t),r=oo[o];r&&(t.endsWith("-display")?n?r.show(e):r.hide(e):t.endsWith("-pin")?r.changeMarker(e):t.endsWith("-color")?r.changeLine(e):t.endsWith("-change")&&r.change(e))})({map:c,mapData:u,name:e.detail.name,value:e.detail.value,ofp:g,kmlOptions:f,aircraftType:d}),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-"))return;const n=tt(),o=Ie(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),a("save")};let P=!1;return V((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",u=lo(x,p,g,f,w),n(3,c=u.map)})),e.$$set=e=>{"kmlOptions"in e&&n(0,f=e.kmlOptions),"ofp"in e&&n(1,g=e.ofp),"id"in e&&n(2,x=e.id),"$$scope"in e&&n(25,i=e.$$scope)},e.$$.update=()=>{262144&e.$$.dirty&&n(12,o=0===$.length)},[f,g,x,c,p,d,m,h,v,y,b,P,o,r,function(e){e.target.blur(),c&&c.remove(),n(8,v=0),n(9,y=!1),n(18,$=[]),n(7,h=0),u=lo(x,p,g,f,w),n(3,c=u.map)},function(e){e.target.blur(),k({detail:{value:d,name:"airport-change"}})},k,async e=>{if(P)return!1;n(11,P=!0);try{n(7,h=$.length),n(9,y=!1);try{await We(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(11,P=!1),n(9,y=!0),!1}n(8,v=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const s=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(s),e()),o>=5||r>n.length-1)return;const i=r++,a=n[i];o++;try{await fetch(a),t&&t()}catch{}o--,delete n[i]}),100)}))}($,(()=>n(8,v++,v))),v>=h&&(n(10,b[p.id]=!0,b),n(10,b),n(18,$=[]),n(7,h=0))}finally{n(11,P=!1)}},$,s,function(e){p=e,n(4,p)},function(e){d=e,n(5,d)},function(e){m=e,n(6,m)},function(e){f=e,n(0,f)},function(t){Q(e,t)},i]}class Zo extends Fe{constructor(e){super(),Me(this,e,Bo,Uo,a,{kmlOptions:0,ofp:1,id:2})}}function Ko(e){let t,n;return{c(){t=L("li"),n=L("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#marker"></use></svg> \n      <span class="svelte-z5ep4u">CARTE</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/map"),N(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),N(t,"active","/map"===e[0])},m(e,o){k(e,t,o),w(t,n)},p(e,o){2&o&&N(n,"disabled",!e[1]),1&o&&N(t,"active","/map"===e[0])},d(e){e&&P(t)}}}function Xo(e){let t,n;return{c(){t=L("li"),n=L("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#cloud"></use></svg> \n      <span class="svelte-z5ep4u">GRAMET</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/gramet"),N(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),N(t,"active","/gramet"===e[0])},m(e,o){k(e,t,o),w(t,n)},p(e,o){2&o&&N(n,"disabled",!e[1]),1&o&&N(t,"active","/gramet"===e[0])},d(e){e&&P(t)}}}function Jo(e){let t,n;return{c(){t=L("li"),n=L("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#export"></use></svg> \n      <span class="svelte-z5ep4u">EXPORT</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/export"),N(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),N(t,"active","/export"===e[0])},m(e,o){k(e,t,o),w(t,n)},p(e,o){2&o&&N(n,"disabled",!e[1]),1&o&&N(t,"active","/export"===e[0])},d(e){e&&P(t)}}}function Vo(t){let n,o,r,s,i,a,l,u,d,m,f,g,h,v,y=(t[1]||"/map"===t[0])&&Ko(t),$=(t[1]&&!t[2]||"/gramet"===t[0])&&Xo(t),b=(t[1]&&!t[2]||"/export"===t[0])&&Jo(t),x=navigator.share&&function(t){let n,o,r,s;return{c(){n=L("li"),o=L("a"),o.textContent="PARTAGER",S(o,"class","nav-link"),S(o,"href","."),S(n,"class","nav-item optional svelte-z5ep4u")},m(e,i){k(e,n,i),w(n,o),r||(s=O(o,"click",A(t[3])),r=!0)},p:e,d(e){e&&P(n),r=!1,s()}}}(t);const C=t[5].default,_=c(C,t,t[4],null);return{c(){n=L("nav"),o=L("ul"),r=L("li"),s=L("a"),i=j("svg"),a=j("use"),l=F(),y&&y.c(),u=F(),$&&$.c(),d=F(),b&&b.c(),m=F(),f=L("li"),f.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-z5ep4u"><use xlink:href="#info"></use></svg> \n      <span class="svelte-z5ep4u">AIDE</span></a>',g=F(),x&&x.c(),h=F(),_&&_.c(),I(a,"xlink:href","#home"),S(i,"class","svelte-z5ep4u"),S(s,"class","nav-link"),S(s,"href","#/"),S(r,"class","nav-item svelte-z5ep4u"),N(r,"active","/"===t[0]),S(f,"class","nav-item svelte-z5ep4u"),N(f,"active","/help"===t[0]),S(o,"class","navbar-nav mr-auto svelte-z5ep4u"),S(n,"class","navbar navbar-expand-md navbar-light bg-light svelte-z5ep4u")},m(e,t){k(e,n,t),w(n,o),w(o,r),w(r,s),w(s,i),w(i,a),w(o,l),y&&y.m(o,null),w(o,u),$&&$.m(o,null),w(o,d),b&&b.m(o,null),w(o,m),w(o,f),w(o,g),x&&x.m(o,null),w(n,h),_&&_.m(n,null),v=!0},p(e,[t]){1&t&&N(r,"active","/"===e[0]),e[1]||"/map"===e[0]?y?y.p(e,t):(y=Ko(e),y.c(),y.m(o,u)):y&&(y.d(1),y=null),e[1]&&!e[2]||"/gramet"===e[0]?$?$.p(e,t):($=Xo(e),$.c(),$.m(o,d)):$&&($.d(1),$=null),e[1]&&!e[2]||"/export"===e[0]?b?b.p(e,t):(b=Jo(e),b.c(),b.m(o,m)):b&&(b.d(1),b=null),1&t&&N(f,"active","/help"===e[0]),navigator.share&&x.p(e,t),_&&_.p&&16&t&&p(_,C,e,e[4],t,null,null)},i(e){v||(be(_,e),v=!0)},o(e){xe(_,e),v=!1},d(e){e&&P(n),y&&y.d(),$&&$.d(),b&&b.d(),x&&x.d(),_&&_.d(e)}}}function Yo(e,t,n){let o,r,s;l(e,cn,(e=>n(0,o=e))),l(e,nn,(e=>n(1,r=e))),l(e,on,(e=>n(2,s=e)));let{$$slots:i={},$$scope:a}=t;return e.$$set=e=>{"$$scope"in e&&n(4,a=e.$$scope)},[o,r,s,async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},a,i]}class Qo extends Fe{constructor(e){super(),Me(this,e,Yo,Vo,a,{})}}function er(n){let o,r,s;const a=n[3].default,l=c(a,n,n[2],null);return{c(){o=L("page"),l&&l.c(),S(o,"class","svelte-7uc4nn"),N(o,"fadein",!1===n[0]),N(o,"d-none",!0===n[0])},m(e,t){k(e,o,t),l&&l.m(o,null),s=!0},p(e,[t]){l&&l.p&&4&t&&p(l,a,e,e[2],t,null,null),1&t&&N(o,"fadein",!1===e[0]),1&t&&N(o,"d-none",!0===e[0])},i(a){s||(be(l,a),r||ae((()=>{r=function(n,o,r){let s,a,l=o(n,r),c=!1,u=0;function p(){s&&K(n,s)}function d(){const{delay:o=0,duration:r=300,easing:i=t,tick:d=e,css:m}=l||we;m&&(s=Z(n,0,1,r,o,i,m,u++)),d(0,1);const f=v()+o,g=f+r;a&&a.abort(),c=!0,ae((()=>ge(n,!0,"start"))),a=x((e=>{if(c){if(e>=g)return d(1,0),ge(n,!0,"end"),p(),c=!1;if(e>=f){const t=i((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(K(n),i(l)?(l=l(),fe().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),s=!0)},o(e){xe(l,e),s=!1},d(e){e&&P(o),l&&l.d(e)}}}function tr(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return Ge(e,t)},r,o]}class nr extends Fe{constructor(e){super(),Me(this,e,tr,er,a,{hidden:0})}}function or(e){let t,o;const r=e[3].default,s=c(r,e,e[2],null);let i=[{href:e[0]},e[1]],a={};for(let e=0;e<i.length;e+=1)a=n(a,i[e]);return{c(){t=L("a"),s&&s.c(),T(t,a)},m(e,n){k(e,t,n),s&&s.m(t,null),o=!0},p(e,[n]){s&&s.p&&4&n&&p(s,r,e,e[2],n,null,null),T(t,a=function(e,t){const n={},o={},r={$$scope:1};let s=e.length;for(;s--;){const i=e[s],a=t[s];if(a){for(const e in i)e in a||(o[e]=1);for(const e in a)r[e]||(n[e]=a[e],r[e]=1);e[s]=a}else for(const e in i)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(i,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||(be(s,e),o=!0)},o(e){xe(s,e),o=!1},d(e){e&&P(t),s&&s.d(e)}}}function rr(e,t,o){const r=["href"];let s=d(t,r),{$$slots:i={},$$scope:a}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},s):s;return e.$$set=e=>{t=n(n({},t),function(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}(e)),o(5,s=d(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,a=e.$$scope)},[l,c,a,i]}class sr extends Fe{constructor(e){super(),Me(this,e,rr,or,a,{href:0})}}function ir(e){let t;return{c(){t=L("span"),t.innerHTML="Fly<span>Tax</span>",S(t,"class","flytax")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function ar(e){let t,n,o,r,s,i,a,l,c,u,p,d,m,f,g,h,v,y,$,b,x,C,_,j,E,O,A,T,I,D,z,q,R,W,N,G,U,H,B,Z,K,X,J,V,Y,Q,ee,te,ne,oe,re;return ne=new sr({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[ir]},$$scope:{ctx:e}}}),{c(){t=L("h2"),t.textContent="Pr√©ambule",n=F(),o=L("p"),o.textContent="OFP2MAP est une application PWA (ou Web Application), elle peut √™tre lanc√©e soit depuis un navigateur, soit depuis l'√©cran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie.",r=F(),s=L("p"),s.textContent="OFP2MAP n√©cessite des navigateurs r√©cents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.",i=F(),a=L("p"),a.textContent="L'OFP ne transite sur aucun serveur, seule une route calcul√©e (bas√©e sur au plus 21 stations m√©t√©o) est transmise √† l'h√©bergeur du proxy (voir plus bas) puis √† Ogimet.com pour r√©cup√©rer le Gramet. L'app ne collecte aucune donn√©es.",l=F(),c=L("h2"),c.textContent="Utilisation",u=F(),p=L("ol"),p.innerHTML='<li><p>Dans Pilot Mission, onglet ¬´Dossier de vol¬ª, affichez le PDF nomm√© &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carr√© avec une fl√®che vers le haut. Choisissez ¬´Enregistrer dans Fichiers¬ª. Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite s√©lectionner.</p></li> \n<li><p>Lorsque l&#39;on visualise la carte, le menu de personnalisation s&#39;affiche en cliquant sur <svg style="vertical-align: bottom;"><use xlink:href="#bars"></use></svg> en haut √† droite. Le type avion pour l&#39;ad√©quation des terrains est d√©tect√© dans l&#39;OFP. Pour vous entrainer, je vous recommande de modifier la couleur des terrains en vert/rouge et de sauvegarder votre choix.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, t√©l√©charger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par d√©faut est une LAMBERT, il est possible sur la carte, en haut √† gauche, de basculer sur d&#39;autres projections.</p> \n<ul><li>LAMBERT NORTH (parall√®les s√©cants N30 et N65) est recommand√©e au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parall√®les s√©cants N30 et S15 ) sont recommand√©es sous N30</li> \n<li>THE WORLD permet de disposer d&#39;un Atlas off-line, c&#39;est une projection Times</li> \n<li>MERCATOR est une Web Mercator avec un th√®me est inspir√© des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line</li></ul></li>',d=F(),m=L("ol"),m.innerHTML="<li>Navigation dans la carte: on peut avec un doigt d√©placer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</li>",f=F(),g=L("h2"),g.textContent="Particularit√©s de l'iPad",h=F(),v=L("p"),v.textContent="OFP2MAP ne peut √™tre lanc√© que depuis l'√©cran d'accueil, l'application se lance en plein √©cran. On ne peut pas recharger la page comme dans un navigateur‚ÄØ: il faudra pour cela aller dans le menu d'aide (cet √©cran) ou un bouton sp√©cifique sera affich√© en haut.",y=F(),$=L("p"),$.textContent="Pour partager le lien vers OFP2MAP, utilisez le menu PARTAGER puis utilisez AirDrop.",b=F(),x=L("p"),x.innerHTML='L&#39;export des fichiers KML affiche une page nomm√©e &quot;data:&quot;, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut √† gauche sur OK pour revenir √† OFP2MAP. En raison d&#39;un bug d&#39;iOS, il est impossible de nommer le fichier pour le moment.',C=F(),_=L("p"),_.textContent="√Ä noter que parfois, des bugs d'affichage peuvent appara√Ætre‚ÄØ:  lorsque l'on retourne sur l'app, l'app est zoom√©e, il faut alors juste d√©zoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  m√™me en mode d√©connect√©, pour la relancer.",j=F(),E=L("h2"),E.textContent="Mode off-line",O=F(),A=L("p"),A.textContent="Une fois un premier OFP charg√©, il est possible m√™me en mode d√©connect√© de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes d√©j√† visualis√©es. Pour mettre en cache les cartes, il suffit de les consulter.",T=F(),I=L("p"),I.textContent="Il existe aussi un bouton de mise en cache‚ÄØ: le pictogramme ‚Üì situ√© √† droite du s√©lecteur de carte. Sur les cartes LAMBERT ou THE WORLD, il mettra en cache la totalit√© de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache.",D=F(),z=L("p"),z.textContent="Les premi√®res mises en cache peuvent prendre du temps‚ÄØ: sur la Mercator, un vol LC peut n√©cessiter le t√©l√©chargement de 40Mo de donn√©es. Les caches des autres projections utilisent‚ÄØ: 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH et 32Mo pour THE WORLD.",q=F(),R=L("h2"),R.textContent="Mise √† jour",W=F(),N=L("p"),N.textContent="L'app d√©tecte les mises √† jour automatiquement, normalement vous n'avez rien √† faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise √† jour. La version AIRAC et le type avion d√©tect√© dans l'OFP sont affich√©s en bas √† droite de la carte dans le champ d'attribution.",G=F(),U=L("h2"),U.textContent="Cr√©dits",H=F(),B=L("ul"),B.innerHTML='<li>Les donn√©es terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est d√©velopp√© en javascript √† l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir r√©cup√©rer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',Z=F(),K=L("h2"),K.textContent="H√©bergement",X=F(),J=L("p"),J.textContent="L'h√©bergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le r√©seau internet d'AF, les fonds de cartes sont √† pr√©sent h√©berg√©s sur netlify. Le proxy gramet est lui dor√©navant h√©berg√© sur vercel.",V=F(),Y=L("h2"),Y.textContent="Liens",Q=F(),ee=L("ul"),te=L("li"),Le(ne.$$.fragment),oe=M(" une aide aux calculs des frais professionnels (m√™me auteur)."),S(m,"start","5")},m(e,P){k(e,t,P),k(e,n,P),k(e,o,P),k(e,r,P),k(e,s,P),k(e,i,P),k(e,a,P),k(e,l,P),k(e,c,P),k(e,u,P),k(e,p,P),k(e,d,P),k(e,m,P),k(e,f,P),k(e,g,P),k(e,h,P),k(e,v,P),k(e,y,P),k(e,$,P),k(e,b,P),k(e,x,P),k(e,C,P),k(e,_,P),k(e,j,P),k(e,E,P),k(e,O,P),k(e,A,P),k(e,T,P),k(e,I,P),k(e,D,P),k(e,z,P),k(e,q,P),k(e,R,P),k(e,W,P),k(e,N,P),k(e,G,P),k(e,U,P),k(e,H,P),k(e,B,P),k(e,Z,P),k(e,K,P),k(e,X,P),k(e,J,P),k(e,V,P),k(e,Y,P),k(e,Q,P),k(e,ee,P),w(ee,te),_e(ne,te,null),w(te,oe),re=!0},p(e,[t]){const n={};1&t&&(n.$$scope={dirty:t,ctx:e}),ne.$set(n)},i(e){re||(be(ne.$$.fragment,e),re=!0)},o(e){xe(ne.$$.fragment,e),re=!1},d(e){e&&P(t),e&&P(n),e&&P(o),e&&P(r),e&&P(s),e&&P(i),e&&P(a),e&&P(l),e&&P(c),e&&P(u),e&&P(p),e&&P(d),e&&P(m),e&&P(f),e&&P(g),e&&P(h),e&&P(v),e&&P(y),e&&P($),e&&P(b),e&&P(x),e&&P(C),e&&P(_),e&&P(j),e&&P(E),e&&P(O),e&&P(A),e&&P(T),e&&P(I),e&&P(D),e&&P(z),e&&P(q),e&&P(R),e&&P(W),e&&P(N),e&&P(G),e&&P(U),e&&P(H),e&&P(B),e&&P(Z),e&&P(K),e&&P(X),e&&P(J),e&&P(V),e&&P(Y),e&&P(Q),e&&P(ee),je(ne)}}}class lr extends Fe{constructor(e){super(),Me(this,e,null,ar,a,{})}}function cr(t){let n,o,r,s,i,a,l,c,u,p,d,m,f,g,h,v,y=!0===navigator.standalone&&function(t){let n,o,r;return{c(){n=L("button"),n.textContent="Recharger l'App",S(n,"class","btn btn-primary btn-sm svelte-vgy6ih")},m(e,s){k(e,n,s),o||(r=O(n,"click",t[2]),o=!0)},p:e,d(e){e&&P(n),o=!1,r()}}}(t);return f=new lr({}),{c(){n=L("div"),o=L("h1"),r=L("img"),i=M(" OFP2MAP v"),a=M(ur),l=F(),c=L("small"),u=M("/ ServiceWorker‚ÄØ: "),p=M(t[1]),d=F(),y&&y.c(),m=F(),Le(f.$$.fragment),r.src!==(s="images/ofp2map-icons/icon-128x128.png")&&S(r,"src","images/ofp2map-icons/icon-128x128.png"),S(r,"alt","logo"),S(r,"class","svelte-vgy6ih"),S(c,"class","svelte-vgy6ih"),S(o,"class","svelte-vgy6ih"),S(n,"class","markdown svelte-vgy6ih")},m(e,s){k(e,n,s),w(n,o),w(o,r),w(o,i),w(o,a),w(o,l),w(o,c),w(c,u),w(c,p),w(o,d),y&&y.m(o,null),w(n,m),_e(f,n,null),g=!0,h||(v=O(c,"click",t[3],{once:!0}),h=!0)},p(e,[t]){(!g||2&t)&&D(p,e[1]),!0===navigator.standalone&&y.p(e,t)},i(e){g||(be(f.$$.fragment,e),g=!0)},o(e){xe(f.$$.fragment,e),g=!1},d(e){e&&P(n),y&&y.d(),je(f),h=!1,v()}}}const ur="1.4.0";function pr(e,t,n){let o;l(e,Qt,(e=>n(0,o=e)));let r="";return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=o)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,r=e)))},[o,r,()=>{window.location.hash="#/",window.location.reload()},()=>o&&o.update()&&void 0]}class dr extends Fe{constructor(e){super(),Me(this,e,pr,cr,a,{})}}function mr(e){let t,n,o,r,i,a,l,c,u,p,d,m,f,g,h,v;return{c(){t=L("div"),n=L("div"),o=L("strong"),o.innerHTML='<span class="svelte-395rpc">üë®üèª‚Äç‚úàÔ∏è</span>Mise √† jour disponible',r=F(),i=L("button"),i.innerHTML='<span aria-hidden="true">√ó</span>',a=F(),l=L("div"),c=L("p"),c.textContent="Il faudra recharger l'OFP",u=F(),p=L("button"),d=L("span"),m=M(e[1]),S(o,"class","svelte-395rpc"),S(i,"type","button"),S(i,"class","close svelte-395rpc"),S(i,"aria-label","Close"),S(n,"class","toast-header svelte-395rpc"),S(d,"class","svelte-395rpc"),N(d,"blinking",e[1].endsWith("...")),S(p,"class","btn btn-primary"),S(p,"type","button"),S(l,"class","toast-body text-center"),S(t,"class","toast svelte-395rpc"),q(t,"position","fixed"),q(t,"top","0"),q(t,"right","0")},m(s,f){k(s,t,f),w(t,n),w(n,o),w(n,r),w(n,i),w(t,a),w(t,l),w(l,c),w(l,u),w(l,p),w(p,d),w(d,m),g=!0,h||(v=[O(i,"click",e[6]),O(p,"click",e[7],{once:!0})],h=!0)},p(e,t){(!g||2&t)&&D(m,e[1]),2&t&&N(d,"blinking",e[1].endsWith("..."))},i(e){g||(ae((()=>{f||(f=ke(t,Ge,{},!0)),f.run(1)})),g=!0)},o(e){f||(f=ke(t,Ge,{},!1)),f.run(0),g=!1},d(e){e&&P(t),e&&f&&f.end(),h=!1,s(v)}}}function fr(t){let n,o,r,s,i,a,l,c,u,p,d=(t[4](700)||"")+"";return{c(){n=L("div"),o=L("div"),r=L("div"),r.innerHTML='<strong class="svelte-395rpc"><span class="svelte-395rpc">üë®üèª‚Äç‚úàÔ∏è</span>Mise √† jour d√©tect√©e</strong>',s=F(),i=L("div"),a=L("button"),a.innerHTML="<span>Mise √† jour...</span>",l=F(),c=M(d),S(r,"class","toast-header svelte-395rpc"),S(a,"class","btn"),S(a,"type","button"),S(i,"class","toast-body text-center"),S(o,"class","toast svelte-395rpc"),S(n,"class","modal svelte-395rpc")},m(e,d){k(e,n,d),w(n,o),w(o,r),w(o,s),w(o,i),w(i,a),w(n,l),k(e,c,d),u||(p=O(a,"click",A(t[5])),u=!0)},p:e,i:e,o:e,d(e){e&&P(n),e&&P(c),u=!1,p()}}}function gr(e){let t,n,o,r;const s=[fr,mr],i=[];function a(e,t){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:-1:0}return~(t=a(e))&&(n=i[t]=s[t](e)),{c(){n&&n.c(),o=E()},m(e,n){~t&&i[t].m(e,n),k(e,o,n),r=!0},p(e,[r]){let l=t;t=a(e),t===l?~t&&i[t].p(e,r):(n&&(ye(),xe(i[l],1,1,(()=>{i[l]=null})),$e()),~t?(n=i[t],n?n.p(e,r):(n=i[t]=s[t](e),n.c()),be(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(be(n),r=!0)},o(e){xe(n),r=!1},d(e){~t&&i[t].d(e),e&&P(o)}}}const hr=Yt(!1),vr=Yt(),yr=Yt(!1),$r=e=>{hr.set(!0),en.set(!1),e?yr.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.4.0",e)):yr.set(!0)};function br(t,n,o){let r,s,i,a,c=e,u=e;l(t,en,(e=>o(2,r=e))),l(t,Qt,(e=>o(8,s=e))),l(t,vr,(e=>o(9,i=e))),l(t,hr,(e=>o(3,a=e))),t.$$.on_destroy.push((()=>c())),t.$$.on_destroy.push((()=>u()));let p="Installer";f(en,r=!1,r);let{prompt:d=!1}=n;const m=(e=0)=>{let t;s&&i&&i.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,p="En cours..."),i.waiting.postMessage({type:"SKIP_WAITING"})):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,d=e.prompt)},[d,p,r,a,m,function(e){Q(t,e)},()=>f(en,r=!0,r),()=>m()]}class xr extends Fe{constructor(e){super(),Me(this,e,br,gr,a,{prompt:0})}}function wr(e){let t;return{c(){t=L("ol"),t.innerHTML='<li class="svelte-aqbc18">Dans la barre de menu, cliquez sur <svg class="svelte-aqbc18"><use xlink:href="#share"></use></svg></li> \n                    <li class="svelte-aqbc18">Faites d√©filer, choisir‚ÄØ: <em>Sur l&#39;√©cran d&#39;accueil</em> \n                        <svg viewBox="0 0 24 24" fill="none" stroke="#000" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="svelte-aqbc18"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg></li> \n                    <li class="svelte-aqbc18">Lancez l&#39;application depuis l&#39;√©cran d&#39;accueil</li>',S(t,"class","guide svelte-aqbc18")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function kr(e){let t;return{c(){t=L("p"),t.textContent="Merci d'ouvrir cette page dans Safari",S(t,"class","guide error svelte-aqbc18")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function Pr(t){let n,o,r,s,i,a,l,c,u,p,d,m,f,g;n=new Tt({});let h=function(e,t){return e[0]?wr:kr}(t)(t);return f=new xr({}),{c(){Le(n.$$.fragment),o=F(),r=L("div"),s=L("div"),i=L("div"),i.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-aqbc18"/>',a=F(),l=L("div"),c=L("h3"),c.textContent="Installez OFP2MAP",u=F(),p=L("p"),p.textContent="Si OFP2MAP est d√©j√† sur l'√©cran d'accueil, ne l'installez pas une deuxi√®me fois. Attention: l'installation ne peut se faire que depuis\n                le navigateur Safari, ce n'est pas possible depuis une WebView (√† l'int√©rieur d'une app).",d=F(),h.c(),m=F(),Le(f.$$.fragment),S(i,"class","icon-container svelte-aqbc18"),S(c,"class","title svelte-aqbc18"),S(p,"class","text svelte-aqbc18"),S(l,"class","prompt-content svelte-aqbc18"),S(s,"class","prompt svelte-aqbc18"),S(r,"class","prompt-container svelte-aqbc18")},m(e,t){_e(n,e,t),k(e,o,t),k(e,r,t),w(r,s),w(s,i),w(s,a),w(s,l),w(l,c),w(l,u),w(l,p),w(l,d),h.m(l,null),k(e,m,t),_e(f,e,t),g=!0},p:e,i(e){g||(be(n.$$.fragment,e),be(f.$$.fragment,e),g=!0)},o(e){xe(n.$$.fragment,e),xe(f.$$.fragment,e),g=!1},d(e){je(n,e),e&&P(o),e&&P(r),h.d(),e&&P(m),je(f,e)}}}function Cr(e){return[Se&&!Ae]}class Lr extends Fe{constructor(e){super(),Me(this,e,Cr,Pr,a,{})}}function _r(e){let t,n,o,r,s,i,a,l,c;t=new Qo({props:{$$slots:{default:[Mr]},$$scope:{ctx:e}}}),o=new xr({props:{prompt:!!e[1]}});let u=e[1]&&Fr(e);const p=[qr,zr,Dr,Ir],d=[];function m(e,t){return!e[1]||"/gramet"!==e[2]&&"/export"!==e[2]?"/"===e[2]?1:"/help"===e[2]?2:e[1]?-1:3:0}return~(i=m(e))&&(a=d[i]=p[i](e)),{c(){Le(t.$$.fragment),n=F(),Le(o.$$.fragment),r=F(),u&&u.c(),s=F(),a&&a.c(),l=E()},m(e,a){_e(t,e,a),k(e,n,a),_e(o,e,a),k(e,r,a),u&&u.m(e,a),k(e,s,a),~i&&d[i].m(e,a),k(e,l,a),c=!0},p(e,n){const r={};8221&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};2&n&&(c.prompt=!!e[1]),o.$set(c),e[1]?u?(u.p(e,n),2&n&&be(u,1)):(u=Fr(e),u.c(),be(u,1),u.m(s.parentNode,s)):u&&(ye(),xe(u,1,1,(()=>{u=null})),$e());let f=i;i=m(e),i===f?~i&&d[i].p(e,n):(a&&(ye(),xe(d[f],1,1,(()=>{d[f]=null})),$e()),~i?(a=d[i],a?a.p(e,n):(a=d[i]=p[i](e),a.c()),be(a,1),a.m(l.parentNode,l)):a=null)},i(e){c||(be(t.$$.fragment,e),be(o.$$.fragment,e),be(u),be(a),c=!0)},o(e){xe(t.$$.fragment,e),xe(o.$$.fragment,e),xe(u),xe(a),c=!1},d(e){je(t,e),e&&P(n),je(o,e),e&&P(r),u&&u.d(e),e&&P(s),~i&&d[i].d(e),e&&P(l)}}}function jr(t){let n,o;return n=new Lr({}),{c(){Le(n.$$.fragment)},m(e,t){_e(n,e,t),o=!0},p:e,i(e){o||(be(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){je(n,e)}}}function Mr(e){let t,n,o,r,s;return n=new Lo({props:{kmlOptions:e[0]}}),n.$on("change",e[7]),{c(){t=L("form"),Le(n.$$.fragment),S(t,"class","form-inline svelte-1jwztj3"),N(t,"invisible","/help"===e[2])},m(i,a){k(i,t,a),_e(n,t,null),o=!0,r||(s=O(t,"submit",A(e[6])),r=!0)},p(e,o){const r={};1&o&&(r.kmlOptions=e[0]),n.$set(r),4&o&&N(t,"invisible","/help"===e[2])},i(e){o||(be(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){e&&P(t),je(n),r=!1,s()}}}function Fr(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Sr,then:Or,catch:Er,value:11,error:12,blocks:[,,,]};return Pe(n=e[1],r),{c(){t=E(),r.block.c()},m(e,n){k(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&Pe(n,r));else{const t=e.slice();t[11]=t[12]=r.resolved,r.block.p(t,o)}},i(e){o||(be(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){xe(r.blocks[e])}o=!1},d(e){e&&P(t),r.block.d(e),r.token=null,r=null}}}function Er(t){let n,o,r,s=t[12].message+"";return{c(){n=L("p"),o=M("üò±: "),r=M(s),N(n,"d-none","/map"!==t[2])},m(e,t){k(e,n,t),w(n,o),w(n,r)},p(e,t){2&t&&s!==(s=e[12].message+"")&&D(r,s),4&t&&N(n,"d-none","/map"!==e[2])},i:e,o:e,d(e){e&&P(n)}}}function Or(e){let t,n;return t=new nr({props:{hidden:"/map"!==e[2],$$slots:{default:[Ar]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.hidden="/map"!==e[2]),8199&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Ar(e){let t,n,o;function r(t){e[8](t)}let s={id:"map",ofp:e[11]};return void 0!==e[0]&&(s.kmlOptions=e[0]),t=new Zo({props:s}),te.push((()=>Ce(t,"kmlOptions",r))),t.$on("save",e[9]),{c(){Le(t.$$.fragment)},m(e,n){_e(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[11]),!n&&1&o&&(n=!0,r.kmlOptions=e[0],le((()=>n=!1))),t.$set(r)},i(e){o||(be(t.$$.fragment,e),o=!0)},o(e){xe(t.$$.fragment,e),o=!1},d(e){je(t,e)}}}function Sr(e){let t,n;return t=new nr({props:{hidden:"/map"!==e[2],$$slots:{default:[Tr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.hidden="/map"!==e[2]),8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Tr(e){let t;return{c(){t=L("div"),t.textContent="traitement en cours...",q(t,"margin","auto")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function Ir(t){let n,o=t[5](t[2])+"";return{c(){n=M(o)},m(e,t){k(e,n,t)},p(e,t){4&t&&o!==(o=e[5](e[2])+"")&&D(n,o)},i:e,o:e,d(e){e&&P(n)}}}function Dr(e){let t,n;return t=new nr({props:{$$slots:{default:[Rr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function zr(e){let t,n;return t=new nr({props:{$$slots:{default:[Wr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function qr(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Kr,then:Gr,catch:Nr,value:11,error:12,blocks:[,,,]};return Pe(n=e[1],r),{c(){t=E(),r.block.c()},m(e,n){k(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&Pe(n,r));else{const t=e.slice();t[11]=t[12]=r.resolved,r.block.p(t,o)}},i(e){o||(be(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){xe(r.blocks[e])}o=!1},d(e){e&&P(t),r.block.d(e),r.token=null,r=null}}}function Rr(e){let t,n;return t=new dr({}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Wr(e){let t,n;return t=new Dt({}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Nr(t){let n,o,r,s=t[12].message+"";return{c(){n=L("p"),o=M("üò±: "),r=M(s)},m(e,t){k(e,n,t),w(n,o),w(n,r)},p(e,t){2&t&&s!==(s=e[12].message+"")&&D(r,s)},i:e,o:e,d(e){e&&P(n)}}}function Gr(e){let t,n,o,r;const s=[Hr,Ur],i=[];function a(e,t){return"/gramet"===e[2]?0:"/export"===e[2]?1:-1}return~(t=a(e))&&(n=i[t]=s[t](e)),{c(){n&&n.c(),o=E()},m(e,n){~t&&i[t].m(e,n),k(e,o,n),r=!0},p(e,r){let l=t;t=a(e),t===l?~t&&i[t].p(e,r):(n&&(ye(),xe(i[l],1,1,(()=>{i[l]=null})),$e()),~t?(n=i[t],n?n.p(e,r):(n=i[t]=s[t](e),n.c()),be(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(be(n),r=!0)},o(e){xe(n),r=!1},d(e){~t&&i[t].d(e),e&&P(o)}}}function Ur(e){let t,n;return t=new nr({props:{$$slots:{default:[Br]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8199&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Hr(e){let t,n;return t=new nr({props:{$$slots:{default:[Zr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8194&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Br(e){let t,n,o,r;return t=new _t({props:{ofp:e[11]}}),t.$on("save",e[10]),o=new Ye({props:{ofp:e[11]}}),{c(){Le(t.$$.fragment),n=F(),Le(o.$$.fragment)},m(e,s){_e(t,e,s),k(e,n,s),_e(o,e,s),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[11]),t.$set(r);const s={};2&n&&(s.ofp=e[11]),o.$set(s)},i(e){r||(be(t.$$.fragment,e),be(o.$$.fragment,e),r=!0)},o(e){xe(t.$$.fragment,e),xe(o.$$.fragment,e),r=!1},d(e){je(t,e),e&&P(n),je(o,e)}}}function Zr(e){let t,n;return t=new At({props:{ofp:e[11]}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[11]),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Kr(e){let t,n;return t=new nr({props:{$$slots:{default:[Xr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(be(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){je(t,e)}}}function Xr(e){let t;return{c(){t=L("div"),t.textContent="traitement en cours...",q(t,"margin","auto")},m(e,n){k(e,t,n)},d(e){e&&P(t)}}}function Jr(e){let t,n,o,r,s,i;const a=[jr,_r],l=[];return o=navigator&&!1===navigator.standalone&&Oe?0:1,r=l[o]=a[o](e),{c(){t=L("main"),n=L("div"),r.c(),S(n,"class","content svelte-1jwztj3"),S(t,"class",s="container "+(e[2].substr(1)||"home")+" svelte-1jwztj3")},m(e,r){k(e,t,r),w(t,n),l[o].m(n,null),i=!0},p(e,[n]){r.p(e,n),(!i||4&n&&s!==(s="container "+(e[2].substr(1)||"home")+" svelte-1jwztj3"))&&S(t,"class",s)},i(e){i||(be(r),i=!0)},o(e){xe(r),i=!1},d(e){e&&P(t),l[o].d()}}}function Vr(e,t,n){let o,r,s,i;l(e,nn,(e=>n(1,o=e))),l(e,cn,(e=>n(2,r=e))),l(e,tn,(e=>n(3,s=e))),l(e,en,(e=>n(4,i=e)));(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in Qe){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(rt)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||mt.setItem(dt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&mt.setItem(dt.shortcut,o));mt.setItem(dt.optionsKML,n)})(window.location.search);let a=(e=>{const t={};for(let[n,o]of Object.entries(e))n in Qe&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(rt)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...Qe,...t}})(mt.getItem(dt.optionsKML)||{});ft(a,r),V((()=>(document.addEventListener("visibilitychange",an,!1),()=>document.removeEventListener("visibilitychange",an))));return[a,o,r,s,i,e=>{window.location.hash="#/"},function(t){Q(e,t)},()=>f(tn,s=f(en,i=!1,i),s),function(e){a=e,n(0,a)},()=>ft(a,r),()=>ft(a,r)]}class Yr extends Fe{constructor(e){super(),Me(this,e,Vr,Jr,a,{})}}try{self["workbox:window:6.1.1"]&&_()}catch(Qr){}function Qr(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ts(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return es(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.1.1"]&&_()}catch(Qr){}var ns=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function os(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var rs=function(e,t){this.type=e,Object.assign(this,t)};function ss(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function is(){}var as={type:"SKIP_WAITING"};function ls(e,t){if(!t)return e&&e.then?e.then(is):Promise.resolve()}var cs=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new ns,o.en=new ns,o.on=new ns,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!os(t.scriptURL,o.sn)||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,s=n===o.vn,i={sw:n,isExternal:s,originalEvent:e};!s&&o.mn&&(i.isUpdate=!0),o.dispatchEvent(new rs(r,i)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new rs("waiting",i))}),200):"activating"===r&&(clearTimeout(o.wn),s||o.en.resolve(n))},o.dn=function(e){var t=o.hn;t===navigator.serviceWorker.controller&&(o.dispatchEvent(new rs("controlling",{sw:t,originalEvent:e,isUpdate:o.mn})),o.on.resolve(t))},o.gn=(r=function(e){var t=e.data,n=e.source;return ss(o.getSW(),(function(){o.an.has(n)&&o.dispatchEvent(new rs("message",{data:t,sw:n,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,s=o.prototype;return s.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return ls(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),ss(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&os(t.scriptURL,o.sn)&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new rs("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn,{once:!0}),o.fn}))}))}catch(e){return Promise.reject(e)}},s.update=function(){try{return this.fn?ls(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},s.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},s.messageSW=function(e){try{return ss(this.getSW(),(function(t){return Qr(t,e)}))}catch(e){return Promise.reject(e)}},s.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Qr(this.fn.waiting,as)},s.pn=function(){var e=navigator.serviceWorker.controller;return e&&os(e.scriptURL,this.sn)?e:void 0},s.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return ss(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=ts(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let us,ps=!1;try{us=new Yr({target:document.body})}catch(e){ps=!0;try{var ds=document.createElement("p");ds.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs r√©cents: Safari 14¬†iOS/Mac, Firefox¬†86, Chrome¬†87 et Microsoft Edge¬†87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(ds)}catch(ts){}}finally{if("serviceWorker"in navigator){const e=new cs("./sw.js");Qt.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{ps?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,We(400,Qr(t.sw,{type:"GET_VERSION"})).then((e=>$r(e))).catch((e=>{$r()})))})),e.register().then((e=>{ps&&e&&e.unregister(),vr.set(e)}),console.error)}}return us}();
//# sourceMappingURL=bundle.js.map
