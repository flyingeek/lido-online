var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function o(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function l(e,t,n,o){if(e){const r=c(e,t,n,o);return e[0](r)}}function c(e,t,n,o){return e[1]&&o?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](o(t))):n.ctx}function u(e,t,n,o,r,s,a){const i=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,s);if(i){const r=c(t,n,o,a);e.p(r,i)}}function p(e){return null==e?"":e}function d(e,t,n=t){return e.set(n),t}function m(t){return t&&s(t.destroy)?t.destroy:e}const f="undefined"!=typeof window;let g=f?()=>window.performance.now():()=>Date.now(),h=f?e=>requestAnimationFrame(e):e;const v=new Set;function y(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&h(y)}function b(e){let t;return 0===v.size&&h(y),{promise:new Promise((n=>{v.add(t={c:e,f:n})})),abort(){v.delete(t)}}}function $(e,t){e.appendChild(t)}function x(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode.removeChild(e)}function k(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function P(e){return document.createElement(e)}function C(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function F(){return L(" ")}function j(){return L("")}function _(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function z(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function I(e,t){e.value=null==t?"":t}function O(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function D(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function q(e,t,n){e.classList[n?"add":"remove"](t)}function R(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const E=new Set;let N,W=0;function G(e,t,n,o,r,s,a,i=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*s(e);c+=100*e+`%{${a(o,1-o)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,d=e.ownerDocument;E.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(P("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,W+=1,p}function U(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),W-=r,W||h((()=>{W||(E.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),E.clear())})))}function H(e){N=e}function B(){if(!N)throw new Error("Function called outside component initialization");return N}function Z(){const e=B();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=R(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function K(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const J=[],X=[],V=[],Y=[],Q=Promise.resolve();let ee=!1;function te(){ee||(ee=!0,Q.then(ae))}function ne(e){V.push(e)}function oe(e){Y.push(e)}let re=!1;const se=new Set;function ae(){if(!re){re=!0;do{for(let e=0;e<J.length;e+=1){const t=J[e];H(t),ie(t.$$)}for(H(null),J.length=0;X.length;)X.pop()();for(let e=0;e<V.length;e+=1){const t=V[e];se.has(t)||(se.add(t),t())}V.length=0}while(J.length);for(;Y.length;)Y.pop()();ee=!1,re=!1,se.clear()}}function ie(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let le;function ce(){return le||(le=Promise.resolve(),le.then((()=>{le=null}))),le}function ue(e,t,n){e.dispatchEvent(R(`${t?"intro":"outro"}${n}`))}const pe=new Set;let de;function me(){de={r:0,c:[],p:de}}function fe(){de.r||r(de.c),de=de.p}function ge(e,t){e&&e.i&&(pe.delete(e),e.i(t))}function he(e,t,n,o){if(e&&e.o){if(pe.has(e))return;pe.add(e),de.c.push((()=>{pe.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const ve={duration:0};function ye(e,t){const n=t.token={};function o(e,o,r,s){if(t.token!==n)return;t.resolved=s;let a=t.ctx;void 0!==r&&(a=a.slice(),a[r]=s);const i=e&&(t.current=e)(a);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(me(),he(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),fe())})):t.block.d(1),i.c(),ge(i,1),i.m(t.mount(),t.anchor),l=!0),t.block=i,t.blocks&&(t.blocks[o]=i),l&&ae()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=B();if(e.then((e=>{H(n),o(t.then,1,t.value,e),H(null)}),(e=>{if(H(n),o(t.catch,2,t.error,e),H(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}const be="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function $e(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function xe(e){e&&e.c()}function we(e,t,o){const{fragment:a,on_mount:i,on_destroy:l,after_update:c}=e.$$;a&&a.m(t,o),ne((()=>{const t=i.map(n).filter(s);l?l.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(ne)}function ke(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Pe(t,n,s,a,i,l,c=[-1]){const u=N;H(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:o(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=s?s(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(J.push(e),te(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(w)}else p.fragment&&p.fragment.c();n.intro&&ge(t.$$.fragment),we(t,n.target,n.anchor),ae()}H(u)}class Ce{$destroy(){ke(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Le{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Fe="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,je=matchMedia("(hover: hover)").matches;function _e(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function Me(e,t,n){return e<=t?t:e>=n?n:e}function Se(e,t,n){return!(e<t)&&!(e>n)}function Te(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function ze(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ie(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Oe(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const Ae=(e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n};function De(e,{delay:n=0,duration:o=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*s}}function qe(e){let t;return{c(){t=P("textarea"),t.value=e[0],S(t,"class","svelte-12a0ij3")},m(n,o){x(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&w(t),e[6](null)}}}function Re(t){let n,o,r;return{c(){n=P("a"),n.textContent="copier la route",S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://")},m(e,s){x(e,n,s),o||(r=_(n,"click",t[4]),o=!0)},p:e,d(e){e&&w(n),o=!1,r()}}}function Ee(t){let n,o,r,s,a;return{c(){n=P("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=F(),r=P("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura √©t√© copi√©e automatiquement).</small>',S(n,"role","button"),S(n,"class","btn btn-primary svelte-12a0ij3"),S(n,"href","lhs-mpilot://"),S(r,"class","card-text")},m(e,i){x(e,n,i),x(e,o,i),x(e,r,i),s||(a=_(n,"click",t[4]),s=!0)},p:e,d(e){e&&w(n),e&&w(o),e&&w(r),s=!1,a()}}}function Ne(n){let o,a,i;return{c(){o=P("span"),o.textContent="copi√©!",S(o,"class","svelte-12a0ij3")},m(e,t){x(e,o,t),i=!0},i(e){i||(a&&a.end(1),i=!0)},o(n){a=function(n,o,a){let i,l=o(n,a),c=!0;const u=de;function p(){const{delay:o=0,duration:s=300,easing:a=t,tick:p=e,css:d}=l||ve;d&&(i=G(n,1,0,s,o,a,d));const m=g()+o,f=m+s;ne((()=>ue(n,!1,"start"))),b((e=>{if(c){if(e>=f)return p(0,1),ue(n,!1,"end"),--u.r||r(u.c),!1;if(e>=m){const t=a((e-m)/s);p(1-t,t)}}return c}))}return u.r+=1,s(l)?ce().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(i&&U(n,i),c=!1)}}}(o,De,{}),i=!1},d(e){e&&w(o),e&&a&&a.end()}}}function We(e){let t,n,o,r,s,a,i,l,c,u,p,d,m=null!=e[0]&&qe(e);let f=(Fe?Ee:Re)(e),g=e[2]&&Ne();return{c(){m&&m.c(),t=F(),n=P("div"),o=P("div"),r=P("h5"),r.textContent="Route Lido",s=F(),a=P("p"),a.textContent="Cette route est optimis√©e par rapport √† celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus r√©active.",i=F(),f.c(),l=F(),c=P("div"),u=L(e[3]),p=F(),g&&g.c(),S(r,"class","card-title"),S(a,"class","card-text"),S(c,"class","text-monospace svelte-12a0ij3"),S(o,"class","card-body"),S(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),x(e,t,h),x(e,n,h),$(n,o),$(o,r),$(o,s),$(o,a),$(o,i),f.m(o,null),$(o,l),$(o,c),$(c,u),$(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=qe(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&ge(g,1):(g=Ne(),g.c(),ge(g,1),g.m(c,null)):g&&(me(),he(g,1,1,(()=>{g=null})),fe())},i(e){d||(ge(g),d=!0)},o(e){he(g),d=!1},d(e){m&&m.d(e),e&&w(t),e&&w(n),f.d(),g&&g.d()}}}let Ge=!1;try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Ge=!0)}))}catch(e){}function Ue(e,t,n){let o,{ofp:r}=t,s=null;const a=r?r.lidoRoute().join(" "):"";let i=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[s,o,i,a,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Ge)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,s=e),await(te(),Q),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,s=null)}return t}(a);Fe||(n(2,i=t),setTimeout((function(){n(2,i=!1)}),3e3),e.preventDefault())},r,function(e){X[e?"unshift":"push"]((()=>{o=e,n(1,o)}))}]}class He extends Ce{constructor(e){super(),Pe(this,e,Ue,We,a,{ofp:5})}}function Be(t){let n,o,a,i,l,c,u,p,d,f,g,h,v,y,b,k,C,j,M;return{c(){n=P("kmlcolor"),o=P("div"),a=P("label"),i=L("Couleur"),l=F(),c=P("picker"),u=P("label"),p=P("input"),g=F(),h=P("input"),y=F(),b=P("input"),S(a,"for",t[1]),S(a,"class","input-group-text svelte-1hvk4hi"),S(o,"class","input-group-prepend"),S(p,"type","color"),S(p,"class","svelte-1hvk4hi"),S(u,"style",d=Ve(t[2])),S(u,"class","svelte-1hvk4hi"),S(h,"type","range"),S(h,"min","30"),S(h,"max","255"),S(h,"class","svelte-1hvk4hi"),S(c,"class","form-control svelte-1hvk4hi"),S(c,"style",v=Xe(t[2][0])),S(b,"name",t[1]),S(b,"class","form-control text-monospace svelte-1hvk4hi"),S(b,"style",k=Ye(t[0])),S(b,"type","text"),S(b,"maxlength","8"),S(n,"class","input-group svelte-1hvk4hi")},m(e,r){x(e,n,r),$(n,o),$(o,a),$(a,i),$(n,l),$(n,c),$(c,u),$(u,p),I(p,t[2][0]),$(c,g),$(c,h),I(h,t[2][1]),$(n,y),$(n,b),I(b,t[0]),j||(M=[_(p,"input",t[5]),m(f=t[4].call(null,u,t[0])),_(h,"change",t[6]),_(h,"input",t[6]),m(C=t[3].call(null,b,t[2])),_(b,"input",t[7])],j=!0)},p(e,[t]){2&t&&S(a,"for",e[1]),4&t&&I(p,e[2][0]),4&t&&d!==(d=Ve(e[2]))&&S(u,"style",d),f&&s(f.update)&&1&t&&f.update.call(null,e[0]),4&t&&I(h,e[2][1]),4&t&&v!==(v=Xe(e[2][0]))&&S(c,"style",v),2&t&&S(b,"name",e[1]),1&t&&k!==(k=Ye(e[0]))&&S(b,"style",k),C&&s(C.update)&&4&t&&C.update.call(null,e[2]),1&t&&b.value!==e[0]&&I(b,e[0])},i:e,o:e,d(e){e&&w(n),j=!1,r(M)}}}const Ze=/^[A-F0-9]{8}$/i,Ke=e=>{let[t,n]=Je(e);return[t,n/255]},Je=e=>{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]},Xe=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},Ve=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,Ye=e=>e.match(Ze)?"":"border-color: #F00;";function Qe(e,t,n){const o=Z();let r,{kmlColor:s="FF0000FF"}=t,{name:a}=t;try{r=Je(s)}catch(e){r=["#FF0000",255]}const i=function(e,t,n){let o;return function(){const r=this,s=arguments,a=function(){o=null,n||e.apply(r,s)},i=n&&!o;clearTimeout(o),o=setTimeout(a,t),i&&e.apply(r,s)}}(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,s=e.kmlColor),"name"in e&&n(1,a=e.name)},[s,a,r,function(e){return{update(e){const[t,o]=e;n(0,s=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),i("change",{name:a,value:s})}}},function(e){return{update(e){if(e.match(Ze)){const t=parseInt(e.slice(0,2),16),o="#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4);n(2,r=[o,t]),i("change",{name:a,value:e.toUpperCase()})}}}},function(){r[0]=this.value,n(2,r)},function(){var e;r[1]=""===(e=this.value)?null:+e,n(2,r)},function(){s=this.value,n(0,s)}]}class et extends Ce{constructor(e){super(),Pe(this,e,Qe,Be,a,{kmlColor:0,name:1})}}const tt={routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC"};function nt(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const ot=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,nt(window.kmlGen,tt)),window.kmlGen);function rt(e,t){let n={...tt,...t};const o=ot();nt(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const s=`${e.infos.departure}-${e.infos.destination}`,a=new editolido.Route(e.wptCoordinates(),{name:s,description:r}),i=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route D√©gagement"}),l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${s}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",a),o.addPoints("rmain",a,{excluded:c}),o.addLine("ralt",i),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",i)}const st=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),at=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){"{}"!==(t=JSON.stringify(t))&&localStorage.setItem(e,t)}removeItem(e){localStorage.removeItem(e)}};function it(t){let n,o,s,a,i,l,c,u,p,d;return{c(){n=P("div"),o=P("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',s=F(),a=P("input"),i=F(),l=P("div"),c=P("a"),u=L("Lancer"),S(o,"class","input-group-prepend"),S(a,"class","form-control svelte-1ecyaux"),S(a,"placeholder","Nom du raccourci"),S(a,"type","text"),S(c,"class","btn btn-outline-secondary svelte-1ecyaux"),S(c,"href",t[1]),q(c,"disabled",!(t[0].trim()&&Fe)),S(l,"class","input-group-append"),S(n,"class","input-group")},m(e,r){x(e,n,r),$(n,o),$(n,s),$(n,a),I(a,t[0]),$(n,i),$(n,l),$(l,c),$(c,u),p||(d=[_(a,"input",t[5]),_(a,"change",t[3]),_(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&a.value!==e[0]&&I(a,e[0]),2&t&&S(c,"href",e[1]),1&t&&q(c,"disabled",!(e[0].trim()&&Fe))},i:e,o:e,d(e){e&&w(n),p=!1,r(d)}}}const lt="OFP2MAP";function ct(e,t,n){const o=Z(),r=st.shortcut;let s,a=at.getItem(r)||lt,{ofp:i}=t;const l=i?i.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,i=e.ofp)},[a,s,function(e){const t=a.trim();if(t&&Fe){const e=ot(),o={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:i.ogimetData.proxyImg};n(1,s="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=a.trim();e===lt?at.removeItem(r):at.setItem(r,e),o("save",[r,e])},i,function(){a=this.value,n(0,a)}]}class ut extends Ce{constructor(e){super(),Pe(this,e,ct,it,a,{ofp:4})}}const pt=function(){var e,t=/\s*/g,n=/^\s*|\s*$/g,o=/\s+/;function r(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function s(e,t){return e.getElementsByTagName(t)}function a(e,t){return e.getAttribute(t)}function i(e,t){return parseFloat(a(e,t))}function l(e,t){var n=s(e,t);return n.length?n[0]:null}function c(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function p(e,t){var n,o,r={};for(o=0;o<t.length;o++)(n=l(e,t[o]))&&(r[t[o]]=u(n));return r}function d(e,t){for(var n in t)e[n]=t[n]}function m(e){return c(e.replace(t,"").split(","))}function f(e){for(var t=e.replace(n,"").split(o),r=[],s=0;s<t.length;s++)r.push(m(t[s]));return r}function g(e){var t,n=[i(e,"lon"),i(e,"lat")],o=l(e,"ele"),r=l(e,"gpxtpx:hr")||l(e,"hr"),s=l(e,"time");return o&&(t=parseFloat(u(o)),isNaN(t)||n.push(t)),{coordinates:n,time:s?u(s):null,heartRate:r?parseFloat(u(r)):null}}if("undefined"==typeof XMLSerializer)throw new Error("Unable to initialize serializer");function h(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return e=new XMLSerializer,{kml:function(e){for(var t={type:"FeatureCollection",features:[]},n={},o={},i={},p=["Polygon","LineString","Point","Track","gx:Track"],d=s(e,"Placemark"),g=s(e,"Style"),v=s(e,"StyleMap"),y=0;y<g.length;y++){var b=r(h(g[y])).toString(16);n["#"+a(g[y],"id")]=b,o[b]=g[y]}for(var $=0;$<v.length;$++){n["#"+a(v[$],"id")]=r(h(v[$])).toString(16);for(var x=s(v[$],"Pair"),w={},k=0;k<x.length;k++)w[u(l(x[k],"key"))]=u(l(x[k],"styleUrl"));i["#"+a(v[$],"id")]=w}for(var P=0;P<d.length;P++)t.features=t.features.concat(j(d[P]));function C(e){var t,n;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(n)?void 0:n]}function L(e){var t=s(e,"coord"),n=[],o=[];0===t.length&&(t=s(e,"gx:coord"));for(var r=0;r<t.length;r++)n.push(c(u(t[r]).split(" ")));for(var a=s(e,"when"),i=0;i<a.length;i++)o.push(u(a[i]));return{coords:n,times:o}}function F(e){var t,n,o,r,a,i=[],c=[];if(l(e,"MultiGeometry"))return F(l(e,"MultiGeometry"));if(l(e,"MultiTrack"))return F(l(e,"MultiTrack"));if(l(e,"gx:MultiTrack"))return F(l(e,"gx:MultiTrack"));for(o=0;o<p.length;o++)if(n=s(e,p[o]))for(r=0;r<n.length;r++)if(t=n[r],"Point"===p[o])i.push({type:"Point",coordinates:m(u(l(t,"coordinates")))});else if("LineString"===p[o])i.push({type:"LineString",coordinates:f(u(l(t,"coordinates")))});else if("Polygon"===p[o]){var d=s(t,"LinearRing"),g=[];for(a=0;a<d.length;a++)g.push(f(u(l(d[a],"coordinates"))));i.push({type:"Polygon",coordinates:g})}else if("Track"===p[o]||"gx:Track"===p[o]){var h=L(t);i.push({type:"LineString",coordinates:h.coords}),h.times.length&&c.push(h.times)}return{geoms:i,coordTimes:c}}function j(e){var t,r=F(e),c={},p=u(l(e,"name")),d=u(l(e,"address")),m=u(l(e,"styleUrl")),f=u(l(e,"description")),g=l(e,"TimeSpan"),h=l(e,"TimeStamp"),v=l(e,"ExtendedData"),y=l(e,"LineStyle"),b=l(e,"PolyStyle"),$=l(e,"visibility");if(!r.geoms.length)return[];if(p&&(c.name=p),d&&(c.address=d),m){"#"!==m[0]&&(m="#"+m),c.styleUrl=m,n[m]&&(c.styleHash=n[m]),i[m]&&(c.styleMapHash=i[m],c.styleHash=n[i[m].normal]);var x=o[c.styleHash];if(x){y||(y=l(x,"LineStyle")),b||(b=l(x,"PolyStyle"));var w=l(x,"IconStyle");if(w){var k=l(w,"Icon");if(k){var P=u(l(k,"href"));P&&(c.icon=P)}}}}if(f&&(c.description=f),g){var L=u(l(g,"begin")),j=u(l(g,"end"));c.timespan={begin:L,end:j}}if(h&&(c.timestamp=u(l(h,"when"))),y){var _=C(u(l(y,"color"))),M=_[0],S=_[1],T=parseFloat(u(l(y,"width")));M&&(c.stroke=M),isNaN(S)||(c["stroke-opacity"]=S),isNaN(T)||(c["stroke-width"]=T)}if(b){var z=C(u(l(b,"color"))),I=z[0],O=z[1],A=u(l(b,"fill")),D=u(l(b,"outline"));I&&(c.fill=I),isNaN(O)||(c["fill-opacity"]=O),A&&(c["fill-opacity"]="1"===A?c["fill-opacity"]||1:0),D&&(c["stroke-opacity"]="1"===D?c["stroke-opacity"]||1:0)}if(v){var q=s(v,"Data"),R=s(v,"SimpleData");for(t=0;t<q.length;t++)c[q[t].getAttribute("name")]=u(l(q[t],"value"));for(t=0;t<R.length;t++)c[R[t].getAttribute("name")]=u(R[t])}$&&(c.visibility=u($)),r.coordTimes.length&&(c.coordTimes=1===r.coordTimes.length?r.coordTimes[0]:r.coordTimes);var E={type:"Feature",geometry:1===r.geoms.length?r.geoms[0]:{type:"GeometryCollection",geometries:r.geoms},properties:c};return a(e,"id")&&(E.id=a(e,"id")),[E]}return t},gpx:function(e){var t,n,o=s(e,"trk"),r=s(e,"rte"),i=s(e,"wpt"),c={type:"FeatureCollection",features:[]};for(t=0;t<o.length;t++)(n=h(o[t]))&&c.features.push(n);for(t=0;t<r.length;t++)(n=v(r[t]))&&c.features.push(n);for(t=0;t<i.length;t++)c.features.push(y(i[t]));function m(e,t){for(var n=0;n<t;n++)e.push(null);return e}function f(e,t){var n=s(e,t),o=[],r=[],a=[],i=n.length;if(i<2)return{};for(var l=0;l<i;l++){var c=g(n[l]);o.push(c.coordinates),c.time&&r.push(c.time),(c.heartRate||a.length)&&(a.length||m(a,l),a.push(c.heartRate||null))}return{line:o,times:r,heartRates:a}}function h(e){for(var t,n=s(e,"trkseg"),o=[],r=[],a=[],i=0;i<n.length;i++)if((t=f(n[i],"trkpt"))&&(t.line&&o.push(t.line),t.times&&t.times.length&&r.push(t.times),a.length||t.heartRates&&t.heartRates.length)){if(!a.length)for(var c=0;c<i;c++)a.push(m([],o[c].length));t.heartRates&&t.heartRates.length?a.push(t.heartRates):a.push(m([],t.line.length||0))}if(0!==o.length){var u=$(e);return d(u,b(l(e,"extensions"))),r.length&&(u.coordTimes=1===o.length?r[0]:r),a.length&&(u.heartRates=1===o.length?a[0]:a),{type:"Feature",properties:u,geometry:{type:1===o.length?"LineString":"MultiLineString",coordinates:1===o.length?o[0]:o}}}}function v(e){var t=f(e,"rtept");if(t.line){var n=$(e);return d(n,b(l(e,"extensions"))),{type:"Feature",properties:n,geometry:{type:"LineString",coordinates:t.line}}}}function y(e){var t=$(e);return d(t,p(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:g(e).coordinates}}}function b(e){var t={};if(e){var n=l(e,"line");if(n){var o=u(l(n,"color")),r=parseFloat(u(l(n,"opacity"))),s=parseFloat(u(l(n,"width")));o&&(t.stroke=o),isNaN(r)||(t["stroke-opacity"]=r),isNaN(s)||(t["stroke-width"]=96*s/25.4)}}return t}function $(e){var t=p(e,["name","cmt","desc","type","time","keywords"]),n=s(e,"link");n.length&&(t.links=[]);for(var o,r=0;r<n.length;r++)d(o={href:a(n[r],"href")},p(n[r],["text","type"])),t.links.push(o);return t}return c}}}();function dt(t){let n,o,s,a,i,l,c,u,p,d,m,f,g,h,v,y,b,k=gt[0]+"",C=gt[1]+"",j=gt[2]+"";return{c(){n=P("div"),o=P("select"),s=P("option"),a=L(k),l=P("option"),c=L(C),p=P("option"),d=L(j),f=F(),g=P("div"),h=P("a"),v=L(t[0]),s.selected=i=0===t[1],s.__value=0,s.value=s.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,p.selected=m=2===t[1],p.__value=2,p.value=p.__value,S(o,"class","custom-select svelte-19hokx5"),S(o,"aria-label","Example select with button addon"),void 0===t[1]&&ne((()=>t[6].call(o))),S(h,"class","btn btn-success"),S(h,"download",t[3]),S(h,"href",t[2]),S(h,"target",mt),S(g,"class","input-group-append"),S(n,"class","input-group")},m(e,r){x(e,n,r),$(n,o),$(o,s),$(s,a),$(o,l),$(l,c),$(o,p),$(p,d),A(o,t[1]),$(n,f),$(n,g),$(g,h),$(h,v),y||(b=[_(o,"change",t[6]),_(o,"change",t[5]),_(h,"click",t[4])],y=!0)},p(e,[t]){2&t&&i!==(i=0===e[1])&&(s.selected=i),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&m!==(m=2===e[1])&&(p.selected=m),2&t&&A(o,e[1]),1&t&&z(v,e[0]),8&t&&S(h,"download",e[3]),4&t&&S(h,"href",e[2])},i:e,o:e,d(e){e&&w(n),y=!1,r(b)}}}const mt=navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,ft=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},gt=["KML Mapsme","KML Avenza","GeoJson"];function ht(e,t,n){const o=Z();let{label:r}=t;const s=st.downloadType;let a=at.getItem(s)||1;"string"==typeof a&&(a=parseInt(a,10));let i="",l="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,a,i,l,function(e){const t=ot(),o=["_mapsme.kml","_avenza.kml",".geojson"][a];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),0===a)n(2,i=ft(t.render()));else if(1===a)n(2,i=ft(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})));else{if(2!==a)return e.preventDefault(),!1;n(2,i=ft(JSON.stringify(function(e){const t=(new DOMParser).parseFromString(e,"text/xml");if(!t)throw"Could not parse KML";return pt.kml(t)}(t.render())),"application/vnd.geo+json"))}},function(){1===a?at.removeItem(s):at.setItem(s,a),o("save",[s,a])},function(){a=D(this),n(1,a)}]}class vt extends Ce{constructor(e){super(),Pe(this,e,ht,dt,a,{label:0})}}function yt(e){let t,n,o,r,s,a,i,l,c,u,p,d,m,f,g;return i=new vt({props:{label:"T√©l√©charger"}}),i.$on("save",e[1]),d=new ut({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=P("div"),n=P("div"),o=P("h5"),o.textContent="Export",r=F(),s=P("div"),a=P("div"),xe(i.$$.fragment),l=F(),c=P("small"),c.textContent="Le fichier est g√©n√©r√© en fonction des options choisies sur la carte.",u=F(),p=P("div"),xe(d.$$.fragment),m=F(),f=P("small"),f.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci √† installer</a>',S(o,"class","card-title"),S(c,"class","text-muted"),S(a,"class","col-12 col-sm-6 col-md-6"),S(f,"class","text-muted"),S(p,"class","col-12 col-sm-6 col-md-6"),S(s,"class","row"),S(n,"class","card-body"),S(t,"class","card mb-3 svelte-17snbjk")},m(e,h){x(e,t,h),$(t,n),$(n,o),$(n,r),$(n,s),$(s,a),we(i,a,null),$(a,l),$(a,c),$(s,u),$(s,p),we(d,p,null),$(p,m),$(p,f),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||(ge(i.$$.fragment,e),ge(d.$$.fragment,e),g=!0)},o(e){he(i.$$.fragment,e),he(d.$$.fragment,e),g=!1},d(e){e&&w(t),ke(i),ke(d)}}}function bt(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){K(e,t)},function(t){K(e,t)}]}class $t extends Ce{constructor(e){super(),Pe(this,e,bt,yt,a,{ofp:0})}}function xt(e){let t;return{c(){t=P("div"),t.innerHTML='<span class="sr-only">Loading...</span>',S(t,"class","spinner-border text-warning"),S(t,"role","status")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function wt(e){let t,n,o,r,s,a,i,l,c,u,p;return{c(){t=P("div"),n=P("p"),o=L("üò±: Erreur de r√©cup√©ration du Gramet, "),r=P("a"),r.textContent="essayez √† nouveau",s=L(" ou allez sur "),a=P("a"),i=L("ogimet"),c=L("."),S(r,"href","."),S(a,"href",l=e[0].ogimetData.url),S(a,"target","_blank"),S(n,"class","svelte-i1m2fr"),S(t,"class","error svelte-i1m2fr")},m(l,d){x(l,t,d),$(t,n),$(n,o),$(n,r),$(n,s),$(n,a),$(a,i),$(n,c),u||(p=_(r,"click",M(e[4])),u=!0)},p(e,t){1&t&&l!==(l=e[0].ogimetData.url)&&S(a,"href",l)},d(e){e&&w(t),u=!1,p()}}}function kt(e){let t,n,o,s;return{c(){t=P("img"),S(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n),S(t,"alt","gramet demo"),S(t,"class","img-fluid svelte-i1m2fr")},m(n,r){x(n,t,r),o||(s=[_(t,"error",e[2]),_(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&S(t,"src",n)},d(e){e&&w(t),o=!1,r(s)}}}function Pt(t){let n,o,r,s,a,i,l,c,u,p,d,m,f,g,h,v,y,b,k,C,j,_="loading"===t[1]&&xt();function M(e,t){return"error"!==e[1]?kt:wt}let T=M(t),z=T(t);return{c(){n=P("div"),o=P("h1"),o.innerHTML='Le GRAMET est un m√©t√©ogramme repr√©sentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et √† l&#39;heure de passage estim√©e, une coupe verticale de la m√©t√©o pr√©vue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interpr√©tation</a>',r=F(),s=P("div"),_&&_.c(),a=F(),z.c(),i=F(),l=P("div"),c=P("div"),u=P("div"),p=P("div"),d=P("div"),d.textContent="Route Ogimet",m=F(),f=P("div"),g=P("p"),h=L("Le GRAMET est r√©alis√© par "),v=P("a"),y=L("www.ogimet.com"),k=L(" √† partir\n    d'une route calcul√©e. Il est possible d'afficher la route sur la carte. Cel√† est\n    particuli√®rement utile lors des vols oc√©aniques car il n'y a aucune station en mer."),C=F(),j=P("div"),j.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Apr√®s avoir s√©lectionner les stations m√©t√©o proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectu√© pour r√©duire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',S(o,"class","svelte-i1m2fr"),S(s,"class","text-center svelte-i1m2fr"),S(d,"class","card-header svelte-i1m2fr"),S(v,"class","text-warning"),S(v,"href",b=t[0].ogimetData.url),S(v,"target","_blank"),S(g,"class","card-text"),S(f,"class","card-body"),S(p,"class","card ogimet svelte-i1m2fr"),S(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),S(j,"class","col-12 col-sm-6 col-md-6 col-xl-6"),S(c,"class","card-deck"),S(l,"class","row")},m(e,t){x(e,n,t),$(n,o),$(n,r),$(n,s),_&&_.m(s,null),$(s,a),z.m(s,null),$(n,i),$(n,l),$(l,c),$(c,u),$(u,p),$(p,d),$(p,m),$(p,f),$(f,g),$(g,h),$(g,v),$(v,y),$(g,k),$(c,C),$(c,j)},p(e,[t]){"loading"===e[1]?_||(_=xt(),_.c(),_.m(s,a)):_&&(_.d(1),_=null),T===(T=M(e))&&z?z.p(e,t):(z.d(1),z=T(e),z&&(z.c(),z.m(s,null))),1&t&&b!==(b=e[0].ogimetData.url)&&S(v,"href",b)},i:e,o:e,d(e){e&&w(n),_&&_.d(),z.d()}}}function Ct(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class Lt extends Ce{constructor(e){super(),Pe(this,e,Ct,Pt,a,{ofp:0})}}function Ft(t){let n,o,r;return{c(){n=P("h1"),n.innerHTML='Convertir l&#39;OFP <img src="svg/Air_France_Logo.svg" alt="logo Air France" class="svelte-2y0613"/> en KML/GeoJSON',o=F(),r=P("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card avenza svelte-2y0613"><div class="card-header svelte-2y0613">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les derni√®res technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card mapsme svelte-2y0613"><div class="card-header svelte-2y0613">Compatible MapsMe/Avenza</div> \n      <div class="card-body"><p class="card-text">Le th√®me par d√©faut s&#39;accorde parfaitement avec les fichiers avions, √©galement compatible avec Google Earth</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card ogimet svelte-2y0613"><div class="card-header svelte-2y0613">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-2y0613"><div class="card shortcuts svelte-2y0613"><div class="card-header svelte-2y0613">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">R√©cup√©rez le KML, le Gramet, et une route Lido optimis√©e dans l&#39;app Raccourcis</p></div></div></div></div>',S(n,"class","text-center svelte-2y0613"),S(r,"class","row svelte-2y0613")},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t)},p:e,i:e,o:e,d(e){e&&w(n),e&&w(o),e&&w(r)}}}class jt extends Ce{constructor(e){super(),Pe(this,e,null,Ft,a,{})}}function _t(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function Mt(e){let t,n,o,r=e[4].label+"";return{c(){t=P("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),$(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&w(t)}}}function St(t){let n,o,a,i,l,c,u,p,d,m,f,g,h=Tt,v=[];for(let e=0;e<h.length;e+=1)v[e]=Mt(_t(t,h,e));return{c(){n=P("div"),o=P("div"),a=P("label"),i=L("Rep√®re"),l=F(),c=P("span"),u=C("svg"),p=C("use"),d=F(),m=P("select");for(let e=0;e<v.length;e+=1)v[e].c();S(a,"class","input-group-text svelte-1j0ign2"),S(a,"for",t[1]),T(p,"xlink:href","#marker"),O(p,"stroke",0===t[0]?"#fff":"#000"),O(p,"fill",Tt[t[0]].color),S(u,"class","svelte-1j0ign2"),S(c,"class","input-group-text svelte-1j0ign2"),S(o,"class","input-group-prepend"),S(m,"name",t[1]),S(m,"class","custom-select svelte-1j0ign2"),void 0===t[0]&&ne((()=>t[3].call(m))),S(n,"class","input-group svelte-1j0ign2")},m(e,r){x(e,n,r),$(n,o),$(o,a),$(a,i),$(o,l),$(o,c),$(c,u),$(u,p),$(n,d),$(n,m);for(let e=0;e<v.length;e+=1)v[e].m(m,null);A(m,t[0]),f||(g=[_(m,"change",t[3]),_(m,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],f=!0)},p(e,[n]){if(t=e,2&n&&S(a,"for",t[1]),1&n&&O(p,"stroke",0===t[0]?"#fff":"#000"),1&n&&O(p,"fill",Tt[t[0]].color),1&n){let e;for(h=Tt,e=0;e<h.length;e+=1){const o=_t(t,h,e);v[e]?v[e].p(o,n):(v[e]=Mt(o),v[e].c(),v[e].m(m,null))}for(;e<v.length;e+=1)v[e].d(1);v.length=h.length}2&n&&S(m,"name",t[1]),1&n&&A(m,t[0])},i:e,o:e,d(e){e&&w(n),k(v,e),f=!1,r(g)}}}const Tt=[{label:"Aucun",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function zt(e,t,n){const o=Z();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class It extends Ce{constructor(e){super(),Pe(this,e,zt,St,a,{selected:0,name:1})}}function Ot(e,t,n){const o=e.slice();return o[4]=t[n],o[6]=n,o}function At(e){let t,n,o,r=e[4].label+"";return{c(){t=P("option"),n=L(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){x(e,t,o),$(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&w(t)}}}function Dt(t){let n,o,a,i,l,c,u,p,d=qt,m=[];for(let e=0;e<d.length;e+=1)m[e]=At(Ot(t,d,e));return{c(){n=P("div"),o=P("div"),a=P("label"),i=L("Couleur"),l=F(),c=P("select");for(let e=0;e<m.length;e+=1)m[e].c();S(a,"class","input-group-text svelte-90luj4"),S(a,"for",t[1]),S(o,"class","input-group-prepend"),S(c,"name",t[1]),S(c,"class","custom-select svelte-90luj4"),void 0===t[0]&&ne((()=>t[3].call(c))),S(n,"class","input-group svelte-90luj4")},m(e,r){x(e,n,r),$(n,o),$(o,a),$(a,i),$(n,l),$(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);A(c,t[0]),u||(p=[_(c,"change",t[3]),_(c,"change",(function(){s(t[2]("change",{name:t[1],value:t[0]}))&&t[2]("change",{name:t[1],value:t[0]}).apply(this,arguments)}))],u=!0)},p(e,[n]){if(t=e,2&n&&S(a,"for",t[1]),1&n){let e;for(d=qt,e=0;e<d.length;e+=1){const o=Ot(t,d,e);m[e]?m[e].p(o,n):(m[e]=At(o),m[e].c(),m[e].m(c,null))}for(;e<m.length;e+=1)m[e].d(1);m.length=d.length}2&n&&S(c,"name",t[1]),1&n&&A(c,t[0])},i:e,o:e,d(e){e&&w(n),k(m,e),u=!1,r(p)}}}const qt=[{label:"statuts"},{label:"vert/rouge"}];function Rt(e,t,n){const o=Z();let{selected:r=0}=t,{name:s}=t;return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(1,s=e.name)},[r,s,o,function(){r=D(this),n(0,r)}]}class Et extends Ce{constructor(e){super(),Pe(this,e,Rt,Dt,a,{selected:0,name:1})}}const Nt=[];function Wt(t,n=e){let o;const r=[];function s(e){if(a(t,e)&&(t=e,o)){const e=!Nt.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Nt.push(n,t)}if(e){for(let e=0;e<Nt.length;e+=2)Nt[e][0](Nt[e+1]);Nt.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(a,i=e){const l=[a,i];return r.push(l),1===r.length&&(o=n(s)||e),a(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const Gt=Wt(!1),Ut=Wt(!1),Ht=Wt(navigator.onLine);function Bt(t){let n,o,r;return{c(){n=P("button"),n.textContent="Revenir aux valeurs par d√©faut",S(n,"class","btn btn-link btn-sm float-right"),S(n,"type","button")},m(e,s){x(e,n,s),o||(r=_(n,"click",t[7]),o=!0)},p:e,d(e){e&&w(n),o=!1,r()}}}function Zt(e){let t,n,o,s,a,i,l,c,u,d,m,f,g,h,v,y,b,k,j,z,I,O,A,D,R,E,N,W,G,U,H,B,Z,K,J,X,V,Y,Q,ee,te,ne,oe,re,se,ae,ie,le,ce,ue,pe,de,me,fe,ve,ye,be,$e,Pe,Ce,Le,Fe,je,_e,Me,Se,Te,ze,Ie,Oe,Ae,De,qe,Re,Ee,Ne,We,Ge,Ue,He,Be,Ze,Ke,Je,Xe,Ve,Ye,Qe,tt,nt,ot,rt,st,at,it,lt,ct,ut,pt,dt,mt,ft,gt,ht,vt,yt,bt,$t,xt,wt,kt,Pt,Ct,Lt,Ft,jt,_t,Mt,St,Tt,zt,Ot,At,Dt,qt,Rt,Nt,Wt,Gt,Ut,Ht;y=new et({props:{name:"route-color",kmlColor:e[0].routeColor}}),y.$on("change",e[6]),z=new It({props:{name:"route-pin",selected:e[0].routePin}}),z.$on("change",e[6]),H=new et({props:{name:"alternate-color",kmlColor:e[0].alternateColor}}),H.$on("change",e[6]),J=new It({props:{name:"alternate-pin",selected:e[0].alternatePin}}),J.$on("change",e[6]),ae=new et({props:{name:"nat-color",kmlColor:e[0].natColor}}),ae.$on("change",e[6]),de=new It({props:{name:"nat-pin",selected:e[0].natPin}}),de.$on("change",e[6]),Te=new et({props:{name:"great-circle-color",kmlColor:e[0].greatCircleColor}}),Te.$on("change",e[6]),Ue=new et({props:{name:"ogimet-color",kmlColor:e[0].ogimetColor}}),Ue.$on("change",e[6]),rt=new et({props:{name:"etops-color",kmlColor:e[0].etopsColor}}),rt.$on("change",e[6]),ht=new Et({props:{name:"airport-pin",selected:e[0].airportPin}}),ht.$on("change",e[6]);let Zt=!e[3]&&Bt(e);return{c(){t=P("div"),n=P("a"),o=C("svg"),s=C("use"),a=F(),i=P("a"),l=C("svg"),c=C("use"),u=F(),d=P("form"),m=P("fieldset"),f=P("legend"),f.textContent="Route",g=F(),h=P("div"),v=P("div"),xe(y.$$.fragment),k=F(),j=P("div"),xe(z.$$.fragment),O=F(),A=P("fieldset"),D=P("legend"),R=P("input"),N=L("D√©gagement"),W=F(),G=P("div"),U=P("div"),xe(H.$$.fragment),Z=F(),K=P("div"),xe(J.$$.fragment),V=F(),Y=P("fieldset"),Q=P("legend"),ee=P("input"),ne=L("Tracks"),oe=F(),re=P("div"),se=P("div"),xe(ae.$$.fragment),ie=F(),le=P("small"),le.textContent="Un track incomplet restera rouge.",ue=F(),pe=P("div"),xe(de.$$.fragment),me=F(),fe=P("small"),fe.textContent="Positionn√© √† l'entr√©e des tracks.",ye=F(),be=P("div"),$e=P("div"),Pe=P("fieldset"),Ce=P("legend"),Le=P("input"),je=L("Orthodromie"),_e=F(),Me=P("div"),Se=P("div"),xe(Te.$$.fragment),Ie=F(),Oe=P("div"),Ae=P("fieldset"),De=P("legend"),qe=P("input"),Ee=L("Route du GRAMET"),Ne=F(),We=P("div"),Ge=P("div"),xe(Ue.$$.fragment),Be=F(),Ze=P("div"),Ke=P("div"),Je=P("fieldset"),Xe=P("legend"),Ve=P("input"),Qe=L("Etops"),tt=F(),nt=P("div"),ot=P("div"),xe(rt.$$.fragment),at=F(),it=P("div"),lt=P("fieldset"),ct=P("legend"),ut=P("input"),dt=L("Airports"),mt=F(),ft=P("div"),gt=P("div"),xe(ht.$$.fragment),yt=F(),bt=P("div"),$t=P("div"),xt=P("fieldset"),wt=P("legend"),kt=P("input"),Ct=L("FIR S√õRET√â"),Ft=F(),jt=P("div"),_t=P("div"),Mt=P("button"),St=L("M√©moriser"),zt=F(),Ot=P("button"),At=L("Restaurer"),Rt=F(),Nt=P("div"),Zt&&Zt.c(),T(s,"xlink:href","#bars"),S(o,"class","svelte-qfeyuc"),q(o,"blink",e[2]),S(n,"class","hamburger svelte-qfeyuc"),S(n,"role","button"),S(n,"href","."),T(c,"xlink:href","#close"),S(l,"class","svelte-qfeyuc"),q(l,"blink",e[2]),S(i,"class","closeB svelte-qfeyuc"),S(i,"role","button"),S(i,"href","."),S(f,"class","svelte-qfeyuc"),S(v,"class",b=p(e[1])+" svelte-qfeyuc"),S(j,"class",I=p(e[1])+" svelte-qfeyuc"),S(h,"class","row"),S(m,"class","form-group svelte-qfeyuc"),S(R,"name","alternate-display"),R.checked=E=e[0].alternateDisplay,S(R,"type","checkbox"),S(R,"class","svelte-qfeyuc"),S(D,"class","svelte-qfeyuc"),S(U,"class",B=p(e[1])+" svelte-qfeyuc"),S(K,"class",X=p(e[1])+" svelte-qfeyuc"),S(G,"class","row"),S(A,"class","form-group svelte-qfeyuc"),S(ee,"name","nat-display"),ee.checked=te=e[0].natDisplay,S(ee,"type","checkbox"),S(ee,"class","svelte-qfeyuc"),S(Q,"class","svelte-qfeyuc"),S(le,"class","form-text text-muted svelte-qfeyuc"),S(se,"class",ce=p(e[1])+" svelte-qfeyuc"),S(fe,"class","form-text text-muted svelte-qfeyuc"),S(pe,"class",ve=p(e[1])+" svelte-qfeyuc"),S(re,"class","row"),S(Y,"class","form-group svelte-qfeyuc"),S(Le,"name","great-circle-display"),Le.checked=Fe=e[0].greatCircleDisplay,S(Le,"type","checkbox"),S(Le,"class","svelte-qfeyuc"),S(Ce,"class","svelte-qfeyuc"),S(Se,"class","col"),S(Me,"class","row"),S(Pe,"class","form-group svelte-qfeyuc"),S($e,"class",ze=p(e[1])+" svelte-qfeyuc"),S(qe,"name","ogimet-display"),qe.checked=Re=e[0].ogimetDisplay,S(qe,"type","checkbox"),S(qe,"class","svelte-qfeyuc"),S(De,"class","svelte-qfeyuc"),S(Ge,"class","col"),S(We,"class","row"),S(Ae,"class","form-group svelte-qfeyuc"),S(Oe,"class",He=p(e[1])+" svelte-qfeyuc"),S(be,"class","row"),S(Ve,"name","etops-display"),Ve.checked=Ye=e[0].etopsDisplay,S(Ve,"type","checkbox"),S(Ve,"class","svelte-qfeyuc"),S(Xe,"class","svelte-qfeyuc"),S(ot,"class","col"),S(nt,"class","row"),S(Je,"class","form-group svelte-qfeyuc"),S(Ke,"class",st=p(e[1])+" svelte-qfeyuc"),S(ut,"name","airport-display"),ut.checked=pt=e[0].airportDisplay,S(ut,"type","checkbox"),S(ut,"class","svelte-qfeyuc"),S(ct,"class","svelte-qfeyuc"),S(gt,"class","col"),S(ft,"class","row"),S(lt,"class","form-group svelte-qfeyuc"),S(it,"class",vt=p(e[1])+" svelte-qfeyuc"),S(Ze,"class","row"),S(kt,"name","fir-display"),kt.checked=Pt=e[0].firDisplay,S(kt,"type","checkbox"),S(kt,"class","svelte-qfeyuc"),S(wt,"class","svelte-qfeyuc"),S(xt,"class","form-group svelte-qfeyuc"),S($t,"class",Lt=p(e[1])+" svelte-qfeyuc"),S(bt,"class","row"),Mt.disabled=Tt=!e[4],S(Mt,"class","btn btn-primary btn-sm mb-2"),S(Mt,"type","button"),Ot.disabled=Dt=!e[4],S(Ot,"class","btn btn-secondary btn-sm mb-2"),S(Ot,"type","button"),S(_t,"class",qt=p(e[1])+" svelte-qfeyuc"),S(Nt,"class",Wt=p(e[1])+" svelte-qfeyuc"),S(jt,"class","row last svelte-qfeyuc"),S(d,"class","svelte-qfeyuc"),S(t,"class","settings svelte-qfeyuc"),q(t,"sidebar",e[5])},m(r,p){x(r,t,p),$(t,n),$(n,o),$(o,s),$(t,a),$(t,i),$(i,l),$(l,c),$(t,u),$(t,d),$(d,m),$(m,f),$(m,g),$(m,h),$(h,v),we(y,v,null),$(h,k),$(h,j),we(z,j,null),$(d,O),$(d,A),$(A,D),$(D,R),$(D,N),$(A,W),$(A,G),$(G,U),we(H,U,null),$(G,Z),$(G,K),we(J,K,null),$(d,V),$(d,Y),$(Y,Q),$(Q,ee),$(Q,ne),$(Y,oe),$(Y,re),$(re,se),we(ae,se,null),$(se,ie),$(se,le),$(re,ue),$(re,pe),we(de,pe,null),$(pe,me),$(pe,fe),$(d,ye),$(d,be),$(be,$e),$($e,Pe),$(Pe,Ce),$(Ce,Le),$(Ce,je),$(Pe,_e),$(Pe,Me),$(Me,Se),we(Te,Se,null),$(be,Ie),$(be,Oe),$(Oe,Ae),$(Ae,De),$(De,qe),$(De,Ee),$(Ae,Ne),$(Ae,We),$(We,Ge),we(Ue,Ge,null),$(d,Be),$(d,Ze),$(Ze,Ke),$(Ke,Je),$(Je,Xe),$(Xe,Ve),$(Xe,Qe),$(Je,tt),$(Je,nt),$(nt,ot),we(rt,ot,null),$(Ze,at),$(Ze,it),$(it,lt),$(lt,ct),$(ct,ut),$(ct,dt),$(lt,mt),$(lt,ft),$(ft,gt),we(ht,gt,null),$(d,yt),$(d,bt),$(bt,$t),$($t,xt),$(xt,wt),$(wt,kt),$(wt,Ct),$(d,Ft),$(d,jt),$(jt,_t),$(_t,Mt),$(Mt,St),$(_t,zt),$(_t,Ot),$(Ot,At),$(jt,Rt),$(jt,Nt),Zt&&Zt.m(Nt,null),Gt=!0,Ut||(Ht=[_(n,"click",M(e[12])),_(i,"click",M(e[13])),_(R,"change",e[6]),_(ee,"change",e[6]),_(Le,"change",e[6]),_(qe,"change",e[6]),_(Ve,"change",e[6]),_(ut,"change",e[6]),_(kt,"change",e[6]),_(Mt,"click",e[9]),_(Ot,"click",e[8]),_(d,"submit",M(e[11]))],Ut=!0)},p(e,[n]){4&n&&q(o,"blink",e[2]),4&n&&q(l,"blink",e[2]);const r={};1&n&&(r.kmlColor=e[0].routeColor),y.$set(r),(!Gt||2&n&&b!==(b=p(e[1])+" svelte-qfeyuc"))&&S(v,"class",b);const s={};1&n&&(s.selected=e[0].routePin),z.$set(s),(!Gt||2&n&&I!==(I=p(e[1])+" svelte-qfeyuc"))&&S(j,"class",I),(!Gt||1&n&&E!==(E=e[0].alternateDisplay))&&(R.checked=E);const a={};1&n&&(a.kmlColor=e[0].alternateColor),H.$set(a),(!Gt||2&n&&B!==(B=p(e[1])+" svelte-qfeyuc"))&&S(U,"class",B);const i={};1&n&&(i.selected=e[0].alternatePin),J.$set(i),(!Gt||2&n&&X!==(X=p(e[1])+" svelte-qfeyuc"))&&S(K,"class",X),(!Gt||1&n&&te!==(te=e[0].natDisplay))&&(ee.checked=te);const c={};1&n&&(c.kmlColor=e[0].natColor),ae.$set(c),(!Gt||2&n&&ce!==(ce=p(e[1])+" svelte-qfeyuc"))&&S(se,"class",ce);const u={};1&n&&(u.selected=e[0].natPin),de.$set(u),(!Gt||2&n&&ve!==(ve=p(e[1])+" svelte-qfeyuc"))&&S(pe,"class",ve),(!Gt||1&n&&Fe!==(Fe=e[0].greatCircleDisplay))&&(Le.checked=Fe);const d={};1&n&&(d.kmlColor=e[0].greatCircleColor),Te.$set(d),(!Gt||2&n&&ze!==(ze=p(e[1])+" svelte-qfeyuc"))&&S($e,"class",ze),(!Gt||1&n&&Re!==(Re=e[0].ogimetDisplay))&&(qe.checked=Re);const m={};1&n&&(m.kmlColor=e[0].ogimetColor),Ue.$set(m),(!Gt||2&n&&He!==(He=p(e[1])+" svelte-qfeyuc"))&&S(Oe,"class",He),(!Gt||1&n&&Ye!==(Ye=e[0].etopsDisplay))&&(Ve.checked=Ye);const f={};1&n&&(f.kmlColor=e[0].etopsColor),rt.$set(f),(!Gt||2&n&&st!==(st=p(e[1])+" svelte-qfeyuc"))&&S(Ke,"class",st),(!Gt||1&n&&pt!==(pt=e[0].airportDisplay))&&(ut.checked=pt);const g={};1&n&&(g.selected=e[0].airportPin),ht.$set(g),(!Gt||2&n&&vt!==(vt=p(e[1])+" svelte-qfeyuc"))&&S(it,"class",vt),(!Gt||1&n&&Pt!==(Pt=e[0].firDisplay))&&(kt.checked=Pt),(!Gt||2&n&&Lt!==(Lt=p(e[1])+" svelte-qfeyuc"))&&S($t,"class",Lt),(!Gt||16&n&&Tt!==(Tt=!e[4]))&&(Mt.disabled=Tt),(!Gt||16&n&&Dt!==(Dt=!e[4]))&&(Ot.disabled=Dt),(!Gt||2&n&&qt!==(qt=p(e[1])+" svelte-qfeyuc"))&&S(_t,"class",qt),e[3]?Zt&&(Zt.d(1),Zt=null):Zt?Zt.p(e,n):(Zt=Bt(e),Zt.c(),Zt.m(Nt,null)),(!Gt||2&n&&Wt!==(Wt=p(e[1])+" svelte-qfeyuc"))&&S(Nt,"class",Wt),32&n&&q(t,"sidebar",e[5])},i(e){Gt||(ge(y.$$.fragment,e),ge(z.$$.fragment,e),ge(H.$$.fragment,e),ge(J.$$.fragment,e),ge(ae.$$.fragment,e),ge(de.$$.fragment,e),ge(Te.$$.fragment,e),ge(Ue.$$.fragment,e),ge(rt.$$.fragment,e),ge(ht.$$.fragment,e),Gt=!0)},o(e){he(y.$$.fragment,e),he(z.$$.fragment,e),he(H.$$.fragment,e),he(J.$$.fragment,e),he(ae.$$.fragment,e),he(de.$$.fragment,e),he(Te.$$.fragment,e),he(Ue.$$.fragment,e),he(rt.$$.fragment,e),he(ht.$$.fragment,e),Gt=!1},d(e){e&&w(t),ke(y),ke(z),ke(H),ke(J),ke(ae),ke(de),ke(Te),ke(Ue),ke(rt),ke(ht),Zt&&Zt.d(),Ut=!1,r(Ht)}}}function Kt(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Jt(e,t,n){let o,r,s;i(e,Ut,(e=>n(5,s=e)));const a=Z(),l=st.optionsKML;let{kmlOptions:c}=t,{mode:u="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"}=t,p={...tt,...at.getItem(l)||{}},m=Kt(tt,c);function f(e){let t=!1;for(const[r,s]of Object.entries(e))c[r]!==s&&(n(0,c[r]=s,c),a("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:s}),t=!0);var o;t&&n(0,c={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,c=e.kmlOptions),"mode"in e&&n(1,u=e.mode)},e.$$.update=()=>{1&e.$$.dirty&&n(3,o=Kt(tt,c)),1025&e.$$.dirty&&n(4,r=!Kt(p,c))},[c,u,m,o,r,s,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));c[r]!==o&&(n(0,c[r]=o,c),a("change",{name:t,value:o}))},function(){f(tt)},function(){f(p)},function(){if(o)at.removeItem(l);else{const e={};for(const t of Object.keys(c).filter((e=>c[e]!==tt[e])))e[t]=c[t];at.setItem(l,e)}a("save"),n(10,p={...c})},p,function(t){K(e,t)},()=>{d(Ut,s=!s,s),n(2,m=!1)},()=>{d(Ut,s=!s,s),n(2,m=!1)}]}class Xt extends Ce{constructor(e){super(),Pe(this,e,Jt,Zt,a,{kmlOptions:0,mode:1})}}const Vt=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Yt=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],Qt=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],en=e=>0===e?3:0,tn=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"];function nn(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function on(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function rn(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const sn=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"];function an(e,t,n,o,r,s,a){e.addSource(`${t}-marker-source`,on(((e,t,n)=>{let o=[];const r=e.length;for(let s=0;s<r;s++){const r=t?t([e[s].longitude,e[s].latitude]):[e[s].longitude,e[s].latitude];r&&o.push(n?n(r,e[s]):r)}return o})(n,o,((e,t)=>nn(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(un(t,r,a,s))}function ln(e,t,n,o,r,s){o?e.addSource(`${t}-line-source`,on(o(n).map((e=>rn(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:rn(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(pn(t,r,s))}function cn(e,t,n,o,r,s){if(o){const r=n.length,s=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)s.push(rn(t[e]))}e.addSource(`${t}-line-source`,on(s))}else e.addSource(`${t}-line-source`,on(n.map((e=>rn(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(pn(t,r,s))}function un(e,t,n,o){const[r,s]=Ke(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":10,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?sn[t]:r,"icon-halo-width":1,"icon-halo-color":"#000","text-color":r,"text-opacity":Math.max(s,.7)}}}function pn(e,t,n){const[o,r]=Ke(t);let s=2,a=[1];return-1!==e.indexOf("-ep-")||-1!==e.indexOf("-etops-")?(s=1,a=[10,10]):-1!==e.indexOf("rnat")&&(s=1),{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":o,"line-opacity":r,"line-width":s,"line-dasharray":a}}}const dn=2*Math.PI,mn=Math.PI/4,fn=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*dn};var gn={init:function(){},forward:function(e){var t=e.x,n=e.y,o=fn(t-this.long0),r=Math.tan(n/2),s=Math.sin(mn*r),a=s*s,i=this.x0+this.a*o*(.74482-.34588*a),l=this.y0+1.70711*this.a*r;return e.x=i,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(mn*t),o=n*n,r=fn(this.long0+e.x/this.a/(.74482-.34588*o)),s=2*Math.atan(t);return e.x=r,e.y=s,e},names:["The Times","times"]};const hn="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q";function vn(e,t,n,o,r,s){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(gn);const a=t.id.startsWith("jb_");let i={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${a?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR ¬© Olivier Ravet`};const l=new mapboxgl.Map({...t.mapboxOptions,...i});let c,u,p,d;l._setCacheLimits(320,32),l.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||l.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||l.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||l.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),l.loadImage("sdf/map-star-sdf.png",(function(e,t){e||l.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let m,f=e=>window.proj4("WGS84","EPSG:3857",e),g=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const s=[-20026376.39,-20048966.1,20026376.39,20048966.1],a=s[2]-s[0],i=s[3]-s[1],[l,c,u,p]=t.extent,[d,m]=t.ratio,f=a/d*m*(i/a),[g,h,v,y]=[s[0],s[3]-f,s[2],s[3]];e=(v-g)/(u-l),n=g-e*l,o=(y-h)/(p-c),r=h-o*c}else{const[s,a,i,l]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(i-s),n=c-e*s,o=(d-u)/(l-a),r=u-o*a}const[s,a,i,l]=t.viewport?t.viewport:t.extent,m=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>g(h(e));f=e=>h(m(e)),c=e=>g(f(e)),u=e=>{let[t,n]=m(e);return t=Me(t,s,i),n=Me(n,a,l),v([t,n])},p=e=>{let[t,n]=m(e);if(Se(t,s,i)&&Se(n,a,l))return v([t,n])},d=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,s,a,i,l=e.length,c=ze(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],a=i=ze(s=e[o],t);;){if(!(c|a)){u.push(r),a!==i?(u.push(s),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(s);break}if(c&a)break;c?c=ze(r=Te(r,s,c,t),t):a=ze(s=Te(r,s,a,t),t)}c=i}return u.length&&n.push(u),n}(e.map((e=>m([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let h=[];if(!n.isFake){for(const e of n.tracks)h=h.concat(e.points);h=h.concat(n.route.points,n.wptCoordinatesAlternate()),m=Ae(h,u),l.fitBounds(m,{padding:{top:30,bottom:80,left:30,right:30}})}const v=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(c){const e=v._onSuccess;v._onSuccess=function(t){const[n,o]=c([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}return l.addControl(v),l.on("load",(function(){t.tiles&&(l.addSource("jb-raster",{type:"raster",tiles:t.tiles,tileSize:t.tileSize}),l.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),function(e,t,n,o,r,s,a,i){const l={...tt,...t},c=e.description;if(!e.isFake){const t=`${e.infos.departure}-${e.infos.destination}`,o=new editolido.Route(e.wptCoordinates(),{name:t,description:c}),r=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route D√©gagement"});ln(n,"greatcircle",new editolido.Route([o.points[0],o.points[o.points.length-1]]).split(300,{name:`Ortho ${t}`}).points,a,l.greatCircleColor,l.greatCircleDisplay),ln(n,"ogimet",e.ogimetData.route.points,a,l.ogimetColor,l.ogimetDisplay),ln(n,"ralt",r.points,a,l.alternateColor,l.alternateDisplay),ln(n,"rmain",o.points,a,l.routeColor,!0),an(n,"ralt",r.points,s,l.alternatePin,l.alternateDisplay,l.alternateColor),an(n,"rmain",o.points,s,l.routePin,!0,l.routeColor)}"jb_pacific"!==i.id&&((e,t,n)=>{fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((o=>{if(t)for(let e=0;e<o.features.length;e++){const n=o.features[e].geometry.coordinates[0];o.features[e].geometry.coordinates=[n.map((e=>t(e)))]}e.addSource("fir-reg-source",{type:"geojson",data:o}),e.addLayer({id:"fir-reg-layer",type:"fill",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),e.addLayer({id:"fir-reg-line-layer",type:"line",source:"fir-reg-source",layout:{visibility:n?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))})(n,o,l.firDisplay);let u=[];e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(u=[e.infos.EEP,e.infos.EXP]);((e,t,n,o,r,s,a,i)=>{const[l]=Ke(s),c=o.map((e=>e.name)),u=r.map((e=>e.name)),p=c.concat(u);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((o=>{if(t){const e=[];for(let n of o.features)n.geometry.coordinates=t(n.geometry.coordinates),void 0!==n.geometry.coordinates&&e.push(n);o.features=e}e.addSource("airports-source",{type:"geojson",data:o}),e.addLayer({id:"airport-emer-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":["case",["==",2,["get","level"]],.5,.4],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:i?"visible":"none","text-field":["get","name"],"text-size":8,"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Yt(n,!1)}),e.addLayer({id:"airport-layer",type:"symbol",source:"airports-source",layout:{"icon-image":["case",["in",["get","name"],["literal",p]],"sdf-triangle","sdf-airport"],"icon-size":["case",["in",["get","name"],["literal",p]],1,.6],"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:i?"visible":"none","text-field":["get","name"],"text-size":["case",["in",["get","name"],["literal",p]],10,8],"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Qt(n,p)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":en(a),"icon-color":Vt(a,n,u,l),"text-color":tn(u,l),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Yt(n)});const r=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!je}),s=function(t){const n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.title;for(;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;r.setLngLat(n).setHTML(o).addTo(e)},c=()=>e.getCanvas().style.cursor="pointer",d=()=>e.getCanvas().style.cursor="",m=function(){d(),r.remove()};je?(e.on("mouseenter","airport-layer",(e=>{c(),s(e)})),e.on("mouseenter","airport-emer-layer",(e=>{c(),s(e)})),e.on("mouseleave","airport-layer",m),e.on("mouseleave","airport-emer-layer",m)):(e.on("mouseenter","airport-layer",c),e.on("mouseenter","airport-emer-layer",c),e.on("click","airport-layer",s),e.on("click","airport-emer-layer",s),e.on("mouseleave","airport-layer",d),e.on("mouseleave","airport-emer-layer",d))}))})(n,s,e.isFake?e.isFake:e.infos.aircraft,u,e.infos.raltPoints,l.etopsColor,l.airportPin,l.airportDisplay),e.isFake||(function(e,t,n,o,r,s,a){const i={rnat:[],"rnat-incomplete":[]},l={rnat:[],"rnat-incomplete":[]};for(let e of t.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(o){const n=o(e.points),r=n.length;for(let o=0;o<r;o++)i[t].push(rn(n[o],e.name))}else i[t].push(rn(e.points.map((e=>[e.longitude,e.latitude])),e.name));const r=e.points[0];let s=n?n([r.longitude,r.latitude]):[r.longitude,r.latitude];if(s&&l[t].push(nn(s,`${e.name}\n${r.name}`,e.description)),e.isMine){const o=e.points[e.points.length-1];s=n?n([o.longitude,o.latitude]):[o.longitude,o.latitude],s&&l[t].push(nn(s,`${e.name}\n${o.name}`,e.description))}}e.addSource("rnat-marker-source",on(l.rnat)),e.addSource("rnat-incomplete-marker-source",on(l["rnat-incomplete"])),e.addSource("rnat-line-source",on(i.rnat)),e.addSource("rnat-incomplete-line-source",on(i["rnat-incomplete"])),e.addLayer(pn("rnat",r,a)),e.addLayer(pn("rnat-incomplete",tt.natIncompleteColor,a)),e.addLayer(un("rnat",s,r,a)),e.addLayer(un("rnat-incomplete",s,r,a));const c=t=>{for(var n=t.features[0].geometry.coordinates.slice(),o=t.features[0].properties.description;Math.abs(t.lngLat.lng-n[0])>180;)n[0]+=t.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(e)},u=t=>{const n=t+"-marker-layer";e.on("click",n,c),e.on("mouseenter",n,(function(){e.getCanvas().style.cursor="pointer"})),e.on("mouseleave",n,(function(){e.getCanvas().style.cursor=""}))};u("rnat"),u("rnat-incomplete")}(n,e,s,a,l.natColor,l.natPin,l.natDisplay),e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&function(e,t,n,o,r,s,a,i){cn(e,`${t}-ep-circle`,[n[0].circle(420,48),n[1].circle(420,48)],o,a,r),cn(e,`${t}-etops-circle`,n.slice(2).map((e=>e.circle(7*s))),o,i,r)}(n,"etops",[e.infos.EEP,e.infos.EXP].concat(e.infos.raltPoints),a,l.etopsDisplay,e.infos.ETOPS,l.routeColor,l.etopsColor))}(n,o,l,c,0,p,d,t);const a=document.querySelector(`#${e} .mapboxgl-ctrl-attrib-inner`);a&&(a.appendChild(document.createTextNode(" | ")),a.appendChild(r),a.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`))),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2"),s&&s(l,t)})),[l,u]}function yn(e,t,n){if("etops"===t)return function(e,t){let n="etops-etops-circle-line-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="etops-ep-circle-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("fir"===t)return function(e,t){let n="fir-reg-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="fir-reg-line-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);if("airport"===t)return function(e,t){let n="airport-layer";e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none"),n="airport-emer-layer",e.getLayer(n)&&e.setLayoutProperty(n,"visibility",t?"visible":"none")}(e,n);const o=t+"-marker-layer",r=t+"-line-layer";e.getLayer(r)&&e.setLayoutProperty(r,"visibility",n?"visible":"none"),e.getLayer(o)&&e.setLayoutProperty(o,"visibility",n?"visible":"none")}function bn(e,t,n){const[o,r]=Ke(n);if("etops"===t)return function(e,t){const[n,o]=Ke(t),r="etops-etops-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n);const s=t+"-marker-layer",a=t+"-line-layer";e.getLayer(a)&&(e.setPaintProperty(a,"line-color",o),e.setPaintProperty(a,"line-opacity",r)),e.getLayer(s)&&e.setPaintProperty(s,"text-color",o),"rmain"===t&&function(e,t){const[n,o]=Ke(t),r="etops-ep-circle-line-layer";e.getLayer(r)&&(e.setPaintProperty(r,"line-color",n),e.setPaintProperty(r,"line-opacity",o))}(e,n)}function $n(e,t,n,o,r,s){if("airport"===t)return function(e,t,n,o,r){const[s]=Ke(r),a="airport-layer";e.getLayer(a)&&(e.setPaintProperty(a,"icon-color",Vt(t,n,o,s)),e.setPaintProperty(a,"text-color",tn(o,s)),e.setPaintProperty(a,"icon-halo-width",en(t)))}(e,n,o,r,s);const a=sn[n],i=t+"-marker-layer",l=t+"-line-layer";if(e.getLayer(i)){const t=e.getPaintProperty(l,"line-color");e.setPaintProperty(i,"icon-color",0!==n?a:t),e.setPaintProperty(i,"text-color",t),e.setLayoutProperty(i,"icon-size",0!==n?1:.2),e.setLayoutProperty(i,"icon-image",0!==n?"sdf-marker-15":"sdf-triangle"),e.setLayoutProperty(i,"icon-anchor",0!==n?"bottom":"center")}}function xn(e,t,n,o,r,s){const a=_e(t);if("aircraftType"===t){let t=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(t=[o.infos.EEP.name,o.infos.EXP.name]),function(e,t,n,o,r,s){const[a]=Ke(s),i="airport-layer";e.setFilter(i,Yt(n)),e.setPaintProperty(i,"icon-color",Vt(t,n,o,a)),e.setLayoutProperty(i,"symbol-sort-key",Qt(n,r)),e.setFilter("airport-emer-layer",Yt(n,!1))}(e,r.airportPin,s,o.infos.ralts,t.concat(o.infos.ralts),r.etopsColor)}else t.endsWith("-display")?("rnat"===a&&yn(e,"rnat-incomplete",n),yn(e,a,n)):t.endsWith("-pin")?$n(e,a,n,s,o.infos.ralts,r.etopsColor):t.endsWith("-color")&&bn(e,a,n)}const wn={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1};class kn{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const s=indexedDB.open(e,t);s.onsuccess=()=>{o(s)},s.onerror=()=>{r("Error while opening DB")},s.onupgradeneeded=n?n.bind(null,s):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const s=n.result.transaction(t,"readonly").objectStore(t).get(e);s.onsuccess=()=>{o(s.result)},s.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,s)=>{const a=o.result.transaction(t,"readwrite").objectStore(t),i=a.put(n,e);i.onsuccess=()=>{const t=a.get(e);t.onsuccess=()=>{r(t.result)}},i.onerror=()=>{s("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,s)=>{const a=o.result.transaction(e,"readonly").objectStore(e).getKey(n);a.onsuccess=()=>{r(void 0===a.result?t:null)},a.onerror=()=>{s("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}const Pn=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,Cn=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv1",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:wn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:Pn},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:wn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:Pn},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:wn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:Pn},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:wn,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:Pn}];function Ln(e,t,n){const o=e.slice();return o[12]=t[n],o}function Fn(e){let t,n,o,s,a,i=Sn,l=[];for(let t=0;t<i.length;t+=1)l[t]=jn(Ln(e,i,t));return{c(){t=P("div"),n=P("select"),o=P("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,S(n,"class","form-control-sm svelte-14yxy04"),n.disabled=e[1],S(t,"class","footer svelte-14yxy04")},m(r,i){x(r,t,i),$(t,n),$(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);s||(a=[_(n,"click",e[4],{once:!0}),_(n,"change",e[6])],s=!0)},p(e,t){if(0&t){let o;for(i=Sn,o=0;o<i.length;o+=1){const r=Ln(e,i,o);l[o]?l[o].p(r,t):(l[o]=jn(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=i.length}2&t&&(n.disabled=e[1])},d(e){e&&w(t),k(l,e),s=!1,r(a)}}}function jn(t){let n,o,r=t[12]+"";return{c(){n=P("option"),o=L(r),n.__value=t[12],n.value=n.__value},m(e,t){x(e,n,t),$(n,o)},p:e,d(e){e&&w(n)}}}function _n(t){let n,o,s,a,i,l,c,u,p,d=!t[0]&&Fn(t);return{c(){n=P("div"),o=P("input"),s=F(),a=P("label"),i=L(t[2]),l=F(),d&&d.c(),c=j(),S(o,"id",zn),S(o,"name",zn),S(o,"type","file"),S(o,"accept","application/pdf"),o.disabled=t[1],S(o,"class","custom-file-input svelte-14yxy04"),S(a,"class","custom-file-label text-truncate svelte-14yxy04"),S(a,"for",zn),q(a,"ready",t[3]),S(n,"class","custom-file svelte-14yxy04"),q(n,"blink",!t[0])},m(e,r){x(e,n,r),$(n,o),$(n,s),$(n,a),$(a,i),x(e,l,r),d&&d.m(e,r),x(e,c,r),u||(p=[_(o,"change",t[5]),_(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){2&t&&(o.disabled=e[1]),4&t&&z(i,e[2]),8&t&&q(a,"ready",e[3]),1&t&&q(n,"blink",!e[0]),e[0]?d&&(d.d(1),d=null):d?d.p(e,t):(d=Fn(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&w(n),e&&w(l),d&&d.d(e),e&&w(c),u=!1,r(p)}}}const Mn=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.6.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.6.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],Sn=["318","319","320","321","330","340","350","380","787","772","773","77F"],Tn=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let zn="file";function In(e,t,n){let o,{promise:r}=t,{kmlOptions:s}=t,a=!1,i=new Le,l="Choisir un OFP",c=!1;const u=Z();function p(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const s="script"===e,a=document.createElement(s?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(a.crossOrigin="anonymous");let i=!0;s?(a.src=t,a.async=n.async,a.defer=n.defer):(a.href=t,"prefetch"in n?(a.rel="prefetch",o-=1,i=!1):"preload"in n?(a.rel="preload",o-=1,i=!1):(a.rel="stylesheet",o-=1,i=!1)),i&&(a.onload=r),document.body.appendChild(a)}))}(Mn,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",o&&!o.destroyed||(o=new e.PDFWorker),i.resolve(!0),n(3,c=!0)}))}const d=e=>{const t=new FileReader;return new Promise(((n,r)=>{t.onload=e=>{if(!o||o.destroyed){const e=window["pdfjs-dist/build/pdf"];o=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,s=r.numPages;for(let e=1;e<=s;e+=1){const t=await Tn(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:o}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),o=new editolido.GeoGridIndex;o.data=window.WMO;const a=editolido.ogimetData(t,o);a.proxyImg=`https://ofp2map-gramet.vercel.app/api/${a.proxy}__${a.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,a.route.description=a.wmo.join(" "),t.ogimetData=a;try{ot();rt(t,s),n(t)}catch(e){r(e)}}catch(e){r(e)}else r(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>r(e)))},t.onerror=e=>{r(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"promise"in e&&n(0,r=e.promise),"kmlOptions"in e&&n(7,s=e.kmlOptions)},[r,a,l,c,p,async function(e){n(1,a=!0),p(),await i.promise.then((()=>{const t=e.target.files[0];t&&(n(2,l=e.target.value.split(/([\\/])/g).pop()),u("change",l),n(0,r=d(t)),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))})),n(1,a=!1)},async function(e){n(1,a=!0),p(),await i.promise.then((()=>{n(0,r=new Promise(((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{ot();rt(o,s),t(o)}catch(e){n(e)}}))),n(0,r.isFakeOfp=!0,r),window.location.hash="#/map"})),n(1,a=!1)},s]}class On extends Ce{constructor(e){super(),Pe(this,e,In,_n,a,{promise:0,kmlOptions:7})}}const{window:An}=be;function Dn(e,t,n){const o=e.slice();return o[33]=t[n],o[35]=n,o}function qn(e,t,n){const o=e.slice();return o[36]=t[n],o[35]=n,o}function Rn(e){let t,n,o,r=(e[36].proj4&&e[18](e[36])?`${e[36].label.toUpperCase()}`:e[36].label)+"";return{c(){t=P("option"),n=L(r),t.__value=e[35],t.value=t.__value,t.selected=o=e[35]===e[6]},m(e,o){x(e,t,o),$(t,n)},p(e,n){64&n[0]&&o!==(o=e[35]===e[6])&&(t.selected=o)},d(e){e&&w(t)}}}function En(e){let t,n,o,r,s,a,i,l,c;return{c(){t=P("div"),n=C("svg"),o=C("path"),r=C("path"),a=F(),i=P("span"),i.textContent="‚Üì",S(o,"d","M50,5A45 45 0 1 1 49.9999 5"),S(o,"class","svelte-135w3h2"),S(r,"d",s=e[12]()),S(r,"class","svelte-135w3h2"),S(n,"viewBox","0 0 100 100"),S(n,"class","svelte-135w3h2"),S(i,"class","svelte-135w3h2"),S(t,"class","cacheButton svelte-135w3h2"),q(t,"cacheError",e[9]),q(t,"cacheProgress",e[5]>0||e[4]>0)},m(s,u){x(s,t,u),$(t,n),$(n,o),$(n,r),$(t,a),$(t,i),l||(c=_(t,"click",e[21]),l=!0)},p(e,n){4096&n[0]&&s!==(s=e[12]())&&S(r,"d",s),512&n[0]&&q(t,"cacheError",e[9]),48&n[0]&&q(t,"cacheProgress",e[5]>0||e[4]>0)},d(e){e&&w(t),l=!1,c()}}}function Nn(e){let t,n,o,r=e[33]+"";return{c(){t=P("option"),n=L(r),t.__value=e[35],t.value=t.__value,t.selected=o=e[35]===e[7]},m(e,o){x(e,t,o),$(t,n)},p(e,n){128&n[0]&&o!==(o=e[35]===e[7])&&(t.selected=o)},d(e){e&&w(t)}}}function Wn(e){let t,n=("???"!==e[33]||"???"===e[7]&&"???"===e[33])&&Nn(e);return{c(){n&&n.c(),t=j()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){"???"!==e[33]||"???"===e[7]&&"???"===e[33]?n?n.p(e,o):(n=Nn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&w(t)}}}function Gn(e){let t,n,o,a,i,l,c,u,p,d,f,g,h,v,y=Cn,b=[];for(let t=0;t<y.length;t+=1)b[t]=Rn(qn(e,y,t));let C=e[6]>=0&&!e[1].isFake&&(navigator&&!0===navigator.standalone||!1)&&e[13]&&!0!==e[10][Cn[e[6]].id]&&!e[11]&&En(e),L=e[14],j=[];for(let t=0;t<L.length;t+=1)j[t]=Wn(Dn(e,L,t));function M(t){e[26](t)}let T={};return void 0!==e[0]&&(T.kmlOptions=e[0]),d=new Xt({props:T}),X.push((()=>$e(d,"kmlOptions",M))),d.$on("change",e[19]),d.$on("save",e[27]),{c(){t=P("div"),o=F(),a=P("div"),i=P("select");for(let e=0;e<b.length;e+=1)b[e].c();l=F(),C&&C.c(),c=F(),u=P("select");for(let e=0;e<j.length;e+=1)j[e].c();p=F(),xe(d.$$.fragment),S(t,"id",e[3]),S(t,"class","svelte-135w3h2"),S(i,"name",Un),S(i,"class","form-control form-control-sm svelte-135w3h2"),void 0===e[6]&&ne((()=>e[23].call(i))),S(a,"class","mapmenu svelte-135w3h2"),S(u,"name","aircraftType"),S(u,"class","svelte-135w3h2"),void 0===e[7]&&ne((()=>e[25].call(u)))},m(r,s){x(r,t,s),x(r,o,s),x(r,a,s),$(a,i);for(let e=0;e<b.length;e+=1)b[e].m(i,null);A(i,e[6]),$(a,l),C&&C.m(a,null),x(r,c,s),x(r,u,s);for(let e=0;e<j.length;e+=1)j[e].m(u,null);e[24](u),A(u,e[7]),x(r,p,s),we(d,r,s),g=!0,h||(v=[_(An,"orientationchange",e[20]),m(n=e[17].call(null,t,{route:e[2]})),_(i,"change",e[23]),_(i,"change",e[15]),_(u,"change",e[25]),_(u,"change",e[16])],h=!0)},p(e,o){if((!g||8&o[0])&&S(t,"id",e[3]),n&&s(n.update)&&4&o[0]&&n.update.call(null,{route:e[2]}),262208&o[0]){let t;for(y=Cn,t=0;t<y.length;t+=1){const n=qn(e,y,t);b[t]?b[t].p(n,o):(b[t]=Rn(n),b[t].c(),b[t].m(i,null))}for(;t<b.length;t+=1)b[t].d(1);b.length=y.length}if(64&o[0]&&A(i,e[6]),e[6]>=0&&!e[1].isFake&&navigator&&!0===navigator.standalone&&e[13]&&!0!==e[10][Cn[e[6]].id]&&!e[11]?C?C.p(e,o):(C=En(e),C.c(),C.m(a,null)):C&&(C.d(1),C=null),16512&o[0]){let t;for(L=e[14],t=0;t<L.length;t+=1){const n=Dn(e,L,t);j[t]?j[t].p(n,o):(j[t]=Wn(n),j[t].c(),j[t].m(u,null))}for(;t<j.length;t+=1)j[t].d(1);j.length=L.length}128&o[0]&&A(u,e[7]);const r={};!f&&1&o[0]&&(f=!0,r.kmlOptions=e[0],oe((()=>f=!1))),d.$set(r)},i(e){g||(ge(d.$$.fragment,e),g=!0)},o(e){he(d.$$.fragment,e),g=!1},d(n){n&&w(t),n&&w(o),n&&w(a),k(b,n),C&&C.d(),n&&w(c),n&&w(u),k(j,n),e[24](null),n&&w(p),ke(d,n),h=!1,r(v)}}}const Un="map-style";function Hn(e,t,n){let o,r,s;i(e,Ht,(e=>n(13,s=e)));const a=Z();let l,c,u,{kmlOptions:p}=t,{ofp:d}=t,{route:m}=t,f=-1,g=-1;const h=["???",...Sn];let v=0,y=0,b=!1,$=[];const x={};let{id:w="map"}=t;function k(){l&&l.remove()}const P=async()=>{if(d.isFake||void 0===l)return void n(22,$=[]);const e=Cn[f],t=new kn("lido-tiles");if(e.cacheAll){const o=await t.countTiles(e.cacheName);let r;if(r=e.matrix?e.matrix.map((([e,t])=>e*t)):[...Array(e.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),o>=r.reduce(((e,t)=>e+t),0))return t.close(),n(10,x[e.id]=!0,x),[]}let o,r=[];for(const e of d.tracks)r=r.concat(e.points);r=r.concat(d.route.points,d.wptCoordinatesAlternate()),o=Ae(r,c);const[s,a]=[[o[0],o[1]],[o[2],o[3]]],i=[];for(let n=0;n<=e.cacheZoom;n++){let o,r;const c=Math.pow(2,n);let u,p;e.cacheAll?(o={x:0,y:c-1},r={x:c-1,y:0}):(o={x:Ie(s[0],n),y:Oe(s[1],n)},r={x:Ie(a[0],n),y:Oe(a[1],n)}),e.matrix?[u,p]=e.matrix[n]:[u,p]=[c,c];for(let s=o.x;s<=r.x;s++)for(let a=r.y;a<=o.y;a++)if(s>=0&&a>=0&&s<u&&a<p){let o;e.tiles?(o=new URL(e.tiles[0].replace("{z}",n).replace("{x}",s).replace("{y}",a)),i.push(t.isNotCached(e.cacheName,o))):(o=new URL(`https://api.mapbox.com/v4/denizotjb.63g5ah66/${n}/${s}/${a}@2x.webp?sku=${l._requestManager._skuToken}&access_token=${hn}`),i.push(t.isNotCached(e.cacheName,o)),o=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${n}/${s}/${a}.vector.pbf?sku=${l._requestManager._skuToken}&access_token=${hn}`),i.push(t.isNotCached(e.cacheName,o)))}}Promise.all(i).then((e=>{n(22,$=e.filter((e=>null!==e))),t.close()}))};var C;return C=()=>{mapboxgl.accessToken=hn,[l,c]=vn(w,Cn[f],d,p,u,P)},B().$$.on_mount.push(C),e.$$set=e=>{"kmlOptions"in e&&n(0,p=e.kmlOptions),"ofp"in e&&n(1,d=e.ofp),"route"in e&&n(2,m=e.route),"id"in e&&n(3,w=e.id)},e.$$.update=()=>{4194304&e.$$.dirty[0]&&n(11,o=0===$.length),48&e.$$.dirty[0]&&n(12,r=()=>{if(y<=0)return"";if(y>=v)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(y/v),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[p,d,m,w,v,y,f,g,u,b,x,o,r,s,h,function(e){e.target.blur(),k(),n(5,y=0),n(9,b=!1),n(22,$=[]),n(4,v=0),[l,c]=vn(w,Cn[f],d,p,u,P)},function(e){e.target.blur(),xn(l,"aircraftType",h[e.target.value],d,p,h[e.target.value])},function(e,t){if(-1===f&&d&&!d.isFake){const e=d.route.points[0],t=d.route.points[d.route.points.length-1];t.latitude>30&&e.latitude>30?n(6,f=1):t.longitude<-80&&e.longitude<-80?n(6,f=3):n(6,f=2)}return-1===f&&n(6,f=0),-1===g&&d&&n(7,g=d.isFake?h.indexOf(d.isFake):h.indexOf(d.infos.aircraft)),-1===g&&n(7,g=0),{update(e){"/map"===e.route&&l&&l.resize()},destroy(){k()}}},function(e){if(!e.proj4||!d||d.isFake)return!0;const t=d.route.points[0],n=d.route.points[d.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},e=>{xn(l,e.detail.name,e.detail.value,d,p,h[g]),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-"))return;const n=ot(),o=_e(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),a("save")},e=>{"/map"===m&&l&&l.resize()},async e=>{let t;if(t)return!1;t=!0,n(4,v=$.length),n(9,b=!1);try{await function(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return t=!1,n(9,b=!0),!1}const o=Cn[f];n(5,y=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const s=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(s),e()),o>=5||r>n.length-1)return;const a=r++,i=n[a];o++;try{await fetch(i),t&&t()}catch{}o--,delete n[a]}),100)}))}($,(()=>n(5,y++,y))),y>=v&&(n(10,x[o.id]=!0,x),n(10,x),n(22,$=[]),n(4,v=0)),t=!1},$,function(){f=D(this),n(6,f)},function(e){X[e?"unshift":"push"]((()=>{u=e,n(8,u)}))},function(){g=D(this),n(7,g)},function(e){p=e,n(0,p)},function(t){K(e,t)}]}class Bn extends Ce{constructor(e){super(),Pe(this,e,Hn,Gn,a,{kmlOptions:0,ofp:1,route:2,id:3},[-1,-1])}}function Zn(e){let t,n;return{c(){t=P("li"),n=P("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#marker"></use></svg> \n      <span class="svelte-z5ep4u">CARTE</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/map"),q(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),q(t,"active","/map"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/map"===e[0])},d(e){e&&w(t)}}}function Kn(e){let t,n;return{c(){t=P("li"),n=P("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#cloud"></use></svg> \n      <span class="svelte-z5ep4u">GRAMET</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/gramet"),q(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),q(t,"active","/gramet"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/gramet"===e[0])},d(e){e&&w(t)}}}function Jn(e){let t,n;return{c(){t=P("li"),n=P("a"),n.innerHTML='<svg class="f svelte-z5ep4u"><use xlink:href="#export"></use></svg> \n      <span class="svelte-z5ep4u">EXPORT</span>',S(n,"class","nav-link svelte-z5ep4u"),S(n,"href","#/export"),q(n,"disabled",!e[1]),S(t,"class","nav-item svelte-z5ep4u"),q(t,"active","/export"===e[0])},m(e,o){x(e,t,o),$(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/export"===e[0])},d(e){e&&w(t)}}}function Xn(t){let n,o,r,s;return{c(){n=P("li"),o=P("a"),o.textContent="PARTAGER",S(o,"class","nav-link"),S(o,"href","."),S(n,"class","nav-item optional svelte-z5ep4u")},m(e,a){x(e,n,a),$(n,o),r||(s=_(o,"click",M(t[2])),r=!0)},p:e,d(e){e&&w(n),r=!1,s()}}}function Vn(e){let t,n,o,r,s,a,i,c,p,d,m,f,g,h,v=(e[1]||"/map"===e[0])&&Zn(e),y=(e[1]&&!e[1].isFakeOfp||"/gramet"===e[0])&&Kn(e),b=(e[1]&&!e[1].isFakeOfp||"/export"===e[0])&&Jn(e),k=e[1]&&navigator.share&&Xn(e);const L=e[4].default,j=l(L,e,e[3],null);return{c(){t=P("nav"),n=P("ul"),o=P("li"),r=P("a"),s=C("svg"),a=C("use"),i=F(),v&&v.c(),c=F(),y&&y.c(),p=F(),b&&b.c(),d=F(),m=P("li"),m.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-z5ep4u"><use xlink:href="#info"></use></svg> \n      <span class="svelte-z5ep4u">AIDE</span></a>',f=F(),k&&k.c(),g=F(),j&&j.c(),T(a,"xlink:href","#home"),S(s,"class","svelte-z5ep4u"),S(r,"class","nav-link"),S(r,"href","#/"),S(o,"class","nav-item svelte-z5ep4u"),q(o,"active","/"===e[0]),S(m,"class","nav-item svelte-z5ep4u"),q(m,"active","/help"===e[0]),S(n,"class","navbar-nav mr-auto svelte-z5ep4u"),S(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-z5ep4u")},m(e,l){x(e,t,l),$(t,n),$(n,o),$(o,r),$(r,s),$(s,a),$(n,i),v&&v.m(n,null),$(n,c),y&&y.m(n,null),$(n,p),b&&b.m(n,null),$(n,d),$(n,m),$(n,f),k&&k.m(n,null),$(t,g),j&&j.m(t,null),h=!0},p(e,[t]){1&t&&q(o,"active","/"===e[0]),e[1]||"/map"===e[0]?v?v.p(e,t):(v=Zn(e),v.c(),v.m(n,c)):v&&(v.d(1),v=null),e[1]&&!e[1].isFakeOfp||"/gramet"===e[0]?y?y.p(e,t):(y=Kn(e),y.c(),y.m(n,p)):y&&(y.d(1),y=null),e[1]&&!e[1].isFakeOfp||"/export"===e[0]?b?b.p(e,t):(b=Jn(e),b.c(),b.m(n,d)):b&&(b.d(1),b=null),1&t&&q(m,"active","/help"===e[0]),e[1]&&navigator.share?k?k.p(e,t):(k=Xn(e),k.c(),k.m(n,null)):k&&(k.d(1),k=null),j&&j.p&&8&t&&u(j,L,e,e[3],t,null,null)},i(e){h||(ge(j,e),h=!0)},o(e){he(j,e),h=!1},d(e){e&&w(t),v&&v.d(),y&&y.d(),b&&b.d(),k&&k.d(),j&&j.d(e)}}}function Yn(e,t,n){let{$$slots:o={},$$scope:r}=t,{route:s}=t,{promise:a}=t;return e.$$set=e=>{"route"in e&&n(0,s=e.route),"promise"in e&&n(1,a=e.promise),"$$scope"in e&&n(3,r=e.$$scope)},[s,a,async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1},r,o]}class Qn extends Ce{constructor(e){super(),Pe(this,e,Yn,Vn,a,{route:0,promise:1})}}function eo(n){let o,r,a;const i=n[3].default,c=l(i,n,n[2],null);return{c(){o=P("page"),c&&c.c(),S(o,"class","svelte-7uc4nn"),q(o,"fadein",!1===n[0]),q(o,"d-none",!0===n[0])},m(e,t){x(e,o,t),c&&c.m(o,null),a=!0},p(e,[t]){c&&c.p&&4&t&&u(c,i,e,e[2],t,null,null),1&t&&q(o,"fadein",!1===e[0]),1&t&&q(o,"d-none",!0===e[0])},i(i){a||(ge(c,i),r||ne((()=>{r=function(n,o,r){let a,i,l=o(n,r),c=!1,u=0;function p(){a&&U(n,a)}function d(){const{delay:o=0,duration:r=300,easing:s=t,tick:d=e,css:m}=l||ve;m&&(a=G(n,0,1,r,o,s,m,u++)),d(0,1);const f=g()+o,h=f+r;i&&i.abort(),c=!0,ne((()=>ue(n,!0,"start"))),i=b((e=>{if(c){if(e>=h)return d(1,0),ue(n,!0,"end"),p(),c=!1;if(e>=f){const t=s((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(U(n),s(l)?(l=l(),ce().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),a=!0)},o(e){he(c,e),a=!1},d(e){e&&w(o),c&&c.d(e)}}}function to(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:s}=t;return e.$$set=e=>{"hidden"in e&&n(0,s=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[s,(e,t,n)=>{if(void 0===s)return De(e,t)},r,o]}class no extends Ce{constructor(e){super(),Pe(this,e,to,eo,a,{hidden:0})}}function oo(t){let n,o,r,s,a,i,l,c,u,p,d,m,f,g,h,v,y,b,$,k,C,L,j,_,M,S,T,z,I,O,A,D,q,R,E,N,W,G,U,H,B;return{c(){n=P("h2"),n.textContent="Pr√©ambule",o=F(),r=P("p"),r.textContent="Cette app a √©t√© con√ßue pour le PilotPad. Elle n√©cessite des navigateurs r√©cents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi. Firefox derni√®re version devrait fonctionner (non test√©).\nL'OFP ne transite sur aucun serveur, seule une route calcul√©e (bas√©e sur au plus 21 stations m√©t√©o) est transmise √† l'h√©bergeur du proxy (voir plus bas) puis √† Ogimet.com pour r√©cup√©rer le Gramet. GitHub (d√©tenu par Microsoft), h√©bergeur du site, utilise des cookies. L'app en elle m√™me ne collecte aucune donn√©es.",s=F(),a=P("p"),a.textContent="OFP2MAP est une application PWA, elle peut √™tre lanc√©e soit depuis le navigateur, soit depuis l'√©cran d'accueil de l'iPad. Pour des raisons techniques la deuxi√®me solution est √† privil√©gier.",i=F(),l=P("h2"),l.textContent="Installation sur l'√©cran d'accueil",c=F(),u=P("p"),u.textContent="Il est recommand√© d'installer l'app sur l'√©cran d'accueil d√®s la premi√®re utilisation.",p=F(),d=P("p"),d.innerHTML='Pour cel√†, apr√®s avoir ouvert l&#39;app dans Safari, utilisez le menu ¬´‚ÄØpartage‚ÄØ¬ª <svg style="width: 1em; display: inline-block; height: 1em; vertical-align: bottom;"><use xlink:href="#share"></use></svg> de Safari (apr√®s avoir cliqu√©, faire d√©filer pour s√©lectionner l&#39;item nomm√© &quot;Sur l&#39;√©cran d&#39;accueil&quot;). Une fois l&#39;app ajout√©e,\nvous pouvez (devriez) revenir dans Safari et fermer l&#39;onglet.',m=F(),f=P("p"),f.textContent="Ceci permet:",g=F(),h=P("ul"),h.innerHTML="<li>un stockage longue dur√©e des pr√©f√©rences, des cartes Lambert et de l&#39;Atlas.</li> \n<li>de disposer d&#39;un cache plus important‚ÄØ: les cartes Lambert et L&#39;Atlas peuvent √™tre stock√©s en totalit√©. La Web Mercator dispose d&#39;un cache de niveau 6 (il y a 12 niveaux de zoom sur la Mercator).</li> \n<li>de mettre facilement en cache la carte. Pour cel√†, cliquez sur le symbole ‚Üì situ√© √† droite du s√©lecteur de carte. Les cartes Lambert sont mises en cache en totalit√©, il en est de m√™me pour l&#39;atlas The World, par contre pour la Mercator, seule la partie de carte incluant la route sera mise en cache. Les premi√®res mises en cache peuvent prendre du temps‚ÄØ: sur la Mercator, un vol LC peut n√©cessiter le t√©l√©chargement de 40Mo de donn√©es. Les caches des autres projections utilisent‚ÄØ: North 7.1 Mo, Pacific 3.7Mo, South 6.4Mo et The World 31.7Mo.</li> \n<li>d&#39;avoir un √©cran plus grand.</li>",v=F(),y=P("p"),y.textContent="Par contre, on ne peut recharger la page comme dans un navigateur‚ÄØ: il faudra pour cela aller dans le menu d'aide (cet √©cran) ou un bouton sp√©cifique sera affich√© en haut.\n√Ä noter que parfois, des bugs d'affichage peuvent appara√Ætre‚ÄØ:  lorsque l'on retourne sur l'app, l'app est zoom√©e, il faut alors juste d√©zoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  m√™me en mode d√©connect√©, pour la relancer.",b=F(),$=P("h2"),$.textContent="Utilisation",k=F(),C=P("ol"),C.innerHTML="<li><p>Dans Pilot Mission, onglet ¬´Dossier de vol¬ª, affichez le PDF nomm√© &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carr√© avec une fl√®che vers le haut. Choisissez ¬´Enregistrer dans Fichiers¬ª. Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite s√©lectionner. Le &quot;drag and drop&quot; est √©galement possible dans le champ d&#39;input de l&#39;OFP.</p></li> \n<li><p>Dans l&#39;application, il est possible, lorsque l&#39;on visualise la carte, d&#39;afficher le menu de personnalisation en cliquant sur  l&#39;ic√¥ne en haut √† droite (le &quot;hamburger&quot;). Dans les r√©solutions plus faibles, sur iPhone ou en mode &quot;split view&quot;, ces r√©glages sont affich√©s sous la carte. Le type avion pour l&#39;ad√©quation des terrains est d√©tect√© dans l&#39;OFP.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, t√©l√©charger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par d√©faut est une LAMBERT, il est possible sur la carte, en haut √† gauche, de basculer sur une projection Web Mercator ou sur l&#39;Atlas &quot;The World&quot;.</p> \n<ul><li>LAMBERT NORTH (parall√®les s√©cants N30 et N65) est recommand√©e au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parall√®les s√©cants N30 et S15 ) sont recommand√©es sous N30</li> \n<li>The World permet de disposer d&#39;un Atlas off-line</li> \n<li>Mercator correspond aux cartes Web habituelles, le th√®me est inspir√© des cartes VFR et on peut zoomer de mani√®re importante (12 niveaux). Le cache offline est limit√© √† un zoom de niveau 6.</li></ul></li> \n<li><p>Navigation dans la carte: on peut avec un doigt d√©placer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts.</p></li>",L=F(),j=P("h2"),j.textContent="Mode off-line",_=F(),M=P("p"),M.innerHTML="Une fois un premier OFP charg√©, il est possible m√™me en mode d√©connect√© de charger un autre OFP pour l&#39;exporter. Le cache de l&#39;App vous permettra de naviguer sur les cartes d√©j√† visualis√©es. La dur√©e de vie du cache est limit√©e √† 7 jours, voir <em>Installation sur l&#39;√©cran d&#39;accueil</em> pour un stockage permanent.",S=F(),T=P("h2"),T.textContent="Sauvegarde des param√®tres",z=F(),I=P("p"),I.textContent="L'app permet de sauvegarder vos param√®tres dans le navigateur. Toutefois Apple ne conserve plus les donn√©es au-del√†\nde 7 jours, vos r√©glages risquent donc de dispara√Ætre. La solution: Installer l'app sur l'√©cran d'accueil.",O=F(),A=P("p"),A.textContent="Si vous voulez utiliser l'app dans Safari, alors, il faudra, apr√®s avoir param√©tr√© l'app, m√©moriser vos choix dans la \"sidebar\" puis, sauvegarder l'url de la page dans vos favoris.\nL'URL contient l'ensemble des d√©tails n√©cessaires √† la restauration. Si vous utilisez cette m√©thode, pensez √† bien\nsauvegarder l'URL apr√®s vos modifications. Dans un premier temps, contentez-vous de sauvegarder avec le bouton ¬´M√©moriser¬ª,\ntestez sur diff√©rents OFP, puis une fois satisfait, sauvegardez dans vos favoris.",D=F(),q=P("h2"),q.textContent="Mise √† jour",R=F(),E=P("p"),E.textContent="L'app d√©tecte les mises √† jour automatiquement, normalement vous n'avez rien √† faire. Eventuellement un prompt peut \napparaitre vous demandant d'autoriser cette mise √† jour. La version AIRAC et le type avion d√©tect√© dans l'OFP sont affich√©s en bas √† droite de la carte dans le champ d'attribution.",N=F(),W=P("h2"),W.textContent="Cr√©dits",G=F(),U=P("ul"),U.innerHTML='<li>Les donn√©es terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est d√©velopp√© en javascript √† l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir r√©cup√©rer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',H=F(),B=P("p"),B.textContent="L'h√©bergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le r√©seau internet d'AF, les fonds de cartes sont √† pr√©sent h√©berg√©s sur netlify. Le proxy gramet est lui dor√©navant h√©berg√© sur vercel."},m(e,t){x(e,n,t),x(e,o,t),x(e,r,t),x(e,s,t),x(e,a,t),x(e,i,t),x(e,l,t),x(e,c,t),x(e,u,t),x(e,p,t),x(e,d,t),x(e,m,t),x(e,f,t),x(e,g,t),x(e,h,t),x(e,v,t),x(e,y,t),x(e,b,t),x(e,$,t),x(e,k,t),x(e,C,t),x(e,L,t),x(e,j,t),x(e,_,t),x(e,M,t),x(e,S,t),x(e,T,t),x(e,z,t),x(e,I,t),x(e,O,t),x(e,A,t),x(e,D,t),x(e,q,t),x(e,R,t),x(e,E,t),x(e,N,t),x(e,W,t),x(e,G,t),x(e,U,t),x(e,H,t),x(e,B,t)},p:e,i:e,o:e,d(e){e&&w(n),e&&w(o),e&&w(r),e&&w(s),e&&w(a),e&&w(i),e&&w(l),e&&w(c),e&&w(u),e&&w(p),e&&w(d),e&&w(m),e&&w(f),e&&w(g),e&&w(h),e&&w(v),e&&w(y),e&&w(b),e&&w($),e&&w(k),e&&w(C),e&&w(L),e&&w(j),e&&w(_),e&&w(M),e&&w(S),e&&w(T),e&&w(z),e&&w(I),e&&w(O),e&&w(A),e&&w(D),e&&w(q),e&&w(R),e&&w(E),e&&w(N),e&&w(W),e&&w(G),e&&w(U),e&&w(H),e&&w(B)}}}class ro extends Ce{constructor(e){super(),Pe(this,e,null,oo,a,{})}}function so(e){let t,n,o,r,s,a,i=e[1].msg+"",l=0!==e[1].code&&lo(e);return{c(){t=P("p"),n=L("Service Worker status: "),o=P("span"),r=L(i),a=F(),l&&l.c(),S(o,"data-status",s=e[1].code),S(o,"class","svelte-jp9cw7"),S(t,"class","svelte-jp9cw7")},m(e,s){x(e,t,s),$(t,n),$(t,o),$(o,r),$(t,a),l&&l.m(t,null)},p(e,n){2&n&&i!==(i=e[1].msg+"")&&z(r,i),2&n&&s!==(s=e[1].code)&&S(o,"data-status",s),0!==e[1].code?l?l.p(e,n):(l=lo(e),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},d(e){e&&w(t),l&&l.d()}}}function ao(e){let t,n,o,r,s,a,i,l,c=e[1].msg+"";return{c(){t=P("p"),n=L("Service Worker status: "),o=P("span"),r=L(c),a=P("a"),a.textContent="Installer",S(o,"data-status",s=e[1].code),S(o,"class","svelte-jp9cw7"),S(a,"href","."),S(t,"class","svelte-jp9cw7")},m(s,c){x(s,t,c),$(t,n),$(t,o),$(o,r),$(t,a),i||(l=_(a,"click",M(e[4])),i=!0)},p(e,t){2&t&&c!==(c=e[1].msg+"")&&z(r,c),2&t&&s!==(s=e[1].code)&&S(o,"data-status",s)},d(e){e&&w(t),i=!1,l()}}}function io(t){let n,o,r,s,a;return{c(){n=P("p"),o=L("La page n'est pas controll√©e par le service worker. "),r=P("a"),r.textContent="Recharger la page",S(r,"href","./index.html"),S(n,"class","svelte-jp9cw7")},m(e,i){x(e,n,i),$(n,o),$(n,r),s||(a=_(r,"click",t[5]),s=!0)},p:e,d(e){e&&w(n),s=!1,a()}}}function lo(e){let t;function n(e,t){return e[0]===vo?uo:co}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&w(t)}}}function co(e){let t;return{c(){t=L(e[0])},m(e,n){x(e,t,n)},p(e,n){1&n&&z(t,e[0])},d(e){e&&w(t)}}}function uo(e){let t;function n(e,t){return e[3]?mo:po}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&w(t)}}}function po(t){let n;return{c(){n=L("non connect√©")},m(e,t){x(e,n,t)},p:e,d(e){e&&w(n)}}}function mo(e){let t,n,o,r;return{c(){t=P("a"),n=L(e[0]),S(t,"href",".")},m(s,a){x(s,t,a),$(t,n),o||(r=_(t,"click",M(e[7])),o=!0)},p(e,t){1&t&&z(n,e[0])},d(e){e&&w(t),o=!1,r()}}}function fo(t){let n;return{c(){n=P("p"),n.textContent="Vos r√©glages seront conserv√©s mais l'OFP sera remis √† z√©ro.",S(n,"class","svelte-jp9cw7")},m(e,t){x(e,n,t)},p:e,d(e){e&&w(n)}}}function go(t){let n,o,r,s,a,i,l;return{c(){n=P("p"),o=P("a"),o.textContent="R√©initialiser l'App",r=L(" va en plus r√©initialiser le service Worker (il faut √™tre connect√©)."),s=F(),a=P("p"),a.textContent="Dans les 2 cas vos r√©glages sont conserv√©s mais l'OFP est remis √† z√©ro.",S(o,"class","btn btn-danger btn-sm"),S(o,"href","./index.html"),S(n,"class","svelte-jp9cw7"),S(a,"class","svelte-jp9cw7")},m(e,c){x(e,n,c),$(n,o),$(n,r),x(e,s,c),x(e,a,c),i||(l=_(o,"click",t[6]),i=!0)},p:e,d(e){e&&w(n),e&&w(s),e&&w(a),i=!1,l()}}}function ho(e){let t,n,o,r,s,a,i,l,c=navigator.serviceWorker&&function(e){let t;function n(e,t){return e[2]?2===e[1].code?ao:so:io}let o=n(e),r=o(e);return{c(){r.c(),t=j()},m(e,n){r.m(e,n),x(e,t,n)},p(e,s){o===(o=n(e))&&r?r.p(e,s):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&w(t)}}}(e),u=!0===navigator.standalone&&function(e){let t,n,o,r,s,a,i,l,c;function u(e,t){return e[3]?go:fo}let p=u(e),d=p(e);return{c(){t=P("p"),t.innerHTML="<b>En cas de probl√®me:</b>",n=F(),o=P("p"),r=P("a"),r.textContent="Recharger l'App",s=L(" c'est l'√©quivalent d'un rechargement de page."),a=F(),d.c(),i=j(),S(t,"class","svelte-jp9cw7"),S(r,"class","btn btn-primary btn-sm svelte-jp9cw7"),S(r,"href","./index.html"),S(o,"class","svelte-jp9cw7")},m(u,p){x(u,t,p),x(u,n,p),x(u,o,p),$(o,r),$(o,s),x(u,a,p),d.m(u,p),x(u,i,p),l||(c=_(r,"click",e[5]),l=!0)},p(e,t){p===(p=u(e))&&d?d.p(e,t):(d.d(1),d=p(e),d&&(d.c(),d.m(i.parentNode,i)))},d(e){e&&w(t),e&&w(n),e&&w(o),e&&w(a),d.d(e),e&&w(i),l=!1,c()}}}(e);return i=new ro({}),{c(){t=P("div"),n=P("p"),n.textContent="Application version: 1.3.8",o=F(),c&&c.c(),r=F(),u&&u.c(),s=F(),a=P("div"),xe(i.$$.fragment),S(n,"class","svelte-jp9cw7"),S(t,"class","info svelte-jp9cw7"),S(a,"class","markdown svelte-jp9cw7")},m(e,p){x(e,t,p),$(t,n),$(t,o),c&&c.m(t,null),$(t,r),u&&u.m(t,null),x(e,s,p),x(e,a,p),we(i,a,null),l=!0},p(e,[t]){navigator.serviceWorker&&c.p(e,t),!0===navigator.standalone&&u.p(e,t)},i(e){l||(ge(i.$$.fragment,e),l=!0)},o(e){he(i.$$.fragment,e),l=!1},d(e){e&&w(t),c&&c.d(),u&&u.d(),e&&w(s),e&&w(a),ke(i)}}}const vo="V√©rifier Mise √† jour";function yo(e,t,n){let o,r,s,a;i(e,Gt,(e=>n(11,s=e))),i(e,Ht,(e=>n(3,a=e)));let l=window.serviceWorker,c=!0;!l&&navigator.serviceWorker&&navigator.serviceWorker.ready.then((e=>(n(8,l=e),e))).catch((e=>n(9,c=!1)));let u=navigator.serviceWorker&&navigator.serviceWorker.controller,p=vo;const m=e=>e?e.installing?{code:1,msg:"üîπ installing"}:e.waiting?{code:2,msg:"üî∏ waiting"}:e.active?{code:3,msg:"üü¢"}:void 0:{code:0,msg:"üî∫ unknown"},f=()=>{window.location.reload()};return e.$$.update=()=>{256&e.$$.dirty&&n(1,o=m(l)),512&e.$$.dirty&&n(2,r=u&&c)},window.editolido&&window.editolido.version,[p,o,r,a,()=>{l.waiting&&(d(Gt,s=!0,s),l.waiting.postMessage("SKIP_WAITING"))},f,e=>{if(!window.confirm("Vous devez √™tre connect√© au r√©seau, ceci ne devrait √™tre utile qu'en cas de bug, R√©initialiser ?"))return e.preventDefault(),!1;l&&l.unregister(),f()},()=>{n(0,p="V√©rification... "),d(Gt,s=!1,s),l.update().then((e=>{3!==m(e).code?(n(0,p=""),n(8,l)):n(0,p="√Ä jour")})).catch((e=>n(0,p=e)))},l,c]}class bo extends Ce{constructor(e){super(),Pe(this,e,yo,ho,a,{})}}function $o(t){return{c:e,m:e,p:e,d:e}}function xo(e){let t,n=e[5]&&!e[1]&&wo(e);return{c(){n&&n.c(),t=j()},m(e,o){n&&n.m(e,o),x(e,t,o)},p(e,o){e[5]&&!e[1]?n?n.p(e,o):(n=wo(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&w(t)}}}function wo(e){let t,n,o,s,a,i,l,c,u,p,d;function m(e,t){return e[0]?ko:Po}let f=m(e),g=f(e);function h(){return e[4](e[5])}return{c(){t=P("div"),n=P("div"),o=P("strong"),o.innerHTML='<span class="svelte-5snzlz">üë®üèª‚Äç‚úàÔ∏è</span>Mise √† jour disponible',s=F(),a=P("button"),a.innerHTML='<span aria-hidden="true">√ó</span>',i=F(),l=P("div"),g.c(),c=F(),u=P("button"),u.textContent="Installer",S(o,"class","mr-auto svelte-5snzlz"),S(a,"type","button"),S(a,"class","ml-2 mb-1 close"),S(a,"aria-label","Close"),S(n,"class","toast-header"),S(u,"type","button"),S(u,"class","btn"),q(u,"btn-primary",!e[0]),q(u,"btn-danger",e[0]),S(l,"class","toast-body text-center"),S(t,"class","toast svelte-5snzlz"),O(t,"position","absolute"),O(t,"top","0"),O(t,"right","0")},m(r,m){x(r,t,m),$(t,n),$(n,o),$(n,s),$(n,a),$(t,i),$(t,l),g.m(l,null),$(l,c),$(l,u),p||(d=[_(a,"click",e[3]),_(u,"click",h)],p=!0)},p(t,n){f!==(f=m(e=t))&&(g.d(1),g=f(e),g&&(g.c(),g.m(l,c))),1&n&&q(u,"btn-primary",!e[0]),1&n&&q(u,"btn-danger",e[0])},d(e){e&&w(t),g.d(),p=!1,r(d)}}}function ko(e){let t;return{c(){t=P("p"),t.textContent="Il faudra recharger l'OFP"},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Po(e){let t;return{c(){t=P("p"),t.textContent="Cel√† va recharger l'App"},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Co(t){return{c:e,m:e,p:e,d:e}}function Lo(t){let n,o={ctx:t,current:null,token:null,hasCatch:!1,pending:Co,then:xo,catch:$o,value:5};return ye(window.isSWUpdateAvailable.promise,o),{c(){n=j(),o.block.c()},m(e,t){x(e,n,t),o.block.m(e,o.anchor=t),o.mount=()=>n.parentNode,o.anchor=n},p(e,[n]){{const r=(t=e).slice();r[5]=o.resolved,o.block.p(r,n)}},i:e,o:e,d(e){e&&w(n),o.block.d(e),o.token=null,o=null}}}function Fo(e,t,n){let o;i(e,Gt,(e=>n(1,o=e)));let{loaded:r=!1}=t;const s=e=>{e.waiting.postMessage("SKIP_WAITING")};return e.$$set=e=>{"loaded"in e&&n(0,r=e.loaded)},[r,o,s,()=>d(Gt,o=!0,o),e=>s(e)]}class jo extends Ce{constructor(e){super(),Pe(this,e,Fo,Lo,a,{loaded:0})}}const{window:_o}=be;function Mo(e){let t,n,o,r,s,a;function i(t){e[9](t)}let l={kmlOptions:e[2]};return void 0!==e[1]&&(l.promise=e[1]),n=new On({props:l}),X.push((()=>$e(n,"promise",i))),n.$on("change",e[5]),{c(){t=P("form"),xe(n.$$.fragment),S(t,"class","form-inline svelte-1pvavz"),q(t,"invisible","/help"===e[0])},m(o,i){x(o,t,i),we(n,t,null),r=!0,s||(a=_(t,"submit",M(e[8])),s=!0)},p(e,r){const s={};4&r&&(s.kmlOptions=e[2]),!o&&2&r&&(o=!0,s.promise=e[1],oe((()=>o=!1))),n.$set(s),1&r&&q(t,"invisible","/help"===e[0])},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){e&&w(t),ke(n),s=!1,a()}}}function So(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Oo,then:zo,catch:To,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=j(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){he(r.blocks[e])}o=!1},d(e){e&&w(t),r.block.d(e),r.token=null,r=null}}}function To(t){let n,o,r,s=t[16].message+"";return{c(){n=P("p"),o=L("üò±: "),r=L(s),q(n,"d-none","/map"!==t[0])},m(e,t){x(e,n,t),$(n,o),$(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&z(r,s),1&t&&q(n,"d-none","/map"!==e[0])},i:e,o:e,d(e){e&&w(n)}}}function zo(e){let t,n;return t=new no({props:{hidden:"/map"!==e[0],$$slots:{default:[Io]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131079&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Io(e){let t,n,o;function r(t){e[10](t)}let s={id:"map",ofp:e[15],route:e[0]};return void 0!==e[2]&&(s.kmlOptions=e[2]),t=new Bn({props:s}),X.push((()=>$e(t,"kmlOptions",r))),t.$on("save",e[4]),{c(){xe(t.$$.fragment)},m(e,n){we(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[15]),1&o&&(r.route=e[0]),!n&&4&o&&(n=!0,r.kmlOptions=e[2],oe((()=>n=!1))),t.$set(r)},i(e){o||(ge(t.$$.fragment,e),o=!0)},o(e){he(t.$$.fragment,e),o=!1},d(e){ke(t,e)}}}function Oo(e){let t,n;return t=new no({props:{hidden:"/map"!==e[0],$$slots:{default:[Ao]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};1&n&&(o.hidden="/map"!==e[0]),131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Ao(e){let t;return{c(){t=P("div"),t.textContent="traitement en cours...",O(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Do(e){let t,n;return t=new no({props:{$$slots:{default:[Eo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function qo(e){let t,n;return t=new no({props:{$$slots:{default:[No]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Ro(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Ko,then:Go,catch:Wo,value:15,error:16,blocks:[,,,]};return ye(n=e[1],r),{c(){t=j(),r.block.c()},m(e,n){x(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&ye(n,r));else{const t=e.slice();t[15]=t[16]=r.resolved,r.block.p(t,o)}},i(e){o||(ge(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){he(r.blocks[e])}o=!1},d(e){e&&w(t),r.block.d(e),r.token=null,r=null}}}function Eo(e){let t,n;return t=new bo({}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function No(e){let t,n;return t=new jt({}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Wo(t){let n,o,r,s=t[16].message+"";return{c(){n=P("p"),o=L("üò±: "),r=L(s)},m(e,t){x(e,n,t),$(n,o),$(n,r)},p(e,t){2&t&&s!==(s=e[16].message+"")&&z(r,s)},i:e,o:e,d(e){e&&w(n)}}}function Go(e){let t,n,o,r;const s=[Ho,Uo],a=[];function i(e,t){return"/gramet"===e[0]?0:"/export"===e[0]?1:-1}return~(t=i(e))&&(n=a[t]=s[t](e)),{c(){n&&n.c(),o=j()},m(e,n){~t&&a[t].m(e,n),x(e,o,n),r=!0},p(e,r){let l=t;t=i(e),t===l?~t&&a[t].p(e,r):(n&&(me(),he(a[l],1,1,(()=>{a[l]=null})),fe()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=s[t](e),n.c()),ge(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||(ge(n),r=!0)},o(e){he(n),r=!1},d(e){~t&&a[t].d(e),e&&w(o)}}}function Uo(e){let t,n;return t=new no({props:{$$slots:{default:[Bo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Ho(e){let t,n;return t=new no({props:{$$slots:{default:[Zo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};131074&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Bo(e){let t,n,o,r;return t=new $t({props:{ofp:e[15]}}),t.$on("save",e[4]),o=new He({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment),n=F(),xe(o.$$.fragment)},m(e,s){we(t,e,s),x(e,n,s),we(o,e,s),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[15]),t.$set(r);const s={};2&n&&(s.ofp=e[15]),o.$set(s)},i(e){r||(ge(t.$$.fragment,e),ge(o.$$.fragment,e),r=!0)},o(e){he(t.$$.fragment,e),he(o.$$.fragment,e),r=!1},d(e){ke(t,e),e&&w(n),ke(o,e)}}}function Zo(e){let t,n;return t=new Lt({props:{ofp:e[15]}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[15]),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Ko(e){let t,n;return t=new no({props:{$$slots:{default:[Jo]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,o){we(t,e,o),n=!0},p(e,n){const o={};131072&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){ke(t,e)}}}function Jo(e){let t;return{c(){t=P("div"),t.textContent="traitement en cours...",O(t,"margin","auto")},m(e,n){x(e,t,n)},d(e){e&&w(t)}}}function Xo(e){let t,n,o,s,a,i,l,c,u,p,d,m,f;o=new Qn({props:{promise:e[1],route:e[0],$$slots:{default:[Mo]},$$scope:{ctx:e}}}),a=new jo({props:{loaded:!!e[1]}});let g=e[1]&&So(e);const h=[Ro,qo,Do],v=[];function y(e,t){return"/gramet"===e[0]||"/export"===e[0]?0:"/"===e[0]?1:"/help"===e[0]?2:-1}return~(c=y(e))&&(u=v[c]=h[c](e)),{c(){t=P("main"),n=P("div"),xe(o.$$.fragment),s=F(),xe(a.$$.fragment),i=F(),g&&g.c(),l=F(),u&&u.c(),S(n,"class","content svelte-1pvavz"),S(t,"class",p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz")},m(r,u){x(r,t,u),$(t,n),we(o,n,null),$(n,s),we(a,n,null),$(n,i),g&&g.m(n,null),$(n,l),~c&&v[c].m(n,null),d=!0,m||(f=[_(_o,"hashchange",e[3]),_(_o,"online",e[6]),_(_o,"offline",e[7])],m=!0)},p(e,[r]){const s={};2&r&&(s.promise=e[1]),1&r&&(s.route=e[0]),131079&r&&(s.$$scope={dirty:r,ctx:e}),o.$set(s);const i={};2&r&&(i.loaded=!!e[1]),a.$set(i),e[1]?g?(g.p(e,r),2&r&&ge(g,1)):(g=So(e),g.c(),ge(g,1),g.m(n,l)):g&&(me(),he(g,1,1,(()=>{g=null})),fe());let m=c;c=y(e),c===m?~c&&v[c].p(e,r):(u&&(me(),he(v[m],1,1,(()=>{v[m]=null})),fe()),~c?(u=v[c],u?u.p(e,r):(u=v[c]=h[c](e),u.c()),ge(u,1),u.m(n,null)):u=null),(!d||1&r&&p!==(p="container "+(e[0].substr(1)||"home")+" svelte-1pvavz"))&&S(t,"class",p)},i(e){d||(ge(o.$$.fragment,e),ge(a.$$.fragment,e),ge(g),ge(u),d=!0)},o(e){he(o.$$.fragment,e),he(a.$$.fragment,e),he(g),he(u),d=!1},d(e){e&&w(t),ke(o),ke(a),g&&g.d(),~c&&v[c].d(),m=!1,r(f)}}}function Vo(e,t,n){let o,r,s;i(e,Ut,(e=>n(12,o=e))),i(e,Gt,(e=>n(13,r=e))),i(e,Ht,(e=>n(14,s=e)));let a,l="/",c=window.location.href;(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in tt){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(Ze)?t=o.toUpperCase():e.endsWith("Display")&&(t=!!o),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||at.setItem(st.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&at.setItem(st.shortcut,o));at.setItem(st.optionsKML,n)})(window.location.search);let u=(e=>{const t={};for(let[n,o]of Object.entries(e))n in tt&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(Ze)?t[n]=o.toUpperCase():n.endsWith("Display")&&(t[n]=!!o));return{...tt,...t}})(at.getItem(st.optionsKML)||{});const p=e=>{const t=document.querySelector("meta[name=viewport]"),r=t?t.getAttribute("content"):"";n(0,l=window.location.hash.substr(1)||"/"),a||"/map"!==l&&"/gramet"!==l&&"/export"!==l||n(0,l="/"),"/map"===l?(o&&d(Ut,o=!1,o),r&&t.setAttribute("content",r+",maximum-scale=1")):r&&t.setAttribute("content",r.replace(",maximum-scale=1",""))};p();const m=e=>{const t=(e=>{const t={};for(const[n,o]of Object.entries(st)){let r=at.getItem(o);if(n===st.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==tt[t])))t[n]=e[n];r=t}if(null!==r)if(n===st.optionsKML)for(const[e,n]of Object.entries(r))t[e]=n;else t[n]=r}return t})(u);let n=Object.entries(t).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&");c=window.location.origin+window.location.pathname+(n?"?"+n:"")+"#"+l,history.replaceState(t,"Mon OFP2MAP",c)};m();return[l,a,u,p,m,()=>{o&&d(Ut,o=!1,o),r&&d(Gt,r=!1,r),window.serviceWorker&&window.serviceWorker.update&&window.serviceWorker.update().catch((e=>{}))},()=>{d(Ht,s=!0,s)},()=>{d(Ht,s=!1,s)},function(t){K(e,t)},function(e){a=e,n(1,a)},function(e){u=e,n(2,u)}]}return new class extends Ce{constructor(e){super(),Pe(this,e,Vo,Xo,a,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
