var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function i(e){e.forEach(o)}function a(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function c(e,t,n,o){if(e){const r=u(e,t,n,o);return e[0](r)}}function u(e,t,o,r){return e[1]&&r?n(o.ctx.slice(),e[1](r(t))):o.ctx}function p(e,t,n,o,r,i,a){const s=function(e,t,n,o){if(e[2]&&o){const r=e[2](o(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let o=0;o<n;o+=1)e[o]=t.dirty[o]|r[o];return e}return t.dirty|r}return t.dirty}(t,o,r,i);if(s){const r=u(t,n,o,a);e.p(r,s)}}function d(e,t){const n={};t=new Set(t);for(const o in e)t.has(o)||"$"===o[0]||(n[o]=e[o]);return n}function m(e,t,n=t){return e.set(n),t}function f(t){return t&&a(t.destroy)?t.destroy:e}const g="undefined"!=typeof window;let h=g?()=>window.performance.now():()=>Date.now(),v=g?e=>requestAnimationFrame(e):e;const y=new Set;function b(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&v(b)}function $(e){let t;return 0===y.size&&v(b),{promise:new Promise((n=>{y.add(t={c:e,f:n})})),abort(){y.delete(t)}}}function x(e,t){e.appendChild(t)}function w(e,t,n){e.insertBefore(t,n||null)}function k(e){e.parentNode.removeChild(e)}function P(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function L(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function F(e){return document.createTextNode(e)}function M(){return F(" ")}function E(){return F("")}function O(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function S(e){return function(t){return t.preventDefault(),e.call(this,t)}}function j(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const o in t)null==t[o]?e.removeAttribute(o):"style"===o?e.style.cssText=t[o]:"__value"===o?e.value=e[o]=t[o]:n[o]&&n[o].set?e[o]=t[o]:j(e,o,t[o])}function A(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function I(e){return""===e?null:+e}function D(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function z(e,t){e.value=null==t?"":t}function R(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function W(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function N(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function q(e,t,n){e.classList[n?"add":"remove"](t)}function G(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const U=new Set;let H,B=0;function Z(e,t,n,o,r,i,a,s=0){const l=16.666/o;let c="{\n";for(let e=0;e<=1;e+=l){const o=t+(n-t)*i(e);c+=100*e+`%{${a(o,1-o)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${s}`,d=e.ownerDocument;U.add(d);const m=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(C("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[p]||(f[p]=!0,m.insertRule(`@keyframes ${p} ${u}`,m.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${p} ${o}ms linear ${r}ms 1 both`,B+=1,p}function K(e,t){const n=(e.style.animation||"").split(", "),o=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-o.length;r&&(e.style.animation=o.join(", "),B-=r,B||v((()=>{B||(U.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),U.clear())})))}function X(e){H=e}function J(){if(!H)throw new Error("Function called outside component initialization");return H}function V(e){J().$$.on_mount.push(e)}function Y(){const e=J();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=G(t,n);o.slice().forEach((t=>{t.call(e,r)}))}}}function Q(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const ee=[],te=[],ne=[],oe=[],re=Promise.resolve();let ie=!1;function ae(){ie||(ie=!0,re.then(pe))}function se(e){ne.push(e)}function le(e){oe.push(e)}let ce=!1;const ue=new Set;function pe(){if(!ce){ce=!0;do{for(let e=0;e<ee.length;e+=1){const t=ee[e];X(t),de(t.$$)}for(X(null),ee.length=0;te.length;)te.pop()();for(let e=0;e<ne.length;e+=1){const t=ne[e];ue.has(t)||(ue.add(t),t())}ne.length=0}while(ee.length);for(;oe.length;)oe.pop()();ie=!1,ce=!1,ue.clear()}}function de(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(se)}}let me;function fe(){return me||(me=Promise.resolve(),me.then((()=>{me=null}))),me}function ge(e,t,n){e.dispatchEvent(G(`${t?"intro":"outro"}${n}`))}const he=new Set;let ve;function ye(){ve={r:0,c:[],p:ve}}function be(){ve.r||i(ve.c),ve=ve.p}function $e(e,t){e&&e.i&&(he.delete(e),e.i(t))}function xe(e,t,n,o){if(e&&e.o){if(he.has(e))return;he.add(e),ve.c.push((()=>{he.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}const we={duration:0};function ke(n,o,r,s){let l=o(n,r),c=s?0:1,u=null,p=null,d=null;function m(){d&&K(n,d)}function f(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function g(o){const{delay:r=0,duration:a=300,easing:s=t,tick:g=e,css:v}=l||we,y={start:h()+r,b:o};o||(y.group=ve,ve.r+=1),u||p?p=y:(v&&(m(),d=Z(n,c,o,a,r,s,v)),o&&g(0,1),u=f(y,a),se((()=>ge(n,o,"start"))),$((e=>{if(p&&e>p.start&&(u=f(p,a),p=null,ge(n,u.b,"start"),v&&(m(),d=Z(n,c,u.b,u.duration,0,s,l.css))),u)if(e>=u.end)g(c=u.b,1-c),ge(n,u.b,"end"),p||(u.b?m():--u.group.r||i(u.group.c)),u=null;else if(e>=u.start){const t=e-u.start;c=u.a+u.d*s(t/u.duration),g(c,1-c)}return!(!u&&!p)})))}return{run(e){a(l)?fe().then((()=>{l=l(),g(e)})):g(e)},end(){m(),u=p=null}}}function Pe(e,t){const n=t.token={};function o(e,o,r,i){if(t.token!==n)return;t.resolved=i;let a=t.ctx;void 0!==r&&(a=a.slice(),a[r]=i);const s=e&&(t.current=e)(a);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(ye(),xe(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),be())})):t.block.d(1),s.c(),$e(s,1),s.m(t.mount(),t.anchor),l=!0),t.block=s,t.blocks&&(t.blocks[o]=s),l&&pe()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=J();if(e.then((e=>{X(n),o(t.then,1,t.value,e),X(null)}),(e=>{if(X(n),o(t.catch,2,t.error,e),X(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}function Ce(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}function Le(e){e&&e.c()}function _e(e,t,n){const{fragment:r,on_mount:s,on_destroy:l,after_update:c}=e.$$;r&&r.m(t,n),se((()=>{const t=s.map(o).filter(a);l?l.push(...t):i(t),e.$$.on_mount=[]})),c.forEach(se)}function Fe(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Me(t,n,o,a,s,l,c=[-1]){const u=H;X(t);const p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:s,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:r(),dirty:c,skip_bound:!1};let d=!1;if(p.ctx=o?o(t,n.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&s(p.ctx[e],p.ctx[e]=r)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](r),d&&function(e,t){-1===e.$$.dirty[0]&&(ee.push(e),ae(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],p.update(),d=!0,i(p.before_update),p.fragment=!!a&&a(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(k)}else p.fragment&&p.fragment.c();n.intro&&$e(t.$$.fragment),_e(t,n.target,n.anchor),pe()}X(u)}class Ee{$destroy(){Fe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}class Oe{constructor(){this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}const Se="iPad"===navigator.platform||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,je=/CriOS/i.test(navigator.userAgent)&&/iphone|ipod|ipad/i.test(navigator.userAgent),Te=/Safari\//i.test(navigator.userAgent)&&!/(Chrome\/|Chromium\/)/i.test(navigator.userAgent),Ae=matchMedia("(hover: hover)").matches;function Ie(e,t,n){let o;return function(){const r=this,i=arguments,a=function(){o=null,n||e.apply(r,i)},s=n&&!o;clearTimeout(o),o=setTimeout(a,t),s&&e.apply(r,i)}}function De(e){const t=e.split("-").slice(0,-1).join("");switch(t){case"route":return"rmain";case"alternate":return"ralt";case"nat":return"rnat";default:return t}}function ze(e){switch(e){case"rmain":return"route";case"ralt":return"alternate";case"rnat":return"nat";default:return e}}function Re(e,t,n){return e<=t?t:e>=n?n:e}function We(e,t,n){return!(e<t)&&!(e>n)}function Ne(e,t,n,o){return 8&n?[e[0]+(t[0]-e[0])*(o[3]-e[1])/(t[1]-e[1]),o[3]]:4&n?[e[0]+(t[0]-e[0])*(o[1]-e[1])/(t[1]-e[1]),o[1]]:2&n?[o[2],e[1]+(t[1]-e[1])*(o[2]-e[0])/(t[0]-e[0])]:1&n?[o[0],e[1]+(t[1]-e[1])*(o[0]-e[0])/(t[0]-e[0])]:null}function qe(e,t){var n=0;return e[0]<t[0]?n|=1:e[0]>t[2]&&(n|=2),e[1]<t[1]?n|=4:e[1]>t[3]&&(n|=8),n}function Ge(e,t){let n=new Promise(((t,n)=>{let o=setTimeout((()=>{clearTimeout(o),n("Timed out in "+e+"ms.")}),e)}));return Promise.race([t,n])}const Ue=async()=>{const e={title:"OFP2MAP",url:window.location.pathname};try{await navigator.share(e)}catch(e){}return!1};function He(e){const t=e-1;return t*t*t+1}function Be(e,{delay:n=0,duration:o=400,easing:r=t}={}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:r,css:e=>"opacity: "+e*i}}function Ze(e,{delay:t=0,duration:n=400,easing:o=He,x:r=0,y:i=0,opacity:a=0}={}){const s=getComputedStyle(e),l=+s.opacity,c="none"===s.transform?"":s.transform,u=l*(1-a);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*r}px, ${(1-e)*i}px);\n\t\t\topacity: ${l-u*t}`}}function Ke(e){let t;return{c(){t=C("textarea"),t.value=e[0],j(t,"class","svelte-12a0ij3")},m(n,o){w(n,t,o),e[6](t)},p(e,n){1&n&&(t.value=e[0])},d(n){n&&k(t),e[6](null)}}}function Xe(t){let n,o,r;return{c(){n=C("a"),n.textContent="copier la route",j(n,"role","button"),j(n,"class","btn btn-primary svelte-12a0ij3"),j(n,"href","lhs-mpilot://")},m(e,i){w(e,n,i),o||(r=O(n,"click",t[4]),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function Je(t){let n,o,r,i,a;return{c(){n=C("a"),n.innerHTML="ouvrir mPilot <sup>*</sup>",o=M(),r=C("p"),r.innerHTML='<small class="text-muted"><sup>*</sup> Une fois dans l&#39;application mPilot,\n             il vous suffira de faire un coller (la route aura été copiée automatiquement).</small>',j(n,"role","button"),j(n,"class","btn btn-primary svelte-12a0ij3"),j(n,"href","lhs-mpilot://"),j(r,"class","card-text")},m(e,s){w(e,n,s),w(e,o,s),w(e,r,s),i||(a=O(n,"click",t[4]),i=!0)},p:e,d(e){e&&k(n),e&&k(o),e&&k(r),i=!1,a()}}}function Ve(n){let o,r,s;return{c(){o=C("span"),o.textContent="copié!",j(o,"class","svelte-12a0ij3")},m(e,t){w(e,o,t),s=!0},i(e){s||(r&&r.end(1),s=!0)},o(n){r=function(n,o,r){let s,l=o(n,r),c=!0;const u=ve;function p(){const{delay:o=0,duration:r=300,easing:a=t,tick:p=e,css:d}=l||we;d&&(s=Z(n,1,0,r,o,a,d));const m=h()+o,f=m+r;se((()=>ge(n,!1,"start"))),$((e=>{if(c){if(e>=f)return p(0,1),ge(n,!1,"end"),--u.r||i(u.c),!1;if(e>=m){const t=a((e-m)/r);p(1-t,t)}}return c}))}return u.r+=1,a(l)?fe().then((()=>{l=l(),p()})):p(),{end(e){e&&l.tick&&l.tick(1,0),c&&(s&&K(n,s),c=!1)}}}(o,Be,{}),s=!1},d(e){e&&k(o),e&&r&&r.end()}}}function Ye(e){let t,n,o,r,i,a,s,l,c,u,p,d,m=null!=e[0]&&Ke(e);let f=(Se?Je:Xe)(e),g=e[2]&&Ve();return{c(){m&&m.c(),t=M(),n=C("div"),o=C("div"),r=C("h5"),r.textContent="Route Lido",i=M(),a=C("p"),a.textContent="Cette route est optimisée par rapport à celle de PilotMission car elle utilise les airways. Utiliser cette route permet\nd'avoir une application Lido plus réactive.",s=M(),f.c(),l=M(),c=C("div"),u=F(e[3]),p=M(),g&&g.c(),j(r,"class","card-title"),j(a,"class","card-text"),j(c,"class","text-monospace svelte-12a0ij3"),j(o,"class","card-body"),j(n,"class","card mb-3 svelte-12a0ij3")},m(e,h){m&&m.m(e,h),w(e,t,h),w(e,n,h),x(n,o),x(o,r),x(o,i),x(o,a),x(o,s),f.m(o,null),x(o,l),x(o,c),x(c,u),x(c,p),g&&g.m(c,null),d=!0},p(e,[n]){null!=e[0]?m?m.p(e,n):(m=Ke(e),m.c(),m.m(t.parentNode,t)):m&&(m.d(1),m=null),f.p(e,n),e[2]?g?4&n&&$e(g,1):(g=Ve(),g.c(),$e(g,1),g.m(c,null)):g&&(ye(),xe(g,1,1,(()=>{g=null})),be())},i(e){d||($e(g),d=!0)},o(e){xe(g),d=!1},d(e){m&&m.d(e),e&&k(t),e&&k(n),f.d(),g&&g.d()}}}let Qe=!1;if(navigator.permissions)try{navigator.permissions.query({name:"clipboard-write"}).then((e=>{"granted"!=e.state&&"prompt"!=e.state||(Qe=!0)}))}catch(e){}function et(e,t,n){let o,{ofp:r}=t,i=null;const a=r?r.lidoRoute().join(" "):"";let s=!1;return e.$$set=e=>{"ofp"in e&&n(5,r=e.ofp)},[i,o,s,a,e=>{e.target.classList.remove("hasactive");const t=async function(e){let t=!0;if(Qe)navigator.clipboard.writeText(e).then((()=>t=!0),(()=>t=!1));else{n(0,i=e),await(ae(),re),o.focus(),o.select();try{t=document.execCommand("copy")}catch(e){t=!1}n(0,i=null)}return t}(a);Se||(n(2,s=t),setTimeout((function(){n(2,s=!1)}),3e3),e.preventDefault())},r,function(e){te[e?"unshift":"push"]((()=>{o=e,n(1,o)}))}]}class tt extends Ee{constructor(e){super(),Me(this,e,et,Ye,s,{ofp:5})}}const nt={routeDisplay:!0,routePin:0,routeColor:"FFDA25A8",alternateDisplay:!0,alternatePin:0,alternateColor:"FFFF00FF",natDisplay:!0,natPin:8,natPinPosition:0,natColor:"80DA25A8",natIncompleteColor:"FF0000FF",greatCircleDisplay:!0,greatCircleColor:"5F1478FF",ogimetDisplay:!0,ogimetColor:"40FF0000",airportDisplay:!0,airportPin:0,firDisplay:!0,etopsDisplay:!0,etopsColor:"FF0324FC",iconTextChange:"1.0",lineWidthChange:"1.0",iconSizeChange:"1.0"};function ot(e,t){e.addFolders({name:"greatcircle",enabled:t.greatCircleDisplay,color:t.greatCircleColor},{name:"ogimet",enabled:t.ogimetDisplay,color:t.ogimetColor},{name:"ralt",enabled:t.alternateDisplay,color:t.alternateColor,pinId:t.alternatePin},{name:"rmain",color:t.routeColor,pinId:t.routePin},{name:"rnat",enabled:t.natDisplay,color:t.natColor,pinId:t.natPin},{name:"rnat_incomplete",enabled:t.natDisplay,color:t.natIncompleteColor,pinId:t.natPin})}const rt=()=>(window.kmlGen||(window.kmlGen=new editolido.KMLGenerator,ot(window.kmlGen,nt)),window.kmlGen);function it(e,t){let n={...nt,...t};const o=rt();ot(o,n);const r=e.description;if(o.setName(r),e.isFake)return;const i=`${e.infos.departure}-${e.infos.destination}`,a=new editolido.Route(e.wptCoordinates(),{name:i,description:r}),s=new editolido.Route(e.wptCoordinatesAlternate(),{name:"Route Dégagement"}),l=new editolido.Route([a.points[0],a.points[a.points.length-1]]).split(300,{name:`Ortho ${i}`});let c=[];for(let t of e.tracks){let e=t.isComplete?"rnat":"rnat_incomplete";o.addLine(e,t);let n=new editolido.GeoPoint(t.points[0],{name:t.name,description:t.description});o.addPoint(e,n),t.isMine&&(c.push(n),n=new editolido.GeoPoint(t.points[t.points.length-1],{name:t.name,description:t.description}),c.push(n),o.addPoint(e,n))}o.addLine("greatcircle",l),o.addLine("rmain",a),o.addPoints("rmain",a,{excluded:c}),o.addLine("ralt",s),o.addLine("ogimet",e.ogimetData.route),o.addPoints("ralt",s)}function at(e,t,n){const o=e.slice();return o[14]=t[n],o[16]=n,o}function st(e){let t,n,o,r=e[14].label+"";return{c(){t=C("option"),n=F(r),t.__value=e[16],t.value=t.__value,t.selected=o=e[16]===e[1]},m(e,o){w(e,t,o),x(t,n)},p(e,n){2&n&&o!==(o=e[16]===e[1])&&(t.selected=o)},d(e){e&&k(t)}}}function lt(t){let n,o,r,s,l,c,u,p,d,m,g,h,v,y,b,$,_,F,E=gt,S=[];for(let e=0;e<E.length;e+=1)S[e]=st(at(t,E,e));return{c(){n=C("kmlcolor"),o=C("pin"),r=L("svg"),s=L("use"),l=M(),c=C("select");for(let e=0;e<S.length;e+=1)S[e].c();u=M(),p=C("picker"),d=C("label"),m=C("input"),v=M(),y=C("input"),A(s,"xlink:href","#marker-symbol"),R(s,"stroke",0===t[1]?"#fff":"#000"),R(s,"fill",gt[t[1]].color),j(o,"class","form-control svelte-15ps55h"),j(c,"name",t[4]),j(c,"class","custom-select"),void 0===t[1]&&se((()=>t[8].call(c))),j(m,"type","color"),j(d,"style",g=ft(t[2])),j(y,"type","range"),j(y,"min","30"),j(y,"max","255"),j(p,"class","form-control"),j(p,"style",b=mt(t[2][0])),j(n,"class","input-group")},m(e,i){w(e,n,i),x(n,o),x(o,r),x(r,s),x(n,l),x(n,c);for(let e=0;e<S.length;e+=1)S[e].m(c,null);W(c,t[1]),x(n,u),x(n,p),x(p,d),x(d,m),z(m,t[2][0]),x(p,v),x(p,y),z(y,t[2][1]),_||(F=[O(c,"change",t[8]),O(c,"change",t[9]),O(m,"input",t[10]),f(h=t[5].call(null,d,t[2])),O(y,"change",t[11]),O(y,"input",t[11]),f($=t[6].call(null,n,t[0]))],_=!0)},p(e,[t]){if(2&t&&R(s,"stroke",0===e[1]?"#fff":"#000"),2&t&&R(s,"fill",gt[e[1]].color),2&t){let n;for(E=gt,n=0;n<E.length;n+=1){const o=at(e,E,n);S[n]?S[n].p(o,t):(S[n]=st(o),S[n].c(),S[n].m(c,null))}for(;n<S.length;n+=1)S[n].d(1);S.length=E.length}2&t&&W(c,e[1]),4&t&&z(m,e[2][0]),4&t&&g!==(g=ft(e[2]))&&j(d,"style",g),h&&a(h.update)&&4&t&&h.update.call(null,e[2]),4&t&&z(y,e[2][1]),4&t&&b!==(b=mt(e[2][0]))&&j(p,"style",b),$&&a($.update)&&1&t&&$.update.call(null,e[0])},i:e,o:e,d(e){e&&k(n),P(S,e),_=!1,i(F)}}}const ct=/^[A-F0-9]{8}$/i,ut=e=>{let[t,n]=dt(e);return[t,n/255]},pt=["#FF0000",255],dt=e=>{try{const t=parseInt(e.slice(0,2),16);return["#"+e.slice(6,8)+e.slice(4,6)+e.slice(2,4),t]}catch(e){return pt}},mt=e=>{const[t,n,o]=[e.slice(1,3),e.slice(3,5),e.slice(5,7)].map((e=>parseInt(e,16)));return`--range-red: ${t}; --range-green: ${n}; --range-blue: ${o};`},ft=e=>`background-color: ${e[0]}; opacity: ${e[1]/255}`,gt=[{label:"Aucun repère",color:"#FFFFFF"},{label:"Bleu",color:"#6699FF"},{label:"Jaune",color:"#FFFF00"},{label:"Marron* (Rouge pour Avenza)",color:"#CC9966"},{label:"Orange",color:"#FF9922"},{label:"Rose* (Rouge pour Avenza)",color:"#DD5599"},{label:"Rouge",color:"#FF0000"},{label:"Vert",color:"#22DD44"},{label:"Violet",color:"#BB11EE"}];function ht(e,t,n){const o=Y();let{kmlColor:r="FF0000FF"}=t,{selected:i=0}=t,{name:a}=t;const s=a+"-color",l=a+"-pin";let c=pt;const u=Ie(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"selected"in e&&n(1,i=e.selected),"name"in e&&n(7,a=e.name)},[r,i,c,o,l,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),u("change",{name:s,value:r})}}},function(e){return n(2,c=dt(r)),{update(e){n(2,c=dt(e)),u("change",{name:s,value:e.toUpperCase()})}}},a,function(){i=N(this),n(1,i)},e=>{e.target.blur(),o("change",{name:l,value:i})},function(){c[0]=this.value,n(2,c)},function(){c[1]=I(this.value),n(2,c)}]}class vt extends Ee{constructor(e){super(),Me(this,e,ht,lt,s,{kmlColor:0,selected:1,name:7})}}const yt=Object.freeze({optionsKML:"optionsKML",shortcut:"shortcut",downloadType:"downloadType"}),bt=new class{constructor(){}getItem(e){const t=localStorage.getItem(e);if(null!==t)try{return JSON.parse(t)}catch(t){this.removeItem(e)}return null}setItem(e,t){const n=JSON.stringify(t);"{}"!==n&&localStorage.setItem(e,n)}removeItem(e){localStorage.removeItem(e)}},$t=(e,t,n="Mon OFP2MAP")=>{const o={};for(const[t,n]of Object.entries(yt)){let r=bt.getItem(n);if(t===yt.optionsKML&&e){const t={};for(const n of Object.keys(e).filter((t=>e[t]!==nt[t])))t[n]=e[n];r=t}if(null!==r)if(t===yt.optionsKML)for(const[e,t]of Object.entries(r))o[e]=t;else o[t]=r}const r=Object.entries(o).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),i=window.location.origin+window.location.pathname+(r?"?"+r:"")+"#"+t;window.history.replaceState(o,n,i)};function xt(t){let n,o,r,a,s,l,c,u,p,d;return{c(){n=C("div"),o=C("div"),o.innerHTML='<span class="input-group-text svelte-1ecyaux"></span>',r=M(),a=C("input"),s=M(),l=C("div"),c=C("a"),u=F("Lancer"),j(o,"class","input-group-prepend"),j(a,"class","form-control svelte-1ecyaux"),j(a,"placeholder","Nom du raccourci"),j(a,"type","text"),j(c,"class","btn btn-outline-secondary svelte-1ecyaux"),j(c,"href",t[1]),q(c,"disabled",!(t[0].trim()&&Se)),j(l,"class","input-group-append"),j(n,"class","input-group")},m(e,i){w(e,n,i),x(n,o),x(n,r),x(n,a),z(a,t[0]),x(n,s),x(n,l),x(l,c),x(c,u),p||(d=[O(a,"input",t[5]),O(a,"change",t[3]),O(c,"click",t[2])],p=!0)},p(e,[t]){1&t&&a.value!==e[0]&&z(a,e[0]),2&t&&j(c,"href",e[1]),1&t&&q(c,"disabled",!(e[0].trim()&&Se))},i:e,o:e,d(e){e&&k(n),p=!1,i(d)}}}const wt="OFP2MAP";function kt(e,t,n){const o=Y(),r=yt.shortcut;let i,a=bt.getItem(r)||wt,{ofp:s}=t;const l=s?s.lidoRoute().join(" "):"";return e.$$set=e=>{"ofp"in e&&n(4,s=e.ofp)},[a,i,function(e){const t=a.trim();if(t&&Se){const e=rt(),o={lidoRoute:l,kml:e.render(),kmlAvenza:e.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS}),grametProxyURL:s.ogimetData.proxyImg};n(1,i="shortcuts://run-shortcut?name="+encodeURIComponent(t)+"&input=text&text="+encodeURIComponent(JSON.stringify(o)))}else e.preventDefault()},function(){const e=a.trim();e===wt?bt.removeItem(r):bt.setItem(r,e),o("save",[r,e])},s,function(){a=this.value,n(0,a)}]}class Pt extends Ee{constructor(e){super(),Me(this,e,kt,xt,s,{ofp:4})}}function Ct(t){let n,o,r,a,s,l,c,u,p,d,m,f,g,h,v,y=Ft[0]+"",b=Ft[1]+"";return{c(){n=C("div"),o=C("select"),r=C("option"),a=F(y),l=C("option"),c=F(b),p=M(),d=C("div"),m=C("a"),f=F(t[0]),r.selected=s=0===t[1],r.__value=0,r.value=r.__value,l.selected=u=1===t[1],l.__value=1,l.value=l.__value,j(o,"class","custom-select svelte-19hokx5"),j(o,"aria-label","Example select with button addon"),void 0===t[1]&&se((()=>t[6].call(o))),j(m,"class","btn btn-success"),j(m,"download",g=navigator.standalone?null:t[3]),j(m,"href",t[2]),j(m,"target",Lt),j(d,"class","input-group-append"),j(n,"class","input-group")},m(e,i){w(e,n,i),x(n,o),x(o,r),x(r,a),x(o,l),x(l,c),W(o,t[1]),x(n,p),x(n,d),x(d,m),x(m,f),h||(v=[O(o,"change",t[6]),O(o,"change",t[5]),O(m,"click",t[4])],h=!0)},p(e,[t]){2&t&&s!==(s=0===e[1])&&(r.selected=s),2&t&&u!==(u=1===e[1])&&(l.selected=u),2&t&&W(o,e[1]),1&t&&D(f,e[0]),8&t&&g!==(g=navigator.standalone?null:e[3])&&j(m,"download",g),4&t&&j(m,"href",e[2])},i:e,o:e,d(e){e&&k(n),h=!1,i(v)}}}const Lt=navigator.standalone||navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)?"_blank":null,_t=function(e,t="application/vnd.google-earth.kml+xml"){return"data:"+t+";base64,"+btoa(unescape(encodeURIComponent(e)))},Ft=["KML Mapsme","KML Avenza"];function Mt(e,t,n){const o=Y();let{label:r}=t;const i=yt.downloadType;let a=bt.getItem(i)||1;"string"==typeof a&&(a=parseInt(a,10)),(a<0||a>=Ft.length)&&(a=0);let s="",l="";return e.$$set=e=>{"label"in e&&n(0,r=e.label)},[r,a,s,l,function(e){const t=rt(),o=["_mapsme.kml","_avenza.kml",".geojson"][a];let r=t.name;if(r?(r=r.trim(),n(3,l=r.replace(/[ \/]/g,"_").replace(/:/g,"")+o)):n(3,l="editolido"+o),0===a)n(2,s=_t(t.render()));else{if(1!==a)return e.preventDefault(),!1;n(2,s=_t(t.render({template:editolido.avenzaTemplate,styleTemplate:editolido.avenzaStyleTemplate,iconTemplate:editolido.avenzaIconTemplate,icons:editolido.AVENZAICONS})))}},function(){1===a?bt.removeItem(i):bt.setItem(i,a),o("save",[i,a])},function(){a=N(this),n(1,a)}]}class Et extends Ee{constructor(e){super(),Me(this,e,Mt,Ct,s,{label:0})}}function Ot(e){let t,n,o,r,i,a,s,l,c,u,p,d,m,f,g;return s=new Et({props:{label:"Télécharger"}}),s.$on("save",e[1]),d=new Pt({props:{ofp:e[0]}}),d.$on("save",e[2]),{c(){t=C("div"),n=C("div"),o=C("h5"),o.textContent="Export",r=M(),i=C("div"),a=C("div"),Le(s.$$.fragment),l=M(),c=C("small"),c.textContent="Le fichier est généré en fonction des options choisies sur la carte.",u=M(),p=C("div"),Le(d.$$.fragment),m=M(),f=C("small"),f.innerHTML='Sur iOS on peut lancer un raccourci.\n                <a href="https://www.icloud.com/shortcuts/2585d34bc76941febff60b8d064517ee" target="_blank">Exemple de raccourci à installer</a>',j(o,"class","card-title"),j(c,"class","text-muted"),j(a,"class","col-12 col-sm-6 col-md-6"),j(f,"class","text-muted"),j(p,"class","col-12 col-sm-6 col-md-6"),j(i,"class","row"),j(n,"class","card-body"),j(t,"class","card mb-3 svelte-17snbjk")},m(e,h){w(e,t,h),x(t,n),x(n,o),x(n,r),x(n,i),x(i,a),_e(s,a,null),x(a,l),x(a,c),x(i,u),x(i,p),_e(d,p,null),x(p,m),x(p,f),g=!0},p(e,[t]){const n={};1&t&&(n.ofp=e[0]),d.$set(n)},i(e){g||($e(s.$$.fragment,e),$e(d.$$.fragment,e),g=!0)},o(e){xe(s.$$.fragment,e),xe(d.$$.fragment,e),g=!1},d(e){e&&k(t),Fe(s),Fe(d)}}}function St(e,t,n){let{ofp:o}=t;return e.$$set=e=>{"ofp"in e&&n(0,o=e.ofp)},[o,function(t){Q(e,t)},function(t){Q(e,t)}]}class jt extends Ee{constructor(e){super(),Me(this,e,St,Ot,s,{ofp:0})}}function Tt(e){let t;return{c(){t=C("div"),t.innerHTML='<span class="sr-only">Loading...</span>',j(t,"class","spinner-border text-warning"),j(t,"role","status")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function At(e){let t,n,o,r,i,a,s,l,c,u,p;return{c(){t=C("div"),n=C("p"),o=F("😱: Erreur de récupération du Gramet, "),r=C("a"),r.textContent="essayez à nouveau",i=F(" ou allez sur "),a=C("a"),s=F("ogimet"),c=F("."),j(r,"href","."),j(a,"href",l=e[0].ogimetData.url),j(a,"target","_blank"),j(n,"class","svelte-i1m2fr"),j(t,"class","error svelte-i1m2fr")},m(l,d){w(l,t,d),x(t,n),x(n,o),x(n,r),x(n,i),x(n,a),x(a,s),x(n,c),u||(p=O(r,"click",S(e[4])),u=!0)},p(e,t){1&t&&l!==(l=e[0].ogimetData.url)&&j(a,"href",l)},d(e){e&&k(t),u=!1,p()}}}function It(e){let t,n,o,r;return{c(){t=C("img"),j(t,"crossorigin","anonymous"),t.src!==(n=e[0].ogimetData.proxyImg)&&j(t,"src",n),j(t,"alt","gramet demo"),j(t,"class","img-fluid svelte-i1m2fr")},m(n,i){w(n,t,i),o||(r=[O(t,"error",e[2]),O(t,"load",e[3])],o=!0)},p(e,o){1&o&&t.src!==(n=e[0].ogimetData.proxyImg)&&j(t,"src",n)},d(e){e&&k(t),o=!1,i(r)}}}function Dt(t){let n,o,r,i,a,s,l,c,u,p,d,m,f,g,h,v,y,b,$,P,L,_="loading"===t[1]&&Tt();function E(e,t){return"error"!==e[1]?It:At}let O=E(t),S=O(t);return{c(){n=C("div"),o=C("h1"),o.innerHTML='Le GRAMET est un météogramme représentant le temps et l&#39;espace. Il indique, en tout point de la route,\n    et à l&#39;heure de passage estimée, une coupe verticale de la météo prévue.\n    <a class="text-warning" href="http://www.ogimet.com/guia_gramet.phtml.en" target="_blank">Guide d&#39;interprétation</a>',r=M(),i=C("div"),_&&_.c(),a=M(),S.c(),s=M(),l=C("div"),c=C("div"),u=C("div"),p=C("div"),d=C("div"),d.textContent="Route Ogimet",m=M(),f=C("div"),g=C("p"),h=F("Le GRAMET est réalisé par "),v=C("a"),y=F("www.ogimet.com"),$=F(" à partir\n    d'une route calculée. Il est possible d'afficher la route sur la carte. Celà est\n    particulièrement utile lors des vols océaniques car il n'y a aucune station en mer."),P=M(),L=C("div"),L.innerHTML='<div class="card ogimet2 svelte-i1m2fr"><div class="card-header svelte-i1m2fr">Algorithme de calcul</div> \n            <div class="card-body"><p class="card-text">Après avoir sélectionner les stations météo proches de la route (13000 dans le monde), \n                une minimisation du &quot;cross track error&quot; est effectué pour réduire le nombre de points. 21 points est la\n                limite maximale pour Ogimet.</p></div></div>',j(o,"class","svelte-i1m2fr"),j(i,"class","text-center svelte-i1m2fr"),j(d,"class","card-header svelte-i1m2fr"),j(v,"class","text-warning"),j(v,"href",b=t[0].ogimetData.url),j(v,"target","_blank"),j(g,"class","card-text"),j(f,"class","card-body"),j(p,"class","card ogimet svelte-i1m2fr"),j(u,"class"," col-12 col-sm-6 col-md-6 col-xl-6"),j(L,"class","col-12 col-sm-6 col-md-6 col-xl-6"),j(c,"class","card-deck"),j(l,"class","row")},m(e,t){w(e,n,t),x(n,o),x(n,r),x(n,i),_&&_.m(i,null),x(i,a),S.m(i,null),x(n,s),x(n,l),x(l,c),x(c,u),x(u,p),x(p,d),x(p,m),x(p,f),x(f,g),x(g,h),x(g,v),x(v,y),x(g,$),x(c,P),x(c,L)},p(e,[t]){"loading"===e[1]?_||(_=Tt(),_.c(),_.m(i,a)):_&&(_.d(1),_=null),O===(O=E(e))&&S?S.p(e,t):(S.d(1),S=O(e),S&&(S.c(),S.m(i,null))),1&t&&b!==(b=e[0].ogimetData.url)&&j(v,"href",b)},i:e,o:e,d(e){e&&k(n),_&&_.d(),S.d()}}}function zt(e,t,n){let o="loading",{ofp:r}=t;return e.$$set=e=>{"ofp"in e&&n(0,r=e.ofp)},[r,o,()=>n(1,o="error"),()=>n(1,o="success"),()=>n(1,o="loading")]}class Rt extends Ee{constructor(e){super(),Me(this,e,zt,Dt,s,{ofp:0})}}function Wt(t){let n;return{c(){n=F(" ")},m(e,t){w(e,n,t)},p:e,d(e){e&&k(n)}}}function Nt(t){let n,o,r;return{c(){n=C("button"),n.textContent="Partager l'App",j(n,"class","btn btn-link")},m(e,t){w(e,n,t),o||(r=O(n,"click",Ue),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}function qt(t){let n,o,r,i,a;let s=(!0===navigator.standalone&&navigator.share?Nt:Wt)(t);return{c(){n=C("h1"),o=F("Cartographie pour l'OFP \n    "),r=C("img"),a=M(),s.c(),r.src!==(i="svg/Air_France_Logo.svg")&&j(r,"src","svg/Air_France_Logo.svg"),j(r,"alt","logo Air France"),j(r,"class","svelte-drdjg7"),j(n,"class","svelte-drdjg7")},m(e,t){w(e,n,t),x(n,o),x(n,r),x(n,a),s.m(n,null)},p(e,[t]){s.p(e,t)},i:e,o:e,d(e){e&&k(n),s.d()}}}class Gt extends Ee{constructor(e){super(),Me(this,e,null,qt,s,{})}}function Ut(t){let n,o,r,i;return n=new Gt({}),{c(){Le(n.$$.fragment),o=M(),r=C("div"),r.innerHTML='<div class="card-deck"><div class=" col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card avenza svelte-z58ee3"><div class="card-header svelte-z58ee3">COMPATIBLE OFFLINE</div> \n      <div class="card-body"><p class="card-text">L&#39;OFP ne quitte pas votre iPad ou votre ordinateur. Fonctionne avec les dernières technologies: PWA, Service Worker, fully responsive, cartes WebGL...</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card mapsme svelte-z58ee3"><div class="card-header svelte-z58ee3">Multiples Projections</div> \n      <div class="card-body"><p class="card-text">Des cartes LAMBERT conformes, un ATLAS, et une MERCATOR avec 12 niveaux de zoom. Export en format KML vers Mapsme ou Avenza</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card ogimet svelte-z58ee3"><div class="card-header svelte-z58ee3">Compatible avec Ogimet</div> \n      <div class="card-body"><p class="card-text">Calcule une route pour ogimet et affiche le GRAMET qui est un météogramme combinant l&#39;espace et le temps</p></div></div></div> \n    <div class="col-12 col-sm-6 col-md-6 col-xl-3 svelte-z58ee3"><div class="card shortcuts svelte-z58ee3"><div class="card-header svelte-z58ee3">Compatible Raccourcis</div> \n      <div class="card-body"><p class="card-text">Avec l&#39;app Raccourcis, automatisez en récupérant le KML, le Gramet, ou une route Lido optimisée</p></div></div></div></div>',j(r,"class","row svelte-z58ee3")},m(e,t){_e(n,e,t),w(e,o,t),w(e,r,t),i=!0},p:e,i(e){i||($e(n.$$.fragment,e),i=!0)},o(e){xe(n.$$.fragment,e),i=!1},d(e){Fe(n,e),e&&k(o),e&&k(r)}}}class Ht extends Ee{constructor(e){super(),Me(this,e,null,Ut,s,{})}}function Bt(t){let n,o,r,s,l,c,u,p,d,m,g,h,v,y,b,$,P;return{c(){n=C("kmlcolor"),o=C("div"),r=C("label"),s=C("input"),l=F(t[2]),c=M(),u=C("picker"),p=C("label"),d=C("input"),h=M(),v=C("input"),j(s,"name",t[4]),s.checked=t[1],j(s,"type","checkbox"),j(r,"for",t[4]),j(r,"class","input-group-text"),j(o,"class","input-group-prepend"),j(d,"type","color"),j(p,"style",m=ft(t[3])),j(v,"type","range"),j(v,"min","30"),j(v,"max","255"),j(u,"class","form-control"),j(u,"style",y=mt(t[3][0])),j(n,"class","input-group checkbox-combo")},m(e,i){w(e,n,i),x(n,o),x(o,r),x(r,s),x(r,l),x(n,c),x(n,u),x(u,p),x(p,d),z(d,t[3][0]),x(u,h),x(u,v),z(v,t[3][1]),$||(P=[O(s,"change",t[8]),O(d,"input",t[9]),f(g=t[5].call(null,p,t[3])),O(v,"change",t[10]),O(v,"input",t[10]),f(b=t[6].call(null,n,t[0]))],$=!0)},p(e,[t]){2&t&&(s.checked=e[1]),4&t&&D(l,e[2]),8&t&&z(d,e[3][0]),8&t&&m!==(m=ft(e[3]))&&j(p,"style",m),g&&a(g.update)&&8&t&&g.update.call(null,e[3]),8&t&&z(v,e[3][1]),8&t&&y!==(y=mt(e[3][0]))&&j(u,"style",y),b&&a(b.update)&&1&t&&b.update.call(null,e[0])},i:e,o:e,d(e){e&&k(n),$=!1,i(P)}}}function Zt(e,t,n){const o=Y();let{kmlColor:r="FF0000FF"}=t,{checked:i}=t,{name:a}=t,{label:s="Couleur"}=t;const l=a+"-color",c=a+"-display";let u=pt;const p=Ie(o,500);return e.$$set=e=>{"kmlColor"in e&&n(0,r=e.kmlColor),"checked"in e&&n(1,i=e.checked),"name"in e&&n(7,a=e.name),"label"in e&&n(2,s=e.label)},[r,i,s,u,c,function(e){return{update(e){const[t,o]=e;n(0,r=(o.toString(16)+t.slice(5,7)+t.slice(3,5)+t.slice(1,3)).toUpperCase()),p("change",{name:l,value:r})}}},function(e){return n(3,u=dt(r)),{update(e){n(3,u=dt(e)),p("change",{name:l,value:e.toUpperCase()})}}},a,function(t){Q(e,t)},function(){u[0]=this.value,n(3,u)},function(){u[1]=I(this.value),n(3,u)}]}class Kt extends Ee{constructor(e){super(),Me(this,e,Zt,Bt,s,{kmlColor:0,checked:1,name:7,label:2})}}function Xt(e,t,n){const o=e.slice();return o[9]=t[n],o[11]=n,o}function Jt(e){let t,n,o,r=e[9].label+"";return{c(){t=C("option"),n=F(r),t.__value=e[11],t.value=t.__value,t.selected=o=e[11]===e[0]},m(e,o){w(e,t,o),x(t,n)},p(e,n){1&n&&o!==(o=e[11]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function Vt(t){let n,o,r,a,s,l,c,u,p,d=Yt,m=[];for(let e=0;e<d.length;e+=1)m[e]=Jt(Xt(t,d,e));return{c(){n=C("div"),o=C("div"),r=C("label"),a=C("input"),s=F("Airports"),l=M(),c=C("select");for(let e=0;e<m.length;e+=1)m[e].c();j(a,"name",t[3]),a.checked=t[1],j(a,"type","checkbox"),j(r,"for",t[3]),j(r,"class","input-group-text"),j(o,"class","input-group-prepend"),j(c,"name",t[4]),j(c,"class","custom-select svelte-aqi3t3"),void 0===t[0]&&se((()=>t[7].call(c))),j(n,"class","input-group checkbox-combo")},m(e,i){w(e,n,i),x(n,o),x(o,r),x(r,a),x(r,s),x(n,l),x(n,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);W(c,t[0]),u||(p=[O(a,"change",t[6]),O(c,"change",t[7]),O(c,"change",t[8])],u=!0)},p(e,[t]){if(2&t&&(a.checked=e[1]),1&t){let n;for(d=Yt,n=0;n<d.length;n+=1){const o=Xt(e,d,n);m[n]?m[n].p(o,t):(m[n]=Jt(o),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}1&t&&W(c,e[0])},i:e,o:e,d(e){e&&k(n),P(m,e),u=!1,i(p)}}}const Yt=[{label:"statuts"},{label:"vert/rouge"}];function Qt(e,t,n){const o=Y();let{selected:r=0}=t,{name:i="airport"}=t,{checked:a}=t;const s=i+"-display",l=i+"-pin";return e.$$set=e=>{"selected"in e&&n(0,r=e.selected),"name"in e&&n(5,i=e.name),"checked"in e&&n(1,a=e.checked)},[r,a,o,s,l,i,function(t){Q(e,t)},function(){r=N(this),n(0,r)},e=>{e.target.blur(),o("change",{name:l,value:r})}]}class en extends Ee{constructor(e){super(),Me(this,e,Qt,Vt,s,{selected:0,name:5,checked:1})}}function tn(t){let n,o,r,a,s,l,c,u,p,d,m,f,g;return{c(){n=C("div"),o=C("div"),r=C("label"),a=F(t[2]),s=M(),l=C("button"),l.textContent="-",c=M(),u=C("div"),p=F(t[0]),d=M(),m=C("button"),m.textContent="+",j(r,"for",t[1]),j(r,"class","input-group-text svelte-si7r19"),j(o,"class","input-group-prepend"),j(l,"class","form-control svelte-si7r19"),j(l,"type","button"),j(u,"class"," form-control svelte-si7r19"),j(m,"class","form-control svelte-si7r19"),j(m,"type","button"),j(n,"class","input-group input-group-sm svelte-si7r19")},m(e,i){w(e,n,i),x(n,o),x(o,r),x(r,a),x(n,s),x(n,l),x(n,c),x(n,u),x(u,p),x(n,d),x(n,m),f||(g=[O(l,"click",t[4]),O(m,"click",t[3])],f=!0)},p(e,[t]){4&t&&D(a,e[2]),2&t&&j(r,"for",e[1]),1&t&&D(p,e[0])},i:e,o:e,d(e){e&&k(n),f=!1,i(g)}}}function nn(e,t,n){const o=Y();let{name:r}=t,{label:i}=t,{value:a}=t,{min:s=.9}=t,{max:l=1.4}=t,{step:c=.1}=t;return e.$$set=e=>{"name"in e&&n(1,r=e.name),"label"in e&&n(2,i=e.label),"value"in e&&n(0,a=e.value),"min"in e&&n(5,s=e.min),"max"in e&&n(6,l=e.max),"step"in e&&n(7,c=e.step)},[a,r,i,()=>{const e=a;n(0,a=Math.min(Math.max(parseFloat(a)+c,s),l).toFixed(1)),a!==e&&o("change",{name:r,value:a})},()=>{const e=a;n(0,a=Math.min(Math.max(parseFloat(a)-c,s),l).toFixed(1)),a!==e&&o("change",{name:r,value:a})},s,l,c]}class on extends Ee{constructor(e){super(),Me(this,e,nn,tn,s,{name:1,label:2,value:0,min:5,max:6,step:7})}}const rn=[];function an(e,t){return{subscribe:sn(e,t).subscribe}}function sn(t,n=e){let o;const r=[];function i(e){if(s(t,e)&&(t=e,o)){const e=!rn.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),rn.push(n,t)}if(e){for(let e=0;e<rn.length;e+=2)rn[e][0](rn[e+1]);rn.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(a,s=e){const l=[a,s];return r.push(l),1===r.length&&(o=n(i)||e),a(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const ln=sn(),cn=sn(!1),un=sn(!1),pn=sn(),dn=sn(!1);let mn=new Date;const fn=()=>{if("serviceWorker"in navigator){const e=18e5;new Date-mn>e&&navigator.serviceWorker.getRegistration().then((e=>{e&&(e.waiting||e.update(),cn.set(!1),mn=new Date)}),console.error)}},gn=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&fn()},hn=an({},(e=>{const t=()=>{e(navigator.onLine)};return"undefined"!=typeof navigator&&"onLine"in navigator?(t(),window.addEventListener("offline",t),window.addEventListener("online",t)):e(void 0),()=>{"undefined"!=typeof navigator&&"onLine"in navigator&&(window.removeEventListener("offline",t),window.removeEventListener("online",t))}})),vn=an("/",(e=>{const t=()=>{const t=document.querySelector("meta[name=viewport]"),n=t?t.getAttribute("content"):"";let o=window.location.hash.substr(1)||"/";"/map"===o?(un.set(!1),n&&t.setAttribute("content",n+",maximum-scale=1")):n&&t.setAttribute("content",n.replace(",maximum-scale=1","")),e(o),fn()};return t(),window.addEventListener("hashchange",t),()=>{window.removeEventListener("hashchange",t)}}));function yn(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function bn(e){let t,n,o,r,a,s,l,c,u,p,d,m,g,h,v,y,b,$,P,L,_,E,T,A,I,D,z,R,W,N,G,U,H,B,Z,K,X,J,V,Y,Q,ee,te,ne,oe,re,ie,ae,le,ce,ue,pe,de,me,fe,ge,he,ve,ye,be,we,Pe,Ce,Me,Ee,Oe,Se;return d=new vt({props:{name:"route",kmlColor:e[0].routeColor,selected:e[0].routePin}}),d.$on("change",e[4]),P=new vt({props:{name:"alternate",kmlColor:e[0].alternateColor,selected:e[0].alternatePin}}),P.$on("change",e[4]),z=new vt({props:{name:"nat",kmlColor:e[0].natColor,selected:e[0].natPin}}),z.$on("change",e[4]),U=new Kt({props:{name:"great-circle",label:"Orthodromie",kmlColor:e[0].greatCircleColor,checked:e[0].greatCircleDisplay}}),U.$on("change",e[4]),Z=new Kt({props:{name:"ogimet",label:"Route GRAMET",kmlColor:e[0].ogimetColor,checked:e[0].ogimetDisplay}}),Z.$on("change",e[4]),J=new Kt({props:{name:"etops",label:"ETOPS",kmlColor:e[0].etopsColor,checked:e[0].etopsDisplay}}),J.$on("change",e[4]),Q=new en({props:{name:"airport",selected:e[0].airportPin,checked:e[0].airportDisplay}}),Q.$on("change",e[4]),ce=new on({props:{name:"icon-text-change",label:"Label",value:e[0].iconTextChange}}),ce.$on("change",e[4]),pe=new on({props:{name:"line-width-change",label:"Ligne",value:e[0].lineWidthChange,min:.6,max:2,step:.2}}),pe.$on("change",e[4]),me=new on({props:{name:"icon-size-change",label:"Icône",value:e[0].iconSizeChange,min:.6,max:2,step:.1}}),me.$on("change",e[4]),{c(){t=C("div"),n=C("a"),n.innerHTML='<svg class="svelte-9piftv"><use xlink:href="#close-symbol"></use></svg>',o=M(),r=C("form"),a=C("div"),s=C("button"),s.textContent="Revenir aux valeurs par défaut",l=M(),c=C("fieldset"),u=C("legend"),u.textContent="Route",p=M(),Le(d.$$.fragment),m=M(),g=C("fieldset"),h=C("legend"),v=C("input"),b=F("Dégagement"),$=M(),Le(P.$$.fragment),L=M(),_=C("fieldset"),E=C("legend"),T=C("input"),I=F("Tracks"),D=M(),Le(z.$$.fragment),R=M(),W=C("small"),W.textContent="Positionné à l'entrée des tracks, un track incomplet restera rouge.",N=M(),G=C("fieldset"),Le(U.$$.fragment),H=M(),B=C("fieldset"),Le(Z.$$.fragment),K=M(),X=C("fieldset"),Le(J.$$.fragment),V=M(),Y=C("fieldset"),Le(Q.$$.fragment),ee=M(),te=C("fieldset"),ne=C("legend"),oe=C("input"),ie=F("FIR SÛRETÉ"),ae=M(),le=C("fieldset"),Le(ce.$$.fragment),ue=M(),Le(pe.$$.fragment),de=M(),Le(me.$$.fragment),fe=M(),ge=C("div"),he=C("button"),ve=F("Mémoriser"),be=M(),we=C("button"),Pe=F("Restaurer"),j(n,"class","closeB svelte-9piftv"),j(n,"role","button"),j(n,"href","."),j(s,"class","btn btn-light btn-sm svelte-9piftv"),j(s,"type","button"),q(s,"invisible",e[1]),j(a,"class","reset svelte-9piftv"),j(c,"class","form-group svelte-9piftv"),j(v,"name","alternate-display"),v.checked=y=e[0].alternateDisplay,j(v,"type","checkbox"),j(g,"class","form-group svelte-9piftv"),j(T,"name","nat-display"),T.checked=A=e[0].natDisplay,j(T,"type","checkbox"),j(W,"class","form-text text-muted svelte-9piftv"),j(_,"class","form-group svelte-9piftv"),j(G,"class","form-group svelte-9piftv"),j(B,"class","form-group svelte-9piftv"),j(X,"class","form-group svelte-9piftv"),j(Y,"class","form-group svelte-9piftv"),j(oe,"name","fir-display"),oe.checked=re=e[0].firDisplay,j(oe,"type","checkbox"),j(te,"class","form-group svelte-9piftv"),j(le,"class","form-group svelte-9piftv"),he.disabled=ye=!e[2],j(he,"class","btn btn-primary btn-sm mb-2 svelte-9piftv"),j(he,"type","button"),we.disabled=Ce=!e[2],j(we,"class","btn btn-secondary btn-sm mb-2 svelte-9piftv"),j(we,"type","button"),j(ge,"class","last svelte-9piftv"),j(r,"class","svelte-9piftv"),j(t,"class","settings svelte-9piftv"),q(t,"sidebar",e[3])},m(i,y){w(i,t,y),x(t,n),x(t,o),x(t,r),x(r,a),x(a,s),x(r,l),x(r,c),x(c,u),x(c,p),_e(d,c,null),x(r,m),x(r,g),x(g,h),x(h,v),x(h,b),x(g,$),_e(P,g,null),x(r,L),x(r,_),x(_,E),x(E,T),x(E,I),x(_,D),_e(z,_,null),x(_,R),x(_,W),x(r,N),x(r,G),_e(U,G,null),x(r,H),x(r,B),_e(Z,B,null),x(r,K),x(r,X),_e(J,X,null),x(r,V),x(r,Y),_e(Q,Y,null),x(r,ee),x(r,te),x(te,ne),x(ne,oe),x(ne,ie),x(r,ae),x(r,le),_e(ce,le,null),x(le,ue),_e(pe,le,null),x(le,de),_e(me,le,null),x(r,fe),x(r,ge),x(ge,he),x(he,ve),x(ge,be),x(ge,we),x(we,Pe),Ee=!0,Oe||(Se=[O(n,"click",S(e[10])),O(s,"click",e[5]),O(v,"change",e[4]),O(T,"change",e[4]),O(oe,"change",e[4]),O(he,"click",e[7]),O(we,"click",e[6]),O(r,"submit",S(e[9])),f(yn.call(null,t)),O(t,"click_outside",e[11])],Oe=!0)},p(e,n){2&n&&q(s,"invisible",e[1]);const o={};1&n&&(o.kmlColor=e[0].routeColor),1&n&&(o.selected=e[0].routePin),d.$set(o),(!Ee||1&n&&y!==(y=e[0].alternateDisplay))&&(v.checked=y);const r={};1&n&&(r.kmlColor=e[0].alternateColor),1&n&&(r.selected=e[0].alternatePin),P.$set(r),(!Ee||1&n&&A!==(A=e[0].natDisplay))&&(T.checked=A);const i={};1&n&&(i.kmlColor=e[0].natColor),1&n&&(i.selected=e[0].natPin),z.$set(i);const a={};1&n&&(a.kmlColor=e[0].greatCircleColor),1&n&&(a.checked=e[0].greatCircleDisplay),U.$set(a);const l={};1&n&&(l.kmlColor=e[0].ogimetColor),1&n&&(l.checked=e[0].ogimetDisplay),Z.$set(l);const c={};1&n&&(c.kmlColor=e[0].etopsColor),1&n&&(c.checked=e[0].etopsDisplay),J.$set(c);const u={};1&n&&(u.selected=e[0].airportPin),1&n&&(u.checked=e[0].airportDisplay),Q.$set(u),(!Ee||1&n&&re!==(re=e[0].firDisplay))&&(oe.checked=re);const p={};1&n&&(p.value=e[0].iconTextChange),ce.$set(p);const m={};1&n&&(m.value=e[0].lineWidthChange),pe.$set(m);const f={};1&n&&(f.value=e[0].iconSizeChange),me.$set(f),(!Ee||4&n&&ye!==(ye=!e[2]))&&(he.disabled=ye),(!Ee||4&n&&Ce!==(Ce=!e[2]))&&(we.disabled=Ce),8&n&&q(t,"sidebar",e[3])},i(e){Ee||($e(d.$$.fragment,e),$e(P.$$.fragment,e),$e(z.$$.fragment,e),$e(U.$$.fragment,e),$e(Z.$$.fragment,e),$e(J.$$.fragment,e),$e(Q.$$.fragment,e),$e(ce.$$.fragment,e),$e(pe.$$.fragment,e),$e(me.$$.fragment,e),se((()=>{Me||(Me=ke(t,Ze,{duration:300,x:200,y:0},!0)),Me.run(1)})),Ee=!0)},o(e){xe(d.$$.fragment,e),xe(P.$$.fragment,e),xe(z.$$.fragment,e),xe(U.$$.fragment,e),xe(Z.$$.fragment,e),xe(J.$$.fragment,e),xe(Q.$$.fragment,e),xe(ce.$$.fragment,e),xe(pe.$$.fragment,e),xe(me.$$.fragment,e),Me||(Me=ke(t,Ze,{duration:300,x:200,y:0},!1)),Me.run(0),Ee=!1},d(e){e&&k(t),Fe(d),Fe(P),Fe(z),Fe(U),Fe(Z),Fe(J),Fe(Q),Fe(ce),Fe(pe),Fe(me),e&&Me&&Me.end(),Oe=!1,i(Se)}}}function $n(e){let t,n,o=e[3]&&bn(e);return{c(){o&&o.c(),t=E()},m(e,r){o&&o.m(e,r),w(e,t,r),n=!0},p(e,[n]){e[3]?o?(o.p(e,n),8&n&&$e(o,1)):(o=bn(e),o.c(),$e(o,1),o.m(t.parentNode,t)):o&&(ye(),xe(o,1,1,(()=>{o=null})),be())},i(e){n||($e(o),n=!0)},o(e){xe(o),n=!1},d(e){o&&o.d(e),e&&k(t)}}}function xn(e,t){return JSON.stringify(e)===JSON.stringify(t)}function wn(e,t,n){let o,r,i;l(e,un,(e=>n(3,i=e)));const a=Y(),s=yt.optionsKML;let{kmlOptions:c}=t,u={...nt,...bt.getItem(s)||{}};function p(e){let t=!1;for(const[r,i]of Object.entries(e))c[r]!==i&&(n(0,c[r]=i,c),a("change",{name:(o=r,o.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),value:i}),t=!0);var o;t&&n(0,c={...e})}return e.$$set=e=>{"kmlOptions"in e&&n(0,c=e.kmlOptions)},e.$$.update=()=>{1&e.$$.dirty&&n(1,o=xn(nt,c)),257&e.$$.dirty&&n(2,r=!xn(u,c))},[c,o,r,i,function(e){const t=e.detail?e.detail.name:e.target.name,o=e.detail?e.detail.value:e.target.checked,r=t.replace(/-([a-z])/g,(function(e){return e[1].toUpperCase()}));c[r]!==o&&(n(0,c[r]=o,c),a("change",{name:t,value:o}))},function(){p(nt)},function(){p(u)},function(){if(o)bt.removeItem(s);else{const e={};for(const t of Object.keys(c).filter((e=>c[e]!==nt[e])))e[t]=c[t];bt.setItem(s,e)}a("save"),n(8,u={...c})},u,function(t){Q(e,t)},()=>{m(un,i=!i,i)},()=>m(un,i=!1,i)]}class kn extends Ee{constructor(e){super(),Me(this,e,wn,$n,s,{kmlOptions:0})}}function Pn(e,t,n){const o={type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{}};return t&&(o.properties.title=t),n&&(o.properties.description=n),o}function Cn(e){return{type:"geojson",data:{type:"FeatureCollection",features:e}}}function Ln(e,t){const n={type:"Feature",geometry:{type:"LineString",coordinates:e},properties:{}};return t&&(n.properties.title=t),n}const _n=["#FFFFFF","#6699FF","#FFFF00","#CC9966","#FF9922","#DD5599","#FF0000","#22DD44","#BB11EE","#F56"],Fn=(e,t=10,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?10:o},Mn=(e,t=2)=>{const n=e*t;return isNaN(n)?1:n},En=(e,t=1,n=1)=>{const o=e*t*(e>1?n:1);return isNaN(o)?1:o};function On(e,t,n,o,r){const i=ze(t),a=r[`${i}Pin`],s=r[`${i}Display`],l=r[`${i}Color`],c=Fn(r.iconTextChange);e.addSource(`${t}-marker-source`,Cn(((e,t,n)=>{let o=[];const r=e.length;for(let i=0;i<r;i++){const r=t?t([e[i].longitude,e[i].latitude]):[e[i].longitude,e[i].latitude];r&&o.push(n?n(r,e[i]):r)}return o})(n,o,((e,t)=>Pn(e,t.name.replace(/00\.0/g,"")))))),e.addLayer(Tn(t,a,l,s,c))}function Sn(e,t,n,o,r,i,a,s){o?e.addSource(`${t}-line-source`,Cn(o(n).map((e=>Ln(e))))):e.addSource(`${t}-line-source`,{type:"geojson",data:Ln(n.map((e=>[e.longitude,e.latitude])))}),e.addLayer(An(t,r,i,a,s))}function jn(e,t,n,o,r,i,a,s){if(o){const r=n.length,i=[];for(let e=0;e<r;e++){const t=o(n[e]),r=t.length;for(let e=0;e<r;e++)i.push(Ln(t[e]))}e.addSource(`${t}-line-source`,Cn(i))}else e.addSource(`${t}-line-source`,Cn(n.map((e=>Ln(e.map((e=>[e.longitude,e.latitude])))))));e.addLayer(An(t,r,i,a,s))}function Tn(e,t,n,o,r){const[i,a]=ut(n);return{id:`${e}-marker-layer`,type:"symbol",source:`${e}-marker-source`,layout:{"icon-image":0!==t?"sdf-marker-15":"sdf-triangle","icon-size":0!==t?1:.2,"icon-anchor":0!==t?"bottom":"center","icon-offset":[0,0],"icon-allow-overlap":!1,visibility:o?"visible":"none","text-field":["get","title"],"text-size":r,"text-offset":[0,.7],"text-anchor":"top"},paint:{"icon-color":0!==t?_n[t]:i,"icon-halo-width":1,"icon-halo-color":"#000","text-color":i,"text-opacity":Math.max(a,.7)}}}function An(e,t,n,o=2,r=!1){const[i,a]=ut(t);return{id:`${e}-line-layer`,type:"line",source:`${e}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:n?"visible":"none"},paint:{"line-color":i,"line-opacity":a,"line-width":o,"line-dasharray":r?[10,10]:[1]}}}function In(e,t,n=1){const{map:o,value:r,kmlOptions:i}=t,a=`${e}-marker-layer`,s=i[`${ze(e)}Pin`];return o.getLayer(a)&&o.setLayoutProperty(a,"icon-size",s?En(r,n):.2),!0}function Dn(e,t,n=10){const{map:o,value:r}=t,i=`${e}-marker-layer`;return o.getLayer(i)&&o.setLayoutProperty(i,"text-size",Fn(r,n)),!0}function zn(e,t,n=2){const{map:o,value:r}=t,i=`${e}-line-layer`;return o.getLayer(i)&&o.setPaintProperty(i,"line-width",Mn(r,n)),!0}function Rn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`;if(n.getLayer(i)&&n.getLayer(r)){const e=o,t=_n[e],a=n.getPaintProperty(r,"line-color");n.setPaintProperty(i,"icon-color",0!==e?t:a),n.setPaintProperty(i,"text-color",a),n.setLayoutProperty(i,"icon-size",0!==e?1:.2),n.setLayoutProperty(i,"icon-image",0!==e?"sdf-marker-15":"sdf-triangle"),n.setLayoutProperty(i,"icon-anchor",0!==e?"bottom":"center")}return!0}function Wn(e,t){const{map:n,value:o}=t,r=`${e}-line-layer`,i=`${e}-marker-layer`,[a,s]=ut(o);return n.getLayer(r)&&(n.setPaintProperty(r,"line-color",a),n.setPaintProperty(r,"line-opacity",s)),n.getLayer(i)&&n.setPaintProperty(i,"text-color",a),!0}function Nn(e,t,n){const{map:o}=n,r=`${e}-line-layer`,i=`${e}-marker-layer`;return o.getLayer(r)&&o.setLayoutProperty(r,"visibility",t?"visible":"none"),o.getLayer(i)&&o.setLayoutProperty(i,"visibility",t?"visible":"none"),!0}const qn="airport-layer",Gn="airport-emer-layer",Un="airport-source",Hn=(e,t,n,o)=>0===e?(e=>["case",["==",8,["get",`${e}`]],"#ea80d8",["==",7,["get",`${e}`]],"#ea80d8",["==",6,["get",`${e}`]],"#dddddd",["==",5,["get",`${e}`]],"#dddddd",["==",4,["get",`${e}`]],"#fbfe98",["==",3,["get",`${e}`]],"#fbfe98",["==",2,["get",`${e}`]],"#00b0f1",["==",1,["get",`${e}`]],"#00b0f1","#000"])(t):((e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#095","#C71"])(n,o),Bn=(e,t=!0)=>t?["in",`${e}`,["get","type"]]:["!",["in",`${e}`,["get","type"]]],Zn=(e,t)=>["case",["in",["get","name"],["literal",t]],0,["get",`${e}`]],Kn=e=>0===e?3:0,Xn=(e,t)=>["case",["in",["get","name"],["literal",e]],t,["==",0,["get","level"]],"#000","#C60"],Jn=(e,t)=>["case",["in",["get","name"],["literal",e]],Fn(t,10),Fn(t,8,1.15)],Vn=e=>Fn(e,8,1.15),Yn=(e,t)=>["case",["in",["get","name"],["literal",e]],En(t,1),En(t,.6)],Qn=e=>["case",["==",2,["get","level"]],En(e,.5,1.2),En(e,.4,1.2)];function eo(e,t){const{map:n}=e;n.getLayer(qn)&&n.setLayoutProperty(qn,"visibility",t?"visible":"none"),n.getLayer(Gn)&&n.setLayoutProperty(Gn,"visibility",t?"visible":"none")}const to=e=>{const t=e.isFake?[]:e.infos.ralts;let n=[];return e.infos.EEP&&e.infos.EXP&&e.infos.raltPoints.length>0&&(n=[e.infos.EEP.name,e.infos.EXP.name]),[t,n.concat(t)]};var no={show:e=>eo(e,!0),hide:e=>eo(e,!1),add:e=>{const{map:t,mapData:n,ofp:o,kmlOptions:r}=e,{affineOrDrop:i}=n,a=i;let s=[];o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0&&(s=[o.infos.EEP,o.infos.EXP]);const l=o.isFake?o.isFake:o.infos.aircraft,c=o.infos.raltPoints,u=r.etopsColor,p=r.airportPin,d=r.airportDisplay,[m]=ut(u),f=s.map((e=>e.name)),g=c.map((e=>e.name)),h=f.concat(g);fetch("data/airports.2102a.geojson").then((e=>e.json())).then((e=>{if(a){const t=[];for(let n of e.features)n.geometry.coordinates=a(n.geometry.coordinates),void 0!==n.geometry.coordinates&&t.push(n);e.features=t}t.addSource(Un,{type:"geojson",data:e}),t.addLayer({id:Gn,type:"symbol",source:Un,layout:{"icon-image":["case",["==",2,["get","level"]],"sdf-star","sdf-airport"],"icon-size":Qn(r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":Vn(r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1},paint:{"icon-color":["case",["==",1,["get","level"]],"#D70","#B02"],"icon-halo-width":0,"icon-halo-color":"#000","text-color":"#000","text-opacity":.8},filter:Bn(l,!1)}),t.addLayer({id:qn,type:"symbol",source:Un,layout:{"icon-image":["case",["in",["get","name"],["literal",h]],"sdf-triangle","sdf-airport"],"icon-size":Yn(h,r.iconSizeChange),"icon-anchor":"center","icon-offset":[0,0],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:d?"visible":"none","text-field":["get","name"],"text-size":Jn(h,r.iconTextChange),"text-offset":[0,.7],"text-anchor":"top","text-allow-overlap":!1,"text-ignore-placement":!1,"symbol-sort-key":Zn(l,h)},paint:{"icon-halo-color":["case",["==",0,["get","level"]],"#095","#D70"],"icon-halo-width":Kn(p),"icon-color":Hn(p,l,g,m),"text-color":Xn(g,m),"text-halo-color":"#000","text-halo-width":["case",["==",0,["get","level"]],0,0],"text-opacity":.8},filter:Bn(l)});const n=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1,closeOnMove:!Ae}),o=function(e){const o=e.features[0].geometry.coordinates.slice(),r=e.features[0].properties.title;for(;Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;n.setLngLat(o).setHTML(r).addTo(t)},i=()=>t.getCanvas().style.cursor="pointer",s=()=>t.getCanvas().style.cursor="",c=function(){s(),n.remove()};Ae?(t.on("mouseenter",qn,(e=>{i(),o(e)})),t.on("mouseenter",Gn,(e=>{i(),o(e)})),t.on("mouseleave",qn,c),t.on("mouseleave",Gn,c)):(t.on("mouseenter",qn,i),t.on("mouseenter",Gn,i),t.on("click",qn,o),t.on("click",Gn,o),t.on("mouseleave",qn,s),t.on("mouseleave",Gn,s))}))},changeMarker:function(e){const{map:t,kmlOptions:n,ofp:o,aircraftType:r}=e,i=o.isFake?[]:o.infos.ralts,[a]=ut(n.etopsColor),s=n.airportPin;t.getLayer(qn)&&(t.setPaintProperty(qn,"icon-color",Hn(s,r,i,a)),t.setPaintProperty(qn,"text-color",Xn(i,a)),t.setPaintProperty(qn,"icon-halo-width",Kn(s)))},change:function(e){const{map:t,kmlOptions:n,aircraftType:o,ofp:r}=e,[i,a]=to(r),[s]=ut(n.etopsColor),l=n.airportPin;t.setFilter(qn,Bn(o)),t.setPaintProperty(qn,"icon-color",Hn(l,o,i,s)),t.setLayoutProperty(qn,"symbol-sort-key",Zn(o,a)),t.setFilter(Gn,Bn(o,!1))},changeIconText:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=to(o);t.getLayer(qn)&&t.setLayoutProperty(qn,"text-size",Jn(r,n.iconTextChange)),t.getLayer(Gn)&&t.setLayoutProperty(Gn,"text-size",Vn(n.iconTextChange))},changeIconSize:e=>{const{map:t,kmlOptions:n,ofp:o}=e,[,r]=to(o);t.getLayer(qn)&&t.setLayoutProperty(qn,"icon-size",Yn(r,n.iconSizeChange)),t.getLayer(Gn)&&t.setLayoutProperty(Gn,"icon-size",Qn(n.iconSizeChange))}};const oo="etops-ep-circle-line-layer",ro="etops-etops-circle-line-layer";function io(e,t){const{map:n}=e;n.getLayer(ro)&&n.setLayoutProperty(ro,"visibility",t?"visible":"none"),n.getLayer(oo)&&n.setLayoutProperty(oo,"visibility",t?"visible":"none")}var ao={show:e=>io(e,!0),hide:e=>io(e,!1),add:function(e){const{map:t,mapData:n,ofp:o,kmlOptions:r}=e;if(o.isFake)return;const i=Mn(r.lineWidthChange,1);if(o.infos.EEP&&o.infos.EXP&&o.infos.raltPoints.length>0){const{affineAndClip:e}=n;o.infos.EEP,o.infos.EXP;const a=o.infos.ETOPS,s=r.etopsDisplay;jn(t,"etops-ep-circle",[o.infos.EEP.circle(420,48),o.infos.EXP.circle(420,48)],e,r.routeColor,s,i,!0),jn(t,"etops-etops-circle",o.infos.raltPoints.map((e=>e.circle(7*a))),e,r.etopsColor,s,i,!0)}},changeLine:e=>function(e){const{map:t}=e,[n,o]=ut(e.value);t.getLayer(ro)&&(t.setPaintProperty(ro,"line-color",n),t.setPaintProperty(ro,"line-opacity",o))}(e),changeLineWidth:function(e){const{map:t,value:n}=e,o=Mn(n,1);return t.getLayer(ro)&&t.setPaintProperty(ro,"line-width",o),t.getLayer(oo)&&t.setPaintProperty(oo,"line-width",o),!0}};const so="fir-reg-line-layer",lo="fir-reg-layer",co="fir-reg-source";function uo(e,t){const{map:n}=e;n.getLayer(lo)&&n.setLayoutProperty(lo,"visibility",t?"visible":"none"),n.getLayer(so)&&n.setLayoutProperty(so,"visibility",t?"visible":"none")}var po={show:e=>uo(e,!0),hide:e=>uo(e,!1),add:e=>{const{map:t,mapData:n,kmlOptions:o,mapOptions:r}=e;if("jb_pacific"===r.id)return;const{affine:i}=n,a=o.firDisplay;fetch("data/fir-reg.2102a.geojson").then((e=>e.json())).then((e=>{if(i)for(let t=0;t<e.features.length;t++){const n=e.features[t].geometry.coordinates[0];e.features[t].geometry.coordinates=[n.map((e=>i(e)))]}t.addSource(co,{type:"geojson",data:e}),t.addLayer({id:lo,type:"fill",source:co,layout:{visibility:a?"visible":"none"},paint:{"fill-color":["case",["==","FIR-RED",["get","type"]],"rgba(255,0,0,0.2)","rgba(255,127,0,0.25)"]}}),t.addLayer({id:so,type:"line",source:co,layout:{visibility:a?"visible":"none"},paint:{"line-color":["case",["==","FIR-RED",["get","type"]],"rgb(255,0,0)","rgb(255,127,0)"],"line-width":1,"line-opacity":["case",["==","FIR-RED",["get","type"]],.4,.6]}})}))}};const mo="great-circle";var fo={show:Nn.bind(null,mo,!0),hide:Nn.bind(null,mo,!1),add:e=>{const{ofp:t,kmlOptions:n,mapData:o,map:r}=e;if(t.isFake)return;const{affineAndClip:i}=o,a=`${t.infos.departure}-${t.infos.destination}`,s=t.route,l=new editolido.Route([s.points[0],s.points[s.points.length-1]]).split(300,{name:`Ortho ${a}`});Sn(r,mo,l.points,i,n.greatCircleColor,n.greatCircleDisplay)},changeLine:Wn.bind(null,mo)};const go="ogimet";var ho={show:Nn.bind(null,go,!0),hide:Nn.bind(null,go,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i}=r;Sn(t,go,n.ogimetData.route.points,i,o.ogimetColor,o.ogimetDisplay)},changeLine:Wn.bind(null,go)};const vo="ralt";var yo={show:Nn.bind(null,vo,!0),hide:Nn.bind(null,vo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:a}=r,s=new editolido.Route(n.wptCoordinatesAlternate(),{name:"Route Dégagement"});Sn(t,vo,s.points,i,o.alternateColor,o.alternateDisplay),On(t,vo,s.points,a,o)},changeLine:Wn.bind(null,vo),changeMarker:Rn.bind(null,vo),changeIconText:Dn.bind(null,vo),changeLineWidth:zn.bind(null,vo),changeIconSize:In.bind(null,vo)};const bo="rmain";var $o={show:Nn.bind(null,bo,!0),hide:Nn.bind(null,bo,!1),add:e=>{const{map:t,ofp:n,kmlOptions:o,mapData:r}=e;if(n.isFake)return;const{affineAndClip:i,affineOrDrop:a}=r,s=n.route;s.name=`${n.infos.departure}-${n.infos.destination}`,s.description=n.description,Sn(t,bo,s.points,i,o.routeColor,!0),On(t,bo,s.points,a,o)},changeLine:e=>Wn(bo,e)&&function(e){const{map:t,kmlOptions:n}=e,[o,r]=ut(n.routeColor);t.getLayer(oo)&&(t.setPaintProperty(oo,"line-color",o),t.setPaintProperty(oo,"line-opacity",r))}(e),changeMarker:Rn.bind(null,bo),changeIconText:Dn.bind(null,bo),changeLineWidth:zn.bind(null,bo),changeIconSize:In.bind(null,bo)};const xo="rnat";const wo={airport:no,etops:ao,fir:po,greatcircle:fo,ogimet:ho,ralt:yo,rmain:$o,rnat:{show:e=>Nn(xo,!0,e)&&Nn("rnat-incomplete",!0,e),hide:e=>Nn(xo,!1,e)&&Nn("rnat-incomplete",!1,e),add:function(e){const{map:t,ofp:n,mapData:o,kmlOptions:r}=e;if(n.isFake)return;const{affineOrDrop:i,affineAndClip:a}=o,s=i,l=a,c=r.natColor,u=r.natPin,p=r.natDisplay,d={rnat:[],"rnat-incomplete":[]},m={rnat:[],"rnat-incomplete":[]};for(let e of n.tracks){const t=e.isComplete?"rnat":"rnat-incomplete";if(l){const n=l(e.points),o=n.length;for(let r=0;r<o;r++)d[t].push(Ln(n[r],e.name))}else d[t].push(Ln(e.points.map((e=>[e.longitude,e.latitude])),e.name));const n=e.points[0];let o=s?s([n.longitude,n.latitude]):[n.longitude,n.latitude];if(o&&m[t].push(Pn(o,`${e.name}\n${n.name}`,e.description)),e.isMine){const n=e.points[e.points.length-1];o=s?s([n.longitude,n.latitude]):[n.longitude,n.latitude],o&&m[t].push(Pn(o,`${e.name}\n${n.name}`,e.description))}}t.addSource("rnat-marker-source",Cn(m.rnat)),t.addSource("rnat-incomplete-marker-source",Cn(m["rnat-incomplete"])),t.addSource("rnat-line-source",Cn(d.rnat)),t.addSource("rnat-incomplete-line-source",Cn(d["rnat-incomplete"]));const f=Fn(r.iconTextChange,10),g=Mn(r.lineWidthChange,1);t.addLayer(An("rnat",c,p,g)),t.addLayer(An("rnat-incomplete",r.natIncompleteColor,p,g)),t.addLayer(Tn("rnat",u,c,p,f)),t.addLayer(Tn("rnat-incomplete",u,c,p,f));const h=e=>{for(var n=e.features[0].geometry.coordinates.slice(),o=e.features[0].properties.description;Math.abs(e.lngLat.lng-n[0])>180;)n[0]+=e.lngLat.lng>n[0]?360:-360;(new mapboxgl.Popup).setLngLat(n).setHTML(o).addTo(t)},v=e=>{const n=e+"-marker-layer";t.on("click",n,h),t.on("mouseenter",n,(function(){t.getCanvas().style.cursor="pointer"})),t.on("mouseleave",n,(function(){t.getCanvas().style.cursor=""}))};v("rnat"),v("rnat-incomplete")},changeLine:Wn.bind(null,xo),changeMarker:Rn.bind(null,xo),changeIconText:function(e){const{map:t,value:n}=e,o=Fn(n,10);return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","text-size",o),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","text-size",o),!0},changeLineWidth:function(e){const{map:t,value:n}=e,o=Mn(n,1);return t.getLayer("rnat-line-layer")&&t.setPaintProperty("rnat-line-layer","line-width",o),t.getLayer("rnat-incomplete-line-layer")&&t.setPaintProperty("rnat-incomplete-line-layer","line-width",o),!0},changeIconSize:function(e){const{map:t,value:n,kmlOptions:o}=e,r=o.natPin?En(n,1):.2;return t.getLayer("rnat-marker-layer")&&t.setLayoutProperty("rnat-marker-layer","icon-size",r),t.getLayer("rnat-incomplete-marker-layer")&&t.setLayoutProperty("rnat-incomplete-marker-layer","icon-size",r),!0}}},ko=2*Math.PI,Po=Math.PI/4,Co=function(e){return Math.abs(e)<=3.14159265359?e:e-function(e){return e<0?-1:1}(e)*ko};var Lo={init:function(){},forward:function(e){var t=e.x,n=e.y,o=Co(t-this.long0),r=Math.tan(n/2),i=Math.sin(Po*r),a=i*i,s=this.x0+this.a*o*(.74482-.34588*a),l=this.y0+1.70711*this.a*r;return e.x=s,e.y=l,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=e.y/1.70711/this.a,n=Math.sin(Po*t),o=n*n,r=Co(this.long0+e.x/this.a/(.74482-.34588*o)),i=2*Math.atan(t);return e.x=r,e.y=i,e},names:["The Times","times"]};function _o(e,t,n,o,r){window.proj4.Proj.projections.get("times")||window.proj4.Proj.projections.add(Lo);let i={container:e,center:[0,49],zoom:2,attributionControl:!0,customAttribution:`Yammer/${t.id.startsWith("jb_")?"QGIS & Avenza maps":"Maps.me"} - Airports/FIR © Olivier Ravet`};const a=new mapboxgl.Map({...t.mapboxOptions,...i});let s,l,c,u;a._setCacheLimits(320,32),a.loadImage("sdf/maki-marker-sdf.png",(function(e,t){e||a.addImage("sdf-marker-15",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-triangle-sdf.png",(function(e,t){e||a.addImage("sdf-triangle",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-circle-sdf.png",(function(e,t){e||a.addImage("sdf-airport",t,{pixelRatio:2,sdf:!0})})),a.loadImage("sdf/map-star-sdf.png",(function(e,t){e||a.addImage("sdf-star",t,{pixelRatio:2,sdf:!0})})),window.proj4.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),window.proj4.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs");let p,d=e=>window.proj4("WGS84","EPSG:3857",e),m=e=>window.proj4("EPSG:3857","WGS84",e);if(t.extent){let e,n,o,r;if(window.proj4.defs("CUSTOM",t.proj4),t.affineTransform)[e,n,o,r]=t.affineTransform;else if(t.ratio){const i=[-20026376.39,-20048966.1,20026376.39,20048966.1],a=i[2]-i[0],s=i[3]-i[1],[l,c,u,p]=t.extent,[d,m]=t.ratio,f=a/d*m*(s/a),[g,h,v,y]=[i[0],i[3]-f,i[2],i[3]];e=(v-g)/(u-l),n=g-e*l,o=(y-h)/(p-c),r=h-o*c}else{const[i,a,s,l]=t.extent,[c,u,p,d]=[-20026376.39,-20048966.1,20026376.39,20048966.1];e=(p-c)/(s-i),n=c-e*i,o=(d-u)/(l-a),r=u-o*a}const[i,a,p,f]=t.viewport?t.viewport:t.extent,g=e=>window.proj4("WGS84","CUSTOM",e),h=t=>[e*t[0]+n,o*t[1]+r],v=e=>m(h(e));d=e=>h(g(e)),s=e=>m(d(e)),l=e=>{let[t,n]=g(e);return t=Re(t,i,p),n=Re(n,a,f),v([t,n])},c=e=>{let[t,n]=g(e);if(We(t,i,p)&&We(n,a,f))return v([t,n])},u=e=>{if(0===e.length)return[];return function(e,t,n){var o,r,i,a,s,l=e.length,c=qe(e[0],t),u=[];for(n||(n=[]),o=1;o<l;o++){for(r=e[o-1],a=s=qe(i=e[o],t);;){if(!(c|a)){u.push(r),a!==s?(u.push(i),o<l-1&&(n.push(u),u=[])):o===l-1&&u.push(i);break}if(c&a)break;c?c=qe(r=Ne(r,i,c,t),t):a=qe(i=Ne(r,i,a,t),t)}c=s}return u.length&&n.push(u),n}(e.map((e=>g([e.longitude,e.latitude]))),t.extent).map((e=>e.map((e=>v(e)))))}}let f=[];if(!n.isFake){for(const e of n.tracks)f=f.concat(e.points);f=f.concat(n.route.points,n.wptCoordinatesAlternate()),p=((e,t,n=[1/0,1/0,-1/0,-1/0])=>{for(const[o,r]of e.map((e=>t?t([e.longitude,e.latitude]):[e.longitude,e.latitude])))n[0]>o&&(n[0]=o),n[1]>r&&(n[1]=r),n[2]<o&&(n[2]=o),n[3]<r&&(n[3]=r);return n[0]-=1,n[1]-=1,n[2]+=1,n[3]+=1,n})(f,l),a.fitBounds(p,{padding:{top:30,bottom:80,left:30,right:30}})}const g=new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!1},fitBoundsOptions:{maxZoom:3},trackUserLocation:!0});if(s){const e=g._onSuccess;g._onSuccess=function(t){const[n,o]=s([t.coords.longitude,t.coords.latitude]);return e.apply(this,[{coords:{longitude:n,latitude:o,accuracy:t.coords.accuracy}}])}}const h={map:a,affine:s,affineAndClamp:l,affineAndClip:u,affineOrDrop:c,bbox:p,mapOptions:t};return a.addControl(new class{onAdd(e){return this._map=e,this._container=document.createElement("div"),this._container.className="mapboxgl-ctrl  mapboxgl-ctrl-group",this._button=document.createElement("button"),this._button.className="mapboxgl-ctrl-layers",this._button.setAttribute("type","button"),this._button.setAttribute("title","Personnaliser la carte"),this._button.innerHTML='<svg><use xlink:href="#layers-symbol"/></svg>',this._container.appendChild(this._button),this._toggleSidebar=()=>un.update((e=>!e)),this._button.addEventListener("click",this._toggleSidebar),this._container}onRemove(){this._button.removeEventListener("click",this._toggleSidebar),this._container.parentNode.removeChild(this._container),this._map=void 0}}),a.addControl(g),a.on("load",(function(){(e=>{const{map:t,mapOptions:n}=e;n.tiles&&(t.addSource("jb-raster",{type:"raster",tiles:n.tiles,tileSize:n.tileSize}),t.addLayer({id:"jb-layer",type:"raster",source:"jb-raster",minzoom:0,maxzoom:22,paint:{"raster-opacity":1}})),Object.values(wo).forEach((t=>t.add&&t.add(e)))})({ofp:n,kmlOptions:o,mapData:h,map:a,mapOptions:t}),n.isFake||async function(e,t){if(window.caches)try{const n=await window.caches.open(t);await n.addAll(e)}catch(e){}}([n.ogimetData.proxyImg],"lido-gramet2"),r&&r(a,t)})),h}class Fo{constructor(e,t,n){this.dbName=e,this.dbPromise=new Promise(((o,r)=>{const i=indexedDB.open(e,t);i.onsuccess=()=>{o(i)},i.onerror=()=>{r("Error while opening DB")},i.onupgradeneeded=n?n.bind(null,i):()=>{}}))}getImageIdFromURL(e){return e.pathname.replace(/[/.]/g,"_")}async fetchImageFromDB(e,t){const n=await this.dbPromise;return new Promise(((o,r)=>{const i=n.result.transaction(t,"readonly").objectStore(t).get(e);i.onsuccess=()=>{o(i.result)},i.onerror=()=>{r("Something went wrong while fetching image from DB ")}}))}async putImageInDB(e,t,n){const o=await this.dbPromise;return new Promise(((r,i)=>{const a=o.result.transaction(t,"readwrite").objectStore(t),s=a.put(n,e);s.onsuccess=()=>{const t=a.get(e);t.onsuccess=()=>{r(t.result)}},s.onerror=()=>{i("Something went wrong while putting image in DB ")}}))}getCacheHandler(e){return this._cacheHandler.bind(this,e)}async isNotCached(e,t){const n=this.getImageIdFromURL(t),o=await this.dbPromise;return new Promise(((r,i)=>{const a=o.result.transaction(e,"readonly").objectStore(e).getKey(n);a.onsuccess=()=>{r(void 0===a.result?t:null)},a.onerror=()=>{i("Something went wrong while checking if cached from DB ")}}))}async countTiles(e){const t=await this.dbPromise;return new Promise(((n,o)=>{const r=t.result.transaction(e,"readonly").objectStore(e).count();r.onsuccess=()=>n(r.result),r.onerror=()=>o("Something went wrong while counting entries from DB")}))}async close(){(await this.dbPromise).result.close()}async _cacheHandler(e,{request:t,url:n}){const o=this.getImageIdFromURL(n);return this.fetchImageFromDB(o,e).then((n=>n?new Response(n):fetch(t).then((e=>e.clone().blob())).then((t=>t.type.startsWith("image/")||"application/x-protobuf"===t.type?this.putImageInDB(o,e,t).then((e=>new Response(e))):new Response("",{status:404,statusText:"invalid image found (sw)"})))))}}function Mo(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}function Eo(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}const Oo=async(e,t)=>{const{map:n,mapOptions:o,bbox:r}=t;if(e.isFake||void 0===n)return[];const i=new Fo("lido-tiles");if(o.cacheAll){const e=await i.countTiles(o.cacheName);let t;if(t=o.matrix?o.matrix.map((([e,t])=>e*t)):[...Array(o.cacheZoom+1).keys()].map((e=>Math.pow(2,e)*Math.pow(2,e))),e>=t.reduce(((e,t)=>e+t),0))return i.close(),caches[o.id]=!0,[]}const[a,s]=[[r[0],r[1]],[r[2],r[3]]],l=[];for(let e=0;e<=o.cacheZoom;e++){let t,r;const c=Math.pow(2,e);let u,p;o.cacheAll?(t={x:0,y:c-1},r={x:c-1,y:0}):(t={x:Mo(a[0],e),y:Eo(a[1],e)},r={x:Mo(s[0],e),y:Eo(s[1],e)}),o.matrix?[u,p]=o.matrix[e]:[u,p]=[c,c];for(let a=t.x;a<=r.x;a++)for(let s=r.y;s<=t.y;s++)if(a>=0&&s>=0&&a<u&&s<p){let t;o.tiles?(t=new URL(o.tiles[0].replace("{z}",e).replace("{x}",a).replace("{y}",s)),l.push(i.isNotCached(o.cacheName,t))):(t=new URL(`https://api.mapbox.com/v4/denizotjb.63g5ah66/${e}/${a}/${s}@2x.webp?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)),t=new URL(`https://api.mapbox.com/v4/denizotjb.9001lcsf,denizotjb.494jxmoa,mapbox.mapbox-streets-v8,denizotjb.bifqeinj,denizotjb.cz0kdfpx,mapbox.mapbox-terrain-v2/${e}/${a}/${s}.vector.pbf?sku=${n._requestManager._skuToken}&access_token=${mapboxgl.accessToken}`),l.push(i.isNotCached(o.cacheName,t)))}}const c=await Promise.all(l);return i.close(),c.filter((e=>null!==e))};function So(e){let t,n,o,r,i,a;const s=e[4].default,l=c(s,e,e[3],null);return{c(){t=L("svg"),n=L("path"),o=L("path"),i=M(),l&&l.c(),j(n,"d","M50,5A45 45 0 1 1 49.9999 5"),j(n,"class","svelte-1bp2w4i"),j(o,"d",r=e[0]()),j(o,"class","svelte-1bp2w4i"),j(t,"viewBox","0 0 100 100"),j(t,"class","svelte-1bp2w4i")},m(e,r){w(e,t,r),x(t,n),x(t,o),w(e,i,r),l&&l.m(e,r),a=!0},p(e,[t]){(!a||1&t&&r!==(r=e[0]()))&&j(o,"d",r),l&&l.p&&8&t&&p(l,s,e,e[3],t,null,null)},i(e){a||($e(l,e),a=!0)},o(e){xe(l,e),a=!1},d(e){e&&k(t),e&&k(i),l&&l.d(e)}}}function jo(e,t,n){let o,{$$slots:r={},$$scope:i}=t,{value:a=0}=t,{max:s=100}=t;return e.$$set=e=>{"value"in e&&n(1,a=e.value),"max"in e&&n(2,s=e.max),"$$scope"in e&&n(3,i=e.$$scope)},e.$$.update=()=>{6&e.$$.dirty&&n(0,o=()=>{if(a<=0)return"";if(a>=s)return"M50,5A45 45 0 1 1 49.9999 5";{const e=2*Math.PI*(a/s),t=50+45*Math.cos(e-Math.PI/2),n=50+45*Math.sin(e-Math.PI/2);let o="M50,5";return e>Math.PI&&(o+="A45 45 0 0 1 50 95"),o+=`A45 45 0 0 1 ${t} ${n}`,o}})},[o,a,s,i,r]}class To extends Ee{constructor(e){super(),Me(this,e,jo,So,s,{value:1,max:2})}}function Ao(e,t,n){const o=e.slice();return o[13]=t[n],o}function Io(e){let t,n,o,r,a,s=Wo,l=[];for(let t=0;t<s.length;t+=1)l[t]=Do(Ao(e,s,t));return{c(){t=C("div"),n=C("select"),o=C("option"),o.textContent="pas d'ofp ?";for(let e=0;e<l.length;e+=1)l[e].c();o.__value="none",o.value=o.__value,j(n,"class","form-control-sm svelte-4l3qox"),n.disabled=e[0],j(t,"class","footer svelte-4l3qox")},m(i,s){w(i,t,s),x(t,n),x(n,o);for(let e=0;e<l.length;e+=1)l[e].m(n,null);r||(a=[O(n,"click",e[4],{once:!0}),O(n,"change",e[6])],r=!0)},p(e,t){if(0&t){let o;for(s=Wo,o=0;o<s.length;o+=1){const r=Ao(e,s,o);l[o]?l[o].p(r,t):(l[o]=Do(r),l[o].c(),l[o].m(n,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=s.length}1&t&&(n.disabled=e[0])},d(e){e&&k(t),P(l,e),r=!1,i(a)}}}function Do(t){let n,o,r=t[13]+"";return{c(){n=C("option"),o=F(r),n.__value=t[13],n.value=n.__value},m(e,t){w(e,n,t),x(n,o)},p:e,d(e){e&&k(n)}}}function zo(t){let n,o,r,a,s,l,c,u,p,d=!t[3]&&Io(t);return{c(){n=C("div"),o=C("input"),r=M(),a=C("label"),s=F(t[1]),l=M(),d&&d.c(),c=E(),j(o,"id",qo),j(o,"name",qo),j(o,"type","file"),j(o,"accept","application/pdf"),o.disabled=t[0],j(o,"class","custom-file-input svelte-4l3qox"),j(a,"class","custom-file-label text-truncate svelte-4l3qox"),j(a,"for",qo),q(a,"ready",t[2]),j(n,"class","custom-file svelte-4l3qox"),q(n,"blink",!t[3])},m(e,i){w(e,n,i),x(n,o),x(n,r),x(n,a),x(a,s),w(e,l,i),d&&d.m(e,i),w(e,c,i),u||(p=[O(o,"change",t[5]),O(o,"click",t[4],{once:!0})],u=!0)},p(e,[t]){1&t&&(o.disabled=e[0]),2&t&&D(s,e[1]),4&t&&q(a,"ready",e[2]),8&t&&q(n,"blink",!e[3]),e[3]?d&&(d.d(1),d=null):d?d.p(e,t):(d=Io(e),d.c(),d.m(c.parentNode,c))},i:e,o:e,d(e){e&&k(n),e&&k(l),d&&d.d(e),e&&k(c),u=!1,i(p)}}}const Ro=[{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"},{type:"script",url:"./js/lidojs.1.3.7.min.js"},{type:"script",url:"https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.6.2/proj4.min.js"},{type:"script",url:"./js/wmo.1.3.7.var.js"},{type:"script",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.js"},{type:"link",url:"https://unpkg.com/mapbox-gl@1.10.1/dist/mapbox-gl.css"}],Wo=["318","319","320","321","330","340","350","380","787","772","773","77F"],No=async(e,t)=>{const n=await e.getPage(t);return(await n.getTextContent()).items.map((e=>e.str)).join("")};let qo="file";function Go(e,t,n){let o,r;l(e,dn,(e=>n(9,o=e))),l(e,pn,(e=>n(3,r=e)));let i,{kmlOptions:a}=t,s=!1,c=new Oe,u="Choisir un OFP",p=!1;const d=Y();function f(){!function(e,t,n){let o=e.length;function r(){o=--o,o<1&&n()}t()?n():e.forEach((({type:e,url:t,options:n={async:!0,defer:!0}})=>{const i="script"===e,a=document.createElement(i?"script":"link");(t.startsWith("http")||t.startsWith("//"))&&(a.crossOrigin="anonymous");let s=!0;i?(a.src=t,a.async=n.async,a.defer=n.defer):(a.href=t,"prefetch"in n?(a.rel="prefetch",o-=1,s=!1):"preload"in n?(a.rel="preload",o-=1,s=!1):(a.rel="stylesheet",o-=1,s=!1)),s&&(a.onload=r),document.body.appendChild(a)}))}(Ro,(()=>!!window["pdfjs-dist/build/pdf"]),(()=>{const e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.worker.min.js",i&&!i.destroyed||(i=new e.PDFWorker),c.resolve(!0),n(2,p=!0)}))}const g=e=>{const t=new FileReader;return m(dn,o=!1,o),new Promise(((n,o)=>{t.onload=e=>{if(!i||i.destroyed){const e=window["pdfjs-dist/build/pdf"];i=new e.PDFWorker}(async e=>{const t=window["pdfjs-dist/build/pdf"],n=[];let o=0;const r=await t.getDocument(e).promise,i=r.numPages;for(let e=1;e<=i;e+=1){const t=await No(r,e);if(t.includes("(Long copy #1)"))n.push(t),o+=1;else{if(0!==o)break;t.includes("FPL SUMMARY")&&n.push(t)}}return n.join("\n")})({data:e.target.result,verbosity:0,worker:i}).then((e=>{if(e)try{const t=new editolido.Ofp("_PDFJS_"+e),r=new editolido.GeoGridIndex;r.data=window.WMO;const i=editolido.ogimetData(t,r);i.proxyImg=`https://ofp2map-gramet.vercel.app/api/${i.proxy}__${i.route.name.replace(/[^a-z0-9\-_]/giu,"_")}.png`,i.route.description=i.wmo.join(" "),t.ogimetData=i;try{rt();it(t,a),n(t)}catch(e){o(e)}}catch(e){o(e)}else o(Error('OFP non reconnu, il faut choisir "Dossier de vol OFP" dans Pilot Mission.'))}),(e=>o(e)))},t.onerror=e=>{o(Error("Fichier illisible !"))},t.readAsArrayBuffer(e)}))};return e.$$set=e=>{"kmlOptions"in e&&n(7,a=e.kmlOptions)},[s,u,p,r,f,async function(e){n(0,s=!0),f(),await c.promise.then((()=>{const t=e.target.files[0];t&&(n(1,u=e.target.value.split(/([\\/])/g).pop()),d("change",u),m(pn,r=g(t),r),"#/gramet"!==window.location.hash&&(window.location.hash="#/map"))})),n(0,s=!1)},async function(e){n(0,s=!0),f(),await c.promise.then((()=>{m(dn,o=!0,o),m(pn,r=new Promise(((t,n)=>{let o=new editolido.Ofp("_PDFJS_AF 681 KATL/LFPG 11Mar2020/2235zReleased: 11Mar/1724z3Main OFP (Long copy #1)OFP 6/0/1 ATC FLIGHT PLAN (FPL-AFR681-IS -B77W/ -KATL2235 -LFPG0724 LFPO ) FLIGHT SUMMARY 0012 TAXI IN Generated");o.isFake=e.target.value;try{rt();it(o,a),t(o)}catch(e){n(e)}})),r),window.location.hash="#/map"})),n(0,s=!1)},a]}class Uo extends Ee{constructor(e){super(),Me(this,e,Go,zo,s,{kmlOptions:7})}}function Ho(e,t,n){const o=e.slice();return o[6]=t[n],o}function Bo(e){let t;return{c(){t=C("option"),t.textContent="???",t.__value="???",t.value=t.__value,t.selected=!0},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function Zo(e){let t,n,o,r=e[6]+"";return{c(){t=C("option"),n=F(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6]===e[0]},m(e,o){w(e,t,o),x(t,n)},p(e,n){1&n&&o!==(o=e[6]===e[0])&&(t.selected=o)},d(e){e&&k(t)}}}function Ko(t){let n,o,r,a,s="???"===t[0]&&Bo(),l=Wo,c=[];for(let e=0;e<l.length;e+=1)c[e]=Zo(Ho(t,l,e));return{c(){n=C("select"),s&&s.c(),o=E();for(let e=0;e<c.length;e+=1)c[e].c();j(n,"name","aircraftType"),j(n,"class","svelte-1xpiicm"),void 0===t[0]&&se((()=>t[5].call(n)))},m(e,i){w(e,n,i),s&&s.m(n,null),x(n,o);for(let e=0;e<c.length;e+=1)c[e].m(n,null);t[4](n),W(n,t[0]),r||(a=[O(n,"change",t[5]),O(n,"change",t[3])],r=!0)},p(e,[t]){if("???"===e[0]?s||(s=Bo(),s.c(),s.m(n,o)):s&&(s.d(1),s=null),1&t){let o;for(l=Wo,o=0;o<l.length;o+=1){const r=Ho(e,l,o);c[o]?c[o].p(r,t):(c[o]=Zo(r),c[o].c(),c[o].m(n,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=l.length}1&t&&W(n,e[0])},i:e,o:e,d(e){e&&k(n),s&&s.d(),P(c,e),t[4](null),r=!1,i(a)}}}function Xo(e,t,n){let{selectedAircraft:o="???"}=t,{aircraftTypeSelectElement:r=null}=t,{ofp:i}=t;return V((()=>{"???"===o&&i&&n(0,o=i.isFake?i.isFake:i.infos.aircraft),-1===Wo.indexOf(o)&&n(0,o="???")})),e.$$set=e=>{"selectedAircraft"in e&&n(0,o=e.selectedAircraft),"aircraftTypeSelectElement"in e&&n(1,r=e.aircraftTypeSelectElement),"ofp"in e&&n(2,i=e.ofp)},[o,r,i,function(t){Q(e,t)},function(e){te[e?"unshift":"push"]((()=>{r=e,n(1,r)}))},function(){o=N(this),n(0,o)}]}class Jo extends Ee{constructor(e){super(),Me(this,e,Xo,Ko,s,{selectedAircraft:0,aircraftTypeSelectElement:1,ofp:2})}}const Vo={version:8,name:"Blank pour App",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"template","mapbox:sdk-support":{js:"1.9.0",android:"8.6.0",ios:"5.6.0"},"mapbox:groups":{},"mapbox:uiParadigm":"layers"},center:[0,0],zoom:1.2946207284336362,bearing:0,pitch:0,sources:{},sprite:"mapbox://sprites/flyingeek/ckbhlmwdm0mn51imw8t4dddqs/ck2u8j60r58fu0sgyxrigm3cu",glyphs:"mapbox://fonts/flyingeek/{fontstack}/{range}.pbf",layers:[],created:"2020-06-16T07:22:32.952Z",id:"ckbhlmwdm0mn51imw8t4dddqs",modified:"2020-06-16T07:23:29.539Z",owner:"flyingeek",visibility:"public",draft:!1},Yo=matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches?256:512,Qo=[{label:"Mercator",id:"mercator",mapboxOptions:{style:"mapbox://styles/flyingeek/cklgh38ep0xsr17qsvlrhth1e",renderWorldCopies:!1,maxZoom:12},cacheName:"denizotjbv1",cacheZoom:6},{label:"Lambert North",id:"jb_north",extent:[-7441575.3298294,-5719574.1644927,7383398.17621086,9105399.34154755],proj4:"+proj=lcc +lat_1=30 +lat_2=65 +lat_0=47.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Vo,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-northv3.netlify.app/northv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"northv3",cacheAll:!0,tileSize:Yo},{label:"Lambert South",id:"jb_south",extent:[-12613000.20107552,-12796118.19556621,13437104.14597977,13253986.15148908],validity:[-12613903.56963206,-9420000.1608799,13437054.51836624,5862747.38325809],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Vo,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-southv3.netlify.app/southv3/{z}/{x}/{y}.jpg"],cacheZoom:4,cacheName:"southv3",cacheAll:!0,tileSize:Yo},{label:"Lambert Pacific",id:"jb_pacific",extent:[-8306365.14297095,-7788164.66141786,6519185.45830619,7037385.93985927],proj4:"+proj=lcc +lat_1=-15 +lat_2=30 +lat_0=7.5 +lon_0=-140 +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs",mapboxOptions:{style:Vo,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-pacificv1.netlify.app/pacificv1/{z}/{x}/{y}.jpg"],cacheName:"pacificv1",cacheZoom:4,cacheAll:!0,tileSize:Yo},{label:"The World",id:"jb_theworld",affineTransform:[1.314746085506463,-45260.546626176685,1.315,648e4],extent:[-15201502.45260082,-8478963.56607166,15262747.04890729,10300929.57326125],proj4:"+proj=times +ellps=sphere +no_defs +wktext +lon_0=0 +x_0=0 +y_0=0",mapboxOptions:{style:Vo,renderWorldCopies:!1,maxZoom:5},tiles:["https://ofp2map-theworldv2.netlify.app/theworldv2/{z}/{x}/{y}.webp"],matrix:[[1,1],[2,2],[4,3],[8,5],[16,10],[32,20]],cacheZoom:5,cacheName:"theworldv2",cacheAll:!0,tileSize:Yo}];function er(e,t,n){const o=e.slice();return o[6]=t[n],o[8]=n,o}function tr(e){let t,n,o,r=(e[6].proj4&&e[2](e[6])?`${e[6].label.toUpperCase()}`:e[6].label)+"";return{c(){t=C("option"),n=F(r),t.__value=e[6],t.value=t.__value,t.selected=o=e[6].id===e[0].id},m(e,o){w(e,t,o),x(t,n)},p(e,n){1&n&&o!==(o=e[6].id===e[0].id)&&(t.selected=o)},d(e){e&&k(t)}}}function nr(t){let n,o,r,a=Qo,s=[];for(let e=0;e<a.length;e+=1)s[e]=tr(er(t,a,e));return{c(){n=C("select");for(let e=0;e<s.length;e+=1)s[e].c();j(n,"name",t[1]),j(n,"class","form-control form-control-sm svelte-1uc3ace"),void 0===t[0]&&se((()=>t[5].call(n)))},m(e,i){w(e,n,i);for(let e=0;e<s.length;e+=1)s[e].m(n,null);W(n,t[0]),o||(r=[O(n,"change",t[5]),O(n,"change",t[4])],o=!0)},p(e,[t]){if(5&t){let o;for(a=Qo,o=0;o<a.length;o+=1){const r=er(e,a,o);s[o]?s[o].p(r,t):(s[o]=tr(r),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=a.length}2&t&&j(n,"name",e[1]),1&t&&W(n,e[0])},i:e,o:e,d(e){e&&k(n),P(s,e),o=!1,i(r)}}}function or(e,t,n){let{name:o="map-style"}=t,{ofp:r}=t,{selected:i=Qo[0]}=t;return V((()=>{if(i.id===Qo[0].id&&r&&!r.isFake){const e=r.route.points[0],t=r.route.points[r.route.points.length-1];t.latitude>30&&e.latitude>30?n(0,i=Qo[1]):t.longitude<-80&&e.longitude<-80?n(0,i=Qo[3]):n(0,i=Qo[2])}})),e.$$set=e=>{"name"in e&&n(1,o=e.name),"ofp"in e&&n(3,r=e.ofp),"selected"in e&&n(0,i=e.selected)},[i,o,function(e){if(!e.proj4||!r||r.isFake)return!0;const t=r.route.points[0],n=r.route.points[r.route.points.length-1];if("jb_north"===e.id)return n.latitude>30&&t.latitude>30;if("jb_south"===e.id){if(n.latitude>30&&t.latitude>30)return!1}else if("jb_theworld"===e.id)return!1;const o=e.validity?e.validity:e.extent;for(let r of[t,n]){const[t,n]=window.proj4(e.proj4,[r.longitude,r.latitude]);if(t<o[0]||t>o[2]||n<o[1]||n>o[3])return!1}return!0},r,function(t){Q(e,t)},function(){i=N(this),n(0,i)}]}class rr extends Ee{constructor(e){super(),Me(this,e,or,nr,s,{name:1,ofp:3,selected:0})}}function ir(e,t){let n=t;const o=()=>n&&n.resize(),r=new IntersectionObserver(((e,t)=>{e.forEach((e=>{1===e.intersectionRatio&&o()}))}),{threshold:1});r.observe(e);const i=()=>{document&&document.visibilityState&&"visible"===document.visibilityState&&o()};return document.addEventListener("visibilitychange",i,!1),window.addEventListener("orientationchange",o),{update(e){n=e},destroy(){r.unobserve(e),r.disconnect(),window.removeEventListener("orientationchange",o),document.removeEventListener("visibilitychange",i),n&&n.remove()}}}function ar(e){let t,n,o,r,i;return n=new To({props:{value:e[8],max:e[7],$$slots:{default:[sr]},$$scope:{ctx:e}}}),{c(){t=C("div"),Le(n.$$.fragment),j(t,"class","cacheButton svelte-qq3vrb"),q(t,"cacheError",e[9]),q(t,"cacheProgress",e[8]>0||e[7]>0)},m(s,l){w(s,t,l),_e(n,t,null),o=!0,r||(i=O(t,"click",(function(){a(e[11]?cr:e[17])&&(e[11]?cr:e[17]).apply(this,arguments)})),r=!0)},p(o,r){e=o;const i={};256&r&&(i.value=e[8]),128&r&&(i.max=e[7]),33554432&r&&(i.$$scope={dirty:r,ctx:e}),n.$set(i),512&r&&q(t,"cacheError",e[9]),384&r&&q(t,"cacheProgress",e[8]>0||e[7]>0)},i(e){o||($e(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){e&&k(t),Fe(n),r=!1,i()}}}function sr(e){let t;const n=e[19].default,o=c(n,e,e[25],null),r=o||function(e){let t;return{c(){t=C("span"),t.textContent="↓",j(t,"class","svelte-qq3vrb")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}();return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,t){o&&o.p&&33554432&t&&p(o,n,e,e[25],t,null,null)},i(e){t||($e(r,e),t=!0)},o(e){xe(r,e),t=!1},d(e){r&&r.d(e)}}}function lr(e){let t,n,o,r,i,s,l,c,u,p,d,m,g,h,v,y,b;function $(t){e[20](t)}let P={ofp:e[1]};void 0!==e[4]&&(P.selected=e[4]),i=new rr({props:P}),te.push((()=>Ce(i,"selected",$))),i.$on("change",e[14]);let L=e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]&&ar(e);function _(t){e[21](t)}function F(t){e[22](t)}let E={ofp:e[1]};function O(t){e[23](t)}void 0!==e[5]&&(E.selectedAircraft=e[5]),void 0!==e[6]&&(E.aircraftTypeSelectElement=e[6]),u=new Jo({props:E}),te.push((()=>Ce(u,"selectedAircraft",_))),te.push((()=>Ce(u,"aircraftTypeSelectElement",F))),u.$on("change",e[15]);let S={};return void 0!==e[0]&&(S.kmlOptions=e[0]),g=new kn({props:S}),te.push((()=>Ce(g,"kmlOptions",O))),g.$on("change",e[16]),g.$on("save",e[24]),{c(){t=C("div"),o=M(),r=C("div"),Le(i.$$.fragment),l=M(),L&&L.c(),c=M(),Le(u.$$.fragment),m=M(),Le(g.$$.fragment),j(t,"id",e[2]),j(t,"class","svelte-qq3vrb"),j(r,"class","mapmenu svelte-qq3vrb")},m(a,s){w(a,t,s),w(a,o,s),w(a,r,s),_e(i,r,null),x(r,l),L&&L.m(r,null),w(a,c,s),_e(u,a,s),w(a,m,s),_e(g,a,s),v=!0,y||(b=f(n=ir.call(null,t,e[3])),y=!0)},p(e,[o]){(!v||4&o)&&j(t,"id",e[2]),n&&a(n.update)&&8&o&&n.update.call(null,e[3]);const l={};2&o&&(l.ofp=e[1]),!s&&16&o&&(s=!0,l.selected=e[4],le((()=>s=!1))),i.$set(l),e[4]&&!e[1].isFake&&window.indexedDB&&e[13]&&!0!==e[10][e[4].id]&&!e[12]?L?(L.p(e,o),13330&o&&$e(L,1)):(L=ar(e),L.c(),$e(L,1),L.m(r,null)):L&&(ye(),xe(L,1,1,(()=>{L=null})),be());const c={};2&o&&(c.ofp=e[1]),!p&&32&o&&(p=!0,c.selectedAircraft=e[5],le((()=>p=!1))),!d&&64&o&&(d=!0,c.aircraftTypeSelectElement=e[6],le((()=>d=!1))),u.$set(c);const m={};!h&&1&o&&(h=!0,m.kmlOptions=e[0],le((()=>h=!1))),g.$set(m)},i(e){v||($e(i.$$.fragment,e),$e(L),$e(u.$$.fragment,e),$e(g.$$.fragment,e),v=!0)},o(e){xe(i.$$.fragment,e),xe(L),xe(u.$$.fragment,e),xe(g.$$.fragment,e),v=!1},d(e){e&&k(t),e&&k(o),e&&k(r),Fe(i),L&&L.d(),e&&k(c),Fe(u,e),e&&k(m),Fe(g,e),y=!1,b()}}}const cr=()=>!1;function ur(e,t,n){let o,r;l(e,hn,(e=>n(13,r=e)));let{$$slots:i={},$$scope:a}=t;const s=Y();let c,u,p,d,m,{kmlOptions:f}=t,{ofp:g}=t,h=0,v=0,y=!1,b=[];const $={};let{id:x="map"}=t;async function w(){n(18,b=await Oo(g,u));const e=document.querySelector(`#${x} .mapboxgl-ctrl-attrib-inner`);e&&(e.appendChild(document.createTextNode(" | ")),e.appendChild(m),e.appendChild(document.createTextNode(`${"2102a".substring(0,2)}.${"2102a".substring(2,4)}`)))}const k=e=>{(e=>{const{name:t,value:n}=e,o=De(t);if("icontext"===o)return Object.values(wo).forEach((t=>t.changeIconText&&t.changeIconText(e)));if("linewidth"===o)return Object.values(wo).forEach((t=>t.changeLineWidth&&t.changeLineWidth(e)));if("iconsize"===o)return Object.values(wo).forEach((t=>t.changeIconSize&&t.changeIconSize(e)));const r=wo[o];r&&(t.endsWith("-display")?n?r.show&&r.show(e):r.hide&&r.hide(e):t.endsWith("-pin")?r.changeMarker&&r.changeMarker(e):t.endsWith("-color")?r.changeLine&&r.changeLine(e):t.endsWith("-change")&&r.change&&r.change(e))})({map:c,mapData:u,name:e.detail.name,value:e.detail.value,ofp:g,kmlOptions:f,aircraftType:d}),function(e,t){if(e.startsWith("etops-")||e.startsWith("airport-")||e.startsWith("fir-")||e.endsWith("-change"))return;const n=rt(),o=De(e);e.endsWith("-display")?n.changeFolderState(o,t):e.endsWith("-pin")?n.changeFolderPin(o,t):e.endsWith("-color")&&n.changeFolderColor(o,t.toUpperCase())}(e.detail.name,e.detail.value),s("save")};let P=!1;return V((()=>{mapboxgl.accessToken="pk.eyJ1IjoiZmx5aW5nZWVrIiwiYSI6ImNrYXpmZzhuYjBpczUycW1pZzZ1b2Z4NjAifQ.5S-VzSXpJkui8NDMlTU51Q",u=_o(x,p,g,f,w),n(3,c=u.map)})),e.$$set=e=>{"kmlOptions"in e&&n(0,f=e.kmlOptions),"ofp"in e&&n(1,g=e.ofp),"id"in e&&n(2,x=e.id),"$$scope"in e&&n(25,a=e.$$scope)},e.$$.update=()=>{262144&e.$$.dirty&&n(12,o=0===b.length)},[f,g,x,c,p,d,m,h,v,y,$,P,o,r,function(e){e.target.blur(),c&&c.remove(),n(8,v=0),n(9,y=!1),n(18,b=[]),n(7,h=0),u=_o(x,p,g,f,w),n(3,c=u.map)},function(e){e.target.blur(),k({detail:{value:d,name:"airport-change"}})},k,async e=>{if(P)return!1;n(11,P=!0);try{n(7,h=b.length),n(9,y=!1);try{await Ge(4e3,fetch(`./manifest.json?dummy=${Date.now()}`,{cache:"no-store"}))}catch(e){return n(11,P=!1),n(9,y=!0),!1}n(8,v=0),await async function(e,t){const n=e;let o=0,r=0;return await new Promise((e=>{const i=setInterval((async()=>{if(0===n.filter((e=>e)).length&&(clearInterval(i),e()),o>=5||r>n.length-1)return;const a=r++,s=n[a];o++;try{await fetch(s),t&&t()}catch{}o--,delete n[a]}),100)}))}(b,(()=>n(8,v++,v))),v>=h&&(n(10,$[p.id]=!0,$),n(10,$),n(18,b=[]),n(7,h=0))}finally{n(11,P=!1)}},b,i,function(e){p=e,n(4,p)},function(e){d=e,n(5,d)},function(e){m=e,n(6,m)},function(e){f=e,n(0,f)},function(t){Q(e,t)},a]}class pr extends Ee{constructor(e){super(),Me(this,e,ur,lr,s,{kmlOptions:0,ofp:1,id:2})}}function dr(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1rvfn9e"><use xlink:href="#map-symbol"></use></svg> \n      <span class="svelte-1rvfn9e">CARTE</span>',j(n,"class","nav-link svelte-1rvfn9e"),j(n,"href","#/map"),q(n,"disabled",!e[1]),j(t,"class","nav-item svelte-1rvfn9e"),q(t,"active","/map"===e[0])},m(e,o){w(e,t,o),x(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/map"===e[0])},d(e){e&&k(t)}}}function mr(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1rvfn9e"><use xlink:href="#cloud-symbol"></use></svg> \n      <span class="svelte-1rvfn9e">GRAMET</span>',j(n,"class","nav-link svelte-1rvfn9e"),j(n,"href","#/gramet"),q(n,"disabled",!e[1]),j(t,"class","nav-item svelte-1rvfn9e"),q(t,"active","/gramet"===e[0])},m(e,o){w(e,t,o),x(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/gramet"===e[0])},d(e){e&&k(t)}}}function fr(e){let t,n;return{c(){t=C("li"),n=C("a"),n.innerHTML='<svg class="f svelte-1rvfn9e"><use xlink:href="#share-symbol"></use></svg> \n      <span class="svelte-1rvfn9e">EXPORT</span>',j(n,"class","nav-link svelte-1rvfn9e"),j(n,"href","#/export"),q(n,"disabled",!e[1]),j(t,"class","nav-item svelte-1rvfn9e"),q(t,"active","/export"===e[0])},m(e,o){w(e,t,o),x(t,n)},p(e,o){2&o&&q(n,"disabled",!e[1]),1&o&&q(t,"active","/export"===e[0])},d(e){e&&k(t)}}}function gr(e){let t,n,o,r,i,a,s,l,u,d,m,f,g,h=(e[1]||"/map"===e[0])&&dr(e),v=(e[1]&&!e[2]||"/gramet"===e[0])&&mr(e),y=(e[1]&&!e[2]||"/export"===e[0])&&fr(e);const b=e[4].default,$=c(b,e,e[3],null);return{c(){t=C("nav"),n=C("ul"),o=C("li"),r=C("a"),i=L("svg"),a=L("use"),s=M(),h&&h.c(),l=M(),v&&v.c(),u=M(),y&&y.c(),d=M(),m=C("li"),m.innerHTML='<a class="nav-link" href="#/help"><svg class="f svelte-1rvfn9e"><use xlink:href="#info-symbol"></use></svg> \n      <span class="svelte-1rvfn9e">AIDE</span></a>',f=M(),$&&$.c(),A(a,"xlink:href","#home-symbol"),j(i,"class","svelte-1rvfn9e"),j(r,"class","nav-link"),j(r,"href","#/"),j(o,"class","nav-item svelte-1rvfn9e"),q(o,"active","/"===e[0]),j(m,"class","nav-item svelte-1rvfn9e"),q(m,"active","/help"===e[0]),j(n,"class","navbar-nav mr-auto svelte-1rvfn9e"),j(t,"class","navbar navbar-expand-md navbar-light bg-light svelte-1rvfn9e")},m(e,c){w(e,t,c),x(t,n),x(n,o),x(o,r),x(r,i),x(i,a),x(n,s),h&&h.m(n,null),x(n,l),v&&v.m(n,null),x(n,u),y&&y.m(n,null),x(n,d),x(n,m),x(t,f),$&&$.m(t,null),g=!0},p(e,[t]){1&t&&q(o,"active","/"===e[0]),e[1]||"/map"===e[0]?h?h.p(e,t):(h=dr(e),h.c(),h.m(n,l)):h&&(h.d(1),h=null),e[1]&&!e[2]||"/gramet"===e[0]?v?v.p(e,t):(v=mr(e),v.c(),v.m(n,u)):v&&(v.d(1),v=null),e[1]&&!e[2]||"/export"===e[0]?y?y.p(e,t):(y=fr(e),y.c(),y.m(n,d)):y&&(y.d(1),y=null),1&t&&q(m,"active","/help"===e[0]),$&&$.p&&8&t&&p($,b,e,e[3],t,null,null)},i(e){g||($e($,e),g=!0)},o(e){xe($,e),g=!1},d(e){e&&k(t),h&&h.d(),v&&v.d(),y&&y.d(),$&&$.d(e)}}}function hr(e,t,n){let o,r,i;l(e,vn,(e=>n(0,o=e))),l(e,pn,(e=>n(1,r=e))),l(e,dn,(e=>n(2,i=e)));let{$$slots:a={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(3,s=e.$$scope)},[o,r,i,s,a]}class vr extends Ee{constructor(e){super(),Me(this,e,hr,gr,s,{})}}function yr(n){let o,r,i;const s=n[3].default,l=c(s,n,n[2],null);return{c(){o=C("page"),l&&l.c(),j(o,"class","svelte-1de5e3b"),q(o,"fadein",!1===n[0]),q(o,"d-none",!0===n[0])},m(e,t){w(e,o,t),l&&l.m(o,null),i=!0},p(e,[t]){l&&l.p&&4&t&&p(l,s,e,e[2],t,null,null),1&t&&q(o,"fadein",!1===e[0]),1&t&&q(o,"d-none",!0===e[0])},i(s){i||($e(l,s),r||se((()=>{r=function(n,o,r){let i,s,l=o(n,r),c=!1,u=0;function p(){i&&K(n,i)}function d(){const{delay:o=0,duration:r=300,easing:a=t,tick:d=e,css:m}=l||we;m&&(i=Z(n,0,1,r,o,a,m,u++)),d(0,1);const f=h()+o,g=f+r;s&&s.abort(),c=!0,se((()=>ge(n,!0,"start"))),s=$((e=>{if(c){if(e>=g)return d(1,0),ge(n,!0,"end"),p(),c=!1;if(e>=f){const t=a((e-f)/r);d(t,1-t)}}return c}))}let m=!1;return{start(){m||(K(n),a(l)?(l=l(),fe().then(d)):d())},invalidate(){m=!1},end(){c&&(p(),c=!1)}}}(o,n[1],{}),r.start()})),i=!0)},o(e){xe(l,e),i=!1},d(e){e&&k(o),l&&l.d(e)}}}function br(e,t,n){let{$$slots:o={},$$scope:r}=t,{hidden:i}=t;return e.$$set=e=>{"hidden"in e&&n(0,i=e.hidden),"$$scope"in e&&n(2,r=e.$$scope)},[i,(e,t,n)=>{if(void 0===i)return Be(e,t)},r,o]}class $r extends Ee{constructor(e){super(),Me(this,e,br,yr,s,{hidden:0})}}function xr(e){let t,o;const r=e[3].default,i=c(r,e,e[2],null);let a=[{href:e[0]},e[1]],s={};for(let e=0;e<a.length;e+=1)s=n(s,a[e]);return{c(){t=C("a"),i&&i.c(),T(t,s)},m(e,n){w(e,t,n),i&&i.m(t,null),o=!0},p(e,[n]){i&&i.p&&4&n&&p(i,r,e,e[2],n,null,null),T(t,s=function(e,t){const n={},o={},r={$$scope:1};let i=e.length;for(;i--;){const a=e[i],s=t[i];if(s){for(const e in a)e in s||(o[e]=1);for(const e in s)r[e]||(n[e]=s[e],r[e]=1);e[i]=s}else for(const e in a)r[e]=1}for(const e in o)e in n||(n[e]=void 0);return n}(a,[(!o||1&n)&&{href:e[0]},e[1]]))},i(e){o||($e(i,e),o=!0)},o(e){xe(i,e),o=!1},d(e){e&&k(t),i&&i.d(e)}}}function wr(e,t,o){const r=["href"];let i=d(t,r),{$$slots:a={},$$scope:s}=t,{href:l}=t;const c=l&&!l.startsWith("#")?Object.assign({rel:"noreferrer",target:"_blank"},i):i;return e.$$set=e=>{t=n(n({},t),function(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}(e)),o(5,i=d(t,r)),"href"in e&&o(0,l=e.href),"$$scope"in e&&o(2,s=e.$$scope)},[l,c,s,a]}class kr extends Ee{constructor(e){super(),Me(this,e,wr,xr,s,{href:0})}}function Pr(e){let t;return{c(){t=C("span"),t.innerHTML="Fly<span>Tax</span>",j(t,"class","flytax")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function Cr(e){let t,n,o,r,i,a,s,l,c,u,p,d,m,f,g,h,v,y,b,$,P,L,_,E,O,S,T,A,I,D,z,R,W,N,q,G,U,H,B,Z,K,X,J,V,Y,Q,ee,te,ne,oe,re,ie,ae=!0!==navigator.standalone&&function(e){let t,n,o;return{c(){t=F("Pour mémoire, dans un navigateur, il suffit de partager l'url ou "),n=C("a"),n.textContent="ce lien",o=F("."),j(n,"href","http://flyingeek.github.io/lido-online/index.html")},m(e,r){w(e,t,r),w(e,n,r),w(e,o,r)},d(e){e&&k(t),e&&k(n),e&&k(o)}}}();return oe=new kr({props:{href:"https://flyingeek.github.io/flytax/",rel:"noopener",$$slots:{default:[Pr]},$$scope:{ctx:e}}}),{c(){t=C("h2"),t.textContent="Préambule",n=M(),o=C("p"),o.textContent="OFP2MAP est une application PWA (ou Web Application), elle peut être lancée soit depuis un navigateur, soit depuis l'écran d'accueil de l'iPad. Initialement, simple convertisseur de l'OFP en KML, OFP2MAP est devenu une vraie application de cartographie.",r=M(),i=C("p"),i.textContent="OFP2MAP nécessite des navigateurs récents pour fonctionner. Safari 14 iOS/Mac est compatible, Chrome 83 fonctionne aussi.",a=M(),s=C("p"),s.textContent="L'OFP ne transite sur aucun serveur, seule une route calculée (basée sur au plus 21 stations météo) est transmise à l'hébergeur du proxy (voir plus bas) puis à Ogimet.com pour récupérer le Gramet. L'app ne collecte aucune données.",l=M(),c=C("h2"),c.textContent="Utilisation",u=M(),p=C("ol"),p.innerHTML="<li><p>Dans Pilot Mission, onglet «Dossier de vol», affichez le PDF nommé &quot;Dossier de vol OFP&quot;. Sur la gauche, cliquez sur le carré avec une flèche vers le haut. Choisissez «Enregistrer dans Fichiers». Dans l&#39;app, c&#39;est cet OFP qu&#39;il faut ensuite sélectionner.</p></li> \n<li><p>La carte dispose d&#39;un bouton pour personnaliser les couleurs. Le type avion pour l&#39;adéquation des terrains est détecté dans l&#39;OFP. Pour vous entrainer, je vous recommande de modifier la couleur des terrains en vert/rouge et de sauvegarder votre choix.</p></li> \n<li><p>Pour Exporter vers une app, direction le menu EXPORT, vous pouvez exporter une route pour mPilot, télécharger le KML (routes et tracks uniquement), ou envoyer vers l&#39;app <strong>Raccourcis</strong> d&#39;Apple.</p></li> \n<li><p>La carte par défaut est une LAMBERT, il est possible sur la carte, en haut à gauche, de basculer sur d&#39;autres projections.</p> \n<ul><li>LAMBERT NORTH (parallèles sécants N30 et N65) est recommandée au-dessus du N40</li> \n<li>LAMBERT SOUTH &amp; PACIFIC (parallèles sécants N30 et S15 ) sont recommandées sous N30</li> \n<li>THE WORLD permet de disposer d&#39;un Atlas off-line, c&#39;est une projection Times</li> \n<li>MERCATOR est une Web Mercator avec un thème est inspiré des cartes VFR. Il y a 12 niveaux de zoom, dont 6 disponibles off-line</li></ul></li>",d=M(),m=C("ol"),m.innerHTML="<li>Navigation dans la carte: on peut avec un doigt déplacer la carte, zoomer ou orienter la carte avec deux doigts. Il est aussi possible de modifier l&#39;angle de vue en balayant de haut en bas avec deux doigts. Si vous activez le bouton de géolocalisation, la carte peut se centrer automatiquement.</li>",f=M(),g=C("h2"),g.textContent="Particularités de l'iPad",h=M(),v=C("p"),v.textContent="OFP2MAP ne peut être lancé que depuis l'écran d'accueil, l'application se lance en plein écran. On ne peut pas recharger la page comme dans un navigateur : il faudra pour cela aller dans le menu d'aide (cet écran) ou un bouton spécifique sera affiché en haut.",y=M(),b=C("p"),$=F("Pour partager le lien vers OFP2MAP, utilisez le bouton situé en haut sur cette page, ou le lien situé sous le logo sur la page d'accueil, puis utilisez AirDrop. "),ae&&ae.c(),P=M(),L=C("p"),L.innerHTML='L&#39;export des fichiers KML affiche une page nommée &quot;data:&quot;, utilisez le bouton <svg style="vertical-align: bottom;"><use xlink:href="#share-symbol"></use></svg> pour choisir l&#39;app qui recevra le fichier. Cliquez en haut à gauche sur OK pour revenir à OFP2MAP. En raison d&#39;un bug d&#39;iOS, il est impossible de nommer le fichier pour le moment.',_=M(),E=C("p"),E.textContent="À noter que parfois, des bugs d'affichage peuvent apparaître :  lorsque l'on retourne sur l'app, l'app est zoomée, il faut alors juste dézoomer en utilisant un pinch de deux doigts sur la barre de menu. Il est aussi possible de tuer l'app,  même en mode déconnecté, pour la relancer.",O=M(),S=C("h2"),S.textContent="Mode off-line",T=M(),A=C("p"),A.textContent="Une fois un premier OFP chargé, il est possible même en mode déconnecté de charger un autre OFP pour l'exporter. Le cache de l'App vous permettra de naviguer sur les cartes déjà visualisées. Pour mettre en cache les cartes, il suffit de les consulter.",I=M(),D=C("p"),D.textContent="Il existe aussi un bouton de mise en cache : le pictogramme ↓ situé à droite du sélecteur de carte. Sur les cartes LAMBERT ou THE WORLD, il mettra en cache la totalité de la carte. Sur la MERCATOR, seule la partie de carte incluant la route sera mise en cache.",z=M(),R=C("p"),R.textContent="Les premières mises en cache peuvent prendre du temps : sur la Mercator, un vol LC peut nécessiter le téléchargement de 40Mo de données. Les caches des autres projections utilisent : 7Mo pour la NORTH, 4Mo pour la PACIFIC, 7Mo pour la SOUTH et 32Mo pour THE WORLD.",W=M(),N=C("h2"),N.textContent="Mise à jour",q=M(),G=C("p"),G.textContent="L'app détecte les mises à jour automatiquement, normalement vous n'avez rien à faire. Eventuellement un prompt peut\napparaitre vous demandant d'autoriser cette mise à jour. La version AIRAC et le type avion détecté dans l'OFP sont affichés en bas à droite de la carte dans le champ d'attribution.",U=M(),H=C("h2"),H.textContent="Crédits",B=M(),Z=C("ul"),Z.innerHTML='<li>Les données terrains/FIR sont fournies par Olivier Ravet forum Yammer/Mapsme</li> \n<li>Les cartes (autres que Mapbox streets) sont de Jean-Baptiste Denizot forum Yammer/QGIS &amp; Avenza Maps</li> \n<li>Le GRAMET provient du site ogimet.com</li> \n<li>Le site est développé en javascript à l&#39;aide du framework SVELTE</li> \n<li>La partie serveur (un proxy pour pouvoir récupérer l&#39;image du GRAMET) est en python.</li> \n<li>Eric Delord CDB 777 est l&#39;auteur. Le code source est disponible sur GitHub pour <a href="https://github.com/flyingeek/lido-online">l&#39;app</a> et <a href="https://github.com/flyingeek/ofp2map-gramet">le proxy</a></li>',K=M(),X=C("h2"),X.textContent="Hébergement",J=M(),V=C("p"),V.textContent="L'hébergement des images est normalement fourni par alwaysdata.com (pack gratuit) mais en raison d'un blacklistage sur le réseau internet d'AF, les fonds de cartes sont à présent hébergés sur netlify. Le proxy gramet est lui dorénavant hébergé sur vercel.",Y=M(),Q=C("h2"),Q.textContent="Liens",ee=M(),te=C("ul"),ne=C("li"),Le(oe.$$.fragment),re=F(" une aide aux calculs des frais professionnels (même auteur)."),j(m,"start","5")},m(e,k){w(e,t,k),w(e,n,k),w(e,o,k),w(e,r,k),w(e,i,k),w(e,a,k),w(e,s,k),w(e,l,k),w(e,c,k),w(e,u,k),w(e,p,k),w(e,d,k),w(e,m,k),w(e,f,k),w(e,g,k),w(e,h,k),w(e,v,k),w(e,y,k),w(e,b,k),x(b,$),ae&&ae.m(b,null),w(e,P,k),w(e,L,k),w(e,_,k),w(e,E,k),w(e,O,k),w(e,S,k),w(e,T,k),w(e,A,k),w(e,I,k),w(e,D,k),w(e,z,k),w(e,R,k),w(e,W,k),w(e,N,k),w(e,q,k),w(e,G,k),w(e,U,k),w(e,H,k),w(e,B,k),w(e,Z,k),w(e,K,k),w(e,X,k),w(e,J,k),w(e,V,k),w(e,Y,k),w(e,Q,k),w(e,ee,k),w(e,te,k),x(te,ne),_e(oe,ne,null),x(ne,re),ie=!0},p(e,[t]){const n={};1&t&&(n.$$scope={dirty:t,ctx:e}),oe.$set(n)},i(e){ie||($e(oe.$$.fragment,e),ie=!0)},o(e){xe(oe.$$.fragment,e),ie=!1},d(e){e&&k(t),e&&k(n),e&&k(o),e&&k(r),e&&k(i),e&&k(a),e&&k(s),e&&k(l),e&&k(c),e&&k(u),e&&k(p),e&&k(d),e&&k(m),e&&k(f),e&&k(g),e&&k(h),e&&k(v),e&&k(y),e&&k(b),ae&&ae.d(),e&&k(P),e&&k(L),e&&k(_),e&&k(E),e&&k(O),e&&k(S),e&&k(T),e&&k(A),e&&k(I),e&&k(D),e&&k(z),e&&k(R),e&&k(W),e&&k(N),e&&k(q),e&&k(G),e&&k(U),e&&k(H),e&&k(B),e&&k(Z),e&&k(K),e&&k(X),e&&k(J),e&&k(V),e&&k(Y),e&&k(Q),e&&k(ee),e&&k(te),Fe(oe)}}}class Lr extends Ee{constructor(e){super(),Me(this,e,null,Cr,s,{})}}function _r(t){let n,o,r,i,a=navigator.share&&function(t){let n,o,r;return{c(){n=C("button"),n.textContent="Partager l'App",j(n,"class","btn btn-outline-secondary btn-sm svelte-12luy5v")},m(e,t){w(e,n,t),o||(r=O(n,"click",Ue),o=!0)},p:e,d(e){e&&k(n),o=!1,r()}}}();return{c(){a&&a.c(),n=M(),o=C("button"),o.textContent="Recharger l'App",j(o,"class","btn btn-outline-secondary btn-sm svelte-12luy5v")},m(e,s){a&&a.m(e,s),w(e,n,s),w(e,o,s),r||(i=O(o,"click",t[2]),r=!0)},p(e,t){navigator.share&&a.p(e,t)},d(e){a&&a.d(e),e&&k(n),e&&k(o),r=!1,i()}}}function Fr(e){let t,n,o,r,i,a,s,l,c,u,p,d,m,f,g,h=!0===navigator.standalone&&_r(e);return d=new Lr({}),{c(){t=C("div"),n=C("h1"),o=C("div"),o.innerHTML='<img src="images/ofp2map-icons/icon-128x128.png" alt="logo" class="svelte-12luy5v"/><span class="svelte-12luy5v">OFP2MAP</span>',r=F(" v"),i=F(Mr),a=M(),s=C("small"),l=F("/ ServiceWorker : "),c=F(e[1]),u=M(),h&&h.c(),p=M(),Le(d.$$.fragment),j(o,"class","app svelte-12luy5v"),j(s,"class","svelte-12luy5v"),j(n,"class","svelte-12luy5v"),j(t,"class","markdown svelte-12luy5v")},m(v,y){w(v,t,y),x(t,n),x(n,o),x(n,r),x(n,i),x(n,a),x(n,s),x(s,l),x(s,c),x(n,u),h&&h.m(n,null),x(t,p),_e(d,t,null),m=!0,f||(g=O(s,"click",e[3],{once:!0}),f=!0)},p(e,[t]){(!m||2&t)&&D(c,e[1]),!0===navigator.standalone&&h.p(e,t)},i(e){m||($e(d.$$.fragment,e),m=!0)},o(e){xe(d.$$.fragment,e),m=!1},d(e){e&&k(t),h&&h.d(),Fe(d),f=!1,g()}}}const Mr="1.5.0";function Er(e,t,n){let o;l(e,ln,(e=>n(0,o=e)));let r="";return e.$$.update=()=>{var t;1&e.$$.dirty&&(t=o)&&t.messageSW({type:"GET_VERSION"}).then((e=>n(1,r=e)))},[o,r,()=>{window.location.hash="#/",window.location.reload()},()=>o&&o.update()&&void 0]}class Or extends Ee{constructor(e){super(),Me(this,e,Er,Fr,s,{})}}function Sr(e){let t,n,o,r,a,s,l,c,u,p,d,m,f,g,h,v;return{c(){t=C("div"),n=C("div"),o=C("strong"),o.innerHTML='<span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour disponible',r=M(),a=C("button"),a.innerHTML='<span aria-hidden="true">×</span>',s=M(),l=C("div"),c=C("p"),c.textContent="Il faudra recharger l'OFP",u=M(),p=C("button"),d=C("span"),m=F(e[1]),j(o,"class","svelte-395rpc"),j(a,"type","button"),j(a,"class","close svelte-395rpc"),j(a,"aria-label","Close"),j(n,"class","toast-header svelte-395rpc"),j(d,"class","svelte-395rpc"),q(d,"blinking",e[1].endsWith("...")),j(p,"class","btn btn-primary"),j(p,"type","button"),j(l,"class","toast-body text-center"),j(t,"class","toast svelte-395rpc"),R(t,"position","fixed"),R(t,"top","0"),R(t,"right","0")},m(i,f){w(i,t,f),x(t,n),x(n,o),x(n,r),x(n,a),x(t,s),x(t,l),x(l,c),x(l,u),x(l,p),x(p,d),x(d,m),g=!0,h||(v=[O(a,"click",e[6]),O(p,"click",e[7],{once:!0})],h=!0)},p(e,t){(!g||2&t)&&D(m,e[1]),2&t&&q(d,"blinking",e[1].endsWith("..."))},i(e){g||(se((()=>{f||(f=ke(t,Be,{},!0)),f.run(1)})),g=!0)},o(e){f||(f=ke(t,Be,{},!1)),f.run(0),g=!1},d(e){e&&k(t),e&&f&&f.end(),h=!1,i(v)}}}function jr(t){let n,o,r,i,a,s,l,c,u,p,d=(t[4](700)||"")+"";return{c(){n=C("div"),o=C("div"),r=C("div"),r.innerHTML='<strong class="svelte-395rpc"><span class="svelte-395rpc">👨🏻‍✈️</span>Mise à jour détectée</strong>',i=M(),a=C("div"),s=C("button"),s.innerHTML="<span>Mise à jour...</span>",l=M(),c=F(d),j(r,"class","toast-header svelte-395rpc"),j(s,"class","btn"),j(s,"type","button"),j(a,"class","toast-body text-center"),j(o,"class","toast svelte-395rpc"),j(n,"class","modal svelte-395rpc")},m(e,d){w(e,n,d),x(n,o),x(o,r),x(o,i),x(o,a),x(a,s),x(n,l),w(e,c,d),u||(p=O(s,"click",S(t[5])),u=!0)},p:e,i:e,o:e,d(e){e&&k(n),e&&k(c),u=!1,p()}}}function Tr(e){let t,n,o,r;const i=[jr,Sr],a=[];function s(e,t){return!e[3]||e[2]||e[0]?e[3]&&!e[2]?1:-1:0}return~(t=s(e))&&(n=a[t]=i[t](e)),{c(){n&&n.c(),o=E()},m(e,n){~t&&a[t].m(e,n),w(e,o,n),r=!0},p(e,[r]){let l=t;t=s(e),t===l?~t&&a[t].p(e,r):(n&&(ye(),xe(a[l],1,1,(()=>{a[l]=null})),be()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=i[t](e),n.c()),$e(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||($e(n),r=!0)},o(e){xe(n),r=!1},d(e){~t&&a[t].d(e),e&&k(o)}}}const Ar=sn(!1),Ir=sn(),Dr=sn(!1),zr=e=>{Ar.set(!0),cn.set(!1),e?Dr.set(!((e,t)=>{const n=e.split("."),o=t.split(".");return n.slice(0,-1).join(".")===o.slice(0,-1).join(".")})("1.5.0",e)):Dr.set(!0)};function Rr(t,n,o){let r,i,a,s,c=e,u=e;l(t,cn,(e=>o(2,r=e))),l(t,ln,(e=>o(8,i=e))),l(t,Ir,(e=>o(9,a=e))),l(t,Ar,(e=>o(3,s=e))),t.$$.on_destroy.push((()=>c())),t.$$.on_destroy.push((()=>u()));let p="Installer";m(cn,r=!1,r);let{prompt:d=!1}=n;const f=(e=0)=>{let t;i&&a&&a.waiting?(navigator.serviceWorker.addEventListener("controllerchange",(()=>{t||(t=!0,e?setTimeout((()=>window.location.reload()),e):window.location.reload())})),o(1,p="En cours..."),a.waiting.postMessage({type:"SKIP_WAITING"})):window.location.reload()};return t.$$set=e=>{"prompt"in e&&o(0,d=e.prompt)},[d,p,r,s,f,function(e){Q(t,e)},()=>m(cn,r=!0,r),()=>f()]}class Wr extends Ee{constructor(e){super(),Me(this,e,Rr,Tr,s,{prompt:0})}}function Nr(e){let t;return{c(){t=C("ol"),t.innerHTML='<li class="svelte-aqbc18">Dans la barre de menu, cliquez sur <svg class="svelte-aqbc18"><use xlink:href="#share-symbol"></use></svg></li> \n                    <li class="svelte-aqbc18">Faites défiler, choisir : <em>Sur l&#39;écran d&#39;accueil</em>  <svg style="width:22px;height:22px;" class="svelte-aqbc18"><use xlink:href="#add2home-symbol"></use></svg></li> \n                    <li class="svelte-aqbc18">Lancez l&#39;application depuis l&#39;écran d&#39;accueil</li>',j(t,"class","guide svelte-aqbc18")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function qr(e){let t;return{c(){t=C("p"),t.textContent="Merci d'ouvrir cette page dans Safari",j(t,"class","guide error svelte-aqbc18")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function Gr(t){let n,o,r,i,a,s,l,c,u,p,d,m,f,g;n=new Gt({});let h=function(e,t){return e[0]?Nr:qr}(t)(t);return f=new Wr({}),{c(){Le(n.$$.fragment),o=M(),r=C("div"),i=C("div"),a=C("div"),a.innerHTML='<img src="./images/ofp2map-icons/icon-128x128.png" alt="OFP2MAP" class="svelte-aqbc18"/>',s=M(),l=C("div"),c=C("h3"),c.textContent="Installez OFP2MAP",u=M(),p=C("p"),p.textContent="Si OFP2MAP est déjà sur l'écran d'accueil, ne l'installez pas une deuxième fois. Attention: l'installation ne peut se faire que depuis\n                le navigateur Safari, ce n'est pas possible depuis une WebView (à l'intérieur d'une app).",d=M(),h.c(),m=M(),Le(f.$$.fragment),j(a,"class","icon-container svelte-aqbc18"),j(c,"class","title svelte-aqbc18"),j(p,"class","text svelte-aqbc18"),j(l,"class","prompt-content svelte-aqbc18"),j(i,"class","prompt svelte-aqbc18"),j(r,"class","prompt-container svelte-aqbc18")},m(e,t){_e(n,e,t),w(e,o,t),w(e,r,t),x(r,i),x(i,a),x(i,s),x(i,l),x(l,c),x(l,u),x(l,p),x(l,d),h.m(l,null),w(e,m,t),_e(f,e,t),g=!0},p:e,i(e){g||($e(n.$$.fragment,e),$e(f.$$.fragment,e),g=!0)},o(e){xe(n.$$.fragment,e),xe(f.$$.fragment,e),g=!1},d(e){Fe(n,e),e&&k(o),e&&k(r),h.d(),e&&k(m),Fe(f,e)}}}function Ur(e){return[Te&&!je]}class Hr extends Ee{constructor(e){super(),Me(this,e,Ur,Gr,s,{})}}function Br(e){let t,n,o,r,i,a,s,l,c;t=new vr({props:{$$slots:{default:[Kr]},$$scope:{ctx:e}}}),o=new Wr({props:{prompt:!!e[1]}});let u=e[1]&&Xr(e);const p=[ri,oi,ni,ti],d=[];function m(e,t){return!e[1]||"/gramet"!==e[2]&&"/export"!==e[2]?"/"===e[2]?1:"/help"===e[2]?2:e[1]?-1:3:0}return~(a=m(e))&&(s=d[a]=p[a](e)),{c(){Le(t.$$.fragment),n=M(),Le(o.$$.fragment),r=M(),u&&u.c(),i=M(),s&&s.c(),l=E()},m(e,s){_e(t,e,s),w(e,n,s),_e(o,e,s),w(e,r,s),u&&u.m(e,s),w(e,i,s),~a&&d[a].m(e,s),w(e,l,s),c=!0},p(e,n){const r={};8217&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const c={};2&n&&(c.prompt=!!e[1]),o.$set(c),e[1]?u?(u.p(e,n),2&n&&$e(u,1)):(u=Xr(e),u.c(),$e(u,1),u.m(i.parentNode,i)):u&&(ye(),xe(u,1,1,(()=>{u=null})),be());let f=a;a=m(e),a===f?~a&&d[a].p(e,n):(s&&(ye(),xe(d[f],1,1,(()=>{d[f]=null})),be()),~a?(s=d[a],s?s.p(e,n):(s=d[a]=p[a](e),s.c()),$e(s,1),s.m(l.parentNode,l)):s=null)},i(e){c||($e(t.$$.fragment,e),$e(o.$$.fragment,e),$e(u),$e(s),c=!0)},o(e){xe(t.$$.fragment,e),xe(o.$$.fragment,e),xe(u),xe(s),c=!1},d(e){Fe(t,e),e&&k(n),Fe(o,e),e&&k(r),u&&u.d(e),e&&k(i),~a&&d[a].d(e),e&&k(l)}}}function Zr(t){let n,o;return n=new Hr({}),{c(){Le(n.$$.fragment)},m(e,t){_e(n,e,t),o=!0},p:e,i(e){o||($e(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){Fe(n,e)}}}function Kr(e){let t,n,o,r,i;return n=new Uo({props:{kmlOptions:e[0]}}),n.$on("change",e[7]),{c(){t=C("form"),Le(n.$$.fragment),j(t,"class","form-inline svelte-1a0hzo3")},m(a,s){w(a,t,s),_e(n,t,null),o=!0,r||(i=O(t,"submit",S(e[6])),r=!0)},p(e,t){const o={};1&t&&(o.kmlOptions=e[0]),n.$set(o)},i(e){o||($e(n.$$.fragment,e),o=!0)},o(e){xe(n.$$.fragment,e),o=!1},d(e){e&&k(t),Fe(n),r=!1,i()}}}function Xr(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Qr,then:Vr,catch:Jr,value:11,error:12,blocks:[,,,]};return Pe(n=e[1],r),{c(){t=E(),r.block.c()},m(e,n){w(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&Pe(n,r));else{const t=e.slice();t[11]=t[12]=r.resolved,r.block.p(t,o)}},i(e){o||($e(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){xe(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function Jr(t){let n,o,r,i=t[12].message+"";return{c(){n=C("p"),o=F("😱: "),r=F(i),q(n,"d-none","/map"!==t[2])},m(e,t){w(e,n,t),x(n,o),x(n,r)},p(e,t){2&t&&i!==(i=e[12].message+"")&&D(r,i),4&t&&q(n,"d-none","/map"!==e[2])},i:e,o:e,d(e){e&&k(n)}}}function Vr(e){let t,n;return t=new $r({props:{hidden:"/map"!==e[2],$$slots:{default:[Yr]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.hidden="/map"!==e[2]),8199&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function Yr(e){let t,n,o;function r(t){e[8](t)}let i={id:"map",ofp:e[11]};return void 0!==e[0]&&(i.kmlOptions=e[0]),t=new pr({props:i}),te.push((()=>Ce(t,"kmlOptions",r))),t.$on("save",e[9]),{c(){Le(t.$$.fragment)},m(e,n){_e(t,e,n),o=!0},p(e,o){const r={};2&o&&(r.ofp=e[11]),!n&&1&o&&(n=!0,r.kmlOptions=e[0],le((()=>n=!1))),t.$set(r)},i(e){o||($e(t.$$.fragment,e),o=!0)},o(e){xe(t.$$.fragment,e),o=!1},d(e){Fe(t,e)}}}function Qr(e){let t,n;return t=new $r({props:{hidden:"/map"!==e[2],$$slots:{default:[ei]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.hidden="/map"!==e[2]),8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function ei(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",R(t,"margin","auto")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function ti(t){let n,o=t[5](t[2])+"";return{c(){n=F(o)},m(e,t){w(e,n,t)},p(e,t){4&t&&o!==(o=e[5](e[2])+"")&&D(n,o)},i:e,o:e,d(e){e&&k(n)}}}function ni(e){let t,n;return t=new $r({props:{$$slots:{default:[ii]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function oi(e){let t,n;return t=new $r({props:{$$slots:{default:[ai]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function ri(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:mi,then:li,catch:si,value:11,error:12,blocks:[,,,]};return Pe(n=e[1],r),{c(){t=E(),r.block.c()},m(e,n){w(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,o){if(e=t,r.ctx=e,2&o&&n!==(n=e[1])&&Pe(n,r));else{const t=e.slice();t[11]=t[12]=r.resolved,r.block.p(t,o)}},i(e){o||($e(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){xe(r.blocks[e])}o=!1},d(e){e&&k(t),r.block.d(e),r.token=null,r=null}}}function ii(e){let t,n;return t=new Or({}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function ai(e){let t,n;return t=new Ht({}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function si(t){let n,o,r,i=t[12].message+"";return{c(){n=C("p"),o=F("😱: "),r=F(i)},m(e,t){w(e,n,t),x(n,o),x(n,r)},p(e,t){2&t&&i!==(i=e[12].message+"")&&D(r,i)},i:e,o:e,d(e){e&&k(n)}}}function li(e){let t,n,o,r;const i=[ui,ci],a=[];function s(e,t){return"/gramet"===e[2]?0:"/export"===e[2]?1:-1}return~(t=s(e))&&(n=a[t]=i[t](e)),{c(){n&&n.c(),o=E()},m(e,n){~t&&a[t].m(e,n),w(e,o,n),r=!0},p(e,r){let l=t;t=s(e),t===l?~t&&a[t].p(e,r):(n&&(ye(),xe(a[l],1,1,(()=>{a[l]=null})),be()),~t?(n=a[t],n?n.p(e,r):(n=a[t]=i[t](e),n.c()),$e(n,1),n.m(o.parentNode,o)):n=null)},i(e){r||($e(n),r=!0)},o(e){xe(n),r=!1},d(e){~t&&a[t].d(e),e&&k(o)}}}function ci(e){let t,n;return t=new $r({props:{$$slots:{default:[pi]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8199&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function ui(e){let t,n;return t=new $r({props:{$$slots:{default:[di]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8194&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function pi(e){let t,n,o,r;return t=new jt({props:{ofp:e[11]}}),t.$on("save",e[10]),o=new tt({props:{ofp:e[11]}}),{c(){Le(t.$$.fragment),n=M(),Le(o.$$.fragment)},m(e,i){_e(t,e,i),w(e,n,i),_e(o,e,i),r=!0},p(e,n){const r={};2&n&&(r.ofp=e[11]),t.$set(r);const i={};2&n&&(i.ofp=e[11]),o.$set(i)},i(e){r||($e(t.$$.fragment,e),$e(o.$$.fragment,e),r=!0)},o(e){xe(t.$$.fragment,e),xe(o.$$.fragment,e),r=!1},d(e){Fe(t,e),e&&k(n),Fe(o,e)}}}function di(e){let t,n;return t=new Rt({props:{ofp:e[11]}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};2&n&&(o.ofp=e[11]),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function mi(e){let t,n;return t=new $r({props:{$$slots:{default:[fi]},$$scope:{ctx:e}}}),{c(){Le(t.$$.fragment)},m(e,o){_e(t,e,o),n=!0},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||($e(t.$$.fragment,e),n=!0)},o(e){xe(t.$$.fragment,e),n=!1},d(e){Fe(t,e)}}}function fi(e){let t;return{c(){t=C("div"),t.textContent="traitement en cours...",R(t,"margin","auto")},m(e,n){w(e,t,n)},d(e){e&&k(t)}}}function gi(e){let t,n,o,r,i,a;const s=[Zr,Br],l=[];return o=navigator&&!1===navigator.standalone&&Se?0:1,r=l[o]=s[o](e),{c(){t=C("main"),n=C("div"),r.c(),j(n,"class","content svelte-1a0hzo3"),j(t,"class",i="container "+(e[2].substr(1)||"home")+" svelte-1a0hzo3")},m(e,r){w(e,t,r),x(t,n),l[o].m(n,null),a=!0},p(e,[n]){r.p(e,n),(!a||4&n&&i!==(i="container "+(e[2].substr(1)||"home")+" svelte-1a0hzo3"))&&j(t,"class",i)},i(e){a||($e(r),a=!0)},o(e){xe(r),a=!1},d(e){e&&k(t),l[o].d()}}}function hi(e,t,n){let o,r,i,a;l(e,pn,(e=>n(1,o=e))),l(e,vn,(e=>n(2,r=e))),l(e,un,(e=>n(3,i=e))),l(e,cn,(e=>n(4,a=e)));(e=>{const t={},n={};e.length>1&&(e.substr(1)||"").split("&").forEach((function(e){const n=e.split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}));for(let[e,o]of Object.entries(t))if(e in nt){let t;e.endsWith("Pin")?(o*=1,isNaN(o)||(t=o)):e.endsWith("Color")&&o.match(ct)?t=o.toUpperCase():e.endsWith("Display")?t=!!o:e.endsWith("Change")&&(o*=1,isNaN(o)||(t=o.toFixed(1))),void 0!==t&&(n[e]=t)}else"downloadType"===e?(o*=1,isNaN(o)||bt.setItem(yt.downloadType,o)):"shortcut"===e&&(o=o.trim(),o&&bt.setItem(yt.shortcut,o));bt.setItem(yt.optionsKML,n)})(window.location.search);let s=(e=>{const t={};for(let[n,o]of Object.entries(e))n in nt&&(n.endsWith("Pin")?(o*=1,isNaN(o)||(t[n]=o)):n.endsWith("Color")&&o.match(ct)?t[n]=o.toUpperCase():n.endsWith("Display")?t[n]=!!o:n.endsWith("Change")&&(o*=1,isNaN(o)||(t[n]=o.toFixed(1))));return{...nt,...t}})(bt.getItem(yt.optionsKML)||{});$t(s,r),V((()=>(document.addEventListener("visibilitychange",gn,!1),()=>document.removeEventListener("visibilitychange",gn))));return[s,o,r,i,a,e=>{window.location.hash="#/"},function(t){Q(e,t)},()=>m(un,i=m(cn,a=!1,a),i),function(e){s=e,n(0,s)},()=>$t(s,r),()=>$t(s,r)]}class vi extends Ee{constructor(e){super(),Me(this,e,hi,gi,s,{})}}try{self["workbox:window:6.1.1"]&&_()}catch(yi){}function yi(e,t){return new Promise((function(n){var o=new MessageChannel;o.port1.onmessage=function(e){n(e.data)},e.postMessage(t,[o.port2])}))}function bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function $i(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bi(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.1.1"]&&_()}catch(yi){}var xi=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))};function wi(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var ki=function(e,t){this.type=e,Object.assign(this,t)};function Pi(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ci(){}var Li={type:"SKIP_WAITING"};function _i(e,t){if(!t)return e&&e.then?e.then(Ci):Promise.resolve()}var Fi=function(e){var t,n;function o(t,n){var o,r;return void 0===n&&(n={}),(o=e.call(this)||this).nn={},o.tn=0,o.rn=new xi,o.en=new xi,o.on=new xi,o.un=0,o.an=new Set,o.cn=function(){var e=o.fn,t=e.installing;o.tn>0||!wi(t.scriptURL,o.sn)||performance.now()>o.un+6e4?(o.vn=t,e.removeEventListener("updatefound",o.cn)):(o.hn=t,o.an.add(t),o.rn.resolve(t)),++o.tn,t.addEventListener("statechange",o.ln)},o.ln=function(e){var t=o.fn,n=e.target,r=n.state,i=n===o.vn,a={sw:n,isExternal:i,originalEvent:e};!i&&o.mn&&(a.isUpdate=!0),o.dispatchEvent(new ki(r,a)),"installed"===r?o.wn=self.setTimeout((function(){"installed"===r&&t.waiting===n&&o.dispatchEvent(new ki("waiting",a))}),200):"activating"===r&&(clearTimeout(o.wn),i||o.en.resolve(n))},o.dn=function(e){var t=o.hn;t===navigator.serviceWorker.controller&&(o.dispatchEvent(new ki("controlling",{sw:t,originalEvent:e,isUpdate:o.mn})),o.on.resolve(t))},o.gn=(r=function(e){var t=e.data,n=e.source;return Pi(o.getSW(),(function(){o.an.has(n)&&o.dispatchEvent(new ki("message",{data:t,sw:n,originalEvent:e}))}))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}),o.sn=t,o.nn=n,navigator.serviceWorker.addEventListener("message",o.gn),o}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r,i=o.prototype;return i.register=function(e){var t=(void 0===e?{}:e).immediate,n=void 0!==t&&t;try{var o=this;return function(e,t){var n=e();return n&&n.then?n.then(t):t()}((function(){if(!n&&"complete"!==document.readyState)return _i(new Promise((function(e){return window.addEventListener("load",e)})))}),(function(){return o.mn=Boolean(navigator.serviceWorker.controller),o.yn=o.pn(),Pi(o.bn(),(function(e){o.fn=e,o.yn&&(o.hn=o.yn,o.en.resolve(o.yn),o.on.resolve(o.yn),o.yn.addEventListener("statechange",o.ln,{once:!0}));var t=o.fn.waiting;return t&&wi(t.scriptURL,o.sn)&&(o.hn=t,Promise.resolve().then((function(){o.dispatchEvent(new ki("waiting",{sw:t,wasWaitingBeforeRegister:!0}))})).then((function(){}))),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.dn,{once:!0}),o.fn}))}))}catch(e){return Promise.reject(e)}},i.update=function(){try{return this.fn?_i(this.fn.update()):void 0}catch(e){return Promise.reject(e)}},i.getSW=function(){return void 0!==this.hn?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(e){try{return Pi(this.getSW(),(function(t){return yi(t,e)}))}catch(e){return Promise.reject(e)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&yi(this.fn.waiting,Li)},i.pn=function(){var e=navigator.serviceWorker.controller;return e&&wi(e.scriptURL,this.sn)?e:void 0},i.bn=function(){try{var e=this;return function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return Pi(navigator.serviceWorker.register(e.sn,e.nn),(function(t){return e.un=performance.now(),t}))}),(function(e){throw e}))}catch(e){return Promise.reject(e)}},(r=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o.prototype,r),o}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(e,t){this.Sn(e).add(t)},t.removeEventListener=function(e,t){this.Sn(e).delete(t)},t.dispatchEvent=function(e){e.target=this;for(var t,n=$i(this.Sn(e.type));!(t=n()).done;)(0,t.value)(e)},t.Sn=function(e){return this.Pn.has(e)||this.Pn.set(e,new Set),this.Pn.get(e)},e}());let Mi,Ei=!1;try{Mi=new vi({target:document.body})}catch(e){Ei=!0;try{var Oi=document.createElement("p");Oi.innerHTML="Erreur: "+e.message+"<br/><br/>OFP2MAP a besoin de navigateurs récents: Safari 14 iOS/Mac, Firefox 86, Chrome 87 et Microsoft Edge 87 sont compatibles. <br /><br />Contactez moi sur l'email AF (erdelord@...) en me donnant le message d'erreur.",document.body.appendChild(Oi)}catch($i){}}finally{if("serviceWorker"in navigator){const e=new Fi("./sw.js");ln.set(e),e.addEventListener("installed",(e=>{e.isUpdate})),e.addEventListener("activated",(t=>{t.isUpdate||e.messageSW({type:"CLIENTS_CLAIM"}),t.isExternal})),e.addEventListener("waiting",(t=>{Ei?(e.addEventListener("controlling",(()=>{window.location.reload()})),e.messageSkipWaiting()):(t.isExternal,Ge(400,yi(t.sw,{type:"GET_VERSION"})).then((e=>zr(e))).catch((e=>{zr()})))})),e.register().then((e=>{Ei&&e&&e.unregister(),Ir.set(e)}),console.error)}}return Mi}();
//# sourceMappingURL=bundle.js.map
